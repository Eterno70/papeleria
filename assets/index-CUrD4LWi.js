(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const a of document.querySelectorAll('link[rel="modulepreload"]'))n(a);new MutationObserver(a=>{for(const i of a)if(i.type==="childList")for(const s of i.addedNodes)s.tagName==="LINK"&&s.rel==="modulepreload"&&n(s)}).observe(document,{childList:!0,subtree:!0});function r(a){const i={};return a.integrity&&(i.integrity=a.integrity),a.referrerPolicy&&(i.referrerPolicy=a.referrerPolicy),a.crossOrigin==="use-credentials"?i.credentials="include":a.crossOrigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function n(a){if(a.ep)return;a.ep=!0;const i=r(a);fetch(a.href,i)}})();var li=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function M_(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}function B_(e){if(e.__esModule)return e;var t=e.default;if(typeof t=="function"){var r=function n(){return this instanceof n?Reflect.construct(t,arguments,this.constructor):t.apply(this,arguments)};r.prototype=t.prototype}else r={};return Object.defineProperty(r,"__esModule",{value:!0}),Object.keys(e).forEach(function(n){var a=Object.getOwnPropertyDescriptor(e,n);Object.defineProperty(r,n,a.get?a:{enumerable:!0,get:function(){return e[n]}})}),r}var U_={exports:{}},j1={},V_={exports:{}},It={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var dh=Symbol.for("react.element"),DN=Symbol.for("react.portal"),IN=Symbol.for("react.fragment"),RN=Symbol.for("react.strict_mode"),jN=Symbol.for("react.profiler"),MN=Symbol.for("react.provider"),BN=Symbol.for("react.context"),UN=Symbol.for("react.forward_ref"),VN=Symbol.for("react.suspense"),$N=Symbol.for("react.memo"),zN=Symbol.for("react.lazy"),fw=Symbol.iterator;function HN(e){return e===null||typeof e!="object"?null:(e=fw&&e[fw]||e["@@iterator"],typeof e=="function"?e:null)}var $_={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},z_=Object.assign,H_={};function Wu(e,t,r){this.props=e,this.context=t,this.refs=H_,this.updater=r||$_}Wu.prototype.isReactComponent={};Wu.prototype.setState=function(e,t){if(typeof e!="object"&&typeof e!="function"&&e!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,e,t,"setState")};Wu.prototype.forceUpdate=function(e){this.updater.enqueueForceUpdate(this,e,"forceUpdate")};function W_(){}W_.prototype=Wu.prototype;function Px(e,t,r){this.props=e,this.context=t,this.refs=H_,this.updater=r||$_}var Lx=Px.prototype=new W_;Lx.constructor=Px;z_(Lx,Wu.prototype);Lx.isPureReactComponent=!0;var hw=Array.isArray,q_=Object.prototype.hasOwnProperty,Fx={current:null},G_={key:!0,ref:!0,__self:!0,__source:!0};function K_(e,t,r){var n,a={},i=null,s=null;if(t!=null)for(n in t.ref!==void 0&&(s=t.ref),t.key!==void 0&&(i=""+t.key),t)q_.call(t,n)&&!G_.hasOwnProperty(n)&&(a[n]=t[n]);var o=arguments.length-2;if(o===1)a.children=r;else if(1<o){for(var l=Array(o),c=0;c<o;c++)l[c]=arguments[c+2];a.children=l}if(e&&e.defaultProps)for(n in o=e.defaultProps,o)a[n]===void 0&&(a[n]=o[n]);return{$$typeof:dh,type:e,key:i,ref:s,props:a,_owner:Fx.current}}function WN(e,t){return{$$typeof:dh,type:e.type,key:t,ref:e.ref,props:e.props,_owner:e._owner}}function Ox(e){return typeof e=="object"&&e!==null&&e.$$typeof===dh}function qN(e){var t={"=":"=0",":":"=2"};return"$"+e.replace(/[=:]/g,function(r){return t[r]})}var dw=/\/+/g;function vg(e,t){return typeof e=="object"&&e!==null&&e.key!=null?qN(""+e.key):t.toString(36)}function mp(e,t,r,n,a){var i=typeof e;(i==="undefined"||i==="boolean")&&(e=null);var s=!1;if(e===null)s=!0;else switch(i){case"string":case"number":s=!0;break;case"object":switch(e.$$typeof){case dh:case DN:s=!0}}if(s)return s=e,a=a(s),e=n===""?"."+vg(s,0):n,hw(a)?(r="",e!=null&&(r=e.replace(dw,"$&/")+"/"),mp(a,t,r,"",function(c){return c})):a!=null&&(Ox(a)&&(a=WN(a,r+(!a.key||s&&s.key===a.key?"":(""+a.key).replace(dw,"$&/")+"/")+e)),t.push(a)),1;if(s=0,n=n===""?".":n+":",hw(e))for(var o=0;o<e.length;o++){i=e[o];var l=n+vg(i,o);s+=mp(i,t,r,l,a)}else if(l=HN(e),typeof l=="function")for(e=l.call(e),o=0;!(i=e.next()).done;)i=i.value,l=n+vg(i,o++),s+=mp(i,t,r,l,a);else if(i==="object")throw t=String(e),Error("Objects are not valid as a React child (found: "+(t==="[object Object]"?"object with keys {"+Object.keys(e).join(", ")+"}":t)+"). If you meant to render a collection of children, use an array instead.");return s}function Ed(e,t,r){if(e==null)return e;var n=[],a=0;return mp(e,n,"","",function(i){return t.call(r,i,a++)}),n}function GN(e){if(e._status===-1){var t=e._result;t=t(),t.then(function(r){(e._status===0||e._status===-1)&&(e._status=1,e._result=r)},function(r){(e._status===0||e._status===-1)&&(e._status=2,e._result=r)}),e._status===-1&&(e._status=0,e._result=t)}if(e._status===1)return e._result.default;throw e._result}var sa={current:null},gp={transition:null},KN={ReactCurrentDispatcher:sa,ReactCurrentBatchConfig:gp,ReactCurrentOwner:Fx};function X_(){throw Error("act(...) is not supported in production builds of React.")}It.Children={map:Ed,forEach:function(e,t,r){Ed(e,function(){t.apply(this,arguments)},r)},count:function(e){var t=0;return Ed(e,function(){t++}),t},toArray:function(e){return Ed(e,function(t){return t})||[]},only:function(e){if(!Ox(e))throw Error("React.Children.only expected to receive a single React element child.");return e}};It.Component=Wu;It.Fragment=IN;It.Profiler=jN;It.PureComponent=Px;It.StrictMode=RN;It.Suspense=VN;It.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=KN;It.act=X_;It.cloneElement=function(e,t,r){if(e==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+e+".");var n=z_({},e.props),a=e.key,i=e.ref,s=e._owner;if(t!=null){if(t.ref!==void 0&&(i=t.ref,s=Fx.current),t.key!==void 0&&(a=""+t.key),e.type&&e.type.defaultProps)var o=e.type.defaultProps;for(l in t)q_.call(t,l)&&!G_.hasOwnProperty(l)&&(n[l]=t[l]===void 0&&o!==void 0?o[l]:t[l])}var l=arguments.length-2;if(l===1)n.children=r;else if(1<l){o=Array(l);for(var c=0;c<l;c++)o[c]=arguments[c+2];n.children=o}return{$$typeof:dh,type:e.type,key:a,ref:i,props:n,_owner:s}};It.createContext=function(e){return e={$$typeof:BN,_currentValue:e,_currentValue2:e,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},e.Provider={$$typeof:MN,_context:e},e.Consumer=e};It.createElement=K_;It.createFactory=function(e){var t=K_.bind(null,e);return t.type=e,t};It.createRef=function(){return{current:null}};It.forwardRef=function(e){return{$$typeof:UN,render:e}};It.isValidElement=Ox;It.lazy=function(e){return{$$typeof:zN,_payload:{_status:-1,_result:e},_init:GN}};It.memo=function(e,t){return{$$typeof:$N,type:e,compare:t===void 0?null:t}};It.startTransition=function(e){var t=gp.transition;gp.transition={};try{e()}finally{gp.transition=t}};It.unstable_act=X_;It.useCallback=function(e,t){return sa.current.useCallback(e,t)};It.useContext=function(e){return sa.current.useContext(e)};It.useDebugValue=function(){};It.useDeferredValue=function(e){return sa.current.useDeferredValue(e)};It.useEffect=function(e,t){return sa.current.useEffect(e,t)};It.useId=function(){return sa.current.useId()};It.useImperativeHandle=function(e,t,r){return sa.current.useImperativeHandle(e,t,r)};It.useInsertionEffect=function(e,t){return sa.current.useInsertionEffect(e,t)};It.useLayoutEffect=function(e,t){return sa.current.useLayoutEffect(e,t)};It.useMemo=function(e,t){return sa.current.useMemo(e,t)};It.useReducer=function(e,t,r){return sa.current.useReducer(e,t,r)};It.useRef=function(e){return sa.current.useRef(e)};It.useState=function(e){return sa.current.useState(e)};It.useSyncExternalStore=function(e,t,r){return sa.current.useSyncExternalStore(e,t,r)};It.useTransition=function(){return sa.current.useTransition()};It.version="18.3.1";V_.exports=It;var ie=V_.exports;const Fi=M_(ie);/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var XN=ie,YN=Symbol.for("react.element"),JN=Symbol.for("react.fragment"),QN=Object.prototype.hasOwnProperty,ZN=XN.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,e8={key:!0,ref:!0,__self:!0,__source:!0};function Y_(e,t,r){var n,a={},i=null,s=null;r!==void 0&&(i=""+r),t.key!==void 0&&(i=""+t.key),t.ref!==void 0&&(s=t.ref);for(n in t)QN.call(t,n)&&!e8.hasOwnProperty(n)&&(a[n]=t[n]);if(e&&e.defaultProps)for(n in t=e.defaultProps,t)a[n]===void 0&&(a[n]=t[n]);return{$$typeof:YN,type:e,key:i,ref:s,props:a,_owner:ZN.current}}j1.Fragment=JN;j1.jsx=Y_;j1.jsxs=Y_;U_.exports=j1;var _=U_.exports,J_={exports:{}},Ua={},Q_={exports:{}},Z_={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(e){function t(Q,q){var he=Q.length;Q.push(q);e:for(;0<he;){var xe=he-1>>>1,E=Q[xe];if(0<a(E,q))Q[xe]=q,Q[he]=E,he=xe;else break e}}function r(Q){return Q.length===0?null:Q[0]}function n(Q){if(Q.length===0)return null;var q=Q[0],he=Q.pop();if(he!==q){Q[0]=he;e:for(var xe=0,E=Q.length,I=E>>>1;xe<I;){var O=2*(xe+1)-1,j=Q[O],K=O+1,ne=Q[K];if(0>a(j,he))K<E&&0>a(ne,j)?(Q[xe]=ne,Q[K]=he,xe=K):(Q[xe]=j,Q[O]=he,xe=O);else if(K<E&&0>a(ne,he))Q[xe]=ne,Q[K]=he,xe=K;else break e}}return q}function a(Q,q){var he=Q.sortIndex-q.sortIndex;return he!==0?he:Q.id-q.id}if(typeof performance=="object"&&typeof performance.now=="function"){var i=performance;e.unstable_now=function(){return i.now()}}else{var s=Date,o=s.now();e.unstable_now=function(){return s.now()-o}}var l=[],c=[],u=1,f=null,p=3,h=!1,g=!1,m=!1,b=typeof setTimeout=="function"?setTimeout:null,x=typeof clearTimeout=="function"?clearTimeout:null,w=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function y(Q){for(var q=r(c);q!==null;){if(q.callback===null)n(c);else if(q.startTime<=Q)n(c),q.sortIndex=q.expirationTime,t(l,q);else break;q=r(c)}}function A(Q){if(m=!1,y(Q),!g)if(r(l)!==null)g=!0,fe(L);else{var q=r(c);q!==null&&U(A,q.startTime-Q)}}function L(Q,q){g=!1,m&&(m=!1,x(F),F=-1),h=!0;var he=p;try{for(y(q),f=r(l);f!==null&&(!(f.expirationTime>q)||Q&&!N());){var xe=f.callback;if(typeof xe=="function"){f.callback=null,p=f.priorityLevel;var E=xe(f.expirationTime<=q);q=e.unstable_now(),typeof E=="function"?f.callback=E:f===r(l)&&n(l),y(q)}else n(l);f=r(l)}if(f!==null)var I=!0;else{var O=r(c);O!==null&&U(A,O.startTime-q),I=!1}return I}finally{f=null,p=he,h=!1}}var D=!1,T=null,F=-1,R=5,X=-1;function N(){return!(e.unstable_now()-X<R)}function P(){if(T!==null){var Q=e.unstable_now();X=Q;var q=!0;try{q=T(!0,Q)}finally{q?J():(D=!1,T=null)}}else D=!1}var J;if(typeof w=="function")J=function(){w(P)};else if(typeof MessageChannel<"u"){var W=new MessageChannel,se=W.port2;W.port1.onmessage=P,J=function(){se.postMessage(null)}}else J=function(){b(P,0)};function fe(Q){T=Q,D||(D=!0,J())}function U(Q,q){F=b(function(){Q(e.unstable_now())},q)}e.unstable_IdlePriority=5,e.unstable_ImmediatePriority=1,e.unstable_LowPriority=4,e.unstable_NormalPriority=3,e.unstable_Profiling=null,e.unstable_UserBlockingPriority=2,e.unstable_cancelCallback=function(Q){Q.callback=null},e.unstable_continueExecution=function(){g||h||(g=!0,fe(L))},e.unstable_forceFrameRate=function(Q){0>Q||125<Q?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):R=0<Q?Math.floor(1e3/Q):5},e.unstable_getCurrentPriorityLevel=function(){return p},e.unstable_getFirstCallbackNode=function(){return r(l)},e.unstable_next=function(Q){switch(p){case 1:case 2:case 3:var q=3;break;default:q=p}var he=p;p=q;try{return Q()}finally{p=he}},e.unstable_pauseExecution=function(){},e.unstable_requestPaint=function(){},e.unstable_runWithPriority=function(Q,q){switch(Q){case 1:case 2:case 3:case 4:case 5:break;default:Q=3}var he=p;p=Q;try{return q()}finally{p=he}},e.unstable_scheduleCallback=function(Q,q,he){var xe=e.unstable_now();switch(typeof he=="object"&&he!==null?(he=he.delay,he=typeof he=="number"&&0<he?xe+he:xe):he=xe,Q){case 1:var E=-1;break;case 2:E=250;break;case 5:E=1073741823;break;case 4:E=1e4;break;default:E=5e3}return E=he+E,Q={id:u++,callback:q,priorityLevel:Q,startTime:he,expirationTime:E,sortIndex:-1},he>xe?(Q.sortIndex=he,t(c,Q),r(l)===null&&Q===r(c)&&(m?(x(F),F=-1):m=!0,U(A,he-xe))):(Q.sortIndex=E,t(l,Q),g||h||(g=!0,fe(L))),Q},e.unstable_shouldYield=N,e.unstable_wrapCallback=function(Q){var q=p;return function(){var he=p;p=q;try{return Q.apply(this,arguments)}finally{p=he}}}})(Z_);Q_.exports=Z_;var t8=Q_.exports;/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var r8=ie,ja=t8;function He(e){for(var t="https://reactjs.org/docs/error-decoder.html?invariant="+e,r=1;r<arguments.length;r++)t+="&args[]="+encodeURIComponent(arguments[r]);return"Minified React error #"+e+"; visit "+t+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var eS=new Set,O0={};function ac(e,t){Lu(e,t),Lu(e+"Capture",t)}function Lu(e,t){for(O0[e]=t,e=0;e<t.length;e++)eS.add(t[e])}var qs=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),I2=Object.prototype.hasOwnProperty,n8=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,pw={},mw={};function a8(e){return I2.call(mw,e)?!0:I2.call(pw,e)?!1:n8.test(e)?mw[e]=!0:(pw[e]=!0,!1)}function i8(e,t,r,n){if(r!==null&&r.type===0)return!1;switch(typeof t){case"function":case"symbol":return!0;case"boolean":return n?!1:r!==null?!r.acceptsBooleans:(e=e.toLowerCase().slice(0,5),e!=="data-"&&e!=="aria-");default:return!1}}function s8(e,t,r,n){if(t===null||typeof t>"u"||i8(e,t,r,n))return!0;if(n)return!1;if(r!==null)switch(r.type){case 3:return!t;case 4:return t===!1;case 5:return isNaN(t);case 6:return isNaN(t)||1>t}return!1}function oa(e,t,r,n,a,i,s){this.acceptsBooleans=t===2||t===3||t===4,this.attributeName=n,this.attributeNamespace=a,this.mustUseProperty=r,this.propertyName=e,this.type=t,this.sanitizeURL=i,this.removeEmptyString=s}var En={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(e){En[e]=new oa(e,0,!1,e,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(e){var t=e[0];En[t]=new oa(t,1,!1,e[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(e){En[e]=new oa(e,2,!1,e.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(e){En[e]=new oa(e,2,!1,e,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(e){En[e]=new oa(e,3,!1,e.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(e){En[e]=new oa(e,3,!0,e,null,!1,!1)});["capture","download"].forEach(function(e){En[e]=new oa(e,4,!1,e,null,!1,!1)});["cols","rows","size","span"].forEach(function(e){En[e]=new oa(e,6,!1,e,null,!1,!1)});["rowSpan","start"].forEach(function(e){En[e]=new oa(e,5,!1,e.toLowerCase(),null,!1,!1)});var Dx=/[\-:]([a-z])/g;function Ix(e){return e[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(e){var t=e.replace(Dx,Ix);En[t]=new oa(t,1,!1,e,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(e){var t=e.replace(Dx,Ix);En[t]=new oa(t,1,!1,e,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(e){var t=e.replace(Dx,Ix);En[t]=new oa(t,1,!1,e,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(e){En[e]=new oa(e,1,!1,e.toLowerCase(),null,!1,!1)});En.xlinkHref=new oa("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(e){En[e]=new oa(e,1,!1,e.toLowerCase(),null,!0,!0)});function Rx(e,t,r,n){var a=En.hasOwnProperty(t)?En[t]:null;(a!==null?a.type!==0:n||!(2<t.length)||t[0]!=="o"&&t[0]!=="O"||t[1]!=="n"&&t[1]!=="N")&&(s8(t,r,a,n)&&(r=null),n||a===null?a8(t)&&(r===null?e.removeAttribute(t):e.setAttribute(t,""+r)):a.mustUseProperty?e[a.propertyName]=r===null?a.type===3?!1:"":r:(t=a.attributeName,n=a.attributeNamespace,r===null?e.removeAttribute(t):(a=a.type,r=a===3||a===4&&r===!0?"":""+r,n?e.setAttributeNS(n,t,r):e.setAttribute(t,r))))}var to=r8.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,Ad=Symbol.for("react.element"),Qc=Symbol.for("react.portal"),Zc=Symbol.for("react.fragment"),jx=Symbol.for("react.strict_mode"),R2=Symbol.for("react.profiler"),tS=Symbol.for("react.provider"),rS=Symbol.for("react.context"),Mx=Symbol.for("react.forward_ref"),j2=Symbol.for("react.suspense"),M2=Symbol.for("react.suspense_list"),Bx=Symbol.for("react.memo"),Eo=Symbol.for("react.lazy"),nS=Symbol.for("react.offscreen"),gw=Symbol.iterator;function Ff(e){return e===null||typeof e!="object"?null:(e=gw&&e[gw]||e["@@iterator"],typeof e=="function"?e:null)}var Ar=Object.assign,xg;function qf(e){if(xg===void 0)try{throw Error()}catch(r){var t=r.stack.trim().match(/\n( *(at )?)/);xg=t&&t[1]||""}return`
`+xg+e}var yg=!1;function wg(e,t){if(!e||yg)return"";yg=!0;var r=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(t)if(t=function(){throw Error()},Object.defineProperty(t.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(t,[])}catch(c){var n=c}Reflect.construct(e,[],t)}else{try{t.call()}catch(c){n=c}e.call(t.prototype)}else{try{throw Error()}catch(c){n=c}e()}}catch(c){if(c&&n&&typeof c.stack=="string"){for(var a=c.stack.split(`
`),i=n.stack.split(`
`),s=a.length-1,o=i.length-1;1<=s&&0<=o&&a[s]!==i[o];)o--;for(;1<=s&&0<=o;s--,o--)if(a[s]!==i[o]){if(s!==1||o!==1)do if(s--,o--,0>o||a[s]!==i[o]){var l=`
`+a[s].replace(" at new "," at ");return e.displayName&&l.includes("<anonymous>")&&(l=l.replace("<anonymous>",e.displayName)),l}while(1<=s&&0<=o);break}}}finally{yg=!1,Error.prepareStackTrace=r}return(e=e?e.displayName||e.name:"")?qf(e):""}function o8(e){switch(e.tag){case 5:return qf(e.type);case 16:return qf("Lazy");case 13:return qf("Suspense");case 19:return qf("SuspenseList");case 0:case 2:case 15:return e=wg(e.type,!1),e;case 11:return e=wg(e.type.render,!1),e;case 1:return e=wg(e.type,!0),e;default:return""}}function B2(e){if(e==null)return null;if(typeof e=="function")return e.displayName||e.name||null;if(typeof e=="string")return e;switch(e){case Zc:return"Fragment";case Qc:return"Portal";case R2:return"Profiler";case jx:return"StrictMode";case j2:return"Suspense";case M2:return"SuspenseList"}if(typeof e=="object")switch(e.$$typeof){case rS:return(e.displayName||"Context")+".Consumer";case tS:return(e._context.displayName||"Context")+".Provider";case Mx:var t=e.render;return e=e.displayName,e||(e=t.displayName||t.name||"",e=e!==""?"ForwardRef("+e+")":"ForwardRef"),e;case Bx:return t=e.displayName||null,t!==null?t:B2(e.type)||"Memo";case Eo:t=e._payload,e=e._init;try{return B2(e(t))}catch{}}return null}function l8(e){var t=e.type;switch(e.tag){case 24:return"Cache";case 9:return(t.displayName||"Context")+".Consumer";case 10:return(t._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return e=t.render,e=e.displayName||e.name||"",t.displayName||(e!==""?"ForwardRef("+e+")":"ForwardRef");case 7:return"Fragment";case 5:return t;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return B2(t);case 8:return t===jx?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof t=="function")return t.displayName||t.name||null;if(typeof t=="string")return t}return null}function Jo(e){switch(typeof e){case"boolean":case"number":case"string":case"undefined":return e;case"object":return e;default:return""}}function aS(e){var t=e.type;return(e=e.nodeName)&&e.toLowerCase()==="input"&&(t==="checkbox"||t==="radio")}function c8(e){var t=aS(e)?"checked":"value",r=Object.getOwnPropertyDescriptor(e.constructor.prototype,t),n=""+e[t];if(!e.hasOwnProperty(t)&&typeof r<"u"&&typeof r.get=="function"&&typeof r.set=="function"){var a=r.get,i=r.set;return Object.defineProperty(e,t,{configurable:!0,get:function(){return a.call(this)},set:function(s){n=""+s,i.call(this,s)}}),Object.defineProperty(e,t,{enumerable:r.enumerable}),{getValue:function(){return n},setValue:function(s){n=""+s},stopTracking:function(){e._valueTracker=null,delete e[t]}}}}function Td(e){e._valueTracker||(e._valueTracker=c8(e))}function iS(e){if(!e)return!1;var t=e._valueTracker;if(!t)return!0;var r=t.getValue(),n="";return e&&(n=aS(e)?e.checked?"true":"false":e.value),e=n,e!==r?(t.setValue(e),!0):!1}function Rp(e){if(e=e||(typeof document<"u"?document:void 0),typeof e>"u")return null;try{return e.activeElement||e.body}catch{return e.body}}function U2(e,t){var r=t.checked;return Ar({},t,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:r??e._wrapperState.initialChecked})}function vw(e,t){var r=t.defaultValue==null?"":t.defaultValue,n=t.checked!=null?t.checked:t.defaultChecked;r=Jo(t.value!=null?t.value:r),e._wrapperState={initialChecked:n,initialValue:r,controlled:t.type==="checkbox"||t.type==="radio"?t.checked!=null:t.value!=null}}function sS(e,t){t=t.checked,t!=null&&Rx(e,"checked",t,!1)}function V2(e,t){sS(e,t);var r=Jo(t.value),n=t.type;if(r!=null)n==="number"?(r===0&&e.value===""||e.value!=r)&&(e.value=""+r):e.value!==""+r&&(e.value=""+r);else if(n==="submit"||n==="reset"){e.removeAttribute("value");return}t.hasOwnProperty("value")?$2(e,t.type,r):t.hasOwnProperty("defaultValue")&&$2(e,t.type,Jo(t.defaultValue)),t.checked==null&&t.defaultChecked!=null&&(e.defaultChecked=!!t.defaultChecked)}function xw(e,t,r){if(t.hasOwnProperty("value")||t.hasOwnProperty("defaultValue")){var n=t.type;if(!(n!=="submit"&&n!=="reset"||t.value!==void 0&&t.value!==null))return;t=""+e._wrapperState.initialValue,r||t===e.value||(e.value=t),e.defaultValue=t}r=e.name,r!==""&&(e.name=""),e.defaultChecked=!!e._wrapperState.initialChecked,r!==""&&(e.name=r)}function $2(e,t,r){(t!=="number"||Rp(e.ownerDocument)!==e)&&(r==null?e.defaultValue=""+e._wrapperState.initialValue:e.defaultValue!==""+r&&(e.defaultValue=""+r))}var Gf=Array.isArray;function vu(e,t,r,n){if(e=e.options,t){t={};for(var a=0;a<r.length;a++)t["$"+r[a]]=!0;for(r=0;r<e.length;r++)a=t.hasOwnProperty("$"+e[r].value),e[r].selected!==a&&(e[r].selected=a),a&&n&&(e[r].defaultSelected=!0)}else{for(r=""+Jo(r),t=null,a=0;a<e.length;a++){if(e[a].value===r){e[a].selected=!0,n&&(e[a].defaultSelected=!0);return}t!==null||e[a].disabled||(t=e[a])}t!==null&&(t.selected=!0)}}function z2(e,t){if(t.dangerouslySetInnerHTML!=null)throw Error(He(91));return Ar({},t,{value:void 0,defaultValue:void 0,children:""+e._wrapperState.initialValue})}function yw(e,t){var r=t.value;if(r==null){if(r=t.children,t=t.defaultValue,r!=null){if(t!=null)throw Error(He(92));if(Gf(r)){if(1<r.length)throw Error(He(93));r=r[0]}t=r}t==null&&(t=""),r=t}e._wrapperState={initialValue:Jo(r)}}function oS(e,t){var r=Jo(t.value),n=Jo(t.defaultValue);r!=null&&(r=""+r,r!==e.value&&(e.value=r),t.defaultValue==null&&e.defaultValue!==r&&(e.defaultValue=r)),n!=null&&(e.defaultValue=""+n)}function ww(e){var t=e.textContent;t===e._wrapperState.initialValue&&t!==""&&t!==null&&(e.value=t)}function lS(e){switch(e){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function H2(e,t){return e==null||e==="http://www.w3.org/1999/xhtml"?lS(t):e==="http://www.w3.org/2000/svg"&&t==="foreignObject"?"http://www.w3.org/1999/xhtml":e}var Cd,cS=function(e){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(t,r,n,a){MSApp.execUnsafeLocalFunction(function(){return e(t,r,n,a)})}:e}(function(e,t){if(e.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in e)e.innerHTML=t;else{for(Cd=Cd||document.createElement("div"),Cd.innerHTML="<svg>"+t.valueOf().toString()+"</svg>",t=Cd.firstChild;e.firstChild;)e.removeChild(e.firstChild);for(;t.firstChild;)e.appendChild(t.firstChild)}});function D0(e,t){if(t){var r=e.firstChild;if(r&&r===e.lastChild&&r.nodeType===3){r.nodeValue=t;return}}e.textContent=t}var r0={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},u8=["Webkit","ms","Moz","O"];Object.keys(r0).forEach(function(e){u8.forEach(function(t){t=t+e.charAt(0).toUpperCase()+e.substring(1),r0[t]=r0[e]})});function uS(e,t,r){return t==null||typeof t=="boolean"||t===""?"":r||typeof t!="number"||t===0||r0.hasOwnProperty(e)&&r0[e]?(""+t).trim():t+"px"}function fS(e,t){e=e.style;for(var r in t)if(t.hasOwnProperty(r)){var n=r.indexOf("--")===0,a=uS(r,t[r],n);r==="float"&&(r="cssFloat"),n?e.setProperty(r,a):e[r]=a}}var f8=Ar({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function W2(e,t){if(t){if(f8[e]&&(t.children!=null||t.dangerouslySetInnerHTML!=null))throw Error(He(137,e));if(t.dangerouslySetInnerHTML!=null){if(t.children!=null)throw Error(He(60));if(typeof t.dangerouslySetInnerHTML!="object"||!("__html"in t.dangerouslySetInnerHTML))throw Error(He(61))}if(t.style!=null&&typeof t.style!="object")throw Error(He(62))}}function q2(e,t){if(e.indexOf("-")===-1)return typeof t.is=="string";switch(e){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var G2=null;function Ux(e){return e=e.target||e.srcElement||window,e.correspondingUseElement&&(e=e.correspondingUseElement),e.nodeType===3?e.parentNode:e}var K2=null,xu=null,yu=null;function bw(e){if(e=gh(e)){if(typeof K2!="function")throw Error(He(280));var t=e.stateNode;t&&(t=$1(t),K2(e.stateNode,e.type,t))}}function hS(e){xu?yu?yu.push(e):yu=[e]:xu=e}function dS(){if(xu){var e=xu,t=yu;if(yu=xu=null,bw(e),t)for(e=0;e<t.length;e++)bw(t[e])}}function pS(e,t){return e(t)}function mS(){}var bg=!1;function gS(e,t,r){if(bg)return e(t,r);bg=!0;try{return pS(e,t,r)}finally{bg=!1,(xu!==null||yu!==null)&&(mS(),dS())}}function I0(e,t){var r=e.stateNode;if(r===null)return null;var n=$1(r);if(n===null)return null;r=n[t];e:switch(t){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(n=!n.disabled)||(e=e.type,n=!(e==="button"||e==="input"||e==="select"||e==="textarea")),e=!n;break e;default:e=!1}if(e)return null;if(r&&typeof r!="function")throw Error(He(231,t,typeof r));return r}var X2=!1;if(qs)try{var Of={};Object.defineProperty(Of,"passive",{get:function(){X2=!0}}),window.addEventListener("test",Of,Of),window.removeEventListener("test",Of,Of)}catch{X2=!1}function h8(e,t,r,n,a,i,s,o,l){var c=Array.prototype.slice.call(arguments,3);try{t.apply(r,c)}catch(u){this.onError(u)}}var n0=!1,jp=null,Mp=!1,Y2=null,d8={onError:function(e){n0=!0,jp=e}};function p8(e,t,r,n,a,i,s,o,l){n0=!1,jp=null,h8.apply(d8,arguments)}function m8(e,t,r,n,a,i,s,o,l){if(p8.apply(this,arguments),n0){if(n0){var c=jp;n0=!1,jp=null}else throw Error(He(198));Mp||(Mp=!0,Y2=c)}}function ic(e){var t=e,r=e;if(e.alternate)for(;t.return;)t=t.return;else{e=t;do t=e,t.flags&4098&&(r=t.return),e=t.return;while(e)}return t.tag===3?r:null}function vS(e){if(e.tag===13){var t=e.memoizedState;if(t===null&&(e=e.alternate,e!==null&&(t=e.memoizedState)),t!==null)return t.dehydrated}return null}function _w(e){if(ic(e)!==e)throw Error(He(188))}function g8(e){var t=e.alternate;if(!t){if(t=ic(e),t===null)throw Error(He(188));return t!==e?null:e}for(var r=e,n=t;;){var a=r.return;if(a===null)break;var i=a.alternate;if(i===null){if(n=a.return,n!==null){r=n;continue}break}if(a.child===i.child){for(i=a.child;i;){if(i===r)return _w(a),e;if(i===n)return _w(a),t;i=i.sibling}throw Error(He(188))}if(r.return!==n.return)r=a,n=i;else{for(var s=!1,o=a.child;o;){if(o===r){s=!0,r=a,n=i;break}if(o===n){s=!0,n=a,r=i;break}o=o.sibling}if(!s){for(o=i.child;o;){if(o===r){s=!0,r=i,n=a;break}if(o===n){s=!0,n=i,r=a;break}o=o.sibling}if(!s)throw Error(He(189))}}if(r.alternate!==n)throw Error(He(190))}if(r.tag!==3)throw Error(He(188));return r.stateNode.current===r?e:t}function xS(e){return e=g8(e),e!==null?yS(e):null}function yS(e){if(e.tag===5||e.tag===6)return e;for(e=e.child;e!==null;){var t=yS(e);if(t!==null)return t;e=e.sibling}return null}var wS=ja.unstable_scheduleCallback,Sw=ja.unstable_cancelCallback,v8=ja.unstable_shouldYield,x8=ja.unstable_requestPaint,Br=ja.unstable_now,y8=ja.unstable_getCurrentPriorityLevel,Vx=ja.unstable_ImmediatePriority,bS=ja.unstable_UserBlockingPriority,Bp=ja.unstable_NormalPriority,w8=ja.unstable_LowPriority,_S=ja.unstable_IdlePriority,M1=null,os=null;function b8(e){if(os&&typeof os.onCommitFiberRoot=="function")try{os.onCommitFiberRoot(M1,e,void 0,(e.current.flags&128)===128)}catch{}}var ji=Math.clz32?Math.clz32:k8,_8=Math.log,S8=Math.LN2;function k8(e){return e>>>=0,e===0?32:31-(_8(e)/S8|0)|0}var Nd=64,Pd=4194304;function Kf(e){switch(e&-e){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return e&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return e}}function Up(e,t){var r=e.pendingLanes;if(r===0)return 0;var n=0,a=e.suspendedLanes,i=e.pingedLanes,s=r&268435455;if(s!==0){var o=s&~a;o!==0?n=Kf(o):(i&=s,i!==0&&(n=Kf(i)))}else s=r&~a,s!==0?n=Kf(s):i!==0&&(n=Kf(i));if(n===0)return 0;if(t!==0&&t!==n&&!(t&a)&&(a=n&-n,i=t&-t,a>=i||a===16&&(i&4194240)!==0))return t;if(n&4&&(n|=r&16),t=e.entangledLanes,t!==0)for(e=e.entanglements,t&=n;0<t;)r=31-ji(t),a=1<<r,n|=e[r],t&=~a;return n}function E8(e,t){switch(e){case 1:case 2:case 4:return t+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function A8(e,t){for(var r=e.suspendedLanes,n=e.pingedLanes,a=e.expirationTimes,i=e.pendingLanes;0<i;){var s=31-ji(i),o=1<<s,l=a[s];l===-1?(!(o&r)||o&n)&&(a[s]=E8(o,t)):l<=t&&(e.expiredLanes|=o),i&=~o}}function J2(e){return e=e.pendingLanes&-1073741825,e!==0?e:e&1073741824?1073741824:0}function SS(){var e=Nd;return Nd<<=1,!(Nd&4194240)&&(Nd=64),e}function _g(e){for(var t=[],r=0;31>r;r++)t.push(e);return t}function ph(e,t,r){e.pendingLanes|=t,t!==536870912&&(e.suspendedLanes=0,e.pingedLanes=0),e=e.eventTimes,t=31-ji(t),e[t]=r}function T8(e,t){var r=e.pendingLanes&~t;e.pendingLanes=t,e.suspendedLanes=0,e.pingedLanes=0,e.expiredLanes&=t,e.mutableReadLanes&=t,e.entangledLanes&=t,t=e.entanglements;var n=e.eventTimes;for(e=e.expirationTimes;0<r;){var a=31-ji(r),i=1<<a;t[a]=0,n[a]=-1,e[a]=-1,r&=~i}}function $x(e,t){var r=e.entangledLanes|=t;for(e=e.entanglements;r;){var n=31-ji(r),a=1<<n;a&t|e[n]&t&&(e[n]|=t),r&=~a}}var rr=0;function kS(e){return e&=-e,1<e?4<e?e&268435455?16:536870912:4:1}var ES,zx,AS,TS,CS,Q2=!1,Ld=[],Vo=null,$o=null,zo=null,R0=new Map,j0=new Map,No=[],C8="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function kw(e,t){switch(e){case"focusin":case"focusout":Vo=null;break;case"dragenter":case"dragleave":$o=null;break;case"mouseover":case"mouseout":zo=null;break;case"pointerover":case"pointerout":R0.delete(t.pointerId);break;case"gotpointercapture":case"lostpointercapture":j0.delete(t.pointerId)}}function Df(e,t,r,n,a,i){return e===null||e.nativeEvent!==i?(e={blockedOn:t,domEventName:r,eventSystemFlags:n,nativeEvent:i,targetContainers:[a]},t!==null&&(t=gh(t),t!==null&&zx(t)),e):(e.eventSystemFlags|=n,t=e.targetContainers,a!==null&&t.indexOf(a)===-1&&t.push(a),e)}function N8(e,t,r,n,a){switch(t){case"focusin":return Vo=Df(Vo,e,t,r,n,a),!0;case"dragenter":return $o=Df($o,e,t,r,n,a),!0;case"mouseover":return zo=Df(zo,e,t,r,n,a),!0;case"pointerover":var i=a.pointerId;return R0.set(i,Df(R0.get(i)||null,e,t,r,n,a)),!0;case"gotpointercapture":return i=a.pointerId,j0.set(i,Df(j0.get(i)||null,e,t,r,n,a)),!0}return!1}function NS(e){var t=Rl(e.target);if(t!==null){var r=ic(t);if(r!==null){if(t=r.tag,t===13){if(t=vS(r),t!==null){e.blockedOn=t,CS(e.priority,function(){AS(r)});return}}else if(t===3&&r.stateNode.current.memoizedState.isDehydrated){e.blockedOn=r.tag===3?r.stateNode.containerInfo:null;return}}}e.blockedOn=null}function vp(e){if(e.blockedOn!==null)return!1;for(var t=e.targetContainers;0<t.length;){var r=Z2(e.domEventName,e.eventSystemFlags,t[0],e.nativeEvent);if(r===null){r=e.nativeEvent;var n=new r.constructor(r.type,r);G2=n,r.target.dispatchEvent(n),G2=null}else return t=gh(r),t!==null&&zx(t),e.blockedOn=r,!1;t.shift()}return!0}function Ew(e,t,r){vp(e)&&r.delete(t)}function P8(){Q2=!1,Vo!==null&&vp(Vo)&&(Vo=null),$o!==null&&vp($o)&&($o=null),zo!==null&&vp(zo)&&(zo=null),R0.forEach(Ew),j0.forEach(Ew)}function If(e,t){e.blockedOn===t&&(e.blockedOn=null,Q2||(Q2=!0,ja.unstable_scheduleCallback(ja.unstable_NormalPriority,P8)))}function M0(e){function t(a){return If(a,e)}if(0<Ld.length){If(Ld[0],e);for(var r=1;r<Ld.length;r++){var n=Ld[r];n.blockedOn===e&&(n.blockedOn=null)}}for(Vo!==null&&If(Vo,e),$o!==null&&If($o,e),zo!==null&&If(zo,e),R0.forEach(t),j0.forEach(t),r=0;r<No.length;r++)n=No[r],n.blockedOn===e&&(n.blockedOn=null);for(;0<No.length&&(r=No[0],r.blockedOn===null);)NS(r),r.blockedOn===null&&No.shift()}var wu=to.ReactCurrentBatchConfig,Vp=!0;function L8(e,t,r,n){var a=rr,i=wu.transition;wu.transition=null;try{rr=1,Hx(e,t,r,n)}finally{rr=a,wu.transition=i}}function F8(e,t,r,n){var a=rr,i=wu.transition;wu.transition=null;try{rr=4,Hx(e,t,r,n)}finally{rr=a,wu.transition=i}}function Hx(e,t,r,n){if(Vp){var a=Z2(e,t,r,n);if(a===null)Fg(e,t,n,$p,r),kw(e,n);else if(N8(a,e,t,r,n))n.stopPropagation();else if(kw(e,n),t&4&&-1<C8.indexOf(e)){for(;a!==null;){var i=gh(a);if(i!==null&&ES(i),i=Z2(e,t,r,n),i===null&&Fg(e,t,n,$p,r),i===a)break;a=i}a!==null&&n.stopPropagation()}else Fg(e,t,n,null,r)}}var $p=null;function Z2(e,t,r,n){if($p=null,e=Ux(n),e=Rl(e),e!==null)if(t=ic(e),t===null)e=null;else if(r=t.tag,r===13){if(e=vS(t),e!==null)return e;e=null}else if(r===3){if(t.stateNode.current.memoizedState.isDehydrated)return t.tag===3?t.stateNode.containerInfo:null;e=null}else t!==e&&(e=null);return $p=e,null}function PS(e){switch(e){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(y8()){case Vx:return 1;case bS:return 4;case Bp:case w8:return 16;case _S:return 536870912;default:return 16}default:return 16}}var Io=null,Wx=null,xp=null;function LS(){if(xp)return xp;var e,t=Wx,r=t.length,n,a="value"in Io?Io.value:Io.textContent,i=a.length;for(e=0;e<r&&t[e]===a[e];e++);var s=r-e;for(n=1;n<=s&&t[r-n]===a[i-n];n++);return xp=a.slice(e,1<n?1-n:void 0)}function yp(e){var t=e.keyCode;return"charCode"in e?(e=e.charCode,e===0&&t===13&&(e=13)):e=t,e===10&&(e=13),32<=e||e===13?e:0}function Fd(){return!0}function Aw(){return!1}function Va(e){function t(r,n,a,i,s){this._reactName=r,this._targetInst=a,this.type=n,this.nativeEvent=i,this.target=s,this.currentTarget=null;for(var o in e)e.hasOwnProperty(o)&&(r=e[o],this[o]=r?r(i):i[o]);return this.isDefaultPrevented=(i.defaultPrevented!=null?i.defaultPrevented:i.returnValue===!1)?Fd:Aw,this.isPropagationStopped=Aw,this}return Ar(t.prototype,{preventDefault:function(){this.defaultPrevented=!0;var r=this.nativeEvent;r&&(r.preventDefault?r.preventDefault():typeof r.returnValue!="unknown"&&(r.returnValue=!1),this.isDefaultPrevented=Fd)},stopPropagation:function(){var r=this.nativeEvent;r&&(r.stopPropagation?r.stopPropagation():typeof r.cancelBubble!="unknown"&&(r.cancelBubble=!0),this.isPropagationStopped=Fd)},persist:function(){},isPersistent:Fd}),t}var qu={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(e){return e.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},qx=Va(qu),mh=Ar({},qu,{view:0,detail:0}),O8=Va(mh),Sg,kg,Rf,B1=Ar({},mh,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:Gx,button:0,buttons:0,relatedTarget:function(e){return e.relatedTarget===void 0?e.fromElement===e.srcElement?e.toElement:e.fromElement:e.relatedTarget},movementX:function(e){return"movementX"in e?e.movementX:(e!==Rf&&(Rf&&e.type==="mousemove"?(Sg=e.screenX-Rf.screenX,kg=e.screenY-Rf.screenY):kg=Sg=0,Rf=e),Sg)},movementY:function(e){return"movementY"in e?e.movementY:kg}}),Tw=Va(B1),D8=Ar({},B1,{dataTransfer:0}),I8=Va(D8),R8=Ar({},mh,{relatedTarget:0}),Eg=Va(R8),j8=Ar({},qu,{animationName:0,elapsedTime:0,pseudoElement:0}),M8=Va(j8),B8=Ar({},qu,{clipboardData:function(e){return"clipboardData"in e?e.clipboardData:window.clipboardData}}),U8=Va(B8),V8=Ar({},qu,{data:0}),Cw=Va(V8),$8={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},z8={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},H8={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function W8(e){var t=this.nativeEvent;return t.getModifierState?t.getModifierState(e):(e=H8[e])?!!t[e]:!1}function Gx(){return W8}var q8=Ar({},mh,{key:function(e){if(e.key){var t=$8[e.key]||e.key;if(t!=="Unidentified")return t}return e.type==="keypress"?(e=yp(e),e===13?"Enter":String.fromCharCode(e)):e.type==="keydown"||e.type==="keyup"?z8[e.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:Gx,charCode:function(e){return e.type==="keypress"?yp(e):0},keyCode:function(e){return e.type==="keydown"||e.type==="keyup"?e.keyCode:0},which:function(e){return e.type==="keypress"?yp(e):e.type==="keydown"||e.type==="keyup"?e.keyCode:0}}),G8=Va(q8),K8=Ar({},B1,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),Nw=Va(K8),X8=Ar({},mh,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:Gx}),Y8=Va(X8),J8=Ar({},qu,{propertyName:0,elapsedTime:0,pseudoElement:0}),Q8=Va(J8),Z8=Ar({},B1,{deltaX:function(e){return"deltaX"in e?e.deltaX:"wheelDeltaX"in e?-e.wheelDeltaX:0},deltaY:function(e){return"deltaY"in e?e.deltaY:"wheelDeltaY"in e?-e.wheelDeltaY:"wheelDelta"in e?-e.wheelDelta:0},deltaZ:0,deltaMode:0}),eP=Va(Z8),tP=[9,13,27,32],Kx=qs&&"CompositionEvent"in window,a0=null;qs&&"documentMode"in document&&(a0=document.documentMode);var rP=qs&&"TextEvent"in window&&!a0,FS=qs&&(!Kx||a0&&8<a0&&11>=a0),Pw=" ",Lw=!1;function OS(e,t){switch(e){case"keyup":return tP.indexOf(t.keyCode)!==-1;case"keydown":return t.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function DS(e){return e=e.detail,typeof e=="object"&&"data"in e?e.data:null}var eu=!1;function nP(e,t){switch(e){case"compositionend":return DS(t);case"keypress":return t.which!==32?null:(Lw=!0,Pw);case"textInput":return e=t.data,e===Pw&&Lw?null:e;default:return null}}function aP(e,t){if(eu)return e==="compositionend"||!Kx&&OS(e,t)?(e=LS(),xp=Wx=Io=null,eu=!1,e):null;switch(e){case"paste":return null;case"keypress":if(!(t.ctrlKey||t.altKey||t.metaKey)||t.ctrlKey&&t.altKey){if(t.char&&1<t.char.length)return t.char;if(t.which)return String.fromCharCode(t.which)}return null;case"compositionend":return FS&&t.locale!=="ko"?null:t.data;default:return null}}var iP={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function Fw(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t==="input"?!!iP[e.type]:t==="textarea"}function IS(e,t,r,n){hS(n),t=zp(t,"onChange"),0<t.length&&(r=new qx("onChange","change",null,r,n),e.push({event:r,listeners:t}))}var i0=null,B0=null;function sP(e){qS(e,0)}function U1(e){var t=nu(e);if(iS(t))return e}function oP(e,t){if(e==="change")return t}var RS=!1;if(qs){var Ag;if(qs){var Tg="oninput"in document;if(!Tg){var Ow=document.createElement("div");Ow.setAttribute("oninput","return;"),Tg=typeof Ow.oninput=="function"}Ag=Tg}else Ag=!1;RS=Ag&&(!document.documentMode||9<document.documentMode)}function Dw(){i0&&(i0.detachEvent("onpropertychange",jS),B0=i0=null)}function jS(e){if(e.propertyName==="value"&&U1(B0)){var t=[];IS(t,B0,e,Ux(e)),gS(sP,t)}}function lP(e,t,r){e==="focusin"?(Dw(),i0=t,B0=r,i0.attachEvent("onpropertychange",jS)):e==="focusout"&&Dw()}function cP(e){if(e==="selectionchange"||e==="keyup"||e==="keydown")return U1(B0)}function uP(e,t){if(e==="click")return U1(t)}function fP(e,t){if(e==="input"||e==="change")return U1(t)}function hP(e,t){return e===t&&(e!==0||1/e===1/t)||e!==e&&t!==t}var Vi=typeof Object.is=="function"?Object.is:hP;function U0(e,t){if(Vi(e,t))return!0;if(typeof e!="object"||e===null||typeof t!="object"||t===null)return!1;var r=Object.keys(e),n=Object.keys(t);if(r.length!==n.length)return!1;for(n=0;n<r.length;n++){var a=r[n];if(!I2.call(t,a)||!Vi(e[a],t[a]))return!1}return!0}function Iw(e){for(;e&&e.firstChild;)e=e.firstChild;return e}function Rw(e,t){var r=Iw(e);e=0;for(var n;r;){if(r.nodeType===3){if(n=e+r.textContent.length,e<=t&&n>=t)return{node:r,offset:t-e};e=n}e:{for(;r;){if(r.nextSibling){r=r.nextSibling;break e}r=r.parentNode}r=void 0}r=Iw(r)}}function MS(e,t){return e&&t?e===t?!0:e&&e.nodeType===3?!1:t&&t.nodeType===3?MS(e,t.parentNode):"contains"in e?e.contains(t):e.compareDocumentPosition?!!(e.compareDocumentPosition(t)&16):!1:!1}function BS(){for(var e=window,t=Rp();t instanceof e.HTMLIFrameElement;){try{var r=typeof t.contentWindow.location.href=="string"}catch{r=!1}if(r)e=t.contentWindow;else break;t=Rp(e.document)}return t}function Xx(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t&&(t==="input"&&(e.type==="text"||e.type==="search"||e.type==="tel"||e.type==="url"||e.type==="password")||t==="textarea"||e.contentEditable==="true")}function dP(e){var t=BS(),r=e.focusedElem,n=e.selectionRange;if(t!==r&&r&&r.ownerDocument&&MS(r.ownerDocument.documentElement,r)){if(n!==null&&Xx(r)){if(t=n.start,e=n.end,e===void 0&&(e=t),"selectionStart"in r)r.selectionStart=t,r.selectionEnd=Math.min(e,r.value.length);else if(e=(t=r.ownerDocument||document)&&t.defaultView||window,e.getSelection){e=e.getSelection();var a=r.textContent.length,i=Math.min(n.start,a);n=n.end===void 0?i:Math.min(n.end,a),!e.extend&&i>n&&(a=n,n=i,i=a),a=Rw(r,i);var s=Rw(r,n);a&&s&&(e.rangeCount!==1||e.anchorNode!==a.node||e.anchorOffset!==a.offset||e.focusNode!==s.node||e.focusOffset!==s.offset)&&(t=t.createRange(),t.setStart(a.node,a.offset),e.removeAllRanges(),i>n?(e.addRange(t),e.extend(s.node,s.offset)):(t.setEnd(s.node,s.offset),e.addRange(t)))}}for(t=[],e=r;e=e.parentNode;)e.nodeType===1&&t.push({element:e,left:e.scrollLeft,top:e.scrollTop});for(typeof r.focus=="function"&&r.focus(),r=0;r<t.length;r++)e=t[r],e.element.scrollLeft=e.left,e.element.scrollTop=e.top}}var pP=qs&&"documentMode"in document&&11>=document.documentMode,tu=null,ev=null,s0=null,tv=!1;function jw(e,t,r){var n=r.window===r?r.document:r.nodeType===9?r:r.ownerDocument;tv||tu==null||tu!==Rp(n)||(n=tu,"selectionStart"in n&&Xx(n)?n={start:n.selectionStart,end:n.selectionEnd}:(n=(n.ownerDocument&&n.ownerDocument.defaultView||window).getSelection(),n={anchorNode:n.anchorNode,anchorOffset:n.anchorOffset,focusNode:n.focusNode,focusOffset:n.focusOffset}),s0&&U0(s0,n)||(s0=n,n=zp(ev,"onSelect"),0<n.length&&(t=new qx("onSelect","select",null,t,r),e.push({event:t,listeners:n}),t.target=tu)))}function Od(e,t){var r={};return r[e.toLowerCase()]=t.toLowerCase(),r["Webkit"+e]="webkit"+t,r["Moz"+e]="moz"+t,r}var ru={animationend:Od("Animation","AnimationEnd"),animationiteration:Od("Animation","AnimationIteration"),animationstart:Od("Animation","AnimationStart"),transitionend:Od("Transition","TransitionEnd")},Cg={},US={};qs&&(US=document.createElement("div").style,"AnimationEvent"in window||(delete ru.animationend.animation,delete ru.animationiteration.animation,delete ru.animationstart.animation),"TransitionEvent"in window||delete ru.transitionend.transition);function V1(e){if(Cg[e])return Cg[e];if(!ru[e])return e;var t=ru[e],r;for(r in t)if(t.hasOwnProperty(r)&&r in US)return Cg[e]=t[r];return e}var VS=V1("animationend"),$S=V1("animationiteration"),zS=V1("animationstart"),HS=V1("transitionend"),WS=new Map,Mw="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function sl(e,t){WS.set(e,t),ac(t,[e])}for(var Ng=0;Ng<Mw.length;Ng++){var Pg=Mw[Ng],mP=Pg.toLowerCase(),gP=Pg[0].toUpperCase()+Pg.slice(1);sl(mP,"on"+gP)}sl(VS,"onAnimationEnd");sl($S,"onAnimationIteration");sl(zS,"onAnimationStart");sl("dblclick","onDoubleClick");sl("focusin","onFocus");sl("focusout","onBlur");sl(HS,"onTransitionEnd");Lu("onMouseEnter",["mouseout","mouseover"]);Lu("onMouseLeave",["mouseout","mouseover"]);Lu("onPointerEnter",["pointerout","pointerover"]);Lu("onPointerLeave",["pointerout","pointerover"]);ac("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));ac("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));ac("onBeforeInput",["compositionend","keypress","textInput","paste"]);ac("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));ac("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));ac("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Xf="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),vP=new Set("cancel close invalid load scroll toggle".split(" ").concat(Xf));function Bw(e,t,r){var n=e.type||"unknown-event";e.currentTarget=r,m8(n,t,void 0,e),e.currentTarget=null}function qS(e,t){t=(t&4)!==0;for(var r=0;r<e.length;r++){var n=e[r],a=n.event;n=n.listeners;e:{var i=void 0;if(t)for(var s=n.length-1;0<=s;s--){var o=n[s],l=o.instance,c=o.currentTarget;if(o=o.listener,l!==i&&a.isPropagationStopped())break e;Bw(a,o,c),i=l}else for(s=0;s<n.length;s++){if(o=n[s],l=o.instance,c=o.currentTarget,o=o.listener,l!==i&&a.isPropagationStopped())break e;Bw(a,o,c),i=l}}}if(Mp)throw e=Y2,Mp=!1,Y2=null,e}function gr(e,t){var r=t[sv];r===void 0&&(r=t[sv]=new Set);var n=e+"__bubble";r.has(n)||(GS(t,e,2,!1),r.add(n))}function Lg(e,t,r){var n=0;t&&(n|=4),GS(r,e,n,t)}var Dd="_reactListening"+Math.random().toString(36).slice(2);function V0(e){if(!e[Dd]){e[Dd]=!0,eS.forEach(function(r){r!=="selectionchange"&&(vP.has(r)||Lg(r,!1,e),Lg(r,!0,e))});var t=e.nodeType===9?e:e.ownerDocument;t===null||t[Dd]||(t[Dd]=!0,Lg("selectionchange",!1,t))}}function GS(e,t,r,n){switch(PS(t)){case 1:var a=L8;break;case 4:a=F8;break;default:a=Hx}r=a.bind(null,t,r,e),a=void 0,!X2||t!=="touchstart"&&t!=="touchmove"&&t!=="wheel"||(a=!0),n?a!==void 0?e.addEventListener(t,r,{capture:!0,passive:a}):e.addEventListener(t,r,!0):a!==void 0?e.addEventListener(t,r,{passive:a}):e.addEventListener(t,r,!1)}function Fg(e,t,r,n,a){var i=n;if(!(t&1)&&!(t&2)&&n!==null)e:for(;;){if(n===null)return;var s=n.tag;if(s===3||s===4){var o=n.stateNode.containerInfo;if(o===a||o.nodeType===8&&o.parentNode===a)break;if(s===4)for(s=n.return;s!==null;){var l=s.tag;if((l===3||l===4)&&(l=s.stateNode.containerInfo,l===a||l.nodeType===8&&l.parentNode===a))return;s=s.return}for(;o!==null;){if(s=Rl(o),s===null)return;if(l=s.tag,l===5||l===6){n=i=s;continue e}o=o.parentNode}}n=n.return}gS(function(){var c=i,u=Ux(r),f=[];e:{var p=WS.get(e);if(p!==void 0){var h=qx,g=e;switch(e){case"keypress":if(yp(r)===0)break e;case"keydown":case"keyup":h=G8;break;case"focusin":g="focus",h=Eg;break;case"focusout":g="blur",h=Eg;break;case"beforeblur":case"afterblur":h=Eg;break;case"click":if(r.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":h=Tw;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":h=I8;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":h=Y8;break;case VS:case $S:case zS:h=M8;break;case HS:h=Q8;break;case"scroll":h=O8;break;case"wheel":h=eP;break;case"copy":case"cut":case"paste":h=U8;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":h=Nw}var m=(t&4)!==0,b=!m&&e==="scroll",x=m?p!==null?p+"Capture":null:p;m=[];for(var w=c,y;w!==null;){y=w;var A=y.stateNode;if(y.tag===5&&A!==null&&(y=A,x!==null&&(A=I0(w,x),A!=null&&m.push($0(w,A,y)))),b)break;w=w.return}0<m.length&&(p=new h(p,g,null,r,u),f.push({event:p,listeners:m}))}}if(!(t&7)){e:{if(p=e==="mouseover"||e==="pointerover",h=e==="mouseout"||e==="pointerout",p&&r!==G2&&(g=r.relatedTarget||r.fromElement)&&(Rl(g)||g[Gs]))break e;if((h||p)&&(p=u.window===u?u:(p=u.ownerDocument)?p.defaultView||p.parentWindow:window,h?(g=r.relatedTarget||r.toElement,h=c,g=g?Rl(g):null,g!==null&&(b=ic(g),g!==b||g.tag!==5&&g.tag!==6)&&(g=null)):(h=null,g=c),h!==g)){if(m=Tw,A="onMouseLeave",x="onMouseEnter",w="mouse",(e==="pointerout"||e==="pointerover")&&(m=Nw,A="onPointerLeave",x="onPointerEnter",w="pointer"),b=h==null?p:nu(h),y=g==null?p:nu(g),p=new m(A,w+"leave",h,r,u),p.target=b,p.relatedTarget=y,A=null,Rl(u)===c&&(m=new m(x,w+"enter",g,r,u),m.target=y,m.relatedTarget=b,A=m),b=A,h&&g)t:{for(m=h,x=g,w=0,y=m;y;y=Uc(y))w++;for(y=0,A=x;A;A=Uc(A))y++;for(;0<w-y;)m=Uc(m),w--;for(;0<y-w;)x=Uc(x),y--;for(;w--;){if(m===x||x!==null&&m===x.alternate)break t;m=Uc(m),x=Uc(x)}m=null}else m=null;h!==null&&Uw(f,p,h,m,!1),g!==null&&b!==null&&Uw(f,b,g,m,!0)}}e:{if(p=c?nu(c):window,h=p.nodeName&&p.nodeName.toLowerCase(),h==="select"||h==="input"&&p.type==="file")var L=oP;else if(Fw(p))if(RS)L=fP;else{L=cP;var D=lP}else(h=p.nodeName)&&h.toLowerCase()==="input"&&(p.type==="checkbox"||p.type==="radio")&&(L=uP);if(L&&(L=L(e,c))){IS(f,L,r,u);break e}D&&D(e,p,c),e==="focusout"&&(D=p._wrapperState)&&D.controlled&&p.type==="number"&&$2(p,"number",p.value)}switch(D=c?nu(c):window,e){case"focusin":(Fw(D)||D.contentEditable==="true")&&(tu=D,ev=c,s0=null);break;case"focusout":s0=ev=tu=null;break;case"mousedown":tv=!0;break;case"contextmenu":case"mouseup":case"dragend":tv=!1,jw(f,r,u);break;case"selectionchange":if(pP)break;case"keydown":case"keyup":jw(f,r,u)}var T;if(Kx)e:{switch(e){case"compositionstart":var F="onCompositionStart";break e;case"compositionend":F="onCompositionEnd";break e;case"compositionupdate":F="onCompositionUpdate";break e}F=void 0}else eu?OS(e,r)&&(F="onCompositionEnd"):e==="keydown"&&r.keyCode===229&&(F="onCompositionStart");F&&(FS&&r.locale!=="ko"&&(eu||F!=="onCompositionStart"?F==="onCompositionEnd"&&eu&&(T=LS()):(Io=u,Wx="value"in Io?Io.value:Io.textContent,eu=!0)),D=zp(c,F),0<D.length&&(F=new Cw(F,e,null,r,u),f.push({event:F,listeners:D}),T?F.data=T:(T=DS(r),T!==null&&(F.data=T)))),(T=rP?nP(e,r):aP(e,r))&&(c=zp(c,"onBeforeInput"),0<c.length&&(u=new Cw("onBeforeInput","beforeinput",null,r,u),f.push({event:u,listeners:c}),u.data=T))}qS(f,t)})}function $0(e,t,r){return{instance:e,listener:t,currentTarget:r}}function zp(e,t){for(var r=t+"Capture",n=[];e!==null;){var a=e,i=a.stateNode;a.tag===5&&i!==null&&(a=i,i=I0(e,r),i!=null&&n.unshift($0(e,i,a)),i=I0(e,t),i!=null&&n.push($0(e,i,a))),e=e.return}return n}function Uc(e){if(e===null)return null;do e=e.return;while(e&&e.tag!==5);return e||null}function Uw(e,t,r,n,a){for(var i=t._reactName,s=[];r!==null&&r!==n;){var o=r,l=o.alternate,c=o.stateNode;if(l!==null&&l===n)break;o.tag===5&&c!==null&&(o=c,a?(l=I0(r,i),l!=null&&s.unshift($0(r,l,o))):a||(l=I0(r,i),l!=null&&s.push($0(r,l,o)))),r=r.return}s.length!==0&&e.push({event:t,listeners:s})}var xP=/\r\n?/g,yP=/\u0000|\uFFFD/g;function Vw(e){return(typeof e=="string"?e:""+e).replace(xP,`
`).replace(yP,"")}function Id(e,t,r){if(t=Vw(t),Vw(e)!==t&&r)throw Error(He(425))}function Hp(){}var rv=null,nv=null;function av(e,t){return e==="textarea"||e==="noscript"||typeof t.children=="string"||typeof t.children=="number"||typeof t.dangerouslySetInnerHTML=="object"&&t.dangerouslySetInnerHTML!==null&&t.dangerouslySetInnerHTML.__html!=null}var iv=typeof setTimeout=="function"?setTimeout:void 0,wP=typeof clearTimeout=="function"?clearTimeout:void 0,$w=typeof Promise=="function"?Promise:void 0,bP=typeof queueMicrotask=="function"?queueMicrotask:typeof $w<"u"?function(e){return $w.resolve(null).then(e).catch(_P)}:iv;function _P(e){setTimeout(function(){throw e})}function Og(e,t){var r=t,n=0;do{var a=r.nextSibling;if(e.removeChild(r),a&&a.nodeType===8)if(r=a.data,r==="/$"){if(n===0){e.removeChild(a),M0(t);return}n--}else r!=="$"&&r!=="$?"&&r!=="$!"||n++;r=a}while(r);M0(t)}function Ho(e){for(;e!=null;e=e.nextSibling){var t=e.nodeType;if(t===1||t===3)break;if(t===8){if(t=e.data,t==="$"||t==="$!"||t==="$?")break;if(t==="/$")return null}}return e}function zw(e){e=e.previousSibling;for(var t=0;e;){if(e.nodeType===8){var r=e.data;if(r==="$"||r==="$!"||r==="$?"){if(t===0)return e;t--}else r==="/$"&&t++}e=e.previousSibling}return null}var Gu=Math.random().toString(36).slice(2),as="__reactFiber$"+Gu,z0="__reactProps$"+Gu,Gs="__reactContainer$"+Gu,sv="__reactEvents$"+Gu,SP="__reactListeners$"+Gu,kP="__reactHandles$"+Gu;function Rl(e){var t=e[as];if(t)return t;for(var r=e.parentNode;r;){if(t=r[Gs]||r[as]){if(r=t.alternate,t.child!==null||r!==null&&r.child!==null)for(e=zw(e);e!==null;){if(r=e[as])return r;e=zw(e)}return t}e=r,r=e.parentNode}return null}function gh(e){return e=e[as]||e[Gs],!e||e.tag!==5&&e.tag!==6&&e.tag!==13&&e.tag!==3?null:e}function nu(e){if(e.tag===5||e.tag===6)return e.stateNode;throw Error(He(33))}function $1(e){return e[z0]||null}var ov=[],au=-1;function ol(e){return{current:e}}function yr(e){0>au||(e.current=ov[au],ov[au]=null,au--)}function hr(e,t){au++,ov[au]=e.current,e.current=t}var Qo={},Wn=ol(Qo),ya=ol(!1),Xl=Qo;function Fu(e,t){var r=e.type.contextTypes;if(!r)return Qo;var n=e.stateNode;if(n&&n.__reactInternalMemoizedUnmaskedChildContext===t)return n.__reactInternalMemoizedMaskedChildContext;var a={},i;for(i in r)a[i]=t[i];return n&&(e=e.stateNode,e.__reactInternalMemoizedUnmaskedChildContext=t,e.__reactInternalMemoizedMaskedChildContext=a),a}function wa(e){return e=e.childContextTypes,e!=null}function Wp(){yr(ya),yr(Wn)}function Hw(e,t,r){if(Wn.current!==Qo)throw Error(He(168));hr(Wn,t),hr(ya,r)}function KS(e,t,r){var n=e.stateNode;if(t=t.childContextTypes,typeof n.getChildContext!="function")return r;n=n.getChildContext();for(var a in n)if(!(a in t))throw Error(He(108,l8(e)||"Unknown",a));return Ar({},r,n)}function qp(e){return e=(e=e.stateNode)&&e.__reactInternalMemoizedMergedChildContext||Qo,Xl=Wn.current,hr(Wn,e),hr(ya,ya.current),!0}function Ww(e,t,r){var n=e.stateNode;if(!n)throw Error(He(169));r?(e=KS(e,t,Xl),n.__reactInternalMemoizedMergedChildContext=e,yr(ya),yr(Wn),hr(Wn,e)):yr(ya),hr(ya,r)}var Ds=null,z1=!1,Dg=!1;function XS(e){Ds===null?Ds=[e]:Ds.push(e)}function EP(e){z1=!0,XS(e)}function ll(){if(!Dg&&Ds!==null){Dg=!0;var e=0,t=rr;try{var r=Ds;for(rr=1;e<r.length;e++){var n=r[e];do n=n(!0);while(n!==null)}Ds=null,z1=!1}catch(a){throw Ds!==null&&(Ds=Ds.slice(e+1)),wS(Vx,ll),a}finally{rr=t,Dg=!1}}return null}var iu=[],su=0,Gp=null,Kp=0,ai=[],ii=0,Yl=null,Is=1,Rs="";function El(e,t){iu[su++]=Kp,iu[su++]=Gp,Gp=e,Kp=t}function YS(e,t,r){ai[ii++]=Is,ai[ii++]=Rs,ai[ii++]=Yl,Yl=e;var n=Is;e=Rs;var a=32-ji(n)-1;n&=~(1<<a),r+=1;var i=32-ji(t)+a;if(30<i){var s=a-a%5;i=(n&(1<<s)-1).toString(32),n>>=s,a-=s,Is=1<<32-ji(t)+a|r<<a|n,Rs=i+e}else Is=1<<i|r<<a|n,Rs=e}function Yx(e){e.return!==null&&(El(e,1),YS(e,1,0))}function Jx(e){for(;e===Gp;)Gp=iu[--su],iu[su]=null,Kp=iu[--su],iu[su]=null;for(;e===Yl;)Yl=ai[--ii],ai[ii]=null,Rs=ai[--ii],ai[ii]=null,Is=ai[--ii],ai[ii]=null}var Ra=null,Da=null,br=!1,Oi=null;function JS(e,t){var r=si(5,null,null,0);r.elementType="DELETED",r.stateNode=t,r.return=e,t=e.deletions,t===null?(e.deletions=[r],e.flags|=16):t.push(r)}function qw(e,t){switch(e.tag){case 5:var r=e.type;return t=t.nodeType!==1||r.toLowerCase()!==t.nodeName.toLowerCase()?null:t,t!==null?(e.stateNode=t,Ra=e,Da=Ho(t.firstChild),!0):!1;case 6:return t=e.pendingProps===""||t.nodeType!==3?null:t,t!==null?(e.stateNode=t,Ra=e,Da=null,!0):!1;case 13:return t=t.nodeType!==8?null:t,t!==null?(r=Yl!==null?{id:Is,overflow:Rs}:null,e.memoizedState={dehydrated:t,treeContext:r,retryLane:1073741824},r=si(18,null,null,0),r.stateNode=t,r.return=e,e.child=r,Ra=e,Da=null,!0):!1;default:return!1}}function lv(e){return(e.mode&1)!==0&&(e.flags&128)===0}function cv(e){if(br){var t=Da;if(t){var r=t;if(!qw(e,t)){if(lv(e))throw Error(He(418));t=Ho(r.nextSibling);var n=Ra;t&&qw(e,t)?JS(n,r):(e.flags=e.flags&-4097|2,br=!1,Ra=e)}}else{if(lv(e))throw Error(He(418));e.flags=e.flags&-4097|2,br=!1,Ra=e}}}function Gw(e){for(e=e.return;e!==null&&e.tag!==5&&e.tag!==3&&e.tag!==13;)e=e.return;Ra=e}function Rd(e){if(e!==Ra)return!1;if(!br)return Gw(e),br=!0,!1;var t;if((t=e.tag!==3)&&!(t=e.tag!==5)&&(t=e.type,t=t!=="head"&&t!=="body"&&!av(e.type,e.memoizedProps)),t&&(t=Da)){if(lv(e))throw QS(),Error(He(418));for(;t;)JS(e,t),t=Ho(t.nextSibling)}if(Gw(e),e.tag===13){if(e=e.memoizedState,e=e!==null?e.dehydrated:null,!e)throw Error(He(317));e:{for(e=e.nextSibling,t=0;e;){if(e.nodeType===8){var r=e.data;if(r==="/$"){if(t===0){Da=Ho(e.nextSibling);break e}t--}else r!=="$"&&r!=="$!"&&r!=="$?"||t++}e=e.nextSibling}Da=null}}else Da=Ra?Ho(e.stateNode.nextSibling):null;return!0}function QS(){for(var e=Da;e;)e=Ho(e.nextSibling)}function Ou(){Da=Ra=null,br=!1}function Qx(e){Oi===null?Oi=[e]:Oi.push(e)}var AP=to.ReactCurrentBatchConfig;function jf(e,t,r){if(e=r.ref,e!==null&&typeof e!="function"&&typeof e!="object"){if(r._owner){if(r=r._owner,r){if(r.tag!==1)throw Error(He(309));var n=r.stateNode}if(!n)throw Error(He(147,e));var a=n,i=""+e;return t!==null&&t.ref!==null&&typeof t.ref=="function"&&t.ref._stringRef===i?t.ref:(t=function(s){var o=a.refs;s===null?delete o[i]:o[i]=s},t._stringRef=i,t)}if(typeof e!="string")throw Error(He(284));if(!r._owner)throw Error(He(290,e))}return e}function jd(e,t){throw e=Object.prototype.toString.call(t),Error(He(31,e==="[object Object]"?"object with keys {"+Object.keys(t).join(", ")+"}":e))}function Kw(e){var t=e._init;return t(e._payload)}function ZS(e){function t(x,w){if(e){var y=x.deletions;y===null?(x.deletions=[w],x.flags|=16):y.push(w)}}function r(x,w){if(!e)return null;for(;w!==null;)t(x,w),w=w.sibling;return null}function n(x,w){for(x=new Map;w!==null;)w.key!==null?x.set(w.key,w):x.set(w.index,w),w=w.sibling;return x}function a(x,w){return x=Ko(x,w),x.index=0,x.sibling=null,x}function i(x,w,y){return x.index=y,e?(y=x.alternate,y!==null?(y=y.index,y<w?(x.flags|=2,w):y):(x.flags|=2,w)):(x.flags|=1048576,w)}function s(x){return e&&x.alternate===null&&(x.flags|=2),x}function o(x,w,y,A){return w===null||w.tag!==6?(w=Vg(y,x.mode,A),w.return=x,w):(w=a(w,y),w.return=x,w)}function l(x,w,y,A){var L=y.type;return L===Zc?u(x,w,y.props.children,A,y.key):w!==null&&(w.elementType===L||typeof L=="object"&&L!==null&&L.$$typeof===Eo&&Kw(L)===w.type)?(A=a(w,y.props),A.ref=jf(x,w,y),A.return=x,A):(A=Ap(y.type,y.key,y.props,null,x.mode,A),A.ref=jf(x,w,y),A.return=x,A)}function c(x,w,y,A){return w===null||w.tag!==4||w.stateNode.containerInfo!==y.containerInfo||w.stateNode.implementation!==y.implementation?(w=$g(y,x.mode,A),w.return=x,w):(w=a(w,y.children||[]),w.return=x,w)}function u(x,w,y,A,L){return w===null||w.tag!==7?(w=zl(y,x.mode,A,L),w.return=x,w):(w=a(w,y),w.return=x,w)}function f(x,w,y){if(typeof w=="string"&&w!==""||typeof w=="number")return w=Vg(""+w,x.mode,y),w.return=x,w;if(typeof w=="object"&&w!==null){switch(w.$$typeof){case Ad:return y=Ap(w.type,w.key,w.props,null,x.mode,y),y.ref=jf(x,null,w),y.return=x,y;case Qc:return w=$g(w,x.mode,y),w.return=x,w;case Eo:var A=w._init;return f(x,A(w._payload),y)}if(Gf(w)||Ff(w))return w=zl(w,x.mode,y,null),w.return=x,w;jd(x,w)}return null}function p(x,w,y,A){var L=w!==null?w.key:null;if(typeof y=="string"&&y!==""||typeof y=="number")return L!==null?null:o(x,w,""+y,A);if(typeof y=="object"&&y!==null){switch(y.$$typeof){case Ad:return y.key===L?l(x,w,y,A):null;case Qc:return y.key===L?c(x,w,y,A):null;case Eo:return L=y._init,p(x,w,L(y._payload),A)}if(Gf(y)||Ff(y))return L!==null?null:u(x,w,y,A,null);jd(x,y)}return null}function h(x,w,y,A,L){if(typeof A=="string"&&A!==""||typeof A=="number")return x=x.get(y)||null,o(w,x,""+A,L);if(typeof A=="object"&&A!==null){switch(A.$$typeof){case Ad:return x=x.get(A.key===null?y:A.key)||null,l(w,x,A,L);case Qc:return x=x.get(A.key===null?y:A.key)||null,c(w,x,A,L);case Eo:var D=A._init;return h(x,w,y,D(A._payload),L)}if(Gf(A)||Ff(A))return x=x.get(y)||null,u(w,x,A,L,null);jd(w,A)}return null}function g(x,w,y,A){for(var L=null,D=null,T=w,F=w=0,R=null;T!==null&&F<y.length;F++){T.index>F?(R=T,T=null):R=T.sibling;var X=p(x,T,y[F],A);if(X===null){T===null&&(T=R);break}e&&T&&X.alternate===null&&t(x,T),w=i(X,w,F),D===null?L=X:D.sibling=X,D=X,T=R}if(F===y.length)return r(x,T),br&&El(x,F),L;if(T===null){for(;F<y.length;F++)T=f(x,y[F],A),T!==null&&(w=i(T,w,F),D===null?L=T:D.sibling=T,D=T);return br&&El(x,F),L}for(T=n(x,T);F<y.length;F++)R=h(T,x,F,y[F],A),R!==null&&(e&&R.alternate!==null&&T.delete(R.key===null?F:R.key),w=i(R,w,F),D===null?L=R:D.sibling=R,D=R);return e&&T.forEach(function(N){return t(x,N)}),br&&El(x,F),L}function m(x,w,y,A){var L=Ff(y);if(typeof L!="function")throw Error(He(150));if(y=L.call(y),y==null)throw Error(He(151));for(var D=L=null,T=w,F=w=0,R=null,X=y.next();T!==null&&!X.done;F++,X=y.next()){T.index>F?(R=T,T=null):R=T.sibling;var N=p(x,T,X.value,A);if(N===null){T===null&&(T=R);break}e&&T&&N.alternate===null&&t(x,T),w=i(N,w,F),D===null?L=N:D.sibling=N,D=N,T=R}if(X.done)return r(x,T),br&&El(x,F),L;if(T===null){for(;!X.done;F++,X=y.next())X=f(x,X.value,A),X!==null&&(w=i(X,w,F),D===null?L=X:D.sibling=X,D=X);return br&&El(x,F),L}for(T=n(x,T);!X.done;F++,X=y.next())X=h(T,x,F,X.value,A),X!==null&&(e&&X.alternate!==null&&T.delete(X.key===null?F:X.key),w=i(X,w,F),D===null?L=X:D.sibling=X,D=X);return e&&T.forEach(function(P){return t(x,P)}),br&&El(x,F),L}function b(x,w,y,A){if(typeof y=="object"&&y!==null&&y.type===Zc&&y.key===null&&(y=y.props.children),typeof y=="object"&&y!==null){switch(y.$$typeof){case Ad:e:{for(var L=y.key,D=w;D!==null;){if(D.key===L){if(L=y.type,L===Zc){if(D.tag===7){r(x,D.sibling),w=a(D,y.props.children),w.return=x,x=w;break e}}else if(D.elementType===L||typeof L=="object"&&L!==null&&L.$$typeof===Eo&&Kw(L)===D.type){r(x,D.sibling),w=a(D,y.props),w.ref=jf(x,D,y),w.return=x,x=w;break e}r(x,D);break}else t(x,D);D=D.sibling}y.type===Zc?(w=zl(y.props.children,x.mode,A,y.key),w.return=x,x=w):(A=Ap(y.type,y.key,y.props,null,x.mode,A),A.ref=jf(x,w,y),A.return=x,x=A)}return s(x);case Qc:e:{for(D=y.key;w!==null;){if(w.key===D)if(w.tag===4&&w.stateNode.containerInfo===y.containerInfo&&w.stateNode.implementation===y.implementation){r(x,w.sibling),w=a(w,y.children||[]),w.return=x,x=w;break e}else{r(x,w);break}else t(x,w);w=w.sibling}w=$g(y,x.mode,A),w.return=x,x=w}return s(x);case Eo:return D=y._init,b(x,w,D(y._payload),A)}if(Gf(y))return g(x,w,y,A);if(Ff(y))return m(x,w,y,A);jd(x,y)}return typeof y=="string"&&y!==""||typeof y=="number"?(y=""+y,w!==null&&w.tag===6?(r(x,w.sibling),w=a(w,y),w.return=x,x=w):(r(x,w),w=Vg(y,x.mode,A),w.return=x,x=w),s(x)):r(x,w)}return b}var Du=ZS(!0),ek=ZS(!1),Xp=ol(null),Yp=null,ou=null,Zx=null;function ey(){Zx=ou=Yp=null}function ty(e){var t=Xp.current;yr(Xp),e._currentValue=t}function uv(e,t,r){for(;e!==null;){var n=e.alternate;if((e.childLanes&t)!==t?(e.childLanes|=t,n!==null&&(n.childLanes|=t)):n!==null&&(n.childLanes&t)!==t&&(n.childLanes|=t),e===r)break;e=e.return}}function bu(e,t){Yp=e,Zx=ou=null,e=e.dependencies,e!==null&&e.firstContext!==null&&(e.lanes&t&&(xa=!0),e.firstContext=null)}function ci(e){var t=e._currentValue;if(Zx!==e)if(e={context:e,memoizedValue:t,next:null},ou===null){if(Yp===null)throw Error(He(308));ou=e,Yp.dependencies={lanes:0,firstContext:e}}else ou=ou.next=e;return t}var jl=null;function ry(e){jl===null?jl=[e]:jl.push(e)}function tk(e,t,r,n){var a=t.interleaved;return a===null?(r.next=r,ry(t)):(r.next=a.next,a.next=r),t.interleaved=r,Ks(e,n)}function Ks(e,t){e.lanes|=t;var r=e.alternate;for(r!==null&&(r.lanes|=t),r=e,e=e.return;e!==null;)e.childLanes|=t,r=e.alternate,r!==null&&(r.childLanes|=t),r=e,e=e.return;return r.tag===3?r.stateNode:null}var Ao=!1;function ny(e){e.updateQueue={baseState:e.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function rk(e,t){e=e.updateQueue,t.updateQueue===e&&(t.updateQueue={baseState:e.baseState,firstBaseUpdate:e.firstBaseUpdate,lastBaseUpdate:e.lastBaseUpdate,shared:e.shared,effects:e.effects})}function Us(e,t){return{eventTime:e,lane:t,tag:0,payload:null,callback:null,next:null}}function Wo(e,t,r){var n=e.updateQueue;if(n===null)return null;if(n=n.shared,zt&2){var a=n.pending;return a===null?t.next=t:(t.next=a.next,a.next=t),n.pending=t,Ks(e,r)}return a=n.interleaved,a===null?(t.next=t,ry(n)):(t.next=a.next,a.next=t),n.interleaved=t,Ks(e,r)}function wp(e,t,r){if(t=t.updateQueue,t!==null&&(t=t.shared,(r&4194240)!==0)){var n=t.lanes;n&=e.pendingLanes,r|=n,t.lanes=r,$x(e,r)}}function Xw(e,t){var r=e.updateQueue,n=e.alternate;if(n!==null&&(n=n.updateQueue,r===n)){var a=null,i=null;if(r=r.firstBaseUpdate,r!==null){do{var s={eventTime:r.eventTime,lane:r.lane,tag:r.tag,payload:r.payload,callback:r.callback,next:null};i===null?a=i=s:i=i.next=s,r=r.next}while(r!==null);i===null?a=i=t:i=i.next=t}else a=i=t;r={baseState:n.baseState,firstBaseUpdate:a,lastBaseUpdate:i,shared:n.shared,effects:n.effects},e.updateQueue=r;return}e=r.lastBaseUpdate,e===null?r.firstBaseUpdate=t:e.next=t,r.lastBaseUpdate=t}function Jp(e,t,r,n){var a=e.updateQueue;Ao=!1;var i=a.firstBaseUpdate,s=a.lastBaseUpdate,o=a.shared.pending;if(o!==null){a.shared.pending=null;var l=o,c=l.next;l.next=null,s===null?i=c:s.next=c,s=l;var u=e.alternate;u!==null&&(u=u.updateQueue,o=u.lastBaseUpdate,o!==s&&(o===null?u.firstBaseUpdate=c:o.next=c,u.lastBaseUpdate=l))}if(i!==null){var f=a.baseState;s=0,u=c=l=null,o=i;do{var p=o.lane,h=o.eventTime;if((n&p)===p){u!==null&&(u=u.next={eventTime:h,lane:0,tag:o.tag,payload:o.payload,callback:o.callback,next:null});e:{var g=e,m=o;switch(p=t,h=r,m.tag){case 1:if(g=m.payload,typeof g=="function"){f=g.call(h,f,p);break e}f=g;break e;case 3:g.flags=g.flags&-65537|128;case 0:if(g=m.payload,p=typeof g=="function"?g.call(h,f,p):g,p==null)break e;f=Ar({},f,p);break e;case 2:Ao=!0}}o.callback!==null&&o.lane!==0&&(e.flags|=64,p=a.effects,p===null?a.effects=[o]:p.push(o))}else h={eventTime:h,lane:p,tag:o.tag,payload:o.payload,callback:o.callback,next:null},u===null?(c=u=h,l=f):u=u.next=h,s|=p;if(o=o.next,o===null){if(o=a.shared.pending,o===null)break;p=o,o=p.next,p.next=null,a.lastBaseUpdate=p,a.shared.pending=null}}while(!0);if(u===null&&(l=f),a.baseState=l,a.firstBaseUpdate=c,a.lastBaseUpdate=u,t=a.shared.interleaved,t!==null){a=t;do s|=a.lane,a=a.next;while(a!==t)}else i===null&&(a.shared.lanes=0);Ql|=s,e.lanes=s,e.memoizedState=f}}function Yw(e,t,r){if(e=t.effects,t.effects=null,e!==null)for(t=0;t<e.length;t++){var n=e[t],a=n.callback;if(a!==null){if(n.callback=null,n=r,typeof a!="function")throw Error(He(191,a));a.call(n)}}}var vh={},ls=ol(vh),H0=ol(vh),W0=ol(vh);function Ml(e){if(e===vh)throw Error(He(174));return e}function ay(e,t){switch(hr(W0,t),hr(H0,e),hr(ls,vh),e=t.nodeType,e){case 9:case 11:t=(t=t.documentElement)?t.namespaceURI:H2(null,"");break;default:e=e===8?t.parentNode:t,t=e.namespaceURI||null,e=e.tagName,t=H2(t,e)}yr(ls),hr(ls,t)}function Iu(){yr(ls),yr(H0),yr(W0)}function nk(e){Ml(W0.current);var t=Ml(ls.current),r=H2(t,e.type);t!==r&&(hr(H0,e),hr(ls,r))}function iy(e){H0.current===e&&(yr(ls),yr(H0))}var Sr=ol(0);function Qp(e){for(var t=e;t!==null;){if(t.tag===13){var r=t.memoizedState;if(r!==null&&(r=r.dehydrated,r===null||r.data==="$?"||r.data==="$!"))return t}else if(t.tag===19&&t.memoizedProps.revealOrder!==void 0){if(t.flags&128)return t}else if(t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break;for(;t.sibling===null;){if(t.return===null||t.return===e)return null;t=t.return}t.sibling.return=t.return,t=t.sibling}return null}var Ig=[];function sy(){for(var e=0;e<Ig.length;e++)Ig[e]._workInProgressVersionPrimary=null;Ig.length=0}var bp=to.ReactCurrentDispatcher,Rg=to.ReactCurrentBatchConfig,Jl=0,Er=null,nn=null,pn=null,Zp=!1,o0=!1,q0=0,TP=0;function Nn(){throw Error(He(321))}function oy(e,t){if(t===null)return!1;for(var r=0;r<t.length&&r<e.length;r++)if(!Vi(e[r],t[r]))return!1;return!0}function ly(e,t,r,n,a,i){if(Jl=i,Er=t,t.memoizedState=null,t.updateQueue=null,t.lanes=0,bp.current=e===null||e.memoizedState===null?LP:FP,e=r(n,a),o0){i=0;do{if(o0=!1,q0=0,25<=i)throw Error(He(301));i+=1,pn=nn=null,t.updateQueue=null,bp.current=OP,e=r(n,a)}while(o0)}if(bp.current=e1,t=nn!==null&&nn.next!==null,Jl=0,pn=nn=Er=null,Zp=!1,t)throw Error(He(300));return e}function cy(){var e=q0!==0;return q0=0,e}function ns(){var e={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return pn===null?Er.memoizedState=pn=e:pn=pn.next=e,pn}function ui(){if(nn===null){var e=Er.alternate;e=e!==null?e.memoizedState:null}else e=nn.next;var t=pn===null?Er.memoizedState:pn.next;if(t!==null)pn=t,nn=e;else{if(e===null)throw Error(He(310));nn=e,e={memoizedState:nn.memoizedState,baseState:nn.baseState,baseQueue:nn.baseQueue,queue:nn.queue,next:null},pn===null?Er.memoizedState=pn=e:pn=pn.next=e}return pn}function G0(e,t){return typeof t=="function"?t(e):t}function jg(e){var t=ui(),r=t.queue;if(r===null)throw Error(He(311));r.lastRenderedReducer=e;var n=nn,a=n.baseQueue,i=r.pending;if(i!==null){if(a!==null){var s=a.next;a.next=i.next,i.next=s}n.baseQueue=a=i,r.pending=null}if(a!==null){i=a.next,n=n.baseState;var o=s=null,l=null,c=i;do{var u=c.lane;if((Jl&u)===u)l!==null&&(l=l.next={lane:0,action:c.action,hasEagerState:c.hasEagerState,eagerState:c.eagerState,next:null}),n=c.hasEagerState?c.eagerState:e(n,c.action);else{var f={lane:u,action:c.action,hasEagerState:c.hasEagerState,eagerState:c.eagerState,next:null};l===null?(o=l=f,s=n):l=l.next=f,Er.lanes|=u,Ql|=u}c=c.next}while(c!==null&&c!==i);l===null?s=n:l.next=o,Vi(n,t.memoizedState)||(xa=!0),t.memoizedState=n,t.baseState=s,t.baseQueue=l,r.lastRenderedState=n}if(e=r.interleaved,e!==null){a=e;do i=a.lane,Er.lanes|=i,Ql|=i,a=a.next;while(a!==e)}else a===null&&(r.lanes=0);return[t.memoizedState,r.dispatch]}function Mg(e){var t=ui(),r=t.queue;if(r===null)throw Error(He(311));r.lastRenderedReducer=e;var n=r.dispatch,a=r.pending,i=t.memoizedState;if(a!==null){r.pending=null;var s=a=a.next;do i=e(i,s.action),s=s.next;while(s!==a);Vi(i,t.memoizedState)||(xa=!0),t.memoizedState=i,t.baseQueue===null&&(t.baseState=i),r.lastRenderedState=i}return[i,n]}function ak(){}function ik(e,t){var r=Er,n=ui(),a=t(),i=!Vi(n.memoizedState,a);if(i&&(n.memoizedState=a,xa=!0),n=n.queue,uy(lk.bind(null,r,n,e),[e]),n.getSnapshot!==t||i||pn!==null&&pn.memoizedState.tag&1){if(r.flags|=2048,K0(9,ok.bind(null,r,n,a,t),void 0,null),gn===null)throw Error(He(349));Jl&30||sk(r,t,a)}return a}function sk(e,t,r){e.flags|=16384,e={getSnapshot:t,value:r},t=Er.updateQueue,t===null?(t={lastEffect:null,stores:null},Er.updateQueue=t,t.stores=[e]):(r=t.stores,r===null?t.stores=[e]:r.push(e))}function ok(e,t,r,n){t.value=r,t.getSnapshot=n,ck(t)&&uk(e)}function lk(e,t,r){return r(function(){ck(t)&&uk(e)})}function ck(e){var t=e.getSnapshot;e=e.value;try{var r=t();return!Vi(e,r)}catch{return!0}}function uk(e){var t=Ks(e,1);t!==null&&Mi(t,e,1,-1)}function Jw(e){var t=ns();return typeof e=="function"&&(e=e()),t.memoizedState=t.baseState=e,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:G0,lastRenderedState:e},t.queue=e,e=e.dispatch=PP.bind(null,Er,e),[t.memoizedState,e]}function K0(e,t,r,n){return e={tag:e,create:t,destroy:r,deps:n,next:null},t=Er.updateQueue,t===null?(t={lastEffect:null,stores:null},Er.updateQueue=t,t.lastEffect=e.next=e):(r=t.lastEffect,r===null?t.lastEffect=e.next=e:(n=r.next,r.next=e,e.next=n,t.lastEffect=e)),e}function fk(){return ui().memoizedState}function _p(e,t,r,n){var a=ns();Er.flags|=e,a.memoizedState=K0(1|t,r,void 0,n===void 0?null:n)}function H1(e,t,r,n){var a=ui();n=n===void 0?null:n;var i=void 0;if(nn!==null){var s=nn.memoizedState;if(i=s.destroy,n!==null&&oy(n,s.deps)){a.memoizedState=K0(t,r,i,n);return}}Er.flags|=e,a.memoizedState=K0(1|t,r,i,n)}function Qw(e,t){return _p(8390656,8,e,t)}function uy(e,t){return H1(2048,8,e,t)}function hk(e,t){return H1(4,2,e,t)}function dk(e,t){return H1(4,4,e,t)}function pk(e,t){if(typeof t=="function")return e=e(),t(e),function(){t(null)};if(t!=null)return e=e(),t.current=e,function(){t.current=null}}function mk(e,t,r){return r=r!=null?r.concat([e]):null,H1(4,4,pk.bind(null,t,e),r)}function fy(){}function gk(e,t){var r=ui();t=t===void 0?null:t;var n=r.memoizedState;return n!==null&&t!==null&&oy(t,n[1])?n[0]:(r.memoizedState=[e,t],e)}function vk(e,t){var r=ui();t=t===void 0?null:t;var n=r.memoizedState;return n!==null&&t!==null&&oy(t,n[1])?n[0]:(e=e(),r.memoizedState=[e,t],e)}function xk(e,t,r){return Jl&21?(Vi(r,t)||(r=SS(),Er.lanes|=r,Ql|=r,e.baseState=!0),t):(e.baseState&&(e.baseState=!1,xa=!0),e.memoizedState=r)}function CP(e,t){var r=rr;rr=r!==0&&4>r?r:4,e(!0);var n=Rg.transition;Rg.transition={};try{e(!1),t()}finally{rr=r,Rg.transition=n}}function yk(){return ui().memoizedState}function NP(e,t,r){var n=Go(e);if(r={lane:n,action:r,hasEagerState:!1,eagerState:null,next:null},wk(e))bk(t,r);else if(r=tk(e,t,r,n),r!==null){var a=na();Mi(r,e,n,a),_k(r,t,n)}}function PP(e,t,r){var n=Go(e),a={lane:n,action:r,hasEagerState:!1,eagerState:null,next:null};if(wk(e))bk(t,a);else{var i=e.alternate;if(e.lanes===0&&(i===null||i.lanes===0)&&(i=t.lastRenderedReducer,i!==null))try{var s=t.lastRenderedState,o=i(s,r);if(a.hasEagerState=!0,a.eagerState=o,Vi(o,s)){var l=t.interleaved;l===null?(a.next=a,ry(t)):(a.next=l.next,l.next=a),t.interleaved=a;return}}catch{}finally{}r=tk(e,t,a,n),r!==null&&(a=na(),Mi(r,e,n,a),_k(r,t,n))}}function wk(e){var t=e.alternate;return e===Er||t!==null&&t===Er}function bk(e,t){o0=Zp=!0;var r=e.pending;r===null?t.next=t:(t.next=r.next,r.next=t),e.pending=t}function _k(e,t,r){if(r&4194240){var n=t.lanes;n&=e.pendingLanes,r|=n,t.lanes=r,$x(e,r)}}var e1={readContext:ci,useCallback:Nn,useContext:Nn,useEffect:Nn,useImperativeHandle:Nn,useInsertionEffect:Nn,useLayoutEffect:Nn,useMemo:Nn,useReducer:Nn,useRef:Nn,useState:Nn,useDebugValue:Nn,useDeferredValue:Nn,useTransition:Nn,useMutableSource:Nn,useSyncExternalStore:Nn,useId:Nn,unstable_isNewReconciler:!1},LP={readContext:ci,useCallback:function(e,t){return ns().memoizedState=[e,t===void 0?null:t],e},useContext:ci,useEffect:Qw,useImperativeHandle:function(e,t,r){return r=r!=null?r.concat([e]):null,_p(4194308,4,pk.bind(null,t,e),r)},useLayoutEffect:function(e,t){return _p(4194308,4,e,t)},useInsertionEffect:function(e,t){return _p(4,2,e,t)},useMemo:function(e,t){var r=ns();return t=t===void 0?null:t,e=e(),r.memoizedState=[e,t],e},useReducer:function(e,t,r){var n=ns();return t=r!==void 0?r(t):t,n.memoizedState=n.baseState=t,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:e,lastRenderedState:t},n.queue=e,e=e.dispatch=NP.bind(null,Er,e),[n.memoizedState,e]},useRef:function(e){var t=ns();return e={current:e},t.memoizedState=e},useState:Jw,useDebugValue:fy,useDeferredValue:function(e){return ns().memoizedState=e},useTransition:function(){var e=Jw(!1),t=e[0];return e=CP.bind(null,e[1]),ns().memoizedState=e,[t,e]},useMutableSource:function(){},useSyncExternalStore:function(e,t,r){var n=Er,a=ns();if(br){if(r===void 0)throw Error(He(407));r=r()}else{if(r=t(),gn===null)throw Error(He(349));Jl&30||sk(n,t,r)}a.memoizedState=r;var i={value:r,getSnapshot:t};return a.queue=i,Qw(lk.bind(null,n,i,e),[e]),n.flags|=2048,K0(9,ok.bind(null,n,i,r,t),void 0,null),r},useId:function(){var e=ns(),t=gn.identifierPrefix;if(br){var r=Rs,n=Is;r=(n&~(1<<32-ji(n)-1)).toString(32)+r,t=":"+t+"R"+r,r=q0++,0<r&&(t+="H"+r.toString(32)),t+=":"}else r=TP++,t=":"+t+"r"+r.toString(32)+":";return e.memoizedState=t},unstable_isNewReconciler:!1},FP={readContext:ci,useCallback:gk,useContext:ci,useEffect:uy,useImperativeHandle:mk,useInsertionEffect:hk,useLayoutEffect:dk,useMemo:vk,useReducer:jg,useRef:fk,useState:function(){return jg(G0)},useDebugValue:fy,useDeferredValue:function(e){var t=ui();return xk(t,nn.memoizedState,e)},useTransition:function(){var e=jg(G0)[0],t=ui().memoizedState;return[e,t]},useMutableSource:ak,useSyncExternalStore:ik,useId:yk,unstable_isNewReconciler:!1},OP={readContext:ci,useCallback:gk,useContext:ci,useEffect:uy,useImperativeHandle:mk,useInsertionEffect:hk,useLayoutEffect:dk,useMemo:vk,useReducer:Mg,useRef:fk,useState:function(){return Mg(G0)},useDebugValue:fy,useDeferredValue:function(e){var t=ui();return nn===null?t.memoizedState=e:xk(t,nn.memoizedState,e)},useTransition:function(){var e=Mg(G0)[0],t=ui().memoizedState;return[e,t]},useMutableSource:ak,useSyncExternalStore:ik,useId:yk,unstable_isNewReconciler:!1};function Ti(e,t){if(e&&e.defaultProps){t=Ar({},t),e=e.defaultProps;for(var r in e)t[r]===void 0&&(t[r]=e[r]);return t}return t}function fv(e,t,r,n){t=e.memoizedState,r=r(n,t),r=r==null?t:Ar({},t,r),e.memoizedState=r,e.lanes===0&&(e.updateQueue.baseState=r)}var W1={isMounted:function(e){return(e=e._reactInternals)?ic(e)===e:!1},enqueueSetState:function(e,t,r){e=e._reactInternals;var n=na(),a=Go(e),i=Us(n,a);i.payload=t,r!=null&&(i.callback=r),t=Wo(e,i,a),t!==null&&(Mi(t,e,a,n),wp(t,e,a))},enqueueReplaceState:function(e,t,r){e=e._reactInternals;var n=na(),a=Go(e),i=Us(n,a);i.tag=1,i.payload=t,r!=null&&(i.callback=r),t=Wo(e,i,a),t!==null&&(Mi(t,e,a,n),wp(t,e,a))},enqueueForceUpdate:function(e,t){e=e._reactInternals;var r=na(),n=Go(e),a=Us(r,n);a.tag=2,t!=null&&(a.callback=t),t=Wo(e,a,n),t!==null&&(Mi(t,e,n,r),wp(t,e,n))}};function Zw(e,t,r,n,a,i,s){return e=e.stateNode,typeof e.shouldComponentUpdate=="function"?e.shouldComponentUpdate(n,i,s):t.prototype&&t.prototype.isPureReactComponent?!U0(r,n)||!U0(a,i):!0}function Sk(e,t,r){var n=!1,a=Qo,i=t.contextType;return typeof i=="object"&&i!==null?i=ci(i):(a=wa(t)?Xl:Wn.current,n=t.contextTypes,i=(n=n!=null)?Fu(e,a):Qo),t=new t(r,i),e.memoizedState=t.state!==null&&t.state!==void 0?t.state:null,t.updater=W1,e.stateNode=t,t._reactInternals=e,n&&(e=e.stateNode,e.__reactInternalMemoizedUnmaskedChildContext=a,e.__reactInternalMemoizedMaskedChildContext=i),t}function e4(e,t,r,n){e=t.state,typeof t.componentWillReceiveProps=="function"&&t.componentWillReceiveProps(r,n),typeof t.UNSAFE_componentWillReceiveProps=="function"&&t.UNSAFE_componentWillReceiveProps(r,n),t.state!==e&&W1.enqueueReplaceState(t,t.state,null)}function hv(e,t,r,n){var a=e.stateNode;a.props=r,a.state=e.memoizedState,a.refs={},ny(e);var i=t.contextType;typeof i=="object"&&i!==null?a.context=ci(i):(i=wa(t)?Xl:Wn.current,a.context=Fu(e,i)),a.state=e.memoizedState,i=t.getDerivedStateFromProps,typeof i=="function"&&(fv(e,t,i,r),a.state=e.memoizedState),typeof t.getDerivedStateFromProps=="function"||typeof a.getSnapshotBeforeUpdate=="function"||typeof a.UNSAFE_componentWillMount!="function"&&typeof a.componentWillMount!="function"||(t=a.state,typeof a.componentWillMount=="function"&&a.componentWillMount(),typeof a.UNSAFE_componentWillMount=="function"&&a.UNSAFE_componentWillMount(),t!==a.state&&W1.enqueueReplaceState(a,a.state,null),Jp(e,r,a,n),a.state=e.memoizedState),typeof a.componentDidMount=="function"&&(e.flags|=4194308)}function Ru(e,t){try{var r="",n=t;do r+=o8(n),n=n.return;while(n);var a=r}catch(i){a=`
Error generating stack: `+i.message+`
`+i.stack}return{value:e,source:t,stack:a,digest:null}}function Bg(e,t,r){return{value:e,source:null,stack:r??null,digest:t??null}}function dv(e,t){try{console.error(t.value)}catch(r){setTimeout(function(){throw r})}}var DP=typeof WeakMap=="function"?WeakMap:Map;function kk(e,t,r){r=Us(-1,r),r.tag=3,r.payload={element:null};var n=t.value;return r.callback=function(){r1||(r1=!0,Sv=n),dv(e,t)},r}function Ek(e,t,r){r=Us(-1,r),r.tag=3;var n=e.type.getDerivedStateFromError;if(typeof n=="function"){var a=t.value;r.payload=function(){return n(a)},r.callback=function(){dv(e,t)}}var i=e.stateNode;return i!==null&&typeof i.componentDidCatch=="function"&&(r.callback=function(){dv(e,t),typeof n!="function"&&(qo===null?qo=new Set([this]):qo.add(this));var s=t.stack;this.componentDidCatch(t.value,{componentStack:s!==null?s:""})}),r}function t4(e,t,r){var n=e.pingCache;if(n===null){n=e.pingCache=new DP;var a=new Set;n.set(t,a)}else a=n.get(t),a===void 0&&(a=new Set,n.set(t,a));a.has(r)||(a.add(r),e=KP.bind(null,e,t,r),t.then(e,e))}function r4(e){do{var t;if((t=e.tag===13)&&(t=e.memoizedState,t=t!==null?t.dehydrated!==null:!0),t)return e;e=e.return}while(e!==null);return null}function n4(e,t,r,n,a){return e.mode&1?(e.flags|=65536,e.lanes=a,e):(e===t?e.flags|=65536:(e.flags|=128,r.flags|=131072,r.flags&=-52805,r.tag===1&&(r.alternate===null?r.tag=17:(t=Us(-1,1),t.tag=2,Wo(r,t,1))),r.lanes|=1),e)}var IP=to.ReactCurrentOwner,xa=!1;function Qn(e,t,r,n){t.child=e===null?ek(t,null,r,n):Du(t,e.child,r,n)}function a4(e,t,r,n,a){r=r.render;var i=t.ref;return bu(t,a),n=ly(e,t,r,n,i,a),r=cy(),e!==null&&!xa?(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~a,Xs(e,t,a)):(br&&r&&Yx(t),t.flags|=1,Qn(e,t,n,a),t.child)}function i4(e,t,r,n,a){if(e===null){var i=r.type;return typeof i=="function"&&!yy(i)&&i.defaultProps===void 0&&r.compare===null&&r.defaultProps===void 0?(t.tag=15,t.type=i,Ak(e,t,i,n,a)):(e=Ap(r.type,null,n,t,t.mode,a),e.ref=t.ref,e.return=t,t.child=e)}if(i=e.child,!(e.lanes&a)){var s=i.memoizedProps;if(r=r.compare,r=r!==null?r:U0,r(s,n)&&e.ref===t.ref)return Xs(e,t,a)}return t.flags|=1,e=Ko(i,n),e.ref=t.ref,e.return=t,t.child=e}function Ak(e,t,r,n,a){if(e!==null){var i=e.memoizedProps;if(U0(i,n)&&e.ref===t.ref)if(xa=!1,t.pendingProps=n=i,(e.lanes&a)!==0)e.flags&131072&&(xa=!0);else return t.lanes=e.lanes,Xs(e,t,a)}return pv(e,t,r,n,a)}function Tk(e,t,r){var n=t.pendingProps,a=n.children,i=e!==null?e.memoizedState:null;if(n.mode==="hidden")if(!(t.mode&1))t.memoizedState={baseLanes:0,cachePool:null,transitions:null},hr(cu,La),La|=r;else{if(!(r&1073741824))return e=i!==null?i.baseLanes|r:r,t.lanes=t.childLanes=1073741824,t.memoizedState={baseLanes:e,cachePool:null,transitions:null},t.updateQueue=null,hr(cu,La),La|=e,null;t.memoizedState={baseLanes:0,cachePool:null,transitions:null},n=i!==null?i.baseLanes:r,hr(cu,La),La|=n}else i!==null?(n=i.baseLanes|r,t.memoizedState=null):n=r,hr(cu,La),La|=n;return Qn(e,t,a,r),t.child}function Ck(e,t){var r=t.ref;(e===null&&r!==null||e!==null&&e.ref!==r)&&(t.flags|=512,t.flags|=2097152)}function pv(e,t,r,n,a){var i=wa(r)?Xl:Wn.current;return i=Fu(t,i),bu(t,a),r=ly(e,t,r,n,i,a),n=cy(),e!==null&&!xa?(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~a,Xs(e,t,a)):(br&&n&&Yx(t),t.flags|=1,Qn(e,t,r,a),t.child)}function s4(e,t,r,n,a){if(wa(r)){var i=!0;qp(t)}else i=!1;if(bu(t,a),t.stateNode===null)Sp(e,t),Sk(t,r,n),hv(t,r,n,a),n=!0;else if(e===null){var s=t.stateNode,o=t.memoizedProps;s.props=o;var l=s.context,c=r.contextType;typeof c=="object"&&c!==null?c=ci(c):(c=wa(r)?Xl:Wn.current,c=Fu(t,c));var u=r.getDerivedStateFromProps,f=typeof u=="function"||typeof s.getSnapshotBeforeUpdate=="function";f||typeof s.UNSAFE_componentWillReceiveProps!="function"&&typeof s.componentWillReceiveProps!="function"||(o!==n||l!==c)&&e4(t,s,n,c),Ao=!1;var p=t.memoizedState;s.state=p,Jp(t,n,s,a),l=t.memoizedState,o!==n||p!==l||ya.current||Ao?(typeof u=="function"&&(fv(t,r,u,n),l=t.memoizedState),(o=Ao||Zw(t,r,o,n,p,l,c))?(f||typeof s.UNSAFE_componentWillMount!="function"&&typeof s.componentWillMount!="function"||(typeof s.componentWillMount=="function"&&s.componentWillMount(),typeof s.UNSAFE_componentWillMount=="function"&&s.UNSAFE_componentWillMount()),typeof s.componentDidMount=="function"&&(t.flags|=4194308)):(typeof s.componentDidMount=="function"&&(t.flags|=4194308),t.memoizedProps=n,t.memoizedState=l),s.props=n,s.state=l,s.context=c,n=o):(typeof s.componentDidMount=="function"&&(t.flags|=4194308),n=!1)}else{s=t.stateNode,rk(e,t),o=t.memoizedProps,c=t.type===t.elementType?o:Ti(t.type,o),s.props=c,f=t.pendingProps,p=s.context,l=r.contextType,typeof l=="object"&&l!==null?l=ci(l):(l=wa(r)?Xl:Wn.current,l=Fu(t,l));var h=r.getDerivedStateFromProps;(u=typeof h=="function"||typeof s.getSnapshotBeforeUpdate=="function")||typeof s.UNSAFE_componentWillReceiveProps!="function"&&typeof s.componentWillReceiveProps!="function"||(o!==f||p!==l)&&e4(t,s,n,l),Ao=!1,p=t.memoizedState,s.state=p,Jp(t,n,s,a);var g=t.memoizedState;o!==f||p!==g||ya.current||Ao?(typeof h=="function"&&(fv(t,r,h,n),g=t.memoizedState),(c=Ao||Zw(t,r,c,n,p,g,l)||!1)?(u||typeof s.UNSAFE_componentWillUpdate!="function"&&typeof s.componentWillUpdate!="function"||(typeof s.componentWillUpdate=="function"&&s.componentWillUpdate(n,g,l),typeof s.UNSAFE_componentWillUpdate=="function"&&s.UNSAFE_componentWillUpdate(n,g,l)),typeof s.componentDidUpdate=="function"&&(t.flags|=4),typeof s.getSnapshotBeforeUpdate=="function"&&(t.flags|=1024)):(typeof s.componentDidUpdate!="function"||o===e.memoizedProps&&p===e.memoizedState||(t.flags|=4),typeof s.getSnapshotBeforeUpdate!="function"||o===e.memoizedProps&&p===e.memoizedState||(t.flags|=1024),t.memoizedProps=n,t.memoizedState=g),s.props=n,s.state=g,s.context=l,n=c):(typeof s.componentDidUpdate!="function"||o===e.memoizedProps&&p===e.memoizedState||(t.flags|=4),typeof s.getSnapshotBeforeUpdate!="function"||o===e.memoizedProps&&p===e.memoizedState||(t.flags|=1024),n=!1)}return mv(e,t,r,n,i,a)}function mv(e,t,r,n,a,i){Ck(e,t);var s=(t.flags&128)!==0;if(!n&&!s)return a&&Ww(t,r,!1),Xs(e,t,i);n=t.stateNode,IP.current=t;var o=s&&typeof r.getDerivedStateFromError!="function"?null:n.render();return t.flags|=1,e!==null&&s?(t.child=Du(t,e.child,null,i),t.child=Du(t,null,o,i)):Qn(e,t,o,i),t.memoizedState=n.state,a&&Ww(t,r,!0),t.child}function Nk(e){var t=e.stateNode;t.pendingContext?Hw(e,t.pendingContext,t.pendingContext!==t.context):t.context&&Hw(e,t.context,!1),ay(e,t.containerInfo)}function o4(e,t,r,n,a){return Ou(),Qx(a),t.flags|=256,Qn(e,t,r,n),t.child}var gv={dehydrated:null,treeContext:null,retryLane:0};function vv(e){return{baseLanes:e,cachePool:null,transitions:null}}function Pk(e,t,r){var n=t.pendingProps,a=Sr.current,i=!1,s=(t.flags&128)!==0,o;if((o=s)||(o=e!==null&&e.memoizedState===null?!1:(a&2)!==0),o?(i=!0,t.flags&=-129):(e===null||e.memoizedState!==null)&&(a|=1),hr(Sr,a&1),e===null)return cv(t),e=t.memoizedState,e!==null&&(e=e.dehydrated,e!==null)?(t.mode&1?e.data==="$!"?t.lanes=8:t.lanes=1073741824:t.lanes=1,null):(s=n.children,e=n.fallback,i?(n=t.mode,i=t.child,s={mode:"hidden",children:s},!(n&1)&&i!==null?(i.childLanes=0,i.pendingProps=s):i=K1(s,n,0,null),e=zl(e,n,r,null),i.return=t,e.return=t,i.sibling=e,t.child=i,t.child.memoizedState=vv(r),t.memoizedState=gv,e):hy(t,s));if(a=e.memoizedState,a!==null&&(o=a.dehydrated,o!==null))return RP(e,t,s,n,o,a,r);if(i){i=n.fallback,s=t.mode,a=e.child,o=a.sibling;var l={mode:"hidden",children:n.children};return!(s&1)&&t.child!==a?(n=t.child,n.childLanes=0,n.pendingProps=l,t.deletions=null):(n=Ko(a,l),n.subtreeFlags=a.subtreeFlags&14680064),o!==null?i=Ko(o,i):(i=zl(i,s,r,null),i.flags|=2),i.return=t,n.return=t,n.sibling=i,t.child=n,n=i,i=t.child,s=e.child.memoizedState,s=s===null?vv(r):{baseLanes:s.baseLanes|r,cachePool:null,transitions:s.transitions},i.memoizedState=s,i.childLanes=e.childLanes&~r,t.memoizedState=gv,n}return i=e.child,e=i.sibling,n=Ko(i,{mode:"visible",children:n.children}),!(t.mode&1)&&(n.lanes=r),n.return=t,n.sibling=null,e!==null&&(r=t.deletions,r===null?(t.deletions=[e],t.flags|=16):r.push(e)),t.child=n,t.memoizedState=null,n}function hy(e,t){return t=K1({mode:"visible",children:t},e.mode,0,null),t.return=e,e.child=t}function Md(e,t,r,n){return n!==null&&Qx(n),Du(t,e.child,null,r),e=hy(t,t.pendingProps.children),e.flags|=2,t.memoizedState=null,e}function RP(e,t,r,n,a,i,s){if(r)return t.flags&256?(t.flags&=-257,n=Bg(Error(He(422))),Md(e,t,s,n)):t.memoizedState!==null?(t.child=e.child,t.flags|=128,null):(i=n.fallback,a=t.mode,n=K1({mode:"visible",children:n.children},a,0,null),i=zl(i,a,s,null),i.flags|=2,n.return=t,i.return=t,n.sibling=i,t.child=n,t.mode&1&&Du(t,e.child,null,s),t.child.memoizedState=vv(s),t.memoizedState=gv,i);if(!(t.mode&1))return Md(e,t,s,null);if(a.data==="$!"){if(n=a.nextSibling&&a.nextSibling.dataset,n)var o=n.dgst;return n=o,i=Error(He(419)),n=Bg(i,n,void 0),Md(e,t,s,n)}if(o=(s&e.childLanes)!==0,xa||o){if(n=gn,n!==null){switch(s&-s){case 4:a=2;break;case 16:a=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:a=32;break;case 536870912:a=268435456;break;default:a=0}a=a&(n.suspendedLanes|s)?0:a,a!==0&&a!==i.retryLane&&(i.retryLane=a,Ks(e,a),Mi(n,e,a,-1))}return xy(),n=Bg(Error(He(421))),Md(e,t,s,n)}return a.data==="$?"?(t.flags|=128,t.child=e.child,t=XP.bind(null,e),a._reactRetry=t,null):(e=i.treeContext,Da=Ho(a.nextSibling),Ra=t,br=!0,Oi=null,e!==null&&(ai[ii++]=Is,ai[ii++]=Rs,ai[ii++]=Yl,Is=e.id,Rs=e.overflow,Yl=t),t=hy(t,n.children),t.flags|=4096,t)}function l4(e,t,r){e.lanes|=t;var n=e.alternate;n!==null&&(n.lanes|=t),uv(e.return,t,r)}function Ug(e,t,r,n,a){var i=e.memoizedState;i===null?e.memoizedState={isBackwards:t,rendering:null,renderingStartTime:0,last:n,tail:r,tailMode:a}:(i.isBackwards=t,i.rendering=null,i.renderingStartTime=0,i.last=n,i.tail=r,i.tailMode=a)}function Lk(e,t,r){var n=t.pendingProps,a=n.revealOrder,i=n.tail;if(Qn(e,t,n.children,r),n=Sr.current,n&2)n=n&1|2,t.flags|=128;else{if(e!==null&&e.flags&128)e:for(e=t.child;e!==null;){if(e.tag===13)e.memoizedState!==null&&l4(e,r,t);else if(e.tag===19)l4(e,r,t);else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===t)break e;for(;e.sibling===null;){if(e.return===null||e.return===t)break e;e=e.return}e.sibling.return=e.return,e=e.sibling}n&=1}if(hr(Sr,n),!(t.mode&1))t.memoizedState=null;else switch(a){case"forwards":for(r=t.child,a=null;r!==null;)e=r.alternate,e!==null&&Qp(e)===null&&(a=r),r=r.sibling;r=a,r===null?(a=t.child,t.child=null):(a=r.sibling,r.sibling=null),Ug(t,!1,a,r,i);break;case"backwards":for(r=null,a=t.child,t.child=null;a!==null;){if(e=a.alternate,e!==null&&Qp(e)===null){t.child=a;break}e=a.sibling,a.sibling=r,r=a,a=e}Ug(t,!0,r,null,i);break;case"together":Ug(t,!1,null,null,void 0);break;default:t.memoizedState=null}return t.child}function Sp(e,t){!(t.mode&1)&&e!==null&&(e.alternate=null,t.alternate=null,t.flags|=2)}function Xs(e,t,r){if(e!==null&&(t.dependencies=e.dependencies),Ql|=t.lanes,!(r&t.childLanes))return null;if(e!==null&&t.child!==e.child)throw Error(He(153));if(t.child!==null){for(e=t.child,r=Ko(e,e.pendingProps),t.child=r,r.return=t;e.sibling!==null;)e=e.sibling,r=r.sibling=Ko(e,e.pendingProps),r.return=t;r.sibling=null}return t.child}function jP(e,t,r){switch(t.tag){case 3:Nk(t),Ou();break;case 5:nk(t);break;case 1:wa(t.type)&&qp(t);break;case 4:ay(t,t.stateNode.containerInfo);break;case 10:var n=t.type._context,a=t.memoizedProps.value;hr(Xp,n._currentValue),n._currentValue=a;break;case 13:if(n=t.memoizedState,n!==null)return n.dehydrated!==null?(hr(Sr,Sr.current&1),t.flags|=128,null):r&t.child.childLanes?Pk(e,t,r):(hr(Sr,Sr.current&1),e=Xs(e,t,r),e!==null?e.sibling:null);hr(Sr,Sr.current&1);break;case 19:if(n=(r&t.childLanes)!==0,e.flags&128){if(n)return Lk(e,t,r);t.flags|=128}if(a=t.memoizedState,a!==null&&(a.rendering=null,a.tail=null,a.lastEffect=null),hr(Sr,Sr.current),n)break;return null;case 22:case 23:return t.lanes=0,Tk(e,t,r)}return Xs(e,t,r)}var Fk,xv,Ok,Dk;Fk=function(e,t){for(var r=t.child;r!==null;){if(r.tag===5||r.tag===6)e.appendChild(r.stateNode);else if(r.tag!==4&&r.child!==null){r.child.return=r,r=r.child;continue}if(r===t)break;for(;r.sibling===null;){if(r.return===null||r.return===t)return;r=r.return}r.sibling.return=r.return,r=r.sibling}};xv=function(){};Ok=function(e,t,r,n){var a=e.memoizedProps;if(a!==n){e=t.stateNode,Ml(ls.current);var i=null;switch(r){case"input":a=U2(e,a),n=U2(e,n),i=[];break;case"select":a=Ar({},a,{value:void 0}),n=Ar({},n,{value:void 0}),i=[];break;case"textarea":a=z2(e,a),n=z2(e,n),i=[];break;default:typeof a.onClick!="function"&&typeof n.onClick=="function"&&(e.onclick=Hp)}W2(r,n);var s;r=null;for(c in a)if(!n.hasOwnProperty(c)&&a.hasOwnProperty(c)&&a[c]!=null)if(c==="style"){var o=a[c];for(s in o)o.hasOwnProperty(s)&&(r||(r={}),r[s]="")}else c!=="dangerouslySetInnerHTML"&&c!=="children"&&c!=="suppressContentEditableWarning"&&c!=="suppressHydrationWarning"&&c!=="autoFocus"&&(O0.hasOwnProperty(c)?i||(i=[]):(i=i||[]).push(c,null));for(c in n){var l=n[c];if(o=a!=null?a[c]:void 0,n.hasOwnProperty(c)&&l!==o&&(l!=null||o!=null))if(c==="style")if(o){for(s in o)!o.hasOwnProperty(s)||l&&l.hasOwnProperty(s)||(r||(r={}),r[s]="");for(s in l)l.hasOwnProperty(s)&&o[s]!==l[s]&&(r||(r={}),r[s]=l[s])}else r||(i||(i=[]),i.push(c,r)),r=l;else c==="dangerouslySetInnerHTML"?(l=l?l.__html:void 0,o=o?o.__html:void 0,l!=null&&o!==l&&(i=i||[]).push(c,l)):c==="children"?typeof l!="string"&&typeof l!="number"||(i=i||[]).push(c,""+l):c!=="suppressContentEditableWarning"&&c!=="suppressHydrationWarning"&&(O0.hasOwnProperty(c)?(l!=null&&c==="onScroll"&&gr("scroll",e),i||o===l||(i=[])):(i=i||[]).push(c,l))}r&&(i=i||[]).push("style",r);var c=i;(t.updateQueue=c)&&(t.flags|=4)}};Dk=function(e,t,r,n){r!==n&&(t.flags|=4)};function Mf(e,t){if(!br)switch(e.tailMode){case"hidden":t=e.tail;for(var r=null;t!==null;)t.alternate!==null&&(r=t),t=t.sibling;r===null?e.tail=null:r.sibling=null;break;case"collapsed":r=e.tail;for(var n=null;r!==null;)r.alternate!==null&&(n=r),r=r.sibling;n===null?t||e.tail===null?e.tail=null:e.tail.sibling=null:n.sibling=null}}function Pn(e){var t=e.alternate!==null&&e.alternate.child===e.child,r=0,n=0;if(t)for(var a=e.child;a!==null;)r|=a.lanes|a.childLanes,n|=a.subtreeFlags&14680064,n|=a.flags&14680064,a.return=e,a=a.sibling;else for(a=e.child;a!==null;)r|=a.lanes|a.childLanes,n|=a.subtreeFlags,n|=a.flags,a.return=e,a=a.sibling;return e.subtreeFlags|=n,e.childLanes=r,t}function MP(e,t,r){var n=t.pendingProps;switch(Jx(t),t.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Pn(t),null;case 1:return wa(t.type)&&Wp(),Pn(t),null;case 3:return n=t.stateNode,Iu(),yr(ya),yr(Wn),sy(),n.pendingContext&&(n.context=n.pendingContext,n.pendingContext=null),(e===null||e.child===null)&&(Rd(t)?t.flags|=4:e===null||e.memoizedState.isDehydrated&&!(t.flags&256)||(t.flags|=1024,Oi!==null&&(Av(Oi),Oi=null))),xv(e,t),Pn(t),null;case 5:iy(t);var a=Ml(W0.current);if(r=t.type,e!==null&&t.stateNode!=null)Ok(e,t,r,n,a),e.ref!==t.ref&&(t.flags|=512,t.flags|=2097152);else{if(!n){if(t.stateNode===null)throw Error(He(166));return Pn(t),null}if(e=Ml(ls.current),Rd(t)){n=t.stateNode,r=t.type;var i=t.memoizedProps;switch(n[as]=t,n[z0]=i,e=(t.mode&1)!==0,r){case"dialog":gr("cancel",n),gr("close",n);break;case"iframe":case"object":case"embed":gr("load",n);break;case"video":case"audio":for(a=0;a<Xf.length;a++)gr(Xf[a],n);break;case"source":gr("error",n);break;case"img":case"image":case"link":gr("error",n),gr("load",n);break;case"details":gr("toggle",n);break;case"input":vw(n,i),gr("invalid",n);break;case"select":n._wrapperState={wasMultiple:!!i.multiple},gr("invalid",n);break;case"textarea":yw(n,i),gr("invalid",n)}W2(r,i),a=null;for(var s in i)if(i.hasOwnProperty(s)){var o=i[s];s==="children"?typeof o=="string"?n.textContent!==o&&(i.suppressHydrationWarning!==!0&&Id(n.textContent,o,e),a=["children",o]):typeof o=="number"&&n.textContent!==""+o&&(i.suppressHydrationWarning!==!0&&Id(n.textContent,o,e),a=["children",""+o]):O0.hasOwnProperty(s)&&o!=null&&s==="onScroll"&&gr("scroll",n)}switch(r){case"input":Td(n),xw(n,i,!0);break;case"textarea":Td(n),ww(n);break;case"select":case"option":break;default:typeof i.onClick=="function"&&(n.onclick=Hp)}n=a,t.updateQueue=n,n!==null&&(t.flags|=4)}else{s=a.nodeType===9?a:a.ownerDocument,e==="http://www.w3.org/1999/xhtml"&&(e=lS(r)),e==="http://www.w3.org/1999/xhtml"?r==="script"?(e=s.createElement("div"),e.innerHTML="<script><\/script>",e=e.removeChild(e.firstChild)):typeof n.is=="string"?e=s.createElement(r,{is:n.is}):(e=s.createElement(r),r==="select"&&(s=e,n.multiple?s.multiple=!0:n.size&&(s.size=n.size))):e=s.createElementNS(e,r),e[as]=t,e[z0]=n,Fk(e,t,!1,!1),t.stateNode=e;e:{switch(s=q2(r,n),r){case"dialog":gr("cancel",e),gr("close",e),a=n;break;case"iframe":case"object":case"embed":gr("load",e),a=n;break;case"video":case"audio":for(a=0;a<Xf.length;a++)gr(Xf[a],e);a=n;break;case"source":gr("error",e),a=n;break;case"img":case"image":case"link":gr("error",e),gr("load",e),a=n;break;case"details":gr("toggle",e),a=n;break;case"input":vw(e,n),a=U2(e,n),gr("invalid",e);break;case"option":a=n;break;case"select":e._wrapperState={wasMultiple:!!n.multiple},a=Ar({},n,{value:void 0}),gr("invalid",e);break;case"textarea":yw(e,n),a=z2(e,n),gr("invalid",e);break;default:a=n}W2(r,a),o=a;for(i in o)if(o.hasOwnProperty(i)){var l=o[i];i==="style"?fS(e,l):i==="dangerouslySetInnerHTML"?(l=l?l.__html:void 0,l!=null&&cS(e,l)):i==="children"?typeof l=="string"?(r!=="textarea"||l!=="")&&D0(e,l):typeof l=="number"&&D0(e,""+l):i!=="suppressContentEditableWarning"&&i!=="suppressHydrationWarning"&&i!=="autoFocus"&&(O0.hasOwnProperty(i)?l!=null&&i==="onScroll"&&gr("scroll",e):l!=null&&Rx(e,i,l,s))}switch(r){case"input":Td(e),xw(e,n,!1);break;case"textarea":Td(e),ww(e);break;case"option":n.value!=null&&e.setAttribute("value",""+Jo(n.value));break;case"select":e.multiple=!!n.multiple,i=n.value,i!=null?vu(e,!!n.multiple,i,!1):n.defaultValue!=null&&vu(e,!!n.multiple,n.defaultValue,!0);break;default:typeof a.onClick=="function"&&(e.onclick=Hp)}switch(r){case"button":case"input":case"select":case"textarea":n=!!n.autoFocus;break e;case"img":n=!0;break e;default:n=!1}}n&&(t.flags|=4)}t.ref!==null&&(t.flags|=512,t.flags|=2097152)}return Pn(t),null;case 6:if(e&&t.stateNode!=null)Dk(e,t,e.memoizedProps,n);else{if(typeof n!="string"&&t.stateNode===null)throw Error(He(166));if(r=Ml(W0.current),Ml(ls.current),Rd(t)){if(n=t.stateNode,r=t.memoizedProps,n[as]=t,(i=n.nodeValue!==r)&&(e=Ra,e!==null))switch(e.tag){case 3:Id(n.nodeValue,r,(e.mode&1)!==0);break;case 5:e.memoizedProps.suppressHydrationWarning!==!0&&Id(n.nodeValue,r,(e.mode&1)!==0)}i&&(t.flags|=4)}else n=(r.nodeType===9?r:r.ownerDocument).createTextNode(n),n[as]=t,t.stateNode=n}return Pn(t),null;case 13:if(yr(Sr),n=t.memoizedState,e===null||e.memoizedState!==null&&e.memoizedState.dehydrated!==null){if(br&&Da!==null&&t.mode&1&&!(t.flags&128))QS(),Ou(),t.flags|=98560,i=!1;else if(i=Rd(t),n!==null&&n.dehydrated!==null){if(e===null){if(!i)throw Error(He(318));if(i=t.memoizedState,i=i!==null?i.dehydrated:null,!i)throw Error(He(317));i[as]=t}else Ou(),!(t.flags&128)&&(t.memoizedState=null),t.flags|=4;Pn(t),i=!1}else Oi!==null&&(Av(Oi),Oi=null),i=!0;if(!i)return t.flags&65536?t:null}return t.flags&128?(t.lanes=r,t):(n=n!==null,n!==(e!==null&&e.memoizedState!==null)&&n&&(t.child.flags|=8192,t.mode&1&&(e===null||Sr.current&1?an===0&&(an=3):xy())),t.updateQueue!==null&&(t.flags|=4),Pn(t),null);case 4:return Iu(),xv(e,t),e===null&&V0(t.stateNode.containerInfo),Pn(t),null;case 10:return ty(t.type._context),Pn(t),null;case 17:return wa(t.type)&&Wp(),Pn(t),null;case 19:if(yr(Sr),i=t.memoizedState,i===null)return Pn(t),null;if(n=(t.flags&128)!==0,s=i.rendering,s===null)if(n)Mf(i,!1);else{if(an!==0||e!==null&&e.flags&128)for(e=t.child;e!==null;){if(s=Qp(e),s!==null){for(t.flags|=128,Mf(i,!1),n=s.updateQueue,n!==null&&(t.updateQueue=n,t.flags|=4),t.subtreeFlags=0,n=r,r=t.child;r!==null;)i=r,e=n,i.flags&=14680066,s=i.alternate,s===null?(i.childLanes=0,i.lanes=e,i.child=null,i.subtreeFlags=0,i.memoizedProps=null,i.memoizedState=null,i.updateQueue=null,i.dependencies=null,i.stateNode=null):(i.childLanes=s.childLanes,i.lanes=s.lanes,i.child=s.child,i.subtreeFlags=0,i.deletions=null,i.memoizedProps=s.memoizedProps,i.memoizedState=s.memoizedState,i.updateQueue=s.updateQueue,i.type=s.type,e=s.dependencies,i.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext}),r=r.sibling;return hr(Sr,Sr.current&1|2),t.child}e=e.sibling}i.tail!==null&&Br()>ju&&(t.flags|=128,n=!0,Mf(i,!1),t.lanes=4194304)}else{if(!n)if(e=Qp(s),e!==null){if(t.flags|=128,n=!0,r=e.updateQueue,r!==null&&(t.updateQueue=r,t.flags|=4),Mf(i,!0),i.tail===null&&i.tailMode==="hidden"&&!s.alternate&&!br)return Pn(t),null}else 2*Br()-i.renderingStartTime>ju&&r!==1073741824&&(t.flags|=128,n=!0,Mf(i,!1),t.lanes=4194304);i.isBackwards?(s.sibling=t.child,t.child=s):(r=i.last,r!==null?r.sibling=s:t.child=s,i.last=s)}return i.tail!==null?(t=i.tail,i.rendering=t,i.tail=t.sibling,i.renderingStartTime=Br(),t.sibling=null,r=Sr.current,hr(Sr,n?r&1|2:r&1),t):(Pn(t),null);case 22:case 23:return vy(),n=t.memoizedState!==null,e!==null&&e.memoizedState!==null!==n&&(t.flags|=8192),n&&t.mode&1?La&1073741824&&(Pn(t),t.subtreeFlags&6&&(t.flags|=8192)):Pn(t),null;case 24:return null;case 25:return null}throw Error(He(156,t.tag))}function BP(e,t){switch(Jx(t),t.tag){case 1:return wa(t.type)&&Wp(),e=t.flags,e&65536?(t.flags=e&-65537|128,t):null;case 3:return Iu(),yr(ya),yr(Wn),sy(),e=t.flags,e&65536&&!(e&128)?(t.flags=e&-65537|128,t):null;case 5:return iy(t),null;case 13:if(yr(Sr),e=t.memoizedState,e!==null&&e.dehydrated!==null){if(t.alternate===null)throw Error(He(340));Ou()}return e=t.flags,e&65536?(t.flags=e&-65537|128,t):null;case 19:return yr(Sr),null;case 4:return Iu(),null;case 10:return ty(t.type._context),null;case 22:case 23:return vy(),null;case 24:return null;default:return null}}var Bd=!1,Un=!1,UP=typeof WeakSet=="function"?WeakSet:Set,it=null;function lu(e,t){var r=e.ref;if(r!==null)if(typeof r=="function")try{r(null)}catch(n){Lr(e,t,n)}else r.current=null}function yv(e,t,r){try{r()}catch(n){Lr(e,t,n)}}var c4=!1;function VP(e,t){if(rv=Vp,e=BS(),Xx(e)){if("selectionStart"in e)var r={start:e.selectionStart,end:e.selectionEnd};else e:{r=(r=e.ownerDocument)&&r.defaultView||window;var n=r.getSelection&&r.getSelection();if(n&&n.rangeCount!==0){r=n.anchorNode;var a=n.anchorOffset,i=n.focusNode;n=n.focusOffset;try{r.nodeType,i.nodeType}catch{r=null;break e}var s=0,o=-1,l=-1,c=0,u=0,f=e,p=null;t:for(;;){for(var h;f!==r||a!==0&&f.nodeType!==3||(o=s+a),f!==i||n!==0&&f.nodeType!==3||(l=s+n),f.nodeType===3&&(s+=f.nodeValue.length),(h=f.firstChild)!==null;)p=f,f=h;for(;;){if(f===e)break t;if(p===r&&++c===a&&(o=s),p===i&&++u===n&&(l=s),(h=f.nextSibling)!==null)break;f=p,p=f.parentNode}f=h}r=o===-1||l===-1?null:{start:o,end:l}}else r=null}r=r||{start:0,end:0}}else r=null;for(nv={focusedElem:e,selectionRange:r},Vp=!1,it=t;it!==null;)if(t=it,e=t.child,(t.subtreeFlags&1028)!==0&&e!==null)e.return=t,it=e;else for(;it!==null;){t=it;try{var g=t.alternate;if(t.flags&1024)switch(t.tag){case 0:case 11:case 15:break;case 1:if(g!==null){var m=g.memoizedProps,b=g.memoizedState,x=t.stateNode,w=x.getSnapshotBeforeUpdate(t.elementType===t.type?m:Ti(t.type,m),b);x.__reactInternalSnapshotBeforeUpdate=w}break;case 3:var y=t.stateNode.containerInfo;y.nodeType===1?y.textContent="":y.nodeType===9&&y.documentElement&&y.removeChild(y.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(He(163))}}catch(A){Lr(t,t.return,A)}if(e=t.sibling,e!==null){e.return=t.return,it=e;break}it=t.return}return g=c4,c4=!1,g}function l0(e,t,r){var n=t.updateQueue;if(n=n!==null?n.lastEffect:null,n!==null){var a=n=n.next;do{if((a.tag&e)===e){var i=a.destroy;a.destroy=void 0,i!==void 0&&yv(t,r,i)}a=a.next}while(a!==n)}}function q1(e,t){if(t=t.updateQueue,t=t!==null?t.lastEffect:null,t!==null){var r=t=t.next;do{if((r.tag&e)===e){var n=r.create;r.destroy=n()}r=r.next}while(r!==t)}}function wv(e){var t=e.ref;if(t!==null){var r=e.stateNode;switch(e.tag){case 5:e=r;break;default:e=r}typeof t=="function"?t(e):t.current=e}}function Ik(e){var t=e.alternate;t!==null&&(e.alternate=null,Ik(t)),e.child=null,e.deletions=null,e.sibling=null,e.tag===5&&(t=e.stateNode,t!==null&&(delete t[as],delete t[z0],delete t[sv],delete t[SP],delete t[kP])),e.stateNode=null,e.return=null,e.dependencies=null,e.memoizedProps=null,e.memoizedState=null,e.pendingProps=null,e.stateNode=null,e.updateQueue=null}function Rk(e){return e.tag===5||e.tag===3||e.tag===4}function u4(e){e:for(;;){for(;e.sibling===null;){if(e.return===null||Rk(e.return))return null;e=e.return}for(e.sibling.return=e.return,e=e.sibling;e.tag!==5&&e.tag!==6&&e.tag!==18;){if(e.flags&2||e.child===null||e.tag===4)continue e;e.child.return=e,e=e.child}if(!(e.flags&2))return e.stateNode}}function bv(e,t,r){var n=e.tag;if(n===5||n===6)e=e.stateNode,t?r.nodeType===8?r.parentNode.insertBefore(e,t):r.insertBefore(e,t):(r.nodeType===8?(t=r.parentNode,t.insertBefore(e,r)):(t=r,t.appendChild(e)),r=r._reactRootContainer,r!=null||t.onclick!==null||(t.onclick=Hp));else if(n!==4&&(e=e.child,e!==null))for(bv(e,t,r),e=e.sibling;e!==null;)bv(e,t,r),e=e.sibling}function _v(e,t,r){var n=e.tag;if(n===5||n===6)e=e.stateNode,t?r.insertBefore(e,t):r.appendChild(e);else if(n!==4&&(e=e.child,e!==null))for(_v(e,t,r),e=e.sibling;e!==null;)_v(e,t,r),e=e.sibling}var wn=null,Pi=!1;function yo(e,t,r){for(r=r.child;r!==null;)jk(e,t,r),r=r.sibling}function jk(e,t,r){if(os&&typeof os.onCommitFiberUnmount=="function")try{os.onCommitFiberUnmount(M1,r)}catch{}switch(r.tag){case 5:Un||lu(r,t);case 6:var n=wn,a=Pi;wn=null,yo(e,t,r),wn=n,Pi=a,wn!==null&&(Pi?(e=wn,r=r.stateNode,e.nodeType===8?e.parentNode.removeChild(r):e.removeChild(r)):wn.removeChild(r.stateNode));break;case 18:wn!==null&&(Pi?(e=wn,r=r.stateNode,e.nodeType===8?Og(e.parentNode,r):e.nodeType===1&&Og(e,r),M0(e)):Og(wn,r.stateNode));break;case 4:n=wn,a=Pi,wn=r.stateNode.containerInfo,Pi=!0,yo(e,t,r),wn=n,Pi=a;break;case 0:case 11:case 14:case 15:if(!Un&&(n=r.updateQueue,n!==null&&(n=n.lastEffect,n!==null))){a=n=n.next;do{var i=a,s=i.destroy;i=i.tag,s!==void 0&&(i&2||i&4)&&yv(r,t,s),a=a.next}while(a!==n)}yo(e,t,r);break;case 1:if(!Un&&(lu(r,t),n=r.stateNode,typeof n.componentWillUnmount=="function"))try{n.props=r.memoizedProps,n.state=r.memoizedState,n.componentWillUnmount()}catch(o){Lr(r,t,o)}yo(e,t,r);break;case 21:yo(e,t,r);break;case 22:r.mode&1?(Un=(n=Un)||r.memoizedState!==null,yo(e,t,r),Un=n):yo(e,t,r);break;default:yo(e,t,r)}}function f4(e){var t=e.updateQueue;if(t!==null){e.updateQueue=null;var r=e.stateNode;r===null&&(r=e.stateNode=new UP),t.forEach(function(n){var a=YP.bind(null,e,n);r.has(n)||(r.add(n),n.then(a,a))})}}function bi(e,t){var r=t.deletions;if(r!==null)for(var n=0;n<r.length;n++){var a=r[n];try{var i=e,s=t,o=s;e:for(;o!==null;){switch(o.tag){case 5:wn=o.stateNode,Pi=!1;break e;case 3:wn=o.stateNode.containerInfo,Pi=!0;break e;case 4:wn=o.stateNode.containerInfo,Pi=!0;break e}o=o.return}if(wn===null)throw Error(He(160));jk(i,s,a),wn=null,Pi=!1;var l=a.alternate;l!==null&&(l.return=null),a.return=null}catch(c){Lr(a,t,c)}}if(t.subtreeFlags&12854)for(t=t.child;t!==null;)Mk(t,e),t=t.sibling}function Mk(e,t){var r=e.alternate,n=e.flags;switch(e.tag){case 0:case 11:case 14:case 15:if(bi(t,e),Zi(e),n&4){try{l0(3,e,e.return),q1(3,e)}catch(m){Lr(e,e.return,m)}try{l0(5,e,e.return)}catch(m){Lr(e,e.return,m)}}break;case 1:bi(t,e),Zi(e),n&512&&r!==null&&lu(r,r.return);break;case 5:if(bi(t,e),Zi(e),n&512&&r!==null&&lu(r,r.return),e.flags&32){var a=e.stateNode;try{D0(a,"")}catch(m){Lr(e,e.return,m)}}if(n&4&&(a=e.stateNode,a!=null)){var i=e.memoizedProps,s=r!==null?r.memoizedProps:i,o=e.type,l=e.updateQueue;if(e.updateQueue=null,l!==null)try{o==="input"&&i.type==="radio"&&i.name!=null&&sS(a,i),q2(o,s);var c=q2(o,i);for(s=0;s<l.length;s+=2){var u=l[s],f=l[s+1];u==="style"?fS(a,f):u==="dangerouslySetInnerHTML"?cS(a,f):u==="children"?D0(a,f):Rx(a,u,f,c)}switch(o){case"input":V2(a,i);break;case"textarea":oS(a,i);break;case"select":var p=a._wrapperState.wasMultiple;a._wrapperState.wasMultiple=!!i.multiple;var h=i.value;h!=null?vu(a,!!i.multiple,h,!1):p!==!!i.multiple&&(i.defaultValue!=null?vu(a,!!i.multiple,i.defaultValue,!0):vu(a,!!i.multiple,i.multiple?[]:"",!1))}a[z0]=i}catch(m){Lr(e,e.return,m)}}break;case 6:if(bi(t,e),Zi(e),n&4){if(e.stateNode===null)throw Error(He(162));a=e.stateNode,i=e.memoizedProps;try{a.nodeValue=i}catch(m){Lr(e,e.return,m)}}break;case 3:if(bi(t,e),Zi(e),n&4&&r!==null&&r.memoizedState.isDehydrated)try{M0(t.containerInfo)}catch(m){Lr(e,e.return,m)}break;case 4:bi(t,e),Zi(e);break;case 13:bi(t,e),Zi(e),a=e.child,a.flags&8192&&(i=a.memoizedState!==null,a.stateNode.isHidden=i,!i||a.alternate!==null&&a.alternate.memoizedState!==null||(my=Br())),n&4&&f4(e);break;case 22:if(u=r!==null&&r.memoizedState!==null,e.mode&1?(Un=(c=Un)||u,bi(t,e),Un=c):bi(t,e),Zi(e),n&8192){if(c=e.memoizedState!==null,(e.stateNode.isHidden=c)&&!u&&e.mode&1)for(it=e,u=e.child;u!==null;){for(f=it=u;it!==null;){switch(p=it,h=p.child,p.tag){case 0:case 11:case 14:case 15:l0(4,p,p.return);break;case 1:lu(p,p.return);var g=p.stateNode;if(typeof g.componentWillUnmount=="function"){n=p,r=p.return;try{t=n,g.props=t.memoizedProps,g.state=t.memoizedState,g.componentWillUnmount()}catch(m){Lr(n,r,m)}}break;case 5:lu(p,p.return);break;case 22:if(p.memoizedState!==null){d4(f);continue}}h!==null?(h.return=p,it=h):d4(f)}u=u.sibling}e:for(u=null,f=e;;){if(f.tag===5){if(u===null){u=f;try{a=f.stateNode,c?(i=a.style,typeof i.setProperty=="function"?i.setProperty("display","none","important"):i.display="none"):(o=f.stateNode,l=f.memoizedProps.style,s=l!=null&&l.hasOwnProperty("display")?l.display:null,o.style.display=uS("display",s))}catch(m){Lr(e,e.return,m)}}}else if(f.tag===6){if(u===null)try{f.stateNode.nodeValue=c?"":f.memoizedProps}catch(m){Lr(e,e.return,m)}}else if((f.tag!==22&&f.tag!==23||f.memoizedState===null||f===e)&&f.child!==null){f.child.return=f,f=f.child;continue}if(f===e)break e;for(;f.sibling===null;){if(f.return===null||f.return===e)break e;u===f&&(u=null),f=f.return}u===f&&(u=null),f.sibling.return=f.return,f=f.sibling}}break;case 19:bi(t,e),Zi(e),n&4&&f4(e);break;case 21:break;default:bi(t,e),Zi(e)}}function Zi(e){var t=e.flags;if(t&2){try{e:{for(var r=e.return;r!==null;){if(Rk(r)){var n=r;break e}r=r.return}throw Error(He(160))}switch(n.tag){case 5:var a=n.stateNode;n.flags&32&&(D0(a,""),n.flags&=-33);var i=u4(e);_v(e,i,a);break;case 3:case 4:var s=n.stateNode.containerInfo,o=u4(e);bv(e,o,s);break;default:throw Error(He(161))}}catch(l){Lr(e,e.return,l)}e.flags&=-3}t&4096&&(e.flags&=-4097)}function $P(e,t,r){it=e,Bk(e)}function Bk(e,t,r){for(var n=(e.mode&1)!==0;it!==null;){var a=it,i=a.child;if(a.tag===22&&n){var s=a.memoizedState!==null||Bd;if(!s){var o=a.alternate,l=o!==null&&o.memoizedState!==null||Un;o=Bd;var c=Un;if(Bd=s,(Un=l)&&!c)for(it=a;it!==null;)s=it,l=s.child,s.tag===22&&s.memoizedState!==null?p4(a):l!==null?(l.return=s,it=l):p4(a);for(;i!==null;)it=i,Bk(i),i=i.sibling;it=a,Bd=o,Un=c}h4(e)}else a.subtreeFlags&8772&&i!==null?(i.return=a,it=i):h4(e)}}function h4(e){for(;it!==null;){var t=it;if(t.flags&8772){var r=t.alternate;try{if(t.flags&8772)switch(t.tag){case 0:case 11:case 15:Un||q1(5,t);break;case 1:var n=t.stateNode;if(t.flags&4&&!Un)if(r===null)n.componentDidMount();else{var a=t.elementType===t.type?r.memoizedProps:Ti(t.type,r.memoizedProps);n.componentDidUpdate(a,r.memoizedState,n.__reactInternalSnapshotBeforeUpdate)}var i=t.updateQueue;i!==null&&Yw(t,i,n);break;case 3:var s=t.updateQueue;if(s!==null){if(r=null,t.child!==null)switch(t.child.tag){case 5:r=t.child.stateNode;break;case 1:r=t.child.stateNode}Yw(t,s,r)}break;case 5:var o=t.stateNode;if(r===null&&t.flags&4){r=o;var l=t.memoizedProps;switch(t.type){case"button":case"input":case"select":case"textarea":l.autoFocus&&r.focus();break;case"img":l.src&&(r.src=l.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(t.memoizedState===null){var c=t.alternate;if(c!==null){var u=c.memoizedState;if(u!==null){var f=u.dehydrated;f!==null&&M0(f)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(He(163))}Un||t.flags&512&&wv(t)}catch(p){Lr(t,t.return,p)}}if(t===e){it=null;break}if(r=t.sibling,r!==null){r.return=t.return,it=r;break}it=t.return}}function d4(e){for(;it!==null;){var t=it;if(t===e){it=null;break}var r=t.sibling;if(r!==null){r.return=t.return,it=r;break}it=t.return}}function p4(e){for(;it!==null;){var t=it;try{switch(t.tag){case 0:case 11:case 15:var r=t.return;try{q1(4,t)}catch(l){Lr(t,r,l)}break;case 1:var n=t.stateNode;if(typeof n.componentDidMount=="function"){var a=t.return;try{n.componentDidMount()}catch(l){Lr(t,a,l)}}var i=t.return;try{wv(t)}catch(l){Lr(t,i,l)}break;case 5:var s=t.return;try{wv(t)}catch(l){Lr(t,s,l)}}}catch(l){Lr(t,t.return,l)}if(t===e){it=null;break}var o=t.sibling;if(o!==null){o.return=t.return,it=o;break}it=t.return}}var zP=Math.ceil,t1=to.ReactCurrentDispatcher,dy=to.ReactCurrentOwner,oi=to.ReactCurrentBatchConfig,zt=0,gn=null,Qr=null,_n=0,La=0,cu=ol(0),an=0,X0=null,Ql=0,G1=0,py=0,c0=null,ga=null,my=0,ju=1/0,Fs=null,r1=!1,Sv=null,qo=null,Ud=!1,Ro=null,n1=0,u0=0,kv=null,kp=-1,Ep=0;function na(){return zt&6?Br():kp!==-1?kp:kp=Br()}function Go(e){return e.mode&1?zt&2&&_n!==0?_n&-_n:AP.transition!==null?(Ep===0&&(Ep=SS()),Ep):(e=rr,e!==0||(e=window.event,e=e===void 0?16:PS(e.type)),e):1}function Mi(e,t,r,n){if(50<u0)throw u0=0,kv=null,Error(He(185));ph(e,r,n),(!(zt&2)||e!==gn)&&(e===gn&&(!(zt&2)&&(G1|=r),an===4&&Po(e,_n)),ba(e,n),r===1&&zt===0&&!(t.mode&1)&&(ju=Br()+500,z1&&ll()))}function ba(e,t){var r=e.callbackNode;A8(e,t);var n=Up(e,e===gn?_n:0);if(n===0)r!==null&&Sw(r),e.callbackNode=null,e.callbackPriority=0;else if(t=n&-n,e.callbackPriority!==t){if(r!=null&&Sw(r),t===1)e.tag===0?EP(m4.bind(null,e)):XS(m4.bind(null,e)),bP(function(){!(zt&6)&&ll()}),r=null;else{switch(kS(n)){case 1:r=Vx;break;case 4:r=bS;break;case 16:r=Bp;break;case 536870912:r=_S;break;default:r=Bp}r=Gk(r,Uk.bind(null,e))}e.callbackPriority=t,e.callbackNode=r}}function Uk(e,t){if(kp=-1,Ep=0,zt&6)throw Error(He(327));var r=e.callbackNode;if(_u()&&e.callbackNode!==r)return null;var n=Up(e,e===gn?_n:0);if(n===0)return null;if(n&30||n&e.expiredLanes||t)t=a1(e,n);else{t=n;var a=zt;zt|=2;var i=$k();(gn!==e||_n!==t)&&(Fs=null,ju=Br()+500,$l(e,t));do try{qP();break}catch(o){Vk(e,o)}while(!0);ey(),t1.current=i,zt=a,Qr!==null?t=0:(gn=null,_n=0,t=an)}if(t!==0){if(t===2&&(a=J2(e),a!==0&&(n=a,t=Ev(e,a))),t===1)throw r=X0,$l(e,0),Po(e,n),ba(e,Br()),r;if(t===6)Po(e,n);else{if(a=e.current.alternate,!(n&30)&&!HP(a)&&(t=a1(e,n),t===2&&(i=J2(e),i!==0&&(n=i,t=Ev(e,i))),t===1))throw r=X0,$l(e,0),Po(e,n),ba(e,Br()),r;switch(e.finishedWork=a,e.finishedLanes=n,t){case 0:case 1:throw Error(He(345));case 2:Al(e,ga,Fs);break;case 3:if(Po(e,n),(n&130023424)===n&&(t=my+500-Br(),10<t)){if(Up(e,0)!==0)break;if(a=e.suspendedLanes,(a&n)!==n){na(),e.pingedLanes|=e.suspendedLanes&a;break}e.timeoutHandle=iv(Al.bind(null,e,ga,Fs),t);break}Al(e,ga,Fs);break;case 4:if(Po(e,n),(n&4194240)===n)break;for(t=e.eventTimes,a=-1;0<n;){var s=31-ji(n);i=1<<s,s=t[s],s>a&&(a=s),n&=~i}if(n=a,n=Br()-n,n=(120>n?120:480>n?480:1080>n?1080:1920>n?1920:3e3>n?3e3:4320>n?4320:1960*zP(n/1960))-n,10<n){e.timeoutHandle=iv(Al.bind(null,e,ga,Fs),n);break}Al(e,ga,Fs);break;case 5:Al(e,ga,Fs);break;default:throw Error(He(329))}}}return ba(e,Br()),e.callbackNode===r?Uk.bind(null,e):null}function Ev(e,t){var r=c0;return e.current.memoizedState.isDehydrated&&($l(e,t).flags|=256),e=a1(e,t),e!==2&&(t=ga,ga=r,t!==null&&Av(t)),e}function Av(e){ga===null?ga=e:ga.push.apply(ga,e)}function HP(e){for(var t=e;;){if(t.flags&16384){var r=t.updateQueue;if(r!==null&&(r=r.stores,r!==null))for(var n=0;n<r.length;n++){var a=r[n],i=a.getSnapshot;a=a.value;try{if(!Vi(i(),a))return!1}catch{return!1}}}if(r=t.child,t.subtreeFlags&16384&&r!==null)r.return=t,t=r;else{if(t===e)break;for(;t.sibling===null;){if(t.return===null||t.return===e)return!0;t=t.return}t.sibling.return=t.return,t=t.sibling}}return!0}function Po(e,t){for(t&=~py,t&=~G1,e.suspendedLanes|=t,e.pingedLanes&=~t,e=e.expirationTimes;0<t;){var r=31-ji(t),n=1<<r;e[r]=-1,t&=~n}}function m4(e){if(zt&6)throw Error(He(327));_u();var t=Up(e,0);if(!(t&1))return ba(e,Br()),null;var r=a1(e,t);if(e.tag!==0&&r===2){var n=J2(e);n!==0&&(t=n,r=Ev(e,n))}if(r===1)throw r=X0,$l(e,0),Po(e,t),ba(e,Br()),r;if(r===6)throw Error(He(345));return e.finishedWork=e.current.alternate,e.finishedLanes=t,Al(e,ga,Fs),ba(e,Br()),null}function gy(e,t){var r=zt;zt|=1;try{return e(t)}finally{zt=r,zt===0&&(ju=Br()+500,z1&&ll())}}function Zl(e){Ro!==null&&Ro.tag===0&&!(zt&6)&&_u();var t=zt;zt|=1;var r=oi.transition,n=rr;try{if(oi.transition=null,rr=1,e)return e()}finally{rr=n,oi.transition=r,zt=t,!(zt&6)&&ll()}}function vy(){La=cu.current,yr(cu)}function $l(e,t){e.finishedWork=null,e.finishedLanes=0;var r=e.timeoutHandle;if(r!==-1&&(e.timeoutHandle=-1,wP(r)),Qr!==null)for(r=Qr.return;r!==null;){var n=r;switch(Jx(n),n.tag){case 1:n=n.type.childContextTypes,n!=null&&Wp();break;case 3:Iu(),yr(ya),yr(Wn),sy();break;case 5:iy(n);break;case 4:Iu();break;case 13:yr(Sr);break;case 19:yr(Sr);break;case 10:ty(n.type._context);break;case 22:case 23:vy()}r=r.return}if(gn=e,Qr=e=Ko(e.current,null),_n=La=t,an=0,X0=null,py=G1=Ql=0,ga=c0=null,jl!==null){for(t=0;t<jl.length;t++)if(r=jl[t],n=r.interleaved,n!==null){r.interleaved=null;var a=n.next,i=r.pending;if(i!==null){var s=i.next;i.next=a,n.next=s}r.pending=n}jl=null}return e}function Vk(e,t){do{var r=Qr;try{if(ey(),bp.current=e1,Zp){for(var n=Er.memoizedState;n!==null;){var a=n.queue;a!==null&&(a.pending=null),n=n.next}Zp=!1}if(Jl=0,pn=nn=Er=null,o0=!1,q0=0,dy.current=null,r===null||r.return===null){an=1,X0=t,Qr=null;break}e:{var i=e,s=r.return,o=r,l=t;if(t=_n,o.flags|=32768,l!==null&&typeof l=="object"&&typeof l.then=="function"){var c=l,u=o,f=u.tag;if(!(u.mode&1)&&(f===0||f===11||f===15)){var p=u.alternate;p?(u.updateQueue=p.updateQueue,u.memoizedState=p.memoizedState,u.lanes=p.lanes):(u.updateQueue=null,u.memoizedState=null)}var h=r4(s);if(h!==null){h.flags&=-257,n4(h,s,o,i,t),h.mode&1&&t4(i,c,t),t=h,l=c;var g=t.updateQueue;if(g===null){var m=new Set;m.add(l),t.updateQueue=m}else g.add(l);break e}else{if(!(t&1)){t4(i,c,t),xy();break e}l=Error(He(426))}}else if(br&&o.mode&1){var b=r4(s);if(b!==null){!(b.flags&65536)&&(b.flags|=256),n4(b,s,o,i,t),Qx(Ru(l,o));break e}}i=l=Ru(l,o),an!==4&&(an=2),c0===null?c0=[i]:c0.push(i),i=s;do{switch(i.tag){case 3:i.flags|=65536,t&=-t,i.lanes|=t;var x=kk(i,l,t);Xw(i,x);break e;case 1:o=l;var w=i.type,y=i.stateNode;if(!(i.flags&128)&&(typeof w.getDerivedStateFromError=="function"||y!==null&&typeof y.componentDidCatch=="function"&&(qo===null||!qo.has(y)))){i.flags|=65536,t&=-t,i.lanes|=t;var A=Ek(i,o,t);Xw(i,A);break e}}i=i.return}while(i!==null)}Hk(r)}catch(L){t=L,Qr===r&&r!==null&&(Qr=r=r.return);continue}break}while(!0)}function $k(){var e=t1.current;return t1.current=e1,e===null?e1:e}function xy(){(an===0||an===3||an===2)&&(an=4),gn===null||!(Ql&268435455)&&!(G1&268435455)||Po(gn,_n)}function a1(e,t){var r=zt;zt|=2;var n=$k();(gn!==e||_n!==t)&&(Fs=null,$l(e,t));do try{WP();break}catch(a){Vk(e,a)}while(!0);if(ey(),zt=r,t1.current=n,Qr!==null)throw Error(He(261));return gn=null,_n=0,an}function WP(){for(;Qr!==null;)zk(Qr)}function qP(){for(;Qr!==null&&!v8();)zk(Qr)}function zk(e){var t=qk(e.alternate,e,La);e.memoizedProps=e.pendingProps,t===null?Hk(e):Qr=t,dy.current=null}function Hk(e){var t=e;do{var r=t.alternate;if(e=t.return,t.flags&32768){if(r=BP(r,t),r!==null){r.flags&=32767,Qr=r;return}if(e!==null)e.flags|=32768,e.subtreeFlags=0,e.deletions=null;else{an=6,Qr=null;return}}else if(r=MP(r,t,La),r!==null){Qr=r;return}if(t=t.sibling,t!==null){Qr=t;return}Qr=t=e}while(t!==null);an===0&&(an=5)}function Al(e,t,r){var n=rr,a=oi.transition;try{oi.transition=null,rr=1,GP(e,t,r,n)}finally{oi.transition=a,rr=n}return null}function GP(e,t,r,n){do _u();while(Ro!==null);if(zt&6)throw Error(He(327));r=e.finishedWork;var a=e.finishedLanes;if(r===null)return null;if(e.finishedWork=null,e.finishedLanes=0,r===e.current)throw Error(He(177));e.callbackNode=null,e.callbackPriority=0;var i=r.lanes|r.childLanes;if(T8(e,i),e===gn&&(Qr=gn=null,_n=0),!(r.subtreeFlags&2064)&&!(r.flags&2064)||Ud||(Ud=!0,Gk(Bp,function(){return _u(),null})),i=(r.flags&15990)!==0,r.subtreeFlags&15990||i){i=oi.transition,oi.transition=null;var s=rr;rr=1;var o=zt;zt|=4,dy.current=null,VP(e,r),Mk(r,e),dP(nv),Vp=!!rv,nv=rv=null,e.current=r,$P(r),x8(),zt=o,rr=s,oi.transition=i}else e.current=r;if(Ud&&(Ud=!1,Ro=e,n1=a),i=e.pendingLanes,i===0&&(qo=null),b8(r.stateNode),ba(e,Br()),t!==null)for(n=e.onRecoverableError,r=0;r<t.length;r++)a=t[r],n(a.value,{componentStack:a.stack,digest:a.digest});if(r1)throw r1=!1,e=Sv,Sv=null,e;return n1&1&&e.tag!==0&&_u(),i=e.pendingLanes,i&1?e===kv?u0++:(u0=0,kv=e):u0=0,ll(),null}function _u(){if(Ro!==null){var e=kS(n1),t=oi.transition,r=rr;try{if(oi.transition=null,rr=16>e?16:e,Ro===null)var n=!1;else{if(e=Ro,Ro=null,n1=0,zt&6)throw Error(He(331));var a=zt;for(zt|=4,it=e.current;it!==null;){var i=it,s=i.child;if(it.flags&16){var o=i.deletions;if(o!==null){for(var l=0;l<o.length;l++){var c=o[l];for(it=c;it!==null;){var u=it;switch(u.tag){case 0:case 11:case 15:l0(8,u,i)}var f=u.child;if(f!==null)f.return=u,it=f;else for(;it!==null;){u=it;var p=u.sibling,h=u.return;if(Ik(u),u===c){it=null;break}if(p!==null){p.return=h,it=p;break}it=h}}}var g=i.alternate;if(g!==null){var m=g.child;if(m!==null){g.child=null;do{var b=m.sibling;m.sibling=null,m=b}while(m!==null)}}it=i}}if(i.subtreeFlags&2064&&s!==null)s.return=i,it=s;else e:for(;it!==null;){if(i=it,i.flags&2048)switch(i.tag){case 0:case 11:case 15:l0(9,i,i.return)}var x=i.sibling;if(x!==null){x.return=i.return,it=x;break e}it=i.return}}var w=e.current;for(it=w;it!==null;){s=it;var y=s.child;if(s.subtreeFlags&2064&&y!==null)y.return=s,it=y;else e:for(s=w;it!==null;){if(o=it,o.flags&2048)try{switch(o.tag){case 0:case 11:case 15:q1(9,o)}}catch(L){Lr(o,o.return,L)}if(o===s){it=null;break e}var A=o.sibling;if(A!==null){A.return=o.return,it=A;break e}it=o.return}}if(zt=a,ll(),os&&typeof os.onPostCommitFiberRoot=="function")try{os.onPostCommitFiberRoot(M1,e)}catch{}n=!0}return n}finally{rr=r,oi.transition=t}}return!1}function g4(e,t,r){t=Ru(r,t),t=kk(e,t,1),e=Wo(e,t,1),t=na(),e!==null&&(ph(e,1,t),ba(e,t))}function Lr(e,t,r){if(e.tag===3)g4(e,e,r);else for(;t!==null;){if(t.tag===3){g4(t,e,r);break}else if(t.tag===1){var n=t.stateNode;if(typeof t.type.getDerivedStateFromError=="function"||typeof n.componentDidCatch=="function"&&(qo===null||!qo.has(n))){e=Ru(r,e),e=Ek(t,e,1),t=Wo(t,e,1),e=na(),t!==null&&(ph(t,1,e),ba(t,e));break}}t=t.return}}function KP(e,t,r){var n=e.pingCache;n!==null&&n.delete(t),t=na(),e.pingedLanes|=e.suspendedLanes&r,gn===e&&(_n&r)===r&&(an===4||an===3&&(_n&130023424)===_n&&500>Br()-my?$l(e,0):py|=r),ba(e,t)}function Wk(e,t){t===0&&(e.mode&1?(t=Pd,Pd<<=1,!(Pd&130023424)&&(Pd=4194304)):t=1);var r=na();e=Ks(e,t),e!==null&&(ph(e,t,r),ba(e,r))}function XP(e){var t=e.memoizedState,r=0;t!==null&&(r=t.retryLane),Wk(e,r)}function YP(e,t){var r=0;switch(e.tag){case 13:var n=e.stateNode,a=e.memoizedState;a!==null&&(r=a.retryLane);break;case 19:n=e.stateNode;break;default:throw Error(He(314))}n!==null&&n.delete(t),Wk(e,r)}var qk;qk=function(e,t,r){if(e!==null)if(e.memoizedProps!==t.pendingProps||ya.current)xa=!0;else{if(!(e.lanes&r)&&!(t.flags&128))return xa=!1,jP(e,t,r);xa=!!(e.flags&131072)}else xa=!1,br&&t.flags&1048576&&YS(t,Kp,t.index);switch(t.lanes=0,t.tag){case 2:var n=t.type;Sp(e,t),e=t.pendingProps;var a=Fu(t,Wn.current);bu(t,r),a=ly(null,t,n,e,a,r);var i=cy();return t.flags|=1,typeof a=="object"&&a!==null&&typeof a.render=="function"&&a.$$typeof===void 0?(t.tag=1,t.memoizedState=null,t.updateQueue=null,wa(n)?(i=!0,qp(t)):i=!1,t.memoizedState=a.state!==null&&a.state!==void 0?a.state:null,ny(t),a.updater=W1,t.stateNode=a,a._reactInternals=t,hv(t,n,e,r),t=mv(null,t,n,!0,i,r)):(t.tag=0,br&&i&&Yx(t),Qn(null,t,a,r),t=t.child),t;case 16:n=t.elementType;e:{switch(Sp(e,t),e=t.pendingProps,a=n._init,n=a(n._payload),t.type=n,a=t.tag=QP(n),e=Ti(n,e),a){case 0:t=pv(null,t,n,e,r);break e;case 1:t=s4(null,t,n,e,r);break e;case 11:t=a4(null,t,n,e,r);break e;case 14:t=i4(null,t,n,Ti(n.type,e),r);break e}throw Error(He(306,n,""))}return t;case 0:return n=t.type,a=t.pendingProps,a=t.elementType===n?a:Ti(n,a),pv(e,t,n,a,r);case 1:return n=t.type,a=t.pendingProps,a=t.elementType===n?a:Ti(n,a),s4(e,t,n,a,r);case 3:e:{if(Nk(t),e===null)throw Error(He(387));n=t.pendingProps,i=t.memoizedState,a=i.element,rk(e,t),Jp(t,n,null,r);var s=t.memoizedState;if(n=s.element,i.isDehydrated)if(i={element:n,isDehydrated:!1,cache:s.cache,pendingSuspenseBoundaries:s.pendingSuspenseBoundaries,transitions:s.transitions},t.updateQueue.baseState=i,t.memoizedState=i,t.flags&256){a=Ru(Error(He(423)),t),t=o4(e,t,n,r,a);break e}else if(n!==a){a=Ru(Error(He(424)),t),t=o4(e,t,n,r,a);break e}else for(Da=Ho(t.stateNode.containerInfo.firstChild),Ra=t,br=!0,Oi=null,r=ek(t,null,n,r),t.child=r;r;)r.flags=r.flags&-3|4096,r=r.sibling;else{if(Ou(),n===a){t=Xs(e,t,r);break e}Qn(e,t,n,r)}t=t.child}return t;case 5:return nk(t),e===null&&cv(t),n=t.type,a=t.pendingProps,i=e!==null?e.memoizedProps:null,s=a.children,av(n,a)?s=null:i!==null&&av(n,i)&&(t.flags|=32),Ck(e,t),Qn(e,t,s,r),t.child;case 6:return e===null&&cv(t),null;case 13:return Pk(e,t,r);case 4:return ay(t,t.stateNode.containerInfo),n=t.pendingProps,e===null?t.child=Du(t,null,n,r):Qn(e,t,n,r),t.child;case 11:return n=t.type,a=t.pendingProps,a=t.elementType===n?a:Ti(n,a),a4(e,t,n,a,r);case 7:return Qn(e,t,t.pendingProps,r),t.child;case 8:return Qn(e,t,t.pendingProps.children,r),t.child;case 12:return Qn(e,t,t.pendingProps.children,r),t.child;case 10:e:{if(n=t.type._context,a=t.pendingProps,i=t.memoizedProps,s=a.value,hr(Xp,n._currentValue),n._currentValue=s,i!==null)if(Vi(i.value,s)){if(i.children===a.children&&!ya.current){t=Xs(e,t,r);break e}}else for(i=t.child,i!==null&&(i.return=t);i!==null;){var o=i.dependencies;if(o!==null){s=i.child;for(var l=o.firstContext;l!==null;){if(l.context===n){if(i.tag===1){l=Us(-1,r&-r),l.tag=2;var c=i.updateQueue;if(c!==null){c=c.shared;var u=c.pending;u===null?l.next=l:(l.next=u.next,u.next=l),c.pending=l}}i.lanes|=r,l=i.alternate,l!==null&&(l.lanes|=r),uv(i.return,r,t),o.lanes|=r;break}l=l.next}}else if(i.tag===10)s=i.type===t.type?null:i.child;else if(i.tag===18){if(s=i.return,s===null)throw Error(He(341));s.lanes|=r,o=s.alternate,o!==null&&(o.lanes|=r),uv(s,r,t),s=i.sibling}else s=i.child;if(s!==null)s.return=i;else for(s=i;s!==null;){if(s===t){s=null;break}if(i=s.sibling,i!==null){i.return=s.return,s=i;break}s=s.return}i=s}Qn(e,t,a.children,r),t=t.child}return t;case 9:return a=t.type,n=t.pendingProps.children,bu(t,r),a=ci(a),n=n(a),t.flags|=1,Qn(e,t,n,r),t.child;case 14:return n=t.type,a=Ti(n,t.pendingProps),a=Ti(n.type,a),i4(e,t,n,a,r);case 15:return Ak(e,t,t.type,t.pendingProps,r);case 17:return n=t.type,a=t.pendingProps,a=t.elementType===n?a:Ti(n,a),Sp(e,t),t.tag=1,wa(n)?(e=!0,qp(t)):e=!1,bu(t,r),Sk(t,n,a),hv(t,n,a,r),mv(null,t,n,!0,e,r);case 19:return Lk(e,t,r);case 22:return Tk(e,t,r)}throw Error(He(156,t.tag))};function Gk(e,t){return wS(e,t)}function JP(e,t,r,n){this.tag=e,this.key=r,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=t,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=n,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function si(e,t,r,n){return new JP(e,t,r,n)}function yy(e){return e=e.prototype,!(!e||!e.isReactComponent)}function QP(e){if(typeof e=="function")return yy(e)?1:0;if(e!=null){if(e=e.$$typeof,e===Mx)return 11;if(e===Bx)return 14}return 2}function Ko(e,t){var r=e.alternate;return r===null?(r=si(e.tag,t,e.key,e.mode),r.elementType=e.elementType,r.type=e.type,r.stateNode=e.stateNode,r.alternate=e,e.alternate=r):(r.pendingProps=t,r.type=e.type,r.flags=0,r.subtreeFlags=0,r.deletions=null),r.flags=e.flags&14680064,r.childLanes=e.childLanes,r.lanes=e.lanes,r.child=e.child,r.memoizedProps=e.memoizedProps,r.memoizedState=e.memoizedState,r.updateQueue=e.updateQueue,t=e.dependencies,r.dependencies=t===null?null:{lanes:t.lanes,firstContext:t.firstContext},r.sibling=e.sibling,r.index=e.index,r.ref=e.ref,r}function Ap(e,t,r,n,a,i){var s=2;if(n=e,typeof e=="function")yy(e)&&(s=1);else if(typeof e=="string")s=5;else e:switch(e){case Zc:return zl(r.children,a,i,t);case jx:s=8,a|=8;break;case R2:return e=si(12,r,t,a|2),e.elementType=R2,e.lanes=i,e;case j2:return e=si(13,r,t,a),e.elementType=j2,e.lanes=i,e;case M2:return e=si(19,r,t,a),e.elementType=M2,e.lanes=i,e;case nS:return K1(r,a,i,t);default:if(typeof e=="object"&&e!==null)switch(e.$$typeof){case tS:s=10;break e;case rS:s=9;break e;case Mx:s=11;break e;case Bx:s=14;break e;case Eo:s=16,n=null;break e}throw Error(He(130,e==null?e:typeof e,""))}return t=si(s,r,t,a),t.elementType=e,t.type=n,t.lanes=i,t}function zl(e,t,r,n){return e=si(7,e,n,t),e.lanes=r,e}function K1(e,t,r,n){return e=si(22,e,n,t),e.elementType=nS,e.lanes=r,e.stateNode={isHidden:!1},e}function Vg(e,t,r){return e=si(6,e,null,t),e.lanes=r,e}function $g(e,t,r){return t=si(4,e.children!==null?e.children:[],e.key,t),t.lanes=r,t.stateNode={containerInfo:e.containerInfo,pendingChildren:null,implementation:e.implementation},t}function ZP(e,t,r,n,a){this.tag=t,this.containerInfo=e,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=_g(0),this.expirationTimes=_g(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=_g(0),this.identifierPrefix=n,this.onRecoverableError=a,this.mutableSourceEagerHydrationData=null}function wy(e,t,r,n,a,i,s,o,l){return e=new ZP(e,t,r,o,l),t===1?(t=1,i===!0&&(t|=8)):t=0,i=si(3,null,null,t),e.current=i,i.stateNode=e,i.memoizedState={element:n,isDehydrated:r,cache:null,transitions:null,pendingSuspenseBoundaries:null},ny(i),e}function eL(e,t,r){var n=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:Qc,key:n==null?null:""+n,children:e,containerInfo:t,implementation:r}}function Kk(e){if(!e)return Qo;e=e._reactInternals;e:{if(ic(e)!==e||e.tag!==1)throw Error(He(170));var t=e;do{switch(t.tag){case 3:t=t.stateNode.context;break e;case 1:if(wa(t.type)){t=t.stateNode.__reactInternalMemoizedMergedChildContext;break e}}t=t.return}while(t!==null);throw Error(He(171))}if(e.tag===1){var r=e.type;if(wa(r))return KS(e,r,t)}return t}function Xk(e,t,r,n,a,i,s,o,l){return e=wy(r,n,!0,e,a,i,s,o,l),e.context=Kk(null),r=e.current,n=na(),a=Go(r),i=Us(n,a),i.callback=t??null,Wo(r,i,a),e.current.lanes=a,ph(e,a,n),ba(e,n),e}function X1(e,t,r,n){var a=t.current,i=na(),s=Go(a);return r=Kk(r),t.context===null?t.context=r:t.pendingContext=r,t=Us(i,s),t.payload={element:e},n=n===void 0?null:n,n!==null&&(t.callback=n),e=Wo(a,t,s),e!==null&&(Mi(e,a,s,i),wp(e,a,s)),s}function i1(e){if(e=e.current,!e.child)return null;switch(e.child.tag){case 5:return e.child.stateNode;default:return e.child.stateNode}}function v4(e,t){if(e=e.memoizedState,e!==null&&e.dehydrated!==null){var r=e.retryLane;e.retryLane=r!==0&&r<t?r:t}}function by(e,t){v4(e,t),(e=e.alternate)&&v4(e,t)}function tL(){return null}var Yk=typeof reportError=="function"?reportError:function(e){console.error(e)};function _y(e){this._internalRoot=e}Y1.prototype.render=_y.prototype.render=function(e){var t=this._internalRoot;if(t===null)throw Error(He(409));X1(e,t,null,null)};Y1.prototype.unmount=_y.prototype.unmount=function(){var e=this._internalRoot;if(e!==null){this._internalRoot=null;var t=e.containerInfo;Zl(function(){X1(null,e,null,null)}),t[Gs]=null}};function Y1(e){this._internalRoot=e}Y1.prototype.unstable_scheduleHydration=function(e){if(e){var t=TS();e={blockedOn:null,target:e,priority:t};for(var r=0;r<No.length&&t!==0&&t<No[r].priority;r++);No.splice(r,0,e),r===0&&NS(e)}};function Sy(e){return!(!e||e.nodeType!==1&&e.nodeType!==9&&e.nodeType!==11)}function J1(e){return!(!e||e.nodeType!==1&&e.nodeType!==9&&e.nodeType!==11&&(e.nodeType!==8||e.nodeValue!==" react-mount-point-unstable "))}function x4(){}function rL(e,t,r,n,a){if(a){if(typeof n=="function"){var i=n;n=function(){var c=i1(s);i.call(c)}}var s=Xk(t,n,e,0,null,!1,!1,"",x4);return e._reactRootContainer=s,e[Gs]=s.current,V0(e.nodeType===8?e.parentNode:e),Zl(),s}for(;a=e.lastChild;)e.removeChild(a);if(typeof n=="function"){var o=n;n=function(){var c=i1(l);o.call(c)}}var l=wy(e,0,!1,null,null,!1,!1,"",x4);return e._reactRootContainer=l,e[Gs]=l.current,V0(e.nodeType===8?e.parentNode:e),Zl(function(){X1(t,l,r,n)}),l}function Q1(e,t,r,n,a){var i=r._reactRootContainer;if(i){var s=i;if(typeof a=="function"){var o=a;a=function(){var l=i1(s);o.call(l)}}X1(t,s,e,a)}else s=rL(r,t,e,a,n);return i1(s)}ES=function(e){switch(e.tag){case 3:var t=e.stateNode;if(t.current.memoizedState.isDehydrated){var r=Kf(t.pendingLanes);r!==0&&($x(t,r|1),ba(t,Br()),!(zt&6)&&(ju=Br()+500,ll()))}break;case 13:Zl(function(){var n=Ks(e,1);if(n!==null){var a=na();Mi(n,e,1,a)}}),by(e,1)}};zx=function(e){if(e.tag===13){var t=Ks(e,134217728);if(t!==null){var r=na();Mi(t,e,134217728,r)}by(e,134217728)}};AS=function(e){if(e.tag===13){var t=Go(e),r=Ks(e,t);if(r!==null){var n=na();Mi(r,e,t,n)}by(e,t)}};TS=function(){return rr};CS=function(e,t){var r=rr;try{return rr=e,t()}finally{rr=r}};K2=function(e,t,r){switch(t){case"input":if(V2(e,r),t=r.name,r.type==="radio"&&t!=null){for(r=e;r.parentNode;)r=r.parentNode;for(r=r.querySelectorAll("input[name="+JSON.stringify(""+t)+'][type="radio"]'),t=0;t<r.length;t++){var n=r[t];if(n!==e&&n.form===e.form){var a=$1(n);if(!a)throw Error(He(90));iS(n),V2(n,a)}}}break;case"textarea":oS(e,r);break;case"select":t=r.value,t!=null&&vu(e,!!r.multiple,t,!1)}};pS=gy;mS=Zl;var nL={usingClientEntryPoint:!1,Events:[gh,nu,$1,hS,dS,gy]},Bf={findFiberByHostInstance:Rl,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},aL={bundleType:Bf.bundleType,version:Bf.version,rendererPackageName:Bf.rendererPackageName,rendererConfig:Bf.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:to.ReactCurrentDispatcher,findHostInstanceByFiber:function(e){return e=xS(e),e===null?null:e.stateNode},findFiberByHostInstance:Bf.findFiberByHostInstance||tL,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var Vd=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!Vd.isDisabled&&Vd.supportsFiber)try{M1=Vd.inject(aL),os=Vd}catch{}}Ua.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=nL;Ua.createPortal=function(e,t){var r=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!Sy(t))throw Error(He(200));return eL(e,t,null,r)};Ua.createRoot=function(e,t){if(!Sy(e))throw Error(He(299));var r=!1,n="",a=Yk;return t!=null&&(t.unstable_strictMode===!0&&(r=!0),t.identifierPrefix!==void 0&&(n=t.identifierPrefix),t.onRecoverableError!==void 0&&(a=t.onRecoverableError)),t=wy(e,1,!1,null,null,r,!1,n,a),e[Gs]=t.current,V0(e.nodeType===8?e.parentNode:e),new _y(t)};Ua.findDOMNode=function(e){if(e==null)return null;if(e.nodeType===1)return e;var t=e._reactInternals;if(t===void 0)throw typeof e.render=="function"?Error(He(188)):(e=Object.keys(e).join(","),Error(He(268,e)));return e=xS(t),e=e===null?null:e.stateNode,e};Ua.flushSync=function(e){return Zl(e)};Ua.hydrate=function(e,t,r){if(!J1(t))throw Error(He(200));return Q1(null,e,t,!0,r)};Ua.hydrateRoot=function(e,t,r){if(!Sy(e))throw Error(He(405));var n=r!=null&&r.hydratedSources||null,a=!1,i="",s=Yk;if(r!=null&&(r.unstable_strictMode===!0&&(a=!0),r.identifierPrefix!==void 0&&(i=r.identifierPrefix),r.onRecoverableError!==void 0&&(s=r.onRecoverableError)),t=Xk(t,null,e,1,r??null,a,!1,i,s),e[Gs]=t.current,V0(e),n)for(e=0;e<n.length;e++)r=n[e],a=r._getVersion,a=a(r._source),t.mutableSourceEagerHydrationData==null?t.mutableSourceEagerHydrationData=[r,a]:t.mutableSourceEagerHydrationData.push(r,a);return new Y1(t)};Ua.render=function(e,t,r){if(!J1(t))throw Error(He(200));return Q1(null,e,t,!1,r)};Ua.unmountComponentAtNode=function(e){if(!J1(e))throw Error(He(40));return e._reactRootContainer?(Zl(function(){Q1(null,null,e,!1,function(){e._reactRootContainer=null,e[Gs]=null})}),!0):!1};Ua.unstable_batchedUpdates=gy;Ua.unstable_renderSubtreeIntoContainer=function(e,t,r,n){if(!J1(r))throw Error(He(200));if(e==null||e._reactInternals===void 0)throw Error(He(38));return Q1(e,t,r,!1,n)};Ua.version="18.3.1-next-f1338f8080-20240426";function Jk(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(Jk)}catch(e){console.error(e)}}Jk(),J_.exports=Ua;var Qk=J_.exports,Zk,y4=Qk;Zk=y4.createRoot,y4.hydrateRoot;let iL={data:""},sL=e=>typeof window=="object"?((e?e.querySelector("#_goober"):window._goober)||Object.assign((e||document.head).appendChild(document.createElement("style")),{innerHTML:" ",id:"_goober"})).firstChild:e||iL,oL=/(?:([\u0080-\uFFFF\w-%@]+) *:? *([^{;]+?);|([^;}{]*?) *{)|(}\s*)/g,lL=/\/\*[^]*?\*\/|  +/g,w4=/\n+/g,Lo=(e,t)=>{let r="",n="",a="";for(let i in e){let s=e[i];i[0]=="@"?i[1]=="i"?r=i+" "+s+";":n+=i[1]=="f"?Lo(s,i):i+"{"+Lo(s,i[1]=="k"?"":t)+"}":typeof s=="object"?n+=Lo(s,t?t.replace(/([^,])+/g,o=>i.replace(/([^,]*:\S+\([^)]*\))|([^,])+/g,l=>/&/.test(l)?l.replace(/&/g,o):o?o+" "+l:l)):i):s!=null&&(i=/^--/.test(i)?i:i.replace(/[A-Z]/g,"-$&").toLowerCase(),a+=Lo.p?Lo.p(i,s):i+":"+s+";")}return r+(t&&a?t+"{"+a+"}":a)+n},Ns={},eE=e=>{if(typeof e=="object"){let t="";for(let r in e)t+=r+eE(e[r]);return t}return e},cL=(e,t,r,n,a)=>{let i=eE(e),s=Ns[i]||(Ns[i]=(l=>{let c=0,u=11;for(;c<l.length;)u=101*u+l.charCodeAt(c++)>>>0;return"go"+u})(i));if(!Ns[s]){let l=i!==e?e:(c=>{let u,f,p=[{}];for(;u=oL.exec(c.replace(lL,""));)u[4]?p.shift():u[3]?(f=u[3].replace(w4," ").trim(),p.unshift(p[0][f]=p[0][f]||{})):p[0][u[1]]=u[2].replace(w4," ").trim();return p[0]})(e);Ns[s]=Lo(a?{["@keyframes "+s]:l}:l,r?"":"."+s)}let o=r&&Ns.g?Ns.g:null;return r&&(Ns.g=Ns[s]),((l,c,u,f)=>{f?c.data=c.data.replace(f,l):c.data.indexOf(l)===-1&&(c.data=u?l+c.data:c.data+l)})(Ns[s],t,n,o),s},uL=(e,t,r)=>e.reduce((n,a,i)=>{let s=t[i];if(s&&s.call){let o=s(r),l=o&&o.props&&o.props.className||/^go/.test(o)&&o;s=l?"."+l:o&&typeof o=="object"?o.props?"":Lo(o,""):o===!1?"":o}return n+a+(s??"")},"");function Z1(e){let t=this||{},r=e.call?e(t.p):e;return cL(r.unshift?r.raw?uL(r,[].slice.call(arguments,1),t.p):r.reduce((n,a)=>Object.assign(n,a&&a.call?a(t.p):a),{}):r,sL(t.target),t.g,t.o,t.k)}let tE,Tv,Cv;Z1.bind({g:1});let Ys=Z1.bind({k:1});function fL(e,t,r,n){Lo.p=t,tE=e,Tv=r,Cv=n}function cl(e,t){let r=this||{};return function(){let n=arguments;function a(i,s){let o=Object.assign({},i),l=o.className||a.className;r.p=Object.assign({theme:Tv&&Tv()},o),r.o=/ *go\d+/.test(l),o.className=Z1.apply(r,n)+(l?" "+l:"");let c=e;return e[0]&&(c=o.as||e,delete o.as),Cv&&c[0]&&Cv(o),tE(c,o)}return a}}var hL=e=>typeof e=="function",s1=(e,t)=>hL(e)?e(t):e,dL=(()=>{let e=0;return()=>(++e).toString()})(),rE=(()=>{let e;return()=>{if(e===void 0&&typeof window<"u"){let t=matchMedia("(prefers-reduced-motion: reduce)");e=!t||t.matches}return e}})(),pL=20,nE=(e,t)=>{switch(t.type){case 0:return{...e,toasts:[t.toast,...e.toasts].slice(0,pL)};case 1:return{...e,toasts:e.toasts.map(i=>i.id===t.toast.id?{...i,...t.toast}:i)};case 2:let{toast:r}=t;return nE(e,{type:e.toasts.find(i=>i.id===r.id)?1:0,toast:r});case 3:let{toastId:n}=t;return{...e,toasts:e.toasts.map(i=>i.id===n||n===void 0?{...i,dismissed:!0,visible:!1}:i)};case 4:return t.toastId===void 0?{...e,toasts:[]}:{...e,toasts:e.toasts.filter(i=>i.id!==t.toastId)};case 5:return{...e,pausedAt:t.time};case 6:let a=t.time-(e.pausedAt||0);return{...e,pausedAt:void 0,toasts:e.toasts.map(i=>({...i,pauseDuration:i.pauseDuration+a}))}}},Tp=[],Bl={toasts:[],pausedAt:void 0},sc=e=>{Bl=nE(Bl,e),Tp.forEach(t=>{t(Bl)})},mL={blank:4e3,error:4e3,success:2e3,loading:1/0,custom:4e3},gL=(e={})=>{let[t,r]=ie.useState(Bl),n=ie.useRef(Bl);ie.useEffect(()=>(n.current!==Bl&&r(Bl),Tp.push(r),()=>{let i=Tp.indexOf(r);i>-1&&Tp.splice(i,1)}),[]);let a=t.toasts.map(i=>{var s,o,l;return{...e,...e[i.type],...i,removeDelay:i.removeDelay||((s=e[i.type])==null?void 0:s.removeDelay)||(e==null?void 0:e.removeDelay),duration:i.duration||((o=e[i.type])==null?void 0:o.duration)||(e==null?void 0:e.duration)||mL[i.type],style:{...e.style,...(l=e[i.type])==null?void 0:l.style,...i.style}}});return{...t,toasts:a}},vL=(e,t="blank",r)=>({createdAt:Date.now(),visible:!0,dismissed:!1,type:t,ariaProps:{role:"status","aria-live":"polite"},message:e,pauseDuration:0,...r,id:(r==null?void 0:r.id)||dL()}),xh=e=>(t,r)=>{let n=vL(t,e,r);return sc({type:2,toast:n}),n.id},ea=(e,t)=>xh("blank")(e,t);ea.error=xh("error");ea.success=xh("success");ea.loading=xh("loading");ea.custom=xh("custom");ea.dismiss=e=>{sc({type:3,toastId:e})};ea.remove=e=>sc({type:4,toastId:e});ea.promise=(e,t,r)=>{let n=ea.loading(t.loading,{...r,...r==null?void 0:r.loading});return typeof e=="function"&&(e=e()),e.then(a=>{let i=t.success?s1(t.success,a):void 0;return i?ea.success(i,{id:n,...r,...r==null?void 0:r.success}):ea.dismiss(n),a}).catch(a=>{let i=t.error?s1(t.error,a):void 0;i?ea.error(i,{id:n,...r,...r==null?void 0:r.error}):ea.dismiss(n)}),e};var xL=(e,t)=>{sc({type:1,toast:{id:e,height:t}})},yL=()=>{sc({type:5,time:Date.now()})},f0=new Map,wL=1e3,bL=(e,t=wL)=>{if(f0.has(e))return;let r=setTimeout(()=>{f0.delete(e),sc({type:4,toastId:e})},t);f0.set(e,r)},_L=e=>{let{toasts:t,pausedAt:r}=gL(e);ie.useEffect(()=>{if(r)return;let i=Date.now(),s=t.map(o=>{if(o.duration===1/0)return;let l=(o.duration||0)+o.pauseDuration-(i-o.createdAt);if(l<0){o.visible&&ea.dismiss(o.id);return}return setTimeout(()=>ea.dismiss(o.id),l)});return()=>{s.forEach(o=>o&&clearTimeout(o))}},[t,r]);let n=ie.useCallback(()=>{r&&sc({type:6,time:Date.now()})},[r]),a=ie.useCallback((i,s)=>{let{reverseOrder:o=!1,gutter:l=8,defaultPosition:c}=s||{},u=t.filter(h=>(h.position||c)===(i.position||c)&&h.height),f=u.findIndex(h=>h.id===i.id),p=u.filter((h,g)=>g<f&&h.visible).length;return u.filter(h=>h.visible).slice(...o?[p+1]:[0,p]).reduce((h,g)=>h+(g.height||0)+l,0)},[t]);return ie.useEffect(()=>{t.forEach(i=>{if(i.dismissed)bL(i.id,i.removeDelay);else{let s=f0.get(i.id);s&&(clearTimeout(s),f0.delete(i.id))}})},[t]),{toasts:t,handlers:{updateHeight:xL,startPause:yL,endPause:n,calculateOffset:a}}},SL=Ys`
from {
  transform: scale(0) rotate(45deg);
	opacity: 0;
}
to {
 transform: scale(1) rotate(45deg);
  opacity: 1;
}`,kL=Ys`
from {
  transform: scale(0);
  opacity: 0;
}
to {
  transform: scale(1);
  opacity: 1;
}`,EL=Ys`
from {
  transform: scale(0) rotate(90deg);
	opacity: 0;
}
to {
  transform: scale(1) rotate(90deg);
	opacity: 1;
}`,AL=cl("div")`
  width: 20px;
  opacity: 0;
  height: 20px;
  border-radius: 10px;
  background: ${e=>e.primary||"#ff4b4b"};
  position: relative;
  transform: rotate(45deg);

  animation: ${SL} 0.3s cubic-bezier(0.175, 0.885, 0.32, 1.275)
    forwards;
  animation-delay: 100ms;

  &:after,
  &:before {
    content: '';
    animation: ${kL} 0.15s ease-out forwards;
    animation-delay: 150ms;
    position: absolute;
    border-radius: 3px;
    opacity: 0;
    background: ${e=>e.secondary||"#fff"};
    bottom: 9px;
    left: 4px;
    height: 2px;
    width: 12px;
  }

  &:before {
    animation: ${EL} 0.15s ease-out forwards;
    animation-delay: 180ms;
    transform: rotate(90deg);
  }
`,TL=Ys`
  from {
    transform: rotate(0deg);
  }
  to {
    transform: rotate(360deg);
  }
`,CL=cl("div")`
  width: 12px;
  height: 12px;
  box-sizing: border-box;
  border: 2px solid;
  border-radius: 100%;
  border-color: ${e=>e.secondary||"#e0e0e0"};
  border-right-color: ${e=>e.primary||"#616161"};
  animation: ${TL} 1s linear infinite;
`,NL=Ys`
from {
  transform: scale(0) rotate(45deg);
	opacity: 0;
}
to {
  transform: scale(1) rotate(45deg);
	opacity: 1;
}`,PL=Ys`
0% {
	height: 0;
	width: 0;
	opacity: 0;
}
40% {
  height: 0;
	width: 6px;
	opacity: 1;
}
100% {
  opacity: 1;
  height: 10px;
}`,LL=cl("div")`
  width: 20px;
  opacity: 0;
  height: 20px;
  border-radius: 10px;
  background: ${e=>e.primary||"#61d345"};
  position: relative;
  transform: rotate(45deg);

  animation: ${NL} 0.3s cubic-bezier(0.175, 0.885, 0.32, 1.275)
    forwards;
  animation-delay: 100ms;
  &:after {
    content: '';
    box-sizing: border-box;
    animation: ${PL} 0.2s ease-out forwards;
    opacity: 0;
    animation-delay: 200ms;
    position: absolute;
    border-right: 2px solid;
    border-bottom: 2px solid;
    border-color: ${e=>e.secondary||"#fff"};
    bottom: 6px;
    left: 6px;
    height: 10px;
    width: 6px;
  }
`,FL=cl("div")`
  position: absolute;
`,OL=cl("div")`
  position: relative;
  display: flex;
  justify-content: center;
  align-items: center;
  min-width: 20px;
  min-height: 20px;
`,DL=Ys`
from {
  transform: scale(0.6);
  opacity: 0.4;
}
to {
  transform: scale(1);
  opacity: 1;
}`,IL=cl("div")`
  position: relative;
  transform: scale(0.6);
  opacity: 0.4;
  min-width: 20px;
  animation: ${DL} 0.3s 0.12s cubic-bezier(0.175, 0.885, 0.32, 1.275)
    forwards;
`,RL=({toast:e})=>{let{icon:t,type:r,iconTheme:n}=e;return t!==void 0?typeof t=="string"?ie.createElement(IL,null,t):t:r==="blank"?null:ie.createElement(OL,null,ie.createElement(CL,{...n}),r!=="loading"&&ie.createElement(FL,null,r==="error"?ie.createElement(AL,{...n}):ie.createElement(LL,{...n})))},jL=e=>`
0% {transform: translate3d(0,${e*-200}%,0) scale(.6); opacity:.5;}
100% {transform: translate3d(0,0,0) scale(1); opacity:1;}
`,ML=e=>`
0% {transform: translate3d(0,0,-1px) scale(1); opacity:1;}
100% {transform: translate3d(0,${e*-150}%,-1px) scale(.6); opacity:0;}
`,BL="0%{opacity:0;} 100%{opacity:1;}",UL="0%{opacity:1;} 100%{opacity:0;}",VL=cl("div")`
  display: flex;
  align-items: center;
  background: #fff;
  color: #363636;
  line-height: 1.3;
  will-change: transform;
  box-shadow: 0 3px 10px rgba(0, 0, 0, 0.1), 0 3px 3px rgba(0, 0, 0, 0.05);
  max-width: 350px;
  pointer-events: auto;
  padding: 8px 10px;
  border-radius: 8px;
`,$L=cl("div")`
  display: flex;
  justify-content: center;
  margin: 4px 10px;
  color: inherit;
  flex: 1 1 auto;
  white-space: pre-line;
`,zL=(e,t)=>{let r=e.includes("top")?1:-1,[n,a]=rE()?[BL,UL]:[jL(r),ML(r)];return{animation:t?`${Ys(n)} 0.35s cubic-bezier(.21,1.02,.73,1) forwards`:`${Ys(a)} 0.4s forwards cubic-bezier(.06,.71,.55,1)`}},HL=ie.memo(({toast:e,position:t,style:r,children:n})=>{let a=e.height?zL(e.position||t||"top-center",e.visible):{opacity:0},i=ie.createElement(RL,{toast:e}),s=ie.createElement($L,{...e.ariaProps},s1(e.message,e));return ie.createElement(VL,{className:e.className,style:{...a,...r,...e.style}},typeof n=="function"?n({icon:i,message:s}):ie.createElement(ie.Fragment,null,i,s))});fL(ie.createElement);var WL=({id:e,className:t,style:r,onHeightUpdate:n,children:a})=>{let i=ie.useCallback(s=>{if(s){let o=()=>{let l=s.getBoundingClientRect().height;n(e,l)};o(),new MutationObserver(o).observe(s,{subtree:!0,childList:!0,characterData:!0})}},[e,n]);return ie.createElement("div",{ref:i,className:t,style:r},a)},qL=(e,t)=>{let r=e.includes("top"),n=r?{top:0}:{bottom:0},a=e.includes("center")?{justifyContent:"center"}:e.includes("right")?{justifyContent:"flex-end"}:{};return{left:0,right:0,display:"flex",position:"absolute",transition:rE()?void 0:"all 230ms cubic-bezier(.21,1.02,.73,1)",transform:`translateY(${t*(r?1:-1)}px)`,...n,...a}},GL=Z1`
  z-index: 9999;
  > * {
    pointer-events: auto;
  }
`,$d=16,KL=({reverseOrder:e,position:t="top-center",toastOptions:r,gutter:n,children:a,containerStyle:i,containerClassName:s})=>{let{toasts:o,handlers:l}=_L(r);return ie.createElement("div",{id:"_rht_toaster",style:{position:"fixed",zIndex:9999,top:$d,left:$d,right:$d,bottom:$d,pointerEvents:"none",...i},className:s,onMouseEnter:l.startPause,onMouseLeave:l.endPause},o.map(c=>{let u=c.position||t,f=l.calculateOffset(c,{reverseOrder:e,gutter:n,defaultPosition:t}),p=qL(u,f);return ie.createElement(WL,{id:c.id,key:c.id,onHeightUpdate:l.updateHeight,className:c.visible?GL:"",style:p},c.type==="custom"?s1(c.message,c):a?a(c):ie.createElement(HL,{toast:c,position:u}))}))},ft=ea;const XL="modulepreload",YL=function(e){return"/papeleria/"+e},b4={},Zo=function(t,r,n){let a=Promise.resolve();if(r&&r.length>0){document.getElementsByTagName("link");const s=document.querySelector("meta[property=csp-nonce]"),o=(s==null?void 0:s.nonce)||(s==null?void 0:s.getAttribute("nonce"));a=Promise.allSettled(r.map(l=>{if(l=YL(l),l in b4)return;b4[l]=!0;const c=l.endsWith(".css"),u=c?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${l}"]${u}`))return;const f=document.createElement("link");if(f.rel=c?"stylesheet":XL,c||(f.as="script"),f.crossOrigin="",f.href=l,o&&f.setAttribute("nonce",o),document.head.appendChild(f),c)return new Promise((p,h)=>{f.addEventListener("load",p),f.addEventListener("error",()=>h(new Error(`Unable to preload CSS for ${l}`)))})}))}function i(s){const o=new Event("vite:preloadError",{cancelable:!0});if(o.payload=s,window.dispatchEvent(o),!o.defaultPrevented)throw s}return a.then(s=>{for(const o of s||[])o.status==="rejected"&&i(o.reason);return t().catch(i)})},JL=e=>{let t;return e?t=e:typeof fetch>"u"?t=(...r)=>Zo(async()=>{const{default:n}=await Promise.resolve().then(()=>Ku);return{default:n}},void 0).then(({default:n})=>n(...r)):t=fetch,(...r)=>t(...r)};class ky extends Error{constructor(t,r="FunctionsError",n){super(t),this.name=r,this.context=n}}class QL extends ky{constructor(t){super("Failed to send a request to the Edge Function","FunctionsFetchError",t)}}class _4 extends ky{constructor(t){super("Relay Error invoking the Edge Function","FunctionsRelayError",t)}}class S4 extends ky{constructor(t){super("Edge Function returned a non-2xx status code","FunctionsHttpError",t)}}var Nv;(function(e){e.Any="any",e.ApNortheast1="ap-northeast-1",e.ApNortheast2="ap-northeast-2",e.ApSouth1="ap-south-1",e.ApSoutheast1="ap-southeast-1",e.ApSoutheast2="ap-southeast-2",e.CaCentral1="ca-central-1",e.EuCentral1="eu-central-1",e.EuWest1="eu-west-1",e.EuWest2="eu-west-2",e.EuWest3="eu-west-3",e.SaEast1="sa-east-1",e.UsEast1="us-east-1",e.UsWest1="us-west-1",e.UsWest2="us-west-2"})(Nv||(Nv={}));var ZL=function(e,t,r,n){function a(i){return i instanceof r?i:new r(function(s){s(i)})}return new(r||(r=Promise))(function(i,s){function o(u){try{c(n.next(u))}catch(f){s(f)}}function l(u){try{c(n.throw(u))}catch(f){s(f)}}function c(u){u.done?i(u.value):a(u.value).then(o,l)}c((n=n.apply(e,t||[])).next())})};class eF{constructor(t,{headers:r={},customFetch:n,region:a=Nv.Any}={}){this.url=t,this.headers=r,this.region=a,this.fetch=JL(n)}setAuth(t){this.headers.Authorization=`Bearer ${t}`}invoke(t,r={}){var n;return ZL(this,void 0,void 0,function*(){try{const{headers:a,method:i,body:s}=r;let o={},{region:l}=r;l||(l=this.region);const c=new URL(`${this.url}/${t}`);l&&l!=="any"&&(o["x-region"]=l,c.searchParams.set("forceFunctionRegion",l));let u;s&&(a&&!Object.prototype.hasOwnProperty.call(a,"Content-Type")||!a)&&(typeof Blob<"u"&&s instanceof Blob||s instanceof ArrayBuffer?(o["Content-Type"]="application/octet-stream",u=s):typeof s=="string"?(o["Content-Type"]="text/plain",u=s):typeof FormData<"u"&&s instanceof FormData?u=s:(o["Content-Type"]="application/json",u=JSON.stringify(s)));const f=yield this.fetch(c.toString(),{method:i||"POST",headers:Object.assign(Object.assign(Object.assign({},o),this.headers),a),body:u}).catch(m=>{throw new QL(m)}),p=f.headers.get("x-relay-error");if(p&&p==="true")throw new _4(f);if(!f.ok)throw new S4(f);let h=((n=f.headers.get("Content-Type"))!==null&&n!==void 0?n:"text/plain").split(";")[0].trim(),g;return h==="application/json"?g=yield f.json():h==="application/octet-stream"?g=yield f.blob():h==="text/event-stream"?g=f:h==="multipart/form-data"?g=yield f.formData():g=yield f.text(),{data:g,error:null,response:f}}catch(a){return{data:null,error:a,response:a instanceof S4||a instanceof _4?a.context:void 0}}})}}var va={},Ey={},em={},yh={},tm={},rm={},tF=function(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("unable to locate global object")},Mu=tF();const rF=Mu.fetch,aE=Mu.fetch.bind(Mu),iE=Mu.Headers,nF=Mu.Request,aF=Mu.Response,Ku=Object.freeze(Object.defineProperty({__proto__:null,Headers:iE,Request:nF,Response:aF,default:aE,fetch:rF},Symbol.toStringTag,{value:"Module"})),iF=B_(Ku);var nm={};Object.defineProperty(nm,"__esModule",{value:!0});let sF=class extends Error{constructor(t){super(t.message),this.name="PostgrestError",this.details=t.details,this.hint=t.hint,this.code=t.code}};nm.default=sF;var sE=li&&li.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(rm,"__esModule",{value:!0});const oF=sE(iF),lF=sE(nm);let cF=class{constructor(t){this.shouldThrowOnError=!1,this.method=t.method,this.url=t.url,this.headers=t.headers,this.schema=t.schema,this.body=t.body,this.shouldThrowOnError=t.shouldThrowOnError,this.signal=t.signal,this.isMaybeSingle=t.isMaybeSingle,t.fetch?this.fetch=t.fetch:typeof fetch>"u"?this.fetch=oF.default:this.fetch=fetch}throwOnError(){return this.shouldThrowOnError=!0,this}setHeader(t,r){return this.headers=Object.assign({},this.headers),this.headers[t]=r,this}then(t,r){this.schema===void 0||(["GET","HEAD"].includes(this.method)?this.headers["Accept-Profile"]=this.schema:this.headers["Content-Profile"]=this.schema),this.method!=="GET"&&this.method!=="HEAD"&&(this.headers["Content-Type"]="application/json");const n=this.fetch;let a=n(this.url.toString(),{method:this.method,headers:this.headers,body:JSON.stringify(this.body),signal:this.signal}).then(async i=>{var s,o,l;let c=null,u=null,f=null,p=i.status,h=i.statusText;if(i.ok){if(this.method!=="HEAD"){const x=await i.text();x===""||(this.headers.Accept==="text/csv"||this.headers.Accept&&this.headers.Accept.includes("application/vnd.pgrst.plan+text")?u=x:u=JSON.parse(x))}const m=(s=this.headers.Prefer)===null||s===void 0?void 0:s.match(/count=(exact|planned|estimated)/),b=(o=i.headers.get("content-range"))===null||o===void 0?void 0:o.split("/");m&&b&&b.length>1&&(f=parseInt(b[1])),this.isMaybeSingle&&this.method==="GET"&&Array.isArray(u)&&(u.length>1?(c={code:"PGRST116",details:`Results contain ${u.length} rows, application/vnd.pgrst.object+json requires 1 row`,hint:null,message:"JSON object requested, multiple (or no) rows returned"},u=null,f=null,p=406,h="Not Acceptable"):u.length===1?u=u[0]:u=null)}else{const m=await i.text();try{c=JSON.parse(m),Array.isArray(c)&&i.status===404&&(u=[],c=null,p=200,h="OK")}catch{i.status===404&&m===""?(p=204,h="No Content"):c={message:m}}if(c&&this.isMaybeSingle&&(!((l=c==null?void 0:c.details)===null||l===void 0)&&l.includes("0 rows"))&&(c=null,p=200,h="OK"),c&&this.shouldThrowOnError)throw new lF.default(c)}return{error:c,data:u,count:f,status:p,statusText:h}});return this.shouldThrowOnError||(a=a.catch(i=>{var s,o,l;return{error:{message:`${(s=i==null?void 0:i.name)!==null&&s!==void 0?s:"FetchError"}: ${i==null?void 0:i.message}`,details:`${(o=i==null?void 0:i.stack)!==null&&o!==void 0?o:""}`,hint:"",code:`${(l=i==null?void 0:i.code)!==null&&l!==void 0?l:""}`},data:null,count:null,status:0,statusText:""}})),a.then(t,r)}returns(){return this}overrideTypes(){return this}};rm.default=cF;var uF=li&&li.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(tm,"__esModule",{value:!0});const fF=uF(rm);let hF=class extends fF.default{select(t){let r=!1;const n=(t??"*").split("").map(a=>/\s/.test(a)&&!r?"":(a==='"'&&(r=!r),a)).join("");return this.url.searchParams.set("select",n),this.headers.Prefer&&(this.headers.Prefer+=","),this.headers.Prefer+="return=representation",this}order(t,{ascending:r=!0,nullsFirst:n,foreignTable:a,referencedTable:i=a}={}){const s=i?`${i}.order`:"order",o=this.url.searchParams.get(s);return this.url.searchParams.set(s,`${o?`${o},`:""}${t}.${r?"asc":"desc"}${n===void 0?"":n?".nullsfirst":".nullslast"}`),this}limit(t,{foreignTable:r,referencedTable:n=r}={}){const a=typeof n>"u"?"limit":`${n}.limit`;return this.url.searchParams.set(a,`${t}`),this}range(t,r,{foreignTable:n,referencedTable:a=n}={}){const i=typeof a>"u"?"offset":`${a}.offset`,s=typeof a>"u"?"limit":`${a}.limit`;return this.url.searchParams.set(i,`${t}`),this.url.searchParams.set(s,`${r-t+1}`),this}abortSignal(t){return this.signal=t,this}single(){return this.headers.Accept="application/vnd.pgrst.object+json",this}maybeSingle(){return this.method==="GET"?this.headers.Accept="application/json":this.headers.Accept="application/vnd.pgrst.object+json",this.isMaybeSingle=!0,this}csv(){return this.headers.Accept="text/csv",this}geojson(){return this.headers.Accept="application/geo+json",this}explain({analyze:t=!1,verbose:r=!1,settings:n=!1,buffers:a=!1,wal:i=!1,format:s="text"}={}){var o;const l=[t?"analyze":null,r?"verbose":null,n?"settings":null,a?"buffers":null,i?"wal":null].filter(Boolean).join("|"),c=(o=this.headers.Accept)!==null&&o!==void 0?o:"application/json";return this.headers.Accept=`application/vnd.pgrst.plan+${s}; for="${c}"; options=${l};`,s==="json"?this:this}rollback(){var t;return((t=this.headers.Prefer)!==null&&t!==void 0?t:"").trim().length>0?this.headers.Prefer+=",tx=rollback":this.headers.Prefer="tx=rollback",this}returns(){return this}};tm.default=hF;var dF=li&&li.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(yh,"__esModule",{value:!0});const pF=dF(tm);let mF=class extends pF.default{eq(t,r){return this.url.searchParams.append(t,`eq.${r}`),this}neq(t,r){return this.url.searchParams.append(t,`neq.${r}`),this}gt(t,r){return this.url.searchParams.append(t,`gt.${r}`),this}gte(t,r){return this.url.searchParams.append(t,`gte.${r}`),this}lt(t,r){return this.url.searchParams.append(t,`lt.${r}`),this}lte(t,r){return this.url.searchParams.append(t,`lte.${r}`),this}like(t,r){return this.url.searchParams.append(t,`like.${r}`),this}likeAllOf(t,r){return this.url.searchParams.append(t,`like(all).{${r.join(",")}}`),this}likeAnyOf(t,r){return this.url.searchParams.append(t,`like(any).{${r.join(",")}}`),this}ilike(t,r){return this.url.searchParams.append(t,`ilike.${r}`),this}ilikeAllOf(t,r){return this.url.searchParams.append(t,`ilike(all).{${r.join(",")}}`),this}ilikeAnyOf(t,r){return this.url.searchParams.append(t,`ilike(any).{${r.join(",")}}`),this}is(t,r){return this.url.searchParams.append(t,`is.${r}`),this}in(t,r){const n=Array.from(new Set(r)).map(a=>typeof a=="string"&&new RegExp("[,()]").test(a)?`"${a}"`:`${a}`).join(",");return this.url.searchParams.append(t,`in.(${n})`),this}contains(t,r){return typeof r=="string"?this.url.searchParams.append(t,`cs.${r}`):Array.isArray(r)?this.url.searchParams.append(t,`cs.{${r.join(",")}}`):this.url.searchParams.append(t,`cs.${JSON.stringify(r)}`),this}containedBy(t,r){return typeof r=="string"?this.url.searchParams.append(t,`cd.${r}`):Array.isArray(r)?this.url.searchParams.append(t,`cd.{${r.join(",")}}`):this.url.searchParams.append(t,`cd.${JSON.stringify(r)}`),this}rangeGt(t,r){return this.url.searchParams.append(t,`sr.${r}`),this}rangeGte(t,r){return this.url.searchParams.append(t,`nxl.${r}`),this}rangeLt(t,r){return this.url.searchParams.append(t,`sl.${r}`),this}rangeLte(t,r){return this.url.searchParams.append(t,`nxr.${r}`),this}rangeAdjacent(t,r){return this.url.searchParams.append(t,`adj.${r}`),this}overlaps(t,r){return typeof r=="string"?this.url.searchParams.append(t,`ov.${r}`):this.url.searchParams.append(t,`ov.{${r.join(",")}}`),this}textSearch(t,r,{config:n,type:a}={}){let i="";a==="plain"?i="pl":a==="phrase"?i="ph":a==="websearch"&&(i="w");const s=n===void 0?"":`(${n})`;return this.url.searchParams.append(t,`${i}fts${s}.${r}`),this}match(t){return Object.entries(t).forEach(([r,n])=>{this.url.searchParams.append(r,`eq.${n}`)}),this}not(t,r,n){return this.url.searchParams.append(t,`not.${r}.${n}`),this}or(t,{foreignTable:r,referencedTable:n=r}={}){const a=n?`${n}.or`:"or";return this.url.searchParams.append(a,`(${t})`),this}filter(t,r,n){return this.url.searchParams.append(t,`${r}.${n}`),this}};yh.default=mF;var gF=li&&li.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(em,"__esModule",{value:!0});const Uf=gF(yh);let vF=class{constructor(t,{headers:r={},schema:n,fetch:a}){this.url=t,this.headers=r,this.schema=n,this.fetch=a}select(t,{head:r=!1,count:n}={}){const a=r?"HEAD":"GET";let i=!1;const s=(t??"*").split("").map(o=>/\s/.test(o)&&!i?"":(o==='"'&&(i=!i),o)).join("");return this.url.searchParams.set("select",s),n&&(this.headers.Prefer=`count=${n}`),new Uf.default({method:a,url:this.url,headers:this.headers,schema:this.schema,fetch:this.fetch,allowEmpty:!1})}insert(t,{count:r,defaultToNull:n=!0}={}){const a="POST",i=[];if(this.headers.Prefer&&i.push(this.headers.Prefer),r&&i.push(`count=${r}`),n||i.push("missing=default"),this.headers.Prefer=i.join(","),Array.isArray(t)){const s=t.reduce((o,l)=>o.concat(Object.keys(l)),[]);if(s.length>0){const o=[...new Set(s)].map(l=>`"${l}"`);this.url.searchParams.set("columns",o.join(","))}}return new Uf.default({method:a,url:this.url,headers:this.headers,schema:this.schema,body:t,fetch:this.fetch,allowEmpty:!1})}upsert(t,{onConflict:r,ignoreDuplicates:n=!1,count:a,defaultToNull:i=!0}={}){const s="POST",o=[`resolution=${n?"ignore":"merge"}-duplicates`];if(r!==void 0&&this.url.searchParams.set("on_conflict",r),this.headers.Prefer&&o.push(this.headers.Prefer),a&&o.push(`count=${a}`),i||o.push("missing=default"),this.headers.Prefer=o.join(","),Array.isArray(t)){const l=t.reduce((c,u)=>c.concat(Object.keys(u)),[]);if(l.length>0){const c=[...new Set(l)].map(u=>`"${u}"`);this.url.searchParams.set("columns",c.join(","))}}return new Uf.default({method:s,url:this.url,headers:this.headers,schema:this.schema,body:t,fetch:this.fetch,allowEmpty:!1})}update(t,{count:r}={}){const n="PATCH",a=[];return this.headers.Prefer&&a.push(this.headers.Prefer),r&&a.push(`count=${r}`),this.headers.Prefer=a.join(","),new Uf.default({method:n,url:this.url,headers:this.headers,schema:this.schema,body:t,fetch:this.fetch,allowEmpty:!1})}delete({count:t}={}){const r="DELETE",n=[];return t&&n.push(`count=${t}`),this.headers.Prefer&&n.unshift(this.headers.Prefer),this.headers.Prefer=n.join(","),new Uf.default({method:r,url:this.url,headers:this.headers,schema:this.schema,fetch:this.fetch,allowEmpty:!1})}};em.default=vF;var am={},im={};Object.defineProperty(im,"__esModule",{value:!0});im.version=void 0;im.version="0.0.0-automated";Object.defineProperty(am,"__esModule",{value:!0});am.DEFAULT_HEADERS=void 0;const xF=im;am.DEFAULT_HEADERS={"X-Client-Info":`postgrest-js/${xF.version}`};var oE=li&&li.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(Ey,"__esModule",{value:!0});const yF=oE(em),wF=oE(yh),bF=am;let _F=class lE{constructor(t,{headers:r={},schema:n,fetch:a}={}){this.url=t,this.headers=Object.assign(Object.assign({},bF.DEFAULT_HEADERS),r),this.schemaName=n,this.fetch=a}from(t){const r=new URL(`${this.url}/${t}`);return new yF.default(r,{headers:Object.assign({},this.headers),schema:this.schemaName,fetch:this.fetch})}schema(t){return new lE(this.url,{headers:this.headers,schema:t,fetch:this.fetch})}rpc(t,r={},{head:n=!1,get:a=!1,count:i}={}){let s;const o=new URL(`${this.url}/rpc/${t}`);let l;n||a?(s=n?"HEAD":"GET",Object.entries(r).filter(([u,f])=>f!==void 0).map(([u,f])=>[u,Array.isArray(f)?`{${f.join(",")}}`:`${f}`]).forEach(([u,f])=>{o.searchParams.append(u,f)})):(s="POST",l=r);const c=Object.assign({},this.headers);return i&&(c.Prefer=`count=${i}`),new wF.default({method:s,url:o,headers:c,schema:this.schemaName,body:l,fetch:this.fetch,allowEmpty:!1})}};Ey.default=_F;var Xu=li&&li.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(va,"__esModule",{value:!0});va.PostgrestError=va.PostgrestBuilder=va.PostgrestTransformBuilder=va.PostgrestFilterBuilder=va.PostgrestQueryBuilder=va.PostgrestClient=void 0;const cE=Xu(Ey);va.PostgrestClient=cE.default;const uE=Xu(em);va.PostgrestQueryBuilder=uE.default;const fE=Xu(yh);va.PostgrestFilterBuilder=fE.default;const hE=Xu(tm);va.PostgrestTransformBuilder=hE.default;const dE=Xu(rm);va.PostgrestBuilder=dE.default;const pE=Xu(nm);va.PostgrestError=pE.default;var SF=va.default={PostgrestClient:cE.default,PostgrestQueryBuilder:uE.default,PostgrestFilterBuilder:fE.default,PostgrestTransformBuilder:hE.default,PostgrestBuilder:dE.default,PostgrestError:pE.default};const{PostgrestClient:kF,PostgrestQueryBuilder:HY,PostgrestFilterBuilder:WY,PostgrestTransformBuilder:qY,PostgrestBuilder:GY,PostgrestError:KY}=SF;function EF(){if(typeof WebSocket<"u")return WebSocket;if(typeof global.WebSocket<"u")return global.WebSocket;if(typeof window.WebSocket<"u")return window.WebSocket;if(typeof self.WebSocket<"u")return self.WebSocket;throw new Error("`WebSocket` is not supported in this environment")}const AF=EF(),TF="2.11.15",CF=`realtime-js/${TF}`,NF="1.0.0",mE=1e4,PF=1e3;var h0;(function(e){e[e.connecting=0]="connecting",e[e.open=1]="open",e[e.closing=2]="closing",e[e.closed=3]="closed"})(h0||(h0={}));var Rn;(function(e){e.closed="closed",e.errored="errored",e.joined="joined",e.joining="joining",e.leaving="leaving"})(Rn||(Rn={}));var Li;(function(e){e.close="phx_close",e.error="phx_error",e.join="phx_join",e.reply="phx_reply",e.leave="phx_leave",e.access_token="access_token"})(Li||(Li={}));var Pv;(function(e){e.websocket="websocket"})(Pv||(Pv={}));var Ol;(function(e){e.Connecting="connecting",e.Open="open",e.Closing="closing",e.Closed="closed"})(Ol||(Ol={}));class LF{constructor(){this.HEADER_LENGTH=1}decode(t,r){return t.constructor===ArrayBuffer?r(this._binaryDecode(t)):r(typeof t=="string"?JSON.parse(t):{})}_binaryDecode(t){const r=new DataView(t),n=new TextDecoder;return this._decodeBroadcast(t,r,n)}_decodeBroadcast(t,r,n){const a=r.getUint8(1),i=r.getUint8(2);let s=this.HEADER_LENGTH+2;const o=n.decode(t.slice(s,s+a));s=s+a;const l=n.decode(t.slice(s,s+i));s=s+i;const c=JSON.parse(n.decode(t.slice(s,t.byteLength)));return{ref:null,topic:o,event:l,payload:c}}}class gE{constructor(t,r){this.callback=t,this.timerCalc=r,this.timer=void 0,this.tries=0,this.callback=t,this.timerCalc=r}reset(){this.tries=0,clearTimeout(this.timer)}scheduleTimeout(){clearTimeout(this.timer),this.timer=setTimeout(()=>{this.tries=this.tries+1,this.callback()},this.timerCalc(this.tries+1))}}var fr;(function(e){e.abstime="abstime",e.bool="bool",e.date="date",e.daterange="daterange",e.float4="float4",e.float8="float8",e.int2="int2",e.int4="int4",e.int4range="int4range",e.int8="int8",e.int8range="int8range",e.json="json",e.jsonb="jsonb",e.money="money",e.numeric="numeric",e.oid="oid",e.reltime="reltime",e.text="text",e.time="time",e.timestamp="timestamp",e.timestamptz="timestamptz",e.timetz="timetz",e.tsrange="tsrange",e.tstzrange="tstzrange"})(fr||(fr={}));const k4=(e,t,r={})=>{var n;const a=(n=r.skipTypes)!==null&&n!==void 0?n:[];return Object.keys(t).reduce((i,s)=>(i[s]=FF(s,e,t,a),i),{})},FF=(e,t,r,n)=>{const a=t.find(o=>o.name===e),i=a==null?void 0:a.type,s=r[e];return i&&!n.includes(i)?vE(i,s):Lv(s)},vE=(e,t)=>{if(e.charAt(0)==="_"){const r=e.slice(1,e.length);return RF(t,r)}switch(e){case fr.bool:return OF(t);case fr.float4:case fr.float8:case fr.int2:case fr.int4:case fr.int8:case fr.numeric:case fr.oid:return DF(t);case fr.json:case fr.jsonb:return IF(t);case fr.timestamp:return jF(t);case fr.abstime:case fr.date:case fr.daterange:case fr.int4range:case fr.int8range:case fr.money:case fr.reltime:case fr.text:case fr.time:case fr.timestamptz:case fr.timetz:case fr.tsrange:case fr.tstzrange:return Lv(t);default:return Lv(t)}},Lv=e=>e,OF=e=>{switch(e){case"t":return!0;case"f":return!1;default:return e}},DF=e=>{if(typeof e=="string"){const t=parseFloat(e);if(!Number.isNaN(t))return t}return e},IF=e=>{if(typeof e=="string")try{return JSON.parse(e)}catch(t){return console.log(`JSON parse error: ${t}`),e}return e},RF=(e,t)=>{if(typeof e!="string")return e;const r=e.length-1,n=e[r];if(e[0]==="{"&&n==="}"){let i;const s=e.slice(1,r);try{i=JSON.parse("["+s+"]")}catch{i=s?s.split(","):[]}return i.map(o=>vE(t,o))}return e},jF=e=>typeof e=="string"?e.replace(" ","T"):e,xE=e=>{let t=e;return t=t.replace(/^ws/i,"http"),t=t.replace(/(\/socket\/websocket|\/socket|\/websocket)\/?$/i,""),t.replace(/\/+$/,"")};class zg{constructor(t,r,n={},a=mE){this.channel=t,this.event=r,this.payload=n,this.timeout=a,this.sent=!1,this.timeoutTimer=void 0,this.ref="",this.receivedResp=null,this.recHooks=[],this.refEvent=null}resend(t){this.timeout=t,this._cancelRefEvent(),this.ref="",this.refEvent=null,this.receivedResp=null,this.sent=!1,this.send()}send(){this._hasReceived("timeout")||(this.startTimeout(),this.sent=!0,this.channel.socket.push({topic:this.channel.topic,event:this.event,payload:this.payload,ref:this.ref,join_ref:this.channel._joinRef()}))}updatePayload(t){this.payload=Object.assign(Object.assign({},this.payload),t)}receive(t,r){var n;return this._hasReceived(t)&&r((n=this.receivedResp)===null||n===void 0?void 0:n.response),this.recHooks.push({status:t,callback:r}),this}startTimeout(){if(this.timeoutTimer)return;this.ref=this.channel.socket._makeRef(),this.refEvent=this.channel._replyEventName(this.ref);const t=r=>{this._cancelRefEvent(),this._cancelTimeout(),this.receivedResp=r,this._matchReceive(r)};this.channel._on(this.refEvent,{},t),this.timeoutTimer=setTimeout(()=>{this.trigger("timeout",{})},this.timeout)}trigger(t,r){this.refEvent&&this.channel._trigger(this.refEvent,{status:t,response:r})}destroy(){this._cancelRefEvent(),this._cancelTimeout()}_cancelRefEvent(){this.refEvent&&this.channel._off(this.refEvent,{})}_cancelTimeout(){clearTimeout(this.timeoutTimer),this.timeoutTimer=void 0}_matchReceive({status:t,response:r}){this.recHooks.filter(n=>n.status===t).forEach(n=>n.callback(r))}_hasReceived(t){return this.receivedResp&&this.receivedResp.status===t}}var E4;(function(e){e.SYNC="sync",e.JOIN="join",e.LEAVE="leave"})(E4||(E4={}));class d0{constructor(t,r){this.channel=t,this.state={},this.pendingDiffs=[],this.joinRef=null,this.caller={onJoin:()=>{},onLeave:()=>{},onSync:()=>{}};const n=(r==null?void 0:r.events)||{state:"presence_state",diff:"presence_diff"};this.channel._on(n.state,{},a=>{const{onJoin:i,onLeave:s,onSync:o}=this.caller;this.joinRef=this.channel._joinRef(),this.state=d0.syncState(this.state,a,i,s),this.pendingDiffs.forEach(l=>{this.state=d0.syncDiff(this.state,l,i,s)}),this.pendingDiffs=[],o()}),this.channel._on(n.diff,{},a=>{const{onJoin:i,onLeave:s,onSync:o}=this.caller;this.inPendingSyncState()?this.pendingDiffs.push(a):(this.state=d0.syncDiff(this.state,a,i,s),o())}),this.onJoin((a,i,s)=>{this.channel._trigger("presence",{event:"join",key:a,currentPresences:i,newPresences:s})}),this.onLeave((a,i,s)=>{this.channel._trigger("presence",{event:"leave",key:a,currentPresences:i,leftPresences:s})}),this.onSync(()=>{this.channel._trigger("presence",{event:"sync"})})}static syncState(t,r,n,a){const i=this.cloneDeep(t),s=this.transformState(r),o={},l={};return this.map(i,(c,u)=>{s[c]||(l[c]=u)}),this.map(s,(c,u)=>{const f=i[c];if(f){const p=u.map(b=>b.presence_ref),h=f.map(b=>b.presence_ref),g=u.filter(b=>h.indexOf(b.presence_ref)<0),m=f.filter(b=>p.indexOf(b.presence_ref)<0);g.length>0&&(o[c]=g),m.length>0&&(l[c]=m)}else o[c]=u}),this.syncDiff(i,{joins:o,leaves:l},n,a)}static syncDiff(t,r,n,a){const{joins:i,leaves:s}={joins:this.transformState(r.joins),leaves:this.transformState(r.leaves)};return n||(n=()=>{}),a||(a=()=>{}),this.map(i,(o,l)=>{var c;const u=(c=t[o])!==null&&c!==void 0?c:[];if(t[o]=this.cloneDeep(l),u.length>0){const f=t[o].map(h=>h.presence_ref),p=u.filter(h=>f.indexOf(h.presence_ref)<0);t[o].unshift(...p)}n(o,u,l)}),this.map(s,(o,l)=>{let c=t[o];if(!c)return;const u=l.map(f=>f.presence_ref);c=c.filter(f=>u.indexOf(f.presence_ref)<0),t[o]=c,a(o,c,l),c.length===0&&delete t[o]}),t}static map(t,r){return Object.getOwnPropertyNames(t).map(n=>r(n,t[n]))}static transformState(t){return t=this.cloneDeep(t),Object.getOwnPropertyNames(t).reduce((r,n)=>{const a=t[n];return"metas"in a?r[n]=a.metas.map(i=>(i.presence_ref=i.phx_ref,delete i.phx_ref,delete i.phx_ref_prev,i)):r[n]=a,r},{})}static cloneDeep(t){return JSON.parse(JSON.stringify(t))}onJoin(t){this.caller.onJoin=t}onLeave(t){this.caller.onLeave=t}onSync(t){this.caller.onSync=t}inPendingSyncState(){return!this.joinRef||this.joinRef!==this.channel._joinRef()}}var A4;(function(e){e.ALL="*",e.INSERT="INSERT",e.UPDATE="UPDATE",e.DELETE="DELETE"})(A4||(A4={}));var T4;(function(e){e.BROADCAST="broadcast",e.PRESENCE="presence",e.POSTGRES_CHANGES="postgres_changes",e.SYSTEM="system"})(T4||(T4={}));var Os;(function(e){e.SUBSCRIBED="SUBSCRIBED",e.TIMED_OUT="TIMED_OUT",e.CLOSED="CLOSED",e.CHANNEL_ERROR="CHANNEL_ERROR"})(Os||(Os={}));class Ay{constructor(t,r={config:{}},n){this.topic=t,this.params=r,this.socket=n,this.bindings={},this.state=Rn.closed,this.joinedOnce=!1,this.pushBuffer=[],this.subTopic=t.replace(/^realtime:/i,""),this.params.config=Object.assign({broadcast:{ack:!1,self:!1},presence:{key:""},private:!1},r.config),this.timeout=this.socket.timeout,this.joinPush=new zg(this,Li.join,this.params,this.timeout),this.rejoinTimer=new gE(()=>this._rejoinUntilConnected(),this.socket.reconnectAfterMs),this.joinPush.receive("ok",()=>{this.state=Rn.joined,this.rejoinTimer.reset(),this.pushBuffer.forEach(a=>a.send()),this.pushBuffer=[]}),this._onClose(()=>{this.rejoinTimer.reset(),this.socket.log("channel",`close ${this.topic} ${this._joinRef()}`),this.state=Rn.closed,this.socket._remove(this)}),this._onError(a=>{this._isLeaving()||this._isClosed()||(this.socket.log("channel",`error ${this.topic}`,a),this.state=Rn.errored,this.rejoinTimer.scheduleTimeout())}),this.joinPush.receive("timeout",()=>{this._isJoining()&&(this.socket.log("channel",`timeout ${this.topic}`,this.joinPush.timeout),this.state=Rn.errored,this.rejoinTimer.scheduleTimeout())}),this._on(Li.reply,{},(a,i)=>{this._trigger(this._replyEventName(i),a)}),this.presence=new d0(this),this.broadcastEndpointURL=xE(this.socket.endPoint)+"/api/broadcast",this.private=this.params.config.private||!1}subscribe(t,r=this.timeout){var n,a;if(this.socket.isConnected()||this.socket.connect(),this.state==Rn.closed){const{config:{broadcast:i,presence:s,private:o}}=this.params;this._onError(u=>t==null?void 0:t(Os.CHANNEL_ERROR,u)),this._onClose(()=>t==null?void 0:t(Os.CLOSED));const l={},c={broadcast:i,presence:s,postgres_changes:(a=(n=this.bindings.postgres_changes)===null||n===void 0?void 0:n.map(u=>u.filter))!==null&&a!==void 0?a:[],private:o};this.socket.accessTokenValue&&(l.access_token=this.socket.accessTokenValue),this.updateJoinPayload(Object.assign({config:c},l)),this.joinedOnce=!0,this._rejoin(r),this.joinPush.receive("ok",async({postgres_changes:u})=>{var f;if(this.socket.setAuth(),u===void 0){t==null||t(Os.SUBSCRIBED);return}else{const p=this.bindings.postgres_changes,h=(f=p==null?void 0:p.length)!==null&&f!==void 0?f:0,g=[];for(let m=0;m<h;m++){const b=p[m],{filter:{event:x,schema:w,table:y,filter:A}}=b,L=u&&u[m];if(L&&L.event===x&&L.schema===w&&L.table===y&&L.filter===A)g.push(Object.assign(Object.assign({},b),{id:L.id}));else{this.unsubscribe(),this.state=Rn.errored,t==null||t(Os.CHANNEL_ERROR,new Error("mismatch between server and client bindings for postgres changes"));return}}this.bindings.postgres_changes=g,t&&t(Os.SUBSCRIBED);return}}).receive("error",u=>{this.state=Rn.errored,t==null||t(Os.CHANNEL_ERROR,new Error(JSON.stringify(Object.values(u).join(", ")||"error")))}).receive("timeout",()=>{t==null||t(Os.TIMED_OUT)})}return this}presenceState(){return this.presence.state}async track(t,r={}){return await this.send({type:"presence",event:"track",payload:t},r.timeout||this.timeout)}async untrack(t={}){return await this.send({type:"presence",event:"untrack"},t)}on(t,r,n){return this._on(t,r,n)}async send(t,r={}){var n,a;if(!this._canPush()&&t.type==="broadcast"){const{event:i,payload:s}=t,l={method:"POST",headers:{Authorization:this.socket.accessTokenValue?`Bearer ${this.socket.accessTokenValue}`:"",apikey:this.socket.apiKey?this.socket.apiKey:"","Content-Type":"application/json"},body:JSON.stringify({messages:[{topic:this.subTopic,event:i,payload:s,private:this.private}]})};try{const c=await this._fetchWithTimeout(this.broadcastEndpointURL,l,(n=r.timeout)!==null&&n!==void 0?n:this.timeout);return await((a=c.body)===null||a===void 0?void 0:a.cancel()),c.ok?"ok":"error"}catch(c){return c.name==="AbortError"?"timed out":"error"}}else return new Promise(i=>{var s,o,l;const c=this._push(t.type,t,r.timeout||this.timeout);t.type==="broadcast"&&!(!((l=(o=(s=this.params)===null||s===void 0?void 0:s.config)===null||o===void 0?void 0:o.broadcast)===null||l===void 0)&&l.ack)&&i("ok"),c.receive("ok",()=>i("ok")),c.receive("error",()=>i("error")),c.receive("timeout",()=>i("timed out"))})}updateJoinPayload(t){this.joinPush.updatePayload(t)}unsubscribe(t=this.timeout){this.state=Rn.leaving;const r=()=>{this.socket.log("channel",`leave ${this.topic}`),this._trigger(Li.close,"leave",this._joinRef())};this.joinPush.destroy();let n=null;return new Promise(a=>{n=new zg(this,Li.leave,{},t),n.receive("ok",()=>{r(),a("ok")}).receive("timeout",()=>{r(),a("timed out")}).receive("error",()=>{a("error")}),n.send(),this._canPush()||n.trigger("ok",{})}).finally(()=>{n==null||n.destroy()})}teardown(){this.pushBuffer.forEach(t=>t.destroy()),this.rejoinTimer&&clearTimeout(this.rejoinTimer.timer),this.joinPush.destroy()}async _fetchWithTimeout(t,r,n){const a=new AbortController,i=setTimeout(()=>a.abort(),n),s=await this.socket.fetch(t,Object.assign(Object.assign({},r),{signal:a.signal}));return clearTimeout(i),s}_push(t,r,n=this.timeout){if(!this.joinedOnce)throw`tried to push '${t}' to '${this.topic}' before joining. Use channel.subscribe() before pushing events`;let a=new zg(this,t,r,n);return this._canPush()?a.send():(a.startTimeout(),this.pushBuffer.push(a)),a}_onMessage(t,r,n){return r}_isMember(t){return this.topic===t}_joinRef(){return this.joinPush.ref}_trigger(t,r,n){var a,i;const s=t.toLocaleLowerCase(),{close:o,error:l,leave:c,join:u}=Li;if(n&&[o,l,c,u].indexOf(s)>=0&&n!==this._joinRef())return;let p=this._onMessage(s,r,n);if(r&&!p)throw"channel onMessage callbacks must return the payload, modified or unmodified";["insert","update","delete"].includes(s)?(a=this.bindings.postgres_changes)===null||a===void 0||a.filter(h=>{var g,m,b;return((g=h.filter)===null||g===void 0?void 0:g.event)==="*"||((b=(m=h.filter)===null||m===void 0?void 0:m.event)===null||b===void 0?void 0:b.toLocaleLowerCase())===s}).map(h=>h.callback(p,n)):(i=this.bindings[s])===null||i===void 0||i.filter(h=>{var g,m,b,x,w,y;if(["broadcast","presence","postgres_changes"].includes(s))if("id"in h){const A=h.id,L=(g=h.filter)===null||g===void 0?void 0:g.event;return A&&((m=r.ids)===null||m===void 0?void 0:m.includes(A))&&(L==="*"||(L==null?void 0:L.toLocaleLowerCase())===((b=r.data)===null||b===void 0?void 0:b.type.toLocaleLowerCase()))}else{const A=(w=(x=h==null?void 0:h.filter)===null||x===void 0?void 0:x.event)===null||w===void 0?void 0:w.toLocaleLowerCase();return A==="*"||A===((y=r==null?void 0:r.event)===null||y===void 0?void 0:y.toLocaleLowerCase())}else return h.type.toLocaleLowerCase()===s}).map(h=>{if(typeof p=="object"&&"ids"in p){const g=p.data,{schema:m,table:b,commit_timestamp:x,type:w,errors:y}=g;p=Object.assign(Object.assign({},{schema:m,table:b,commit_timestamp:x,eventType:w,new:{},old:{},errors:y}),this._getPayloadRecords(g))}h.callback(p,n)})}_isClosed(){return this.state===Rn.closed}_isJoined(){return this.state===Rn.joined}_isJoining(){return this.state===Rn.joining}_isLeaving(){return this.state===Rn.leaving}_replyEventName(t){return`chan_reply_${t}`}_on(t,r,n){const a=t.toLocaleLowerCase(),i={type:a,filter:r,callback:n};return this.bindings[a]?this.bindings[a].push(i):this.bindings[a]=[i],this}_off(t,r){const n=t.toLocaleLowerCase();return this.bindings[n]=this.bindings[n].filter(a=>{var i;return!(((i=a.type)===null||i===void 0?void 0:i.toLocaleLowerCase())===n&&Ay.isEqual(a.filter,r))}),this}static isEqual(t,r){if(Object.keys(t).length!==Object.keys(r).length)return!1;for(const n in t)if(t[n]!==r[n])return!1;return!0}_rejoinUntilConnected(){this.rejoinTimer.scheduleTimeout(),this.socket.isConnected()&&this._rejoin()}_onClose(t){this._on(Li.close,{},t)}_onError(t){this._on(Li.error,{},r=>t(r))}_canPush(){return this.socket.isConnected()&&this._isJoined()}_rejoin(t=this.timeout){this._isLeaving()||(this.socket._leaveOpenTopic(this.topic),this.state=Rn.joining,this.joinPush.resend(t))}_getPayloadRecords(t){const r={new:{},old:{}};return(t.type==="INSERT"||t.type==="UPDATE")&&(r.new=k4(t.columns,t.record)),(t.type==="UPDATE"||t.type==="DELETE")&&(r.old=k4(t.columns,t.old_record)),r}}const C4=()=>{},MF=`
  addEventListener("message", (e) => {
    if (e.data.event === "start") {
      setInterval(() => postMessage({ event: "keepAlive" }), e.data.interval);
    }
  });`;class BF{constructor(t,r){var n;this.accessTokenValue=null,this.apiKey=null,this.channels=new Array,this.endPoint="",this.httpEndpoint="",this.headers={},this.params={},this.timeout=mE,this.heartbeatIntervalMs=25e3,this.heartbeatTimer=void 0,this.pendingHeartbeatRef=null,this.heartbeatCallback=C4,this.ref=0,this.logger=C4,this.conn=null,this.sendBuffer=[],this.serializer=new LF,this.stateChangeCallbacks={open:[],close:[],error:[],message:[]},this.accessToken=null,this._resolveFetch=i=>{let s;return i?s=i:typeof fetch>"u"?s=(...o)=>Zo(async()=>{const{default:l}=await Promise.resolve().then(()=>Ku);return{default:l}},void 0).then(({default:l})=>l(...o)):s=fetch,(...o)=>s(...o)},this.endPoint=`${t}/${Pv.websocket}`,this.httpEndpoint=xE(t),r!=null&&r.transport?this.transport=r.transport:this.transport=null,r!=null&&r.params&&(this.params=r.params),r!=null&&r.timeout&&(this.timeout=r.timeout),r!=null&&r.logger&&(this.logger=r.logger),(r!=null&&r.logLevel||r!=null&&r.log_level)&&(this.logLevel=r.logLevel||r.log_level,this.params=Object.assign(Object.assign({},this.params),{log_level:this.logLevel})),r!=null&&r.heartbeatIntervalMs&&(this.heartbeatIntervalMs=r.heartbeatIntervalMs);const a=(n=r==null?void 0:r.params)===null||n===void 0?void 0:n.apikey;if(a&&(this.accessTokenValue=a,this.apiKey=a),this.reconnectAfterMs=r!=null&&r.reconnectAfterMs?r.reconnectAfterMs:i=>[1e3,2e3,5e3,1e4][i-1]||1e4,this.encode=r!=null&&r.encode?r.encode:(i,s)=>s(JSON.stringify(i)),this.decode=r!=null&&r.decode?r.decode:this.serializer.decode.bind(this.serializer),this.reconnectTimer=new gE(async()=>{this.disconnect(),this.connect()},this.reconnectAfterMs),this.fetch=this._resolveFetch(r==null?void 0:r.fetch),r!=null&&r.worker){if(typeof window<"u"&&!window.Worker)throw new Error("Web Worker is not supported");this.worker=(r==null?void 0:r.worker)||!1,this.workerUrl=r==null?void 0:r.workerUrl}this.accessToken=(r==null?void 0:r.accessToken)||null}connect(){if(!this.conn){if(this.transport||(this.transport=AF),!this.transport)throw new Error("No transport provided");this.conn=new this.transport(this.endpointURL()),this.setupConnection()}}endpointURL(){return this._appendParams(this.endPoint,Object.assign({},this.params,{vsn:NF}))}disconnect(t,r){this.conn&&(this.conn.onclose=function(){},t?this.conn.close(t,r??""):this.conn.close(),this.conn=null,this.heartbeatTimer&&clearInterval(this.heartbeatTimer),this.reconnectTimer.reset(),this.channels.forEach(n=>n.teardown()))}getChannels(){return this.channels}async removeChannel(t){const r=await t.unsubscribe();return this.channels.length===0&&this.disconnect(),r}async removeAllChannels(){const t=await Promise.all(this.channels.map(r=>r.unsubscribe()));return this.channels=[],this.disconnect(),t}log(t,r,n){this.logger(t,r,n)}connectionState(){switch(this.conn&&this.conn.readyState){case h0.connecting:return Ol.Connecting;case h0.open:return Ol.Open;case h0.closing:return Ol.Closing;default:return Ol.Closed}}isConnected(){return this.connectionState()===Ol.Open}channel(t,r={config:{}}){const n=`realtime:${t}`,a=this.getChannels().find(i=>i.topic===n);if(a)return a;{const i=new Ay(`realtime:${t}`,r,this);return this.channels.push(i),i}}push(t){const{topic:r,event:n,payload:a,ref:i}=t,s=()=>{this.encode(t,o=>{var l;(l=this.conn)===null||l===void 0||l.send(o)})};this.log("push",`${r} ${n} (${i})`,a),this.isConnected()?s():this.sendBuffer.push(s)}async setAuth(t=null){let r=t||this.accessToken&&await this.accessToken()||this.accessTokenValue;this.accessTokenValue!=r&&(this.accessTokenValue=r,this.channels.forEach(n=>{const a={access_token:r,version:CF};r&&n.updateJoinPayload(a),n.joinedOnce&&n._isJoined()&&n._push(Li.access_token,{access_token:r})}))}async sendHeartbeat(){var t;if(!this.isConnected()){this.heartbeatCallback("disconnected");return}if(this.pendingHeartbeatRef){this.pendingHeartbeatRef=null,this.log("transport","heartbeat timeout. Attempting to re-establish connection"),this.heartbeatCallback("timeout"),(t=this.conn)===null||t===void 0||t.close(PF,"hearbeat timeout");return}this.pendingHeartbeatRef=this._makeRef(),this.push({topic:"phoenix",event:"heartbeat",payload:{},ref:this.pendingHeartbeatRef}),this.heartbeatCallback("sent"),await this.setAuth()}onHeartbeat(t){this.heartbeatCallback=t}flushSendBuffer(){this.isConnected()&&this.sendBuffer.length>0&&(this.sendBuffer.forEach(t=>t()),this.sendBuffer=[])}_makeRef(){let t=this.ref+1;return t===this.ref?this.ref=0:this.ref=t,this.ref.toString()}_leaveOpenTopic(t){let r=this.channels.find(n=>n.topic===t&&(n._isJoined()||n._isJoining()));r&&(this.log("transport",`leaving duplicate topic "${t}"`),r.unsubscribe())}_remove(t){this.channels=this.channels.filter(r=>r.topic!==t.topic)}setupConnection(){this.conn&&(this.conn.binaryType="arraybuffer",this.conn.onopen=()=>this._onConnOpen(),this.conn.onerror=t=>this._onConnError(t),this.conn.onmessage=t=>this._onConnMessage(t),this.conn.onclose=t=>this._onConnClose(t))}_onConnMessage(t){this.decode(t.data,r=>{let{topic:n,event:a,payload:i,ref:s}=r;n==="phoenix"&&a==="phx_reply"&&this.heartbeatCallback(r.payload.status=="ok"?"ok":"error"),s&&s===this.pendingHeartbeatRef&&(this.pendingHeartbeatRef=null),this.log("receive",`${i.status||""} ${n} ${a} ${s&&"("+s+")"||""}`,i),Array.from(this.channels).filter(o=>o._isMember(n)).forEach(o=>o._trigger(a,i,s)),this.stateChangeCallbacks.message.forEach(o=>o(r))})}_onConnOpen(){this.log("transport",`connected to ${this.endpointURL()}`),this.flushSendBuffer(),this.reconnectTimer.reset(),this.worker?this.workerRef||this._startWorkerHeartbeat():this._startHeartbeat(),this.stateChangeCallbacks.open.forEach(t=>t())}_startHeartbeat(){this.heartbeatTimer&&clearInterval(this.heartbeatTimer),this.heartbeatTimer=setInterval(()=>this.sendHeartbeat(),this.heartbeatIntervalMs)}_startWorkerHeartbeat(){this.workerUrl?this.log("worker",`starting worker for from ${this.workerUrl}`):this.log("worker","starting default worker");const t=this._workerObjectUrl(this.workerUrl);this.workerRef=new Worker(t),this.workerRef.onerror=r=>{this.log("worker","worker error",r.message),this.workerRef.terminate()},this.workerRef.onmessage=r=>{r.data.event==="keepAlive"&&this.sendHeartbeat()},this.workerRef.postMessage({event:"start",interval:this.heartbeatIntervalMs})}_onConnClose(t){this.log("transport","close",t),this._triggerChanError(),this.heartbeatTimer&&clearInterval(this.heartbeatTimer),this.reconnectTimer.scheduleTimeout(),this.stateChangeCallbacks.close.forEach(r=>r(t))}_onConnError(t){this.log("transport",`${t}`),this._triggerChanError(),this.stateChangeCallbacks.error.forEach(r=>r(t))}_triggerChanError(){this.channels.forEach(t=>t._trigger(Li.error))}_appendParams(t,r){if(Object.keys(r).length===0)return t;const n=t.match(/\?/)?"&":"?",a=new URLSearchParams(r);return`${t}${n}${a}`}_workerObjectUrl(t){let r;if(t)r=t;else{const n=new Blob([MF],{type:"application/javascript"});r=URL.createObjectURL(n)}return r}}class Ty extends Error{constructor(t){super(t),this.__isStorageError=!0,this.name="StorageError"}}function hn(e){return typeof e=="object"&&e!==null&&"__isStorageError"in e}class UF extends Ty{constructor(t,r){super(t),this.name="StorageApiError",this.status=r}toJSON(){return{name:this.name,message:this.message,status:this.status}}}class Fv extends Ty{constructor(t,r){super(t),this.name="StorageUnknownError",this.originalError=r}}var VF=function(e,t,r,n){function a(i){return i instanceof r?i:new r(function(s){s(i)})}return new(r||(r=Promise))(function(i,s){function o(u){try{c(n.next(u))}catch(f){s(f)}}function l(u){try{c(n.throw(u))}catch(f){s(f)}}function c(u){u.done?i(u.value):a(u.value).then(o,l)}c((n=n.apply(e,t||[])).next())})};const yE=e=>{let t;return e?t=e:typeof fetch>"u"?t=(...r)=>Zo(async()=>{const{default:n}=await Promise.resolve().then(()=>Ku);return{default:n}},void 0).then(({default:n})=>n(...r)):t=fetch,(...r)=>t(...r)},$F=()=>VF(void 0,void 0,void 0,function*(){return typeof Response>"u"?(yield Zo(()=>Promise.resolve().then(()=>Ku),void 0)).Response:Response}),Ov=e=>{if(Array.isArray(e))return e.map(r=>Ov(r));if(typeof e=="function"||e!==Object(e))return e;const t={};return Object.entries(e).forEach(([r,n])=>{const a=r.replace(/([-_][a-z])/gi,i=>i.toUpperCase().replace(/[-_]/g,""));t[a]=Ov(n)}),t};var oc=function(e,t,r,n){function a(i){return i instanceof r?i:new r(function(s){s(i)})}return new(r||(r=Promise))(function(i,s){function o(u){try{c(n.next(u))}catch(f){s(f)}}function l(u){try{c(n.throw(u))}catch(f){s(f)}}function c(u){u.done?i(u.value):a(u.value).then(o,l)}c((n=n.apply(e,t||[])).next())})};const Hg=e=>e.msg||e.message||e.error_description||e.error||JSON.stringify(e),zF=(e,t,r)=>oc(void 0,void 0,void 0,function*(){const n=yield $F();e instanceof n&&!(r!=null&&r.noResolveJson)?e.json().then(a=>{t(new UF(Hg(a),e.status||500))}).catch(a=>{t(new Fv(Hg(a),a))}):t(new Fv(Hg(e),e))}),HF=(e,t,r,n)=>{const a={method:e,headers:(t==null?void 0:t.headers)||{}};return e==="GET"?a:(a.headers=Object.assign({"Content-Type":"application/json"},t==null?void 0:t.headers),n&&(a.body=JSON.stringify(n)),Object.assign(Object.assign({},a),r))};function wh(e,t,r,n,a,i){return oc(this,void 0,void 0,function*(){return new Promise((s,o)=>{e(r,HF(t,n,a,i)).then(l=>{if(!l.ok)throw l;return n!=null&&n.noResolveJson?l:l.json()}).then(l=>s(l)).catch(l=>zF(l,o,n))})})}function o1(e,t,r,n){return oc(this,void 0,void 0,function*(){return wh(e,"GET",t,r,n)})}function To(e,t,r,n,a){return oc(this,void 0,void 0,function*(){return wh(e,"POST",t,n,a,r)})}function WF(e,t,r,n,a){return oc(this,void 0,void 0,function*(){return wh(e,"PUT",t,n,a,r)})}function qF(e,t,r,n){return oc(this,void 0,void 0,function*(){return wh(e,"HEAD",t,Object.assign(Object.assign({},r),{noResolveJson:!0}),n)})}function wE(e,t,r,n,a){return oc(this,void 0,void 0,function*(){return wh(e,"DELETE",t,n,a,r)})}var pa=function(e,t,r,n){function a(i){return i instanceof r?i:new r(function(s){s(i)})}return new(r||(r=Promise))(function(i,s){function o(u){try{c(n.next(u))}catch(f){s(f)}}function l(u){try{c(n.throw(u))}catch(f){s(f)}}function c(u){u.done?i(u.value):a(u.value).then(o,l)}c((n=n.apply(e,t||[])).next())})};const GF={limit:100,offset:0,sortBy:{column:"name",order:"asc"}},N4={cacheControl:"3600",contentType:"text/plain;charset=UTF-8",upsert:!1};class KF{constructor(t,r={},n,a){this.url=t,this.headers=r,this.bucketId=n,this.fetch=yE(a)}uploadOrUpdate(t,r,n,a){return pa(this,void 0,void 0,function*(){try{let i;const s=Object.assign(Object.assign({},N4),a);let o=Object.assign(Object.assign({},this.headers),t==="POST"&&{"x-upsert":String(s.upsert)});const l=s.metadata;typeof Blob<"u"&&n instanceof Blob?(i=new FormData,i.append("cacheControl",s.cacheControl),l&&i.append("metadata",this.encodeMetadata(l)),i.append("",n)):typeof FormData<"u"&&n instanceof FormData?(i=n,i.append("cacheControl",s.cacheControl),l&&i.append("metadata",this.encodeMetadata(l))):(i=n,o["cache-control"]=`max-age=${s.cacheControl}`,o["content-type"]=s.contentType,l&&(o["x-metadata"]=this.toBase64(this.encodeMetadata(l)))),a!=null&&a.headers&&(o=Object.assign(Object.assign({},o),a.headers));const c=this._removeEmptyFolders(r),u=this._getFinalPath(c),f=yield this.fetch(`${this.url}/object/${u}`,Object.assign({method:t,body:i,headers:o},s!=null&&s.duplex?{duplex:s.duplex}:{})),p=yield f.json();return f.ok?{data:{path:c,id:p.Id,fullPath:p.Key},error:null}:{data:null,error:p}}catch(i){if(hn(i))return{data:null,error:i};throw i}})}upload(t,r,n){return pa(this,void 0,void 0,function*(){return this.uploadOrUpdate("POST",t,r,n)})}uploadToSignedUrl(t,r,n,a){return pa(this,void 0,void 0,function*(){const i=this._removeEmptyFolders(t),s=this._getFinalPath(i),o=new URL(this.url+`/object/upload/sign/${s}`);o.searchParams.set("token",r);try{let l;const c=Object.assign({upsert:N4.upsert},a),u=Object.assign(Object.assign({},this.headers),{"x-upsert":String(c.upsert)});typeof Blob<"u"&&n instanceof Blob?(l=new FormData,l.append("cacheControl",c.cacheControl),l.append("",n)):typeof FormData<"u"&&n instanceof FormData?(l=n,l.append("cacheControl",c.cacheControl)):(l=n,u["cache-control"]=`max-age=${c.cacheControl}`,u["content-type"]=c.contentType);const f=yield this.fetch(o.toString(),{method:"PUT",body:l,headers:u}),p=yield f.json();return f.ok?{data:{path:i,fullPath:p.Key},error:null}:{data:null,error:p}}catch(l){if(hn(l))return{data:null,error:l};throw l}})}createSignedUploadUrl(t,r){return pa(this,void 0,void 0,function*(){try{let n=this._getFinalPath(t);const a=Object.assign({},this.headers);r!=null&&r.upsert&&(a["x-upsert"]="true");const i=yield To(this.fetch,`${this.url}/object/upload/sign/${n}`,{},{headers:a}),s=new URL(this.url+i.url),o=s.searchParams.get("token");if(!o)throw new Ty("No token returned by API");return{data:{signedUrl:s.toString(),path:t,token:o},error:null}}catch(n){if(hn(n))return{data:null,error:n};throw n}})}update(t,r,n){return pa(this,void 0,void 0,function*(){return this.uploadOrUpdate("PUT",t,r,n)})}move(t,r,n){return pa(this,void 0,void 0,function*(){try{return{data:yield To(this.fetch,`${this.url}/object/move`,{bucketId:this.bucketId,sourceKey:t,destinationKey:r,destinationBucket:n==null?void 0:n.destinationBucket},{headers:this.headers}),error:null}}catch(a){if(hn(a))return{data:null,error:a};throw a}})}copy(t,r,n){return pa(this,void 0,void 0,function*(){try{return{data:{path:(yield To(this.fetch,`${this.url}/object/copy`,{bucketId:this.bucketId,sourceKey:t,destinationKey:r,destinationBucket:n==null?void 0:n.destinationBucket},{headers:this.headers})).Key},error:null}}catch(a){if(hn(a))return{data:null,error:a};throw a}})}createSignedUrl(t,r,n){return pa(this,void 0,void 0,function*(){try{let a=this._getFinalPath(t),i=yield To(this.fetch,`${this.url}/object/sign/${a}`,Object.assign({expiresIn:r},n!=null&&n.transform?{transform:n.transform}:{}),{headers:this.headers});const s=n!=null&&n.download?`&download=${n.download===!0?"":n.download}`:"";return i={signedUrl:encodeURI(`${this.url}${i.signedURL}${s}`)},{data:i,error:null}}catch(a){if(hn(a))return{data:null,error:a};throw a}})}createSignedUrls(t,r,n){return pa(this,void 0,void 0,function*(){try{const a=yield To(this.fetch,`${this.url}/object/sign/${this.bucketId}`,{expiresIn:r,paths:t},{headers:this.headers}),i=n!=null&&n.download?`&download=${n.download===!0?"":n.download}`:"";return{data:a.map(s=>Object.assign(Object.assign({},s),{signedUrl:s.signedURL?encodeURI(`${this.url}${s.signedURL}${i}`):null})),error:null}}catch(a){if(hn(a))return{data:null,error:a};throw a}})}download(t,r){return pa(this,void 0,void 0,function*(){const a=typeof(r==null?void 0:r.transform)<"u"?"render/image/authenticated":"object",i=this.transformOptsToQueryString((r==null?void 0:r.transform)||{}),s=i?`?${i}`:"";try{const o=this._getFinalPath(t);return{data:yield(yield o1(this.fetch,`${this.url}/${a}/${o}${s}`,{headers:this.headers,noResolveJson:!0})).blob(),error:null}}catch(o){if(hn(o))return{data:null,error:o};throw o}})}info(t){return pa(this,void 0,void 0,function*(){const r=this._getFinalPath(t);try{const n=yield o1(this.fetch,`${this.url}/object/info/${r}`,{headers:this.headers});return{data:Ov(n),error:null}}catch(n){if(hn(n))return{data:null,error:n};throw n}})}exists(t){return pa(this,void 0,void 0,function*(){const r=this._getFinalPath(t);try{return yield qF(this.fetch,`${this.url}/object/${r}`,{headers:this.headers}),{data:!0,error:null}}catch(n){if(hn(n)&&n instanceof Fv){const a=n.originalError;if([400,404].includes(a==null?void 0:a.status))return{data:!1,error:n}}throw n}})}getPublicUrl(t,r){const n=this._getFinalPath(t),a=[],i=r!=null&&r.download?`download=${r.download===!0?"":r.download}`:"";i!==""&&a.push(i);const o=typeof(r==null?void 0:r.transform)<"u"?"render/image":"object",l=this.transformOptsToQueryString((r==null?void 0:r.transform)||{});l!==""&&a.push(l);let c=a.join("&");return c!==""&&(c=`?${c}`),{data:{publicUrl:encodeURI(`${this.url}/${o}/public/${n}${c}`)}}}remove(t){return pa(this,void 0,void 0,function*(){try{return{data:yield wE(this.fetch,`${this.url}/object/${this.bucketId}`,{prefixes:t},{headers:this.headers}),error:null}}catch(r){if(hn(r))return{data:null,error:r};throw r}})}list(t,r,n){return pa(this,void 0,void 0,function*(){try{const a=Object.assign(Object.assign(Object.assign({},GF),r),{prefix:t||""});return{data:yield To(this.fetch,`${this.url}/object/list/${this.bucketId}`,a,{headers:this.headers},n),error:null}}catch(a){if(hn(a))return{data:null,error:a};throw a}})}encodeMetadata(t){return JSON.stringify(t)}toBase64(t){return typeof Buffer<"u"?Buffer.from(t).toString("base64"):btoa(t)}_getFinalPath(t){return`${this.bucketId}/${t}`}_removeEmptyFolders(t){return t.replace(/^\/|\/$/g,"").replace(/\/+/g,"/")}transformOptsToQueryString(t){const r=[];return t.width&&r.push(`width=${t.width}`),t.height&&r.push(`height=${t.height}`),t.resize&&r.push(`resize=${t.resize}`),t.format&&r.push(`format=${t.format}`),t.quality&&r.push(`quality=${t.quality}`),r.join("&")}}const XF="2.7.1",YF={"X-Client-Info":`storage-js/${XF}`};var Vc=function(e,t,r,n){function a(i){return i instanceof r?i:new r(function(s){s(i)})}return new(r||(r=Promise))(function(i,s){function o(u){try{c(n.next(u))}catch(f){s(f)}}function l(u){try{c(n.throw(u))}catch(f){s(f)}}function c(u){u.done?i(u.value):a(u.value).then(o,l)}c((n=n.apply(e,t||[])).next())})};class JF{constructor(t,r={},n){this.url=t,this.headers=Object.assign(Object.assign({},YF),r),this.fetch=yE(n)}listBuckets(){return Vc(this,void 0,void 0,function*(){try{return{data:yield o1(this.fetch,`${this.url}/bucket`,{headers:this.headers}),error:null}}catch(t){if(hn(t))return{data:null,error:t};throw t}})}getBucket(t){return Vc(this,void 0,void 0,function*(){try{return{data:yield o1(this.fetch,`${this.url}/bucket/${t}`,{headers:this.headers}),error:null}}catch(r){if(hn(r))return{data:null,error:r};throw r}})}createBucket(t,r={public:!1}){return Vc(this,void 0,void 0,function*(){try{return{data:yield To(this.fetch,`${this.url}/bucket`,{id:t,name:t,public:r.public,file_size_limit:r.fileSizeLimit,allowed_mime_types:r.allowedMimeTypes},{headers:this.headers}),error:null}}catch(n){if(hn(n))return{data:null,error:n};throw n}})}updateBucket(t,r){return Vc(this,void 0,void 0,function*(){try{return{data:yield WF(this.fetch,`${this.url}/bucket/${t}`,{id:t,name:t,public:r.public,file_size_limit:r.fileSizeLimit,allowed_mime_types:r.allowedMimeTypes},{headers:this.headers}),error:null}}catch(n){if(hn(n))return{data:null,error:n};throw n}})}emptyBucket(t){return Vc(this,void 0,void 0,function*(){try{return{data:yield To(this.fetch,`${this.url}/bucket/${t}/empty`,{},{headers:this.headers}),error:null}}catch(r){if(hn(r))return{data:null,error:r};throw r}})}deleteBucket(t){return Vc(this,void 0,void 0,function*(){try{return{data:yield wE(this.fetch,`${this.url}/bucket/${t}`,{},{headers:this.headers}),error:null}}catch(r){if(hn(r))return{data:null,error:r};throw r}})}}class QF extends JF{constructor(t,r={},n){super(t,r,n)}from(t){return new KF(this.url,this.headers,t,this.fetch)}}const ZF="2.50.3";let Yf="";typeof Deno<"u"?Yf="deno":typeof document<"u"?Yf="web":typeof navigator<"u"&&navigator.product==="ReactNative"?Yf="react-native":Yf="node";const e7={"X-Client-Info":`supabase-js-${Yf}/${ZF}`},t7={headers:e7},r7={schema:"public"},n7={autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,flowType:"implicit"},a7={};var i7=function(e,t,r,n){function a(i){return i instanceof r?i:new r(function(s){s(i)})}return new(r||(r=Promise))(function(i,s){function o(u){try{c(n.next(u))}catch(f){s(f)}}function l(u){try{c(n.throw(u))}catch(f){s(f)}}function c(u){u.done?i(u.value):a(u.value).then(o,l)}c((n=n.apply(e,t||[])).next())})};const s7=e=>{let t;return e?t=e:typeof fetch>"u"?t=aE:t=fetch,(...r)=>t(...r)},o7=()=>typeof Headers>"u"?iE:Headers,l7=(e,t,r)=>{const n=s7(r),a=o7();return(i,s)=>i7(void 0,void 0,void 0,function*(){var o;const l=(o=yield t())!==null&&o!==void 0?o:e;let c=new a(s==null?void 0:s.headers);return c.has("apikey")||c.set("apikey",e),c.has("Authorization")||c.set("Authorization",`Bearer ${l}`),n(i,Object.assign(Object.assign({},s),{headers:c}))})};var c7=function(e,t,r,n){function a(i){return i instanceof r?i:new r(function(s){s(i)})}return new(r||(r=Promise))(function(i,s){function o(u){try{c(n.next(u))}catch(f){s(f)}}function l(u){try{c(n.throw(u))}catch(f){s(f)}}function c(u){u.done?i(u.value):a(u.value).then(o,l)}c((n=n.apply(e,t||[])).next())})};function u7(e){return e.endsWith("/")?e:e+"/"}function f7(e,t){var r,n;const{db:a,auth:i,realtime:s,global:o}=e,{db:l,auth:c,realtime:u,global:f}=t,p={db:Object.assign(Object.assign({},l),a),auth:Object.assign(Object.assign({},c),i),realtime:Object.assign(Object.assign({},u),s),global:Object.assign(Object.assign(Object.assign({},f),o),{headers:Object.assign(Object.assign({},(r=f==null?void 0:f.headers)!==null&&r!==void 0?r:{}),(n=o==null?void 0:o.headers)!==null&&n!==void 0?n:{})}),accessToken:()=>c7(this,void 0,void 0,function*(){return""})};return e.accessToken?p.accessToken=e.accessToken:delete p.accessToken,p}const bE="2.70.0",Kc=30*1e3,Dv=3,Wg=Dv*Kc,h7="http://localhost:9999",d7="supabase.auth.token",p7={"X-Client-Info":`gotrue-js/${bE}`},Iv="X-Supabase-Api-Version",_E={"2024-01-01":{timestamp:Date.parse("2024-01-01T00:00:00.0Z"),name:"2024-01-01"}},m7=/^([a-z0-9_-]{4})*($|[a-z0-9_-]{3}$|[a-z0-9_-]{2}$)$/i,g7=6e5;class Cy extends Error{constructor(t,r,n){super(t),this.__isAuthError=!0,this.name="AuthError",this.status=r,this.code=n}}function Lt(e){return typeof e=="object"&&e!==null&&"__isAuthError"in e}class v7 extends Cy{constructor(t,r,n){super(t,r,n),this.name="AuthApiError",this.status=r,this.code=n}}function x7(e){return Lt(e)&&e.name==="AuthApiError"}class SE extends Cy{constructor(t,r){super(t),this.name="AuthUnknownError",this.originalError=r}}class ul extends Cy{constructor(t,r,n,a){super(t,n,a),this.name=r,this.status=n}}class So extends ul{constructor(){super("Auth session missing!","AuthSessionMissingError",400,void 0)}}function y7(e){return Lt(e)&&e.name==="AuthSessionMissingError"}class zd extends ul{constructor(){super("Auth session or user missing","AuthInvalidTokenResponseError",500,void 0)}}class Hd extends ul{constructor(t){super(t,"AuthInvalidCredentialsError",400,void 0)}}class Wd extends ul{constructor(t,r=null){super(t,"AuthImplicitGrantRedirectError",500,void 0),this.details=null,this.details=r}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}function w7(e){return Lt(e)&&e.name==="AuthImplicitGrantRedirectError"}class P4 extends ul{constructor(t,r=null){super(t,"AuthPKCEGrantCodeExchangeError",500,void 0),this.details=null,this.details=r}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}class Rv extends ul{constructor(t,r){super(t,"AuthRetryableFetchError",r,void 0)}}function qg(e){return Lt(e)&&e.name==="AuthRetryableFetchError"}class L4 extends ul{constructor(t,r,n){super(t,"AuthWeakPasswordError",r,"weak_password"),this.reasons=n}}class p0 extends ul{constructor(t){super(t,"AuthInvalidJwtError",400,"invalid_jwt")}}const l1="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_".split(""),F4=` 	
\r=`.split(""),b7=(()=>{const e=new Array(128);for(let t=0;t<e.length;t+=1)e[t]=-1;for(let t=0;t<F4.length;t+=1)e[F4[t].charCodeAt(0)]=-2;for(let t=0;t<l1.length;t+=1)e[l1[t].charCodeAt(0)]=t;return e})();function O4(e,t,r){if(e!==null)for(t.queue=t.queue<<8|e,t.queuedBits+=8;t.queuedBits>=6;){const n=t.queue>>t.queuedBits-6&63;r(l1[n]),t.queuedBits-=6}else if(t.queuedBits>0)for(t.queue=t.queue<<6-t.queuedBits,t.queuedBits=6;t.queuedBits>=6;){const n=t.queue>>t.queuedBits-6&63;r(l1[n]),t.queuedBits-=6}}function kE(e,t,r){const n=b7[e];if(n>-1)for(t.queue=t.queue<<6|n,t.queuedBits+=6;t.queuedBits>=8;)r(t.queue>>t.queuedBits-8&255),t.queuedBits-=8;else{if(n===-2)return;throw new Error(`Invalid Base64-URL character "${String.fromCharCode(e)}"`)}}function D4(e){const t=[],r=s=>{t.push(String.fromCodePoint(s))},n={utf8seq:0,codepoint:0},a={queue:0,queuedBits:0},i=s=>{k7(s,n,r)};for(let s=0;s<e.length;s+=1)kE(e.charCodeAt(s),a,i);return t.join("")}function _7(e,t){if(e<=127){t(e);return}else if(e<=2047){t(192|e>>6),t(128|e&63);return}else if(e<=65535){t(224|e>>12),t(128|e>>6&63),t(128|e&63);return}else if(e<=1114111){t(240|e>>18),t(128|e>>12&63),t(128|e>>6&63),t(128|e&63);return}throw new Error(`Unrecognized Unicode codepoint: ${e.toString(16)}`)}function S7(e,t){for(let r=0;r<e.length;r+=1){let n=e.charCodeAt(r);if(n>55295&&n<=56319){const a=(n-55296)*1024&65535;n=(e.charCodeAt(r+1)-56320&65535|a)+65536,r+=1}_7(n,t)}}function k7(e,t,r){if(t.utf8seq===0){if(e<=127){r(e);return}for(let n=1;n<6;n+=1)if(!(e>>7-n&1)){t.utf8seq=n;break}if(t.utf8seq===2)t.codepoint=e&31;else if(t.utf8seq===3)t.codepoint=e&15;else if(t.utf8seq===4)t.codepoint=e&7;else throw new Error("Invalid UTF-8 sequence");t.utf8seq-=1}else if(t.utf8seq>0){if(e<=127)throw new Error("Invalid UTF-8 sequence");t.codepoint=t.codepoint<<6|e&63,t.utf8seq-=1,t.utf8seq===0&&r(t.codepoint)}}function E7(e){const t=[],r={queue:0,queuedBits:0},n=a=>{t.push(a)};for(let a=0;a<e.length;a+=1)kE(e.charCodeAt(a),r,n);return new Uint8Array(t)}function A7(e){const t=[];return S7(e,r=>t.push(r)),new Uint8Array(t)}function T7(e){const t=[],r={queue:0,queuedBits:0},n=a=>{t.push(a)};return e.forEach(a=>O4(a,r,n)),O4(null,r,n),t.join("")}function C7(e){return Math.round(Date.now()/1e3)+e}function N7(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(e){const t=Math.random()*16|0;return(e=="x"?t:t&3|8).toString(16)})}const Ai=()=>typeof window<"u"&&typeof document<"u",Sl={tested:!1,writable:!1},m0=()=>{if(!Ai())return!1;try{if(typeof globalThis.localStorage!="object")return!1}catch{return!1}if(Sl.tested)return Sl.writable;const e=`lswt-${Math.random()}${Math.random()}`;try{globalThis.localStorage.setItem(e,e),globalThis.localStorage.removeItem(e),Sl.tested=!0,Sl.writable=!0}catch{Sl.tested=!0,Sl.writable=!1}return Sl.writable};function P7(e){const t={},r=new URL(e);if(r.hash&&r.hash[0]==="#")try{new URLSearchParams(r.hash.substring(1)).forEach((a,i)=>{t[i]=a})}catch{}return r.searchParams.forEach((n,a)=>{t[a]=n}),t}const EE=e=>{let t;return e?t=e:typeof fetch>"u"?t=(...r)=>Zo(async()=>{const{default:n}=await Promise.resolve().then(()=>Ku);return{default:n}},void 0).then(({default:n})=>n(...r)):t=fetch,(...r)=>t(...r)},L7=e=>typeof e=="object"&&e!==null&&"status"in e&&"ok"in e&&"json"in e&&typeof e.json=="function",AE=async(e,t,r)=>{await e.setItem(t,JSON.stringify(r))},qd=async(e,t)=>{const r=await e.getItem(t);if(!r)return null;try{return JSON.parse(r)}catch{return r}},Gd=async(e,t)=>{await e.removeItem(t)};class sm{constructor(){this.promise=new sm.promiseConstructor((t,r)=>{this.resolve=t,this.reject=r})}}sm.promiseConstructor=Promise;function Gg(e){const t=e.split(".");if(t.length!==3)throw new p0("Invalid JWT structure");for(let n=0;n<t.length;n++)if(!m7.test(t[n]))throw new p0("JWT not in base64url format");return{header:JSON.parse(D4(t[0])),payload:JSON.parse(D4(t[1])),signature:E7(t[2]),raw:{header:t[0],payload:t[1]}}}async function F7(e){return await new Promise(t=>{setTimeout(()=>t(null),e)})}function O7(e,t){return new Promise((n,a)=>{(async()=>{for(let i=0;i<1/0;i++)try{const s=await e(i);if(!t(i,null,s)){n(s);return}}catch(s){if(!t(i,s)){a(s);return}}})()})}function D7(e){return("0"+e.toString(16)).substr(-2)}function I7(){const t=new Uint32Array(56);if(typeof crypto>"u"){const r="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-._~",n=r.length;let a="";for(let i=0;i<56;i++)a+=r.charAt(Math.floor(Math.random()*n));return a}return crypto.getRandomValues(t),Array.from(t,D7).join("")}async function R7(e){const r=new TextEncoder().encode(e),n=await crypto.subtle.digest("SHA-256",r),a=new Uint8Array(n);return Array.from(a).map(i=>String.fromCharCode(i)).join("")}async function j7(e){if(!(typeof crypto<"u"&&typeof crypto.subtle<"u"&&typeof TextEncoder<"u"))return console.warn("WebCrypto API is not supported. Code challenge method will default to use plain instead of sha256."),e;const r=await R7(e);return btoa(r).replace(/\+/g,"-").replace(/\//g,"_").replace(/=+$/,"")}async function $c(e,t,r=!1){const n=I7();let a=n;r&&(a+="/PASSWORD_RECOVERY"),await AE(e,`${t}-code-verifier`,a);const i=await j7(n);return[i,n===i?"plain":"s256"]}const M7=/^2[0-9]{3}-(0[1-9]|1[0-2])-(0[1-9]|1[0-9]|2[0-9]|3[0-1])$/i;function B7(e){const t=e.headers.get(Iv);if(!t||!t.match(M7))return null;try{return new Date(`${t}T00:00:00.0Z`)}catch{return null}}function U7(e){if(!e)throw new Error("Missing exp claim");const t=Math.floor(Date.now()/1e3);if(e<=t)throw new Error("JWT has expired")}function V7(e){switch(e){case"RS256":return{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-256"}};case"ES256":return{name:"ECDSA",namedCurve:"P-256",hash:{name:"SHA-256"}};default:throw new Error("Invalid alg claim")}}const $7=/^[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}$/;function zc(e){if(!$7.test(e))throw new Error("@supabase/auth-js: Expected parameter to be UUID but is not")}var z7=function(e,t){var r={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(r[n]=e[n]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var a=0,n=Object.getOwnPropertySymbols(e);a<n.length;a++)t.indexOf(n[a])<0&&Object.prototype.propertyIsEnumerable.call(e,n[a])&&(r[n[a]]=e[n[a]]);return r};const Tl=e=>e.msg||e.message||e.error_description||e.error||JSON.stringify(e),H7=[502,503,504];async function I4(e){var t;if(!L7(e))throw new Rv(Tl(e),0);if(H7.includes(e.status))throw new Rv(Tl(e),e.status);let r;try{r=await e.json()}catch(i){throw new SE(Tl(i),i)}let n;const a=B7(e);if(a&&a.getTime()>=_E["2024-01-01"].timestamp&&typeof r=="object"&&r&&typeof r.code=="string"?n=r.code:typeof r=="object"&&r&&typeof r.error_code=="string"&&(n=r.error_code),n){if(n==="weak_password")throw new L4(Tl(r),e.status,((t=r.weak_password)===null||t===void 0?void 0:t.reasons)||[]);if(n==="session_not_found")throw new So}else if(typeof r=="object"&&r&&typeof r.weak_password=="object"&&r.weak_password&&Array.isArray(r.weak_password.reasons)&&r.weak_password.reasons.length&&r.weak_password.reasons.reduce((i,s)=>i&&typeof s=="string",!0))throw new L4(Tl(r),e.status,r.weak_password.reasons);throw new v7(Tl(r),e.status||500,n)}const W7=(e,t,r,n)=>{const a={method:e,headers:(t==null?void 0:t.headers)||{}};return e==="GET"?a:(a.headers=Object.assign({"Content-Type":"application/json;charset=UTF-8"},t==null?void 0:t.headers),a.body=JSON.stringify(n),Object.assign(Object.assign({},a),r))};async function Dt(e,t,r,n){var a;const i=Object.assign({},n==null?void 0:n.headers);i[Iv]||(i[Iv]=_E["2024-01-01"].name),n!=null&&n.jwt&&(i.Authorization=`Bearer ${n.jwt}`);const s=(a=n==null?void 0:n.query)!==null&&a!==void 0?a:{};n!=null&&n.redirectTo&&(s.redirect_to=n.redirectTo);const o=Object.keys(s).length?"?"+new URLSearchParams(s).toString():"",l=await q7(e,t,r+o,{headers:i,noResolveJson:n==null?void 0:n.noResolveJson},{},n==null?void 0:n.body);return n!=null&&n.xform?n==null?void 0:n.xform(l):{data:Object.assign({},l),error:null}}async function q7(e,t,r,n,a,i){const s=W7(t,n,a,i);let o;try{o=await e(r,Object.assign({},s))}catch(l){throw console.error(l),new Rv(Tl(l),0)}if(o.ok||await I4(o),n!=null&&n.noResolveJson)return o;try{return await o.json()}catch(l){await I4(l)}}function Ls(e){var t;let r=null;Y7(e)&&(r=Object.assign({},e),e.expires_at||(r.expires_at=C7(e.expires_in)));const n=(t=e.user)!==null&&t!==void 0?t:e;return{data:{session:r,user:n},error:null}}function R4(e){const t=Ls(e);return!t.error&&e.weak_password&&typeof e.weak_password=="object"&&Array.isArray(e.weak_password.reasons)&&e.weak_password.reasons.length&&e.weak_password.message&&typeof e.weak_password.message=="string"&&e.weak_password.reasons.reduce((r,n)=>r&&typeof n=="string",!0)&&(t.data.weak_password=e.weak_password),t}function Fo(e){var t;return{data:{user:(t=e.user)!==null&&t!==void 0?t:e},error:null}}function G7(e){return{data:e,error:null}}function K7(e){const{action_link:t,email_otp:r,hashed_token:n,redirect_to:a,verification_type:i}=e,s=z7(e,["action_link","email_otp","hashed_token","redirect_to","verification_type"]),o={action_link:t,email_otp:r,hashed_token:n,redirect_to:a,verification_type:i},l=Object.assign({},s);return{data:{properties:o,user:l},error:null}}function X7(e){return e}function Y7(e){return e.access_token&&e.refresh_token&&e.expires_in}const Kg=["global","local","others"];var J7=function(e,t){var r={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(r[n]=e[n]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var a=0,n=Object.getOwnPropertySymbols(e);a<n.length;a++)t.indexOf(n[a])<0&&Object.prototype.propertyIsEnumerable.call(e,n[a])&&(r[n[a]]=e[n[a]]);return r};class Q7{constructor({url:t="",headers:r={},fetch:n}){this.url=t,this.headers=r,this.fetch=EE(n),this.mfa={listFactors:this._listFactors.bind(this),deleteFactor:this._deleteFactor.bind(this)}}async signOut(t,r=Kg[0]){if(Kg.indexOf(r)<0)throw new Error(`@supabase/auth-js: Parameter scope must be one of ${Kg.join(", ")}`);try{return await Dt(this.fetch,"POST",`${this.url}/logout?scope=${r}`,{headers:this.headers,jwt:t,noResolveJson:!0}),{data:null,error:null}}catch(n){if(Lt(n))return{data:null,error:n};throw n}}async inviteUserByEmail(t,r={}){try{return await Dt(this.fetch,"POST",`${this.url}/invite`,{body:{email:t,data:r.data},headers:this.headers,redirectTo:r.redirectTo,xform:Fo})}catch(n){if(Lt(n))return{data:{user:null},error:n};throw n}}async generateLink(t){try{const{options:r}=t,n=J7(t,["options"]),a=Object.assign(Object.assign({},n),r);return"newEmail"in n&&(a.new_email=n==null?void 0:n.newEmail,delete a.newEmail),await Dt(this.fetch,"POST",`${this.url}/admin/generate_link`,{body:a,headers:this.headers,xform:K7,redirectTo:r==null?void 0:r.redirectTo})}catch(r){if(Lt(r))return{data:{properties:null,user:null},error:r};throw r}}async createUser(t){try{return await Dt(this.fetch,"POST",`${this.url}/admin/users`,{body:t,headers:this.headers,xform:Fo})}catch(r){if(Lt(r))return{data:{user:null},error:r};throw r}}async listUsers(t){var r,n,a,i,s,o,l;try{const c={nextPage:null,lastPage:0,total:0},u=await Dt(this.fetch,"GET",`${this.url}/admin/users`,{headers:this.headers,noResolveJson:!0,query:{page:(n=(r=t==null?void 0:t.page)===null||r===void 0?void 0:r.toString())!==null&&n!==void 0?n:"",per_page:(i=(a=t==null?void 0:t.perPage)===null||a===void 0?void 0:a.toString())!==null&&i!==void 0?i:""},xform:X7});if(u.error)throw u.error;const f=await u.json(),p=(s=u.headers.get("x-total-count"))!==null&&s!==void 0?s:0,h=(l=(o=u.headers.get("link"))===null||o===void 0?void 0:o.split(","))!==null&&l!==void 0?l:[];return h.length>0&&(h.forEach(g=>{const m=parseInt(g.split(";")[0].split("=")[1].substring(0,1)),b=JSON.parse(g.split(";")[1].split("=")[1]);c[`${b}Page`]=m}),c.total=parseInt(p)),{data:Object.assign(Object.assign({},f),c),error:null}}catch(c){if(Lt(c))return{data:{users:[]},error:c};throw c}}async getUserById(t){zc(t);try{return await Dt(this.fetch,"GET",`${this.url}/admin/users/${t}`,{headers:this.headers,xform:Fo})}catch(r){if(Lt(r))return{data:{user:null},error:r};throw r}}async updateUserById(t,r){zc(t);try{return await Dt(this.fetch,"PUT",`${this.url}/admin/users/${t}`,{body:r,headers:this.headers,xform:Fo})}catch(n){if(Lt(n))return{data:{user:null},error:n};throw n}}async deleteUser(t,r=!1){zc(t);try{return await Dt(this.fetch,"DELETE",`${this.url}/admin/users/${t}`,{headers:this.headers,body:{should_soft_delete:r},xform:Fo})}catch(n){if(Lt(n))return{data:{user:null},error:n};throw n}}async _listFactors(t){zc(t.userId);try{const{data:r,error:n}=await Dt(this.fetch,"GET",`${this.url}/admin/users/${t.userId}/factors`,{headers:this.headers,xform:a=>({data:{factors:a},error:null})});return{data:r,error:n}}catch(r){if(Lt(r))return{data:null,error:r};throw r}}async _deleteFactor(t){zc(t.userId),zc(t.id);try{return{data:await Dt(this.fetch,"DELETE",`${this.url}/admin/users/${t.userId}/factors/${t.id}`,{headers:this.headers}),error:null}}catch(r){if(Lt(r))return{data:null,error:r};throw r}}}const Z7={getItem:e=>m0()?globalThis.localStorage.getItem(e):null,setItem:(e,t)=>{m0()&&globalThis.localStorage.setItem(e,t)},removeItem:e=>{m0()&&globalThis.localStorage.removeItem(e)}};function j4(e={}){return{getItem:t=>e[t]||null,setItem:(t,r)=>{e[t]=r},removeItem:t=>{delete e[t]}}}function eO(){if(typeof globalThis!="object")try{Object.defineProperty(Object.prototype,"__magic__",{get:function(){return this},configurable:!0}),__magic__.globalThis=__magic__,delete Object.prototype.__magic__}catch{typeof self<"u"&&(self.globalThis=self)}}const Hc={debug:!!(globalThis&&m0()&&globalThis.localStorage&&globalThis.localStorage.getItem("supabase.gotrue-js.locks.debug")==="true")};class TE extends Error{constructor(t){super(t),this.isAcquireTimeout=!0}}class tO extends TE{}async function rO(e,t,r){Hc.debug&&console.log("@supabase/gotrue-js: navigatorLock: acquire lock",e,t);const n=new globalThis.AbortController;return t>0&&setTimeout(()=>{n.abort(),Hc.debug&&console.log("@supabase/gotrue-js: navigatorLock acquire timed out",e)},t),await Promise.resolve().then(()=>globalThis.navigator.locks.request(e,t===0?{mode:"exclusive",ifAvailable:!0}:{mode:"exclusive",signal:n.signal},async a=>{if(a){Hc.debug&&console.log("@supabase/gotrue-js: navigatorLock: acquired",e,a.name);try{return await r()}finally{Hc.debug&&console.log("@supabase/gotrue-js: navigatorLock: released",e,a.name)}}else{if(t===0)throw Hc.debug&&console.log("@supabase/gotrue-js: navigatorLock: not immediately available",e),new tO(`Acquiring an exclusive Navigator LockManager lock "${e}" immediately failed`);if(Hc.debug)try{const i=await globalThis.navigator.locks.query();console.log("@supabase/gotrue-js: Navigator LockManager state",JSON.stringify(i,null,"  "))}catch(i){console.warn("@supabase/gotrue-js: Error when querying Navigator LockManager state",i)}return console.warn("@supabase/gotrue-js: Navigator LockManager returned a null lock when using #request without ifAvailable set to true, it appears this browser is not following the LockManager spec https://developer.mozilla.org/en-US/docs/Web/API/LockManager/request"),await r()}}))}eO();const nO={url:h7,storageKey:d7,autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,headers:p7,flowType:"implicit",debug:!1,hasCustomAuthorizationHeader:!1};async function M4(e,t,r){return await r()}class Y0{constructor(t){var r,n;this.memoryStorage=null,this.stateChangeEmitters=new Map,this.autoRefreshTicker=null,this.visibilityChangedCallback=null,this.refreshingDeferred=null,this.initializePromise=null,this.detectSessionInUrl=!0,this.hasCustomAuthorizationHeader=!1,this.suppressGetSessionWarning=!1,this.lockAcquired=!1,this.pendingInLock=[],this.broadcastChannel=null,this.logger=console.log,this.instanceID=Y0.nextInstanceID,Y0.nextInstanceID+=1,this.instanceID>0&&Ai()&&console.warn("Multiple GoTrueClient instances detected in the same browser context. It is not an error, but this should be avoided as it may produce undefined behavior when used concurrently under the same storage key.");const a=Object.assign(Object.assign({},nO),t);if(this.logDebugMessages=!!a.debug,typeof a.debug=="function"&&(this.logger=a.debug),this.persistSession=a.persistSession,this.storageKey=a.storageKey,this.autoRefreshToken=a.autoRefreshToken,this.admin=new Q7({url:a.url,headers:a.headers,fetch:a.fetch}),this.url=a.url,this.headers=a.headers,this.fetch=EE(a.fetch),this.lock=a.lock||M4,this.detectSessionInUrl=a.detectSessionInUrl,this.flowType=a.flowType,this.hasCustomAuthorizationHeader=a.hasCustomAuthorizationHeader,a.lock?this.lock=a.lock:Ai()&&(!((r=globalThis==null?void 0:globalThis.navigator)===null||r===void 0)&&r.locks)?this.lock=rO:this.lock=M4,this.jwks={keys:[]},this.jwks_cached_at=Number.MIN_SAFE_INTEGER,this.mfa={verify:this._verify.bind(this),enroll:this._enroll.bind(this),unenroll:this._unenroll.bind(this),challenge:this._challenge.bind(this),listFactors:this._listFactors.bind(this),challengeAndVerify:this._challengeAndVerify.bind(this),getAuthenticatorAssuranceLevel:this._getAuthenticatorAssuranceLevel.bind(this)},this.persistSession?a.storage?this.storage=a.storage:m0()?this.storage=Z7:(this.memoryStorage={},this.storage=j4(this.memoryStorage)):(this.memoryStorage={},this.storage=j4(this.memoryStorage)),Ai()&&globalThis.BroadcastChannel&&this.persistSession&&this.storageKey){try{this.broadcastChannel=new globalThis.BroadcastChannel(this.storageKey)}catch(i){console.error("Failed to create a new BroadcastChannel, multi-tab state changes will not be available",i)}(n=this.broadcastChannel)===null||n===void 0||n.addEventListener("message",async i=>{this._debug("received broadcast notification from other tab or client",i),await this._notifyAllSubscribers(i.data.event,i.data.session,!1)})}this.initialize()}_debug(...t){return this.logDebugMessages&&this.logger(`GoTrueClient@${this.instanceID} (${bE}) ${new Date().toISOString()}`,...t),this}async initialize(){return this.initializePromise?await this.initializePromise:(this.initializePromise=(async()=>await this._acquireLock(-1,async()=>await this._initialize()))(),await this.initializePromise)}async _initialize(){var t;try{const r=P7(window.location.href);let n="none";if(this._isImplicitGrantCallback(r)?n="implicit":await this._isPKCECallback(r)&&(n="pkce"),Ai()&&this.detectSessionInUrl&&n!=="none"){const{data:a,error:i}=await this._getSessionFromURL(r,n);if(i){if(this._debug("#_initialize()","error detecting session from URL",i),w7(i)){const l=(t=i.details)===null||t===void 0?void 0:t.code;if(l==="identity_already_exists"||l==="identity_not_found"||l==="single_identity_not_deletable")return{error:i}}return await this._removeSession(),{error:i}}const{session:s,redirectType:o}=a;return this._debug("#_initialize()","detected session in URL",s,"redirect type",o),await this._saveSession(s),setTimeout(async()=>{o==="recovery"?await this._notifyAllSubscribers("PASSWORD_RECOVERY",s):await this._notifyAllSubscribers("SIGNED_IN",s)},0),{error:null}}return await this._recoverAndRefresh(),{error:null}}catch(r){return Lt(r)?{error:r}:{error:new SE("Unexpected error during initialization",r)}}finally{await this._handleVisibilityChange(),this._debug("#_initialize()","end")}}async signInAnonymously(t){var r,n,a;try{const i=await Dt(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{data:(n=(r=t==null?void 0:t.options)===null||r===void 0?void 0:r.data)!==null&&n!==void 0?n:{},gotrue_meta_security:{captcha_token:(a=t==null?void 0:t.options)===null||a===void 0?void 0:a.captchaToken}},xform:Ls}),{data:s,error:o}=i;if(o||!s)return{data:{user:null,session:null},error:o};const l=s.session,c=s.user;return s.session&&(await this._saveSession(s.session),await this._notifyAllSubscribers("SIGNED_IN",l)),{data:{user:c,session:l},error:null}}catch(i){if(Lt(i))return{data:{user:null,session:null},error:i};throw i}}async signUp(t){var r,n,a;try{let i;if("email"in t){const{email:u,password:f,options:p}=t;let h=null,g=null;this.flowType==="pkce"&&([h,g]=await $c(this.storage,this.storageKey)),i=await Dt(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,redirectTo:p==null?void 0:p.emailRedirectTo,body:{email:u,password:f,data:(r=p==null?void 0:p.data)!==null&&r!==void 0?r:{},gotrue_meta_security:{captcha_token:p==null?void 0:p.captchaToken},code_challenge:h,code_challenge_method:g},xform:Ls})}else if("phone"in t){const{phone:u,password:f,options:p}=t;i=await Dt(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{phone:u,password:f,data:(n=p==null?void 0:p.data)!==null&&n!==void 0?n:{},channel:(a=p==null?void 0:p.channel)!==null&&a!==void 0?a:"sms",gotrue_meta_security:{captcha_token:p==null?void 0:p.captchaToken}},xform:Ls})}else throw new Hd("You must provide either an email or phone number and a password");const{data:s,error:o}=i;if(o||!s)return{data:{user:null,session:null},error:o};const l=s.session,c=s.user;return s.session&&(await this._saveSession(s.session),await this._notifyAllSubscribers("SIGNED_IN",l)),{data:{user:c,session:l},error:null}}catch(i){if(Lt(i))return{data:{user:null,session:null},error:i};throw i}}async signInWithPassword(t){try{let r;if("email"in t){const{email:i,password:s,options:o}=t;r=await Dt(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{email:i,password:s,gotrue_meta_security:{captcha_token:o==null?void 0:o.captchaToken}},xform:R4})}else if("phone"in t){const{phone:i,password:s,options:o}=t;r=await Dt(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{phone:i,password:s,gotrue_meta_security:{captcha_token:o==null?void 0:o.captchaToken}},xform:R4})}else throw new Hd("You must provide either an email or phone number and a password");const{data:n,error:a}=r;return a?{data:{user:null,session:null},error:a}:!n||!n.session||!n.user?{data:{user:null,session:null},error:new zd}:(n.session&&(await this._saveSession(n.session),await this._notifyAllSubscribers("SIGNED_IN",n.session)),{data:Object.assign({user:n.user,session:n.session},n.weak_password?{weakPassword:n.weak_password}:null),error:a})}catch(r){if(Lt(r))return{data:{user:null,session:null},error:r};throw r}}async signInWithOAuth(t){var r,n,a,i;return await this._handleProviderSignIn(t.provider,{redirectTo:(r=t.options)===null||r===void 0?void 0:r.redirectTo,scopes:(n=t.options)===null||n===void 0?void 0:n.scopes,queryParams:(a=t.options)===null||a===void 0?void 0:a.queryParams,skipBrowserRedirect:(i=t.options)===null||i===void 0?void 0:i.skipBrowserRedirect})}async exchangeCodeForSession(t){return await this.initializePromise,this._acquireLock(-1,async()=>this._exchangeCodeForSession(t))}async signInWithWeb3(t){const{chain:r}=t;if(r==="solana")return await this.signInWithSolana(t);throw new Error(`@supabase/auth-js: Unsupported chain "${r}"`)}async signInWithSolana(t){var r,n,a,i,s,o,l,c,u,f,p,h;let g,m;if("message"in t)g=t.message,m=t.signature;else{const{chain:b,wallet:x,statement:w,options:y}=t;let A;if(Ai())if(typeof x=="object")A=x;else{const D=window;if("solana"in D&&typeof D.solana=="object"&&("signIn"in D.solana&&typeof D.solana.signIn=="function"||"signMessage"in D.solana&&typeof D.solana.signMessage=="function"))A=D.solana;else throw new Error("@supabase/auth-js: No compatible Solana wallet interface on the window object (window.solana) detected. Make sure the user already has a wallet installed and connected for this app. Prefer passing the wallet interface object directly to signInWithWeb3({ chain: 'solana', wallet: resolvedUserWallet }) instead.")}else{if(typeof x!="object"||!(y!=null&&y.url))throw new Error("@supabase/auth-js: Both wallet and url must be specified in non-browser environments.");A=x}const L=new URL((r=y==null?void 0:y.url)!==null&&r!==void 0?r:window.location.href);if("signIn"in A&&A.signIn){const D=await A.signIn(Object.assign(Object.assign(Object.assign({issuedAt:new Date().toISOString()},y==null?void 0:y.signInWithSolana),{version:"1",domain:L.host,uri:L.href}),w?{statement:w}:null));let T;if(Array.isArray(D)&&D[0]&&typeof D[0]=="object")T=D[0];else if(D&&typeof D=="object"&&"signedMessage"in D&&"signature"in D)T=D;else throw new Error("@supabase/auth-js: Wallet method signIn() returned unrecognized value");if("signedMessage"in T&&"signature"in T&&(typeof T.signedMessage=="string"||T.signedMessage instanceof Uint8Array)&&T.signature instanceof Uint8Array)g=typeof T.signedMessage=="string"?T.signedMessage:new TextDecoder().decode(T.signedMessage),m=T.signature;else throw new Error("@supabase/auth-js: Wallet method signIn() API returned object without signedMessage and signature fields")}else{if(!("signMessage"in A)||typeof A.signMessage!="function"||!("publicKey"in A)||typeof A!="object"||!A.publicKey||!("toBase58"in A.publicKey)||typeof A.publicKey.toBase58!="function")throw new Error("@supabase/auth-js: Wallet does not have a compatible signMessage() and publicKey.toBase58() API");g=[`${L.host} wants you to sign in with your Solana account:`,A.publicKey.toBase58(),...w?["",w,""]:[""],"Version: 1",`URI: ${L.href}`,`Issued At: ${(a=(n=y==null?void 0:y.signInWithSolana)===null||n===void 0?void 0:n.issuedAt)!==null&&a!==void 0?a:new Date().toISOString()}`,...!((i=y==null?void 0:y.signInWithSolana)===null||i===void 0)&&i.notBefore?[`Not Before: ${y.signInWithSolana.notBefore}`]:[],...!((s=y==null?void 0:y.signInWithSolana)===null||s===void 0)&&s.expirationTime?[`Expiration Time: ${y.signInWithSolana.expirationTime}`]:[],...!((o=y==null?void 0:y.signInWithSolana)===null||o===void 0)&&o.chainId?[`Chain ID: ${y.signInWithSolana.chainId}`]:[],...!((l=y==null?void 0:y.signInWithSolana)===null||l===void 0)&&l.nonce?[`Nonce: ${y.signInWithSolana.nonce}`]:[],...!((c=y==null?void 0:y.signInWithSolana)===null||c===void 0)&&c.requestId?[`Request ID: ${y.signInWithSolana.requestId}`]:[],...!((f=(u=y==null?void 0:y.signInWithSolana)===null||u===void 0?void 0:u.resources)===null||f===void 0)&&f.length?["Resources",...y.signInWithSolana.resources.map(T=>`- ${T}`)]:[]].join(`
`);const D=await A.signMessage(new TextEncoder().encode(g),"utf8");if(!D||!(D instanceof Uint8Array))throw new Error("@supabase/auth-js: Wallet signMessage() API returned an recognized value");m=D}}try{const{data:b,error:x}=await Dt(this.fetch,"POST",`${this.url}/token?grant_type=web3`,{headers:this.headers,body:Object.assign({chain:"solana",message:g,signature:T7(m)},!((p=t.options)===null||p===void 0)&&p.captchaToken?{gotrue_meta_security:{captcha_token:(h=t.options)===null||h===void 0?void 0:h.captchaToken}}:null),xform:Ls});if(x)throw x;return!b||!b.session||!b.user?{data:{user:null,session:null},error:new zd}:(b.session&&(await this._saveSession(b.session),await this._notifyAllSubscribers("SIGNED_IN",b.session)),{data:Object.assign({},b),error:x})}catch(b){if(Lt(b))return{data:{user:null,session:null},error:b};throw b}}async _exchangeCodeForSession(t){const r=await qd(this.storage,`${this.storageKey}-code-verifier`),[n,a]=(r??"").split("/");try{const{data:i,error:s}=await Dt(this.fetch,"POST",`${this.url}/token?grant_type=pkce`,{headers:this.headers,body:{auth_code:t,code_verifier:n},xform:Ls});if(await Gd(this.storage,`${this.storageKey}-code-verifier`),s)throw s;return!i||!i.session||!i.user?{data:{user:null,session:null,redirectType:null},error:new zd}:(i.session&&(await this._saveSession(i.session),await this._notifyAllSubscribers("SIGNED_IN",i.session)),{data:Object.assign(Object.assign({},i),{redirectType:a??null}),error:s})}catch(i){if(Lt(i))return{data:{user:null,session:null,redirectType:null},error:i};throw i}}async signInWithIdToken(t){try{const{options:r,provider:n,token:a,access_token:i,nonce:s}=t,o=await Dt(this.fetch,"POST",`${this.url}/token?grant_type=id_token`,{headers:this.headers,body:{provider:n,id_token:a,access_token:i,nonce:s,gotrue_meta_security:{captcha_token:r==null?void 0:r.captchaToken}},xform:Ls}),{data:l,error:c}=o;return c?{data:{user:null,session:null},error:c}:!l||!l.session||!l.user?{data:{user:null,session:null},error:new zd}:(l.session&&(await this._saveSession(l.session),await this._notifyAllSubscribers("SIGNED_IN",l.session)),{data:l,error:c})}catch(r){if(Lt(r))return{data:{user:null,session:null},error:r};throw r}}async signInWithOtp(t){var r,n,a,i,s;try{if("email"in t){const{email:o,options:l}=t;let c=null,u=null;this.flowType==="pkce"&&([c,u]=await $c(this.storage,this.storageKey));const{error:f}=await Dt(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{email:o,data:(r=l==null?void 0:l.data)!==null&&r!==void 0?r:{},create_user:(n=l==null?void 0:l.shouldCreateUser)!==null&&n!==void 0?n:!0,gotrue_meta_security:{captcha_token:l==null?void 0:l.captchaToken},code_challenge:c,code_challenge_method:u},redirectTo:l==null?void 0:l.emailRedirectTo});return{data:{user:null,session:null},error:f}}if("phone"in t){const{phone:o,options:l}=t,{data:c,error:u}=await Dt(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{phone:o,data:(a=l==null?void 0:l.data)!==null&&a!==void 0?a:{},create_user:(i=l==null?void 0:l.shouldCreateUser)!==null&&i!==void 0?i:!0,gotrue_meta_security:{captcha_token:l==null?void 0:l.captchaToken},channel:(s=l==null?void 0:l.channel)!==null&&s!==void 0?s:"sms"}});return{data:{user:null,session:null,messageId:c==null?void 0:c.message_id},error:u}}throw new Hd("You must provide either an email or phone number.")}catch(o){if(Lt(o))return{data:{user:null,session:null},error:o};throw o}}async verifyOtp(t){var r,n;try{let a,i;"options"in t&&(a=(r=t.options)===null||r===void 0?void 0:r.redirectTo,i=(n=t.options)===null||n===void 0?void 0:n.captchaToken);const{data:s,error:o}=await Dt(this.fetch,"POST",`${this.url}/verify`,{headers:this.headers,body:Object.assign(Object.assign({},t),{gotrue_meta_security:{captcha_token:i}}),redirectTo:a,xform:Ls});if(o)throw o;if(!s)throw new Error("An error occurred on token verification.");const l=s.session,c=s.user;return l!=null&&l.access_token&&(await this._saveSession(l),await this._notifyAllSubscribers(t.type=="recovery"?"PASSWORD_RECOVERY":"SIGNED_IN",l)),{data:{user:c,session:l},error:null}}catch(a){if(Lt(a))return{data:{user:null,session:null},error:a};throw a}}async signInWithSSO(t){var r,n,a;try{let i=null,s=null;return this.flowType==="pkce"&&([i,s]=await $c(this.storage,this.storageKey)),await Dt(this.fetch,"POST",`${this.url}/sso`,{body:Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},"providerId"in t?{provider_id:t.providerId}:null),"domain"in t?{domain:t.domain}:null),{redirect_to:(n=(r=t.options)===null||r===void 0?void 0:r.redirectTo)!==null&&n!==void 0?n:void 0}),!((a=t==null?void 0:t.options)===null||a===void 0)&&a.captchaToken?{gotrue_meta_security:{captcha_token:t.options.captchaToken}}:null),{skip_http_redirect:!0,code_challenge:i,code_challenge_method:s}),headers:this.headers,xform:G7})}catch(i){if(Lt(i))return{data:null,error:i};throw i}}async reauthenticate(){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._reauthenticate())}async _reauthenticate(){try{return await this._useSession(async t=>{const{data:{session:r},error:n}=t;if(n)throw n;if(!r)throw new So;const{error:a}=await Dt(this.fetch,"GET",`${this.url}/reauthenticate`,{headers:this.headers,jwt:r.access_token});return{data:{user:null,session:null},error:a}})}catch(t){if(Lt(t))return{data:{user:null,session:null},error:t};throw t}}async resend(t){try{const r=`${this.url}/resend`;if("email"in t){const{email:n,type:a,options:i}=t,{error:s}=await Dt(this.fetch,"POST",r,{headers:this.headers,body:{email:n,type:a,gotrue_meta_security:{captcha_token:i==null?void 0:i.captchaToken}},redirectTo:i==null?void 0:i.emailRedirectTo});return{data:{user:null,session:null},error:s}}else if("phone"in t){const{phone:n,type:a,options:i}=t,{data:s,error:o}=await Dt(this.fetch,"POST",r,{headers:this.headers,body:{phone:n,type:a,gotrue_meta_security:{captcha_token:i==null?void 0:i.captchaToken}}});return{data:{user:null,session:null,messageId:s==null?void 0:s.message_id},error:o}}throw new Hd("You must provide either an email or phone number and a type")}catch(r){if(Lt(r))return{data:{user:null,session:null},error:r};throw r}}async getSession(){return await this.initializePromise,await this._acquireLock(-1,async()=>this._useSession(async r=>r))}async _acquireLock(t,r){this._debug("#_acquireLock","begin",t);try{if(this.lockAcquired){const n=this.pendingInLock.length?this.pendingInLock[this.pendingInLock.length-1]:Promise.resolve(),a=(async()=>(await n,await r()))();return this.pendingInLock.push((async()=>{try{await a}catch{}})()),a}return await this.lock(`lock:${this.storageKey}`,t,async()=>{this._debug("#_acquireLock","lock acquired for storage key",this.storageKey);try{this.lockAcquired=!0;const n=r();for(this.pendingInLock.push((async()=>{try{await n}catch{}})()),await n;this.pendingInLock.length;){const a=[...this.pendingInLock];await Promise.all(a),this.pendingInLock.splice(0,a.length)}return await n}finally{this._debug("#_acquireLock","lock released for storage key",this.storageKey),this.lockAcquired=!1}})}finally{this._debug("#_acquireLock","end")}}async _useSession(t){this._debug("#_useSession","begin");try{const r=await this.__loadSession();return await t(r)}finally{this._debug("#_useSession","end")}}async __loadSession(){this._debug("#__loadSession()","begin"),this.lockAcquired||this._debug("#__loadSession()","used outside of an acquired lock!",new Error().stack);try{let t=null;const r=await qd(this.storage,this.storageKey);if(this._debug("#getSession()","session from storage",r),r!==null&&(this._isValidSession(r)?t=r:(this._debug("#getSession()","session from storage is not valid"),await this._removeSession())),!t)return{data:{session:null},error:null};const n=t.expires_at?t.expires_at*1e3-Date.now()<Wg:!1;if(this._debug("#__loadSession()",`session has${n?"":" not"} expired`,"expires_at",t.expires_at),!n){if(this.storage.isServer){let s=this.suppressGetSessionWarning;t=new Proxy(t,{get:(l,c,u)=>(!s&&c==="user"&&(console.warn("Using the user object as returned from supabase.auth.getSession() or from some supabase.auth.onAuthStateChange() events could be insecure! This value comes directly from the storage medium (usually cookies on the server) and may not be authentic. Use supabase.auth.getUser() instead which authenticates the data by contacting the Supabase Auth server."),s=!0,this.suppressGetSessionWarning=!0),Reflect.get(l,c,u))})}return{data:{session:t},error:null}}const{session:a,error:i}=await this._callRefreshToken(t.refresh_token);return i?{data:{session:null},error:i}:{data:{session:a},error:null}}finally{this._debug("#__loadSession()","end")}}async getUser(t){return t?await this._getUser(t):(await this.initializePromise,await this._acquireLock(-1,async()=>await this._getUser()))}async _getUser(t){try{return t?await Dt(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:t,xform:Fo}):await this._useSession(async r=>{var n,a,i;const{data:s,error:o}=r;if(o)throw o;return!(!((n=s.session)===null||n===void 0)&&n.access_token)&&!this.hasCustomAuthorizationHeader?{data:{user:null},error:new So}:await Dt(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:(i=(a=s.session)===null||a===void 0?void 0:a.access_token)!==null&&i!==void 0?i:void 0,xform:Fo})})}catch(r){if(Lt(r))return y7(r)&&(await this._removeSession(),await Gd(this.storage,`${this.storageKey}-code-verifier`)),{data:{user:null},error:r};throw r}}async updateUser(t,r={}){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._updateUser(t,r))}async _updateUser(t,r={}){try{return await this._useSession(async n=>{const{data:a,error:i}=n;if(i)throw i;if(!a.session)throw new So;const s=a.session;let o=null,l=null;this.flowType==="pkce"&&t.email!=null&&([o,l]=await $c(this.storage,this.storageKey));const{data:c,error:u}=await Dt(this.fetch,"PUT",`${this.url}/user`,{headers:this.headers,redirectTo:r==null?void 0:r.emailRedirectTo,body:Object.assign(Object.assign({},t),{code_challenge:o,code_challenge_method:l}),jwt:s.access_token,xform:Fo});if(u)throw u;return s.user=c.user,await this._saveSession(s),await this._notifyAllSubscribers("USER_UPDATED",s),{data:{user:s.user},error:null}})}catch(n){if(Lt(n))return{data:{user:null},error:n};throw n}}async setSession(t){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._setSession(t))}async _setSession(t){try{if(!t.access_token||!t.refresh_token)throw new So;const r=Date.now()/1e3;let n=r,a=!0,i=null;const{payload:s}=Gg(t.access_token);if(s.exp&&(n=s.exp,a=n<=r),a){const{session:o,error:l}=await this._callRefreshToken(t.refresh_token);if(l)return{data:{user:null,session:null},error:l};if(!o)return{data:{user:null,session:null},error:null};i=o}else{const{data:o,error:l}=await this._getUser(t.access_token);if(l)throw l;i={access_token:t.access_token,refresh_token:t.refresh_token,user:o.user,token_type:"bearer",expires_in:n-r,expires_at:n},await this._saveSession(i),await this._notifyAllSubscribers("SIGNED_IN",i)}return{data:{user:i.user,session:i},error:null}}catch(r){if(Lt(r))return{data:{session:null,user:null},error:r};throw r}}async refreshSession(t){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._refreshSession(t))}async _refreshSession(t){try{return await this._useSession(async r=>{var n;if(!t){const{data:s,error:o}=r;if(o)throw o;t=(n=s.session)!==null&&n!==void 0?n:void 0}if(!(t!=null&&t.refresh_token))throw new So;const{session:a,error:i}=await this._callRefreshToken(t.refresh_token);return i?{data:{user:null,session:null},error:i}:a?{data:{user:a.user,session:a},error:null}:{data:{user:null,session:null},error:null}})}catch(r){if(Lt(r))return{data:{user:null,session:null},error:r};throw r}}async _getSessionFromURL(t,r){try{if(!Ai())throw new Wd("No browser detected.");if(t.error||t.error_description||t.error_code)throw new Wd(t.error_description||"Error in URL with unspecified error_description",{error:t.error||"unspecified_error",code:t.error_code||"unspecified_code"});switch(r){case"implicit":if(this.flowType==="pkce")throw new P4("Not a valid PKCE flow url.");break;case"pkce":if(this.flowType==="implicit")throw new Wd("Not a valid implicit grant flow url.");break;default:}if(r==="pkce"){if(this._debug("#_initialize()","begin","is PKCE flow",!0),!t.code)throw new P4("No code detected.");const{data:w,error:y}=await this._exchangeCodeForSession(t.code);if(y)throw y;const A=new URL(window.location.href);return A.searchParams.delete("code"),window.history.replaceState(window.history.state,"",A.toString()),{data:{session:w.session,redirectType:null},error:null}}const{provider_token:n,provider_refresh_token:a,access_token:i,refresh_token:s,expires_in:o,expires_at:l,token_type:c}=t;if(!i||!o||!s||!c)throw new Wd("No session defined in URL");const u=Math.round(Date.now()/1e3),f=parseInt(o);let p=u+f;l&&(p=parseInt(l));const h=p-u;h*1e3<=Kc&&console.warn(`@supabase/gotrue-js: Session as retrieved from URL expires in ${h}s, should have been closer to ${f}s`);const g=p-f;u-g>=120?console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued over 120s ago, URL could be stale",g,p,u):u-g<0&&console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued in the future? Check the device clock for skew",g,p,u);const{data:m,error:b}=await this._getUser(i);if(b)throw b;const x={provider_token:n,provider_refresh_token:a,access_token:i,expires_in:f,expires_at:p,refresh_token:s,token_type:c,user:m.user};return window.location.hash="",this._debug("#_getSessionFromURL()","clearing window.location.hash"),{data:{session:x,redirectType:t.type},error:null}}catch(n){if(Lt(n))return{data:{session:null,redirectType:null},error:n};throw n}}_isImplicitGrantCallback(t){return!!(t.access_token||t.error_description)}async _isPKCECallback(t){const r=await qd(this.storage,`${this.storageKey}-code-verifier`);return!!(t.code&&r)}async signOut(t={scope:"global"}){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._signOut(t))}async _signOut({scope:t}={scope:"global"}){return await this._useSession(async r=>{var n;const{data:a,error:i}=r;if(i)return{error:i};const s=(n=a.session)===null||n===void 0?void 0:n.access_token;if(s){const{error:o}=await this.admin.signOut(s,t);if(o&&!(x7(o)&&(o.status===404||o.status===401||o.status===403)))return{error:o}}return t!=="others"&&(await this._removeSession(),await Gd(this.storage,`${this.storageKey}-code-verifier`)),{error:null}})}onAuthStateChange(t){const r=N7(),n={id:r,callback:t,unsubscribe:()=>{this._debug("#unsubscribe()","state change callback with id removed",r),this.stateChangeEmitters.delete(r)}};return this._debug("#onAuthStateChange()","registered callback with id",r),this.stateChangeEmitters.set(r,n),(async()=>(await this.initializePromise,await this._acquireLock(-1,async()=>{this._emitInitialSession(r)})))(),{data:{subscription:n}}}async _emitInitialSession(t){return await this._useSession(async r=>{var n,a;try{const{data:{session:i},error:s}=r;if(s)throw s;await((n=this.stateChangeEmitters.get(t))===null||n===void 0?void 0:n.callback("INITIAL_SESSION",i)),this._debug("INITIAL_SESSION","callback id",t,"session",i)}catch(i){await((a=this.stateChangeEmitters.get(t))===null||a===void 0?void 0:a.callback("INITIAL_SESSION",null)),this._debug("INITIAL_SESSION","callback id",t,"error",i),console.error(i)}})}async resetPasswordForEmail(t,r={}){let n=null,a=null;this.flowType==="pkce"&&([n,a]=await $c(this.storage,this.storageKey,!0));try{return await Dt(this.fetch,"POST",`${this.url}/recover`,{body:{email:t,code_challenge:n,code_challenge_method:a,gotrue_meta_security:{captcha_token:r.captchaToken}},headers:this.headers,redirectTo:r.redirectTo})}catch(i){if(Lt(i))return{data:null,error:i};throw i}}async getUserIdentities(){var t;try{const{data:r,error:n}=await this.getUser();if(n)throw n;return{data:{identities:(t=r.user.identities)!==null&&t!==void 0?t:[]},error:null}}catch(r){if(Lt(r))return{data:null,error:r};throw r}}async linkIdentity(t){var r;try{const{data:n,error:a}=await this._useSession(async i=>{var s,o,l,c,u;const{data:f,error:p}=i;if(p)throw p;const h=await this._getUrlForProvider(`${this.url}/user/identities/authorize`,t.provider,{redirectTo:(s=t.options)===null||s===void 0?void 0:s.redirectTo,scopes:(o=t.options)===null||o===void 0?void 0:o.scopes,queryParams:(l=t.options)===null||l===void 0?void 0:l.queryParams,skipBrowserRedirect:!0});return await Dt(this.fetch,"GET",h,{headers:this.headers,jwt:(u=(c=f.session)===null||c===void 0?void 0:c.access_token)!==null&&u!==void 0?u:void 0})});if(a)throw a;return Ai()&&!(!((r=t.options)===null||r===void 0)&&r.skipBrowserRedirect)&&window.location.assign(n==null?void 0:n.url),{data:{provider:t.provider,url:n==null?void 0:n.url},error:null}}catch(n){if(Lt(n))return{data:{provider:t.provider,url:null},error:n};throw n}}async unlinkIdentity(t){try{return await this._useSession(async r=>{var n,a;const{data:i,error:s}=r;if(s)throw s;return await Dt(this.fetch,"DELETE",`${this.url}/user/identities/${t.identity_id}`,{headers:this.headers,jwt:(a=(n=i.session)===null||n===void 0?void 0:n.access_token)!==null&&a!==void 0?a:void 0})})}catch(r){if(Lt(r))return{data:null,error:r};throw r}}async _refreshAccessToken(t){const r=`#_refreshAccessToken(${t.substring(0,5)}...)`;this._debug(r,"begin");try{const n=Date.now();return await O7(async a=>(a>0&&await F7(200*Math.pow(2,a-1)),this._debug(r,"refreshing attempt",a),await Dt(this.fetch,"POST",`${this.url}/token?grant_type=refresh_token`,{body:{refresh_token:t},headers:this.headers,xform:Ls})),(a,i)=>{const s=200*Math.pow(2,a);return i&&qg(i)&&Date.now()+s-n<Kc})}catch(n){if(this._debug(r,"error",n),Lt(n))return{data:{session:null,user:null},error:n};throw n}finally{this._debug(r,"end")}}_isValidSession(t){return typeof t=="object"&&t!==null&&"access_token"in t&&"refresh_token"in t&&"expires_at"in t}async _handleProviderSignIn(t,r){const n=await this._getUrlForProvider(`${this.url}/authorize`,t,{redirectTo:r.redirectTo,scopes:r.scopes,queryParams:r.queryParams});return this._debug("#_handleProviderSignIn()","provider",t,"options",r,"url",n),Ai()&&!r.skipBrowserRedirect&&window.location.assign(n),{data:{provider:t,url:n},error:null}}async _recoverAndRefresh(){var t;const r="#_recoverAndRefresh()";this._debug(r,"begin");try{const n=await qd(this.storage,this.storageKey);if(this._debug(r,"session from storage",n),!this._isValidSession(n)){this._debug(r,"session is not valid"),n!==null&&await this._removeSession();return}const a=((t=n.expires_at)!==null&&t!==void 0?t:1/0)*1e3-Date.now()<Wg;if(this._debug(r,`session has${a?"":" not"} expired with margin of ${Wg}s`),a){if(this.autoRefreshToken&&n.refresh_token){const{error:i}=await this._callRefreshToken(n.refresh_token);i&&(console.error(i),qg(i)||(this._debug(r,"refresh failed with a non-retryable error, removing the session",i),await this._removeSession()))}}else await this._notifyAllSubscribers("SIGNED_IN",n)}catch(n){this._debug(r,"error",n),console.error(n);return}finally{this._debug(r,"end")}}async _callRefreshToken(t){var r,n;if(!t)throw new So;if(this.refreshingDeferred)return this.refreshingDeferred.promise;const a=`#_callRefreshToken(${t.substring(0,5)}...)`;this._debug(a,"begin");try{this.refreshingDeferred=new sm;const{data:i,error:s}=await this._refreshAccessToken(t);if(s)throw s;if(!i.session)throw new So;await this._saveSession(i.session),await this._notifyAllSubscribers("TOKEN_REFRESHED",i.session);const o={session:i.session,error:null};return this.refreshingDeferred.resolve(o),o}catch(i){if(this._debug(a,"error",i),Lt(i)){const s={session:null,error:i};return qg(i)||await this._removeSession(),(r=this.refreshingDeferred)===null||r===void 0||r.resolve(s),s}throw(n=this.refreshingDeferred)===null||n===void 0||n.reject(i),i}finally{this.refreshingDeferred=null,this._debug(a,"end")}}async _notifyAllSubscribers(t,r,n=!0){const a=`#_notifyAllSubscribers(${t})`;this._debug(a,"begin",r,`broadcast = ${n}`);try{this.broadcastChannel&&n&&this.broadcastChannel.postMessage({event:t,session:r});const i=[],s=Array.from(this.stateChangeEmitters.values()).map(async o=>{try{await o.callback(t,r)}catch(l){i.push(l)}});if(await Promise.all(s),i.length>0){for(let o=0;o<i.length;o+=1)console.error(i[o]);throw i[0]}}finally{this._debug(a,"end")}}async _saveSession(t){this._debug("#_saveSession()",t),this.suppressGetSessionWarning=!0,await AE(this.storage,this.storageKey,t)}async _removeSession(){this._debug("#_removeSession()"),await Gd(this.storage,this.storageKey),await this._notifyAllSubscribers("SIGNED_OUT",null)}_removeVisibilityChangedCallback(){this._debug("#_removeVisibilityChangedCallback()");const t=this.visibilityChangedCallback;this.visibilityChangedCallback=null;try{t&&Ai()&&(window!=null&&window.removeEventListener)&&window.removeEventListener("visibilitychange",t)}catch(r){console.error("removing visibilitychange callback failed",r)}}async _startAutoRefresh(){await this._stopAutoRefresh(),this._debug("#_startAutoRefresh()");const t=setInterval(()=>this._autoRefreshTokenTick(),Kc);this.autoRefreshTicker=t,t&&typeof t=="object"&&typeof t.unref=="function"?t.unref():typeof Deno<"u"&&typeof Deno.unrefTimer=="function"&&Deno.unrefTimer(t),setTimeout(async()=>{await this.initializePromise,await this._autoRefreshTokenTick()},0)}async _stopAutoRefresh(){this._debug("#_stopAutoRefresh()");const t=this.autoRefreshTicker;this.autoRefreshTicker=null,t&&clearInterval(t)}async startAutoRefresh(){this._removeVisibilityChangedCallback(),await this._startAutoRefresh()}async stopAutoRefresh(){this._removeVisibilityChangedCallback(),await this._stopAutoRefresh()}async _autoRefreshTokenTick(){this._debug("#_autoRefreshTokenTick()","begin");try{await this._acquireLock(0,async()=>{try{const t=Date.now();try{return await this._useSession(async r=>{const{data:{session:n}}=r;if(!n||!n.refresh_token||!n.expires_at){this._debug("#_autoRefreshTokenTick()","no session");return}const a=Math.floor((n.expires_at*1e3-t)/Kc);this._debug("#_autoRefreshTokenTick()",`access token expires in ${a} ticks, a tick lasts ${Kc}ms, refresh threshold is ${Dv} ticks`),a<=Dv&&await this._callRefreshToken(n.refresh_token)})}catch(r){console.error("Auto refresh tick failed with error. This is likely a transient error.",r)}}finally{this._debug("#_autoRefreshTokenTick()","end")}})}catch(t){if(t.isAcquireTimeout||t instanceof TE)this._debug("auto refresh token tick lock not available");else throw t}}async _handleVisibilityChange(){if(this._debug("#_handleVisibilityChange()"),!Ai()||!(window!=null&&window.addEventListener))return this.autoRefreshToken&&this.startAutoRefresh(),!1;try{this.visibilityChangedCallback=async()=>await this._onVisibilityChanged(!1),window==null||window.addEventListener("visibilitychange",this.visibilityChangedCallback),await this._onVisibilityChanged(!0)}catch(t){console.error("_handleVisibilityChange",t)}}async _onVisibilityChanged(t){const r=`#_onVisibilityChanged(${t})`;this._debug(r,"visibilityState",document.visibilityState),document.visibilityState==="visible"?(this.autoRefreshToken&&this._startAutoRefresh(),t||(await this.initializePromise,await this._acquireLock(-1,async()=>{if(document.visibilityState!=="visible"){this._debug(r,"acquired the lock to recover the session, but the browser visibilityState is no longer visible, aborting");return}await this._recoverAndRefresh()}))):document.visibilityState==="hidden"&&this.autoRefreshToken&&this._stopAutoRefresh()}async _getUrlForProvider(t,r,n){const a=[`provider=${encodeURIComponent(r)}`];if(n!=null&&n.redirectTo&&a.push(`redirect_to=${encodeURIComponent(n.redirectTo)}`),n!=null&&n.scopes&&a.push(`scopes=${encodeURIComponent(n.scopes)}`),this.flowType==="pkce"){const[i,s]=await $c(this.storage,this.storageKey),o=new URLSearchParams({code_challenge:`${encodeURIComponent(i)}`,code_challenge_method:`${encodeURIComponent(s)}`});a.push(o.toString())}if(n!=null&&n.queryParams){const i=new URLSearchParams(n.queryParams);a.push(i.toString())}return n!=null&&n.skipBrowserRedirect&&a.push(`skip_http_redirect=${n.skipBrowserRedirect}`),`${t}?${a.join("&")}`}async _unenroll(t){try{return await this._useSession(async r=>{var n;const{data:a,error:i}=r;return i?{data:null,error:i}:await Dt(this.fetch,"DELETE",`${this.url}/factors/${t.factorId}`,{headers:this.headers,jwt:(n=a==null?void 0:a.session)===null||n===void 0?void 0:n.access_token})})}catch(r){if(Lt(r))return{data:null,error:r};throw r}}async _enroll(t){try{return await this._useSession(async r=>{var n,a;const{data:i,error:s}=r;if(s)return{data:null,error:s};const o=Object.assign({friendly_name:t.friendlyName,factor_type:t.factorType},t.factorType==="phone"?{phone:t.phone}:{issuer:t.issuer}),{data:l,error:c}=await Dt(this.fetch,"POST",`${this.url}/factors`,{body:o,headers:this.headers,jwt:(n=i==null?void 0:i.session)===null||n===void 0?void 0:n.access_token});return c?{data:null,error:c}:(t.factorType==="totp"&&(!((a=l==null?void 0:l.totp)===null||a===void 0)&&a.qr_code)&&(l.totp.qr_code=`data:image/svg+xml;utf-8,${l.totp.qr_code}`),{data:l,error:null})})}catch(r){if(Lt(r))return{data:null,error:r};throw r}}async _verify(t){return this._acquireLock(-1,async()=>{try{return await this._useSession(async r=>{var n;const{data:a,error:i}=r;if(i)return{data:null,error:i};const{data:s,error:o}=await Dt(this.fetch,"POST",`${this.url}/factors/${t.factorId}/verify`,{body:{code:t.code,challenge_id:t.challengeId},headers:this.headers,jwt:(n=a==null?void 0:a.session)===null||n===void 0?void 0:n.access_token});return o?{data:null,error:o}:(await this._saveSession(Object.assign({expires_at:Math.round(Date.now()/1e3)+s.expires_in},s)),await this._notifyAllSubscribers("MFA_CHALLENGE_VERIFIED",s),{data:s,error:o})})}catch(r){if(Lt(r))return{data:null,error:r};throw r}})}async _challenge(t){return this._acquireLock(-1,async()=>{try{return await this._useSession(async r=>{var n;const{data:a,error:i}=r;return i?{data:null,error:i}:await Dt(this.fetch,"POST",`${this.url}/factors/${t.factorId}/challenge`,{body:{channel:t.channel},headers:this.headers,jwt:(n=a==null?void 0:a.session)===null||n===void 0?void 0:n.access_token})})}catch(r){if(Lt(r))return{data:null,error:r};throw r}})}async _challengeAndVerify(t){const{data:r,error:n}=await this._challenge({factorId:t.factorId});return n?{data:null,error:n}:await this._verify({factorId:t.factorId,challengeId:r.id,code:t.code})}async _listFactors(){const{data:{user:t},error:r}=await this.getUser();if(r)return{data:null,error:r};const n=(t==null?void 0:t.factors)||[],a=n.filter(s=>s.factor_type==="totp"&&s.status==="verified"),i=n.filter(s=>s.factor_type==="phone"&&s.status==="verified");return{data:{all:n,totp:a,phone:i},error:null}}async _getAuthenticatorAssuranceLevel(){return this._acquireLock(-1,async()=>await this._useSession(async t=>{var r,n;const{data:{session:a},error:i}=t;if(i)return{data:null,error:i};if(!a)return{data:{currentLevel:null,nextLevel:null,currentAuthenticationMethods:[]},error:null};const{payload:s}=Gg(a.access_token);let o=null;s.aal&&(o=s.aal);let l=o;((n=(r=a.user.factors)===null||r===void 0?void 0:r.filter(f=>f.status==="verified"))!==null&&n!==void 0?n:[]).length>0&&(l="aal2");const u=s.amr||[];return{data:{currentLevel:o,nextLevel:l,currentAuthenticationMethods:u},error:null}}))}async fetchJwk(t,r={keys:[]}){let n=r.keys.find(s=>s.kid===t);if(n||(n=this.jwks.keys.find(s=>s.kid===t),n&&this.jwks_cached_at+g7>Date.now()))return n;const{data:a,error:i}=await Dt(this.fetch,"GET",`${this.url}/.well-known/jwks.json`,{headers:this.headers});if(i)throw i;if(!a.keys||a.keys.length===0)throw new p0("JWKS is empty");if(this.jwks=a,this.jwks_cached_at=Date.now(),n=a.keys.find(s=>s.kid===t),!n)throw new p0("No matching signing key found in JWKS");return n}async getClaims(t,r={keys:[]}){try{let n=t;if(!n){const{data:h,error:g}=await this.getSession();if(g||!h.session)return{data:null,error:g};n=h.session.access_token}const{header:a,payload:i,signature:s,raw:{header:o,payload:l}}=Gg(n);if(U7(i.exp),!a.kid||a.alg==="HS256"||!("crypto"in globalThis&&"subtle"in globalThis.crypto)){const{error:h}=await this.getUser(n);if(h)throw h;return{data:{claims:i,header:a,signature:s},error:null}}const c=V7(a.alg),u=await this.fetchJwk(a.kid,r),f=await crypto.subtle.importKey("jwk",u,c,!0,["verify"]);if(!await crypto.subtle.verify(c,f,s,A7(`${o}.${l}`)))throw new p0("Invalid JWT signature");return{data:{claims:i,header:a,signature:s},error:null}}catch(n){if(Lt(n))return{data:null,error:n};throw n}}}Y0.nextInstanceID=0;const aO=Y0;class iO extends aO{constructor(t){super(t)}}var sO=function(e,t,r,n){function a(i){return i instanceof r?i:new r(function(s){s(i)})}return new(r||(r=Promise))(function(i,s){function o(u){try{c(n.next(u))}catch(f){s(f)}}function l(u){try{c(n.throw(u))}catch(f){s(f)}}function c(u){u.done?i(u.value):a(u.value).then(o,l)}c((n=n.apply(e,t||[])).next())})};class oO{constructor(t,r,n){var a,i,s;if(this.supabaseUrl=t,this.supabaseKey=r,!t)throw new Error("supabaseUrl is required.");if(!r)throw new Error("supabaseKey is required.");const o=u7(t),l=new URL(o);this.realtimeUrl=new URL("realtime/v1",l),this.realtimeUrl.protocol=this.realtimeUrl.protocol.replace("http","ws"),this.authUrl=new URL("auth/v1",l),this.storageUrl=new URL("storage/v1",l),this.functionsUrl=new URL("functions/v1",l);const c=`sb-${l.hostname.split(".")[0]}-auth-token`,u={db:r7,realtime:a7,auth:Object.assign(Object.assign({},n7),{storageKey:c}),global:t7},f=f7(n??{},u);this.storageKey=(a=f.auth.storageKey)!==null&&a!==void 0?a:"",this.headers=(i=f.global.headers)!==null&&i!==void 0?i:{},f.accessToken?(this.accessToken=f.accessToken,this.auth=new Proxy({},{get:(p,h)=>{throw new Error(`@supabase/supabase-js: Supabase Client is configured with the accessToken option, accessing supabase.auth.${String(h)} is not possible`)}})):this.auth=this._initSupabaseAuthClient((s=f.auth)!==null&&s!==void 0?s:{},this.headers,f.global.fetch),this.fetch=l7(r,this._getAccessToken.bind(this),f.global.fetch),this.realtime=this._initRealtimeClient(Object.assign({headers:this.headers,accessToken:this._getAccessToken.bind(this)},f.realtime)),this.rest=new kF(new URL("rest/v1",l).href,{headers:this.headers,schema:f.db.schema,fetch:this.fetch}),f.accessToken||this._listenForAuthEvents()}get functions(){return new eF(this.functionsUrl.href,{headers:this.headers,customFetch:this.fetch})}get storage(){return new QF(this.storageUrl.href,this.headers,this.fetch)}from(t){return this.rest.from(t)}schema(t){return this.rest.schema(t)}rpc(t,r={},n={}){return this.rest.rpc(t,r,n)}channel(t,r={config:{}}){return this.realtime.channel(t,r)}getChannels(){return this.realtime.getChannels()}removeChannel(t){return this.realtime.removeChannel(t)}removeAllChannels(){return this.realtime.removeAllChannels()}_getAccessToken(){var t,r;return sO(this,void 0,void 0,function*(){if(this.accessToken)return yield this.accessToken();const{data:n}=yield this.auth.getSession();return(r=(t=n.session)===null||t===void 0?void 0:t.access_token)!==null&&r!==void 0?r:null})}_initSupabaseAuthClient({autoRefreshToken:t,persistSession:r,detectSessionInUrl:n,storage:a,storageKey:i,flowType:s,lock:o,debug:l},c,u){const f={Authorization:`Bearer ${this.supabaseKey}`,apikey:`${this.supabaseKey}`};return new iO({url:this.authUrl.href,headers:Object.assign(Object.assign({},f),c),storageKey:i,autoRefreshToken:t,persistSession:r,detectSessionInUrl:n,storage:a,flowType:s,lock:o,debug:l,fetch:u,hasCustomAuthorizationHeader:"Authorization"in this.headers})}_initRealtimeClient(t){return new BF(this.realtimeUrl.href,Object.assign(Object.assign({},t),{params:Object.assign({apikey:this.supabaseKey},t==null?void 0:t.params)}))}_listenForAuthEvents(){return this.auth.onAuthStateChange((r,n)=>{this._handleTokenChanged(r,"CLIENT",n==null?void 0:n.access_token)})}_handleTokenChanged(t,r,n){(t==="TOKEN_REFRESHED"||t==="SIGNED_IN")&&this.changedAccessToken!==n?this.changedAccessToken=n:t==="SIGNED_OUT"&&(this.realtime.setAuth(),r=="STORAGE"&&this.auth.signOut(),this.changedAccessToken=void 0)}}const lO=(e,t,r)=>new oO(e,t,r),cO="https://sstfgrbvltvxcmutgsmb.supabase.co",uO="eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InNzdGZncmJ2bHR2eGNtdXRnc21iIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTE1NzkzNDYsImV4cCI6MjA2NzE1NTM0Nn0.dYYclh7BHivtmhss8ioGYE4n2kdAEH_Isq4sNXlY670",vr=lO(cO,uO),Ny=ie.createContext(void 0);function fO({children:e}){const[t,r]=ie.useState(null),[n,a]=ie.useState(!0);ie.useEffect(()=>{const o=localStorage.getItem("currentUser");if(localStorage.getItem("isLoggedIn")==="true"&&o){const c=JSON.parse(o);r(c)}a(!1)},[]);const i=async(o,l)=>{try{a(!0);const{data:c,error:u}=await vr.from("usuarios").select("count",{count:"exact",head:!0});if(u)return console.error("Error de conexin a Supabase:",u),ft.error("Error de conexin a la base de datos"),!1;const{data:f,error:p}=await vr.from("usuarios").select("id, username, role, full_name, email, active, password_hash").eq("username",o).eq("active",!0).single();if(p||!f)return console.error("Usuario no encontrado:",p),ft.error("Usuario o contrasea incorrectos"),!1;const{data:h,error:g}=await vr.rpc("verify_password",{password:l,hash:f.password_hash});if(g||!h)return console.error("Error verificando contrasea:",g),ft.error("Usuario o contrasea incorrectos"),!1;await vr.from("usuarios").update({last_login:new Date().toISOString()}).eq("id",f.id);const m={id:f.id,username:f.username,role:f.role,full_name:f.full_name,email:f.email};return r(m),localStorage.setItem("isLoggedIn","true"),localStorage.setItem("currentUser",JSON.stringify(m)),ft.success(`Bienvenido, ${f.full_name||f.username}`),!0}catch(c){return console.error("Error durante el login:",c),ft.error("Error durante el inicio de sesin"),!1}finally{a(!1)}},s=()=>{r(null),localStorage.removeItem("isLoggedIn"),localStorage.removeItem("currentUser"),ft.success("Sesin cerrada correctamente")};return _.jsx(Ny.Provider,{value:{user:t,isAuthenticated:!!t,isLoading:n,login:i,logout:s},children:e})}const hO=()=>{const e=ie.useContext(Ny);if(e===void 0)throw new Error("useAuth must be used within an AuthProvider");return e},CE=async()=>{const e=[];let t=!1,r=!1;try{console.log(" Verificando conexin a Supabase...");const{data:n,error:a}=await vr.from("usuarios").select("count",{count:"exact",head:!0});if(a)return console.error(" Error de conexin:",a.message),e.push(`Connection error: ${a.message}`),{connected:t,tablesExist:r,errors:e};t=!0,console.log(" Conexin a Supabase exitosa");const i=[{name:"usuarios",columns:["id","username","password_hash","role","active"]},{name:"articulos",columns:["id","nombre","costo","activo"]},{name:"movimientos",columns:["id","id_articulo","tipo","cantidad","fecha","descripcion","costo_unitario"]}];let s=!0;for(const o of i)try{const{data:l,error:c}=await vr.from(o.name).select(o.columns.join(", ")).limit(1);c?(console.error(` Error en tabla ${o.name}:`,c.message),e.push(`${o.name} table error: ${c.message}`),s=!1):console.log(` Tabla ${o.name} verificada correctamente`)}catch(l){console.error(` Error verificando tabla ${o.name}:`,l),e.push(`${o.name} verification error: ${l instanceof Error?l.message:"Unknown error"}`),s=!1}r=s,console.log(r?" Todas las tablas verificadas correctamente":" Algunas tablas no existen o tienen errores")}catch(n){console.error(" Error inesperado:",n),e.push(`Unexpected error: ${n instanceof Error?n.message:"Unknown error"}`)}return{connected:t,tablesExist:r,errors:e}},dO=async()=>{try{console.log(" Obteniendo estadsticas de la base de datos...");const[e,t,r]=await Promise.all([vr.from("usuarios").select("*",{count:"exact",head:!0}),vr.from("articulos").select("*",{count:"exact",head:!0}),vr.from("movimientos").select("*",{count:"exact",head:!0})]),n={usuarios:e.count||0,articulos:t.count||0,movimientos:r.count||0};return console.log(" Estadsticas obtenidas:",n),n}catch(e){return console.error("Error getting database stats:",e),{usuarios:0,articulos:0,movimientos:0}}},pO=async()=>{const e=[];try{console.log(" Validando integridad de datos...");const{data:t,error:r}=await vr.from("movimientos").select(`
        id,
        id_articulo,
        articulos!inner(id, nombre)
      `);r&&e.push(`Error checking orphaned movements: ${r.message}`);const{data:n}=await vr.from("articulos").select("id, nombre").eq("activo",!0);if(n)for(const s of n){const{data:o}=await vr.from("movimientos").select("tipo, cantidad").eq("id_articulo",s.id);if(o){let l=0;o.forEach(c=>{c.tipo==="Entrada"?l+=c.cantidad:l-=c.cantidad}),l<0&&e.push(`Article "${s.nombre}" has negative stock: ${l}`)}}const{data:a,error:i}=await vr.from("usuarios").select("id, username, role").eq("active",!0);if(i)e.push(`Error checking users: ${i.message}`);else if(a){const s=["admin","user","viewer"],o=a.filter(l=>!s.includes(l.role));o.length>0&&e.push(`Found ${o.length} users with invalid roles`)}console.log(e.length===0?" Integridad de datos validada correctamente":` Encontrados ${e.length} problemas de integridad`)}catch(t){e.push(`Validation error: ${t instanceof Error?t.message:"Unknown error"}`)}return{valid:e.length===0,issues:e}},NE=ie.createContext(void 0);function mO({children:e}){const[t,r]=ie.useState([]),[n,a]=ie.useState([]),[i,s]=ie.useState(!0),[o,l]=ie.useState(!1),{user:c}=hO(),u=async()=>{try{const{data:L,error:D}=await vr.from("articulos").select("id, nombre, costo, descripcion, categoria, activo").eq("activo",!0).order("nombre",{ascending:!0});if(D)throw D;const T=(L||[]).map(F=>({id:F.id,nombre:F.nombre,costo:parseFloat(F.costo||"0")}));r(T),console.log(" Artculos cargados desde Supabase:",T.length)}catch(L){throw console.error("Error loading articles:",L),ft.error("Error al cargar artculos desde la base de datos"),L}},f=async()=>{try{const{data:L,error:D}=await vr.from("movimientos").select(`
          id, 
          id_articulo, 
          tipo, 
          cantidad, 
          fecha, 
          descripcion, 
          costo_unitario,
          created_at
        `).order("fecha",{ascending:!1}).order("created_at",{ascending:!1});if(D)throw D;const T=(L||[]).map(F=>({id:F.id,id_articulo:F.id_articulo,tipo:F.tipo,cantidad:F.cantidad,fecha:F.fecha,descripcion:F.descripcion||"",costo:parseFloat(F.costo_unitario||"0")}));a(T),console.log(" Movimientos cargados desde Supabase:",T.length)}catch(L){throw console.error("Error loading movements:",L),ft.error("Error al cargar movimientos desde la base de datos"),L}},p=async()=>{s(!0);try{const L=await CE();if(!L.connected){console.error("Database not connected:",L.errors),ft.error("No se pudo conectar a la base de datos"),s(!1);return}if(!L.tablesExist){console.warn("Database tables do not exist:",L.errors),ft.error("Las tablas de la base de datos no existen. Por favor, ejecuta las migraciones SQL."),s(!1);return}l(!0),await Promise.all([u(),f()])}catch(L){console.error("Error refreshing data:",L),ft.error("Error al actualizar datos")}finally{s(!1)}};ie.useEffect(()=>{p()},[]);const h=async L=>{try{if(!o)throw new Error("Base de datos no disponible");const{data:D,error:T}=await vr.from("articulos").insert({nombre:L.nombre.toUpperCase(),costo:L.costo,categoria:"GENERAL",unidad_medida:"UNIDAD",activo:!0}).select().single();if(T)throw T;const F={id:D.id,nombre:D.nombre,costo:parseFloat(D.costo)};r(R=>[...R,F]),ft.success("Artculo agregado correctamente")}catch(D){throw console.error("Error adding article:",D),ft.error("Error al agregar artculo"),D}},g=async(L,D)=>{try{if(!o)throw new Error("Base de datos no disponible");const T={};D.nombre&&(T.nombre=D.nombre.toUpperCase()),D.costo!==void 0&&(T.costo=D.costo);const{data:F,error:R}=await vr.from("articulos").update(T).eq("id",L).select().single();if(R)throw R;const X={id:F.id,nombre:F.nombre,costo:parseFloat(F.costo)};r(N=>N.map(P=>P.id===L?X:P)),ft.success("Artculo actualizado correctamente")}catch(T){throw console.error("Error updating article:",T),ft.error("Error al actualizar artculo"),T}},m=async L=>{try{if(!o)throw new Error("Base de datos no disponible");const{data:D,error:T}=await vr.from("movimientos").select("id").eq("id_articulo",L).limit(1);if(T)throw T;if(D&&D.length>0){ft.error("No se puede eliminar un artculo que tiene movimientos registrados");return}const{error:F}=await vr.from("articulos").delete().eq("id",L);if(F)throw F;r(R=>R.filter(X=>X.id!==L)),ft.success("Artculo eliminado correctamente")}catch(D){throw console.error("Error deleting article:",D),ft.error("Error al eliminar artculo"),D}},b=async L=>{try{if(!o)throw new Error("Base de datos no disponible");const{data:D,error:T}=await vr.from("movimientos").insert({id_articulo:L.id_articulo,id_usuario:(c==null?void 0:c.id)||null,tipo:L.tipo,cantidad:L.cantidad,fecha:L.fecha,descripcion:L.descripcion.toUpperCase(),costo_unitario:L.costo}).select().single();if(T)throw T;const F={id:D.id,id_articulo:D.id_articulo,tipo:D.tipo,cantidad:D.cantidad,fecha:D.fecha,descripcion:D.descripcion,costo:parseFloat(D.costo_unitario)};a(R=>[F,...R]),ft.success("Movimiento registrado correctamente")}catch(D){throw console.error("Error adding movement:",D),D instanceof Error&&D.message.includes("Stock insuficiente")?ft.error(D.message):ft.error("Error al registrar movimiento"),D}},x=async(L,D)=>{try{if(!o)throw new Error("Base de datos no disponible");const T={};D.cantidad!==void 0&&(T.cantidad=D.cantidad),D.fecha&&(T.fecha=D.fecha),D.descripcion&&(T.descripcion=D.descripcion.toUpperCase()),D.costo!==void 0&&(T.costo_unitario=D.costo);const{data:F,error:R}=await vr.from("movimientos").update(T).eq("id",L).select().single();if(R)throw R;const X={id:F.id,id_articulo:F.id_articulo,tipo:F.tipo,cantidad:F.cantidad,fecha:F.fecha,descripcion:F.descripcion,costo:parseFloat(F.costo_unitario)};a(N=>N.map(P=>P.id===L?X:P)),ft.success("Movimiento actualizado correctamente")}catch(T){throw console.error("Error updating movement:",T),ft.error("Error al actualizar movimiento"),T}},w=async L=>{try{if(!o)throw new Error("Base de datos no disponible");const{error:D}=await vr.from("movimientos").delete().eq("id",L);if(D)throw D;a(T=>T.filter(F=>F.id!==L)),ft.success("Movimiento eliminado correctamente")}catch(D){throw console.error("Error deleting movement:",D),ft.error("Error al eliminar movimiento"),D}},y=L=>n.filter(T=>T.id_articulo===L).reduce((T,F)=>F.tipo==="Entrada"?T+F.cantidad:T-F.cantidad,0),A=async()=>{const L=n.filter(D=>D.costo===0);for(const D of L){const T=t.find(F=>F.id===D.id_articulo);T&&T.costo>0&&await x(D.id,{costo:T.costo})}ft.success("Movimientos actualizados con el costo unitario del artculo"),await p()};return _.jsx(NE.Provider,{value:{articles:t,movements:n,loading:i,refreshData:p,addArticle:h,updateArticle:g,deleteArticle:m,addMovement:b,updateMovement:x,deleteMovement:w,getStock:y,actualizarCostosMovimientos:A},children:e})}const ds=()=>{const e=ie.useContext(NE);if(e===void 0)throw new Error("useData must be used within a DataProvider");return e},PE=ie.createContext({transformPagePoint:e=>e,isStatic:!1,reducedMotion:"never"}),om=ie.createContext({}),lm=ie.createContext(null),cm=typeof document<"u",Py=cm?ie.useLayoutEffect:ie.useEffect,LE=ie.createContext({strict:!1}),Ly=e=>e.replace(/([a-z])([A-Z])/g,"$1-$2").toLowerCase(),gO="framerAppearId",FE="data-"+Ly(gO);function vO(e,t,r,n){const{visualElement:a}=ie.useContext(om),i=ie.useContext(LE),s=ie.useContext(lm),o=ie.useContext(PE).reducedMotion,l=ie.useRef();n=n||i.renderer,!l.current&&n&&(l.current=n(e,{visualState:t,parent:a,props:r,presenceContext:s,blockInitialAnimation:s?s.initial===!1:!1,reducedMotionConfig:o}));const c=l.current;ie.useInsertionEffect(()=>{c&&c.update(r,s)});const u=ie.useRef(!!(r[FE]&&!window.HandoffComplete));return Py(()=>{c&&(c.render(),u.current&&c.animationState&&c.animationState.animateChanges())}),ie.useEffect(()=>{c&&(c.updateFeatures(),!u.current&&c.animationState&&c.animationState.animateChanges(),u.current&&(u.current=!1,window.HandoffComplete=!0))}),c}function uu(e){return e&&typeof e=="object"&&Object.prototype.hasOwnProperty.call(e,"current")}function xO(e,t,r){return ie.useCallback(n=>{n&&e.mount&&e.mount(n),t&&(n?t.mount(n):t.unmount()),r&&(typeof r=="function"?r(n):uu(r)&&(r.current=n))},[t])}function J0(e){return typeof e=="string"||Array.isArray(e)}function um(e){return e!==null&&typeof e=="object"&&typeof e.start=="function"}const Fy=["animate","whileInView","whileFocus","whileHover","whileTap","whileDrag","exit"],Oy=["initial",...Fy];function fm(e){return um(e.animate)||Oy.some(t=>J0(e[t]))}function OE(e){return!!(fm(e)||e.variants)}function yO(e,t){if(fm(e)){const{initial:r,animate:n}=e;return{initial:r===!1||J0(r)?r:void 0,animate:J0(n)?n:void 0}}return e.inherit!==!1?t:{}}function wO(e){const{initial:t,animate:r}=yO(e,ie.useContext(om));return ie.useMemo(()=>({initial:t,animate:r}),[B4(t),B4(r)])}function B4(e){return Array.isArray(e)?e.join(" "):e}const U4={animation:["animate","variants","whileHover","whileTap","exit","whileInView","whileFocus","whileDrag"],exit:["exit"],drag:["drag","dragControls"],focus:["whileFocus"],hover:["whileHover","onHoverStart","onHoverEnd"],tap:["whileTap","onTap","onTapStart","onTapCancel"],pan:["onPan","onPanStart","onPanSessionStart","onPanEnd"],inView:["whileInView","onViewportEnter","onViewportLeave"],layout:["layout","layoutId"]},Q0={};for(const e in U4)Q0[e]={isEnabled:t=>U4[e].some(r=>!!t[r])};function bO(e){for(const t in e)Q0[t]={...Q0[t],...e[t]}}const Dy=ie.createContext({}),DE=ie.createContext({}),_O=Symbol.for("motionComponentSymbol");function SO({preloadedFeatures:e,createVisualElement:t,useRender:r,useVisualState:n,Component:a}){e&&bO(e);function i(o,l){let c;const u={...ie.useContext(PE),...o,layoutId:kO(o)},{isStatic:f}=u,p=wO(o),h=n(o,f);if(!f&&cm){p.visualElement=vO(a,h,u,t);const g=ie.useContext(DE),m=ie.useContext(LE).strict;p.visualElement&&(c=p.visualElement.loadFeatures(u,m,e,g))}return ie.createElement(om.Provider,{value:p},c&&p.visualElement?ie.createElement(c,{visualElement:p.visualElement,...u}):null,r(a,o,xO(h,p.visualElement,l),h,f,p.visualElement))}const s=ie.forwardRef(i);return s[_O]=a,s}function kO({layoutId:e}){const t=ie.useContext(Dy).id;return t&&e!==void 0?t+"-"+e:e}function EO(e){function t(n,a={}){return SO(e(n,a))}if(typeof Proxy>"u")return t;const r=new Map;return new Proxy(t,{get:(n,a)=>(r.has(a)||r.set(a,t(a)),r.get(a))})}const AO=["animate","circle","defs","desc","ellipse","g","image","line","filter","marker","mask","metadata","path","pattern","polygon","polyline","rect","stop","switch","symbol","svg","text","tspan","use","view"];function Iy(e){return typeof e!="string"||e.includes("-")?!1:!!(AO.indexOf(e)>-1||/[A-Z]/.test(e))}const c1={};function TO(e){Object.assign(c1,e)}const bh=["transformPerspective","x","y","z","translateX","translateY","translateZ","scale","scaleX","scaleY","rotate","rotateX","rotateY","rotateZ","skew","skewX","skewY"],lc=new Set(bh);function IE(e,{layout:t,layoutId:r}){return lc.has(e)||e.startsWith("origin")||(t||r!==void 0)&&(!!c1[e]||e==="opacity")}const _a=e=>!!(e&&e.getVelocity),CO={x:"translateX",y:"translateY",z:"translateZ",transformPerspective:"perspective"},NO=bh.length;function PO(e,{enableHardwareAcceleration:t=!0,allowTransformNone:r=!0},n,a){let i="";for(let s=0;s<NO;s++){const o=bh[s];if(e[o]!==void 0){const l=CO[o]||o;i+=`${l}(${e[o]}) `}}return t&&!e.z&&(i+="translateZ(0)"),i=i.trim(),a?i=a(e,n?"":i):r&&n&&(i="none"),i}const RE=e=>t=>typeof t=="string"&&t.startsWith(e),jE=RE("--"),jv=RE("var(--"),LO=/var\s*\(\s*--[\w-]+(\s*,\s*(?:(?:[^)(]|\((?:[^)(]+|\([^)(]*\))*\))*)+)?\s*\)/g,FO=(e,t)=>t&&typeof e=="number"?t.transform(e):e,el=(e,t,r)=>Math.min(Math.max(r,e),t),cc={test:e=>typeof e=="number",parse:parseFloat,transform:e=>e},g0={...cc,transform:e=>el(0,1,e)},Kd={...cc,default:1},v0=e=>Math.round(e*1e5)/1e5,hm=/(-)?([\d]*\.?[\d])+/g,ME=/(#[0-9a-f]{3,8}|(rgb|hsl)a?\((-?[\d\.]+%?[,\s]+){2}(-?[\d\.]+%?)\s*[\,\/]?\s*[\d\.]*%?\))/gi,OO=/^(#[0-9a-f]{3,8}|(rgb|hsl)a?\((-?[\d\.]+%?[,\s]+){2}(-?[\d\.]+%?)\s*[\,\/]?\s*[\d\.]*%?\))$/i;function _h(e){return typeof e=="string"}const Sh=e=>({test:t=>_h(t)&&t.endsWith(e)&&t.split(" ").length===1,parse:parseFloat,transform:t=>`${t}${e}`}),ko=Sh("deg"),cs=Sh("%"),gt=Sh("px"),DO=Sh("vh"),IO=Sh("vw"),V4={...cs,parse:e=>cs.parse(e)/100,transform:e=>cs.transform(e*100)},$4={...cc,transform:Math.round},BE={borderWidth:gt,borderTopWidth:gt,borderRightWidth:gt,borderBottomWidth:gt,borderLeftWidth:gt,borderRadius:gt,radius:gt,borderTopLeftRadius:gt,borderTopRightRadius:gt,borderBottomRightRadius:gt,borderBottomLeftRadius:gt,width:gt,maxWidth:gt,height:gt,maxHeight:gt,size:gt,top:gt,right:gt,bottom:gt,left:gt,padding:gt,paddingTop:gt,paddingRight:gt,paddingBottom:gt,paddingLeft:gt,margin:gt,marginTop:gt,marginRight:gt,marginBottom:gt,marginLeft:gt,rotate:ko,rotateX:ko,rotateY:ko,rotateZ:ko,scale:Kd,scaleX:Kd,scaleY:Kd,scaleZ:Kd,skew:ko,skewX:ko,skewY:ko,distance:gt,translateX:gt,translateY:gt,translateZ:gt,x:gt,y:gt,z:gt,perspective:gt,transformPerspective:gt,opacity:g0,originX:V4,originY:V4,originZ:gt,zIndex:$4,fillOpacity:g0,strokeOpacity:g0,numOctaves:$4};function Ry(e,t,r,n){const{style:a,vars:i,transform:s,transformOrigin:o}=e;let l=!1,c=!1,u=!0;for(const f in t){const p=t[f];if(jE(f)){i[f]=p;continue}const h=BE[f],g=FO(p,h);if(lc.has(f)){if(l=!0,s[f]=g,!u)continue;p!==(h.default||0)&&(u=!1)}else f.startsWith("origin")?(c=!0,o[f]=g):a[f]=g}if(t.transform||(l||n?a.transform=PO(e.transform,r,u,n):a.transform&&(a.transform="none")),c){const{originX:f="50%",originY:p="50%",originZ:h=0}=o;a.transformOrigin=`${f} ${p} ${h}`}}const jy=()=>({style:{},transform:{},transformOrigin:{},vars:{}});function UE(e,t,r){for(const n in t)!_a(t[n])&&!IE(n,r)&&(e[n]=t[n])}function RO({transformTemplate:e},t,r){return ie.useMemo(()=>{const n=jy();return Ry(n,t,{enableHardwareAcceleration:!r},e),Object.assign({},n.vars,n.style)},[t])}function jO(e,t,r){const n=e.style||{},a={};return UE(a,n,e),Object.assign(a,RO(e,t,r)),e.transformValues?e.transformValues(a):a}function MO(e,t,r){const n={},a=jO(e,t,r);return e.drag&&e.dragListener!==!1&&(n.draggable=!1,a.userSelect=a.WebkitUserSelect=a.WebkitTouchCallout="none",a.touchAction=e.drag===!0?"none":`pan-${e.drag==="x"?"y":"x"}`),e.tabIndex===void 0&&(e.onTap||e.onTapStart||e.whileTap)&&(n.tabIndex=0),n.style=a,n}const BO=new Set(["animate","exit","variants","initial","style","values","variants","transition","transformTemplate","transformValues","custom","inherit","onBeforeLayoutMeasure","onAnimationStart","onAnimationComplete","onUpdate","onDragStart","onDrag","onDragEnd","onMeasureDragConstraints","onDirectionLock","onDragTransitionEnd","_dragX","_dragY","onHoverStart","onHoverEnd","onViewportEnter","onViewportLeave","globalTapTarget","ignoreStrict","viewport"]);function u1(e){return e.startsWith("while")||e.startsWith("drag")&&e!=="draggable"||e.startsWith("layout")||e.startsWith("onTap")||e.startsWith("onPan")||e.startsWith("onLayout")||BO.has(e)}let VE=e=>!u1(e);function UO(e){e&&(VE=t=>t.startsWith("on")?!u1(t):e(t))}try{UO(require("@emotion/is-prop-valid").default)}catch{}function VO(e,t,r){const n={};for(const a in e)a==="values"&&typeof e.values=="object"||(VE(a)||r===!0&&u1(a)||!t&&!u1(a)||e.draggable&&a.startsWith("onDrag"))&&(n[a]=e[a]);return n}function z4(e,t,r){return typeof e=="string"?e:gt.transform(t+r*e)}function $O(e,t,r){const n=z4(t,e.x,e.width),a=z4(r,e.y,e.height);return`${n} ${a}`}const zO={offset:"stroke-dashoffset",array:"stroke-dasharray"},HO={offset:"strokeDashoffset",array:"strokeDasharray"};function WO(e,t,r=1,n=0,a=!0){e.pathLength=1;const i=a?zO:HO;e[i.offset]=gt.transform(-n);const s=gt.transform(t),o=gt.transform(r);e[i.array]=`${s} ${o}`}function My(e,{attrX:t,attrY:r,attrScale:n,originX:a,originY:i,pathLength:s,pathSpacing:o=1,pathOffset:l=0,...c},u,f,p){if(Ry(e,c,u,p),f){e.style.viewBox&&(e.attrs.viewBox=e.style.viewBox);return}e.attrs=e.style,e.style={};const{attrs:h,style:g,dimensions:m}=e;h.transform&&(m&&(g.transform=h.transform),delete h.transform),m&&(a!==void 0||i!==void 0||g.transform)&&(g.transformOrigin=$O(m,a!==void 0?a:.5,i!==void 0?i:.5)),t!==void 0&&(h.x=t),r!==void 0&&(h.y=r),n!==void 0&&(h.scale=n),s!==void 0&&WO(h,s,o,l,!1)}const $E=()=>({...jy(),attrs:{}}),By=e=>typeof e=="string"&&e.toLowerCase()==="svg";function qO(e,t,r,n){const a=ie.useMemo(()=>{const i=$E();return My(i,t,{enableHardwareAcceleration:!1},By(n),e.transformTemplate),{...i.attrs,style:{...i.style}}},[t]);if(e.style){const i={};UE(i,e.style,e),a.style={...i,...a.style}}return a}function GO(e=!1){return(r,n,a,{latestValues:i},s)=>{const l=(Iy(r)?qO:MO)(n,i,s,r),u={...VO(n,typeof r=="string",e),...l,ref:a},{children:f}=n,p=ie.useMemo(()=>_a(f)?f.get():f,[f]);return ie.createElement(r,{...u,children:p})}}function zE(e,{style:t,vars:r},n,a){Object.assign(e.style,t,a&&a.getProjectionStyles(n));for(const i in r)e.style.setProperty(i,r[i])}const HE=new Set(["baseFrequency","diffuseConstant","kernelMatrix","kernelUnitLength","keySplines","keyTimes","limitingConeAngle","markerHeight","markerWidth","numOctaves","targetX","targetY","surfaceScale","specularConstant","specularExponent","stdDeviation","tableValues","viewBox","gradientTransform","pathLength","startOffset","textLength","lengthAdjust"]);function WE(e,t,r,n){zE(e,t,void 0,n);for(const a in t.attrs)e.setAttribute(HE.has(a)?a:Ly(a),t.attrs[a])}function Uy(e,t){const{style:r}=e,n={};for(const a in r)(_a(r[a])||t.style&&_a(t.style[a])||IE(a,e))&&(n[a]=r[a]);return n}function qE(e,t){const r=Uy(e,t);for(const n in e)if(_a(e[n])||_a(t[n])){const a=bh.indexOf(n)!==-1?"attr"+n.charAt(0).toUpperCase()+n.substring(1):n;r[a]=e[n]}return r}function Vy(e,t,r,n={},a={}){return typeof t=="function"&&(t=t(r!==void 0?r:e.custom,n,a)),typeof t=="string"&&(t=e.variants&&e.variants[t]),typeof t=="function"&&(t=t(r!==void 0?r:e.custom,n,a)),t}function GE(e){const t=ie.useRef(null);return t.current===null&&(t.current=e()),t.current}const f1=e=>Array.isArray(e),KO=e=>!!(e&&typeof e=="object"&&e.mix&&e.toValue),XO=e=>f1(e)?e[e.length-1]||0:e;function Cp(e){const t=_a(e)?e.get():e;return KO(t)?t.toValue():t}function YO({scrapeMotionValuesFromProps:e,createRenderState:t,onMount:r},n,a,i){const s={latestValues:JO(n,a,i,e),renderState:t()};return r&&(s.mount=o=>r(n,o,s)),s}const KE=e=>(t,r)=>{const n=ie.useContext(om),a=ie.useContext(lm),i=()=>YO(e,t,n,a);return r?i():GE(i)};function JO(e,t,r,n){const a={},i=n(e,{});for(const p in i)a[p]=Cp(i[p]);let{initial:s,animate:o}=e;const l=fm(e),c=OE(e);t&&c&&!l&&e.inherit!==!1&&(s===void 0&&(s=t.initial),o===void 0&&(o=t.animate));let u=r?r.initial===!1:!1;u=u||s===!1;const f=u?o:s;return f&&typeof f!="boolean"&&!um(f)&&(Array.isArray(f)?f:[f]).forEach(h=>{const g=Vy(e,h);if(!g)return;const{transitionEnd:m,transition:b,...x}=g;for(const w in x){let y=x[w];if(Array.isArray(y)){const A=u?y.length-1:0;y=y[A]}y!==null&&(a[w]=y)}for(const w in m)a[w]=m[w]}),a}const zr=e=>e;class H4{constructor(){this.order=[],this.scheduled=new Set}add(t){if(!this.scheduled.has(t))return this.scheduled.add(t),this.order.push(t),!0}remove(t){const r=this.order.indexOf(t);r!==-1&&(this.order.splice(r,1),this.scheduled.delete(t))}clear(){this.order.length=0,this.scheduled.clear()}}function QO(e){let t=new H4,r=new H4,n=0,a=!1,i=!1;const s=new WeakSet,o={schedule:(l,c=!1,u=!1)=>{const f=u&&a,p=f?t:r;return c&&s.add(l),p.add(l)&&f&&a&&(n=t.order.length),l},cancel:l=>{r.remove(l),s.delete(l)},process:l=>{if(a){i=!0;return}if(a=!0,[t,r]=[r,t],r.clear(),n=t.order.length,n)for(let c=0;c<n;c++){const u=t.order[c];u(l),s.has(u)&&(o.schedule(u),e())}a=!1,i&&(i=!1,o.process(l))}};return o}const Xd=["prepare","read","update","preRender","render","postRender"],ZO=40;function eD(e,t){let r=!1,n=!0;const a={delta:0,timestamp:0,isProcessing:!1},i=Xd.reduce((f,p)=>(f[p]=QO(()=>r=!0),f),{}),s=f=>i[f].process(a),o=()=>{const f=performance.now();r=!1,a.delta=n?1e3/60:Math.max(Math.min(f-a.timestamp,ZO),1),a.timestamp=f,a.isProcessing=!0,Xd.forEach(s),a.isProcessing=!1,r&&t&&(n=!1,e(o))},l=()=>{r=!0,n=!0,a.isProcessing||e(o)};return{schedule:Xd.reduce((f,p)=>{const h=i[p];return f[p]=(g,m=!1,b=!1)=>(r||l(),h.schedule(g,m,b)),f},{}),cancel:f=>Xd.forEach(p=>i[p].cancel(f)),state:a,steps:i}}const{schedule:dr,cancel:Js,state:Mn,steps:Xg}=eD(typeof requestAnimationFrame<"u"?requestAnimationFrame:zr,!0),tD={useVisualState:KE({scrapeMotionValuesFromProps:qE,createRenderState:$E,onMount:(e,t,{renderState:r,latestValues:n})=>{dr.read(()=>{try{r.dimensions=typeof t.getBBox=="function"?t.getBBox():t.getBoundingClientRect()}catch{r.dimensions={x:0,y:0,width:0,height:0}}}),dr.render(()=>{My(r,n,{enableHardwareAcceleration:!1},By(t.tagName),e.transformTemplate),WE(t,r)})}})},rD={useVisualState:KE({scrapeMotionValuesFromProps:Uy,createRenderState:jy})};function nD(e,{forwardMotionProps:t=!1},r,n){return{...Iy(e)?tD:rD,preloadedFeatures:r,useRender:GO(t),createVisualElement:n,Component:e}}function js(e,t,r,n={passive:!0}){return e.addEventListener(t,r,n),()=>e.removeEventListener(t,r)}const XE=e=>e.pointerType==="mouse"?typeof e.button!="number"||e.button<=0:e.isPrimary!==!1;function dm(e,t="page"){return{point:{x:e[t+"X"],y:e[t+"Y"]}}}const aD=e=>t=>XE(t)&&e(t,dm(t));function Vs(e,t,r,n){return js(e,t,aD(r),n)}const iD=(e,t)=>r=>t(e(r)),Xo=(...e)=>e.reduce(iD);function YE(e){let t=null;return()=>{const r=()=>{t=null};return t===null?(t=e,r):!1}}const W4=YE("dragHorizontal"),q4=YE("dragVertical");function JE(e){let t=!1;if(e==="y")t=q4();else if(e==="x")t=W4();else{const r=W4(),n=q4();r&&n?t=()=>{r(),n()}:(r&&r(),n&&n())}return t}function QE(){const e=JE(!0);return e?(e(),!1):!0}class fl{constructor(t){this.isMounted=!1,this.node=t}update(){}}function G4(e,t){const r="pointer"+(t?"enter":"leave"),n="onHover"+(t?"Start":"End"),a=(i,s)=>{if(i.pointerType==="touch"||QE())return;const o=e.getProps();e.animationState&&o.whileHover&&e.animationState.setActive("whileHover",t),o[n]&&dr.update(()=>o[n](i,s))};return Vs(e.current,r,a,{passive:!e.getProps()[n]})}class sD extends fl{mount(){this.unmount=Xo(G4(this.node,!0),G4(this.node,!1))}unmount(){}}class oD extends fl{constructor(){super(...arguments),this.isActive=!1}onFocus(){let t=!1;try{t=this.node.current.matches(":focus-visible")}catch{t=!0}!t||!this.node.animationState||(this.node.animationState.setActive("whileFocus",!0),this.isActive=!0)}onBlur(){!this.isActive||!this.node.animationState||(this.node.animationState.setActive("whileFocus",!1),this.isActive=!1)}mount(){this.unmount=Xo(js(this.node.current,"focus",()=>this.onFocus()),js(this.node.current,"blur",()=>this.onBlur()))}unmount(){}}const ZE=(e,t)=>t?e===t?!0:ZE(e,t.parentElement):!1;function Yg(e,t){if(!t)return;const r=new PointerEvent("pointer"+e);t(r,dm(r))}class lD extends fl{constructor(){super(...arguments),this.removeStartListeners=zr,this.removeEndListeners=zr,this.removeAccessibleListeners=zr,this.startPointerPress=(t,r)=>{if(this.isPressing)return;this.removeEndListeners();const n=this.node.getProps(),i=Vs(window,"pointerup",(o,l)=>{if(!this.checkPressEnd())return;const{onTap:c,onTapCancel:u,globalTapTarget:f}=this.node.getProps();dr.update(()=>{!f&&!ZE(this.node.current,o.target)?u&&u(o,l):c&&c(o,l)})},{passive:!(n.onTap||n.onPointerUp)}),s=Vs(window,"pointercancel",(o,l)=>this.cancelPress(o,l),{passive:!(n.onTapCancel||n.onPointerCancel)});this.removeEndListeners=Xo(i,s),this.startPress(t,r)},this.startAccessiblePress=()=>{const t=i=>{if(i.key!=="Enter"||this.isPressing)return;const s=o=>{o.key!=="Enter"||!this.checkPressEnd()||Yg("up",(l,c)=>{const{onTap:u}=this.node.getProps();u&&dr.update(()=>u(l,c))})};this.removeEndListeners(),this.removeEndListeners=js(this.node.current,"keyup",s),Yg("down",(o,l)=>{this.startPress(o,l)})},r=js(this.node.current,"keydown",t),n=()=>{this.isPressing&&Yg("cancel",(i,s)=>this.cancelPress(i,s))},a=js(this.node.current,"blur",n);this.removeAccessibleListeners=Xo(r,a)}}startPress(t,r){this.isPressing=!0;const{onTapStart:n,whileTap:a}=this.node.getProps();a&&this.node.animationState&&this.node.animationState.setActive("whileTap",!0),n&&dr.update(()=>n(t,r))}checkPressEnd(){return this.removeEndListeners(),this.isPressing=!1,this.node.getProps().whileTap&&this.node.animationState&&this.node.animationState.setActive("whileTap",!1),!QE()}cancelPress(t,r){if(!this.checkPressEnd())return;const{onTapCancel:n}=this.node.getProps();n&&dr.update(()=>n(t,r))}mount(){const t=this.node.getProps(),r=Vs(t.globalTapTarget?window:this.node.current,"pointerdown",this.startPointerPress,{passive:!(t.onTapStart||t.onPointerStart)}),n=js(this.node.current,"focus",this.startAccessiblePress);this.removeStartListeners=Xo(r,n)}unmount(){this.removeStartListeners(),this.removeEndListeners(),this.removeAccessibleListeners()}}const Mv=new WeakMap,Jg=new WeakMap,cD=e=>{const t=Mv.get(e.target);t&&t(e)},uD=e=>{e.forEach(cD)};function fD({root:e,...t}){const r=e||document;Jg.has(r)||Jg.set(r,{});const n=Jg.get(r),a=JSON.stringify(t);return n[a]||(n[a]=new IntersectionObserver(uD,{root:e,...t})),n[a]}function hD(e,t,r){const n=fD(t);return Mv.set(e,r),n.observe(e),()=>{Mv.delete(e),n.unobserve(e)}}const dD={some:0,all:1};class pD extends fl{constructor(){super(...arguments),this.hasEnteredView=!1,this.isInView=!1}startObserver(){this.unmount();const{viewport:t={}}=this.node.getProps(),{root:r,margin:n,amount:a="some",once:i}=t,s={root:r?r.current:void 0,rootMargin:n,threshold:typeof a=="number"?a:dD[a]},o=l=>{const{isIntersecting:c}=l;if(this.isInView===c||(this.isInView=c,i&&!c&&this.hasEnteredView))return;c&&(this.hasEnteredView=!0),this.node.animationState&&this.node.animationState.setActive("whileInView",c);const{onViewportEnter:u,onViewportLeave:f}=this.node.getProps(),p=c?u:f;p&&p(l)};return hD(this.node.current,s,o)}mount(){this.startObserver()}update(){if(typeof IntersectionObserver>"u")return;const{props:t,prevProps:r}=this.node;["amount","margin","root"].some(mD(t,r))&&this.startObserver()}unmount(){}}function mD({viewport:e={}},{viewport:t={}}={}){return r=>e[r]!==t[r]}const gD={inView:{Feature:pD},tap:{Feature:lD},focus:{Feature:oD},hover:{Feature:sD}};function e6(e,t){if(!Array.isArray(t))return!1;const r=t.length;if(r!==e.length)return!1;for(let n=0;n<r;n++)if(t[n]!==e[n])return!1;return!0}function vD(e){const t={};return e.values.forEach((r,n)=>t[n]=r.get()),t}function xD(e){const t={};return e.values.forEach((r,n)=>t[n]=r.getVelocity()),t}function pm(e,t,r){const n=e.getProps();return Vy(n,t,r!==void 0?r:n.custom,vD(e),xD(e))}let h1=zr;const Hl=e=>e*1e3,$s=e=>e/1e3,yD={current:!1},t6=e=>Array.isArray(e)&&typeof e[0]=="number";function r6(e){return!!(!e||typeof e=="string"&&n6[e]||t6(e)||Array.isArray(e)&&e.every(r6))}const Jf=([e,t,r,n])=>`cubic-bezier(${e}, ${t}, ${r}, ${n})`,n6={linear:"linear",ease:"ease",easeIn:"ease-in",easeOut:"ease-out",easeInOut:"ease-in-out",circIn:Jf([0,.65,.55,1]),circOut:Jf([.55,0,1,.45]),backIn:Jf([.31,.01,.66,-.59]),backOut:Jf([.33,1.53,.69,.99])};function a6(e){if(e)return t6(e)?Jf(e):Array.isArray(e)?e.map(a6):n6[e]}function wD(e,t,r,{delay:n=0,duration:a,repeat:i=0,repeatType:s="loop",ease:o,times:l}={}){const c={[t]:r};l&&(c.offset=l);const u=a6(o);return Array.isArray(u)&&(c.easing=u),e.animate(c,{delay:n,duration:a,easing:Array.isArray(u)?"linear":u,fill:"both",iterations:i+1,direction:s==="reverse"?"alternate":"normal"})}function bD(e,{repeat:t,repeatType:r="loop"}){const n=t&&r!=="loop"&&t%2===1?0:e.length-1;return e[n]}const i6=(e,t,r)=>(((1-3*r+3*t)*e+(3*r-6*t))*e+3*t)*e,_D=1e-7,SD=12;function kD(e,t,r,n,a){let i,s,o=0;do s=t+(r-t)/2,i=i6(s,n,a)-e,i>0?r=s:t=s;while(Math.abs(i)>_D&&++o<SD);return s}function kh(e,t,r,n){if(e===t&&r===n)return zr;const a=i=>kD(i,0,1,e,r);return i=>i===0||i===1?i:i6(a(i),t,n)}const ED=kh(.42,0,1,1),AD=kh(0,0,.58,1),s6=kh(.42,0,.58,1),TD=e=>Array.isArray(e)&&typeof e[0]!="number",o6=e=>t=>t<=.5?e(2*t)/2:(2-e(2*(1-t)))/2,l6=e=>t=>1-e(1-t),$y=e=>1-Math.sin(Math.acos(e)),c6=l6($y),CD=o6($y),u6=kh(.33,1.53,.69,.99),zy=l6(u6),ND=o6(zy),PD=e=>(e*=2)<1?.5*zy(e):.5*(2-Math.pow(2,-10*(e-1))),K4={linear:zr,easeIn:ED,easeInOut:s6,easeOut:AD,circIn:$y,circInOut:CD,circOut:c6,backIn:zy,backInOut:ND,backOut:u6,anticipate:PD},X4=e=>{if(Array.isArray(e)){h1(e.length===4);const[t,r,n,a]=e;return kh(t,r,n,a)}else if(typeof e=="string")return h1(K4[e]!==void 0),K4[e];return e},Hy=(e,t)=>r=>!!(_h(r)&&OO.test(r)&&r.startsWith(e)||t&&Object.prototype.hasOwnProperty.call(r,t)),f6=(e,t,r)=>n=>{if(!_h(n))return n;const[a,i,s,o]=n.match(hm);return{[e]:parseFloat(a),[t]:parseFloat(i),[r]:parseFloat(s),alpha:o!==void 0?parseFloat(o):1}},LD=e=>el(0,255,e),Qg={...cc,transform:e=>Math.round(LD(e))},Ul={test:Hy("rgb","red"),parse:f6("red","green","blue"),transform:({red:e,green:t,blue:r,alpha:n=1})=>"rgba("+Qg.transform(e)+", "+Qg.transform(t)+", "+Qg.transform(r)+", "+v0(g0.transform(n))+")"};function FD(e){let t="",r="",n="",a="";return e.length>5?(t=e.substring(1,3),r=e.substring(3,5),n=e.substring(5,7),a=e.substring(7,9)):(t=e.substring(1,2),r=e.substring(2,3),n=e.substring(3,4),a=e.substring(4,5),t+=t,r+=r,n+=n,a+=a),{red:parseInt(t,16),green:parseInt(r,16),blue:parseInt(n,16),alpha:a?parseInt(a,16)/255:1}}const Bv={test:Hy("#"),parse:FD,transform:Ul.transform},fu={test:Hy("hsl","hue"),parse:f6("hue","saturation","lightness"),transform:({hue:e,saturation:t,lightness:r,alpha:n=1})=>"hsla("+Math.round(e)+", "+cs.transform(v0(t))+", "+cs.transform(v0(r))+", "+v0(g0.transform(n))+")"},Jn={test:e=>Ul.test(e)||Bv.test(e)||fu.test(e),parse:e=>Ul.test(e)?Ul.parse(e):fu.test(e)?fu.parse(e):Bv.parse(e),transform:e=>_h(e)?e:e.hasOwnProperty("red")?Ul.transform(e):fu.transform(e)},kr=(e,t,r)=>-r*e+r*t+e;function Zg(e,t,r){return r<0&&(r+=1),r>1&&(r-=1),r<1/6?e+(t-e)*6*r:r<1/2?t:r<2/3?e+(t-e)*(2/3-r)*6:e}function OD({hue:e,saturation:t,lightness:r,alpha:n}){e/=360,t/=100,r/=100;let a=0,i=0,s=0;if(!t)a=i=s=r;else{const o=r<.5?r*(1+t):r+t-r*t,l=2*r-o;a=Zg(l,o,e+1/3),i=Zg(l,o,e),s=Zg(l,o,e-1/3)}return{red:Math.round(a*255),green:Math.round(i*255),blue:Math.round(s*255),alpha:n}}const e2=(e,t,r)=>{const n=e*e;return Math.sqrt(Math.max(0,r*(t*t-n)+n))},DD=[Bv,Ul,fu],ID=e=>DD.find(t=>t.test(e));function Y4(e){const t=ID(e);let r=t.parse(e);return t===fu&&(r=OD(r)),r}const h6=(e,t)=>{const r=Y4(e),n=Y4(t),a={...r};return i=>(a.red=e2(r.red,n.red,i),a.green=e2(r.green,n.green,i),a.blue=e2(r.blue,n.blue,i),a.alpha=kr(r.alpha,n.alpha,i),Ul.transform(a))};function RD(e){var t,r;return isNaN(e)&&_h(e)&&(((t=e.match(hm))===null||t===void 0?void 0:t.length)||0)+(((r=e.match(ME))===null||r===void 0?void 0:r.length)||0)>0}const d6={regex:LO,countKey:"Vars",token:"${v}",parse:zr},p6={regex:ME,countKey:"Colors",token:"${c}",parse:Jn.parse},m6={regex:hm,countKey:"Numbers",token:"${n}",parse:cc.parse};function t2(e,{regex:t,countKey:r,token:n,parse:a}){const i=e.tokenised.match(t);i&&(e["num"+r]=i.length,e.tokenised=e.tokenised.replace(t,n),e.values.push(...i.map(a)))}function d1(e){const t=e.toString(),r={value:t,tokenised:t,values:[],numVars:0,numColors:0,numNumbers:0};return r.value.includes("var(--")&&t2(r,d6),t2(r,p6),t2(r,m6),r}function g6(e){return d1(e).values}function v6(e){const{values:t,numColors:r,numVars:n,tokenised:a}=d1(e),i=t.length;return s=>{let o=a;for(let l=0;l<i;l++)l<n?o=o.replace(d6.token,s[l]):l<n+r?o=o.replace(p6.token,Jn.transform(s[l])):o=o.replace(m6.token,v0(s[l]));return o}}const jD=e=>typeof e=="number"?0:e;function MD(e){const t=g6(e);return v6(e)(t.map(jD))}const tl={test:RD,parse:g6,createTransformer:v6,getAnimatableNone:MD},x6=(e,t)=>r=>`${r>0?t:e}`;function y6(e,t){return typeof e=="number"?r=>kr(e,t,r):Jn.test(e)?h6(e,t):e.startsWith("var(")?x6(e,t):b6(e,t)}const w6=(e,t)=>{const r=[...e],n=r.length,a=e.map((i,s)=>y6(i,t[s]));return i=>{for(let s=0;s<n;s++)r[s]=a[s](i);return r}},BD=(e,t)=>{const r={...e,...t},n={};for(const a in r)e[a]!==void 0&&t[a]!==void 0&&(n[a]=y6(e[a],t[a]));return a=>{for(const i in n)r[i]=n[i](a);return r}},b6=(e,t)=>{const r=tl.createTransformer(t),n=d1(e),a=d1(t);return n.numVars===a.numVars&&n.numColors===a.numColors&&n.numNumbers>=a.numNumbers?Xo(w6(n.values,a.values),r):x6(e,t)},Z0=(e,t,r)=>{const n=t-e;return n===0?1:(r-e)/n},J4=(e,t)=>r=>kr(e,t,r);function UD(e){return typeof e=="number"?J4:typeof e=="string"?Jn.test(e)?h6:b6:Array.isArray(e)?w6:typeof e=="object"?BD:J4}function VD(e,t,r){const n=[],a=r||UD(e[0]),i=e.length-1;for(let s=0;s<i;s++){let o=a(e[s],e[s+1]);if(t){const l=Array.isArray(t)?t[s]||zr:t;o=Xo(l,o)}n.push(o)}return n}function _6(e,t,{clamp:r=!0,ease:n,mixer:a}={}){const i=e.length;if(h1(i===t.length),i===1)return()=>t[0];e[0]>e[i-1]&&(e=[...e].reverse(),t=[...t].reverse());const s=VD(t,n,a),o=s.length,l=c=>{let u=0;if(o>1)for(;u<e.length-2&&!(c<e[u+1]);u++);const f=Z0(e[u],e[u+1],c);return s[u](f)};return r?c=>l(el(e[0],e[i-1],c)):l}function $D(e,t){const r=e[e.length-1];for(let n=1;n<=t;n++){const a=Z0(0,t,n);e.push(kr(r,1,a))}}function zD(e){const t=[0];return $D(t,e.length-1),t}function HD(e,t){return e.map(r=>r*t)}function WD(e,t){return e.map(()=>t||s6).splice(0,e.length-1)}function p1({duration:e=300,keyframes:t,times:r,ease:n="easeInOut"}){const a=TD(n)?n.map(X4):X4(n),i={done:!1,value:t[0]},s=HD(r&&r.length===t.length?r:zD(t),e),o=_6(s,t,{ease:Array.isArray(a)?a:WD(t,a)});return{calculatedDuration:e,next:l=>(i.value=o(l),i.done=l>=e,i)}}function S6(e,t){return t?e*(1e3/t):0}const qD=5;function k6(e,t,r){const n=Math.max(t-qD,0);return S6(r-e(n),t-n)}const r2=.001,GD=.01,KD=10,XD=.05,YD=1;function JD({duration:e=800,bounce:t=.25,velocity:r=0,mass:n=1}){let a,i,s=1-t;s=el(XD,YD,s),e=el(GD,KD,$s(e)),s<1?(a=c=>{const u=c*s,f=u*e,p=u-r,h=Uv(c,s),g=Math.exp(-f);return r2-p/h*g},i=c=>{const f=c*s*e,p=f*r+r,h=Math.pow(s,2)*Math.pow(c,2)*e,g=Math.exp(-f),m=Uv(Math.pow(c,2),s);return(-a(c)+r2>0?-1:1)*((p-h)*g)/m}):(a=c=>{const u=Math.exp(-c*e),f=(c-r)*e+1;return-r2+u*f},i=c=>{const u=Math.exp(-c*e),f=(r-c)*(e*e);return u*f});const o=5/e,l=ZD(a,i,o);if(e=Hl(e),isNaN(l))return{stiffness:100,damping:10,duration:e};{const c=Math.pow(l,2)*n;return{stiffness:c,damping:s*2*Math.sqrt(n*c),duration:e}}}const QD=12;function ZD(e,t,r){let n=r;for(let a=1;a<QD;a++)n=n-e(n)/t(n);return n}function Uv(e,t){return e*Math.sqrt(1-t*t)}const eI=["duration","bounce"],tI=["stiffness","damping","mass"];function Q4(e,t){return t.some(r=>e[r]!==void 0)}function rI(e){let t={velocity:0,stiffness:100,damping:10,mass:1,isResolvedFromDuration:!1,...e};if(!Q4(e,tI)&&Q4(e,eI)){const r=JD(e);t={...t,...r,mass:1},t.isResolvedFromDuration=!0}return t}function E6({keyframes:e,restDelta:t,restSpeed:r,...n}){const a=e[0],i=e[e.length-1],s={done:!1,value:a},{stiffness:o,damping:l,mass:c,duration:u,velocity:f,isResolvedFromDuration:p}=rI({...n,velocity:-$s(n.velocity||0)}),h=f||0,g=l/(2*Math.sqrt(o*c)),m=i-a,b=$s(Math.sqrt(o/c)),x=Math.abs(m)<5;r||(r=x?.01:2),t||(t=x?.005:.5);let w;if(g<1){const y=Uv(b,g);w=A=>{const L=Math.exp(-g*b*A);return i-L*((h+g*b*m)/y*Math.sin(y*A)+m*Math.cos(y*A))}}else if(g===1)w=y=>i-Math.exp(-b*y)*(m+(h+b*m)*y);else{const y=b*Math.sqrt(g*g-1);w=A=>{const L=Math.exp(-g*b*A),D=Math.min(y*A,300);return i-L*((h+g*b*m)*Math.sinh(D)+y*m*Math.cosh(D))/y}}return{calculatedDuration:p&&u||null,next:y=>{const A=w(y);if(p)s.done=y>=u;else{let L=h;y!==0&&(g<1?L=k6(w,y,A):L=0);const D=Math.abs(L)<=r,T=Math.abs(i-A)<=t;s.done=D&&T}return s.value=s.done?i:A,s}}}function Z4({keyframes:e,velocity:t=0,power:r=.8,timeConstant:n=325,bounceDamping:a=10,bounceStiffness:i=500,modifyTarget:s,min:o,max:l,restDelta:c=.5,restSpeed:u}){const f=e[0],p={done:!1,value:f},h=F=>o!==void 0&&F<o||l!==void 0&&F>l,g=F=>o===void 0?l:l===void 0||Math.abs(o-F)<Math.abs(l-F)?o:l;let m=r*t;const b=f+m,x=s===void 0?b:s(b);x!==b&&(m=x-f);const w=F=>-m*Math.exp(-F/n),y=F=>x+w(F),A=F=>{const R=w(F),X=y(F);p.done=Math.abs(R)<=c,p.value=p.done?x:X};let L,D;const T=F=>{h(p.value)&&(L=F,D=E6({keyframes:[p.value,g(p.value)],velocity:k6(y,F,p.value),damping:a,stiffness:i,restDelta:c,restSpeed:u}))};return T(0),{calculatedDuration:null,next:F=>{let R=!1;return!D&&L===void 0&&(R=!0,A(F),T(F)),L!==void 0&&F>L?D.next(F-L):(!R&&A(F),p)}}}const nI=e=>{const t=({timestamp:r})=>e(r);return{start:()=>dr.update(t,!0),stop:()=>Js(t),now:()=>Mn.isProcessing?Mn.timestamp:performance.now()}},eb=2e4;function tb(e){let t=0;const r=50;let n=e.next(t);for(;!n.done&&t<eb;)t+=r,n=e.next(t);return t>=eb?1/0:t}const aI={decay:Z4,inertia:Z4,tween:p1,keyframes:p1,spring:E6};function m1({autoplay:e=!0,delay:t=0,driver:r=nI,keyframes:n,type:a="keyframes",repeat:i=0,repeatDelay:s=0,repeatType:o="loop",onPlay:l,onStop:c,onComplete:u,onUpdate:f,...p}){let h=1,g=!1,m,b;const x=()=>{b=new Promise(xe=>{m=xe})};x();let w;const y=aI[a]||p1;let A;y!==p1&&typeof n[0]!="number"&&(A=_6([0,100],n,{clamp:!1}),n=[0,100]);const L=y({...p,keyframes:n});let D;o==="mirror"&&(D=y({...p,keyframes:[...n].reverse(),velocity:-(p.velocity||0)}));let T="idle",F=null,R=null,X=null;L.calculatedDuration===null&&i&&(L.calculatedDuration=tb(L));const{calculatedDuration:N}=L;let P=1/0,J=1/0;N!==null&&(P=N+s,J=P*(i+1)-s);let W=0;const se=xe=>{if(R===null)return;h>0&&(R=Math.min(R,xe)),h<0&&(R=Math.min(xe-J/h,R)),F!==null?W=F:W=Math.round(xe-R)*h;const E=W-t*(h>=0?1:-1),I=h>=0?E<0:E>J;W=Math.max(E,0),T==="finished"&&F===null&&(W=J);let O=W,j=L;if(i){const de=Math.min(W,J)/P;let we=Math.floor(de),Pe=de%1;!Pe&&de>=1&&(Pe=1),Pe===1&&we--,we=Math.min(we,i+1),!!(we%2)&&(o==="reverse"?(Pe=1-Pe,s&&(Pe-=s/P)):o==="mirror"&&(j=D)),O=el(0,1,Pe)*P}const K=I?{done:!1,value:n[0]}:j.next(O);A&&(K.value=A(K.value));let{done:ne}=K;!I&&N!==null&&(ne=h>=0?W>=J:W<=0);const pe=F===null&&(T==="finished"||T==="running"&&ne);return f&&f(K.value),pe&&Q(),K},fe=()=>{w&&w.stop(),w=void 0},U=()=>{T="idle",fe(),m(),x(),R=X=null},Q=()=>{T="finished",u&&u(),fe(),m()},q=()=>{if(g)return;w||(w=r(se));const xe=w.now();l&&l(),F!==null?R=xe-F:(!R||T==="finished")&&(R=xe),T==="finished"&&x(),X=R,F=null,T="running",w.start()};e&&q();const he={then(xe,E){return b.then(xe,E)},get time(){return $s(W)},set time(xe){xe=Hl(xe),W=xe,F!==null||!w||h===0?F=xe:R=w.now()-xe/h},get duration(){const xe=L.calculatedDuration===null?tb(L):L.calculatedDuration;return $s(xe)},get speed(){return h},set speed(xe){xe===h||!w||(h=xe,he.time=$s(W))},get state(){return T},play:q,pause:()=>{T="paused",F=W},stop:()=>{g=!0,T!=="idle"&&(T="idle",c&&c(),U())},cancel:()=>{X!==null&&se(X),U()},complete:()=>{T="finished"},sample:xe=>(R=0,se(xe))};return he}function iI(e){let t;return()=>(t===void 0&&(t=e()),t)}const sI=iI(()=>Object.hasOwnProperty.call(Element.prototype,"animate")),oI=new Set(["opacity","clipPath","filter","transform","backgroundColor"]),Yd=10,lI=2e4,cI=(e,t)=>t.type==="spring"||e==="backgroundColor"||!r6(t.ease);function uI(e,t,{onUpdate:r,onComplete:n,...a}){if(!(sI()&&oI.has(t)&&!a.repeatDelay&&a.repeatType!=="mirror"&&a.damping!==0&&a.type!=="inertia"))return!1;let s=!1,o,l,c=!1;const u=()=>{l=new Promise(y=>{o=y})};u();let{keyframes:f,duration:p=300,ease:h,times:g}=a;if(cI(t,a)){const y=m1({...a,repeat:0,delay:0});let A={done:!1,value:f[0]};const L=[];let D=0;for(;!A.done&&D<lI;)A=y.sample(D),L.push(A.value),D+=Yd;g=void 0,f=L,p=D-Yd,h="linear"}const m=wD(e.owner.current,t,f,{...a,duration:p,ease:h,times:g}),b=()=>{c=!1,m.cancel()},x=()=>{c=!0,dr.update(b),o(),u()};return m.onfinish=()=>{c||(e.set(bD(f,a)),n&&n(),x())},{then(y,A){return l.then(y,A)},attachTimeline(y){return m.timeline=y,m.onfinish=null,zr},get time(){return $s(m.currentTime||0)},set time(y){m.currentTime=Hl(y)},get speed(){return m.playbackRate},set speed(y){m.playbackRate=y},get duration(){return $s(p)},play:()=>{s||(m.play(),Js(b))},pause:()=>m.pause(),stop:()=>{if(s=!0,m.playState==="idle")return;const{currentTime:y}=m;if(y){const A=m1({...a,autoplay:!1});e.setWithVelocity(A.sample(y-Yd).value,A.sample(y).value,Yd)}x()},complete:()=>{c||m.finish()},cancel:x}}function fI({keyframes:e,delay:t,onUpdate:r,onComplete:n}){const a=()=>(r&&r(e[e.length-1]),n&&n(),{time:0,speed:1,duration:0,play:zr,pause:zr,stop:zr,then:i=>(i(),Promise.resolve()),cancel:zr,complete:zr});return t?m1({keyframes:[0,1],duration:0,delay:t,onComplete:a}):a()}const hI={type:"spring",stiffness:500,damping:25,restSpeed:10},dI=e=>({type:"spring",stiffness:550,damping:e===0?2*Math.sqrt(550):30,restSpeed:10}),pI={type:"keyframes",duration:.8},mI={type:"keyframes",ease:[.25,.1,.35,1],duration:.3},gI=(e,{keyframes:t})=>t.length>2?pI:lc.has(e)?e.startsWith("scale")?dI(t[1]):hI:mI,Vv=(e,t)=>e==="zIndex"?!1:!!(typeof t=="number"||Array.isArray(t)||typeof t=="string"&&(tl.test(t)||t==="0")&&!t.startsWith("url(")),vI=new Set(["brightness","contrast","saturate","opacity"]);function xI(e){const[t,r]=e.slice(0,-1).split("(");if(t==="drop-shadow")return e;const[n]=r.match(hm)||[];if(!n)return e;const a=r.replace(n,"");let i=vI.has(t)?1:0;return n!==r&&(i*=100),t+"("+i+a+")"}const yI=/([a-z-]*)\(.*?\)/g,$v={...tl,getAnimatableNone:e=>{const t=e.match(yI);return t?t.map(xI).join(" "):e}},wI={...BE,color:Jn,backgroundColor:Jn,outlineColor:Jn,fill:Jn,stroke:Jn,borderColor:Jn,borderTopColor:Jn,borderRightColor:Jn,borderBottomColor:Jn,borderLeftColor:Jn,filter:$v,WebkitFilter:$v},Wy=e=>wI[e];function A6(e,t){let r=Wy(e);return r!==$v&&(r=tl),r.getAnimatableNone?r.getAnimatableNone(t):void 0}const T6=e=>/^0[^.\s]+$/.test(e);function bI(e){if(typeof e=="number")return e===0;if(e!==null)return e==="none"||e==="0"||T6(e)}function _I(e,t,r,n){const a=Vv(t,r);let i;Array.isArray(r)?i=[...r]:i=[null,r];const s=n.from!==void 0?n.from:e.get();let o;const l=[];for(let c=0;c<i.length;c++)i[c]===null&&(i[c]=c===0?s:i[c-1]),bI(i[c])&&l.push(c),typeof i[c]=="string"&&i[c]!=="none"&&i[c]!=="0"&&(o=i[c]);if(a&&l.length&&o)for(let c=0;c<l.length;c++){const u=l[c];i[u]=A6(t,o)}return i}function SI({when:e,delay:t,delayChildren:r,staggerChildren:n,staggerDirection:a,repeat:i,repeatType:s,repeatDelay:o,from:l,elapsed:c,...u}){return!!Object.keys(u).length}function qy(e,t){return e[t]||e.default||e}const kI={skipAnimations:!1},Gy=(e,t,r,n={})=>a=>{const i=qy(n,e)||{},s=i.delay||n.delay||0;let{elapsed:o=0}=n;o=o-Hl(s);const l=_I(t,e,r,i),c=l[0],u=l[l.length-1],f=Vv(e,c),p=Vv(e,u);let h={keyframes:l,velocity:t.getVelocity(),ease:"easeOut",...i,delay:-o,onUpdate:g=>{t.set(g),i.onUpdate&&i.onUpdate(g)},onComplete:()=>{a(),i.onComplete&&i.onComplete()}};if(SI(i)||(h={...h,...gI(e,h)}),h.duration&&(h.duration=Hl(h.duration)),h.repeatDelay&&(h.repeatDelay=Hl(h.repeatDelay)),!f||!p||yD.current||i.type===!1||kI.skipAnimations)return fI(h);if(!n.isHandoff&&t.owner&&t.owner.current instanceof HTMLElement&&!t.owner.getProps().onUpdate){const g=uI(t,e,h);if(g)return g}return m1(h)};function g1(e){return!!(_a(e)&&e.add)}const C6=e=>/^\-?\d*\.?\d+$/.test(e);function Ky(e,t){e.indexOf(t)===-1&&e.push(t)}function Xy(e,t){const r=e.indexOf(t);r>-1&&e.splice(r,1)}class Yy{constructor(){this.subscriptions=[]}add(t){return Ky(this.subscriptions,t),()=>Xy(this.subscriptions,t)}notify(t,r,n){const a=this.subscriptions.length;if(a)if(a===1)this.subscriptions[0](t,r,n);else for(let i=0;i<a;i++){const s=this.subscriptions[i];s&&s(t,r,n)}}getSize(){return this.subscriptions.length}clear(){this.subscriptions.length=0}}const EI=e=>!isNaN(parseFloat(e));class AI{constructor(t,r={}){this.version="10.18.0",this.timeDelta=0,this.lastUpdated=0,this.canTrackVelocity=!1,this.events={},this.updateAndNotify=(n,a=!0)=>{this.prev=this.current,this.current=n;const{delta:i,timestamp:s}=Mn;this.lastUpdated!==s&&(this.timeDelta=i,this.lastUpdated=s,dr.postRender(this.scheduleVelocityCheck)),this.prev!==this.current&&this.events.change&&this.events.change.notify(this.current),this.events.velocityChange&&this.events.velocityChange.notify(this.getVelocity()),a&&this.events.renderRequest&&this.events.renderRequest.notify(this.current)},this.scheduleVelocityCheck=()=>dr.postRender(this.velocityCheck),this.velocityCheck=({timestamp:n})=>{n!==this.lastUpdated&&(this.prev=this.current,this.events.velocityChange&&this.events.velocityChange.notify(this.getVelocity()))},this.hasAnimated=!1,this.prev=this.current=t,this.canTrackVelocity=EI(this.current),this.owner=r.owner}onChange(t){return this.on("change",t)}on(t,r){this.events[t]||(this.events[t]=new Yy);const n=this.events[t].add(r);return t==="change"?()=>{n(),dr.read(()=>{this.events.change.getSize()||this.stop()})}:n}clearListeners(){for(const t in this.events)this.events[t].clear()}attach(t,r){this.passiveEffect=t,this.stopPassiveEffect=r}set(t,r=!0){!r||!this.passiveEffect?this.updateAndNotify(t,r):this.passiveEffect(t,this.updateAndNotify)}setWithVelocity(t,r,n){this.set(r),this.prev=t,this.timeDelta=n}jump(t){this.updateAndNotify(t),this.prev=t,this.stop(),this.stopPassiveEffect&&this.stopPassiveEffect()}get(){return this.current}getPrevious(){return this.prev}getVelocity(){return this.canTrackVelocity?S6(parseFloat(this.current)-parseFloat(this.prev),this.timeDelta):0}start(t){return this.stop(),new Promise(r=>{this.hasAnimated=!0,this.animation=t(r),this.events.animationStart&&this.events.animationStart.notify()}).then(()=>{this.events.animationComplete&&this.events.animationComplete.notify(),this.clearAnimation()})}stop(){this.animation&&(this.animation.stop(),this.events.animationCancel&&this.events.animationCancel.notify()),this.clearAnimation()}isAnimating(){return!!this.animation}clearAnimation(){delete this.animation}destroy(){this.clearListeners(),this.stop(),this.stopPassiveEffect&&this.stopPassiveEffect()}}function Bu(e,t){return new AI(e,t)}const N6=e=>t=>t.test(e),TI={test:e=>e==="auto",parse:e=>e},P6=[cc,gt,cs,ko,IO,DO,TI],Vf=e=>P6.find(N6(e)),CI=[...P6,Jn,tl],NI=e=>CI.find(N6(e));function PI(e,t,r){e.hasValue(t)?e.getValue(t).set(r):e.addValue(t,Bu(r))}function LI(e,t){const r=pm(e,t);let{transitionEnd:n={},transition:a={},...i}=r?e.makeTargetAnimatable(r,!1):{};i={...i,...n};for(const s in i){const o=XO(i[s]);PI(e,s,o)}}function FI(e,t,r){var n,a;const i=Object.keys(t).filter(o=>!e.hasValue(o)),s=i.length;if(s)for(let o=0;o<s;o++){const l=i[o],c=t[l];let u=null;Array.isArray(c)&&(u=c[0]),u===null&&(u=(a=(n=r[l])!==null&&n!==void 0?n:e.readValue(l))!==null&&a!==void 0?a:t[l]),u!=null&&(typeof u=="string"&&(C6(u)||T6(u))?u=parseFloat(u):!NI(u)&&tl.test(c)&&(u=A6(l,c)),e.addValue(l,Bu(u,{owner:e})),r[l]===void 0&&(r[l]=u),u!==null&&e.setBaseTarget(l,u))}}function OI(e,t){return t?(t[e]||t.default||t).from:void 0}function DI(e,t,r){const n={};for(const a in e){const i=OI(a,t);if(i!==void 0)n[a]=i;else{const s=r.getValue(a);s&&(n[a]=s.get())}}return n}function II({protectedKeys:e,needsAnimating:t},r){const n=e.hasOwnProperty(r)&&t[r]!==!0;return t[r]=!1,n}function RI(e,t){const r=e.get();if(Array.isArray(t)){for(let n=0;n<t.length;n++)if(t[n]!==r)return!0}else return r!==t}function L6(e,t,{delay:r=0,transitionOverride:n,type:a}={}){let{transition:i=e.getDefaultTransition(),transitionEnd:s,...o}=e.makeTargetAnimatable(t);const l=e.getValue("willChange");n&&(i=n);const c=[],u=a&&e.animationState&&e.animationState.getState()[a];for(const f in o){const p=e.getValue(f),h=o[f];if(!p||h===void 0||u&&II(u,f))continue;const g={delay:r,elapsed:0,...qy(i||{},f)};if(window.HandoffAppearAnimations){const x=e.getProps()[FE];if(x){const w=window.HandoffAppearAnimations(x,f,p,dr);w!==null&&(g.elapsed=w,g.isHandoff=!0)}}let m=!g.isHandoff&&!RI(p,h);if(g.type==="spring"&&(p.getVelocity()||g.velocity)&&(m=!1),p.animation&&(m=!1),m)continue;p.start(Gy(f,p,h,e.shouldReduceMotion&&lc.has(f)?{type:!1}:g));const b=p.animation;g1(l)&&(l.add(f),b.then(()=>l.remove(f))),c.push(b)}return s&&Promise.all(c).then(()=>{s&&LI(e,s)}),c}function zv(e,t,r={}){const n=pm(e,t,r.custom);let{transition:a=e.getDefaultTransition()||{}}=n||{};r.transitionOverride&&(a=r.transitionOverride);const i=n?()=>Promise.all(L6(e,n,r)):()=>Promise.resolve(),s=e.variantChildren&&e.variantChildren.size?(l=0)=>{const{delayChildren:c=0,staggerChildren:u,staggerDirection:f}=a;return jI(e,t,c+l,u,f,r)}:()=>Promise.resolve(),{when:o}=a;if(o){const[l,c]=o==="beforeChildren"?[i,s]:[s,i];return l().then(()=>c())}else return Promise.all([i(),s(r.delay)])}function jI(e,t,r=0,n=0,a=1,i){const s=[],o=(e.variantChildren.size-1)*n,l=a===1?(c=0)=>c*n:(c=0)=>o-c*n;return Array.from(e.variantChildren).sort(MI).forEach((c,u)=>{c.notify("AnimationStart",t),s.push(zv(c,t,{...i,delay:r+l(u)}).then(()=>c.notify("AnimationComplete",t)))}),Promise.all(s)}function MI(e,t){return e.sortNodePosition(t)}function BI(e,t,r={}){e.notify("AnimationStart",t);let n;if(Array.isArray(t)){const a=t.map(i=>zv(e,i,r));n=Promise.all(a)}else if(typeof t=="string")n=zv(e,t,r);else{const a=typeof t=="function"?pm(e,t,r.custom):t;n=Promise.all(L6(e,a,r))}return n.then(()=>e.notify("AnimationComplete",t))}const UI=[...Fy].reverse(),VI=Fy.length;function $I(e){return t=>Promise.all(t.map(({animation:r,options:n})=>BI(e,r,n)))}function zI(e){let t=$I(e);const r=WI();let n=!0;const a=(l,c)=>{const u=pm(e,c);if(u){const{transition:f,transitionEnd:p,...h}=u;l={...l,...h,...p}}return l};function i(l){t=l(e)}function s(l,c){const u=e.getProps(),f=e.getVariantContext(!0)||{},p=[],h=new Set;let g={},m=1/0;for(let x=0;x<VI;x++){const w=UI[x],y=r[w],A=u[w]!==void 0?u[w]:f[w],L=J0(A),D=w===c?y.isActive:null;D===!1&&(m=x);let T=A===f[w]&&A!==u[w]&&L;if(T&&n&&e.manuallyAnimateOnMount&&(T=!1),y.protectedKeys={...g},!y.isActive&&D===null||!A&&!y.prevProp||um(A)||typeof A=="boolean")continue;let R=HI(y.prevProp,A)||w===c&&y.isActive&&!T&&L||x>m&&L,X=!1;const N=Array.isArray(A)?A:[A];let P=N.reduce(a,{});D===!1&&(P={});const{prevResolvedValues:J={}}=y,W={...J,...P},se=fe=>{R=!0,h.has(fe)&&(X=!0,h.delete(fe)),y.needsAnimating[fe]=!0};for(const fe in W){const U=P[fe],Q=J[fe];if(g.hasOwnProperty(fe))continue;let q=!1;f1(U)&&f1(Q)?q=!e6(U,Q):q=U!==Q,q?U!==void 0?se(fe):h.add(fe):U!==void 0&&h.has(fe)?se(fe):y.protectedKeys[fe]=!0}y.prevProp=A,y.prevResolvedValues=P,y.isActive&&(g={...g,...P}),n&&e.blockInitialAnimation&&(R=!1),R&&(!T||X)&&p.push(...N.map(fe=>({animation:fe,options:{type:w,...l}})))}if(h.size){const x={};h.forEach(w=>{const y=e.getBaseTarget(w);y!==void 0&&(x[w]=y)}),p.push({animation:x})}let b=!!p.length;return n&&(u.initial===!1||u.initial===u.animate)&&!e.manuallyAnimateOnMount&&(b=!1),n=!1,b?t(p):Promise.resolve()}function o(l,c,u){var f;if(r[l].isActive===c)return Promise.resolve();(f=e.variantChildren)===null||f===void 0||f.forEach(h=>{var g;return(g=h.animationState)===null||g===void 0?void 0:g.setActive(l,c)}),r[l].isActive=c;const p=s(u,l);for(const h in r)r[h].protectedKeys={};return p}return{animateChanges:s,setActive:o,setAnimateFunction:i,getState:()=>r}}function HI(e,t){return typeof t=="string"?t!==e:Array.isArray(t)?!e6(t,e):!1}function kl(e=!1){return{isActive:e,protectedKeys:{},needsAnimating:{},prevResolvedValues:{}}}function WI(){return{animate:kl(!0),whileInView:kl(),whileHover:kl(),whileTap:kl(),whileDrag:kl(),whileFocus:kl(),exit:kl()}}class qI extends fl{constructor(t){super(t),t.animationState||(t.animationState=zI(t))}updateAnimationControlsSubscription(){const{animate:t}=this.node.getProps();this.unmount(),um(t)&&(this.unmount=t.subscribe(this.node))}mount(){this.updateAnimationControlsSubscription()}update(){const{animate:t}=this.node.getProps(),{animate:r}=this.node.prevProps||{};t!==r&&this.updateAnimationControlsSubscription()}unmount(){}}let GI=0;class KI extends fl{constructor(){super(...arguments),this.id=GI++}update(){if(!this.node.presenceContext)return;const{isPresent:t,onExitComplete:r,custom:n}=this.node.presenceContext,{isPresent:a}=this.node.prevPresenceContext||{};if(!this.node.animationState||t===a)return;const i=this.node.animationState.setActive("exit",!t,{custom:n??this.node.getProps().custom});r&&!t&&i.then(()=>r(this.id))}mount(){const{register:t}=this.node.presenceContext||{};t&&(this.unmount=t(this.id))}unmount(){}}const XI={animation:{Feature:qI},exit:{Feature:KI}},rb=(e,t)=>Math.abs(e-t);function YI(e,t){const r=rb(e.x,t.x),n=rb(e.y,t.y);return Math.sqrt(r**2+n**2)}class F6{constructor(t,r,{transformPagePoint:n,contextWindow:a,dragSnapToOrigin:i=!1}={}){if(this.startEvent=null,this.lastMoveEvent=null,this.lastMoveEventInfo=null,this.handlers={},this.contextWindow=window,this.updatePoint=()=>{if(!(this.lastMoveEvent&&this.lastMoveEventInfo))return;const f=a2(this.lastMoveEventInfo,this.history),p=this.startEvent!==null,h=YI(f.offset,{x:0,y:0})>=3;if(!p&&!h)return;const{point:g}=f,{timestamp:m}=Mn;this.history.push({...g,timestamp:m});const{onStart:b,onMove:x}=this.handlers;p||(b&&b(this.lastMoveEvent,f),this.startEvent=this.lastMoveEvent),x&&x(this.lastMoveEvent,f)},this.handlePointerMove=(f,p)=>{this.lastMoveEvent=f,this.lastMoveEventInfo=n2(p,this.transformPagePoint),dr.update(this.updatePoint,!0)},this.handlePointerUp=(f,p)=>{this.end();const{onEnd:h,onSessionEnd:g,resumeAnimation:m}=this.handlers;if(this.dragSnapToOrigin&&m&&m(),!(this.lastMoveEvent&&this.lastMoveEventInfo))return;const b=a2(f.type==="pointercancel"?this.lastMoveEventInfo:n2(p,this.transformPagePoint),this.history);this.startEvent&&h&&h(f,b),g&&g(f,b)},!XE(t))return;this.dragSnapToOrigin=i,this.handlers=r,this.transformPagePoint=n,this.contextWindow=a||window;const s=dm(t),o=n2(s,this.transformPagePoint),{point:l}=o,{timestamp:c}=Mn;this.history=[{...l,timestamp:c}];const{onSessionStart:u}=r;u&&u(t,a2(o,this.history)),this.removeListeners=Xo(Vs(this.contextWindow,"pointermove",this.handlePointerMove),Vs(this.contextWindow,"pointerup",this.handlePointerUp),Vs(this.contextWindow,"pointercancel",this.handlePointerUp))}updateHandlers(t){this.handlers=t}end(){this.removeListeners&&this.removeListeners(),Js(this.updatePoint)}}function n2(e,t){return t?{point:t(e.point)}:e}function nb(e,t){return{x:e.x-t.x,y:e.y-t.y}}function a2({point:e},t){return{point:e,delta:nb(e,O6(t)),offset:nb(e,JI(t)),velocity:QI(t,.1)}}function JI(e){return e[0]}function O6(e){return e[e.length-1]}function QI(e,t){if(e.length<2)return{x:0,y:0};let r=e.length-1,n=null;const a=O6(e);for(;r>=0&&(n=e[r],!(a.timestamp-n.timestamp>Hl(t)));)r--;if(!n)return{x:0,y:0};const i=$s(a.timestamp-n.timestamp);if(i===0)return{x:0,y:0};const s={x:(a.x-n.x)/i,y:(a.y-n.y)/i};return s.x===1/0&&(s.x=0),s.y===1/0&&(s.y=0),s}function Ma(e){return e.max-e.min}function Hv(e,t=0,r=.01){return Math.abs(e-t)<=r}function ab(e,t,r,n=.5){e.origin=n,e.originPoint=kr(t.min,t.max,e.origin),e.scale=Ma(r)/Ma(t),(Hv(e.scale,1,1e-4)||isNaN(e.scale))&&(e.scale=1),e.translate=kr(r.min,r.max,e.origin)-e.originPoint,(Hv(e.translate)||isNaN(e.translate))&&(e.translate=0)}function x0(e,t,r,n){ab(e.x,t.x,r.x,n?n.originX:void 0),ab(e.y,t.y,r.y,n?n.originY:void 0)}function ib(e,t,r){e.min=r.min+t.min,e.max=e.min+Ma(t)}function ZI(e,t,r){ib(e.x,t.x,r.x),ib(e.y,t.y,r.y)}function sb(e,t,r){e.min=t.min-r.min,e.max=e.min+Ma(t)}function y0(e,t,r){sb(e.x,t.x,r.x),sb(e.y,t.y,r.y)}function eR(e,{min:t,max:r},n){return t!==void 0&&e<t?e=n?kr(t,e,n.min):Math.max(e,t):r!==void 0&&e>r&&(e=n?kr(r,e,n.max):Math.min(e,r)),e}function ob(e,t,r){return{min:t!==void 0?e.min+t:void 0,max:r!==void 0?e.max+r-(e.max-e.min):void 0}}function tR(e,{top:t,left:r,bottom:n,right:a}){return{x:ob(e.x,r,a),y:ob(e.y,t,n)}}function lb(e,t){let r=t.min-e.min,n=t.max-e.max;return t.max-t.min<e.max-e.min&&([r,n]=[n,r]),{min:r,max:n}}function rR(e,t){return{x:lb(e.x,t.x),y:lb(e.y,t.y)}}function nR(e,t){let r=.5;const n=Ma(e),a=Ma(t);return a>n?r=Z0(t.min,t.max-n,e.min):n>a&&(r=Z0(e.min,e.max-a,t.min)),el(0,1,r)}function aR(e,t){const r={};return t.min!==void 0&&(r.min=t.min-e.min),t.max!==void 0&&(r.max=t.max-e.min),r}const Wv=.35;function iR(e=Wv){return e===!1?e=0:e===!0&&(e=Wv),{x:cb(e,"left","right"),y:cb(e,"top","bottom")}}function cb(e,t,r){return{min:ub(e,t),max:ub(e,r)}}function ub(e,t){return typeof e=="number"?e:e[t]||0}const fb=()=>({translate:0,scale:1,origin:0,originPoint:0}),hu=()=>({x:fb(),y:fb()}),hb=()=>({min:0,max:0}),Xr=()=>({x:hb(),y:hb()});function ti(e){return[e("x"),e("y")]}function D6({top:e,left:t,right:r,bottom:n}){return{x:{min:t,max:r},y:{min:e,max:n}}}function sR({x:e,y:t}){return{top:t.min,right:e.max,bottom:t.max,left:e.min}}function oR(e,t){if(!t)return e;const r=t({x:e.left,y:e.top}),n=t({x:e.right,y:e.bottom});return{top:r.y,left:r.x,bottom:n.y,right:n.x}}function i2(e){return e===void 0||e===1}function qv({scale:e,scaleX:t,scaleY:r}){return!i2(e)||!i2(t)||!i2(r)}function Cl(e){return qv(e)||I6(e)||e.z||e.rotate||e.rotateX||e.rotateY}function I6(e){return db(e.x)||db(e.y)}function db(e){return e&&e!=="0%"}function v1(e,t,r){const n=e-r,a=t*n;return r+a}function pb(e,t,r,n,a){return a!==void 0&&(e=v1(e,a,n)),v1(e,r,n)+t}function Gv(e,t=0,r=1,n,a){e.min=pb(e.min,t,r,n,a),e.max=pb(e.max,t,r,n,a)}function R6(e,{x:t,y:r}){Gv(e.x,t.translate,t.scale,t.originPoint),Gv(e.y,r.translate,r.scale,r.originPoint)}function lR(e,t,r,n=!1){const a=r.length;if(!a)return;t.x=t.y=1;let i,s;for(let o=0;o<a;o++){i=r[o],s=i.projectionDelta;const l=i.instance;l&&l.style&&l.style.display==="contents"||(n&&i.options.layoutScroll&&i.scroll&&i!==i.root&&du(e,{x:-i.scroll.offset.x,y:-i.scroll.offset.y}),s&&(t.x*=s.x.scale,t.y*=s.y.scale,R6(e,s)),n&&Cl(i.latestValues)&&du(e,i.latestValues))}t.x=mb(t.x),t.y=mb(t.y)}function mb(e){return Number.isInteger(e)||e>1.0000000000001||e<.999999999999?e:1}function Co(e,t){e.min=e.min+t,e.max=e.max+t}function gb(e,t,[r,n,a]){const i=t[a]!==void 0?t[a]:.5,s=kr(e.min,e.max,i);Gv(e,t[r],t[n],s,t.scale)}const cR=["x","scaleX","originX"],uR=["y","scaleY","originY"];function du(e,t){gb(e.x,t,cR),gb(e.y,t,uR)}function j6(e,t){return D6(oR(e.getBoundingClientRect(),t))}function fR(e,t,r){const n=j6(e,r),{scroll:a}=t;return a&&(Co(n.x,a.offset.x),Co(n.y,a.offset.y)),n}const M6=({current:e})=>e?e.ownerDocument.defaultView:null,hR=new WeakMap;class dR{constructor(t){this.openGlobalLock=null,this.isDragging=!1,this.currentDirection=null,this.originPoint={x:0,y:0},this.constraints=!1,this.hasMutatedConstraints=!1,this.elastic=Xr(),this.visualElement=t}start(t,{snapToCursor:r=!1}={}){const{presenceContext:n}=this.visualElement;if(n&&n.isPresent===!1)return;const a=u=>{const{dragSnapToOrigin:f}=this.getProps();f?this.pauseAnimation():this.stopAnimation(),r&&this.snapToCursor(dm(u,"page").point)},i=(u,f)=>{const{drag:p,dragPropagation:h,onDragStart:g}=this.getProps();if(p&&!h&&(this.openGlobalLock&&this.openGlobalLock(),this.openGlobalLock=JE(p),!this.openGlobalLock))return;this.isDragging=!0,this.currentDirection=null,this.resolveConstraints(),this.visualElement.projection&&(this.visualElement.projection.isAnimationBlocked=!0,this.visualElement.projection.target=void 0),ti(b=>{let x=this.getAxisMotionValue(b).get()||0;if(cs.test(x)){const{projection:w}=this.visualElement;if(w&&w.layout){const y=w.layout.layoutBox[b];y&&(x=Ma(y)*(parseFloat(x)/100))}}this.originPoint[b]=x}),g&&dr.update(()=>g(u,f),!1,!0);const{animationState:m}=this.visualElement;m&&m.setActive("whileDrag",!0)},s=(u,f)=>{const{dragPropagation:p,dragDirectionLock:h,onDirectionLock:g,onDrag:m}=this.getProps();if(!p&&!this.openGlobalLock)return;const{offset:b}=f;if(h&&this.currentDirection===null){this.currentDirection=pR(b),this.currentDirection!==null&&g&&g(this.currentDirection);return}this.updateAxis("x",f.point,b),this.updateAxis("y",f.point,b),this.visualElement.render(),m&&m(u,f)},o=(u,f)=>this.stop(u,f),l=()=>ti(u=>{var f;return this.getAnimationState(u)==="paused"&&((f=this.getAxisMotionValue(u).animation)===null||f===void 0?void 0:f.play())}),{dragSnapToOrigin:c}=this.getProps();this.panSession=new F6(t,{onSessionStart:a,onStart:i,onMove:s,onSessionEnd:o,resumeAnimation:l},{transformPagePoint:this.visualElement.getTransformPagePoint(),dragSnapToOrigin:c,contextWindow:M6(this.visualElement)})}stop(t,r){const n=this.isDragging;if(this.cancel(),!n)return;const{velocity:a}=r;this.startAnimation(a);const{onDragEnd:i}=this.getProps();i&&dr.update(()=>i(t,r))}cancel(){this.isDragging=!1;const{projection:t,animationState:r}=this.visualElement;t&&(t.isAnimationBlocked=!1),this.panSession&&this.panSession.end(),this.panSession=void 0;const{dragPropagation:n}=this.getProps();!n&&this.openGlobalLock&&(this.openGlobalLock(),this.openGlobalLock=null),r&&r.setActive("whileDrag",!1)}updateAxis(t,r,n){const{drag:a}=this.getProps();if(!n||!Jd(t,a,this.currentDirection))return;const i=this.getAxisMotionValue(t);let s=this.originPoint[t]+n[t];this.constraints&&this.constraints[t]&&(s=eR(s,this.constraints[t],this.elastic[t])),i.set(s)}resolveConstraints(){var t;const{dragConstraints:r,dragElastic:n}=this.getProps(),a=this.visualElement.projection&&!this.visualElement.projection.layout?this.visualElement.projection.measure(!1):(t=this.visualElement.projection)===null||t===void 0?void 0:t.layout,i=this.constraints;r&&uu(r)?this.constraints||(this.constraints=this.resolveRefConstraints()):r&&a?this.constraints=tR(a.layoutBox,r):this.constraints=!1,this.elastic=iR(n),i!==this.constraints&&a&&this.constraints&&!this.hasMutatedConstraints&&ti(s=>{this.getAxisMotionValue(s)&&(this.constraints[s]=aR(a.layoutBox[s],this.constraints[s]))})}resolveRefConstraints(){const{dragConstraints:t,onMeasureDragConstraints:r}=this.getProps();if(!t||!uu(t))return!1;const n=t.current,{projection:a}=this.visualElement;if(!a||!a.layout)return!1;const i=fR(n,a.root,this.visualElement.getTransformPagePoint());let s=rR(a.layout.layoutBox,i);if(r){const o=r(sR(s));this.hasMutatedConstraints=!!o,o&&(s=D6(o))}return s}startAnimation(t){const{drag:r,dragMomentum:n,dragElastic:a,dragTransition:i,dragSnapToOrigin:s,onDragTransitionEnd:o}=this.getProps(),l=this.constraints||{},c=ti(u=>{if(!Jd(u,r,this.currentDirection))return;let f=l&&l[u]||{};s&&(f={min:0,max:0});const p=a?200:1e6,h=a?40:1e7,g={type:"inertia",velocity:n?t[u]:0,bounceStiffness:p,bounceDamping:h,timeConstant:750,restDelta:1,restSpeed:10,...i,...f};return this.startAxisValueAnimation(u,g)});return Promise.all(c).then(o)}startAxisValueAnimation(t,r){const n=this.getAxisMotionValue(t);return n.start(Gy(t,n,0,r))}stopAnimation(){ti(t=>this.getAxisMotionValue(t).stop())}pauseAnimation(){ti(t=>{var r;return(r=this.getAxisMotionValue(t).animation)===null||r===void 0?void 0:r.pause()})}getAnimationState(t){var r;return(r=this.getAxisMotionValue(t).animation)===null||r===void 0?void 0:r.state}getAxisMotionValue(t){const r="_drag"+t.toUpperCase(),n=this.visualElement.getProps(),a=n[r];return a||this.visualElement.getValue(t,(n.initial?n.initial[t]:void 0)||0)}snapToCursor(t){ti(r=>{const{drag:n}=this.getProps();if(!Jd(r,n,this.currentDirection))return;const{projection:a}=this.visualElement,i=this.getAxisMotionValue(r);if(a&&a.layout){const{min:s,max:o}=a.layout.layoutBox[r];i.set(t[r]-kr(s,o,.5))}})}scalePositionWithinConstraints(){if(!this.visualElement.current)return;const{drag:t,dragConstraints:r}=this.getProps(),{projection:n}=this.visualElement;if(!uu(r)||!n||!this.constraints)return;this.stopAnimation();const a={x:0,y:0};ti(s=>{const o=this.getAxisMotionValue(s);if(o){const l=o.get();a[s]=nR({min:l,max:l},this.constraints[s])}});const{transformTemplate:i}=this.visualElement.getProps();this.visualElement.current.style.transform=i?i({},""):"none",n.root&&n.root.updateScroll(),n.updateLayout(),this.resolveConstraints(),ti(s=>{if(!Jd(s,t,null))return;const o=this.getAxisMotionValue(s),{min:l,max:c}=this.constraints[s];o.set(kr(l,c,a[s]))})}addListeners(){if(!this.visualElement.current)return;hR.set(this.visualElement,this);const t=this.visualElement.current,r=Vs(t,"pointerdown",l=>{const{drag:c,dragListener:u=!0}=this.getProps();c&&u&&this.start(l)}),n=()=>{const{dragConstraints:l}=this.getProps();uu(l)&&(this.constraints=this.resolveRefConstraints())},{projection:a}=this.visualElement,i=a.addEventListener("measure",n);a&&!a.layout&&(a.root&&a.root.updateScroll(),a.updateLayout()),n();const s=js(window,"resize",()=>this.scalePositionWithinConstraints()),o=a.addEventListener("didUpdate",({delta:l,hasLayoutChanged:c})=>{this.isDragging&&c&&(ti(u=>{const f=this.getAxisMotionValue(u);f&&(this.originPoint[u]+=l[u].translate,f.set(f.get()+l[u].translate))}),this.visualElement.render())});return()=>{s(),r(),i(),o&&o()}}getProps(){const t=this.visualElement.getProps(),{drag:r=!1,dragDirectionLock:n=!1,dragPropagation:a=!1,dragConstraints:i=!1,dragElastic:s=Wv,dragMomentum:o=!0}=t;return{...t,drag:r,dragDirectionLock:n,dragPropagation:a,dragConstraints:i,dragElastic:s,dragMomentum:o}}}function Jd(e,t,r){return(t===!0||t===e)&&(r===null||r===e)}function pR(e,t=10){let r=null;return Math.abs(e.y)>t?r="y":Math.abs(e.x)>t&&(r="x"),r}class mR extends fl{constructor(t){super(t),this.removeGroupControls=zr,this.removeListeners=zr,this.controls=new dR(t)}mount(){const{dragControls:t}=this.node.getProps();t&&(this.removeGroupControls=t.subscribe(this.controls)),this.removeListeners=this.controls.addListeners()||zr}unmount(){this.removeGroupControls(),this.removeListeners()}}const vb=e=>(t,r)=>{e&&dr.update(()=>e(t,r))};class gR extends fl{constructor(){super(...arguments),this.removePointerDownListener=zr}onPointerDown(t){this.session=new F6(t,this.createPanHandlers(),{transformPagePoint:this.node.getTransformPagePoint(),contextWindow:M6(this.node)})}createPanHandlers(){const{onPanSessionStart:t,onPanStart:r,onPan:n,onPanEnd:a}=this.node.getProps();return{onSessionStart:vb(t),onStart:vb(r),onMove:n,onEnd:(i,s)=>{delete this.session,a&&dr.update(()=>a(i,s))}}}mount(){this.removePointerDownListener=Vs(this.node.current,"pointerdown",t=>this.onPointerDown(t))}update(){this.session&&this.session.updateHandlers(this.createPanHandlers())}unmount(){this.removePointerDownListener(),this.session&&this.session.end()}}function vR(){const e=ie.useContext(lm);if(e===null)return[!0,null];const{isPresent:t,onExitComplete:r,register:n}=e,a=ie.useId();return ie.useEffect(()=>n(a),[]),!t&&r?[!1,()=>r&&r(a)]:[!0]}const Np={hasAnimatedSinceResize:!0,hasEverUpdated:!1};function xb(e,t){return t.max===t.min?0:e/(t.max-t.min)*100}const $f={correct:(e,t)=>{if(!t.target)return e;if(typeof e=="string")if(gt.test(e))e=parseFloat(e);else return e;const r=xb(e,t.target.x),n=xb(e,t.target.y);return`${r}% ${n}%`}},xR={correct:(e,{treeScale:t,projectionDelta:r})=>{const n=e,a=tl.parse(e);if(a.length>5)return n;const i=tl.createTransformer(e),s=typeof a[0]!="number"?1:0,o=r.x.scale*t.x,l=r.y.scale*t.y;a[0+s]/=o,a[1+s]/=l;const c=kr(o,l,.5);return typeof a[2+s]=="number"&&(a[2+s]/=c),typeof a[3+s]=="number"&&(a[3+s]/=c),i(a)}};class yR extends Fi.Component{componentDidMount(){const{visualElement:t,layoutGroup:r,switchLayoutGroup:n,layoutId:a}=this.props,{projection:i}=t;TO(wR),i&&(r.group&&r.group.add(i),n&&n.register&&a&&n.register(i),i.root.didUpdate(),i.addEventListener("animationComplete",()=>{this.safeToRemove()}),i.setOptions({...i.options,onExitComplete:()=>this.safeToRemove()})),Np.hasEverUpdated=!0}getSnapshotBeforeUpdate(t){const{layoutDependency:r,visualElement:n,drag:a,isPresent:i}=this.props,s=n.projection;return s&&(s.isPresent=i,a||t.layoutDependency!==r||r===void 0?s.willUpdate():this.safeToRemove(),t.isPresent!==i&&(i?s.promote():s.relegate()||dr.postRender(()=>{const o=s.getStack();(!o||!o.members.length)&&this.safeToRemove()}))),null}componentDidUpdate(){const{projection:t}=this.props.visualElement;t&&(t.root.didUpdate(),queueMicrotask(()=>{!t.currentAnimation&&t.isLead()&&this.safeToRemove()}))}componentWillUnmount(){const{visualElement:t,layoutGroup:r,switchLayoutGroup:n}=this.props,{projection:a}=t;a&&(a.scheduleCheckAfterUnmount(),r&&r.group&&r.group.remove(a),n&&n.deregister&&n.deregister(a))}safeToRemove(){const{safeToRemove:t}=this.props;t&&t()}render(){return null}}function B6(e){const[t,r]=vR(),n=ie.useContext(Dy);return Fi.createElement(yR,{...e,layoutGroup:n,switchLayoutGroup:ie.useContext(DE),isPresent:t,safeToRemove:r})}const wR={borderRadius:{...$f,applyTo:["borderTopLeftRadius","borderTopRightRadius","borderBottomLeftRadius","borderBottomRightRadius"]},borderTopLeftRadius:$f,borderTopRightRadius:$f,borderBottomLeftRadius:$f,borderBottomRightRadius:$f,boxShadow:xR},U6=["TopLeft","TopRight","BottomLeft","BottomRight"],bR=U6.length,yb=e=>typeof e=="string"?parseFloat(e):e,wb=e=>typeof e=="number"||gt.test(e);function _R(e,t,r,n,a,i){a?(e.opacity=kr(0,r.opacity!==void 0?r.opacity:1,SR(n)),e.opacityExit=kr(t.opacity!==void 0?t.opacity:1,0,kR(n))):i&&(e.opacity=kr(t.opacity!==void 0?t.opacity:1,r.opacity!==void 0?r.opacity:1,n));for(let s=0;s<bR;s++){const o=`border${U6[s]}Radius`;let l=bb(t,o),c=bb(r,o);if(l===void 0&&c===void 0)continue;l||(l=0),c||(c=0),l===0||c===0||wb(l)===wb(c)?(e[o]=Math.max(kr(yb(l),yb(c),n),0),(cs.test(c)||cs.test(l))&&(e[o]+="%")):e[o]=c}(t.rotate||r.rotate)&&(e.rotate=kr(t.rotate||0,r.rotate||0,n))}function bb(e,t){return e[t]!==void 0?e[t]:e.borderRadius}const SR=V6(0,.5,c6),kR=V6(.5,.95,zr);function V6(e,t,r){return n=>n<e?0:n>t?1:r(Z0(e,t,n))}function _b(e,t){e.min=t.min,e.max=t.max}function Qa(e,t){_b(e.x,t.x),_b(e.y,t.y)}function Sb(e,t,r,n,a){return e-=t,e=v1(e,1/r,n),a!==void 0&&(e=v1(e,1/a,n)),e}function ER(e,t=0,r=1,n=.5,a,i=e,s=e){if(cs.test(t)&&(t=parseFloat(t),t=kr(s.min,s.max,t/100)-s.min),typeof t!="number")return;let o=kr(i.min,i.max,n);e===i&&(o-=t),e.min=Sb(e.min,t,r,o,a),e.max=Sb(e.max,t,r,o,a)}function kb(e,t,[r,n,a],i,s){ER(e,t[r],t[n],t[a],t.scale,i,s)}const AR=["x","scaleX","originX"],TR=["y","scaleY","originY"];function Eb(e,t,r,n){kb(e.x,t,AR,r?r.x:void 0,n?n.x:void 0),kb(e.y,t,TR,r?r.y:void 0,n?n.y:void 0)}function Ab(e){return e.translate===0&&e.scale===1}function $6(e){return Ab(e.x)&&Ab(e.y)}function CR(e,t){return e.x.min===t.x.min&&e.x.max===t.x.max&&e.y.min===t.y.min&&e.y.max===t.y.max}function z6(e,t){return Math.round(e.x.min)===Math.round(t.x.min)&&Math.round(e.x.max)===Math.round(t.x.max)&&Math.round(e.y.min)===Math.round(t.y.min)&&Math.round(e.y.max)===Math.round(t.y.max)}function Tb(e){return Ma(e.x)/Ma(e.y)}class NR{constructor(){this.members=[]}add(t){Ky(this.members,t),t.scheduleRender()}remove(t){if(Xy(this.members,t),t===this.prevLead&&(this.prevLead=void 0),t===this.lead){const r=this.members[this.members.length-1];r&&this.promote(r)}}relegate(t){const r=this.members.findIndex(a=>t===a);if(r===0)return!1;let n;for(let a=r;a>=0;a--){const i=this.members[a];if(i.isPresent!==!1){n=i;break}}return n?(this.promote(n),!0):!1}promote(t,r){const n=this.lead;if(t!==n&&(this.prevLead=n,this.lead=t,t.show(),n)){n.instance&&n.scheduleRender(),t.scheduleRender(),t.resumeFrom=n,r&&(t.resumeFrom.preserveOpacity=!0),n.snapshot&&(t.snapshot=n.snapshot,t.snapshot.latestValues=n.animationValues||n.latestValues),t.root&&t.root.isUpdating&&(t.isLayoutDirty=!0);const{crossfade:a}=t.options;a===!1&&n.hide()}}exitAnimationComplete(){this.members.forEach(t=>{const{options:r,resumingFrom:n}=t;r.onExitComplete&&r.onExitComplete(),n&&n.options.onExitComplete&&n.options.onExitComplete()})}scheduleRender(){this.members.forEach(t=>{t.instance&&t.scheduleRender(!1)})}removeLeadSnapshot(){this.lead&&this.lead.snapshot&&(this.lead.snapshot=void 0)}}function Cb(e,t,r){let n="";const a=e.x.translate/t.x,i=e.y.translate/t.y;if((a||i)&&(n=`translate3d(${a}px, ${i}px, 0) `),(t.x!==1||t.y!==1)&&(n+=`scale(${1/t.x}, ${1/t.y}) `),r){const{rotate:l,rotateX:c,rotateY:u}=r;l&&(n+=`rotate(${l}deg) `),c&&(n+=`rotateX(${c}deg) `),u&&(n+=`rotateY(${u}deg) `)}const s=e.x.scale*t.x,o=e.y.scale*t.y;return(s!==1||o!==1)&&(n+=`scale(${s}, ${o})`),n||"none"}const PR=(e,t)=>e.depth-t.depth;class LR{constructor(){this.children=[],this.isDirty=!1}add(t){Ky(this.children,t),this.isDirty=!0}remove(t){Xy(this.children,t),this.isDirty=!0}forEach(t){this.isDirty&&this.children.sort(PR),this.isDirty=!1,this.children.forEach(t)}}function FR(e,t){const r=performance.now(),n=({timestamp:a})=>{const i=a-r;i>=t&&(Js(n),e(i-t))};return dr.read(n,!0),()=>Js(n)}function OR(e){window.MotionDebug&&window.MotionDebug.record(e)}function DR(e){return e instanceof SVGElement&&e.tagName!=="svg"}function IR(e,t,r){const n=_a(e)?e:Bu(e);return n.start(Gy("",n,t,r)),n.animation}const Nb=["","X","Y","Z"],RR={visibility:"hidden"},Pb=1e3;let jR=0;const Nl={type:"projectionFrame",totalNodes:0,resolvedTargetDeltas:0,recalculatedProjection:0};function H6({attachResizeListener:e,defaultParent:t,measureScroll:r,checkIsScrollRoot:n,resetTransform:a}){return class{constructor(s={},o=t==null?void 0:t()){this.id=jR++,this.animationId=0,this.children=new Set,this.options={},this.isTreeAnimating=!1,this.isAnimationBlocked=!1,this.isLayoutDirty=!1,this.isProjectionDirty=!1,this.isSharedProjectionDirty=!1,this.isTransformDirty=!1,this.updateManuallyBlocked=!1,this.updateBlockedByResize=!1,this.isUpdating=!1,this.isSVG=!1,this.needsReset=!1,this.shouldResetTransform=!1,this.treeScale={x:1,y:1},this.eventHandlers=new Map,this.hasTreeAnimated=!1,this.updateScheduled=!1,this.projectionUpdateScheduled=!1,this.checkUpdateFailed=()=>{this.isUpdating&&(this.isUpdating=!1,this.clearAllSnapshots())},this.updateProjection=()=>{this.projectionUpdateScheduled=!1,Nl.totalNodes=Nl.resolvedTargetDeltas=Nl.recalculatedProjection=0,this.nodes.forEach(UR),this.nodes.forEach(WR),this.nodes.forEach(qR),this.nodes.forEach(VR),OR(Nl)},this.hasProjected=!1,this.isVisible=!0,this.animationProgress=0,this.sharedNodes=new Map,this.latestValues=s,this.root=o?o.root||o:this,this.path=o?[...o.path,o]:[],this.parent=o,this.depth=o?o.depth+1:0;for(let l=0;l<this.path.length;l++)this.path[l].shouldResetTransform=!0;this.root===this&&(this.nodes=new LR)}addEventListener(s,o){return this.eventHandlers.has(s)||this.eventHandlers.set(s,new Yy),this.eventHandlers.get(s).add(o)}notifyListeners(s,...o){const l=this.eventHandlers.get(s);l&&l.notify(...o)}hasListeners(s){return this.eventHandlers.has(s)}mount(s,o=this.root.hasTreeAnimated){if(this.instance)return;this.isSVG=DR(s),this.instance=s;const{layoutId:l,layout:c,visualElement:u}=this.options;if(u&&!u.current&&u.mount(s),this.root.nodes.add(this),this.parent&&this.parent.children.add(this),o&&(c||l)&&(this.isLayoutDirty=!0),e){let f;const p=()=>this.root.updateBlockedByResize=!1;e(s,()=>{this.root.updateBlockedByResize=!0,f&&f(),f=FR(p,250),Np.hasAnimatedSinceResize&&(Np.hasAnimatedSinceResize=!1,this.nodes.forEach(Fb))})}l&&this.root.registerSharedNode(l,this),this.options.animate!==!1&&u&&(l||c)&&this.addEventListener("didUpdate",({delta:f,hasLayoutChanged:p,hasRelativeTargetChanged:h,layout:g})=>{if(this.isTreeAnimationBlocked()){this.target=void 0,this.relativeTarget=void 0;return}const m=this.options.transition||u.getDefaultTransition()||JR,{onLayoutAnimationStart:b,onLayoutAnimationComplete:x}=u.getProps(),w=!this.targetLayout||!z6(this.targetLayout,g)||h,y=!p&&h;if(this.options.layoutRoot||this.resumeFrom&&this.resumeFrom.instance||y||p&&(w||!this.currentAnimation)){this.resumeFrom&&(this.resumingFrom=this.resumeFrom,this.resumingFrom.resumingFrom=void 0),this.setAnimationOrigin(f,y);const A={...qy(m,"layout"),onPlay:b,onComplete:x};(u.shouldReduceMotion||this.options.layoutRoot)&&(A.delay=0,A.type=!1),this.startAnimation(A)}else p||Fb(this),this.isLead()&&this.options.onExitComplete&&this.options.onExitComplete();this.targetLayout=g})}unmount(){this.options.layoutId&&this.willUpdate(),this.root.nodes.remove(this);const s=this.getStack();s&&s.remove(this),this.parent&&this.parent.children.delete(this),this.instance=void 0,Js(this.updateProjection)}blockUpdate(){this.updateManuallyBlocked=!0}unblockUpdate(){this.updateManuallyBlocked=!1}isUpdateBlocked(){return this.updateManuallyBlocked||this.updateBlockedByResize}isTreeAnimationBlocked(){return this.isAnimationBlocked||this.parent&&this.parent.isTreeAnimationBlocked()||!1}startUpdate(){this.isUpdateBlocked()||(this.isUpdating=!0,this.nodes&&this.nodes.forEach(GR),this.animationId++)}getTransformTemplate(){const{visualElement:s}=this.options;return s&&s.getProps().transformTemplate}willUpdate(s=!0){if(this.root.hasTreeAnimated=!0,this.root.isUpdateBlocked()){this.options.onExitComplete&&this.options.onExitComplete();return}if(!this.root.isUpdating&&this.root.startUpdate(),this.isLayoutDirty)return;this.isLayoutDirty=!0;for(let u=0;u<this.path.length;u++){const f=this.path[u];f.shouldResetTransform=!0,f.updateScroll("snapshot"),f.options.layoutRoot&&f.willUpdate(!1)}const{layoutId:o,layout:l}=this.options;if(o===void 0&&!l)return;const c=this.getTransformTemplate();this.prevTransformTemplateValue=c?c(this.latestValues,""):void 0,this.updateSnapshot(),s&&this.notifyListeners("willUpdate")}update(){if(this.updateScheduled=!1,this.isUpdateBlocked()){this.unblockUpdate(),this.clearAllSnapshots(),this.nodes.forEach(Lb);return}this.isUpdating||this.nodes.forEach(zR),this.isUpdating=!1,this.nodes.forEach(HR),this.nodes.forEach(MR),this.nodes.forEach(BR),this.clearAllSnapshots();const o=performance.now();Mn.delta=el(0,1e3/60,o-Mn.timestamp),Mn.timestamp=o,Mn.isProcessing=!0,Xg.update.process(Mn),Xg.preRender.process(Mn),Xg.render.process(Mn),Mn.isProcessing=!1}didUpdate(){this.updateScheduled||(this.updateScheduled=!0,queueMicrotask(()=>this.update()))}clearAllSnapshots(){this.nodes.forEach($R),this.sharedNodes.forEach(KR)}scheduleUpdateProjection(){this.projectionUpdateScheduled||(this.projectionUpdateScheduled=!0,dr.preRender(this.updateProjection,!1,!0))}scheduleCheckAfterUnmount(){dr.postRender(()=>{this.isLayoutDirty?this.root.didUpdate():this.root.checkUpdateFailed()})}updateSnapshot(){this.snapshot||!this.instance||(this.snapshot=this.measure())}updateLayout(){if(!this.instance||(this.updateScroll(),!(this.options.alwaysMeasureLayout&&this.isLead())&&!this.isLayoutDirty))return;if(this.resumeFrom&&!this.resumeFrom.instance)for(let l=0;l<this.path.length;l++)this.path[l].updateScroll();const s=this.layout;this.layout=this.measure(!1),this.layoutCorrected=Xr(),this.isLayoutDirty=!1,this.projectionDelta=void 0,this.notifyListeners("measure",this.layout.layoutBox);const{visualElement:o}=this.options;o&&o.notify("LayoutMeasure",this.layout.layoutBox,s?s.layoutBox:void 0)}updateScroll(s="measure"){let o=!!(this.options.layoutScroll&&this.instance);this.scroll&&this.scroll.animationId===this.root.animationId&&this.scroll.phase===s&&(o=!1),o&&(this.scroll={animationId:this.root.animationId,phase:s,isRoot:n(this.instance),offset:r(this.instance)})}resetTransform(){if(!a)return;const s=this.isLayoutDirty||this.shouldResetTransform,o=this.projectionDelta&&!$6(this.projectionDelta),l=this.getTransformTemplate(),c=l?l(this.latestValues,""):void 0,u=c!==this.prevTransformTemplateValue;s&&(o||Cl(this.latestValues)||u)&&(a(this.instance,c),this.shouldResetTransform=!1,this.scheduleRender())}measure(s=!0){const o=this.measurePageBox();let l=this.removeElementScroll(o);return s&&(l=this.removeTransform(l)),QR(l),{animationId:this.root.animationId,measuredBox:o,layoutBox:l,latestValues:{},source:this.id}}measurePageBox(){const{visualElement:s}=this.options;if(!s)return Xr();const o=s.measureViewportBox(),{scroll:l}=this.root;return l&&(Co(o.x,l.offset.x),Co(o.y,l.offset.y)),o}removeElementScroll(s){const o=Xr();Qa(o,s);for(let l=0;l<this.path.length;l++){const c=this.path[l],{scroll:u,options:f}=c;if(c!==this.root&&u&&f.layoutScroll){if(u.isRoot){Qa(o,s);const{scroll:p}=this.root;p&&(Co(o.x,-p.offset.x),Co(o.y,-p.offset.y))}Co(o.x,u.offset.x),Co(o.y,u.offset.y)}}return o}applyTransform(s,o=!1){const l=Xr();Qa(l,s);for(let c=0;c<this.path.length;c++){const u=this.path[c];!o&&u.options.layoutScroll&&u.scroll&&u!==u.root&&du(l,{x:-u.scroll.offset.x,y:-u.scroll.offset.y}),Cl(u.latestValues)&&du(l,u.latestValues)}return Cl(this.latestValues)&&du(l,this.latestValues),l}removeTransform(s){const o=Xr();Qa(o,s);for(let l=0;l<this.path.length;l++){const c=this.path[l];if(!c.instance||!Cl(c.latestValues))continue;qv(c.latestValues)&&c.updateSnapshot();const u=Xr(),f=c.measurePageBox();Qa(u,f),Eb(o,c.latestValues,c.snapshot?c.snapshot.layoutBox:void 0,u)}return Cl(this.latestValues)&&Eb(o,this.latestValues),o}setTargetDelta(s){this.targetDelta=s,this.root.scheduleUpdateProjection(),this.isProjectionDirty=!0}setOptions(s){this.options={...this.options,...s,crossfade:s.crossfade!==void 0?s.crossfade:!0}}clearMeasurements(){this.scroll=void 0,this.layout=void 0,this.snapshot=void 0,this.prevTransformTemplateValue=void 0,this.targetDelta=void 0,this.target=void 0,this.isLayoutDirty=!1}forceRelativeParentToResolveTarget(){this.relativeParent&&this.relativeParent.resolvedRelativeTargetAt!==Mn.timestamp&&this.relativeParent.resolveTargetDelta(!0)}resolveTargetDelta(s=!1){var o;const l=this.getLead();this.isProjectionDirty||(this.isProjectionDirty=l.isProjectionDirty),this.isTransformDirty||(this.isTransformDirty=l.isTransformDirty),this.isSharedProjectionDirty||(this.isSharedProjectionDirty=l.isSharedProjectionDirty);const c=!!this.resumingFrom||this!==l;if(!(s||c&&this.isSharedProjectionDirty||this.isProjectionDirty||!((o=this.parent)===null||o===void 0)&&o.isProjectionDirty||this.attemptToResolveRelativeTarget))return;const{layout:f,layoutId:p}=this.options;if(!(!this.layout||!(f||p))){if(this.resolvedRelativeTargetAt=Mn.timestamp,!this.targetDelta&&!this.relativeTarget){const h=this.getClosestProjectingParent();h&&h.layout&&this.animationProgress!==1?(this.relativeParent=h,this.forceRelativeParentToResolveTarget(),this.relativeTarget=Xr(),this.relativeTargetOrigin=Xr(),y0(this.relativeTargetOrigin,this.layout.layoutBox,h.layout.layoutBox),Qa(this.relativeTarget,this.relativeTargetOrigin)):this.relativeParent=this.relativeTarget=void 0}if(!(!this.relativeTarget&&!this.targetDelta)){if(this.target||(this.target=Xr(),this.targetWithTransforms=Xr()),this.relativeTarget&&this.relativeTargetOrigin&&this.relativeParent&&this.relativeParent.target?(this.forceRelativeParentToResolveTarget(),ZI(this.target,this.relativeTarget,this.relativeParent.target)):this.targetDelta?(this.resumingFrom?this.target=this.applyTransform(this.layout.layoutBox):Qa(this.target,this.layout.layoutBox),R6(this.target,this.targetDelta)):Qa(this.target,this.layout.layoutBox),this.attemptToResolveRelativeTarget){this.attemptToResolveRelativeTarget=!1;const h=this.getClosestProjectingParent();h&&!!h.resumingFrom==!!this.resumingFrom&&!h.options.layoutScroll&&h.target&&this.animationProgress!==1?(this.relativeParent=h,this.forceRelativeParentToResolveTarget(),this.relativeTarget=Xr(),this.relativeTargetOrigin=Xr(),y0(this.relativeTargetOrigin,this.target,h.target),Qa(this.relativeTarget,this.relativeTargetOrigin)):this.relativeParent=this.relativeTarget=void 0}Nl.resolvedTargetDeltas++}}}getClosestProjectingParent(){if(!(!this.parent||qv(this.parent.latestValues)||I6(this.parent.latestValues)))return this.parent.isProjecting()?this.parent:this.parent.getClosestProjectingParent()}isProjecting(){return!!((this.relativeTarget||this.targetDelta||this.options.layoutRoot)&&this.layout)}calcProjection(){var s;const o=this.getLead(),l=!!this.resumingFrom||this!==o;let c=!0;if((this.isProjectionDirty||!((s=this.parent)===null||s===void 0)&&s.isProjectionDirty)&&(c=!1),l&&(this.isSharedProjectionDirty||this.isTransformDirty)&&(c=!1),this.resolvedRelativeTargetAt===Mn.timestamp&&(c=!1),c)return;const{layout:u,layoutId:f}=this.options;if(this.isTreeAnimating=!!(this.parent&&this.parent.isTreeAnimating||this.currentAnimation||this.pendingAnimation),this.isTreeAnimating||(this.targetDelta=this.relativeTarget=void 0),!this.layout||!(u||f))return;Qa(this.layoutCorrected,this.layout.layoutBox);const p=this.treeScale.x,h=this.treeScale.y;lR(this.layoutCorrected,this.treeScale,this.path,l),o.layout&&!o.target&&(this.treeScale.x!==1||this.treeScale.y!==1)&&(o.target=o.layout.layoutBox);const{target:g}=o;if(!g){this.projectionTransform&&(this.projectionDelta=hu(),this.projectionTransform="none",this.scheduleRender());return}this.projectionDelta||(this.projectionDelta=hu(),this.projectionDeltaWithTransform=hu());const m=this.projectionTransform;x0(this.projectionDelta,this.layoutCorrected,g,this.latestValues),this.projectionTransform=Cb(this.projectionDelta,this.treeScale),(this.projectionTransform!==m||this.treeScale.x!==p||this.treeScale.y!==h)&&(this.hasProjected=!0,this.scheduleRender(),this.notifyListeners("projectionUpdate",g)),Nl.recalculatedProjection++}hide(){this.isVisible=!1}show(){this.isVisible=!0}scheduleRender(s=!0){if(this.options.scheduleRender&&this.options.scheduleRender(),s){const o=this.getStack();o&&o.scheduleRender()}this.resumingFrom&&!this.resumingFrom.instance&&(this.resumingFrom=void 0)}setAnimationOrigin(s,o=!1){const l=this.snapshot,c=l?l.latestValues:{},u={...this.latestValues},f=hu();(!this.relativeParent||!this.relativeParent.options.layoutRoot)&&(this.relativeTarget=this.relativeTargetOrigin=void 0),this.attemptToResolveRelativeTarget=!o;const p=Xr(),h=l?l.source:void 0,g=this.layout?this.layout.source:void 0,m=h!==g,b=this.getStack(),x=!b||b.members.length<=1,w=!!(m&&!x&&this.options.crossfade===!0&&!this.path.some(YR));this.animationProgress=0;let y;this.mixTargetDelta=A=>{const L=A/1e3;Ob(f.x,s.x,L),Ob(f.y,s.y,L),this.setTargetDelta(f),this.relativeTarget&&this.relativeTargetOrigin&&this.layout&&this.relativeParent&&this.relativeParent.layout&&(y0(p,this.layout.layoutBox,this.relativeParent.layout.layoutBox),XR(this.relativeTarget,this.relativeTargetOrigin,p,L),y&&CR(this.relativeTarget,y)&&(this.isProjectionDirty=!1),y||(y=Xr()),Qa(y,this.relativeTarget)),m&&(this.animationValues=u,_R(u,c,this.latestValues,L,w,x)),this.root.scheduleUpdateProjection(),this.scheduleRender(),this.animationProgress=L},this.mixTargetDelta(this.options.layoutRoot?1e3:0)}startAnimation(s){this.notifyListeners("animationStart"),this.currentAnimation&&this.currentAnimation.stop(),this.resumingFrom&&this.resumingFrom.currentAnimation&&this.resumingFrom.currentAnimation.stop(),this.pendingAnimation&&(Js(this.pendingAnimation),this.pendingAnimation=void 0),this.pendingAnimation=dr.update(()=>{Np.hasAnimatedSinceResize=!0,this.currentAnimation=IR(0,Pb,{...s,onUpdate:o=>{this.mixTargetDelta(o),s.onUpdate&&s.onUpdate(o)},onComplete:()=>{s.onComplete&&s.onComplete(),this.completeAnimation()}}),this.resumingFrom&&(this.resumingFrom.currentAnimation=this.currentAnimation),this.pendingAnimation=void 0})}completeAnimation(){this.resumingFrom&&(this.resumingFrom.currentAnimation=void 0,this.resumingFrom.preserveOpacity=void 0);const s=this.getStack();s&&s.exitAnimationComplete(),this.resumingFrom=this.currentAnimation=this.animationValues=void 0,this.notifyListeners("animationComplete")}finishAnimation(){this.currentAnimation&&(this.mixTargetDelta&&this.mixTargetDelta(Pb),this.currentAnimation.stop()),this.completeAnimation()}applyTransformsToTarget(){const s=this.getLead();let{targetWithTransforms:o,target:l,layout:c,latestValues:u}=s;if(!(!o||!l||!c)){if(this!==s&&this.layout&&c&&W6(this.options.animationType,this.layout.layoutBox,c.layoutBox)){l=this.target||Xr();const f=Ma(this.layout.layoutBox.x);l.x.min=s.target.x.min,l.x.max=l.x.min+f;const p=Ma(this.layout.layoutBox.y);l.y.min=s.target.y.min,l.y.max=l.y.min+p}Qa(o,l),du(o,u),x0(this.projectionDeltaWithTransform,this.layoutCorrected,o,u)}}registerSharedNode(s,o){this.sharedNodes.has(s)||this.sharedNodes.set(s,new NR),this.sharedNodes.get(s).add(o);const c=o.options.initialPromotionConfig;o.promote({transition:c?c.transition:void 0,preserveFollowOpacity:c&&c.shouldPreserveFollowOpacity?c.shouldPreserveFollowOpacity(o):void 0})}isLead(){const s=this.getStack();return s?s.lead===this:!0}getLead(){var s;const{layoutId:o}=this.options;return o?((s=this.getStack())===null||s===void 0?void 0:s.lead)||this:this}getPrevLead(){var s;const{layoutId:o}=this.options;return o?(s=this.getStack())===null||s===void 0?void 0:s.prevLead:void 0}getStack(){const{layoutId:s}=this.options;if(s)return this.root.sharedNodes.get(s)}promote({needsReset:s,transition:o,preserveFollowOpacity:l}={}){const c=this.getStack();c&&c.promote(this,l),s&&(this.projectionDelta=void 0,this.needsReset=!0),o&&this.setOptions({transition:o})}relegate(){const s=this.getStack();return s?s.relegate(this):!1}resetRotation(){const{visualElement:s}=this.options;if(!s)return;let o=!1;const{latestValues:l}=s;if((l.rotate||l.rotateX||l.rotateY||l.rotateZ)&&(o=!0),!o)return;const c={};for(let u=0;u<Nb.length;u++){const f="rotate"+Nb[u];l[f]&&(c[f]=l[f],s.setStaticValue(f,0))}s.render();for(const u in c)s.setStaticValue(u,c[u]);s.scheduleRender()}getProjectionStyles(s){var o,l;if(!this.instance||this.isSVG)return;if(!this.isVisible)return RR;const c={visibility:""},u=this.getTransformTemplate();if(this.needsReset)return this.needsReset=!1,c.opacity="",c.pointerEvents=Cp(s==null?void 0:s.pointerEvents)||"",c.transform=u?u(this.latestValues,""):"none",c;const f=this.getLead();if(!this.projectionDelta||!this.layout||!f.target){const m={};return this.options.layoutId&&(m.opacity=this.latestValues.opacity!==void 0?this.latestValues.opacity:1,m.pointerEvents=Cp(s==null?void 0:s.pointerEvents)||""),this.hasProjected&&!Cl(this.latestValues)&&(m.transform=u?u({},""):"none",this.hasProjected=!1),m}const p=f.animationValues||f.latestValues;this.applyTransformsToTarget(),c.transform=Cb(this.projectionDeltaWithTransform,this.treeScale,p),u&&(c.transform=u(p,c.transform));const{x:h,y:g}=this.projectionDelta;c.transformOrigin=`${h.origin*100}% ${g.origin*100}% 0`,f.animationValues?c.opacity=f===this?(l=(o=p.opacity)!==null&&o!==void 0?o:this.latestValues.opacity)!==null&&l!==void 0?l:1:this.preserveOpacity?this.latestValues.opacity:p.opacityExit:c.opacity=f===this?p.opacity!==void 0?p.opacity:"":p.opacityExit!==void 0?p.opacityExit:0;for(const m in c1){if(p[m]===void 0)continue;const{correct:b,applyTo:x}=c1[m],w=c.transform==="none"?p[m]:b(p[m],f);if(x){const y=x.length;for(let A=0;A<y;A++)c[x[A]]=w}else c[m]=w}return this.options.layoutId&&(c.pointerEvents=f===this?Cp(s==null?void 0:s.pointerEvents)||"":"none"),c}clearSnapshot(){this.resumeFrom=this.snapshot=void 0}resetTree(){this.root.nodes.forEach(s=>{var o;return(o=s.currentAnimation)===null||o===void 0?void 0:o.stop()}),this.root.nodes.forEach(Lb),this.root.sharedNodes.clear()}}}function MR(e){e.updateLayout()}function BR(e){var t;const r=((t=e.resumeFrom)===null||t===void 0?void 0:t.snapshot)||e.snapshot;if(e.isLead()&&e.layout&&r&&e.hasListeners("didUpdate")){const{layoutBox:n,measuredBox:a}=e.layout,{animationType:i}=e.options,s=r.source!==e.layout.source;i==="size"?ti(f=>{const p=s?r.measuredBox[f]:r.layoutBox[f],h=Ma(p);p.min=n[f].min,p.max=p.min+h}):W6(i,r.layoutBox,n)&&ti(f=>{const p=s?r.measuredBox[f]:r.layoutBox[f],h=Ma(n[f]);p.max=p.min+h,e.relativeTarget&&!e.currentAnimation&&(e.isProjectionDirty=!0,e.relativeTarget[f].max=e.relativeTarget[f].min+h)});const o=hu();x0(o,n,r.layoutBox);const l=hu();s?x0(l,e.applyTransform(a,!0),r.measuredBox):x0(l,n,r.layoutBox);const c=!$6(o);let u=!1;if(!e.resumeFrom){const f=e.getClosestProjectingParent();if(f&&!f.resumeFrom){const{snapshot:p,layout:h}=f;if(p&&h){const g=Xr();y0(g,r.layoutBox,p.layoutBox);const m=Xr();y0(m,n,h.layoutBox),z6(g,m)||(u=!0),f.options.layoutRoot&&(e.relativeTarget=m,e.relativeTargetOrigin=g,e.relativeParent=f)}}}e.notifyListeners("didUpdate",{layout:n,snapshot:r,delta:l,layoutDelta:o,hasLayoutChanged:c,hasRelativeTargetChanged:u})}else if(e.isLead()){const{onExitComplete:n}=e.options;n&&n()}e.options.transition=void 0}function UR(e){Nl.totalNodes++,e.parent&&(e.isProjecting()||(e.isProjectionDirty=e.parent.isProjectionDirty),e.isSharedProjectionDirty||(e.isSharedProjectionDirty=!!(e.isProjectionDirty||e.parent.isProjectionDirty||e.parent.isSharedProjectionDirty)),e.isTransformDirty||(e.isTransformDirty=e.parent.isTransformDirty))}function VR(e){e.isProjectionDirty=e.isSharedProjectionDirty=e.isTransformDirty=!1}function $R(e){e.clearSnapshot()}function Lb(e){e.clearMeasurements()}function zR(e){e.isLayoutDirty=!1}function HR(e){const{visualElement:t}=e.options;t&&t.getProps().onBeforeLayoutMeasure&&t.notify("BeforeLayoutMeasure"),e.resetTransform()}function Fb(e){e.finishAnimation(),e.targetDelta=e.relativeTarget=e.target=void 0,e.isProjectionDirty=!0}function WR(e){e.resolveTargetDelta()}function qR(e){e.calcProjection()}function GR(e){e.resetRotation()}function KR(e){e.removeLeadSnapshot()}function Ob(e,t,r){e.translate=kr(t.translate,0,r),e.scale=kr(t.scale,1,r),e.origin=t.origin,e.originPoint=t.originPoint}function Db(e,t,r,n){e.min=kr(t.min,r.min,n),e.max=kr(t.max,r.max,n)}function XR(e,t,r,n){Db(e.x,t.x,r.x,n),Db(e.y,t.y,r.y,n)}function YR(e){return e.animationValues&&e.animationValues.opacityExit!==void 0}const JR={duration:.45,ease:[.4,0,.1,1]},Ib=e=>typeof navigator<"u"&&navigator.userAgent.toLowerCase().includes(e),Rb=Ib("applewebkit/")&&!Ib("chrome/")?Math.round:zr;function jb(e){e.min=Rb(e.min),e.max=Rb(e.max)}function QR(e){jb(e.x),jb(e.y)}function W6(e,t,r){return e==="position"||e==="preserve-aspect"&&!Hv(Tb(t),Tb(r),.2)}const ZR=H6({attachResizeListener:(e,t)=>js(e,"resize",t),measureScroll:()=>({x:document.documentElement.scrollLeft||document.body.scrollLeft,y:document.documentElement.scrollTop||document.body.scrollTop}),checkIsScrollRoot:()=>!0}),s2={current:void 0},q6=H6({measureScroll:e=>({x:e.scrollLeft,y:e.scrollTop}),defaultParent:()=>{if(!s2.current){const e=new ZR({});e.mount(window),e.setOptions({layoutScroll:!0}),s2.current=e}return s2.current},resetTransform:(e,t)=>{e.style.transform=t!==void 0?t:"none"},checkIsScrollRoot:e=>window.getComputedStyle(e).position==="fixed"}),ej={pan:{Feature:gR},drag:{Feature:mR,ProjectionNode:q6,MeasureLayout:B6}},tj=/var\((--[a-zA-Z0-9-_]+),? ?([a-zA-Z0-9 ()%#.,-]+)?\)/;function rj(e){const t=tj.exec(e);if(!t)return[,];const[,r,n]=t;return[r,n]}function Kv(e,t,r=1){const[n,a]=rj(e);if(!n)return;const i=window.getComputedStyle(t).getPropertyValue(n);if(i){const s=i.trim();return C6(s)?parseFloat(s):s}else return jv(a)?Kv(a,t,r+1):a}function nj(e,{...t},r){const n=e.current;if(!(n instanceof Element))return{target:t,transitionEnd:r};r&&(r={...r}),e.values.forEach(a=>{const i=a.get();if(!jv(i))return;const s=Kv(i,n);s&&a.set(s)});for(const a in t){const i=t[a];if(!jv(i))continue;const s=Kv(i,n);s&&(t[a]=s,r||(r={}),r[a]===void 0&&(r[a]=i))}return{target:t,transitionEnd:r}}const aj=new Set(["width","height","top","left","right","bottom","x","y","translateX","translateY"]),G6=e=>aj.has(e),ij=e=>Object.keys(e).some(G6),Mb=e=>e===cc||e===gt,Bb=(e,t)=>parseFloat(e.split(", ")[t]),Ub=(e,t)=>(r,{transform:n})=>{if(n==="none"||!n)return 0;const a=n.match(/^matrix3d\((.+)\)$/);if(a)return Bb(a[1],t);{const i=n.match(/^matrix\((.+)\)$/);return i?Bb(i[1],e):0}},sj=new Set(["x","y","z"]),oj=bh.filter(e=>!sj.has(e));function lj(e){const t=[];return oj.forEach(r=>{const n=e.getValue(r);n!==void 0&&(t.push([r,n.get()]),n.set(r.startsWith("scale")?1:0))}),t.length&&e.render(),t}const Uu={width:({x:e},{paddingLeft:t="0",paddingRight:r="0"})=>e.max-e.min-parseFloat(t)-parseFloat(r),height:({y:e},{paddingTop:t="0",paddingBottom:r="0"})=>e.max-e.min-parseFloat(t)-parseFloat(r),top:(e,{top:t})=>parseFloat(t),left:(e,{left:t})=>parseFloat(t),bottom:({y:e},{top:t})=>parseFloat(t)+(e.max-e.min),right:({x:e},{left:t})=>parseFloat(t)+(e.max-e.min),x:Ub(4,13),y:Ub(5,14)};Uu.translateX=Uu.x;Uu.translateY=Uu.y;const cj=(e,t,r)=>{const n=t.measureViewportBox(),a=t.current,i=getComputedStyle(a),{display:s}=i,o={};s==="none"&&t.setStaticValue("display",e.display||"block"),r.forEach(c=>{o[c]=Uu[c](n,i)}),t.render();const l=t.measureViewportBox();return r.forEach(c=>{const u=t.getValue(c);u&&u.jump(o[c]),e[c]=Uu[c](l,i)}),e},uj=(e,t,r={},n={})=>{t={...t},n={...n};const a=Object.keys(t).filter(G6);let i=[],s=!1;const o=[];if(a.forEach(l=>{const c=e.getValue(l);if(!e.hasValue(l))return;let u=r[l],f=Vf(u);const p=t[l];let h;if(f1(p)){const g=p.length,m=p[0]===null?1:0;u=p[m],f=Vf(u);for(let b=m;b<g&&p[b]!==null;b++)h?h1(Vf(p[b])===h):h=Vf(p[b])}else h=Vf(p);if(f!==h)if(Mb(f)&&Mb(h)){const g=c.get();typeof g=="string"&&c.set(parseFloat(g)),typeof p=="string"?t[l]=parseFloat(p):Array.isArray(p)&&h===gt&&(t[l]=p.map(parseFloat))}else f!=null&&f.transform&&(h!=null&&h.transform)&&(u===0||p===0)?u===0?c.set(h.transform(u)):t[l]=f.transform(p):(s||(i=lj(e),s=!0),o.push(l),n[l]=n[l]!==void 0?n[l]:t[l],c.jump(p))}),o.length){const l=o.indexOf("height")>=0?window.pageYOffset:null,c=cj(t,e,o);return i.length&&i.forEach(([u,f])=>{e.getValue(u).set(f)}),e.render(),cm&&l!==null&&window.scrollTo({top:l}),{target:c,transitionEnd:n}}else return{target:t,transitionEnd:n}};function fj(e,t,r,n){return ij(t)?uj(e,t,r,n):{target:t,transitionEnd:n}}const hj=(e,t,r,n)=>{const a=nj(e,t,n);return t=a.target,n=a.transitionEnd,fj(e,t,r,n)},Xv={current:null},K6={current:!1};function dj(){if(K6.current=!0,!!cm)if(window.matchMedia){const e=window.matchMedia("(prefers-reduced-motion)"),t=()=>Xv.current=e.matches;e.addListener(t),t()}else Xv.current=!1}function pj(e,t,r){const{willChange:n}=t;for(const a in t){const i=t[a],s=r[a];if(_a(i))e.addValue(a,i),g1(n)&&n.add(a);else if(_a(s))e.addValue(a,Bu(i,{owner:e})),g1(n)&&n.remove(a);else if(s!==i)if(e.hasValue(a)){const o=e.getValue(a);!o.hasAnimated&&o.set(i)}else{const o=e.getStaticValue(a);e.addValue(a,Bu(o!==void 0?o:i,{owner:e}))}}for(const a in r)t[a]===void 0&&e.removeValue(a);return t}const Vb=new WeakMap,X6=Object.keys(Q0),mj=X6.length,$b=["AnimationStart","AnimationComplete","Update","BeforeLayoutMeasure","LayoutMeasure","LayoutAnimationStart","LayoutAnimationComplete"],gj=Oy.length;class vj{constructor({parent:t,props:r,presenceContext:n,reducedMotionConfig:a,visualState:i},s={}){this.current=null,this.children=new Set,this.isVariantNode=!1,this.isControllingVariants=!1,this.shouldReduceMotion=null,this.values=new Map,this.features={},this.valueSubscriptions=new Map,this.prevMotionValues={},this.events={},this.propEventSubscriptions={},this.notifyUpdate=()=>this.notify("Update",this.latestValues),this.render=()=>{this.current&&(this.triggerBuild(),this.renderInstance(this.current,this.renderState,this.props.style,this.projection))},this.scheduleRender=()=>dr.render(this.render,!1,!0);const{latestValues:o,renderState:l}=i;this.latestValues=o,this.baseTarget={...o},this.initialValues=r.initial?{...o}:{},this.renderState=l,this.parent=t,this.props=r,this.presenceContext=n,this.depth=t?t.depth+1:0,this.reducedMotionConfig=a,this.options=s,this.isControllingVariants=fm(r),this.isVariantNode=OE(r),this.isVariantNode&&(this.variantChildren=new Set),this.manuallyAnimateOnMount=!!(t&&t.current);const{willChange:c,...u}=this.scrapeMotionValuesFromProps(r,{});for(const f in u){const p=u[f];o[f]!==void 0&&_a(p)&&(p.set(o[f],!1),g1(c)&&c.add(f))}}scrapeMotionValuesFromProps(t,r){return{}}mount(t){this.current=t,Vb.set(t,this),this.projection&&!this.projection.instance&&this.projection.mount(t),this.parent&&this.isVariantNode&&!this.isControllingVariants&&(this.removeFromVariantTree=this.parent.addVariantChild(this)),this.values.forEach((r,n)=>this.bindToMotionValue(n,r)),K6.current||dj(),this.shouldReduceMotion=this.reducedMotionConfig==="never"?!1:this.reducedMotionConfig==="always"?!0:Xv.current,this.parent&&this.parent.children.add(this),this.update(this.props,this.presenceContext)}unmount(){Vb.delete(this.current),this.projection&&this.projection.unmount(),Js(this.notifyUpdate),Js(this.render),this.valueSubscriptions.forEach(t=>t()),this.removeFromVariantTree&&this.removeFromVariantTree(),this.parent&&this.parent.children.delete(this);for(const t in this.events)this.events[t].clear();for(const t in this.features)this.features[t].unmount();this.current=null}bindToMotionValue(t,r){const n=lc.has(t),a=r.on("change",s=>{this.latestValues[t]=s,this.props.onUpdate&&dr.update(this.notifyUpdate,!1,!0),n&&this.projection&&(this.projection.isTransformDirty=!0)}),i=r.on("renderRequest",this.scheduleRender);this.valueSubscriptions.set(t,()=>{a(),i()})}sortNodePosition(t){return!this.current||!this.sortInstanceNodePosition||this.type!==t.type?0:this.sortInstanceNodePosition(this.current,t.current)}loadFeatures({children:t,...r},n,a,i){let s,o;for(let l=0;l<mj;l++){const c=X6[l],{isEnabled:u,Feature:f,ProjectionNode:p,MeasureLayout:h}=Q0[c];p&&(s=p),u(r)&&(!this.features[c]&&f&&(this.features[c]=new f(this)),h&&(o=h))}if((this.type==="html"||this.type==="svg")&&!this.projection&&s){this.projection=new s(this.latestValues,this.parent&&this.parent.projection);const{layoutId:l,layout:c,drag:u,dragConstraints:f,layoutScroll:p,layoutRoot:h}=r;this.projection.setOptions({layoutId:l,layout:c,alwaysMeasureLayout:!!u||f&&uu(f),visualElement:this,scheduleRender:()=>this.scheduleRender(),animationType:typeof c=="string"?c:"both",initialPromotionConfig:i,layoutScroll:p,layoutRoot:h})}return o}updateFeatures(){for(const t in this.features){const r=this.features[t];r.isMounted?r.update():(r.mount(),r.isMounted=!0)}}triggerBuild(){this.build(this.renderState,this.latestValues,this.options,this.props)}measureViewportBox(){return this.current?this.measureInstanceViewportBox(this.current,this.props):Xr()}getStaticValue(t){return this.latestValues[t]}setStaticValue(t,r){this.latestValues[t]=r}makeTargetAnimatable(t,r=!0){return this.makeTargetAnimatableFromInstance(t,this.props,r)}update(t,r){(t.transformTemplate||this.props.transformTemplate)&&this.scheduleRender(),this.prevProps=this.props,this.props=t,this.prevPresenceContext=this.presenceContext,this.presenceContext=r;for(let n=0;n<$b.length;n++){const a=$b[n];this.propEventSubscriptions[a]&&(this.propEventSubscriptions[a](),delete this.propEventSubscriptions[a]);const i=t["on"+a];i&&(this.propEventSubscriptions[a]=this.on(a,i))}this.prevMotionValues=pj(this,this.scrapeMotionValuesFromProps(t,this.prevProps),this.prevMotionValues),this.handleChildMotionValue&&this.handleChildMotionValue()}getProps(){return this.props}getVariant(t){return this.props.variants?this.props.variants[t]:void 0}getDefaultTransition(){return this.props.transition}getTransformPagePoint(){return this.props.transformPagePoint}getClosestVariantNode(){return this.isVariantNode?this:this.parent?this.parent.getClosestVariantNode():void 0}getVariantContext(t=!1){if(t)return this.parent?this.parent.getVariantContext():void 0;if(!this.isControllingVariants){const n=this.parent?this.parent.getVariantContext()||{}:{};return this.props.initial!==void 0&&(n.initial=this.props.initial),n}const r={};for(let n=0;n<gj;n++){const a=Oy[n],i=this.props[a];(J0(i)||i===!1)&&(r[a]=i)}return r}addVariantChild(t){const r=this.getClosestVariantNode();if(r)return r.variantChildren&&r.variantChildren.add(t),()=>r.variantChildren.delete(t)}addValue(t,r){r!==this.values.get(t)&&(this.removeValue(t),this.bindToMotionValue(t,r)),this.values.set(t,r),this.latestValues[t]=r.get()}removeValue(t){this.values.delete(t);const r=this.valueSubscriptions.get(t);r&&(r(),this.valueSubscriptions.delete(t)),delete this.latestValues[t],this.removeValueFromRenderState(t,this.renderState)}hasValue(t){return this.values.has(t)}getValue(t,r){if(this.props.values&&this.props.values[t])return this.props.values[t];let n=this.values.get(t);return n===void 0&&r!==void 0&&(n=Bu(r,{owner:this}),this.addValue(t,n)),n}readValue(t){var r;return this.latestValues[t]!==void 0||!this.current?this.latestValues[t]:(r=this.getBaseTargetFromProps(this.props,t))!==null&&r!==void 0?r:this.readValueFromInstance(this.current,t,this.options)}setBaseTarget(t,r){this.baseTarget[t]=r}getBaseTarget(t){var r;const{initial:n}=this.props,a=typeof n=="string"||typeof n=="object"?(r=Vy(this.props,n))===null||r===void 0?void 0:r[t]:void 0;if(n&&a!==void 0)return a;const i=this.getBaseTargetFromProps(this.props,t);return i!==void 0&&!_a(i)?i:this.initialValues[t]!==void 0&&a===void 0?void 0:this.baseTarget[t]}on(t,r){return this.events[t]||(this.events[t]=new Yy),this.events[t].add(r)}notify(t,...r){this.events[t]&&this.events[t].notify(...r)}}class Y6 extends vj{sortInstanceNodePosition(t,r){return t.compareDocumentPosition(r)&2?1:-1}getBaseTargetFromProps(t,r){return t.style?t.style[r]:void 0}removeValueFromRenderState(t,{vars:r,style:n}){delete r[t],delete n[t]}makeTargetAnimatableFromInstance({transition:t,transitionEnd:r,...n},{transformValues:a},i){let s=DI(n,t||{},this);if(a&&(r&&(r=a(r)),n&&(n=a(n)),s&&(s=a(s))),i){FI(this,n,s);const o=hj(this,n,s,r);r=o.transitionEnd,n=o.target}return{transition:t,transitionEnd:r,...n}}}function xj(e){return window.getComputedStyle(e)}class yj extends Y6{constructor(){super(...arguments),this.type="html"}readValueFromInstance(t,r){if(lc.has(r)){const n=Wy(r);return n&&n.default||0}else{const n=xj(t),a=(jE(r)?n.getPropertyValue(r):n[r])||0;return typeof a=="string"?a.trim():a}}measureInstanceViewportBox(t,{transformPagePoint:r}){return j6(t,r)}build(t,r,n,a){Ry(t,r,n,a.transformTemplate)}scrapeMotionValuesFromProps(t,r){return Uy(t,r)}handleChildMotionValue(){this.childSubscription&&(this.childSubscription(),delete this.childSubscription);const{children:t}=this.props;_a(t)&&(this.childSubscription=t.on("change",r=>{this.current&&(this.current.textContent=`${r}`)}))}renderInstance(t,r,n,a){zE(t,r,n,a)}}class wj extends Y6{constructor(){super(...arguments),this.type="svg",this.isSVGTag=!1}getBaseTargetFromProps(t,r){return t[r]}readValueFromInstance(t,r){if(lc.has(r)){const n=Wy(r);return n&&n.default||0}return r=HE.has(r)?r:Ly(r),t.getAttribute(r)}measureInstanceViewportBox(){return Xr()}scrapeMotionValuesFromProps(t,r){return qE(t,r)}build(t,r,n,a){My(t,r,n,this.isSVGTag,a.transformTemplate)}renderInstance(t,r,n,a){WE(t,r,n,a)}mount(t){this.isSVGTag=By(t.tagName),super.mount(t)}}const bj=(e,t)=>Iy(e)?new wj(t,{enableHardwareAcceleration:!1}):new yj(t,{enableHardwareAcceleration:!0}),_j={layout:{ProjectionNode:q6,MeasureLayout:B6}},Sj={...XI,...gD,...ej,..._j},er=EO((e,t)=>nD(e,t,Sj,bj));function J6(){const e=ie.useRef(!1);return Py(()=>(e.current=!0,()=>{e.current=!1}),[]),e}function kj(){const e=J6(),[t,r]=ie.useState(0),n=ie.useCallback(()=>{e.current&&r(t+1)},[t]);return[ie.useCallback(()=>dr.postRender(n),[n]),t]}class Ej extends ie.Component{getSnapshotBeforeUpdate(t){const r=this.props.childRef.current;if(r&&t.isPresent&&!this.props.isPresent){const n=this.props.sizeRef.current;n.height=r.offsetHeight||0,n.width=r.offsetWidth||0,n.top=r.offsetTop,n.left=r.offsetLeft}return null}componentDidUpdate(){}render(){return this.props.children}}function Aj({children:e,isPresent:t}){const r=ie.useId(),n=ie.useRef(null),a=ie.useRef({width:0,height:0,top:0,left:0});return ie.useInsertionEffect(()=>{const{width:i,height:s,top:o,left:l}=a.current;if(t||!n.current||!i||!s)return;n.current.dataset.motionPopId=r;const c=document.createElement("style");return document.head.appendChild(c),c.sheet&&c.sheet.insertRule(`
          [data-motion-pop-id="${r}"] {
            position: absolute !important;
            width: ${i}px !important;
            height: ${s}px !important;
            top: ${o}px !important;
            left: ${l}px !important;
          }
        `),()=>{document.head.removeChild(c)}},[t]),ie.createElement(Ej,{isPresent:t,childRef:n,sizeRef:a},ie.cloneElement(e,{ref:n}))}const o2=({children:e,initial:t,isPresent:r,onExitComplete:n,custom:a,presenceAffectsLayout:i,mode:s})=>{const o=GE(Tj),l=ie.useId(),c=ie.useMemo(()=>({id:l,initial:t,isPresent:r,custom:a,onExitComplete:u=>{o.set(u,!0);for(const f of o.values())if(!f)return;n&&n()},register:u=>(o.set(u,!1),()=>o.delete(u))}),i?void 0:[r]);return ie.useMemo(()=>{o.forEach((u,f)=>o.set(f,!1))},[r]),ie.useEffect(()=>{!r&&!o.size&&n&&n()},[r]),s==="popLayout"&&(e=ie.createElement(Aj,{isPresent:r},e)),ie.createElement(lm.Provider,{value:c},e)};function Tj(){return new Map}function Cj(e){return ie.useEffect(()=>()=>e(),[])}const Pl=e=>e.key||"";function Nj(e,t){e.forEach(r=>{const n=Pl(r);t.set(n,r)})}function Pj(e){const t=[];return ie.Children.forEach(e,r=>{ie.isValidElement(r)&&t.push(r)}),t}const mm=({children:e,custom:t,initial:r=!0,onExitComplete:n,exitBeforeEnter:a,presenceAffectsLayout:i=!0,mode:s="sync"})=>{const o=ie.useContext(Dy).forceRender||kj()[0],l=J6(),c=Pj(e);let u=c;const f=ie.useRef(new Map).current,p=ie.useRef(u),h=ie.useRef(new Map).current,g=ie.useRef(!0);if(Py(()=>{g.current=!1,Nj(c,h),p.current=u}),Cj(()=>{g.current=!0,h.clear(),f.clear()}),g.current)return ie.createElement(ie.Fragment,null,u.map(w=>ie.createElement(o2,{key:Pl(w),isPresent:!0,initial:r?void 0:!1,presenceAffectsLayout:i,mode:s},w)));u=[...u];const m=p.current.map(Pl),b=c.map(Pl),x=m.length;for(let w=0;w<x;w++){const y=m[w];b.indexOf(y)===-1&&!f.has(y)&&f.set(y,void 0)}return s==="wait"&&f.size&&(u=[]),f.forEach((w,y)=>{if(b.indexOf(y)!==-1)return;const A=h.get(y);if(!A)return;const L=m.indexOf(y);let D=w;if(!D){const T=()=>{f.delete(y);const F=Array.from(h.keys()).filter(R=>!b.includes(R));if(F.forEach(R=>h.delete(R)),p.current=c.filter(R=>{const X=Pl(R);return X===y||F.includes(X)}),!f.size){if(l.current===!1)return;o(),n&&n()}};D=ie.createElement(o2,{key:Pl(A),isPresent:!1,onExitComplete:T,custom:t,presenceAffectsLayout:i,mode:s},A),f.set(y,D)}u.splice(L,0,D)}),u=u.map(w=>{const y=w.key;return f.has(y)?w:ie.createElement(o2,{key:Pl(w),isPresent:!0,presenceAffectsLayout:i,mode:s},w)}),ie.createElement(ie.Fragment,null,f.size?u:u.map(w=>ie.cloneElement(w)))};/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */var Lj={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Fj=e=>e.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase().trim(),Yt=(e,t)=>{const r=ie.forwardRef(({color:n="currentColor",size:a=24,strokeWidth:i=2,absoluteStrokeWidth:s,className:o="",children:l,...c},u)=>ie.createElement("svg",{ref:u,...Lj,width:a,height:a,stroke:n,strokeWidth:s?Number(i)*24/Number(a):i,className:["lucide",`lucide-${Fj(e)}`,o].join(" "),...c},[...t.map(([f,p])=>ie.createElement(f,p)),...Array.isArray(l)?l:[l]]));return r.displayName=`${e}`,r};/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const gm=Yt("AlertTriangle",[["path",{d:"m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3Z",key:"c3ski4"}],["path",{d:"M12 9v4",key:"juzpu7"}],["path",{d:"M12 17h.01",key:"p32p05"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Oj=Yt("BarChart3",[["path",{d:"M3 3v18h18",key:"1s2lah"}],["path",{d:"M18 17V9",key:"2bz60n"}],["path",{d:"M13 17V5",key:"1frdt8"}],["path",{d:"M8 17v-3",key:"17ska0"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Dj=Yt("Bell",[["path",{d:"M6 8a6 6 0 0 1 12 0c0 7 3 9 3 9H3s3-2 3-9",key:"1qo2s2"}],["path",{d:"M10.3 21a1.94 1.94 0 0 0 3.4 0",key:"qgo35s"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Q6=Yt("Calendar",[["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M16 2v4",key:"4m81vk"}],["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",key:"1hopcy"}],["path",{d:"M3 10h18",key:"8toen8"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Qd=Yt("CheckCircle",[["path",{d:"M22 11.08V12a10 10 0 1 1-5.93-9.14",key:"g774vq"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const zb=Yt("Database",[["ellipse",{cx:"12",cy:"5",rx:"9",ry:"3",key:"msslwz"}],["path",{d:"M3 5V19A9 3 0 0 0 21 19V5",key:"1wlel7"}],["path",{d:"M3 12A9 3 0 0 0 21 12",key:"mv7ke4"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Z6=Yt("DollarSign",[["line",{x1:"12",x2:"12",y1:"2",y2:"22",key:"7eqyqh"}],["path",{d:"M17 5H9.5a3.5 3.5 0 0 0 0 7h5a3.5 3.5 0 0 1 0 7H6",key:"1b0p4s"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const is=Yt("FileDown",[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"M12 18v-6",key:"17g6i2"}],["path",{d:"m9 15 3 3 3-3",key:"1npd3o"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ij=Yt("FileText",[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"M10 9H8",key:"b1mrlr"}],["path",{d:"M16 13H8",key:"t4e002"}],["path",{d:"M16 17H8",key:"z1uh3a"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Rj=Yt("Home",[["path",{d:"m3 9 9-7 9 7v11a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z",key:"y5dka4"}],["polyline",{points:"9 22 9 12 15 12 15 22",key:"e2us08"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Hb=Yt("KeyRound",[["path",{d:"M2 18v3c0 .6.4 1 1 1h4v-3h3v-3h2l1.4-1.4a6.5 6.5 0 1 0-4-4Z",key:"167ctg"}],["circle",{cx:"16.5",cy:"7.5",r:".5",fill:"currentColor",key:"w0ekpg"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const eA=Yt("Layers",[["path",{d:"m12.83 2.18a2 2 0 0 0-1.66 0L2.6 6.08a1 1 0 0 0 0 1.83l8.58 3.91a2 2 0 0 0 1.66 0l8.58-3.9a1 1 0 0 0 0-1.83Z",key:"8b97xw"}],["path",{d:"m22 17.65-9.17 4.16a2 2 0 0 1-1.66 0L2 17.65",key:"dd6zsq"}],["path",{d:"m22 12.65-9.17 4.16a2 2 0 0 1-1.66 0L2 12.65",key:"ep9fru"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const jj=Yt("Lock",[["rect",{width:"18",height:"11",x:"3",y:"11",rx:"2",ry:"2",key:"1w4ew1"}],["path",{d:"M7 11V7a5 5 0 0 1 10 0v4",key:"fwvmzm"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Mj=Yt("LogIn",[["path",{d:"M15 3h4a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2h-4",key:"u53s6r"}],["polyline",{points:"10 17 15 12 10 7",key:"1ail0h"}],["line",{x1:"15",x2:"3",y1:"12",y2:"12",key:"v6grx8"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Bj=Yt("LogOut",[["path",{d:"M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4",key:"1uf3rs"}],["polyline",{points:"16 17 21 12 16 7",key:"1gabdz"}],["line",{x1:"21",x2:"9",y1:"12",y2:"12",key:"1uyos4"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Jy=Yt("Package",[["path",{d:"m7.5 4.27 9 5.15",key:"1c824w"}],["path",{d:"M21 8a2 2 0 0 0-1-1.73l-7-4a2 2 0 0 0-2 0l-7 4A2 2 0 0 0 3 8v8a2 2 0 0 0 1 1.73l7 4a2 2 0 0 0 2 0l7-4A2 2 0 0 0 21 16Z",key:"hh9hay"}],["path",{d:"m3.3 7 8.7 5 8.7-5",key:"g66t2b"}],["path",{d:"M12 22V12",key:"d0xqtd"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const tA=Yt("Pencil",[["path",{d:"M17 3a2.85 2.83 0 1 1 4 4L7.5 20.5 2 22l1.5-5.5Z",key:"5qss01"}],["path",{d:"m15 5 4 4",key:"1mk7zo"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const rA=Yt("Plus",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const eh=Yt("Printer",[["polyline",{points:"6 9 6 2 18 2 18 9",key:"1306q4"}],["path",{d:"M6 18H4a2 2 0 0 1-2-2v-5a2 2 0 0 1 2-2h16a2 2 0 0 1 2 2v5a2 2 0 0 1-2 2h-2",key:"143wyd"}],["rect",{width:"12",height:"8",x:"6",y:"14",key:"5ipwut"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Uj=Yt("RefreshCw",[["path",{d:"M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8",key:"v9h5vc"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}],["path",{d:"M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16",key:"3uifl3"}],["path",{d:"M8 16H3v5",key:"1cv678"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Qy=Yt("Save",[["path",{d:"M19 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h11l5 5v11a2 2 0 0 1-2 2z",key:"1owoqh"}],["polyline",{points:"17 21 17 13 7 13 7 21",key:"1md35c"}],["polyline",{points:"7 3 7 8 15 8",key:"8nz8an"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const nA=Yt("Search",[["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}],["path",{d:"m21 21-4.3-4.3",key:"1qie3q"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Vj=Yt("SquarePen",[["path",{d:"M12 3H5a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7",key:"1m0v6g"}],["path",{d:"M18.375 2.625a2.121 2.121 0 1 1 3 3L12 15l-4 1 1-4Z",key:"1lpok0"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const $j=Yt("Trash2",[["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6",key:"4alrt4"}],["path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2",key:"v07s0e"}],["line",{x1:"10",x2:"10",y1:"11",y2:"17",key:"1uufr5"}],["line",{x1:"14",x2:"14",y1:"11",y2:"17",key:"xtxkd"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const aA=Yt("Trash",[["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6",key:"4alrt4"}],["path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2",key:"v07s0e"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Yv=Yt("TrendingUp",[["polyline",{points:"22 7 13.5 15.5 8.5 10.5 2 17",key:"126l90"}],["polyline",{points:"16 7 22 7 22 13",key:"kwv8wd"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const zj=Yt("Upload",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"17 8 12 3 7 8",key:"t8dd8p"}],["line",{x1:"12",x2:"12",y1:"3",y2:"15",key:"widbto"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Hj=Yt("User",[["path",{d:"M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2",key:"975kel"}],["circle",{cx:"12",cy:"7",r:"4",key:"17ys0d"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const l2=Yt("XCircle",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m15 9-6 6",key:"1uzhvr"}],["path",{d:"m9 9 6 6",key:"z0biqf"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Eh=Yt("X",[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]]),vm=()=>{const e=ie.useContext(Ny);if(e===void 0)throw new Error("useAuth must be used within an AuthProvider");return e},Wj=()=>{const[e,t]=ie.useState(""),[r,n]=ie.useState(""),[a,i]=ie.useState(!1),{login:s,isAuthenticated:o}=vm(),l=ie.useRef(o);ie.useEffect(()=>{l.current&&!o&&(t(""),n("")),l.current=o},[o]);const c=async u=>{if(u.preventDefault(),!e||!r){ft.error("Por favor complete todos los campos");return}i(!0);try{await s(e,r)||ft.error("Usuario o contrasea incorrectos")}catch{ft.error("Error al iniciar sesin")}finally{i(!1)}};return _.jsx("div",{className:"min-h-screen bg-gradient-to-br from-blue-50 via-white to-blue-100 flex items-center justify-center p-4",children:_.jsxs(er.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.6},className:"max-w-md w-full space-y-8",children:[_.jsxs("div",{className:"text-center",children:[_.jsx(er.div,{initial:{scale:0},animate:{scale:1},transition:{delay:.2,type:"spring",stiffness:260,damping:20},className:"mx-auto h-20 w-20 bg-gradient-to-r from-blue-600 to-blue-800 rounded-full flex items-center justify-center shadow-xl mb-6",children:_.jsx(eA,{className:"h-10 w-10 text-white"})}),_.jsxs(er.div,{initial:{opacity:0},animate:{opacity:1},transition:{delay:.4},children:[_.jsx("h1",{className:"text-3xl font-bold text-blue-900 mb-1",children:"Alcalda Municipal de Cabaas Oeste"}),_.jsx("p",{className:"text-base text-gray-700 mb-2",children:"Unidad de Informtica"}),_.jsx("h2",{className:"text-xl font-semibold text-gray-900 mb-2",children:"Sistema de Control de Inventario"})]})]}),_.jsx(er.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.6},className:"bg-white py-8 px-6 shadow-xl rounded-xl border border-gray-100",children:_.jsxs("form",{className:"space-y-6",onSubmit:c,autoComplete:"off",children:[_.jsx("input",{type:"text",name:"fakeusernameremembered",style:{display:"none"},autoComplete:"username"}),_.jsx("input",{type:"password",name:"fakepasswordremembered",style:{display:"none"},autoComplete:"current-password"}),_.jsxs("div",{children:[_.jsx("label",{htmlFor:"username",className:"block text-sm font-medium text-gray-700 mb-2",children:"Nombre de Usuario"}),_.jsxs("div",{className:"relative",children:[_.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:_.jsx(Hj,{className:"h-5 w-5 text-gray-400"})}),_.jsx("input",{id:"username",name:"login_user",type:"text",autoComplete:"new-username",required:!0,value:e,onChange:u=>t(u.target.value),className:"block w-full pl-10 pr-3 py-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 text-sm transition-colors",placeholder:"Ingrese su nombre de usuario"})]})]}),_.jsxs("div",{children:[_.jsx("label",{htmlFor:"password",className:"block text-sm font-medium text-gray-700 mb-2",children:"Contrasea"}),_.jsxs("div",{className:"relative",children:[_.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:_.jsx(jj,{className:"h-5 w-5 text-gray-400"})}),_.jsx("input",{id:"password",name:"login_pass",type:"password",autoComplete:"new-password",required:!0,value:r,onChange:u=>n(u.target.value),className:"block w-full pl-10 pr-3 py-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 text-sm transition-colors",placeholder:"Ingrese su contrasea"})]})]}),_.jsx("div",{children:_.jsxs("button",{type:"submit",disabled:a,className:"group relative w-full flex justify-center py-3 px-4 border border-transparent text-sm font-medium rounded-lg text-white bg-gradient-to-r from-blue-600 to-blue-700 hover:from-blue-700 hover:to-blue-800 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 transition-all duration-200 shadow-lg hover:shadow-xl disabled:opacity-50 disabled:cursor-not-allowed",children:[_.jsx("span",{className:"absolute left-0 inset-y-0 flex items-center pl-3",children:a?_.jsx("div",{className:"animate-spin rounded-full h-5 w-5 border-b-2 border-blue-300"}):_.jsx(Mj,{className:"h-5 w-5 text-blue-300 group-hover:text-blue-200"})}),a?"Iniciando...":"Iniciar Sesin"]})})]})}),_.jsxs(er.div,{initial:{opacity:0},animate:{opacity:1},transition:{delay:.8},className:"text-center text-xs text-gray-500",children:[_.jsx("p",{children:" 2025 Alcalda Municipal de Cabaas Oeste"}),_.jsx("p",{children:"Sistema desarrollado por la Unidad de Informtica"})]})]})})};var Zy={};Object.defineProperty(Zy,"__esModule",{value:!0});Zy.parse=Qj;Zy.serialize=Zj;const qj=/^[\u0021-\u003A\u003C\u003E-\u007E]+$/,Gj=/^[\u0021-\u003A\u003C-\u007E]*$/,Kj=/^([.]?[a-z0-9]([a-z0-9-]{0,61}[a-z0-9])?)([.][a-z0-9]([a-z0-9-]{0,61}[a-z0-9])?)*$/i,Xj=/^[\u0020-\u003A\u003D-\u007E]*$/,Yj=Object.prototype.toString,Jj=(()=>{const e=function(){};return e.prototype=Object.create(null),e})();function Qj(e,t){const r=new Jj,n=e.length;if(n<2)return r;const a=(t==null?void 0:t.decode)||e9;let i=0;do{const s=e.indexOf("=",i);if(s===-1)break;const o=e.indexOf(";",i),l=o===-1?n:o;if(s>l){i=e.lastIndexOf(";",s-1)+1;continue}const c=Wb(e,i,s),u=qb(e,s,c),f=e.slice(c,u);if(r[f]===void 0){let p=Wb(e,s+1,l),h=qb(e,l,p);const g=a(e.slice(p,h));r[f]=g}i=l+1}while(i<n);return r}function Wb(e,t,r){do{const n=e.charCodeAt(t);if(n!==32&&n!==9)return t}while(++t<r);return r}function qb(e,t,r){for(;t>r;){const n=e.charCodeAt(--t);if(n!==32&&n!==9)return t+1}return r}function Zj(e,t,r){const n=(r==null?void 0:r.encode)||encodeURIComponent;if(!qj.test(e))throw new TypeError(`argument name is invalid: ${e}`);const a=n(t);if(!Gj.test(a))throw new TypeError(`argument val is invalid: ${t}`);let i=e+"="+a;if(!r)return i;if(r.maxAge!==void 0){if(!Number.isInteger(r.maxAge))throw new TypeError(`option maxAge is invalid: ${r.maxAge}`);i+="; Max-Age="+r.maxAge}if(r.domain){if(!Kj.test(r.domain))throw new TypeError(`option domain is invalid: ${r.domain}`);i+="; Domain="+r.domain}if(r.path){if(!Xj.test(r.path))throw new TypeError(`option path is invalid: ${r.path}`);i+="; Path="+r.path}if(r.expires){if(!t9(r.expires)||!Number.isFinite(r.expires.valueOf()))throw new TypeError(`option expires is invalid: ${r.expires}`);i+="; Expires="+r.expires.toUTCString()}if(r.httpOnly&&(i+="; HttpOnly"),r.secure&&(i+="; Secure"),r.partitioned&&(i+="; Partitioned"),r.priority)switch(typeof r.priority=="string"?r.priority.toLowerCase():void 0){case"low":i+="; Priority=Low";break;case"medium":i+="; Priority=Medium";break;case"high":i+="; Priority=High";break;default:throw new TypeError(`option priority is invalid: ${r.priority}`)}if(r.sameSite)switch(typeof r.sameSite=="string"?r.sameSite.toLowerCase():r.sameSite){case!0:case"strict":i+="; SameSite=Strict";break;case"lax":i+="; SameSite=Lax";break;case"none":i+="; SameSite=None";break;default:throw new TypeError(`option sameSite is invalid: ${r.sameSite}`)}return i}function e9(e){if(e.indexOf("%")===-1)return e;try{return decodeURIComponent(e)}catch{return e}}function t9(e){return Yj.call(e)==="[object Date]"}var Gb="popstate";function r9(e={}){function t(n,a){let{pathname:i,search:s,hash:o}=n.location;return Jv("",{pathname:i,search:s,hash:o},a.state&&a.state.usr||null,a.state&&a.state.key||"default")}function r(n,a){return typeof a=="string"?a:th(a)}return a9(t,r,null,e)}function on(e,t){if(e===!1||e===null||typeof e>"u")throw new Error(t)}function fs(e,t){if(!e){typeof console<"u"&&console.warn(t);try{throw new Error(t)}catch{}}}function n9(){return Math.random().toString(36).substring(2,10)}function Kb(e,t){return{usr:e.state,key:e.key,idx:t}}function Jv(e,t,r=null,n){return{pathname:typeof e=="string"?e:e.pathname,search:"",hash:"",...typeof t=="string"?Ah(t):t,state:r,key:t&&t.key||n||n9()}}function th({pathname:e="/",search:t="",hash:r=""}){return t&&t!=="?"&&(e+=t.charAt(0)==="?"?t:"?"+t),r&&r!=="#"&&(e+=r.charAt(0)==="#"?r:"#"+r),e}function Ah(e){let t={};if(e){let r=e.indexOf("#");r>=0&&(t.hash=e.substring(r),e=e.substring(0,r));let n=e.indexOf("?");n>=0&&(t.search=e.substring(n),e=e.substring(0,n)),e&&(t.pathname=e)}return t}function a9(e,t,r,n={}){let{window:a=document.defaultView,v5Compat:i=!1}=n,s=a.history,o="POP",l=null,c=u();c==null&&(c=0,s.replaceState({...s.state,idx:c},""));function u(){return(s.state||{idx:null}).idx}function f(){o="POP";let b=u(),x=b==null?null:b-c;c=b,l&&l({action:o,location:m.location,delta:x})}function p(b,x){o="PUSH";let w=Jv(m.location,b,x);c=u()+1;let y=Kb(w,c),A=m.createHref(w);try{s.pushState(y,"",A)}catch(L){if(L instanceof DOMException&&L.name==="DataCloneError")throw L;a.location.assign(A)}i&&l&&l({action:o,location:m.location,delta:1})}function h(b,x){o="REPLACE";let w=Jv(m.location,b,x);c=u();let y=Kb(w,c),A=m.createHref(w);s.replaceState(y,"",A),i&&l&&l({action:o,location:m.location,delta:0})}function g(b){return i9(b)}let m={get action(){return o},get location(){return e(a,s)},listen(b){if(l)throw new Error("A history only accepts one active listener");return a.addEventListener(Gb,f),l=b,()=>{a.removeEventListener(Gb,f),l=null}},createHref(b){return t(a,b)},createURL:g,encodeLocation(b){let x=g(b);return{pathname:x.pathname,search:x.search,hash:x.hash}},push:p,replace:h,go(b){return s.go(b)}};return m}function i9(e,t=!1){let r="http://localhost";typeof window<"u"&&(r=window.location.origin!=="null"?window.location.origin:window.location.href),on(r,"No window.location.(origin|href) available to create URL");let n=typeof e=="string"?e:th(e);return n=n.replace(/ $/,"%20"),!t&&n.startsWith("//")&&(n=r+n),new URL(n,r)}function iA(e,t,r="/"){return s9(e,t,r,!1)}function s9(e,t,r,n){let a=typeof t=="string"?Ah(t):t,i=Qs(a.pathname||"/",r);if(i==null)return null;let s=sA(e);o9(s);let o=null;for(let l=0;o==null&&l<s.length;++l){let c=x9(i);o=g9(s[l],c,n)}return o}function sA(e,t=[],r=[],n=""){let a=(i,s,o)=>{let l={relativePath:o===void 0?i.path||"":o,caseSensitive:i.caseSensitive===!0,childrenIndex:s,route:i};l.relativePath.startsWith("/")&&(on(l.relativePath.startsWith(n),`Absolute route path "${l.relativePath}" nested under path "${n}" is not valid. An absolute child route path must start with the combined path of all its parent routes.`),l.relativePath=l.relativePath.slice(n.length));let c=zs([n,l.relativePath]),u=r.concat(l);i.children&&i.children.length>0&&(on(i.index!==!0,`Index routes must not have child routes. Please remove all child routes from route path "${c}".`),sA(i.children,t,u,c)),!(i.path==null&&!i.index)&&t.push({path:c,score:p9(c,i.index),routesMeta:u})};return e.forEach((i,s)=>{var o;if(i.path===""||!((o=i.path)!=null&&o.includes("?")))a(i,s);else for(let l of oA(i.path))a(i,s,l)}),t}function oA(e){let t=e.split("/");if(t.length===0)return[];let[r,...n]=t,a=r.endsWith("?"),i=r.replace(/\?$/,"");if(n.length===0)return a?[i,""]:[i];let s=oA(n.join("/")),o=[];return o.push(...s.map(l=>l===""?i:[i,l].join("/"))),a&&o.push(...s),o.map(l=>e.startsWith("/")&&l===""?"/":l)}function o9(e){e.sort((t,r)=>t.score!==r.score?r.score-t.score:m9(t.routesMeta.map(n=>n.childrenIndex),r.routesMeta.map(n=>n.childrenIndex)))}var l9=/^:[\w-]+$/,c9=3,u9=2,f9=1,h9=10,d9=-2,Xb=e=>e==="*";function p9(e,t){let r=e.split("/"),n=r.length;return r.some(Xb)&&(n+=d9),t&&(n+=u9),r.filter(a=>!Xb(a)).reduce((a,i)=>a+(l9.test(i)?c9:i===""?f9:h9),n)}function m9(e,t){return e.length===t.length&&e.slice(0,-1).every((n,a)=>n===t[a])?e[e.length-1]-t[t.length-1]:0}function g9(e,t,r=!1){let{routesMeta:n}=e,a={},i="/",s=[];for(let o=0;o<n.length;++o){let l=n[o],c=o===n.length-1,u=i==="/"?t:t.slice(i.length)||"/",f=x1({path:l.relativePath,caseSensitive:l.caseSensitive,end:c},u),p=l.route;if(!f&&c&&r&&!n[n.length-1].route.index&&(f=x1({path:l.relativePath,caseSensitive:l.caseSensitive,end:!1},u)),!f)return null;Object.assign(a,f.params),s.push({params:a,pathname:zs([i,f.pathname]),pathnameBase:_9(zs([i,f.pathnameBase])),route:p}),f.pathnameBase!=="/"&&(i=zs([i,f.pathnameBase]))}return s}function x1(e,t){typeof e=="string"&&(e={path:e,caseSensitive:!1,end:!0});let[r,n]=v9(e.path,e.caseSensitive,e.end),a=t.match(r);if(!a)return null;let i=a[0],s=i.replace(/(.)\/+$/,"$1"),o=a.slice(1);return{params:n.reduce((c,{paramName:u,isOptional:f},p)=>{if(u==="*"){let g=o[p]||"";s=i.slice(0,i.length-g.length).replace(/(.)\/+$/,"$1")}const h=o[p];return f&&!h?c[u]=void 0:c[u]=(h||"").replace(/%2F/g,"/"),c},{}),pathname:i,pathnameBase:s,pattern:e}}function v9(e,t=!1,r=!0){fs(e==="*"||!e.endsWith("*")||e.endsWith("/*"),`Route path "${e}" will be treated as if it were "${e.replace(/\*$/,"/*")}" because the \`*\` character must always follow a \`/\` in the pattern. To get rid of this warning, please change the route path to "${e.replace(/\*$/,"/*")}".`);let n=[],a="^"+e.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,(s,o,l)=>(n.push({paramName:o,isOptional:l!=null}),l?"/?([^\\/]+)?":"/([^\\/]+)"));return e.endsWith("*")?(n.push({paramName:"*"}),a+=e==="*"||e==="/*"?"(.*)$":"(?:\\/(.+)|\\/*)$"):r?a+="\\/*$":e!==""&&e!=="/"&&(a+="(?:(?=\\/|$))"),[new RegExp(a,t?void 0:"i"),n]}function x9(e){try{return e.split("/").map(t=>decodeURIComponent(t).replace(/\//g,"%2F")).join("/")}catch(t){return fs(!1,`The URL path "${e}" could not be decoded because it is a malformed URL segment. This is probably due to a bad percent encoding (${t}).`),e}}function Qs(e,t){if(t==="/")return e;if(!e.toLowerCase().startsWith(t.toLowerCase()))return null;let r=t.endsWith("/")?t.length-1:t.length,n=e.charAt(r);return n&&n!=="/"?null:e.slice(r)||"/"}function y9(e,t="/"){let{pathname:r,search:n="",hash:a=""}=typeof e=="string"?Ah(e):e;return{pathname:r?r.startsWith("/")?r:w9(r,t):t,search:S9(n),hash:k9(a)}}function w9(e,t){let r=t.replace(/\/+$/,"").split("/");return e.split("/").forEach(a=>{a===".."?r.length>1&&r.pop():a!=="."&&r.push(a)}),r.length>1?r.join("/"):"/"}function c2(e,t,r,n){return`Cannot include a '${e}' character in a manually specified \`to.${t}\` field [${JSON.stringify(n)}].  Please separate it out to the \`to.${r}\` field. Alternatively you may provide the full path as a string in <Link to="..."> and the router will parse it for you.`}function b9(e){return e.filter((t,r)=>r===0||t.route.path&&t.route.path.length>0)}function lA(e){let t=b9(e);return t.map((r,n)=>n===t.length-1?r.pathname:r.pathnameBase)}function cA(e,t,r,n=!1){let a;typeof e=="string"?a=Ah(e):(a={...e},on(!a.pathname||!a.pathname.includes("?"),c2("?","pathname","search",a)),on(!a.pathname||!a.pathname.includes("#"),c2("#","pathname","hash",a)),on(!a.search||!a.search.includes("#"),c2("#","search","hash",a)));let i=e===""||a.pathname==="",s=i?"/":a.pathname,o;if(s==null)o=r;else{let f=t.length-1;if(!n&&s.startsWith("..")){let p=s.split("/");for(;p[0]==="..";)p.shift(),f-=1;a.pathname=p.join("/")}o=f>=0?t[f]:"/"}let l=y9(a,o),c=s&&s!=="/"&&s.endsWith("/"),u=(i||s===".")&&r.endsWith("/");return!l.pathname.endsWith("/")&&(c||u)&&(l.pathname+="/"),l}var zs=e=>e.join("/").replace(/\/\/+/g,"/"),_9=e=>e.replace(/\/+$/,"").replace(/^\/*/,"/"),S9=e=>!e||e==="?"?"":e.startsWith("?")?e:"?"+e,k9=e=>!e||e==="#"?"":e.startsWith("#")?e:"#"+e;function E9(e){return e!=null&&typeof e.status=="number"&&typeof e.statusText=="string"&&typeof e.internal=="boolean"&&"data"in e}var uA=["POST","PUT","PATCH","DELETE"];new Set(uA);var A9=["GET",...uA];new Set(A9);var Yu=ie.createContext(null);Yu.displayName="DataRouter";var xm=ie.createContext(null);xm.displayName="DataRouterState";var fA=ie.createContext({isTransitioning:!1});fA.displayName="ViewTransition";var T9=ie.createContext(new Map);T9.displayName="Fetchers";var C9=ie.createContext(null);C9.displayName="Await";var ps=ie.createContext(null);ps.displayName="Navigation";var ym=ie.createContext(null);ym.displayName="Location";var ro=ie.createContext({outlet:null,matches:[],isDataRoute:!1});ro.displayName="Route";var e5=ie.createContext(null);e5.displayName="RouteError";function N9(e,{relative:t}={}){on(Th(),"useHref() may be used only in the context of a <Router> component.");let{basename:r,navigator:n}=ie.useContext(ps),{hash:a,pathname:i,search:s}=Ch(e,{relative:t}),o=i;return r!=="/"&&(o=i==="/"?r:zs([r,i])),n.createHref({pathname:o,search:s,hash:a})}function Th(){return ie.useContext(ym)!=null}function uc(){return on(Th(),"useLocation() may be used only in the context of a <Router> component."),ie.useContext(ym).location}var hA="You should call navigate() in a React.useEffect(), not when your component is first rendered.";function dA(e){ie.useContext(ps).static||ie.useLayoutEffect(e)}function pA(){let{isDataRoute:e}=ie.useContext(ro);return e?$9():P9()}function P9(){on(Th(),"useNavigate() may be used only in the context of a <Router> component.");let e=ie.useContext(Yu),{basename:t,navigator:r}=ie.useContext(ps),{matches:n}=ie.useContext(ro),{pathname:a}=uc(),i=JSON.stringify(lA(n)),s=ie.useRef(!1);return dA(()=>{s.current=!0}),ie.useCallback((l,c={})=>{if(fs(s.current,hA),!s.current)return;if(typeof l=="number"){r.go(l);return}let u=cA(l,JSON.parse(i),a,c.relative==="path");e==null&&t!=="/"&&(u.pathname=u.pathname==="/"?t:zs([t,u.pathname])),(c.replace?r.replace:r.push)(u,c.state,c)},[t,r,i,a,e])}ie.createContext(null);function Ch(e,{relative:t}={}){let{matches:r}=ie.useContext(ro),{pathname:n}=uc(),a=JSON.stringify(lA(r));return ie.useMemo(()=>cA(e,JSON.parse(a),n,t==="path"),[e,a,n,t])}function L9(e,t,r,n){on(Th(),"useRoutes() may be used only in the context of a <Router> component.");let{navigator:a}=ie.useContext(ps),{matches:i}=ie.useContext(ro),s=i[i.length-1],o=s?s.params:{},l=s?s.pathname:"/",c=s?s.pathnameBase:"/",u=s&&s.route;{let x=u&&u.path||"";mA(l,!u||x.endsWith("*")||x.endsWith("*?"),`You rendered descendant <Routes> (or called \`useRoutes()\`) at "${l}" (under <Route path="${x}">) but the parent route path has no trailing "*". This means if you navigate deeper, the parent won't match anymore and therefore the child routes will never render.

Please change the parent <Route path="${x}"> to <Route path="${x==="/"?"*":`${x}/*`}">.`)}let f=uc(),p;p=f;let h=p.pathname||"/",g=h;if(c!=="/"){let x=c.replace(/^\//,"").split("/");g="/"+h.replace(/^\//,"").split("/").slice(x.length).join("/")}let m=iA(e,{pathname:g});return fs(u||m!=null,`No routes matched location "${p.pathname}${p.search}${p.hash}" `),fs(m==null||m[m.length-1].route.element!==void 0||m[m.length-1].route.Component!==void 0||m[m.length-1].route.lazy!==void 0,`Matched leaf route at location "${p.pathname}${p.search}${p.hash}" does not have an element or Component. This means it will render an <Outlet /> with a null value by default resulting in an "empty" page.`),R9(m&&m.map(x=>Object.assign({},x,{params:Object.assign({},o,x.params),pathname:zs([c,a.encodeLocation?a.encodeLocation(x.pathname).pathname:x.pathname]),pathnameBase:x.pathnameBase==="/"?c:zs([c,a.encodeLocation?a.encodeLocation(x.pathnameBase).pathname:x.pathnameBase])})),i,r,n)}function F9(){let e=V9(),t=E9(e)?`${e.status} ${e.statusText}`:e instanceof Error?e.message:JSON.stringify(e),r=e instanceof Error?e.stack:null,n="rgba(200,200,200, 0.5)",a={padding:"0.5rem",backgroundColor:n},i={padding:"2px 4px",backgroundColor:n},s=null;return console.error("Error handled by React Router default ErrorBoundary:",e),s=ie.createElement(ie.Fragment,null,ie.createElement("p",null," Hey developer "),ie.createElement("p",null,"You can provide a way better UX than this when your app throws errors by providing your own ",ie.createElement("code",{style:i},"ErrorBoundary")," or"," ",ie.createElement("code",{style:i},"errorElement")," prop on your route.")),ie.createElement(ie.Fragment,null,ie.createElement("h2",null,"Unexpected Application Error!"),ie.createElement("h3",{style:{fontStyle:"italic"}},t),r?ie.createElement("pre",{style:a},r):null,s)}var O9=ie.createElement(F9,null),D9=class extends ie.Component{constructor(e){super(e),this.state={location:e.location,revalidation:e.revalidation,error:e.error}}static getDerivedStateFromError(e){return{error:e}}static getDerivedStateFromProps(e,t){return t.location!==e.location||t.revalidation!=="idle"&&e.revalidation==="idle"?{error:e.error,location:e.location,revalidation:e.revalidation}:{error:e.error!==void 0?e.error:t.error,location:t.location,revalidation:e.revalidation||t.revalidation}}componentDidCatch(e,t){console.error("React Router caught the following error during render",e,t)}render(){return this.state.error!==void 0?ie.createElement(ro.Provider,{value:this.props.routeContext},ie.createElement(e5.Provider,{value:this.state.error,children:this.props.component})):this.props.children}};function I9({routeContext:e,match:t,children:r}){let n=ie.useContext(Yu);return n&&n.static&&n.staticContext&&(t.route.errorElement||t.route.ErrorBoundary)&&(n.staticContext._deepestRenderedBoundaryId=t.route.id),ie.createElement(ro.Provider,{value:e},r)}function R9(e,t=[],r=null,n=null){if(e==null){if(!r)return null;if(r.errors)e=r.matches;else if(t.length===0&&!r.initialized&&r.matches.length>0)e=r.matches;else return null}let a=e,i=r==null?void 0:r.errors;if(i!=null){let l=a.findIndex(c=>c.route.id&&(i==null?void 0:i[c.route.id])!==void 0);on(l>=0,`Could not find a matching route for errors on route IDs: ${Object.keys(i).join(",")}`),a=a.slice(0,Math.min(a.length,l+1))}let s=!1,o=-1;if(r)for(let l=0;l<a.length;l++){let c=a[l];if((c.route.HydrateFallback||c.route.hydrateFallbackElement)&&(o=l),c.route.id){let{loaderData:u,errors:f}=r,p=c.route.loader&&!u.hasOwnProperty(c.route.id)&&(!f||f[c.route.id]===void 0);if(c.route.lazy||p){s=!0,o>=0?a=a.slice(0,o+1):a=[a[0]];break}}}return a.reduceRight((l,c,u)=>{let f,p=!1,h=null,g=null;r&&(f=i&&c.route.id?i[c.route.id]:void 0,h=c.route.errorElement||O9,s&&(o<0&&u===0?(mA("route-fallback",!1,"No `HydrateFallback` element provided to render during initial hydration"),p=!0,g=null):o===u&&(p=!0,g=c.route.hydrateFallbackElement||null)));let m=t.concat(a.slice(0,u+1)),b=()=>{let x;return f?x=h:p?x=g:c.route.Component?x=ie.createElement(c.route.Component,null):c.route.element?x=c.route.element:x=l,ie.createElement(I9,{match:c,routeContext:{outlet:l,matches:m,isDataRoute:r!=null},children:x})};return r&&(c.route.ErrorBoundary||c.route.errorElement||u===0)?ie.createElement(D9,{location:r.location,revalidation:r.revalidation,component:h,error:f,children:b(),routeContext:{outlet:null,matches:m,isDataRoute:!0}}):b()},null)}function t5(e){return`${e} must be used within a data router.  See https://reactrouter.com/en/main/routers/picking-a-router.`}function j9(e){let t=ie.useContext(Yu);return on(t,t5(e)),t}function M9(e){let t=ie.useContext(xm);return on(t,t5(e)),t}function B9(e){let t=ie.useContext(ro);return on(t,t5(e)),t}function r5(e){let t=B9(e),r=t.matches[t.matches.length-1];return on(r.route.id,`${e} can only be used on routes that contain a unique "id"`),r.route.id}function U9(){return r5("useRouteId")}function V9(){var n;let e=ie.useContext(e5),t=M9("useRouteError"),r=r5("useRouteError");return e!==void 0?e:(n=t.errors)==null?void 0:n[r]}function $9(){let{router:e}=j9("useNavigate"),t=r5("useNavigate"),r=ie.useRef(!1);return dA(()=>{r.current=!0}),ie.useCallback(async(a,i={})=>{fs(r.current,hA),r.current&&(typeof a=="number"?e.navigate(a):await e.navigate(a,{fromRouteId:t,...i}))},[e,t])}var Yb={};function mA(e,t,r){!t&&!Yb[e]&&(Yb[e]=!0,fs(!1,r))}ie.memo(z9);function z9({routes:e,future:t,state:r}){return L9(e,void 0,r,t)}function H9({basename:e="/",children:t=null,location:r,navigationType:n="POP",navigator:a,static:i=!1}){on(!Th(),"You cannot render a <Router> inside another <Router>. You should never have more than one in your app.");let s=e.replace(/^\/*/,"/"),o=ie.useMemo(()=>({basename:s,navigator:a,static:i,future:{}}),[s,a,i]);typeof r=="string"&&(r=Ah(r));let{pathname:l="/",search:c="",hash:u="",state:f=null,key:p="default"}=r,h=ie.useMemo(()=>{let g=Qs(l,s);return g==null?null:{location:{pathname:g,search:c,hash:u,state:f,key:p},navigationType:n}},[s,l,c,u,f,p,n]);return fs(h!=null,`<Router basename="${s}"> is not able to match the URL "${l}${c}${u}" because it does not start with the basename, so the <Router> won't render anything.`),h==null?null:ie.createElement(ps.Provider,{value:o},ie.createElement(ym.Provider,{children:t,value:h}))}var Pp="get",Lp="application/x-www-form-urlencoded";function wm(e){return e!=null&&typeof e.tagName=="string"}function W9(e){return wm(e)&&e.tagName.toLowerCase()==="button"}function q9(e){return wm(e)&&e.tagName.toLowerCase()==="form"}function G9(e){return wm(e)&&e.tagName.toLowerCase()==="input"}function K9(e){return!!(e.metaKey||e.altKey||e.ctrlKey||e.shiftKey)}function X9(e,t){return e.button===0&&(!t||t==="_self")&&!K9(e)}var Zd=null;function Y9(){if(Zd===null)try{new FormData(document.createElement("form"),0),Zd=!1}catch{Zd=!0}return Zd}var J9=new Set(["application/x-www-form-urlencoded","multipart/form-data","text/plain"]);function u2(e){return e!=null&&!J9.has(e)?(fs(!1,`"${e}" is not a valid \`encType\` for \`<Form>\`/\`<fetcher.Form>\` and will default to "${Lp}"`),null):e}function Q9(e,t){let r,n,a,i,s;if(q9(e)){let o=e.getAttribute("action");n=o?Qs(o,t):null,r=e.getAttribute("method")||Pp,a=u2(e.getAttribute("enctype"))||Lp,i=new FormData(e)}else if(W9(e)||G9(e)&&(e.type==="submit"||e.type==="image")){let o=e.form;if(o==null)throw new Error('Cannot submit a <button> or <input type="submit"> without a <form>');let l=e.getAttribute("formaction")||o.getAttribute("action");if(n=l?Qs(l,t):null,r=e.getAttribute("formmethod")||o.getAttribute("method")||Pp,a=u2(e.getAttribute("formenctype"))||u2(o.getAttribute("enctype"))||Lp,i=new FormData(o,e),!Y9()){let{name:c,type:u,value:f}=e;if(u==="image"){let p=c?`${c}.`:"";i.append(`${p}x`,"0"),i.append(`${p}y`,"0")}else c&&i.append(c,f)}}else{if(wm(e))throw new Error('Cannot submit element that is not <form>, <button>, or <input type="submit|image">');r=Pp,n=null,a=Lp,s=e}return i&&a==="text/plain"&&(s=i,i=void 0),{action:n,method:r.toLowerCase(),encType:a,formData:i,body:s}}function n5(e,t){if(e===!1||e===null||typeof e>"u")throw new Error(t)}async function Z9(e,t){if(e.id in t)return t[e.id];try{let r=await import(e.module);return t[e.id]=r,r}catch(r){return console.error(`Error loading route module \`${e.module}\`, reloading page...`),console.error(r),window.__reactRouterContext&&window.__reactRouterContext.isSpaMode,window.location.reload(),new Promise(()=>{})}}function eM(e){return e==null?!1:e.href==null?e.rel==="preload"&&typeof e.imageSrcSet=="string"&&typeof e.imageSizes=="string":typeof e.rel=="string"&&typeof e.href=="string"}async function tM(e,t,r){let n=await Promise.all(e.map(async a=>{let i=t.routes[a.route.id];if(i){let s=await Z9(i,r);return s.links?s.links():[]}return[]}));return iM(n.flat(1).filter(eM).filter(a=>a.rel==="stylesheet"||a.rel==="preload").map(a=>a.rel==="stylesheet"?{...a,rel:"prefetch",as:"style"}:{...a,rel:"prefetch"}))}function Jb(e,t,r,n,a,i){let s=(l,c)=>r[c]?l.route.id!==r[c].route.id:!0,o=(l,c)=>{var u;return r[c].pathname!==l.pathname||((u=r[c].route.path)==null?void 0:u.endsWith("*"))&&r[c].params["*"]!==l.params["*"]};return i==="assets"?t.filter((l,c)=>s(l,c)||o(l,c)):i==="data"?t.filter((l,c)=>{var f;let u=n.routes[l.route.id];if(!u||!u.hasLoader)return!1;if(s(l,c)||o(l,c))return!0;if(l.route.shouldRevalidate){let p=l.route.shouldRevalidate({currentUrl:new URL(a.pathname+a.search+a.hash,window.origin),currentParams:((f=r[0])==null?void 0:f.params)||{},nextUrl:new URL(e,window.origin),nextParams:l.params,defaultShouldRevalidate:!0});if(typeof p=="boolean")return p}return!0}):[]}function rM(e,t,{includeHydrateFallback:r}={}){return nM(e.map(n=>{let a=t.routes[n.route.id];if(!a)return[];let i=[a.module];return a.clientActionModule&&(i=i.concat(a.clientActionModule)),a.clientLoaderModule&&(i=i.concat(a.clientLoaderModule)),r&&a.hydrateFallbackModule&&(i=i.concat(a.hydrateFallbackModule)),a.imports&&(i=i.concat(a.imports)),i}).flat(1))}function nM(e){return[...new Set(e)]}function aM(e){let t={},r=Object.keys(e).sort();for(let n of r)t[n]=e[n];return t}function iM(e,t){let r=new Set;return new Set(t),e.reduce((n,a)=>{let i=JSON.stringify(aM(a));return r.has(i)||(r.add(i),n.push({key:i,link:a})),n},[])}Object.getOwnPropertyNames(Object.prototype).sort().join("\0");var sM=new Set([100,101,204,205]);function oM(e,t){let r=typeof e=="string"?new URL(e,typeof window>"u"?"server://singlefetch/":window.location.origin):e;return r.pathname==="/"?r.pathname="_root.data":t&&Qs(r.pathname,t)==="/"?r.pathname=`${t.replace(/\/$/,"")}/_root.data`:r.pathname=`${r.pathname.replace(/\/$/,"")}.data`,r}function gA(){let e=ie.useContext(Yu);return n5(e,"You must render this element inside a <DataRouterContext.Provider> element"),e}function lM(){let e=ie.useContext(xm);return n5(e,"You must render this element inside a <DataRouterStateContext.Provider> element"),e}var a5=ie.createContext(void 0);a5.displayName="FrameworkContext";function vA(){let e=ie.useContext(a5);return n5(e,"You must render this element inside a <HydratedRouter> element"),e}function cM(e,t){let r=ie.useContext(a5),[n,a]=ie.useState(!1),[i,s]=ie.useState(!1),{onFocus:o,onBlur:l,onMouseEnter:c,onMouseLeave:u,onTouchStart:f}=t,p=ie.useRef(null);ie.useEffect(()=>{if(e==="render"&&s(!0),e==="viewport"){let m=x=>{x.forEach(w=>{s(w.isIntersecting)})},b=new IntersectionObserver(m,{threshold:.5});return p.current&&b.observe(p.current),()=>{b.disconnect()}}},[e]),ie.useEffect(()=>{if(n){let m=setTimeout(()=>{s(!0)},100);return()=>{clearTimeout(m)}}},[n]);let h=()=>{a(!0)},g=()=>{a(!1),s(!1)};return r?e!=="intent"?[i,p,{}]:[i,p,{onFocus:zf(o,h),onBlur:zf(l,g),onMouseEnter:zf(c,h),onMouseLeave:zf(u,g),onTouchStart:zf(f,h)}]:[!1,p,{}]}function zf(e,t){return r=>{e&&e(r),r.defaultPrevented||t(r)}}function uM({page:e,...t}){let{router:r}=gA(),n=ie.useMemo(()=>iA(r.routes,e,r.basename),[r.routes,e,r.basename]);return n?ie.createElement(hM,{page:e,matches:n,...t}):null}function fM(e){let{manifest:t,routeModules:r}=vA(),[n,a]=ie.useState([]);return ie.useEffect(()=>{let i=!1;return tM(e,t,r).then(s=>{i||a(s)}),()=>{i=!0}},[e,t,r]),n}function hM({page:e,matches:t,...r}){let n=uc(),{manifest:a,routeModules:i}=vA(),{basename:s}=gA(),{loaderData:o,matches:l}=lM(),c=ie.useMemo(()=>Jb(e,t,l,a,n,"data"),[e,t,l,a,n]),u=ie.useMemo(()=>Jb(e,t,l,a,n,"assets"),[e,t,l,a,n]),f=ie.useMemo(()=>{if(e===n.pathname+n.search+n.hash)return[];let g=new Set,m=!1;if(t.forEach(x=>{var y;let w=a.routes[x.route.id];!w||!w.hasLoader||(!c.some(A=>A.route.id===x.route.id)&&x.route.id in o&&((y=i[x.route.id])!=null&&y.shouldRevalidate)||w.hasClientLoader?m=!0:g.add(x.route.id))}),g.size===0)return[];let b=oM(e,s);return m&&g.size>0&&b.searchParams.set("_routes",t.filter(x=>g.has(x.route.id)).map(x=>x.route.id).join(",")),[b.pathname+b.search]},[s,o,n,a,c,t,e,i]),p=ie.useMemo(()=>rM(u,a),[u,a]),h=fM(u);return ie.createElement(ie.Fragment,null,f.map(g=>ie.createElement("link",{key:g,rel:"prefetch",as:"fetch",href:g,...r})),p.map(g=>ie.createElement("link",{key:g,rel:"modulepreload",href:g,...r})),h.map(({key:g,link:m})=>ie.createElement("link",{key:g,...m})))}function dM(...e){return t=>{e.forEach(r=>{typeof r=="function"?r(t):r!=null&&(r.current=t)})}}var xA=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u";try{xA&&(window.__reactRouterVersion="7.6.3")}catch{}function pM({basename:e,children:t,window:r}){let n=ie.useRef();n.current==null&&(n.current=r9({window:r,v5Compat:!0}));let a=n.current,[i,s]=ie.useState({action:a.action,location:a.location}),o=ie.useCallback(l=>{ie.startTransition(()=>s(l))},[s]);return ie.useLayoutEffect(()=>a.listen(o),[a,o]),ie.createElement(H9,{basename:e,children:t,location:i.location,navigationType:i.action,navigator:a})}var yA=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,wA=ie.forwardRef(function({onClick:t,discover:r="render",prefetch:n="none",relative:a,reloadDocument:i,replace:s,state:o,target:l,to:c,preventScrollReset:u,viewTransition:f,...p},h){let{basename:g}=ie.useContext(ps),m=typeof c=="string"&&yA.test(c),b,x=!1;if(typeof c=="string"&&m&&(b=c,xA))try{let R=new URL(window.location.href),X=c.startsWith("//")?new URL(R.protocol+c):new URL(c),N=Qs(X.pathname,g);X.origin===R.origin&&N!=null?c=N+X.search+X.hash:x=!0}catch{fs(!1,`<Link to="${c}"> contains an invalid URL which will probably break when clicked - please update to a valid URL path.`)}let w=N9(c,{relative:a}),[y,A,L]=cM(n,p),D=xM(c,{replace:s,state:o,target:l,preventScrollReset:u,relative:a,viewTransition:f});function T(R){t&&t(R),R.defaultPrevented||D(R)}let F=ie.createElement("a",{...p,...L,href:b||w,onClick:x||i?t:T,ref:dM(h,A),target:l,"data-discover":!m&&r==="render"?"true":void 0});return y&&!m?ie.createElement(ie.Fragment,null,F,ie.createElement(uM,{page:w})):F});wA.displayName="Link";var mM=ie.forwardRef(function({"aria-current":t="page",caseSensitive:r=!1,className:n="",end:a=!1,style:i,to:s,viewTransition:o,children:l,...c},u){let f=Ch(s,{relative:c.relative}),p=uc(),h=ie.useContext(xm),{navigator:g,basename:m}=ie.useContext(ps),b=h!=null&&SM(f)&&o===!0,x=g.encodeLocation?g.encodeLocation(f).pathname:f.pathname,w=p.pathname,y=h&&h.navigation&&h.navigation.location?h.navigation.location.pathname:null;r||(w=w.toLowerCase(),y=y?y.toLowerCase():null,x=x.toLowerCase()),y&&m&&(y=Qs(y,m)||y);const A=x!=="/"&&x.endsWith("/")?x.length-1:x.length;let L=w===x||!a&&w.startsWith(x)&&w.charAt(A)==="/",D=y!=null&&(y===x||!a&&y.startsWith(x)&&y.charAt(x.length)==="/"),T={isActive:L,isPending:D,isTransitioning:b},F=L?t:void 0,R;typeof n=="function"?R=n(T):R=[n,L?"active":null,D?"pending":null,b?"transitioning":null].filter(Boolean).join(" ");let X=typeof i=="function"?i(T):i;return ie.createElement(wA,{...c,"aria-current":F,className:R,ref:u,style:X,to:s,viewTransition:o},typeof l=="function"?l(T):l)});mM.displayName="NavLink";var gM=ie.forwardRef(({discover:e="render",fetcherKey:t,navigate:r,reloadDocument:n,replace:a,state:i,method:s=Pp,action:o,onSubmit:l,relative:c,preventScrollReset:u,viewTransition:f,...p},h)=>{let g=bM(),m=_M(o,{relative:c}),b=s.toLowerCase()==="get"?"get":"post",x=typeof o=="string"&&yA.test(o),w=y=>{if(l&&l(y),y.defaultPrevented)return;y.preventDefault();let A=y.nativeEvent.submitter,L=(A==null?void 0:A.getAttribute("formmethod"))||s;g(A||y.currentTarget,{fetcherKey:t,method:L,navigate:r,replace:a,state:i,relative:c,preventScrollReset:u,viewTransition:f})};return ie.createElement("form",{ref:h,method:b,action:m,onSubmit:n?l:w,...p,"data-discover":!x&&e==="render"?"true":void 0})});gM.displayName="Form";function vM(e){return`${e} must be used within a data router.  See https://reactrouter.com/en/main/routers/picking-a-router.`}function bA(e){let t=ie.useContext(Yu);return on(t,vM(e)),t}function xM(e,{target:t,replace:r,state:n,preventScrollReset:a,relative:i,viewTransition:s}={}){let o=pA(),l=uc(),c=Ch(e,{relative:i});return ie.useCallback(u=>{if(X9(u,t)){u.preventDefault();let f=r!==void 0?r:th(l)===th(c);o(e,{replace:f,state:n,preventScrollReset:a,relative:i,viewTransition:s})}},[l,o,c,r,n,t,e,a,i,s])}var yM=0,wM=()=>`__${String(++yM)}__`;function bM(){let{router:e}=bA("useSubmit"),{basename:t}=ie.useContext(ps),r=U9();return ie.useCallback(async(n,a={})=>{let{action:i,method:s,encType:o,formData:l,body:c}=Q9(n,t);if(a.navigate===!1){let u=a.fetcherKey||wM();await e.fetch(u,r,a.action||i,{preventScrollReset:a.preventScrollReset,formData:l,body:c,formMethod:a.method||s,formEncType:a.encType||o,flushSync:a.flushSync})}else await e.navigate(a.action||i,{preventScrollReset:a.preventScrollReset,formData:l,body:c,formMethod:a.method||s,formEncType:a.encType||o,replace:a.replace,state:a.state,fromRouteId:r,flushSync:a.flushSync,viewTransition:a.viewTransition})},[e,t,r])}function _M(e,{relative:t}={}){let{basename:r}=ie.useContext(ps),n=ie.useContext(ro);on(n,"useFormAction must be used inside a RouteContext");let[a]=n.matches.slice(-1),i={...Ch(e||".",{relative:t})},s=uc();if(e==null){i.search=s.search;let o=new URLSearchParams(i.search),l=o.getAll("index");if(l.some(u=>u==="")){o.delete("index"),l.filter(f=>f).forEach(f=>o.append("index",f));let u=o.toString();i.search=u?`?${u}`:""}}return(!e||e===".")&&a.route.index&&(i.search=i.search?i.search.replace(/^\?/,"?index&"):"?index"),r!=="/"&&(i.pathname=i.pathname==="/"?r:zs([r,i.pathname])),th(i)}function SM(e,t={}){let r=ie.useContext(fA);on(r!=null,"`useViewTransitionState` must be used within `react-router-dom`'s `RouterProvider`.  Did you accidentally import `RouterProvider` from `react-router`?");let{basename:n}=bA("useViewTransitionState"),a=Ch(e,{relative:t.relative});if(!r.isTransitioning)return!1;let i=Qs(r.currentLocation.pathname,n)||r.currentLocation.pathname,s=Qs(r.nextLocation.pathname,n)||r.nextLocation.pathname;return x1(a.pathname,s)!=null||x1(a.pathname,i)!=null}[...sM];const kM=({isOpen:e,onClose:t})=>{const{user:r}=vm(),[n,a]=ie.useState({full_name:(r==null?void 0:r.full_name)||"",email:(r==null?void 0:r.email)||""}),[i,s]=ie.useState(!1),[o,l]=ie.useState(!1),[c,u]=ie.useState({current:"",new:"",confirm:""}),[f,p]=ie.useState(!1);Fi.useEffect(()=>{r&&a({full_name:r.full_name||"",email:r.email||""})},[r,e]);const h=async m=>{m.preventDefault(),p(!0),setTimeout(()=>{ft.success("Datos actualizados"),s(!1),p(!1),t()},1e3)},g=async m=>{if(m.preventDefault(),c.new!==c.confirm){ft.error("Las contraseas no coinciden");return}p(!0),setTimeout(()=>{ft.success("Contrasea cambiada"),l(!1),p(!1),u({current:"",new:"",confirm:""}),t()},1e3)};return _.jsx(mm,{children:e&&_.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50",children:_.jsxs(er.div,{initial:{opacity:0,scale:.9},animate:{opacity:1,scale:1},exit:{opacity:0,scale:.9},className:"bg-white rounded-xl p-6 max-w-md w-full shadow-2xl",children:[_.jsxs("div",{className:"flex justify-between items-center mb-4",children:[_.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Perfil de Usuario"}),_.jsx("button",{onClick:t,className:"text-gray-400 hover:text-gray-600 transition-colors",children:_.jsx(Eh,{className:"h-6 w-6"})})]}),o?_.jsxs("form",{onSubmit:g,className:"space-y-4",children:[_.jsxs("div",{children:[_.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Contrasea actual"}),_.jsx("input",{type:"password",value:c.current,onChange:m=>u({...c,current:m.target.value}),className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all",required:!0})]}),_.jsxs("div",{children:[_.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Nueva contrasea"}),_.jsx("input",{type:"password",value:c.new,onChange:m=>u({...c,new:m.target.value}),className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all",required:!0})]}),_.jsxs("div",{children:[_.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Confirmar nueva contrasea"}),_.jsx("input",{type:"password",value:c.confirm,onChange:m=>u({...c,confirm:m.target.value}),className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all",required:!0})]}),_.jsxs("div",{className:"flex gap-3 pt-4",children:[_.jsx("button",{type:"button",onClick:()=>l(!1),className:"flex-1 px-4 py-2 bg-gray-200 text-gray-800 rounded-lg hover:bg-gray-300 transition-colors font-medium",children:"Cancelar"}),_.jsxs("button",{type:"submit",disabled:f,className:"flex-1 px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors font-medium disabled:opacity-50 disabled:cursor-not-allowed flex items-center justify-center gap-2",children:[f?_.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white"}):_.jsx(Hb,{className:"h-4 w-4"}),f?"Guardando...":"Cambiar"]})]})]}):_.jsxs("form",{onSubmit:h,className:"space-y-4",children:[_.jsxs("div",{children:[_.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Nombre completo"}),_.jsx("input",{type:"text",value:n.full_name,onChange:m=>a({...n,full_name:m.target.value}),className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all",disabled:!i})]}),_.jsxs("div",{children:[_.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Correo electrnico"}),_.jsx("input",{type:"email",value:n.email,onChange:m=>a({...n,email:m.target.value}),className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all",disabled:!i})]}),_.jsxs("div",{children:[_.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Usuario"}),_.jsx("input",{type:"text",value:(r==null?void 0:r.username)||"",disabled:!0,className:"w-full px-4 py-2 border border-gray-200 rounded-lg bg-gray-100 text-gray-500"})]}),_.jsxs("div",{children:[_.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Rol"}),_.jsx("input",{type:"text",value:(r==null?void 0:r.role)||"",disabled:!0,className:"w-full px-4 py-2 border border-gray-200 rounded-lg bg-gray-100 text-gray-500"})]}),_.jsx("div",{className:"flex gap-3 pt-4",children:i?_.jsxs(_.Fragment,{children:[_.jsx("button",{type:"button",onClick:()=>s(!1),className:"flex-1 px-4 py-2 bg-gray-200 text-gray-800 rounded-lg hover:bg-gray-300 transition-colors font-medium",children:"Cancelar"}),_.jsxs("button",{type:"submit",disabled:f,className:"flex-1 px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors font-medium disabled:opacity-50 disabled:cursor-not-allowed flex items-center justify-center gap-2",children:[f?_.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white"}):_.jsx(Qy,{className:"h-4 w-4"}),f?"Guardando...":"Guardar"]})]}):_.jsxs(_.Fragment,{children:[_.jsx("button",{type:"button",onClick:()=>s(!0),className:"flex-1 px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors font-medium",children:"Editar datos"}),_.jsxs("button",{type:"button",onClick:()=>l(!0),className:"flex-1 px-4 py-2 bg-gray-200 text-gray-800 rounded-lg hover:bg-gray-300 transition-colors font-medium flex items-center gap-2",children:[_.jsx(Hb,{className:"h-4 w-4"})," Cambiar contrasea"]})]})})]})]})})})},EM=()=>{const{user:e,logout:t}=vm(),{articles:r,getStock:n}=ds();pA();const[a,i]=Fi.useState(!1),[s,o]=Fi.useState(!1),[l,c]=Fi.useState(!1),u="notificaciones_gestionadas",[f,p]=Fi.useState(()=>{try{return JSON.parse(localStorage.getItem(u)||"[]")}catch{return[]}}),m=[...r.filter(L=>n(L.id)>0&&n(L.id)<=5).map(L=>({id:`stock-${L.id}`,type:"stock",message:`Stock bajo: ${L.nombre} (${n(L.id)} unidades)`,articleId:L.id}))].filter(L=>!f.includes(L.id)),b=m.length>0,x=L=>{const D=[...f,L];p(D),localStorage.setItem(u,JSON.stringify(D))},w=L=>{x(L.id)};Fi.useEffect(()=>{const L=D=>{i(!1),o(!1)};if(a||s)return document.addEventListener("click",L),()=>document.removeEventListener("click",L)},[a,s]),Fi.useEffect(()=>{p(()=>{try{return JSON.parse(localStorage.getItem(u)||"[]")}catch{return[]}})},[e==null?void 0:e.id]);const y=new Date().toLocaleDateString("es-ES",{weekday:"long",year:"numeric",month:"long",day:"numeric"}),A=(e==null?void 0:e.username.slice(0,2).toUpperCase())||"U";return _.jsx("header",{className:"bg-white shadow-sm border-b border-gray-200 sticky top-0 z-30",children:_.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:_.jsxs("div",{className:"flex justify-between items-center py-4",children:[_.jsxs("div",{className:"flex items-center space-x-4",children:[_.jsx("div",{className:"bg-gradient-to-r from-blue-600 to-blue-700 p-2.5 rounded-xl shadow-lg",children:_.jsx(eA,{className:"h-6 w-6 text-white"})}),_.jsxs("div",{className:"hidden md:block",children:[_.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"Sistema de Control de Inventario"}),_.jsx("p",{className:"text-sm text-gray-600 mt-0.5",children:"Gestin profesional de inventarios"})]}),_.jsx("div",{className:"block md:hidden",children:_.jsx("h1",{className:"text-xl font-bold text-gray-900",children:"Inventario"})})]}),_.jsxs("div",{className:"flex items-center space-x-4",children:[_.jsxs("div",{className:"relative hidden md:block",children:[_.jsx(nA,{className:"absolute left-3 top-2.5 h-4 w-4 text-gray-400"}),_.jsx("input",{type:"text",placeholder:"Buscar en el sistema...",className:"w-48 pl-9 pr-4 py-2 bg-gray-100 border border-transparent rounded-lg focus:bg-white focus:border-blue-300 focus:ring-2 focus:ring-blue-200 transition-all text-sm"})]}),_.jsxs("div",{className:"relative",children:[_.jsxs("button",{className:"relative p-2 rounded-full hover:bg-gray-100 transition-colors",onClick:L=>{L.stopPropagation(),i(!a)},children:[_.jsx(Dj,{className:"h-5 w-5 text-gray-600"}),b&&_.jsx("span",{className:"absolute top-1 right-1 h-2 w-2 bg-blue-600 rounded-full"})]}),a&&_.jsxs("div",{className:"absolute right-0 mt-2 w-80 bg-white border border-gray-200 rounded-lg shadow-lg z-50",children:[_.jsxs("div",{className:"p-4 border-b font-semibold text-gray-700 flex justify-between items-center",children:[_.jsx("span",{children:"Notificaciones"}),m.length>0&&_.jsx("button",{onClick:L=>{L.stopPropagation();const D=[...f,...m.map(T=>T.id)];p(D),localStorage.setItem(u,JSON.stringify(D))},className:"px-2 py-1 bg-blue-600 text-white rounded text-xs hover:bg-blue-700",children:"Marcar todas"})]}),m.length===0?_.jsx("div",{className:"p-4 text-gray-500 text-sm",children:"No hay notificaciones"}):m.map((L,D)=>_.jsxs("div",{className:"p-4 text-gray-700 text-sm border-b last:border-b-0 flex flex-col gap-2",children:[_.jsx("span",{children:L.message}),_.jsx("div",{className:"flex gap-2 mt-1",children:_.jsx("button",{onClick:T=>{T.stopPropagation(),w(L)},className:"px-2 py-1 bg-gray-200 text-gray-700 rounded text-xs hover:bg-gray-300",children:"Marcar como leda"})})]},D))]})]}),_.jsxs("div",{className:"hidden md:block text-right",children:[_.jsx("div",{className:"text-sm font-medium text-gray-900",children:"Alcalda Municipal de Cabaas Oeste"}),_.jsx("div",{className:"text-xs text-gray-500 mt-0.5 capitalize",children:y})]}),_.jsxs("div",{className:"relative flex items-center gap-3",children:[_.jsx("button",{className:"h-9 w-9 rounded-full bg-gradient-to-r from-blue-400 to-blue-600 flex items-center justify-center text-white font-medium shadow-md focus:outline-none",onClick:L=>{L.stopPropagation(),o(!s)},children:_.jsx("span",{children:A})}),s&&_.jsxs("div",{className:"absolute right-0 mt-12 w-48 bg-white border border-gray-200 rounded-lg shadow-lg z-50",children:[_.jsx("div",{className:"p-4 border-b font-semibold text-gray-700",children:"Perfil"}),_.jsx("div",{className:"p-4 text-gray-700 text-sm border-b",children:(e==null?void 0:e.username)||"Usuario"}),_.jsx("button",{onClick:()=>{c(!0),o(!1)},className:"w-full text-left px-4 py-2 text-blue-600 hover:bg-blue-100 font-medium flex items-center gap-2",children:"Ver perfil"}),_.jsxs("button",{onClick:t,className:"w-full text-left px-4 py-2 text-red-600 hover:bg-red-100 rounded-b-lg font-medium flex items-center gap-2",children:[_.jsx(Bj,{className:"h-4 w-4"})," Cerrar Sesin"]})]}),_.jsx(kM,{isOpen:l,onClose:()=>c(!1)})]})]})]})})})},AM=[{id:"dashboard",label:"Dashboard",icon:Rj},{id:"articles",label:"Artculos",icon:Jy},{id:"movements",label:"Movimientos",icon:Yv},{id:"existencias",label:"Existencias",icon:Ij},{id:"control-card",label:"Tarjeta de Control",icon:Q6},{id:"papeleria-nueva",label:"Papelera Nueva",icon:Oj},{id:"import-export",label:"Importar/Exportar",icon:zj}],TM=({currentView:e,onViewChange:t})=>_.jsx("div",{className:"bg-white shadow-sm border-b border-gray-200 sticky top-16 z-20",children:_.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:_.jsx("nav",{className:"flex space-x-1 py-3 overflow-x-auto",children:AM.map(r=>{const n=r.icon,a=e===r.id;return _.jsxs("button",{onClick:()=>t(r.id),className:`flex items-center px-4 py-2 rounded-lg text-sm font-medium transition-all duration-200 whitespace-nowrap ${a?"bg-blue-50 text-blue-700":"text-gray-600 hover:text-gray-800 hover:bg-gray-50"}`,children:[_.jsx(n,{className:"h-4 w-4 mr-2"}),r.label]},r.id)})})})}),Gt=e=>new Intl.NumberFormat("es-ES",{style:"currency",currency:"USD"}).format(e),_A=e=>{if(/^\d{4}-\d{2}-\d{2}$/.test(e)){const[r,n,a]=e.split("-");return`${a}/${n}/${r}`}return new Date(e).toLocaleDateString("es-ES",{year:"numeric",month:"2-digit",day:"2-digit"})},CM=({onStatusChange:e})=>{const[t,r]=ie.useState("loading"),[n,a]=ie.useState({connected:!1,tablesExist:!1,errors:[]}),[i,s]=ie.useState(!1),o=async()=>{s(!0);try{const u=await CE(),f=await dO(),p=await pO(),h={...u,stats:f,integrity:p};a(h),u.connected&&u.tablesExist&&p.valid?(r("connected"),e==null||e("connected")):(r("error"),e==null||e("error"))}catch(u){r("error"),a(f=>({...f,errors:[...f.errors,`Status check failed: ${u instanceof Error?u.message:"Unknown error"}`]})),e==null||e("error")}finally{s(!1)}};ie.useEffect(()=>{o()},[]);const l=()=>{switch(t){case"connected":return _.jsx(Qd,{className:"h-5 w-5 text-green-600"});case"error":return _.jsx(l2,{className:"h-5 w-5 text-red-600"});default:return _.jsx(zb,{className:"h-5 w-5 text-gray-400 animate-pulse"})}},c=()=>{switch(t){case"connected":return"border-green-200 bg-green-50";case"error":return"border-red-200 bg-red-50";default:return"border-gray-200 bg-gray-50"}};return _.jsxs(er.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},className:`border rounded-lg p-4 ${c()}`,children:[_.jsxs("div",{className:"flex items-center justify-between mb-3",children:[_.jsxs("div",{className:"flex items-center gap-2",children:[l(),_.jsx("h3",{className:"font-medium text-gray-900",children:"Estado de la Base de Datos"})]}),_.jsx("button",{onClick:o,disabled:i,className:"p-1 text-gray-500 hover:text-gray-700 transition-colors",children:_.jsx(Uj,{className:`h-4 w-4 ${i?"animate-spin":""}`})})]}),_.jsxs("div",{className:"space-y-2 text-sm",children:[_.jsxs("div",{className:"flex items-center gap-2",children:[n.connected?_.jsx(Qd,{className:"h-4 w-4 text-green-500"}):_.jsx(l2,{className:"h-4 w-4 text-red-500"}),_.jsxs("span",{children:["Conexin a Supabase: ",n.connected?"Conectado":"Desconectado"]})]}),_.jsxs("div",{className:"flex items-center gap-2",children:[n.tablesExist?_.jsx(Qd,{className:"h-4 w-4 text-green-500"}):_.jsx(l2,{className:"h-4 w-4 text-red-500"}),_.jsxs("span",{children:["Tablas de inventario: ",n.tablesExist?"Existentes":"No encontradas"]})]}),n.stats&&_.jsxs("div",{className:"flex items-center gap-2",children:[_.jsx(zb,{className:"h-4 w-4 text-blue-500"}),_.jsxs("span",{children:["Datos: ",n.stats.articulos," artculos, ",n.stats.movimientos," movimientos"]})]}),n.integrity&&_.jsxs("div",{className:"flex items-center gap-2",children:[n.integrity.valid?_.jsx(Qd,{className:"h-4 w-4 text-green-500"}):_.jsx(gm,{className:"h-4 w-4 text-yellow-500"}),_.jsxs("span",{children:["Integridad: ",n.integrity.valid?"Vlida":`${n.integrity.issues.length} problemas`]})]})]}),n.errors.length>0&&_.jsxs("div",{className:"mt-3 p-2 bg-red-100 border border-red-200 rounded text-sm",children:[_.jsx("div",{className:"font-medium text-red-800 mb-1",children:"Errores encontrados:"}),_.jsx("ul",{className:"text-red-700 space-y-1",children:n.errors.map((u,f)=>_.jsxs("li",{children:[" ",u]},f))})]}),n.integrity&&n.integrity.issues.length>0&&_.jsxs("div",{className:"mt-3 p-2 bg-yellow-100 border border-yellow-200 rounded text-sm",children:[_.jsx("div",{className:"font-medium text-yellow-800 mb-1",children:"Problemas de integridad:"}),_.jsx("ul",{className:"text-yellow-700 space-y-1",children:n.integrity.issues.map((u,f)=>_.jsxs("li",{children:[" ",u]},f))})]}),!n.tablesExist&&_.jsxs("div",{className:"mt-3 p-2 bg-blue-100 border border-blue-200 rounded text-sm",children:[_.jsx("div",{className:"font-medium text-blue-800 mb-1",children:"Accin requerida:"}),_.jsx("p",{className:"text-blue-700",children:"Las tablas de inventario no existen. Por favor, ejecuta el archivo de migracin SQL en tu panel de Supabase para crear las tablas necesarias."})]})]})},NM=()=>{const{articles:e,movements:t,getStock:r,loading:n}=ds();if(n)return _.jsx("div",{className:"flex items-center justify-center py-12",children:_.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600"})});const a=e.length,i=e.reduce((c,u)=>{const f=r(u.id);return c+f*u.costo},0),s=e.filter(c=>r(c.id)<=5).length,o=t.slice(0,5),l=[{title:"Total Artculos",value:a,icon:Jy,color:"blue",trend:"+8.2%"},{title:"Valor actual del stock",value:Gt(i),icon:Z6,color:"green",trend:"+12.5%"},{title:"Stock Bajo",value:s,icon:gm,color:"red",trend:"-5.2%"},{title:"Movimientos",value:t.length,icon:Yv,color:"purple",trend:"+18.1%"}];return _.jsxs("div",{className:"space-y-8",children:[_.jsxs(er.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},className:"bg-white rounded-2xl shadow-lg p-8 border border-gray-100",children:[_.jsx("div",{className:"flex flex-col md:flex-row md:items-center md:justify-between gap-4",children:_.jsxs("div",{children:[_.jsx("h2",{className:"text-3xl font-bold text-gray-900 mb-2",children:"Dashboard de Inventario"}),_.jsx("p",{className:"text-gray-600",children:"Visualizacin general del sistema de control de inventario"})]})}),_.jsxs("div",{className:"mt-6 rounded-xl overflow-hidden h-40 md:h-64 relative",children:[_.jsx("img",{src:"https://images.pexels.com/photos/1181354/pexels-photo-1181354.jpeg?auto=compress&cs=tinysrgb&w=1260&h=750&dpr=1",alt:"Dashboard de gestin de inventario",className:"w-full h-full object-cover"}),_.jsx("div",{className:"absolute inset-0 bg-gradient-to-r from-blue-900/70 to-transparent flex items-center",children:_.jsxs("div",{className:"px-8 py-6 text-white max-w-lg",children:[_.jsx("h3",{className:"text-2xl font-bold mb-2 drop-shadow-md",children:"Sistema de Gestin de Inventario"}),_.jsx("p",{className:"text-white/90 drop-shadow-md",children:"Control total sobre su inventario de papelera y suministros de oficina"})]})})]})]}),_.jsx(er.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.1},children:_.jsx(CM,{})}),_.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6",children:l.map((c,u)=>{const f=c.icon;return _.jsxs(er.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:u*.1},className:"bg-white p-6 rounded-xl shadow-lg border border-gray-100 hover:shadow-xl transition-shadow duration-300",children:[_.jsxs("div",{className:"flex items-center justify-between mb-4",children:[_.jsx("div",{className:`p-3 rounded-lg bg-${c.color}-100`,children:_.jsx(f,{className:`h-6 w-6 text-${c.color}-600`})}),_.jsxs("div",{className:"flex items-center px-2 py-1 rounded-full text-xs font-medium bg-green-50 text-green-600",children:[_.jsx(Yv,{className:"h-3 w-3 mr-1"}),c.trend]})]}),_.jsx("p",{className:`text-sm font-medium text-${c.color}-600 mb-1`,children:c.title}),_.jsx("p",{className:`text-2xl font-bold text-${c.color}-800`,children:c.value})]},c.title)})}),_.jsxs(er.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.4},className:"bg-white p-6 rounded-xl shadow-lg border border-gray-100",children:[_.jsx("h3",{className:"font-semibold text-gray-800 text-lg mb-6",children:"ltimos Movimientos"}),_.jsx("div",{className:"overflow-x-auto",children:_.jsxs("table",{className:"w-full text-left",children:[_.jsx("thead",{children:_.jsxs("tr",{className:"border-b border-gray-200",children:[_.jsx("th",{className:"pb-3 font-medium text-gray-500 text-sm",children:"Fecha"}),_.jsx("th",{className:"pb-3 font-medium text-gray-500 text-sm",children:"Artculo"}),_.jsx("th",{className:"pb-3 font-medium text-gray-500 text-sm",children:"Tipo"}),_.jsx("th",{className:"pb-3 font-medium text-gray-500 text-sm",children:"Cantidad"}),_.jsx("th",{className:"pb-3 font-medium text-gray-500 text-sm",children:"Valor"})]})}),_.jsx("tbody",{children:o.map(c=>{const u=e.find(f=>f.id===c.id_articulo);return _.jsxs("tr",{className:"border-b border-gray-100 hover:bg-gray-50 transition-colors",children:[_.jsx("td",{className:"py-4 text-sm text-gray-600",children:c.fecha}),_.jsx("td",{className:"py-4 text-sm font-medium text-gray-900",children:(u==null?void 0:u.nombre)||"Artculo no encontrado"}),_.jsx("td",{className:"py-4",children:_.jsx("span",{className:`inline-block px-2 py-1 rounded-full text-xs font-medium ${c.tipo==="Entrada"?"bg-green-100 text-green-800":"bg-red-100 text-red-800"}`,children:c.tipo})}),_.jsxs("td",{className:"py-4 text-sm text-gray-900",children:[c.cantidad," unidades"]}),_.jsx("td",{className:"py-4 text-sm font-medium text-gray-900",children:Gt(c.cantidad*c.costo)})]},c.id)})})]})})]})]})},Vu=e=>`$${e.toFixed(2)}`,bm=(e,t)=>[e.join(","),...t.map(n=>n.map(a=>`"${a}"`).join(","))].join(`
`),_m=(e,t)=>{const r=new Blob([e],{type:"text/csv;charset=utf-8;"}),n=document.createElement("a"),a=URL.createObjectURL(r);n.setAttribute("href",a),n.setAttribute("download",t),n.style.visibility="hidden",document.body.appendChild(n),n.click(),document.body.removeChild(n),URL.revokeObjectURL(a)},Nh=(e,t,r)=>{const n=new Date().toLocaleDateString("es-ES",{weekday:"long",year:"numeric",month:"long",day:"numeric"}),a=new Date().toLocaleTimeString("es-ES",{hour:"2-digit",minute:"2-digit"});let i="";if(r){const s=[];r.articleId&&s.push(`Artculo: ${r.articleId}`),r.type&&s.push(`Tipo: ${r.type}`),r.dateFrom&&r.dateTo?s.push(`Perodo: ${r.dateFrom} al ${r.dateTo}`):r.dateFrom?s.push(`Desde: ${r.dateFrom}`):r.dateTo&&s.push(`Hasta: ${r.dateTo}`),r.description&&s.push(`Descripcin: "${r.description}"`),r.status&&s.push(`Estado: ${r.status}`),s.length>0&&(i=`<div class="filters-info">Filtros aplicados: ${s.join(" | ")}</div>`)}return`
<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>${e}</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            margin: 20px;
            background: white;
            color: #000;
        }
        .header {
            display: flex;
            justify-content: space-between;
            align-items: flex-start;
            margin-bottom: 20px;
            padding-bottom: 15px;
            border-bottom: 2px solid #000;
        }
        .header h1 {
            margin: 0;
            font-size: 24px;
            font-weight: bold;
            color: #000;
        }
        .header .meta {
            text-align: right;
            font-size: 12px;
            color: #666;
        }
        .company-info {
            margin-bottom: 10px;
            font-weight: bold;
            color: #000;
        }
        .filters-info {
            margin-bottom: 15px;
            padding: 10px;
            background-color: #f0f0f0;
            border: 1px solid #ccc;
            border-radius: 4px;
            font-size: 12px;
            color: #333;
        }
        table {
            border-collapse: collapse;
            width: 100%;
            font-size: 11px;
            margin-top: 10px;
        }
        th, td {
            border: 1px solid #000;
            padding: 6px 8px;
            text-align: left;
        }
        th {
            background-color: #f0f0f0;
            font-weight: bold;
            color: #000;
        }
        .text-center {
            text-align: center;
        }
        .text-right {
            text-align: right;
        }
        .font-medium {
            font-weight: 600;
        }
        .status-badge {
            padding: 2px 6px;
            border-radius: 4px;
            font-size: 10px;
            font-weight: bold;
        }
        .status-success { background-color: #dcfce7; color: #166534; }
        .status-warning { background-color: #fef3c7; color: #92400e; }
        .status-error { background-color: #fee2e2; color: #991b1b; }
        .status-info { background-color: #dbeafe; color: #1e40af; }
        @media print {
            body { margin: 0; }
            .no-print { display: none; }
        }
    </style>
</head>
<body>
    <div class="header">
        <div>
            <div class="company-info">Sistema de Control de Inventario</div>
            <div class="company-info">Alcalda Municipal de Cabaas Oeste</div>
            <h1>${e}</h1>
            <div>${n} - ${a}</div>
        </div>
        <div class="meta">
            <div>Unidad de Informtica</div>
            <div>Pgina 1 de 1</div>
        </div>
    </div>
    
    ${i}
    ${t}
    
    <div style="margin-top: 30px; font-size: 10px; color: #666; text-align: center; border-top: 1px solid #ccc; padding-top: 10px;">
        Sistema de Control de Inventario - Generado automticamente el ${n} a las ${a}
    </div>
</body>
</html>`},Sm=(e,t)=>{const r=new Blob([e],{type:"text/html;charset=utf-8;"}),n=document.createElement("a"),a=URL.createObjectURL(r);n.setAttribute("href",a),n.setAttribute("download",t),n.style.visibility="hidden",document.body.appendChild(n),n.click(),document.body.removeChild(n),URL.revokeObjectURL(a)},km=()=>{window.print()},PM=(e,t,r)=>{const n=["ID","Artculo","Costo Unitario","Stock Actual","Valor Total"],a=e.map(o=>{const l=t(o.id),c=l*o.costo;return[o.id.toString(),o.nombre,Vu(o.costo),`${l} unidades`,Vu(c)]}),i=bm(n,a),s=`articulos_${new Date().toISOString().split("T")[0]}.csv`;_m(i,s)},LM=(e,t,r)=>{const n=["Fecha","Artculo","Tipo","Cantidad","Costo","Descripcin","Valor Total"],a=e.map(o=>[_A(o.fecha),t(o.id_articulo),o.tipo,o.cantidad.toString(),Vu(o.costo),o.descripcion||"",Vu(o.cantidad*o.costo)]),i=bm(n,a),s=`movimientos_${new Date().toISOString().split("T")[0]}.csv`;_m(i,s)},FM=(e,t,r)=>{const n=["Artculo","Stock","Costo Unitario","Valor Total","Estado"],a=e.map(o=>{const l=t(o.id),c=l*o.costo;let u="Stock Normal";return l===0?u="Sin Stock":l<=5&&(u="Stock Bajo"),[o.nombre,`${l} unidades`,Vu(o.costo),Vu(c),u]}),i=bm(n,a),s=`existencias_${new Date().toISOString().split("T")[0]}.csv`;_m(i,s)},Em=(e,t)=>`
    <table>
      <thead>
        <tr>
          ${e.map(r=>`<th>${r}</th>`).join("")}
        </tr>
      </thead>
      <tbody>
        ${t.map(r=>`
          <tr>
            ${r.map(n=>`<td>${n}</td>`).join("")}
          </tr>
        `).join("")}
      </tbody>
    </table>
  `,OM=({isOpen:e,onClose:t,article:r})=>{const{addArticle:n,updateArticle:a}=ds(),[i,s]=ie.useState({nombre:"",costo:""}),[o,l]=ie.useState(!1);ie.useEffect(()=>{s(r?{nombre:r.nombre,costo:r.costo.toString()}:{nombre:"",costo:""})},[r,e]);const c=async u=>{if(u.preventDefault(),!i.nombre.trim()||!i.costo||parseFloat(i.costo)<=0){ft.error("Por favor complete todos los campos correctamente");return}l(!0);try{const f={nombre:i.nombre.trim().toUpperCase(),costo:parseFloat(i.costo)};r?await a(r.id,f):await n(f),t()}catch{}finally{l(!1)}};return _.jsx(mm,{children:e&&_.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50",children:_.jsxs(er.div,{initial:{opacity:0,scale:.9},animate:{opacity:1,scale:1},exit:{opacity:0,scale:.9},className:"bg-white rounded-xl p-6 max-w-md w-full shadow-2xl",children:[_.jsxs("div",{className:"flex justify-between items-center mb-4",children:[_.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:r?"Editar Artculo":"Agregar Artculo"}),_.jsx("button",{onClick:t,className:"text-gray-400 hover:text-gray-600 transition-colors",children:_.jsx(Eh,{className:"h-6 w-6"})})]}),_.jsxs("form",{onSubmit:c,className:"space-y-4",children:[_.jsxs("div",{children:[_.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Nombre del Artculo"}),_.jsx("input",{type:"text",value:i.nombre,onChange:u=>s({...i,nombre:u.target.value}),className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all",required:!0})]}),_.jsxs("div",{children:[_.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Costo Unitario"}),_.jsx("input",{type:"number",step:"0.01",min:"0",value:i.costo,onChange:u=>s({...i,costo:u.target.value}),className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all",required:!0})]}),_.jsxs("div",{className:"flex gap-3 pt-4",children:[_.jsx("button",{type:"button",onClick:t,className:"flex-1 px-4 py-2 bg-gray-200 text-gray-800 rounded-lg hover:bg-gray-300 transition-colors font-medium",children:"Cancelar"}),_.jsxs("button",{type:"submit",disabled:o,className:"flex-1 px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors font-medium disabled:opacity-50 disabled:cursor-not-allowed flex items-center justify-center gap-2",children:[o?_.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white"}):_.jsx(Qy,{className:"h-4 w-4"}),o?"Guardando...":"Guardar"]})]})]})]})})})},DM=({isOpen:e,onClose:t,onConfirm:r,title:n,message:a,confirmText:i="Confirmar",cancelText:s="Cancelar",type:o="warning"})=>{const c={danger:{icon:"text-red-600",button:"bg-red-600 hover:bg-red-700",background:"bg-red-50"},warning:{icon:"text-yellow-600",button:"bg-yellow-600 hover:bg-yellow-700",background:"bg-yellow-50"},info:{icon:"text-blue-600",button:"bg-blue-600 hover:bg-blue-700",background:"bg-blue-50"}}[o];return _.jsx(mm,{children:e&&_.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50",children:_.jsxs(er.div,{initial:{opacity:0,scale:.9},animate:{opacity:1,scale:1},exit:{opacity:0,scale:.9},className:"bg-white rounded-xl p-6 max-w-md w-full shadow-2xl",children:[_.jsxs("div",{className:"flex items-center justify-between mb-4",children:[_.jsxs("div",{className:"flex items-center",children:[_.jsx("div",{className:`p-2 rounded-full ${c.background} mr-3`,children:_.jsx(gm,{className:`h-6 w-6 ${c.icon}`})}),_.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:n})]}),_.jsx("button",{onClick:t,className:"text-gray-400 hover:text-gray-600 transition-colors",children:_.jsx(Eh,{className:"h-6 w-6"})})]}),_.jsx("p",{className:"text-gray-600 mb-6",children:a}),_.jsxs("div",{className:"flex gap-3",children:[_.jsx("button",{onClick:t,className:"flex-1 px-4 py-2 bg-gray-200 text-gray-800 rounded-lg hover:bg-gray-300 transition-colors font-medium",children:s}),_.jsx("button",{onClick:()=>{r(),t()},className:`flex-1 px-4 py-2 text-white rounded-lg transition-colors font-medium ${c.button}`,children:i})]})]})})})},IM=()=>{const{articles:e,getStock:t,deleteArticle:r}=ds(),[n,a]=ie.useState(!1),[i,s]=ie.useState(null),[o,l]=ie.useState(""),[c,u]=ie.useState({dateFrom:"",dateTo:"",minCost:"",maxCost:"",stockStatus:""}),[f,p]=ie.useState(!1),[h,g]=ie.useState(null),m=N=>{const P=t(N);return P===0?"Sin Stock":P<=5?"Stock Bajo":"Stock Normal"},b=e.filter(N=>N.nombre.toLowerCase().includes(o.toLowerCase())&&(c.minCost===""||N.costo>=parseFloat(c.minCost))&&(c.maxCost===""||N.costo<=parseFloat(c.maxCost))&&(c.stockStatus===""||m(N.id)===c.stockStatus)),x=N=>{s(N),a(!0)},w=()=>{s(null),a(!0)},y=async N=>{const P=t(N);if(P>0){ft.error(`No se puede eliminar un artculo que tiene existencias. Stock actual: ${P} unidades`);return}g(N)},A=()=>{l(""),u({dateFrom:"",dateTo:"",minCost:"",maxCost:"",stockStatus:""})},L=()=>{km()},D=N=>`$${N.toFixed(2)}`,T=()=>{const N=["ID","Artculo","Costo Unitario","Stock Actual","Valor Total"],P=b.map(fe=>{const U=t(fe.id),Q=U*fe.costo;return[fe.id.toString(),fe.nombre,D(fe.costo),`${U} unidades`,D(Q)]}),J=Em(N,P),W=Nh("Gestin de Artculos",J,{description:o,...c}),se=`articulos_${new Date().toISOString().split("T")[0]}.html`;Sm(W,se),ft.success("Artculos exportados a PDF/HTML")},F=()=>{PM(b,t,{description:o,...c}),ft.success("Artculos exportados a CSV")},R=h!==null?e.find(N=>N.id===h):null,X=R?t(R.id):null;return _.jsxs("div",{className:"space-y-8",children:[_.jsx(er.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},className:"bg-white rounded-2xl shadow-lg p-8 border border-gray-100",children:_.jsxs("div",{className:"flex items-center justify-between",children:[_.jsxs("div",{children:[_.jsx("h2",{className:"text-3xl font-bold text-gray-900 mb-2",children:"Gestin de Artculos"}),_.jsx("p",{className:"text-gray-600",children:"Administra el catlogo de productos del inventario"})]}),_.jsxs("button",{onClick:w,className:"px-6 py-3 bg-blue-600 text-white rounded-lg hover:bg-blue-700 flex items-center justify-center gap-2 font-medium transition-all duration-300 shadow-lg hover:shadow-xl",children:[_.jsx(rA,{className:"h-4 w-4"}),"Nuevo Artculo"]})]})}),_.jsx(er.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.1},className:"bg-white rounded-xl shadow-lg p-6 border border-gray-100",children:_.jsxs("div",{className:"flex flex-col md:flex-row gap-4 items-center",children:[_.jsxs("div",{className:"flex-1 relative w-full",children:[_.jsx(nA,{className:"absolute left-3 top-3 h-5 w-5 text-gray-400"}),_.jsx("input",{type:"text",placeholder:"Buscar artculo por nombre...",value:o,onChange:N=>l(N.target.value),className:"w-full pl-10 pr-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all"})]}),_.jsx("div",{className:"flex justify-end w-full md:w-auto",children:_.jsx("button",{onClick:A,className:"px-4 py-2 bg-gray-100 text-gray-700 rounded-lg hover:bg-gray-200 transition-colors font-medium",children:"Limpiar filtro"})})]})}),_.jsxs(er.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.2},className:"bg-white rounded-xl shadow-lg overflow-hidden border border-gray-100",children:[_.jsx("div",{className:"p-6 border-b border-gray-200",children:_.jsxs("div",{className:"flex justify-between items-center",children:[_.jsxs("div",{children:[_.jsx("h3",{className:"font-semibold text-gray-800 text-lg",children:"Lista de Artculos"}),_.jsx("p",{className:"text-sm text-gray-600 mt-1",children:"Gestiona todos los artculos del inventario"})]}),_.jsxs("div",{className:"flex gap-2",children:[_.jsxs("button",{onClick:L,className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 flex items-center gap-2 font-medium",children:[_.jsx(eh,{className:"h-5 w-5"})," Imprimir"]}),_.jsxs("button",{onClick:T,className:"px-4 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700 flex items-center gap-2 font-medium",children:[_.jsx(is,{className:"h-5 w-5"})," PDF"]}),_.jsxs("button",{onClick:F,className:"px-4 py-2 bg-gray-700 text-white rounded-lg hover:bg-gray-800 flex items-center gap-2 font-medium",children:[_.jsx(is,{className:"h-5 w-5"})," CSV"]})]})]})}),_.jsx("div",{className:"overflow-x-auto",children:_.jsxs("table",{className:"w-full",children:[_.jsx("thead",{className:"bg-gray-50",children:_.jsxs("tr",{children:[_.jsx("th",{className:"px-6 py-4 text-left text-sm font-semibold text-gray-900",children:"ID"}),_.jsx("th",{className:"px-6 py-4 text-left text-sm font-semibold text-gray-900",children:"Artculo"}),_.jsx("th",{className:"px-6 py-4 text-left text-sm font-semibold text-gray-900",children:"Costo Unitario"}),_.jsx("th",{className:"px-6 py-4 text-left text-sm font-semibold text-gray-900",children:"Stock Actual"}),_.jsx("th",{className:"px-6 py-4 text-left text-sm font-semibold text-gray-900",children:"Valor Total"}),_.jsx("th",{className:"px-6 py-4 text-center text-sm font-semibold text-gray-900",children:"Acciones"})]})}),_.jsx("tbody",{className:"divide-y divide-gray-200",children:b.length===0?_.jsx("tr",{children:_.jsx("td",{colSpan:7,className:"px-6 py-8 text-center text-gray-500",children:"No hay artculos registrados"})}):b.map(N=>{const P=t(N.id),J=P*N.costo;return _.jsxs("tr",{className:"hover:bg-gray-50",children:[_.jsx("td",{className:"px-6 py-4 text-sm text-gray-900",children:N.id}),_.jsx("td",{className:"px-6 py-4 text-sm font-medium text-gray-900",children:N.nombre}),_.jsx("td",{className:"px-6 py-4 text-sm text-gray-900",children:Gt(N.costo)}),_.jsx("td",{className:"px-6 py-4 text-sm",children:_.jsxs("span",{className:`inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium ${P===0?"bg-red-100 text-red-800":P<10?"bg-yellow-100 text-yellow-800":"bg-green-100 text-green-800"}`,children:[P," unidades"]})}),_.jsx("td",{className:"px-6 py-4 text-sm font-medium text-gray-900",children:Gt(J)}),_.jsx("td",{className:"px-6 py-4 text-center no-print",children:_.jsxs("div",{className:"flex items-center justify-center gap-2",children:[_.jsx("button",{onClick:()=>x(N),className:"p-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors",title:"Editar artculo",children:_.jsx(Vj,{className:"h-4 w-4"})}),_.jsx("button",{onClick:()=>y(N.id),className:"p-2 bg-red-600 text-white rounded-lg hover:bg-red-700 transition-colors",title:"Eliminar artculo",children:_.jsx($j,{className:"h-4 w-4"})})]})})]},N.id)})})]})}),f&&_.jsxs(er.div,{initial:{opacity:0,height:0},animate:{opacity:1,height:"auto"},exit:{opacity:0,height:0},className:"bg-white rounded-xl shadow-lg p-6 border border-gray-100",children:[_.jsxs("div",{className:"flex justify-between items-center mb-4",children:[_.jsx("h3",{className:"font-semibold text-gray-800",children:"Filtros Avanzados"}),_.jsx("button",{onClick:()=>p(!1),className:"text-gray-400 hover:text-gray-600",children:_.jsx(Eh,{className:"h-5 w-5"})})]}),_.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4",children:[_.jsxs("div",{children:[_.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Costo Mnimo"}),_.jsx("input",{type:"number",step:"0.01",min:"0",value:c.minCost,onChange:N=>u({...c,minCost:N.target.value}),className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",placeholder:"0.00"})]}),_.jsxs("div",{children:[_.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Costo Mximo"}),_.jsx("input",{type:"number",step:"0.01",min:"0",value:c.maxCost,onChange:N=>u({...c,maxCost:N.target.value}),className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",placeholder:"999.99"})]}),_.jsxs("div",{children:[_.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Estado de Stock"}),_.jsxs("select",{value:c.stockStatus,onChange:N=>u({...c,stockStatus:N.target.value}),className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",children:[_.jsx("option",{value:"",children:"Todos los estados"}),_.jsx("option",{value:"Sin Stock",children:"Sin Stock"}),_.jsx("option",{value:"Stock Normal",children:"Stock Normal"})]})]}),_.jsxs("div",{className:"flex items-end",children:[_.jsxs("button",{onClick:L,className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors flex items-center gap-2",children:[_.jsx(eh,{className:"h-4 w-4"}),"Imprimir"]}),_.jsxs("button",{onClick:T,className:"px-4 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700 transition-colors flex items-center gap-2",children:[_.jsx(is,{className:"h-4 w-4"}),"PDF"]}),_.jsxs("button",{onClick:F,className:"px-4 py-2 bg-gray-600 text-white rounded-lg hover:bg-gray-700 transition-colors flex items-center gap-2",children:[_.jsx(is,{className:"h-4 w-4"}),"CSV"]})]})]})]})]}),_.jsx(DM,{isOpen:h!==null,onClose:()=>g(null),onConfirm:async()=>{if(h!==null)try{await r(h),g(null)}catch{}},title:"Advertencia de Eliminacin!",message:X===0?"Ests seguro de que deseas eliminar este artculo? Esta accin es irreversible.":"Si eliminas este artculo, tambin se eliminarn TODAS las entradas y salidas asociadas a l. Esta accin es irreversible. Deseas continuar?",confirmText:"S, eliminar todo",cancelText:"Cancelar",type:"danger"}),_.jsx(OM,{isOpen:n,onClose:()=>a(!1),article:i})]})},RM=({isOpen:e,onClose:t,movementToEdit:r})=>{const{articles:n,addMovement:a,updateMovement:i,getStock:s,movements:o}=ds(),[l,c]=ie.useState({id_articulo:"",tipo:"",cantidad:"",fecha:new Date().toISOString().split("T")[0],descripcion:""}),[u,f]=ie.useState(!1),[p,h]=ie.useState("");Fi.useEffect(()=>{c(r?{id_articulo:r.id_articulo.toString(),tipo:r.tipo,cantidad:r.cantidad.toString(),fecha:r.fecha,descripcion:r.descripcion}:{id_articulo:"",tipo:"",cantidad:"",fecha:new Date().toISOString().split("T")[0],descripcion:""})},[r,e]);const g=async m=>{if(m.preventDefault(),!l.id_articulo||!l.tipo||!l.cantidad||!l.descripcion){ft.error("Por favor complete todos los campos");return}const b=parseInt(l.id_articulo),x=parseInt(l.cantidad);if(x<=0){console.log("VALIDACIN FALLIDA: cantidad menor o igual a 0"),ft.error("La cantidad debe ser mayor a 0");return}if(l.tipo==="Entrada"){if(r){const y=o.filter(A=>A.id_articulo===b&&A.tipo==="Salida"&&new Date(A.fecha)>=new Date(l.fecha)).reduce((A,L)=>A+L.cantidad,0);if(x<y){const A=`No puedes registrar una entrada menor a las salidas ya realizadas (${y} unidades).`;h(A),console.log("VALIDACIN FALLIDA: entrada menor a salidas posteriores",A),ft.error(A);return}else h("")}}else if(l.tipo==="Salida"){const w=o.filter(D=>D.id_articulo===b&&D.tipo==="Entrada"),y=o.filter(D=>D.id_articulo===b&&D.tipo==="Salida"&&D.id!==(r?r.id:null)),A=w.reduce((D,T)=>D+T.cantidad,0),L=y.reduce((D,T)=>D+T.cantidad,0);if(L+x>A){console.log("VALIDACIN FALLIDA: salida mayor al stock disponible",{totalSalidas:L,cantidad:x,totalEntradas:A}),ft.error("No puedes registrar una salida mayor al stock disponible.");return}}f(!0);try{const w=n.find(A=>A.id===b);if(!w){ft.error("Artculo no encontrado");return}const y={id_articulo:b,tipo:l.tipo,cantidad:x,fecha:l.fecha,descripcion:l.descripcion.trim().toUpperCase(),costo:w.costo};r?await i(r.id,y):await a(y),c({id_articulo:"",tipo:"",cantidad:"",fecha:new Date().toISOString().split("T")[0],descripcion:""}),t()}catch{}finally{f(!1)}};return _.jsx(mm,{children:e&&_.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50",children:_.jsxs(er.div,{initial:{opacity:0,scale:.9},animate:{opacity:1,scale:1},exit:{opacity:0,scale:.9},className:"bg-white rounded-xl p-6 max-w-md w-full shadow-2xl",children:[_.jsxs("div",{className:"flex justify-between items-center mb-4",children:[_.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:r?"Editar Movimiento":"Registrar Movimiento"}),_.jsx("button",{onClick:t,className:"text-gray-400 hover:text-gray-600 transition-colors",children:_.jsx(Eh,{className:"h-6 w-6"})})]}),_.jsxs("form",{onSubmit:g,className:"space-y-4",children:[_.jsxs("div",{children:[_.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Artculo"}),_.jsxs("select",{value:l.id_articulo,onChange:m=>c({...l,id_articulo:m.target.value}),className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all",required:!0,children:[_.jsx("option",{value:"",children:"Seleccionar artculo..."}),n.map(m=>_.jsx("option",{value:m.id,children:m.nombre},m.id))]})]}),_.jsxs("div",{children:[_.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Tipo de Movimiento"}),_.jsxs("select",{value:l.tipo,onChange:m=>c({...l,tipo:m.target.value}),className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all",required:!0,children:[_.jsx("option",{value:"",children:"Seleccionar tipo..."}),_.jsx("option",{value:"Entrada",children:"Entrada"}),_.jsx("option",{value:"Salida",children:"Salida"})]})]}),_.jsxs("div",{children:[_.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Cantidad"}),_.jsx("input",{type:"number",min:"1",value:l.cantidad,onChange:m=>c({...l,cantidad:m.target.value}),className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all",required:!0})]}),_.jsxs("div",{children:[_.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Fecha"}),_.jsx("input",{type:"date",value:l.fecha,onChange:m=>c({...l,fecha:m.target.value}),className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all",required:!0})]}),_.jsxs("div",{children:[_.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Descripcin"}),_.jsx("textarea",{rows:3,value:l.descripcion,onChange:m=>c({...l,descripcion:m.target.value}),className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all",required:!0})]}),_.jsxs("div",{children:[_.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Costo Unitario"}),_.jsx("input",{type:"number",value:(()=>{const m=n.find(b=>b.id===parseInt(l.id_articulo));return m?m.costo:""})(),readOnly:!0,className:"w-full px-4 py-2 border border-gray-300 rounded-lg bg-gray-100 focus:ring-0 focus:border-gray-300 transition-all",placeholder:"Selecciona un artculo"})]}),_.jsxs("div",{className:"flex gap-3 pt-4",children:[_.jsx("button",{type:"button",onClick:t,className:"flex-1 px-4 py-2 bg-gray-200 text-gray-800 rounded-lg hover:bg-gray-300 transition-colors font-medium",children:"Cancelar"}),_.jsxs("button",{type:"submit",disabled:u,className:"flex-1 px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors font-medium disabled:opacity-50 disabled:cursor-not-allowed flex items-center justify-center gap-2",children:[u?_.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white"}):_.jsx(Qy,{className:"h-4 w-4"}),u?"Registrando...":"Registrar"]})]})]})]})})})},jM=()=>{const{movements:e,articles:t,deleteMovement:r,actualizarCostosMovimientos:n}=ds(),[a,i]=ie.useState(!1),[s,o]=ie.useState({articleId:"",type:"",month:"",year:"",description:""}),[l,c]=ie.useState(null),u=e.filter(w=>{if(t.find(y=>y.id===w.id_articulo),s.articleId&&w.id_articulo!==parseInt(s.articleId)||s.type&&w.tipo!==s.type)return!1;if(s.month&&s.year&&w.fecha){const y=new Date(w.fecha);if(y.getMonth()+1!==parseInt(s.month)||y.getFullYear()!==parseInt(s.year))return!1}return!(s.description&&!w.descripcion.toLowerCase().includes(s.description.toLowerCase()))}),f=w=>{const y=t.find(A=>A.id===w);return y?y.nombre:"Artculo no encontrado"},p=()=>{o({articleId:"",type:"",month:"",year:"",description:""})},h=()=>{km()},g=w=>`$${w.toFixed(2)}`,m=()=>{const w=["Fecha","Artculo","Tipo","Cantidad","Costo","Descripcin","Valor Total"],y=u.map(T=>[T.fecha,f(T.id_articulo),T.tipo,T.cantidad.toString(),g(T.costo),T.descripcion||"",g(T.cantidad*T.costo)]),A=Em(w,y),L=Nh("Movimientos de Inventario",A,s),D=`movimientos_${new Date().toISOString().split("T")[0]}.html`;Sm(L,D),ft.success("Movimientos exportados a PDF/HTML")},b=()=>{LM(u,f),ft.success("Movimientos exportados a CSV")},x=async w=>{const y=f(w.id_articulo);if(w.tipo==="Entrada"&&e.some(L=>L.id_articulo===w.id_articulo&&L.tipo==="Salida"&&new Date(L.fecha)>=new Date(w.fecha))){ft.error("No se puede eliminar esta entrada porque existen salidas asociadas posteriores. Solo puede editarse.");return}if(window.confirm(`Seguro que deseas eliminar el movimiento de "${y}"?`))try{await r(w.id)}catch{}};return _.jsxs("div",{className:"space-y-8",children:[_.jsx(er.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},className:"bg-white rounded-2xl shadow-lg p-8 border border-gray-100",children:_.jsxs("div",{className:"flex items-center justify-between",children:[_.jsxs("div",{children:[_.jsx("h2",{className:"text-3xl font-bold text-gray-900 mb-2",children:"Movimientos de Inventario"}),_.jsx("p",{className:"text-gray-600",children:"Registra entradas y salidas de productos"})]}),_.jsxs("button",{onClick:()=>i(!0),className:"px-6 py-3 bg-blue-600 text-white rounded-lg hover:bg-blue-700 flex items-center justify-center gap-2 font-medium transition-all duration-300 shadow-lg hover:shadow-xl",children:[_.jsx(rA,{className:"h-4 w-4"}),"Nuevo Movimiento"]})]})}),_.jsxs(er.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.1},className:"bg-white rounded-xl shadow-lg p-6 border border-gray-100",children:[_.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-6 gap-4",children:[_.jsxs("div",{children:[_.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Filtrar por Artculo"}),_.jsxs("select",{value:s.articleId,onChange:w=>o({...s,articleId:w.target.value}),className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",children:[_.jsx("option",{value:"",children:"Todos los artculos"}),t.map(w=>_.jsx("option",{value:w.id,children:w.nombre},w.id))]})]}),_.jsxs("div",{children:[_.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Tipo de Movimiento"}),_.jsxs("select",{value:s.type,onChange:w=>o({...s,type:w.target.value}),className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",children:[_.jsx("option",{value:"",children:"Todos los tipos"}),_.jsx("option",{value:"Entrada",children:"Entrada"}),_.jsx("option",{value:"Salida",children:"Salida"})]})]}),_.jsxs("div",{children:[_.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Mes"}),_.jsxs("select",{value:s.month,onChange:w=>o({...s,month:w.target.value}),className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",children:[_.jsx("option",{value:"",children:"Todos los meses"}),_.jsx("option",{value:"1",children:"Enero"}),_.jsx("option",{value:"2",children:"Febrero"}),_.jsx("option",{value:"3",children:"Marzo"}),_.jsx("option",{value:"4",children:"Abril"}),_.jsx("option",{value:"5",children:"Mayo"}),_.jsx("option",{value:"6",children:"Junio"}),_.jsx("option",{value:"7",children:"Julio"}),_.jsx("option",{value:"8",children:"Agosto"}),_.jsx("option",{value:"9",children:"Septiembre"}),_.jsx("option",{value:"10",children:"Octubre"}),_.jsx("option",{value:"11",children:"Noviembre"}),_.jsx("option",{value:"12",children:"Diciembre"})]})]}),_.jsxs("div",{children:[_.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Ao"}),_.jsxs("select",{value:s.year,onChange:w=>o({...s,year:w.target.value}),className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",children:[_.jsx("option",{value:"",children:"Todos los aos"}),(()=>{const w=new Date().getFullYear(),y=[];for(let A=2023;A<=w;A++)y.push(_.jsx("option",{value:A,children:A},A));return y})()]})]}),_.jsxs("div",{children:[_.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Descripcin"}),_.jsx("input",{type:"text",placeholder:"Buscar en descripcin...",value:s.description,onChange:w=>o({...s,description:w.target.value}),className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500"})]}),_.jsx("div",{className:"flex items-end",children:_.jsx("button",{onClick:p,className:"w-full px-4 py-2 bg-gray-100 text-gray-700 rounded-lg hover:bg-gray-200 transition-colors font-medium",children:"Limpiar Filtros"})})]}),_.jsx("div",{className:"flex justify-between items-center mt-4",children:_.jsxs("div",{className:"text-sm text-gray-600",children:["Mostrando ",u.length," de ",e.length," movimientos"]})})]}),_.jsxs(er.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.2},className:"bg-white rounded-xl shadow-lg overflow-hidden border border-gray-100",children:[_.jsx("div",{className:"p-6 border-b border-gray-200",children:_.jsxs("div",{className:"flex justify-between items-center",children:[_.jsxs("div",{children:[_.jsx("h3",{className:"font-semibold text-gray-800 text-lg",children:"Historial de Movimientos"}),_.jsx("p",{className:"text-sm text-gray-600 mt-1",children:"Registro filtrado de entradas y salidas"})]}),_.jsxs("div",{className:"flex gap-2",children:[_.jsxs("button",{onClick:h,className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 flex items-center gap-2 font-medium",children:[_.jsx(eh,{className:"h-5 w-5"})," Imprimir"]}),_.jsxs("button",{onClick:m,className:"px-4 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700 flex items-center gap-2 font-medium",children:[_.jsx(is,{className:"h-5 w-5"})," PDF"]}),_.jsxs("button",{onClick:b,className:"px-4 py-2 bg-gray-700 text-white rounded-lg hover:bg-gray-800 flex items-center gap-2 font-medium",children:[_.jsx(is,{className:"h-5 w-5"})," CSV"]})]})]})}),_.jsx("div",{className:"overflow-x-auto",children:_.jsxs("table",{className:"w-full",children:[_.jsx("thead",{className:"bg-gray-50",children:_.jsxs("tr",{children:[_.jsx("th",{className:"px-6 py-4 text-left text-sm font-semibold text-gray-900 min-w-[130px]",children:"Fecha"}),_.jsx("th",{className:"px-6 py-4 text-left text-sm font-semibold text-gray-900",children:"Artculo"}),_.jsx("th",{className:"px-6 py-4 text-left text-sm font-semibold text-gray-900",children:"Tipo"}),_.jsx("th",{className:"px-6 py-4 text-left text-sm font-semibold text-gray-900",children:"Cantidad"}),_.jsx("th",{className:"px-6 py-4 text-left text-sm font-semibold text-gray-900",children:"Costo"}),_.jsx("th",{className:"px-6 py-4 text-left text-sm font-semibold text-gray-900",children:"Descripcin"}),_.jsx("th",{className:"px-6 py-4 text-left text-sm font-semibold text-gray-900",children:"Valor Total"})]})}),_.jsxs("tbody",{className:"divide-y divide-gray-200",children:[u.map(w=>_.jsxs("tr",{className:"hover:bg-gray-50 transition-colors",children:[_.jsx("td",{className:"px-6 py-4 text-sm text-gray-600 min-w-[130px]",children:w.fecha}),_.jsx("td",{className:"px-6 py-4 text-sm font-medium text-gray-900",children:f(w.id_articulo)}),_.jsx("td",{className:"px-6 py-4",children:_.jsx("span",{className:`inline-block px-2 py-1 rounded-full text-xs font-medium ${w.tipo==="Entrada"?"bg-green-100 text-green-800":"bg-red-100 text-red-800"}`,children:w.tipo})}),_.jsx("td",{className:"px-6 py-4 text-sm text-gray-900",children:w.cantidad}),_.jsx("td",{className:"px-6 py-4 text-sm text-gray-900",children:Gt(w.costo)}),_.jsx("td",{className:"px-6 py-4 text-sm text-gray-600",children:w.descripcion}),_.jsx("td",{className:"px-6 py-4 text-sm font-medium text-gray-900",children:Gt(w.cantidad*w.costo)}),_.jsxs("td",{className:"px-6 py-4 text-center no-print flex gap-2 justify-center",children:[_.jsx("button",{className:"p-2 rounded-full bg-yellow-100 hover:bg-yellow-200 text-yellow-700 transition-colors",title:"Editar",onClick:()=>{c(w),i(!0)},children:_.jsx(tA,{className:"w-4 h-4"})}),_.jsx("button",{className:"p-2 rounded-full bg-red-100 hover:bg-red-200 text-red-700 transition-colors",title:"Eliminar",onClick:()=>x(w),children:_.jsx(aA,{className:"w-4 h-4"})})]})]},w.id)),u.length===0&&_.jsx("tr",{children:_.jsx("td",{colSpan:8,className:"px-6 py-8 text-center text-gray-500",children:"No se encontraron movimientos que coincidan con los filtros aplicados"})})]})]})})]}),_.jsx(RM,{isOpen:a,onClose:()=>{i(!1),c(null)},movementToEdit:l})]})},Qb=e=>`$${e.toFixed(2)}`,MM=()=>{const{articles:e,getStock:t}=ds(),[r,n]=Fi.useState({articleId:"",status:""}),i=e.filter(m=>{if(r.articleId&&m.id!==parseInt(r.articleId))return!1;const b=t(m.id);b*m.costo;let x;return b===0?x="Sin Stock":b<=5?x="Stock Bajo":x="Stock Normal",!(r.status&&x!==r.status)}),s=i.map(m=>{const b=t(m.id),x=b*m.costo;let w;return b===0?w="Sin Stock":b<=5?w="Stock Bajo":w="Stock Normal",{article:m,stock:b,totalValue:x,status:w}}),o=s.reduce((m,b)=>m+b.stock,0),l=s.filter(m=>m.stock<=5).length,c=s.reduce((m,b)=>m+b.totalValue,0),u=()=>{n({articleId:"",status:""})},f=()=>{km()},p=()=>{const m=["Artculo","Stock","Costo Unitario","Valor Total","Estado"],b=s.map(({article:A,stock:L,totalValue:D,status:T})=>[A.nombre,`${L} unidades`,Qb(A.costo),Qb(D),T]),x=Em(m,b),w=Nh("Control de Existencias",x,r),y=`existencias_${new Date().toISOString().split("T")[0]}.html`;Sm(w,y),ft.success("Existencias exportadas a PDF/HTML")},h=()=>{FM(i,t),ft.success("Existencias exportadas a CSV")},g=[{title:"Total Unidades",value:o,icon:Jy,color:"blue"},{title:"Stock Bajo",value:l,icon:gm,color:"red"},{title:"Valor Total",value:Gt(c),icon:Z6,color:"green"}];return _.jsxs("div",{className:"space-y-8",children:[_.jsx(er.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},className:"bg-white rounded-2xl shadow-lg p-8 border border-gray-100",children:_.jsx("div",{className:"flex items-center justify-between",children:_.jsxs("div",{children:[_.jsx("h2",{className:"text-3xl font-bold text-gray-900 mb-2",children:"Control de Existencias"}),_.jsx("p",{className:"text-gray-600",children:"Visualiza el stock de productos por perodo y artculo"})]})})}),_.jsxs(er.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.1},className:"bg-white rounded-xl shadow-lg p-6 border border-gray-100",children:[_.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-4 gap-4",children:[_.jsxs("div",{children:[_.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Filtrar por Artculo"}),_.jsxs("select",{value:r.articleId,onChange:m=>n({...r,articleId:m.target.value}),className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",children:[_.jsx("option",{value:"",children:"Todos los artculos"}),e.map(m=>_.jsx("option",{value:m.id,children:m.nombre},m.id))]})]}),_.jsxs("div",{children:[_.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Estado"}),_.jsxs("select",{value:r.status,onChange:m=>n({...r,status:m.target.value}),className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",children:[_.jsx("option",{value:"",children:"Todos los estados"}),_.jsx("option",{value:"Sin Stock",children:"Sin Stock"}),_.jsx("option",{value:"Stock Bajo",children:"Stock Bajo"}),_.jsx("option",{value:"Stock Normal",children:"Stock Normal"})]})]}),_.jsx("div",{className:"flex items-end",children:_.jsx("button",{onClick:u,className:"w-full px-4 py-2 bg-gray-100 text-gray-700 rounded-lg hover:bg-gray-200 transition-colors font-medium",children:"Limpiar Filtros"})})]}),_.jsx("div",{className:"flex justify-between items-center mt-4",children:_.jsxs("div",{className:"text-sm text-gray-600",children:["Mostrando ",i.length," de ",e.length," artculos"]})})]}),_.jsx("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:g.map((m,b)=>{const x=m.icon;return _.jsx(er.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:b*.1},className:"bg-white p-6 rounded-xl shadow-lg border border-gray-100",children:_.jsxs("div",{className:"flex items-center",children:[_.jsx("div",{className:`p-3 bg-${m.color}-100 rounded-lg mr-4`,children:_.jsx(x,{className:`h-6 w-6 text-${m.color}-600`})}),_.jsxs("div",{children:[_.jsx("p",{className:"text-sm font-medium text-gray-600",children:m.title}),_.jsx("p",{className:"text-2xl font-bold text-gray-900",children:m.value})]})]})},m.title)})}),_.jsxs(er.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.3},className:"bg-white rounded-xl shadow-lg overflow-hidden border border-gray-100",children:[_.jsx("div",{className:"p-6 border-b border-gray-200",children:_.jsxs("div",{className:"flex justify-between items-center",children:[_.jsxs("div",{children:[_.jsx("h3",{className:"font-semibold text-gray-800 text-lg",children:"Estado del Inventario"}),_.jsx("p",{className:"text-sm text-gray-600 mt-1",children:"Stock actual por artculo"})]}),_.jsxs("div",{className:"flex gap-2",children:[_.jsxs("button",{onClick:f,className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 flex items-center gap-2 font-medium",children:[_.jsx(eh,{className:"h-5 w-5"})," Imprimir"]}),_.jsxs("button",{onClick:p,className:"px-4 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700 flex items-center gap-2 font-medium",children:[_.jsx(is,{className:"h-5 w-5"})," PDF"]}),_.jsxs("button",{onClick:h,className:"px-4 py-2 bg-gray-700 text-white rounded-lg hover:bg-gray-800 flex items-center gap-2 font-medium",children:[_.jsx(is,{className:"h-5 w-5"})," CSV"]})]})]})}),_.jsx("div",{className:"overflow-x-auto",children:_.jsxs("table",{className:"w-full",children:[_.jsx("thead",{className:"bg-gray-50",children:_.jsxs("tr",{children:[_.jsx("th",{className:"px-6 py-4 text-left text-sm font-semibold text-gray-900",children:"Artculo"}),_.jsx("th",{className:"px-6 py-4 text-left text-sm font-semibold text-gray-900",children:"Stock"}),_.jsx("th",{className:"px-6 py-4 text-left text-sm font-semibold text-gray-900",children:"Costo Unitario"}),_.jsx("th",{className:"px-6 py-4 text-left text-sm font-semibold text-gray-900",children:"Valor Total"}),_.jsx("th",{className:"px-6 py-4 text-left text-sm font-semibold text-gray-900",children:"Estado"})]})}),_.jsxs("tbody",{className:"divide-y divide-gray-200",children:[s.map(({article:m,stock:b,totalValue:x,status:w})=>{const y=w==="Sin Stock"?"bg-red-100 text-red-800":w==="Stock Bajo"?"bg-yellow-100 text-yellow-800":"bg-green-100 text-green-800";return _.jsxs("tr",{className:"hover:bg-gray-50 transition-colors",children:[_.jsx("td",{className:"px-6 py-4 text-sm font-medium text-gray-900",children:m.nombre}),_.jsxs("td",{className:"px-6 py-4 text-sm text-gray-900",children:[b," unidades"]}),_.jsx("td",{className:"px-6 py-4 text-sm text-gray-900",children:Gt(m.costo)}),_.jsx("td",{className:"px-6 py-4 text-sm font-medium text-gray-900",children:Gt(x)}),_.jsx("td",{className:"px-6 py-4",children:_.jsx("span",{className:`inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium ${y}`,children:w})})]},m.id)}),s.length===0&&_.jsx("tr",{children:_.jsx("td",{colSpan:6,className:"px-6 py-8 text-center text-gray-500",children:"No se encontraron artculos que coincidan con los filtros aplicados"})})]})]})})]})]})};var Qv={exports:{}},ec={},SA={exports:{}},BM="SECRET_DO_NOT_PASS_THIS_OR_YOU_WILL_BE_FIRED",UM=BM,VM=UM;function kA(){}function EA(){}EA.resetWarningCache=kA;var $M=function(){function e(n,a,i,s,o,l){if(l!==VM){var c=new Error("Calling PropTypes validators directly is not supported by the `prop-types` package. Use PropTypes.checkPropTypes() to call them. Read more at http://fb.me/use-check-prop-types");throw c.name="Invariant Violation",c}}e.isRequired=e;function t(){return e}var r={array:e,bigint:e,bool:e,func:e,number:e,object:e,string:e,symbol:e,any:e,arrayOf:t,element:e,elementType:e,instanceOf:t,node:e,objectOf:t,oneOf:t,oneOfType:t,shape:t,exact:t,checkPropTypes:EA,resetWarningCache:kA};return r.PropTypes=r,r};SA.exports=$M();var AA=SA.exports,Zv={exports:{}},$i={},ex={exports:{}};(function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.default=u;/*!
 * Adapted from jQuery UI core
 *
 * http://jqueryui.com
 *
 * Copyright 2014 jQuery Foundation and other contributors
 * Released under the MIT license.
 * http://jquery.org/license
 *
 * http://api.jqueryui.com/category/ui-core/
 */var r="none",n="contents",a=/^(input|select|textarea|button|object|iframe)$/;function i(f,p){return p.getPropertyValue("overflow")!=="visible"||f.scrollWidth<=0&&f.scrollHeight<=0}function s(f){var p=f.offsetWidth<=0&&f.offsetHeight<=0;if(p&&!f.innerHTML)return!0;try{var h=window.getComputedStyle(f),g=h.getPropertyValue("display");return p?g!==n&&i(f,h):g===r}catch{return console.warn("Failed to inspect element style"),!1}}function o(f){for(var p=f,h=f.getRootNode&&f.getRootNode();p&&p!==document.body;){if(h&&p===h&&(p=h.host.parentNode),s(p))return!1;p=p.parentNode}return!0}function l(f,p){var h=f.nodeName.toLowerCase(),g=a.test(h)&&!f.disabled||h==="a"&&f.href||p;return g&&o(f)}function c(f){var p=f.getAttribute("tabindex");p===null&&(p=void 0);var h=isNaN(p);return(h||p>=0)&&l(f,!h)}function u(f){var p=[].slice.call(f.querySelectorAll("*"),0).reduce(function(h,g){return h.concat(g.shadowRoot?u(g.shadowRoot):[g])},[]);return p.filter(c)}e.exports=t.default})(ex,ex.exports);var TA=ex.exports;Object.defineProperty($i,"__esModule",{value:!0});$i.resetState=qM;$i.log=GM;$i.handleBlur=rh;$i.handleFocus=nh;$i.markForFocusLater=KM;$i.returnFocus=XM;$i.popWithoutFocus=YM;$i.setupScopedFocus=JM;$i.teardownScopedFocus=QM;var zM=TA,HM=WM(zM);function WM(e){return e&&e.__esModule?e:{default:e}}var $u=[],pu=null,tx=!1;function qM(){$u=[]}function GM(){}function rh(){tx=!0}function nh(){if(tx){if(tx=!1,!pu)return;setTimeout(function(){if(!pu.contains(document.activeElement)){var e=(0,HM.default)(pu)[0]||pu;e.focus()}},0)}}function KM(){$u.push(document.activeElement)}function XM(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,t=null;try{$u.length!==0&&(t=$u.pop(),t.focus({preventScroll:e}));return}catch{console.warn(["You tried to return focus to",t,"but it is not in the DOM anymore"].join(" "))}}function YM(){$u.length>0&&$u.pop()}function JM(e){pu=e,window.addEventListener?(window.addEventListener("blur",rh,!1),document.addEventListener("focus",nh,!0)):(window.attachEvent("onBlur",rh),document.attachEvent("onFocus",nh))}function QM(){pu=null,window.addEventListener?(window.removeEventListener("blur",rh),document.removeEventListener("focus",nh)):(window.detachEvent("onBlur",rh),document.detachEvent("onFocus",nh))}var rx={exports:{}};(function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.default=s;var r=TA,n=a(r);function a(o){return o&&o.__esModule?o:{default:o}}function i(){var o=arguments.length>0&&arguments[0]!==void 0?arguments[0]:document;return o.activeElement.shadowRoot?i(o.activeElement.shadowRoot):o.activeElement}function s(o,l){var c=(0,n.default)(o);if(!c.length){l.preventDefault();return}var u=void 0,f=l.shiftKey,p=c[0],h=c[c.length-1],g=i();if(o===g){if(!f)return;u=h}if(h===g&&!f&&(u=p),p===g&&f&&(u=h),u){l.preventDefault(),u.focus();return}var m=/(\bChrome\b|\bSafari\b)\//.exec(navigator.userAgent),b=m!=null&&m[1]!="Chrome"&&/\biPod\b|\biPad\b/g.exec(navigator.userAgent)==null;if(b){var x=c.indexOf(g);if(x>-1&&(x+=f?-1:1),u=c[x],typeof u>"u"){l.preventDefault(),u=f?h:p,u.focus();return}l.preventDefault(),u.focus()}}e.exports=t.default})(rx,rx.exports);var ZM=rx.exports,zi={},eB=function(){},tB=eB,Bi={},CA={exports:{}};/*!
  Copyright (c) 2015 Jed Watson.
  Based on code that is Copyright 2013-2015, Facebook, Inc.
  All rights reserved.
*/(function(e){(function(){var t=!!(typeof window<"u"&&window.document&&window.document.createElement),r={canUseDOM:t,canUseWorkers:typeof Worker<"u",canUseEventListeners:t&&!!(window.addEventListener||window.attachEvent),canUseViewport:t&&!!window.screen};e.exports?e.exports=r:window.ExecutionEnvironment=r})()})(CA);var rB=CA.exports;Object.defineProperty(Bi,"__esModule",{value:!0});Bi.canUseDOM=Bi.SafeNodeList=Bi.SafeHTMLCollection=void 0;var nB=rB,aB=iB(nB);function iB(e){return e&&e.__esModule?e:{default:e}}var Am=aB.default,sB=Am.canUseDOM?window.HTMLElement:{};Bi.SafeHTMLCollection=Am.canUseDOM?window.HTMLCollection:{};Bi.SafeNodeList=Am.canUseDOM?window.NodeList:{};Bi.canUseDOM=Am.canUseDOM;Bi.default=sB;Object.defineProperty(zi,"__esModule",{value:!0});zi.resetState=fB;zi.log=hB;zi.assertNodeList=NA;zi.setElement=dB;zi.validateElement=i5;zi.hide=pB;zi.show=mB;zi.documentNotReadyOrSSRTesting=gB;var oB=tB,lB=uB(oB),cB=Bi;function uB(e){return e&&e.__esModule?e:{default:e}}var ni=null;function fB(){ni&&(ni.removeAttribute?ni.removeAttribute("aria-hidden"):ni.length!=null?ni.forEach(function(e){return e.removeAttribute("aria-hidden")}):document.querySelectorAll(ni).forEach(function(e){return e.removeAttribute("aria-hidden")})),ni=null}function hB(){}function NA(e,t){if(!e||!e.length)throw new Error("react-modal: No elements were found for selector "+t+".")}function dB(e){var t=e;if(typeof t=="string"&&cB.canUseDOM){var r=document.querySelectorAll(t);NA(r,t),t=r}return ni=t||ni,ni}function i5(e){var t=e||ni;return t?Array.isArray(t)||t instanceof HTMLCollection||t instanceof NodeList?t:[t]:((0,lB.default)(!1,["react-modal: App element is not defined.","Please use `Modal.setAppElement(el)` or set `appElement={el}`.","This is needed so screen readers don't see main content","when modal is opened. It is not recommended, but you can opt-out","by setting `ariaHideApp={false}`."].join(" ")),[])}function pB(e){var t=!0,r=!1,n=void 0;try{for(var a=i5(e)[Symbol.iterator](),i;!(t=(i=a.next()).done);t=!0){var s=i.value;s.setAttribute("aria-hidden","true")}}catch(o){r=!0,n=o}finally{try{!t&&a.return&&a.return()}finally{if(r)throw n}}}function mB(e){var t=!0,r=!1,n=void 0;try{for(var a=i5(e)[Symbol.iterator](),i;!(t=(i=a.next()).done);t=!0){var s=i.value;s.removeAttribute("aria-hidden")}}catch(o){r=!0,n=o}finally{try{!t&&a.return&&a.return()}finally{if(r)throw n}}}function gB(){ni=null}var Ju={};Object.defineProperty(Ju,"__esModule",{value:!0});Ju.resetState=vB;Ju.log=xB;var w0={},b0={};function Zb(e,t){e.classList.remove(t)}function vB(){var e=document.getElementsByTagName("html")[0];for(var t in w0)Zb(e,w0[t]);var r=document.body;for(var n in b0)Zb(r,b0[n]);w0={},b0={}}function xB(){}var yB=function(t,r){return t[r]||(t[r]=0),t[r]+=1,r},wB=function(t,r){return t[r]&&(t[r]-=1),r},bB=function(t,r,n){n.forEach(function(a){yB(r,a),t.add(a)})},_B=function(t,r,n){n.forEach(function(a){wB(r,a),r[a]===0&&t.remove(a)})};Ju.add=function(t,r){return bB(t.classList,t.nodeName.toLowerCase()=="html"?w0:b0,r.split(" "))};Ju.remove=function(t,r){return _B(t.classList,t.nodeName.toLowerCase()=="html"?w0:b0,r.split(" "))};var Qu={};Object.defineProperty(Qu,"__esModule",{value:!0});Qu.log=kB;Qu.resetState=EB;function SB(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var PA=function e(){var t=this;SB(this,e),this.register=function(r){t.openInstances.indexOf(r)===-1&&(t.openInstances.push(r),t.emit("register"))},this.deregister=function(r){var n=t.openInstances.indexOf(r);n!==-1&&(t.openInstances.splice(n,1),t.emit("deregister"))},this.subscribe=function(r){t.subscribers.push(r)},this.emit=function(r){t.subscribers.forEach(function(n){return n(r,t.openInstances.slice())})},this.openInstances=[],this.subscribers=[]},y1=new PA;function kB(){console.log("portalOpenInstances ----------"),console.log(y1.openInstances.length),y1.openInstances.forEach(function(e){return console.log(e)}),console.log("end portalOpenInstances ----------")}function EB(){y1=new PA}Qu.default=y1;var s5={};Object.defineProperty(s5,"__esModule",{value:!0});s5.resetState=NB;s5.log=PB;var AB=Qu,TB=CB(AB);function CB(e){return e&&e.__esModule?e:{default:e}}var jn=void 0,Ci=void 0,Wl=[];function NB(){for(var e=[jn,Ci],t=0;t<e.length;t++){var r=e[t];r&&r.parentNode&&r.parentNode.removeChild(r)}jn=Ci=null,Wl=[]}function PB(){console.log("bodyTrap ----------"),console.log(Wl.length);for(var e=[jn,Ci],t=0;t<e.length;t++){var r=e[t],n=r||{};console.log(n.nodeName,n.className,n.id)}console.log("edn bodyTrap ----------")}function e3(){Wl.length!==0&&Wl[Wl.length-1].focusContent()}function LB(e,t){!jn&&!Ci&&(jn=document.createElement("div"),jn.setAttribute("data-react-modal-body-trap",""),jn.style.position="absolute",jn.style.opacity="0",jn.setAttribute("tabindex","0"),jn.addEventListener("focus",e3),Ci=jn.cloneNode(),Ci.addEventListener("focus",e3)),Wl=t,Wl.length>0?(document.body.firstChild!==jn&&document.body.insertBefore(jn,document.body.firstChild),document.body.lastChild!==Ci&&document.body.appendChild(Ci)):(jn.parentElement&&jn.parentElement.removeChild(jn),Ci.parentElement&&Ci.parentElement.removeChild(Ci))}TB.default.subscribe(LB);(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var r=Object.assign||function(W){for(var se=1;se<arguments.length;se++){var fe=arguments[se];for(var U in fe)Object.prototype.hasOwnProperty.call(fe,U)&&(W[U]=fe[U])}return W},n=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(W){return typeof W}:function(W){return W&&typeof Symbol=="function"&&W.constructor===Symbol&&W!==Symbol.prototype?"symbol":typeof W},a=function(){function W(se,fe){for(var U=0;U<fe.length;U++){var Q=fe[U];Q.enumerable=Q.enumerable||!1,Q.configurable=!0,"value"in Q&&(Q.writable=!0),Object.defineProperty(se,Q.key,Q)}}return function(se,fe,U){return fe&&W(se.prototype,fe),U&&W(se,U),se}}(),i=ie,s=AA,o=L(s),l=$i,c=A(l),u=ZM,f=L(u),p=zi,h=A(p),g=Ju,m=A(g),b=Bi,x=L(b),w=Qu,y=L(w);function A(W){if(W&&W.__esModule)return W;var se={};if(W!=null)for(var fe in W)Object.prototype.hasOwnProperty.call(W,fe)&&(se[fe]=W[fe]);return se.default=W,se}function L(W){return W&&W.__esModule?W:{default:W}}function D(W,se){if(!(W instanceof se))throw new TypeError("Cannot call a class as a function")}function T(W,se){if(!W)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return se&&(typeof se=="object"||typeof se=="function")?se:W}function F(W,se){if(typeof se!="function"&&se!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof se);W.prototype=Object.create(se&&se.prototype,{constructor:{value:W,enumerable:!1,writable:!0,configurable:!0}}),se&&(Object.setPrototypeOf?Object.setPrototypeOf(W,se):W.__proto__=se)}var R={overlay:"ReactModal__Overlay",content:"ReactModal__Content"},X=function(se){return se.code==="Tab"||se.keyCode===9},N=function(se){return se.code==="Escape"||se.keyCode===27},P=0,J=function(W){F(se,W);function se(fe){D(this,se);var U=T(this,(se.__proto__||Object.getPrototypeOf(se)).call(this,fe));return U.setOverlayRef=function(Q){U.overlay=Q,U.props.overlayRef&&U.props.overlayRef(Q)},U.setContentRef=function(Q){U.content=Q,U.props.contentRef&&U.props.contentRef(Q)},U.afterClose=function(){var Q=U.props,q=Q.appElement,he=Q.ariaHideApp,xe=Q.htmlOpenClassName,E=Q.bodyOpenClassName,I=Q.parentSelector,O=I&&I().ownerDocument||document;E&&m.remove(O.body,E),xe&&m.remove(O.getElementsByTagName("html")[0],xe),he&&P>0&&(P-=1,P===0&&h.show(q)),U.props.shouldFocusAfterRender&&(U.props.shouldReturnFocusAfterClose?(c.returnFocus(U.props.preventScroll),c.teardownScopedFocus()):c.popWithoutFocus()),U.props.onAfterClose&&U.props.onAfterClose(),y.default.deregister(U)},U.open=function(){U.beforeOpen(),U.state.afterOpen&&U.state.beforeClose?(clearTimeout(U.closeTimer),U.setState({beforeClose:!1})):(U.props.shouldFocusAfterRender&&(c.setupScopedFocus(U.node),c.markForFocusLater()),U.setState({isOpen:!0},function(){U.openAnimationFrame=requestAnimationFrame(function(){U.setState({afterOpen:!0}),U.props.isOpen&&U.props.onAfterOpen&&U.props.onAfterOpen({overlayEl:U.overlay,contentEl:U.content})})}))},U.close=function(){U.props.closeTimeoutMS>0?U.closeWithTimeout():U.closeWithoutTimeout()},U.focusContent=function(){return U.content&&!U.contentHasFocus()&&U.content.focus({preventScroll:!0})},U.closeWithTimeout=function(){var Q=Date.now()+U.props.closeTimeoutMS;U.setState({beforeClose:!0,closesAt:Q},function(){U.closeTimer=setTimeout(U.closeWithoutTimeout,U.state.closesAt-Date.now())})},U.closeWithoutTimeout=function(){U.setState({beforeClose:!1,isOpen:!1,afterOpen:!1,closesAt:null},U.afterClose)},U.handleKeyDown=function(Q){X(Q)&&(0,f.default)(U.content,Q),U.props.shouldCloseOnEsc&&N(Q)&&(Q.stopPropagation(),U.requestClose(Q))},U.handleOverlayOnClick=function(Q){U.shouldClose===null&&(U.shouldClose=!0),U.shouldClose&&U.props.shouldCloseOnOverlayClick&&(U.ownerHandlesClose()?U.requestClose(Q):U.focusContent()),U.shouldClose=null},U.handleContentOnMouseUp=function(){U.shouldClose=!1},U.handleOverlayOnMouseDown=function(Q){!U.props.shouldCloseOnOverlayClick&&Q.target==U.overlay&&Q.preventDefault()},U.handleContentOnClick=function(){U.shouldClose=!1},U.handleContentOnMouseDown=function(){U.shouldClose=!1},U.requestClose=function(Q){return U.ownerHandlesClose()&&U.props.onRequestClose(Q)},U.ownerHandlesClose=function(){return U.props.onRequestClose},U.shouldBeClosed=function(){return!U.state.isOpen&&!U.state.beforeClose},U.contentHasFocus=function(){return document.activeElement===U.content||U.content.contains(document.activeElement)},U.buildClassName=function(Q,q){var he=(typeof q>"u"?"undefined":n(q))==="object"?q:{base:R[Q],afterOpen:R[Q]+"--after-open",beforeClose:R[Q]+"--before-close"},xe=he.base;return U.state.afterOpen&&(xe=xe+" "+he.afterOpen),U.state.beforeClose&&(xe=xe+" "+he.beforeClose),typeof q=="string"&&q?xe+" "+q:xe},U.attributesFromObject=function(Q,q){return Object.keys(q).reduce(function(he,xe){return he[Q+"-"+xe]=q[xe],he},{})},U.state={afterOpen:!1,beforeClose:!1},U.shouldClose=null,U.moveFromContentToOverlay=null,U}return a(se,[{key:"componentDidMount",value:function(){this.props.isOpen&&this.open()}},{key:"componentDidUpdate",value:function(U,Q){this.props.isOpen&&!U.isOpen?this.open():!this.props.isOpen&&U.isOpen&&this.close(),this.props.shouldFocusAfterRender&&this.state.isOpen&&!Q.isOpen&&this.focusContent()}},{key:"componentWillUnmount",value:function(){this.state.isOpen&&this.afterClose(),clearTimeout(this.closeTimer),cancelAnimationFrame(this.openAnimationFrame)}},{key:"beforeOpen",value:function(){var U=this.props,Q=U.appElement,q=U.ariaHideApp,he=U.htmlOpenClassName,xe=U.bodyOpenClassName,E=U.parentSelector,I=E&&E().ownerDocument||document;xe&&m.add(I.body,xe),he&&m.add(I.getElementsByTagName("html")[0],he),q&&(P+=1,h.hide(Q)),y.default.register(this)}},{key:"render",value:function(){var U=this.props,Q=U.id,q=U.className,he=U.overlayClassName,xe=U.defaultStyles,E=U.children,I=q?{}:xe.content,O=he?{}:xe.overlay;if(this.shouldBeClosed())return null;var j={ref:this.setOverlayRef,className:this.buildClassName("overlay",he),style:r({},O,this.props.style.overlay),onClick:this.handleOverlayOnClick,onMouseDown:this.handleOverlayOnMouseDown},K=r({id:Q,ref:this.setContentRef,style:r({},I,this.props.style.content),className:this.buildClassName("content",q),tabIndex:"-1",onKeyDown:this.handleKeyDown,onMouseDown:this.handleContentOnMouseDown,onMouseUp:this.handleContentOnMouseUp,onClick:this.handleContentOnClick,role:this.props.role,"aria-label":this.props.contentLabel},this.attributesFromObject("aria",r({modal:!0},this.props.aria)),this.attributesFromObject("data",this.props.data||{}),{"data-testid":this.props.testId}),ne=this.props.contentElement(K,E);return this.props.overlayElement(j,ne)}}]),se}(i.Component);J.defaultProps={style:{overlay:{},content:{}},defaultStyles:{}},J.propTypes={isOpen:o.default.bool.isRequired,defaultStyles:o.default.shape({content:o.default.object,overlay:o.default.object}),style:o.default.shape({content:o.default.object,overlay:o.default.object}),className:o.default.oneOfType([o.default.string,o.default.object]),overlayClassName:o.default.oneOfType([o.default.string,o.default.object]),parentSelector:o.default.func,bodyOpenClassName:o.default.string,htmlOpenClassName:o.default.string,ariaHideApp:o.default.bool,appElement:o.default.oneOfType([o.default.instanceOf(x.default),o.default.instanceOf(b.SafeHTMLCollection),o.default.instanceOf(b.SafeNodeList),o.default.arrayOf(o.default.instanceOf(x.default))]),onAfterOpen:o.default.func,onAfterClose:o.default.func,onRequestClose:o.default.func,closeTimeoutMS:o.default.number,shouldFocusAfterRender:o.default.bool,shouldCloseOnOverlayClick:o.default.bool,shouldReturnFocusAfterClose:o.default.bool,preventScroll:o.default.bool,role:o.default.string,contentLabel:o.default.string,aria:o.default.object,data:o.default.object,children:o.default.node,shouldCloseOnEsc:o.default.bool,overlayRef:o.default.func,contentRef:o.default.func,id:o.default.string,overlayElement:o.default.func,contentElement:o.default.func,testId:o.default.string},t.default=J,e.exports=t.default})(Zv,Zv.exports);var FB=Zv.exports;function LA(){var e=this.constructor.getDerivedStateFromProps(this.props,this.state);e!=null&&this.setState(e)}function FA(e){function t(r){var n=this.constructor.getDerivedStateFromProps(e,r);return n??null}this.setState(t.bind(this))}function OA(e,t){try{var r=this.props,n=this.state;this.props=e,this.state=t,this.__reactInternalSnapshotFlag=!0,this.__reactInternalSnapshot=this.getSnapshotBeforeUpdate(r,n)}finally{this.props=r,this.state=n}}LA.__suppressDeprecationWarning=!0;FA.__suppressDeprecationWarning=!0;OA.__suppressDeprecationWarning=!0;function OB(e){var t=e.prototype;if(!t||!t.isReactComponent)throw new Error("Can only polyfill class components");if(typeof e.getDerivedStateFromProps!="function"&&typeof t.getSnapshotBeforeUpdate!="function")return e;var r=null,n=null,a=null;if(typeof t.componentWillMount=="function"?r="componentWillMount":typeof t.UNSAFE_componentWillMount=="function"&&(r="UNSAFE_componentWillMount"),typeof t.componentWillReceiveProps=="function"?n="componentWillReceiveProps":typeof t.UNSAFE_componentWillReceiveProps=="function"&&(n="UNSAFE_componentWillReceiveProps"),typeof t.componentWillUpdate=="function"?a="componentWillUpdate":typeof t.UNSAFE_componentWillUpdate=="function"&&(a="UNSAFE_componentWillUpdate"),r!==null||n!==null||a!==null){var i=e.displayName||e.name,s=typeof e.getDerivedStateFromProps=="function"?"getDerivedStateFromProps()":"getSnapshotBeforeUpdate()";throw Error(`Unsafe legacy lifecycles will not be called for components using new component APIs.

`+i+" uses "+s+" but also contains the following legacy lifecycles:"+(r!==null?`
  `+r:"")+(n!==null?`
  `+n:"")+(a!==null?`
  `+a:"")+`

The above lifecycles should be removed. Learn more about this warning here:
https://fb.me/react-async-component-lifecycle-hooks`)}if(typeof e.getDerivedStateFromProps=="function"&&(t.componentWillMount=LA,t.componentWillReceiveProps=FA),typeof t.getSnapshotBeforeUpdate=="function"){if(typeof t.componentDidUpdate!="function")throw new Error("Cannot polyfill getSnapshotBeforeUpdate() for components that do not define componentDidUpdate() on the prototype");t.componentWillUpdate=OA;var o=t.componentDidUpdate;t.componentDidUpdate=function(c,u,f){var p=this.__reactInternalSnapshotFlag?this.__reactInternalSnapshot:f;o.call(this,c,u,p)}}return e}const DB=Object.freeze(Object.defineProperty({__proto__:null,polyfill:OB},Symbol.toStringTag,{value:"Module"})),IB=B_(DB);Object.defineProperty(ec,"__esModule",{value:!0});ec.bodyOpenClassName=ec.portalClassName=void 0;var t3=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},RB=function(){function e(t,r){for(var n=0;n<r.length;n++){var a=r[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(t,a.key,a)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),DA=ie,w1=Ph(DA),jB=Qk,b1=Ph(jB),MB=AA,At=Ph(MB),BB=FB,r3=Ph(BB),UB=zi,VB=zB(UB),jo=Bi,n3=Ph(jo),$B=IB;function zB(e){if(e&&e.__esModule)return e;var t={};if(e!=null)for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t.default=e,t}function Ph(e){return e&&e.__esModule?e:{default:e}}function HB(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a3(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t&&(typeof t=="object"||typeof t=="function")?t:e}function WB(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var qB=ec.portalClassName="ReactModalPortal",GB=ec.bodyOpenClassName="ReactModal__Body--open",Ll=jo.canUseDOM&&b1.default.createPortal!==void 0,i3=function(t){return document.createElement(t)},s3=function(){return Ll?b1.default.createPortal:b1.default.unstable_renderSubtreeIntoContainer};function ep(e){return e()}var Lh=function(e){WB(t,e);function t(){var r,n,a,i;HB(this,t);for(var s=arguments.length,o=Array(s),l=0;l<s;l++)o[l]=arguments[l];return i=(n=(a=a3(this,(r=t.__proto__||Object.getPrototypeOf(t)).call.apply(r,[this].concat(o))),a),a.removePortal=function(){!Ll&&b1.default.unmountComponentAtNode(a.node);var c=ep(a.props.parentSelector);c&&c.contains(a.node)?c.removeChild(a.node):console.warn('React-Modal: "parentSelector" prop did not returned any DOM element. Make sure that the parent element is unmounted to avoid any memory leaks.')},a.portalRef=function(c){a.portal=c},a.renderPortal=function(c){var u=s3(),f=u(a,w1.default.createElement(r3.default,t3({defaultStyles:t.defaultStyles},c)),a.node);a.portalRef(f)},n),a3(a,i)}return RB(t,[{key:"componentDidMount",value:function(){if(jo.canUseDOM){Ll||(this.node=i3("div")),this.node.className=this.props.portalClassName;var n=ep(this.props.parentSelector);n.appendChild(this.node),!Ll&&this.renderPortal(this.props)}}},{key:"getSnapshotBeforeUpdate",value:function(n){var a=ep(n.parentSelector),i=ep(this.props.parentSelector);return{prevParent:a,nextParent:i}}},{key:"componentDidUpdate",value:function(n,a,i){if(jo.canUseDOM){var s=this.props,o=s.isOpen,l=s.portalClassName;n.portalClassName!==l&&(this.node.className=l);var c=i.prevParent,u=i.nextParent;u!==c&&(c.removeChild(this.node),u.appendChild(this.node)),!(!n.isOpen&&!o)&&!Ll&&this.renderPortal(this.props)}}},{key:"componentWillUnmount",value:function(){if(!(!jo.canUseDOM||!this.node||!this.portal)){var n=this.portal.state,a=Date.now(),i=n.isOpen&&this.props.closeTimeoutMS&&(n.closesAt||a+this.props.closeTimeoutMS);i?(n.beforeClose||this.portal.closeWithTimeout(),setTimeout(this.removePortal,i-a)):this.removePortal()}}},{key:"render",value:function(){if(!jo.canUseDOM||!Ll)return null;!this.node&&Ll&&(this.node=i3("div"));var n=s3();return n(w1.default.createElement(r3.default,t3({ref:this.portalRef,defaultStyles:t.defaultStyles},this.props)),this.node)}}],[{key:"setAppElement",value:function(n){VB.setElement(n)}}]),t}(DA.Component);Lh.propTypes={isOpen:At.default.bool.isRequired,style:At.default.shape({content:At.default.object,overlay:At.default.object}),portalClassName:At.default.string,bodyOpenClassName:At.default.string,htmlOpenClassName:At.default.string,className:At.default.oneOfType([At.default.string,At.default.shape({base:At.default.string.isRequired,afterOpen:At.default.string.isRequired,beforeClose:At.default.string.isRequired})]),overlayClassName:At.default.oneOfType([At.default.string,At.default.shape({base:At.default.string.isRequired,afterOpen:At.default.string.isRequired,beforeClose:At.default.string.isRequired})]),appElement:At.default.oneOfType([At.default.instanceOf(n3.default),At.default.instanceOf(jo.SafeHTMLCollection),At.default.instanceOf(jo.SafeNodeList),At.default.arrayOf(At.default.instanceOf(n3.default))]),onAfterOpen:At.default.func,onRequestClose:At.default.func,closeTimeoutMS:At.default.number,ariaHideApp:At.default.bool,shouldFocusAfterRender:At.default.bool,shouldCloseOnOverlayClick:At.default.bool,shouldReturnFocusAfterClose:At.default.bool,preventScroll:At.default.bool,parentSelector:At.default.func,aria:At.default.object,data:At.default.object,role:At.default.string,contentLabel:At.default.string,shouldCloseOnEsc:At.default.bool,overlayRef:At.default.func,contentRef:At.default.func,id:At.default.string,overlayElement:At.default.func,contentElement:At.default.func};Lh.defaultProps={isOpen:!1,portalClassName:qB,bodyOpenClassName:GB,role:"dialog",ariaHideApp:!0,closeTimeoutMS:0,shouldFocusAfterRender:!0,shouldCloseOnEsc:!0,shouldCloseOnOverlayClick:!0,shouldReturnFocusAfterClose:!0,preventScroll:!1,parentSelector:function(){return document.body},overlayElement:function(t,r){return w1.default.createElement("div",t,r)},contentElement:function(t,r){return w1.default.createElement("div",t,r)}};Lh.defaultStyles={overlay:{position:"fixed",top:0,left:0,right:0,bottom:0,backgroundColor:"rgba(255, 255, 255, 0.75)"},content:{position:"absolute",top:"40px",left:"40px",right:"40px",bottom:"40px",border:"1px solid #ccc",background:"#fff",overflow:"auto",WebkitOverflowScrolling:"touch",borderRadius:"4px",outline:"none",padding:"20px"}};(0,$B.polyfill)(Lh);ec.default=Lh;(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var r=ec,n=a(r);function a(i){return i&&i.__esModule?i:{default:i}}t.default=n.default,e.exports=t.default})(Qv,Qv.exports);var KB=Qv.exports;const nx=M_(KB),XB=()=>{var fe;const{articles:e,movements:t,updateMovement:r,deleteMovement:n,refreshData:a}=ds(),[i,s]=ie.useState(""),[o,l]=ie.useState(""),[c,u]=ie.useState(""),[f,p]=ie.useState([]),[h,g]=ie.useState({description:""}),[m,b]=ie.useState(!1),[x,w]=ie.useState(null),[y,A]=ie.useState(!1),[L,D]=ie.useState(!1),[T,F]=ie.useState(null);ie.useEffect(()=>{R()},[i,o,c,e,t]);const R=()=>{let U=t,Q=null;i&&(Q=e.find(j=>j.id===parseInt(i)),U=U.filter(j=>j.id_articulo===parseInt(i)));let q={},he={};(o||c)&&e.forEach(j=>{const K=t.filter(de=>{if(de.id_articulo!==j.id)return!1;const[we,Pe]=de.fecha.split("-"),Z=c&&we<c,Ve=c&&we===c&&o&&Pe<o.padStart(2,"0");return Z||Ve});let ne=0,pe=j.costo;K.forEach(de=>{de.tipo==="Entrada"?(ne+=de.cantidad,de.costo>0&&(pe=de.costo)):ne-=de.cantidad}),q[j.id]=ne,he[j.id]=pe}),(o||c)&&(U=U.filter(j=>{const[K,ne]=j.fecha.split("-");return(!o||ne===o.padStart(2,"0"))&&(!c||K===c)})),U.sort((j,K)=>{const ne=j.fecha,pe=K.fecha;return ne!==pe?ne.localeCompare(pe):j.tipo===K.tipo?0:j.tipo==="Entrada"?-1:1});let xe={...q},E={...he};const I=U.map(j=>{let K=Q;return K||(K=e.find(ne=>ne.id===j.id_articulo)),K?(xe[K.id]===void 0&&(xe[K.id]=0),E[K.id]===void 0&&(E[K.id]=K.costo),j.tipo==="Entrada"?(xe[K.id]+=j.cantidad,j.costo>0&&(E[K.id]=j.costo)):xe[K.id]-=j.cantidad,{...j,article:K,balance:xe[K.id],costoUnit:E[K.id],totalValue:j.cantidad*(j.costo>0?j.costo:E[K.id]),balanceValue:xe[K.id]*E[K.id]}):null}).filter(Boolean);let O=null;if((o||c)&&i){const j=e.find(K=>K.id===parseInt(i));j&&(O={fecha:"",descripcion:"Saldo Inicial",tipo:"",cantidad:"",costo:"",article:j,balance:q[j.id],costoUnit:he[j.id],totalValue:"",balanceValue:q[j.id]*he[j.id]})}p(O?[O,...I]:I)},X=()=>{if(!i){ft.error("Por favor seleccione un artculo para imprimir");return}km()},N=()=>{if(!i){ft.error("Por favor seleccione un artculo para exportar");return}const U=e.find(I=>I.id===parseInt(i));if(!U)return;const Q=["Fecha","Descripcin","Entrada Cant.","Entrada Costo","Entrada Total","Salida Cant.","Salida Costo","Salida Total","Existencia","Costo Unit.","Total"],q=f.map(I=>{const O=I.tipo==="Entrada",j=I.cantidad*I.costo,K=I.balance*U.costo;return[I.fecha,I.descripcion,O?I.cantidad.toString():"0",Gt(O?I.costo:0),Gt(O?j:0),O?"0":I.cantidad.toString(),Gt(O?0:I.costo),Gt(O?0:j),I.balance.toString(),Gt(U.costo),Gt(K)]}),he=Em(Q,q),xe=Nh(`Tarjeta de Control - ${U.nombre}`,he,{articleId:i,dateFrom:o&&c?`${c}-${o}-01`:"",dateTo:o&&c?`${c}-${o}-31`:"",...h}),E=`tarjeta_control_${U.nombre.replace(/\s+/g,"_").toLowerCase()}_${new Date().toISOString().split("T")[0]}.html`;Sm(xe,E),ft.success("Tarjeta de control exportada a PDF/HTML")},P=U=>`$${U.toFixed(2)}`,J=()=>{if(!i){ft.error("Por favor seleccione un artculo para exportar");return}const U=e.find(O=>O.id===parseInt(i));if(!U)return;const Q=["Fecha","Descripcin","Entrada Cant.","Entrada Costo","Entrada Total","Salida Cant.","Salida Costo","Salida Total","Existencia","Costo Unit.","Total"],q=f.map(O=>{const j=O.tipo==="Entrada",K=O.cantidad*O.costo,ne=O.balance*U.costo;return[O.fecha,O.descripcion,j?O.cantidad.toString():"0",P(j?O.costo:0),P(j?K:0),j?"0":O.cantidad.toString(),P(j?0:O.costo),P(j?0:K),O.balance.toString(),P(U.costo),P(ne)]}),he=[Q.join(","),...q.map(O=>O.map(j=>`"${j}"`).join(","))].join(`
`),xe=new Blob([he],{type:"text/csv;charset=utf-8;"}),E=document.createElement("a"),I=URL.createObjectURL(xe);E.setAttribute("href",I),E.setAttribute("download",`tarjeta_control_${U.nombre.replace(/\s+/g,"_").toLowerCase()}_${new Date().toISOString().split("T")[0]}.csv`),E.style.visibility="hidden",document.body.appendChild(E),E.click(),document.body.removeChild(E),URL.revokeObjectURL(I),ft.success("Tarjeta de control exportada a CSV")},W=()=>{X()},se=()=>{N()};return _.jsxs("div",{className:"space-y-8",children:[o&&!c&&_.jsx("div",{className:"bg-yellow-100 border-l-4 border-yellow-500 p-4 mb-4 text-yellow-800 font-semibold",children:" Por favor, selecciona tambin un ao para filtrar por mes. Filtrar solo por mes puede mostrar datos incongruentes."}),_.jsx(er.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},className:"bg-white rounded-2xl shadow-lg p-8 border border-gray-100",children:_.jsxs("div",{className:"flex items-center justify-between",children:[_.jsxs("div",{children:[_.jsx("h2",{className:"text-3xl font-bold text-gray-900 mb-2",children:"Tarjeta de Control"}),_.jsx("p",{className:"text-gray-600",children:"Historial detallado de movimientos por artculo"})]}),_.jsx(Q6,{className:"h-12 w-12 text-blue-600"})]})}),_.jsx(er.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.1},className:"bg-white rounded-xl shadow-lg p-6 border border-gray-100",children:_.jsxs("div",{className:"flex flex-col gap-4",children:[_.jsxs("div",{className:"flex flex-col md:flex-row md:items-end md:justify-between gap-4",children:[_.jsxs("div",{className:"flex flex-col md:flex-row gap-4 flex-1",children:[_.jsxs("div",{className:"flex flex-col flex-1 min-w-[180px]",children:[_.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Artculo"}),_.jsxs("select",{value:i,onChange:U=>s(U.target.value),className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",children:[_.jsx("option",{value:"",children:"Todos los artculos"}),e.map(U=>_.jsx("option",{value:U.id,children:U.nombre},U.id))]})]}),_.jsxs("div",{className:"flex flex-col flex-1 min-w-[150px]",children:[_.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Mes"}),_.jsxs("select",{value:o,onChange:U=>l(U.target.value),className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",children:[_.jsx("option",{value:"",children:"Todos los meses"}),_.jsx("option",{value:"1",children:"Enero"}),_.jsx("option",{value:"2",children:"Febrero"}),_.jsx("option",{value:"3",children:"Marzo"}),_.jsx("option",{value:"4",children:"Abril"}),_.jsx("option",{value:"5",children:"Mayo"}),_.jsx("option",{value:"6",children:"Junio"}),_.jsx("option",{value:"7",children:"Julio"}),_.jsx("option",{value:"8",children:"Agosto"}),_.jsx("option",{value:"9",children:"Septiembre"}),_.jsx("option",{value:"10",children:"Octubre"}),_.jsx("option",{value:"11",children:"Noviembre"}),_.jsx("option",{value:"12",children:"Diciembre"})]})]}),_.jsxs("div",{className:"flex flex-col flex-1 min-w-[150px]",children:[_.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Ao"}),_.jsxs("select",{value:c,onChange:U=>u(U.target.value),className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",children:[_.jsx("option",{value:"",children:"Todos los aos"}),_.jsx("option",{value:"2023",children:"2023"}),_.jsx("option",{value:"2024",children:"2024"}),_.jsx("option",{value:"2025",children:"2025"})]})]}),_.jsxs("div",{className:"flex flex-col flex-1 min-w-[220px]",children:[_.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Descripcin"}),_.jsx("input",{type:"text",value:h.description,onChange:U=>g({...h,description:U.target.value}),className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",placeholder:"Buscar en descripcin..."})]})]}),_.jsx("div",{className:"flex justify-end mt-2 md:mt-0",children:_.jsx("button",{onClick:()=>{s(""),l(""),u(""),g({description:""})},className:"px-4 py-2 bg-gray-100 text-gray-700 rounded-lg hover:bg-gray-200 transition-colors font-medium",children:"Limpiar Filtros"})})]}),_.jsxs("div",{className:"flex flex-row gap-2 justify-end mt-2",children:[_.jsxs("button",{onClick:W,className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors flex items-center gap-2",children:[_.jsx(eh,{className:"h-4 w-4"}),"Imprimir"]}),_.jsxs("button",{onClick:se,className:"px-4 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700 transition-colors flex items-center gap-2",children:[_.jsx(is,{className:"h-4 w-4"}),"Exportar PDF"]}),_.jsxs("button",{onClick:J,className:"px-4 py-2 bg-gray-600 text-white rounded-lg hover:bg-gray-700 transition-colors flex items-center gap-2",children:[_.jsx(is,{className:"h-4 w-4"}),"Exportar CSV"]})]})]})}),(i||!i)&&_.jsxs(er.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.2},className:"bg-white rounded-xl shadow-lg overflow-hidden border border-gray-100",children:[_.jsxs("div",{className:"p-6 border-b border-gray-200",children:[_.jsxs("h3",{className:"font-semibold text-gray-800 text-lg",children:["Tarjeta de Control - ",(fe=e.find(U=>U.id===parseInt(i)))==null?void 0:fe.nombre]}),_.jsxs("p",{className:"text-sm text-gray-600 mt-1",children:["Mostrando ",f.length," movimientos"]})]}),_.jsx("div",{className:"overflow-x-auto",children:_.jsxs("table",{className:"w-full",children:[_.jsxs("thead",{className:"bg-gray-50",children:[_.jsxs("tr",{children:[_.jsx("th",{rowSpan:2,className:"px-4 py-3 text-center text-sm font-semibold text-gray-900 border-r",children:"Fecha"}),_.jsx("th",{rowSpan:2,className:"px-4 py-3 text-center text-sm font-semibold text-gray-900 border-r",children:"Descripcin"}),_.jsx("th",{colSpan:3,className:"px-4 py-2 text-center text-sm font-semibold text-gray-900 border-r bg-green-50",children:"ENTRADA"}),_.jsx("th",{colSpan:3,className:"px-4 py-2 text-center text-sm font-semibold text-gray-900 border-r bg-red-50",children:"SALIDA"}),_.jsx("th",{colSpan:3,className:"px-4 py-2 text-center text-sm font-semibold text-gray-900 bg-blue-50",children:"EXISTENCIA"})]}),_.jsxs("tr",{children:[_.jsx("th",{className:"px-2 py-2 text-center text-xs font-medium text-gray-700 border-r",children:"Cantidad"}),_.jsx("th",{className:"px-2 py-2 text-center text-xs font-medium text-gray-700 border-r",children:"Costo Unit."}),_.jsx("th",{className:"px-2 py-2 text-center text-xs font-medium text-gray-700 border-r",children:"Total"}),_.jsx("th",{className:"px-2 py-2 text-center text-xs font-medium text-gray-700 border-r",children:"Cantidad"}),_.jsx("th",{className:"px-2 py-2 text-center text-xs font-medium text-gray-700 border-r",children:"Costo Unit."}),_.jsx("th",{className:"px-2 py-2 text-center text-xs font-medium text-gray-700 border-r",children:"Total"}),_.jsx("th",{className:"px-2 py-2 text-center text-xs font-medium text-gray-700 border-r",children:"Cantidad"}),_.jsx("th",{className:"px-2 py-2 text-center text-xs font-medium text-gray-700 border-r",children:"Costo Unit."}),_.jsx("th",{className:"px-2 py-2 text-center text-xs font-medium text-gray-700",children:"Total"})]})]}),_.jsx("tbody",{className:"divide-y divide-gray-200",children:f.length===0?_.jsx("tr",{children:_.jsx("td",{colSpan:11,className:"px-6 py-8 text-center text-gray-500",children:"No hay movimientos registrados para este artculo en el perodo seleccionado"})}):f.map((U,Q)=>_.jsxs("tr",{className:"hover:bg-gray-50",children:[_.jsx("td",{className:"px-4 py-3 text-sm text-gray-600 border-r",children:_A(U.fecha)}),_.jsx("td",{className:"px-4 py-3 text-sm text-gray-900 border-r",children:U.descripcion}),_.jsx("td",{className:"px-2 py-3 text-center text-sm text-gray-900 border-r",children:U.tipo==="Entrada"?U.cantidad:""}),_.jsx("td",{className:"px-2 py-3 text-center text-sm text-gray-600 border-r",children:U.tipo==="Entrada"?Gt(U.costo):""}),_.jsx("td",{className:"px-2 py-3 text-center text-sm text-gray-600 border-r",children:U.tipo==="Entrada"?Gt(U.totalValue):""}),_.jsx("td",{className:"px-2 py-3 text-center text-sm text-gray-900 border-r",children:U.tipo==="Salida"?U.cantidad:""}),_.jsx("td",{className:"px-2 py-3 text-center text-sm text-gray-600 border-r",children:U.tipo==="Salida"?Gt(U.costo):""}),_.jsx("td",{className:"px-2 py-3 text-center text-sm text-gray-600 border-r",children:U.tipo==="Salida"?Gt(U.totalValue):""}),_.jsx("td",{className:"px-2 py-3 text-center text-sm font-medium text-gray-900 border-r",children:U.balance}),_.jsx("td",{className:"px-2 py-3 text-center text-sm text-gray-600 border-r",children:Gt(U.costoUnit)}),_.jsx("td",{className:"px-2 py-3 text-center text-sm font-medium text-gray-900",children:Gt(U.balanceValue)}),_.jsx("td",{className:"px-2 py-3 text-center text-sm",children:_.jsxs("div",{className:"flex gap-2 justify-center",children:[_.jsx("button",{className:"p-2 rounded-full bg-blue-600 hover:bg-blue-700 text-white transition-colors",title:"Editar",onClick:()=>{const q=t.find(he=>he.id===U.id);w(q),b(!0)},children:_.jsx(tA,{className:"w-4 h-4"})}),_.jsx("button",{className:"p-2 rounded-full bg-red-600 hover:bg-red-700 text-white transition-colors",title:"Eliminar",onClick:()=>F({open:!0,movement:U}),disabled:L,children:_.jsx(aA,{className:"w-4 h-4"})})]})})]},Q))})]})})]}),_.jsxs(nx,{isOpen:m,onRequestClose:()=>b(!1),className:"bg-white rounded-2xl shadow-lg p-8 border border-gray-100 max-w-lg mx-auto mt-20 outline-none",overlayClassName:"fixed inset-0 bg-black bg-opacity-40 flex items-center justify-center z-50",ariaHideApp:!1,children:[_.jsx("h2",{className:"text-2xl font-bold mb-4 text-center",children:"Editar movimiento"}),x&&_.jsxs("form",{onSubmit:async U=>{U.preventDefault(),A(!0);try{await r(x.id,{cantidad:Number(x.cantidad),fecha:x.fecha,descripcion:x.descripcion,costo:Number(x.costo)}),ft.success("Movimiento actualizado correctamente"),b(!1),w(null),a()}catch{ft.error("Error al actualizar movimiento")}finally{A(!1)}},className:"space-y-4",children:[_.jsxs("div",{children:[_.jsx("label",{className:"block text-sm font-medium mb-1",children:"Cantidad"}),_.jsx("input",{type:"number",value:x.cantidad,min:1,required:!0,onChange:U=>w({...x,cantidad:U.target.value}),className:"w-full border rounded px-2 py-1"})]}),_.jsxs("div",{children:[_.jsx("label",{className:"block text-sm font-medium mb-1",children:"Fecha"}),_.jsx("input",{type:"date",value:x.fecha?x.fecha.slice(0,10):"",required:!0,onChange:U=>w({...x,fecha:U.target.value}),className:"w-full border rounded px-2 py-1"})]}),_.jsxs("div",{children:[_.jsx("label",{className:"block text-sm font-medium mb-1",children:"Descripcin"}),_.jsx("input",{type:"text",value:x.descripcion,onChange:U=>w({...x,descripcion:U.target.value}),className:"w-full border rounded px-2 py-1"})]}),_.jsxs("div",{children:[_.jsx("label",{className:"block text-sm font-medium mb-1",children:"Costo unitario"}),_.jsx("input",{type:"number",step:"0.01",value:x.costo,onChange:U=>w({...x,costo:U.target.value}),className:"w-full border rounded px-2 py-1"})]}),_.jsxs("div",{className:"flex gap-2 mt-6",children:[_.jsx("button",{type:"submit",disabled:y,className:"flex-1 bg-blue-600 text-white py-2 rounded-lg",children:y?"Guardando...":"Guardar cambios"}),_.jsx("button",{type:"button",onClick:()=>b(!1),className:"flex-1 bg-gray-200 text-gray-700 py-2 rounded-lg",children:"Cancelar"})]})]})]}),_.jsxs(nx,{isOpen:!!(T!=null&&T.open),onRequestClose:()=>F(null),className:"bg-white rounded-2xl shadow-lg p-8 border border-gray-100 max-w-md mx-auto mt-20 outline-none",overlayClassName:"fixed inset-0 bg-black bg-opacity-40 flex items-center justify-center z-50",ariaHideApp:!1,children:[_.jsx("h2",{className:"text-xl font-bold mb-4 text-center",children:"Eliminar movimiento?"}),_.jsx("p",{className:"mb-4 text-center",children:"Esta accin no se puede deshacer."}),_.jsxs("div",{className:"flex gap-2 mt-6",children:[_.jsx("button",{onClick:async()=>{D(!0);try{await n(T.movement.id),ft.success("Movimiento eliminado correctamente"),F(null),a()}catch{ft.error("Error al eliminar movimiento")}finally{D(!1)}},disabled:L,className:"flex-1 bg-red-600 text-white py-2 rounded-lg",children:L?"Eliminando...":"Eliminar"}),_.jsx("button",{onClick:()=>F(null),className:"flex-1 bg-gray-200 text-gray-700 py-2 rounded-lg",children:"Cancelar"})]})]})]})};/*! xlsx.js (C) 2013-present SheetJS -- http://sheetjs.com */var IA=1252,YB=[874,932,936,949,950,1250,1251,1252,1253,1254,1255,1256,1257,1258,1e4],o5={0:1252,1:65001,2:65001,77:1e4,128:932,129:949,130:1361,134:936,136:950,161:1253,162:1254,163:1258,177:1255,178:1256,186:1257,204:1251,222:874,238:1250,255:1252,69:6969},l5=function(e){YB.indexOf(e)!=-1&&(IA=o5[0]=e)};function JB(){l5(1252)}var Ii=function(e){l5(e)};function RA(){Ii(1200),JB()}function o3(e){for(var t=[],r=0,n=e.length;r<n;++r)t[r]=e.charCodeAt(r);return t}function QB(e){for(var t=[],r=0;r<e.length>>1;++r)t[r]=String.fromCharCode(e.charCodeAt(2*r)+(e.charCodeAt(2*r+1)<<8));return t.join("")}function jA(e){for(var t=[],r=0;r<e.length>>1;++r)t[r]=String.fromCharCode(e.charCodeAt(2*r+1)+(e.charCodeAt(2*r)<<8));return t.join("")}var Qf=function(e){var t=e.charCodeAt(0),r=e.charCodeAt(1);return t==255&&r==254?QB(e.slice(2)):t==254&&r==255?jA(e.slice(2)):t==65279?e.slice(1):e},tp=function(t){return String.fromCharCode(t)},l3=function(t){return String.fromCharCode(t)},Oo,Mo="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";function c3(e){for(var t="",r=0,n=0,a=0,i=0,s=0,o=0,l=0,c=0;c<e.length;)r=e.charCodeAt(c++),i=r>>2,n=e.charCodeAt(c++),s=(r&3)<<4|n>>4,a=e.charCodeAt(c++),o=(n&15)<<2|a>>6,l=a&63,isNaN(n)?o=l=64:isNaN(a)&&(l=64),t+=Mo.charAt(i)+Mo.charAt(s)+Mo.charAt(o)+Mo.charAt(l);return t}function Ba(e){var t="",r=0,n=0,a=0,i=0,s=0,o=0,l=0;e=e.replace(/[^\w\+\/\=]/g,"");for(var c=0;c<e.length;)i=Mo.indexOf(e.charAt(c++)),s=Mo.indexOf(e.charAt(c++)),r=i<<2|s>>4,t+=String.fromCharCode(r),o=Mo.indexOf(e.charAt(c++)),n=(s&15)<<4|o>>2,o!==64&&(t+=String.fromCharCode(n)),l=Mo.indexOf(e.charAt(c++)),a=(o&3)<<6|l,l!==64&&(t+=String.fromCharCode(a));return t}var jt=function(){return typeof Buffer<"u"&&typeof process<"u"&&typeof process.versions<"u"&&!!process.versions.node}(),fc=function(){if(typeof Buffer<"u"){var e=!Buffer.from;if(!e)try{Buffer.from("foo","utf8")}catch{e=!0}return e?function(t,r){return r?new Buffer(t,r):new Buffer(t)}:Buffer.from.bind(Buffer)}return function(){}}();function rl(e){return jt?Buffer.alloc?Buffer.alloc(e):new Buffer(e):typeof Uint8Array<"u"?new Uint8Array(e):new Array(e)}function u3(e){return jt?Buffer.allocUnsafe?Buffer.allocUnsafe(e):new Buffer(e):typeof Uint8Array<"u"?new Uint8Array(e):new Array(e)}var Di=function(t){return jt?fc(t,"binary"):t.split("").map(function(r){return r.charCodeAt(0)&255})};function hc(e){if(Array.isArray(e))return e.map(function(n){return String.fromCharCode(n)}).join("");for(var t=[],r=0;r<e.length;++r)t[r]=String.fromCharCode(e[r]);return t.join("")}function c5(e){if(typeof ArrayBuffer>"u")throw new Error("Unsupported");if(e instanceof ArrayBuffer)return c5(new Uint8Array(e));for(var t=new Array(e.length),r=0;r<e.length;++r)t[r]=e[r];return t}var Do=jt?function(e){return Buffer.concat(e.map(function(t){return Buffer.isBuffer(t)?t:fc(t)}))}:function(e){if(typeof Uint8Array<"u"){var t=0,r=0;for(t=0;t<e.length;++t)r+=e[t].length;var n=new Uint8Array(r),a=0;for(t=0,r=0;t<e.length;r+=a,++t)if(a=e[t].length,e[t]instanceof Uint8Array)n.set(e[t],r);else{if(typeof e[t]=="string")throw"wtf";n.set(new Uint8Array(e[t]),r)}return n}return[].concat.apply([],e.map(function(i){return Array.isArray(i)?i:[].slice.call(i)}))};function ZB(e){for(var t=[],r=0,n=e.length+250,a=rl(e.length+255),i=0;i<e.length;++i){var s=e.charCodeAt(i);if(s<128)a[r++]=s;else if(s<2048)a[r++]=192|s>>6&31,a[r++]=128|s&63;else if(s>=55296&&s<57344){s=(s&1023)+64;var o=e.charCodeAt(++i)&1023;a[r++]=240|s>>8&7,a[r++]=128|s>>2&63,a[r++]=128|o>>6&15|(s&3)<<4,a[r++]=128|o&63}else a[r++]=224|s>>12&15,a[r++]=128|s>>6&63,a[r++]=128|s&63;r>n&&(t.push(a.slice(0,r)),r=0,a=rl(65535),n=65530)}return t.push(a.slice(0,r)),Do(t)}var aa=/\u0000/g,Zf=/[\u0001-\u0006]/g;function Su(e){for(var t="",r=e.length-1;r>=0;)t+=e.charAt(r--);return t}function Ri(e,t){var r=""+e;return r.length>=t?r:Fr("0",t-r.length)+r}function u5(e,t){var r=""+e;return r.length>=t?r:Fr(" ",t-r.length)+r}function _1(e,t){var r=""+e;return r.length>=t?r:r+Fr(" ",t-r.length)}function eU(e,t){var r=""+Math.round(e);return r.length>=t?r:Fr("0",t-r.length)+r}function tU(e,t){var r=""+e;return r.length>=t?r:Fr("0",t-r.length)+r}var f3=Math.pow(2,32);function Wc(e,t){if(e>f3||e<-f3)return eU(e,t);var r=Math.round(e);return tU(r,t)}function S1(e,t){return t=t||0,e.length>=7+t&&(e.charCodeAt(t)|32)===103&&(e.charCodeAt(t+1)|32)===101&&(e.charCodeAt(t+2)|32)===110&&(e.charCodeAt(t+3)|32)===101&&(e.charCodeAt(t+4)|32)===114&&(e.charCodeAt(t+5)|32)===97&&(e.charCodeAt(t+6)|32)===108}var h3=[["Sun","Sunday"],["Mon","Monday"],["Tue","Tuesday"],["Wed","Wednesday"],["Thu","Thursday"],["Fri","Friday"],["Sat","Saturday"]],f2=[["J","Jan","January"],["F","Feb","February"],["M","Mar","March"],["A","Apr","April"],["M","May","May"],["J","Jun","June"],["J","Jul","July"],["A","Aug","August"],["S","Sep","September"],["O","Oct","October"],["N","Nov","November"],["D","Dec","December"]];function rU(e){return e||(e={}),e[0]="General",e[1]="0",e[2]="0.00",e[3]="#,##0",e[4]="#,##0.00",e[9]="0%",e[10]="0.00%",e[11]="0.00E+00",e[12]="# ?/?",e[13]="# ??/??",e[14]="m/d/yy",e[15]="d-mmm-yy",e[16]="d-mmm",e[17]="mmm-yy",e[18]="h:mm AM/PM",e[19]="h:mm:ss AM/PM",e[20]="h:mm",e[21]="h:mm:ss",e[22]="m/d/yy h:mm",e[37]="#,##0 ;(#,##0)",e[38]="#,##0 ;[Red](#,##0)",e[39]="#,##0.00;(#,##0.00)",e[40]="#,##0.00;[Red](#,##0.00)",e[45]="mm:ss",e[46]="[h]:mm:ss",e[47]="mmss.0",e[48]="##0.0E+0",e[49]="@",e[56]='"/ "hh""mm""ss" "',e}var Ft={0:"General",1:"0",2:"0.00",3:"#,##0",4:"#,##0.00",9:"0%",10:"0.00%",11:"0.00E+00",12:"# ?/?",13:"# ??/??",14:"m/d/yy",15:"d-mmm-yy",16:"d-mmm",17:"mmm-yy",18:"h:mm AM/PM",19:"h:mm:ss AM/PM",20:"h:mm",21:"h:mm:ss",22:"m/d/yy h:mm",37:"#,##0 ;(#,##0)",38:"#,##0 ;[Red](#,##0)",39:"#,##0.00;(#,##0.00)",40:"#,##0.00;[Red](#,##0.00)",45:"mm:ss",46:"[h]:mm:ss",47:"mmss.0",48:"##0.0E+0",49:"@",56:'"/ "hh""mm""ss" "'},d3={5:37,6:38,7:39,8:40,23:0,24:0,25:0,26:0,27:14,28:14,29:14,30:14,31:14,50:14,51:14,52:14,53:14,54:14,55:14,56:14,57:14,58:14,59:1,60:2,61:3,62:4,67:9,68:10,69:12,70:13,71:14,72:14,73:15,74:16,75:17,76:20,77:21,78:22,79:45,80:46,81:47,82:0},nU={5:'"$"#,##0_);\\("$"#,##0\\)',63:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',41:'_(* #,##0_);_(* \\(#,##0\\);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* \\(#,##0\\);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* \\(#,##0.00\\);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* \\(#,##0.00\\);_("$"* "-"??_);_(@_)'};function k1(e,t,r){for(var n=e<0?-1:1,a=e*n,i=0,s=1,o=0,l=1,c=0,u=0,f=Math.floor(a);c<t&&(f=Math.floor(a),o=f*s+i,u=f*c+l,!(a-f<5e-8));)a=1/(a-f),i=s,s=o,l=c,c=u;if(u>t&&(c>t?(u=l,o=i):(u=c,o=s)),!r)return[0,n*o,u];var p=Math.floor(n*o/u);return[p,n*o-p*u,u]}function Vl(e,t,r){if(e>2958465||e<0)return null;var n=e|0,a=Math.floor(86400*(e-n)),i=0,s=[],o={D:n,T:a,u:86400*(e-n)-a,y:0,m:0,d:0,H:0,M:0,S:0,q:0};if(Math.abs(o.u)<1e-6&&(o.u=0),t&&t.date1904&&(n+=1462),o.u>.9999&&(o.u=0,++a==86400&&(o.T=a=0,++n,++o.D)),n===60)s=r?[1317,10,29]:[1900,2,29],i=3;else if(n===0)s=r?[1317,8,29]:[1900,1,0],i=6;else{n>60&&--n;var l=new Date(1900,0,1);l.setDate(l.getDate()+n-1),s=[l.getFullYear(),l.getMonth()+1,l.getDate()],i=l.getDay(),n<60&&(i=(i+6)%7),r&&(i=cU(l,s))}return o.y=s[0],o.m=s[1],o.d=s[2],o.S=a%60,a=Math.floor(a/60),o.M=a%60,a=Math.floor(a/60),o.H=a,o.q=i,o}var MA=new Date(1899,11,31,0,0,0),aU=MA.getTime(),iU=new Date(1900,2,1,0,0,0);function BA(e,t){var r=e.getTime();return t?r-=1461*24*60*60*1e3:e>=iU&&(r+=24*60*60*1e3),(r-(aU+(e.getTimezoneOffset()-MA.getTimezoneOffset())*6e4))/(24*60*60*1e3)}function f5(e){return e.indexOf(".")==-1?e:e.replace(/(?:\.0*|(\.\d*[1-9])0+)$/,"$1")}function sU(e){return e.indexOf("E")==-1?e:e.replace(/(?:\.0*|(\.\d*[1-9])0+)[Ee]/,"$1E").replace(/(E[+-])(\d)$/,"$10$2")}function oU(e){var t=e<0?12:11,r=f5(e.toFixed(12));return r.length<=t||(r=e.toPrecision(10),r.length<=t)?r:e.toExponential(5)}function lU(e){var t=f5(e.toFixed(11));return t.length>(e<0?12:11)||t==="0"||t==="-0"?e.toPrecision(6):t}function ah(e){var t=Math.floor(Math.log(Math.abs(e))*Math.LOG10E),r;return t>=-4&&t<=-1?r=e.toPrecision(10+t):Math.abs(t)<=9?r=oU(e):t===10?r=e.toFixed(10).substr(0,12):r=lU(e),f5(sU(r.toUpperCase()))}function tc(e,t){switch(typeof e){case"string":return e;case"boolean":return e?"TRUE":"FALSE";case"number":return(e|0)===e?e.toString(10):ah(e);case"undefined":return"";case"object":if(e==null)return"";if(e instanceof Date)return fi(14,BA(e,t&&t.date1904),t)}throw new Error("unsupported value in General format: "+e)}function cU(e,t){t[0]-=581;var r=e.getDay();return e<60&&(r=(r+6)%7),r}function uU(e,t,r,n){var a="",i=0,s=0,o=r.y,l,c=0;switch(e){case 98:o=r.y+543;case 121:switch(t.length){case 1:case 2:l=o%100,c=2;break;default:l=o%1e4,c=4;break}break;case 109:switch(t.length){case 1:case 2:l=r.m,c=t.length;break;case 3:return f2[r.m-1][1];case 5:return f2[r.m-1][0];default:return f2[r.m-1][2]}break;case 100:switch(t.length){case 1:case 2:l=r.d,c=t.length;break;case 3:return h3[r.q][0];default:return h3[r.q][1]}break;case 104:switch(t.length){case 1:case 2:l=1+(r.H+11)%12,c=t.length;break;default:throw"bad hour format: "+t}break;case 72:switch(t.length){case 1:case 2:l=r.H,c=t.length;break;default:throw"bad hour format: "+t}break;case 77:switch(t.length){case 1:case 2:l=r.M,c=t.length;break;default:throw"bad minute format: "+t}break;case 115:if(t!="s"&&t!="ss"&&t!=".0"&&t!=".00"&&t!=".000")throw"bad second format: "+t;return r.u===0&&(t=="s"||t=="ss")?Ri(r.S,t.length):(n>=2?s=n===3?1e3:100:s=n===1?10:1,i=Math.round(s*(r.S+r.u)),i>=60*s&&(i=0),t==="s"?i===0?"0":""+i/s:(a=Ri(i,2+n),t==="ss"?a.substr(0,2):"."+a.substr(2,t.length-1)));case 90:switch(t){case"[h]":case"[hh]":l=r.D*24+r.H;break;case"[m]":case"[mm]":l=(r.D*24+r.H)*60+r.M;break;case"[s]":case"[ss]":l=((r.D*24+r.H)*60+r.M)*60+Math.round(r.S+r.u);break;default:throw"bad abstime format: "+t}c=t.length===3?1:2;break;case 101:l=o,c=1;break}var u=c>0?Ri(l,c):"";return u}function Bo(e){var t=3;if(e.length<=t)return e;for(var r=e.length%t,n=e.substr(0,r);r!=e.length;r+=t)n+=(n.length>0?",":"")+e.substr(r,t);return n}var UA=/%/g;function fU(e,t,r){var n=t.replace(UA,""),a=t.length-n.length;return Hs(e,n,r*Math.pow(10,2*a))+Fr("%",a)}function hU(e,t,r){for(var n=t.length-1;t.charCodeAt(n-1)===44;)--n;return Hs(e,t.substr(0,n),r/Math.pow(10,3*(t.length-n)))}function VA(e,t){var r,n=e.indexOf("E")-e.indexOf(".")-1;if(e.match(/^#+0.0E\+0$/)){if(t==0)return"0.0E+0";if(t<0)return"-"+VA(e,-t);var a=e.indexOf(".");a===-1&&(a=e.indexOf("E"));var i=Math.floor(Math.log(t)*Math.LOG10E)%a;if(i<0&&(i+=a),r=(t/Math.pow(10,i)).toPrecision(n+1+(a+i)%a),r.indexOf("e")===-1){var s=Math.floor(Math.log(t)*Math.LOG10E);for(r.indexOf(".")===-1?r=r.charAt(0)+"."+r.substr(1)+"E+"+(s-r.length+i):r+="E+"+(s-i);r.substr(0,2)==="0.";)r=r.charAt(0)+r.substr(2,a)+"."+r.substr(2+a),r=r.replace(/^0+([1-9])/,"$1").replace(/^0+\./,"0.");r=r.replace(/\+-/,"-")}r=r.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(o,l,c,u){return l+c+u.substr(0,(a+i)%a)+"."+u.substr(i)+"E"})}else r=t.toExponential(n);return e.match(/E\+00$/)&&r.match(/e[+-]\d$/)&&(r=r.substr(0,r.length-1)+"0"+r.charAt(r.length-1)),e.match(/E\-/)&&r.match(/e\+/)&&(r=r.replace(/e\+/,"e")),r.replace("e","E")}var $A=/# (\?+)( ?)\/( ?)(\d+)/;function dU(e,t,r){var n=parseInt(e[4],10),a=Math.round(t*n),i=Math.floor(a/n),s=a-i*n,o=n;return r+(i===0?"":""+i)+" "+(s===0?Fr(" ",e[1].length+1+e[4].length):u5(s,e[1].length)+e[2]+"/"+e[3]+Ri(o,e[4].length))}function pU(e,t,r){return r+(t===0?"":""+t)+Fr(" ",e[1].length+2+e[4].length)}var zA=/^#*0*\.([0#]+)/,HA=/\).*[0#]/,WA=/\(###\) ###\\?-####/;function Zn(e){for(var t="",r,n=0;n!=e.length;++n)switch(r=e.charCodeAt(n)){case 35:break;case 63:t+=" ";break;case 48:t+="0";break;default:t+=String.fromCharCode(r)}return t}function p3(e,t){var r=Math.pow(10,t);return""+Math.round(e*r)/r}function m3(e,t){var r=e-Math.floor(e),n=Math.pow(10,t);return t<(""+Math.round(r*n)).length?0:Math.round(r*n)}function mU(e,t){return t<(""+Math.round((e-Math.floor(e))*Math.pow(10,t))).length?1:0}function gU(e){return e<2147483647&&e>-2147483648?""+(e>=0?e|0:e-1|0):""+Math.floor(e)}function ei(e,t,r){if(e.charCodeAt(0)===40&&!t.match(HA)){var n=t.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return r>=0?ei("n",n,r):"("+ei("n",n,-r)+")"}if(t.charCodeAt(t.length-1)===44)return hU(e,t,r);if(t.indexOf("%")!==-1)return fU(e,t,r);if(t.indexOf("E")!==-1)return VA(t,r);if(t.charCodeAt(0)===36)return"$"+ei(e,t.substr(t.charAt(1)==" "?2:1),r);var a,i,s,o,l=Math.abs(r),c=r<0?"-":"";if(t.match(/^00+$/))return c+Wc(l,t.length);if(t.match(/^[#?]+$/))return a=Wc(r,0),a==="0"&&(a=""),a.length>t.length?a:Zn(t.substr(0,t.length-a.length))+a;if(i=t.match($A))return dU(i,l,c);if(t.match(/^#+0+$/))return c+Wc(l,t.length-t.indexOf("0"));if(i=t.match(zA))return a=p3(r,i[1].length).replace(/^([^\.]+)$/,"$1."+Zn(i[1])).replace(/\.$/,"."+Zn(i[1])).replace(/\.(\d*)$/,function(g,m){return"."+m+Fr("0",Zn(i[1]).length-m.length)}),t.indexOf("0.")!==-1?a:a.replace(/^0\./,".");if(t=t.replace(/^#+([0.])/,"$1"),i=t.match(/^(0*)\.(#*)$/))return c+p3(l,i[2].length).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,i[1].length?"0.":".");if(i=t.match(/^#{1,3},##0(\.?)$/))return c+Bo(Wc(l,0));if(i=t.match(/^#,##0\.([#0]*0)$/))return r<0?"-"+ei(e,t,-r):Bo(""+(Math.floor(r)+mU(r,i[1].length)))+"."+Ri(m3(r,i[1].length),i[1].length);if(i=t.match(/^#,#*,#0/))return ei(e,t.replace(/^#,#*,/,""),r);if(i=t.match(/^([0#]+)(\\?-([0#]+))+$/))return a=Su(ei(e,t.replace(/[\\-]/g,""),r)),s=0,Su(Su(t.replace(/\\/g,"")).replace(/[0#]/g,function(g){return s<a.length?a.charAt(s++):g==="0"?"0":""}));if(t.match(WA))return a=ei(e,"##########",r),"("+a.substr(0,3)+") "+a.substr(3,3)+"-"+a.substr(6);var u="";if(i=t.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return s=Math.min(i[4].length,7),o=k1(l,Math.pow(10,s)-1,!1),a=""+c,u=Hs("n",i[1],o[1]),u.charAt(u.length-1)==" "&&(u=u.substr(0,u.length-1)+"0"),a+=u+i[2]+"/"+i[3],u=_1(o[2],s),u.length<i[4].length&&(u=Zn(i[4].substr(i[4].length-u.length))+u),a+=u,a;if(i=t.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return s=Math.min(Math.max(i[1].length,i[4].length),7),o=k1(l,Math.pow(10,s)-1,!0),c+(o[0]||(o[1]?"":"0"))+" "+(o[1]?u5(o[1],s)+i[2]+"/"+i[3]+_1(o[2],s):Fr(" ",2*s+1+i[2].length+i[3].length));if(i=t.match(/^[#0?]+$/))return a=Wc(r,0),t.length<=a.length?a:Zn(t.substr(0,t.length-a.length))+a;if(i=t.match(/^([#0?]+)\.([#0]+)$/)){a=""+r.toFixed(Math.min(i[2].length,10)).replace(/([^0])0+$/,"$1"),s=a.indexOf(".");var f=t.indexOf(".")-s,p=t.length-a.length-f;return Zn(t.substr(0,f)+a+t.substr(t.length-p))}if(i=t.match(/^00,000\.([#0]*0)$/))return s=m3(r,i[1].length),r<0?"-"+ei(e,t,-r):Bo(gU(r)).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(g){return"00,"+(g.length<3?Ri(0,3-g.length):"")+g})+"."+Ri(s,i[1].length);switch(t){case"###,##0.00":return ei(e,"#,##0.00",r);case"###,###":case"##,###":case"#,###":var h=Bo(Wc(l,0));return h!=="0"?c+h:"";case"###,###.00":return ei(e,"###,##0.00",r).replace(/^0\./,".");case"#,###.00":return ei(e,"#,##0.00",r).replace(/^0\./,".")}throw new Error("unsupported format |"+t+"|")}function vU(e,t,r){for(var n=t.length-1;t.charCodeAt(n-1)===44;)--n;return Hs(e,t.substr(0,n),r/Math.pow(10,3*(t.length-n)))}function xU(e,t,r){var n=t.replace(UA,""),a=t.length-n.length;return Hs(e,n,r*Math.pow(10,2*a))+Fr("%",a)}function qA(e,t){var r,n=e.indexOf("E")-e.indexOf(".")-1;if(e.match(/^#+0.0E\+0$/)){if(t==0)return"0.0E+0";if(t<0)return"-"+qA(e,-t);var a=e.indexOf(".");a===-1&&(a=e.indexOf("E"));var i=Math.floor(Math.log(t)*Math.LOG10E)%a;if(i<0&&(i+=a),r=(t/Math.pow(10,i)).toPrecision(n+1+(a+i)%a),!r.match(/[Ee]/)){var s=Math.floor(Math.log(t)*Math.LOG10E);r.indexOf(".")===-1?r=r.charAt(0)+"."+r.substr(1)+"E+"+(s-r.length+i):r+="E+"+(s-i),r=r.replace(/\+-/,"-")}r=r.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(o,l,c,u){return l+c+u.substr(0,(a+i)%a)+"."+u.substr(i)+"E"})}else r=t.toExponential(n);return e.match(/E\+00$/)&&r.match(/e[+-]\d$/)&&(r=r.substr(0,r.length-1)+"0"+r.charAt(r.length-1)),e.match(/E\-/)&&r.match(/e\+/)&&(r=r.replace(/e\+/,"e")),r.replace("e","E")}function ts(e,t,r){if(e.charCodeAt(0)===40&&!t.match(HA)){var n=t.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return r>=0?ts("n",n,r):"("+ts("n",n,-r)+")"}if(t.charCodeAt(t.length-1)===44)return vU(e,t,r);if(t.indexOf("%")!==-1)return xU(e,t,r);if(t.indexOf("E")!==-1)return qA(t,r);if(t.charCodeAt(0)===36)return"$"+ts(e,t.substr(t.charAt(1)==" "?2:1),r);var a,i,s,o,l=Math.abs(r),c=r<0?"-":"";if(t.match(/^00+$/))return c+Ri(l,t.length);if(t.match(/^[#?]+$/))return a=""+r,r===0&&(a=""),a.length>t.length?a:Zn(t.substr(0,t.length-a.length))+a;if(i=t.match($A))return pU(i,l,c);if(t.match(/^#+0+$/))return c+Ri(l,t.length-t.indexOf("0"));if(i=t.match(zA))return a=(""+r).replace(/^([^\.]+)$/,"$1."+Zn(i[1])).replace(/\.$/,"."+Zn(i[1])),a=a.replace(/\.(\d*)$/,function(g,m){return"."+m+Fr("0",Zn(i[1]).length-m.length)}),t.indexOf("0.")!==-1?a:a.replace(/^0\./,".");if(t=t.replace(/^#+([0.])/,"$1"),i=t.match(/^(0*)\.(#*)$/))return c+(""+l).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,i[1].length?"0.":".");if(i=t.match(/^#{1,3},##0(\.?)$/))return c+Bo(""+l);if(i=t.match(/^#,##0\.([#0]*0)$/))return r<0?"-"+ts(e,t,-r):Bo(""+r)+"."+Fr("0",i[1].length);if(i=t.match(/^#,#*,#0/))return ts(e,t.replace(/^#,#*,/,""),r);if(i=t.match(/^([0#]+)(\\?-([0#]+))+$/))return a=Su(ts(e,t.replace(/[\\-]/g,""),r)),s=0,Su(Su(t.replace(/\\/g,"")).replace(/[0#]/g,function(g){return s<a.length?a.charAt(s++):g==="0"?"0":""}));if(t.match(WA))return a=ts(e,"##########",r),"("+a.substr(0,3)+") "+a.substr(3,3)+"-"+a.substr(6);var u="";if(i=t.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return s=Math.min(i[4].length,7),o=k1(l,Math.pow(10,s)-1,!1),a=""+c,u=Hs("n",i[1],o[1]),u.charAt(u.length-1)==" "&&(u=u.substr(0,u.length-1)+"0"),a+=u+i[2]+"/"+i[3],u=_1(o[2],s),u.length<i[4].length&&(u=Zn(i[4].substr(i[4].length-u.length))+u),a+=u,a;if(i=t.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return s=Math.min(Math.max(i[1].length,i[4].length),7),o=k1(l,Math.pow(10,s)-1,!0),c+(o[0]||(o[1]?"":"0"))+" "+(o[1]?u5(o[1],s)+i[2]+"/"+i[3]+_1(o[2],s):Fr(" ",2*s+1+i[2].length+i[3].length));if(i=t.match(/^[#0?]+$/))return a=""+r,t.length<=a.length?a:Zn(t.substr(0,t.length-a.length))+a;if(i=t.match(/^([#0]+)\.([#0]+)$/)){a=""+r.toFixed(Math.min(i[2].length,10)).replace(/([^0])0+$/,"$1"),s=a.indexOf(".");var f=t.indexOf(".")-s,p=t.length-a.length-f;return Zn(t.substr(0,f)+a+t.substr(t.length-p))}if(i=t.match(/^00,000\.([#0]*0)$/))return r<0?"-"+ts(e,t,-r):Bo(""+r).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(g){return"00,"+(g.length<3?Ri(0,3-g.length):"")+g})+"."+Ri(0,i[1].length);switch(t){case"###,###":case"##,###":case"#,###":var h=Bo(""+l);return h!=="0"?c+h:"";default:if(t.match(/\.[0#?]*$/))return ts(e,t.slice(0,t.lastIndexOf(".")),r)+Zn(t.slice(t.lastIndexOf(".")))}throw new Error("unsupported format |"+t+"|")}function Hs(e,t,r){return(r|0)===r?ts(e,t,r):ei(e,t,r)}function yU(e){for(var t=[],r=!1,n=0,a=0;n<e.length;++n)switch(e.charCodeAt(n)){case 34:r=!r;break;case 95:case 42:case 92:++n;break;case 59:t[t.length]=e.substr(a,n-a),a=n+1}if(t[t.length]=e.substr(a),r===!0)throw new Error("Format |"+e+"| unterminated string ");return t}var GA=/\[[HhMmSs\u0E0A\u0E19\u0E17]*\]/;function Zu(e){for(var t=0,r="",n="";t<e.length;)switch(r=e.charAt(t)){case"G":S1(e,t)&&(t+=6),t++;break;case'"':for(;e.charCodeAt(++t)!==34&&t<e.length;);++t;break;case"\\":t+=2;break;case"_":t+=2;break;case"@":++t;break;case"B":case"b":if(e.charAt(t+1)==="1"||e.charAt(t+1)==="2")return!0;case"M":case"D":case"Y":case"H":case"S":case"E":case"m":case"d":case"y":case"h":case"s":case"e":case"g":return!0;case"A":case"a":case"":if(e.substr(t,3).toUpperCase()==="A/P"||e.substr(t,5).toUpperCase()==="AM/PM"||e.substr(t,5).toUpperCase()==="/")return!0;++t;break;case"[":for(n=r;e.charAt(t++)!=="]"&&t<e.length;)n+=e.charAt(t);if(n.match(GA))return!0;break;case".":case"0":case"#":for(;t<e.length&&("0#?.,E+-%".indexOf(r=e.charAt(++t))>-1||r=="\\"&&e.charAt(t+1)=="-"&&"0#".indexOf(e.charAt(t+2))>-1););break;case"?":for(;e.charAt(++t)===r;);break;case"*":++t,(e.charAt(t)==" "||e.charAt(t)=="*")&&++t;break;case"(":case")":++t;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(;t<e.length&&"0123456789".indexOf(e.charAt(++t))>-1;);break;case" ":++t;break;default:++t;break}return!1}function wU(e,t,r,n){for(var a=[],i="",s=0,o="",l="t",c,u,f,p="H";s<e.length;)switch(o=e.charAt(s)){case"G":if(!S1(e,s))throw new Error("unrecognized character "+o+" in "+e);a[a.length]={t:"G",v:"General"},s+=7;break;case'"':for(i="";(f=e.charCodeAt(++s))!==34&&s<e.length;)i+=String.fromCharCode(f);a[a.length]={t:"t",v:i},++s;break;case"\\":var h=e.charAt(++s),g=h==="("||h===")"?h:"t";a[a.length]={t:g,v:h},++s;break;case"_":a[a.length]={t:"t",v:" "},s+=2;break;case"@":a[a.length]={t:"T",v:t},++s;break;case"B":case"b":if(e.charAt(s+1)==="1"||e.charAt(s+1)==="2"){if(c==null&&(c=Vl(t,r,e.charAt(s+1)==="2"),c==null))return"";a[a.length]={t:"X",v:e.substr(s,2)},l=o,s+=2;break}case"M":case"D":case"Y":case"H":case"S":case"E":o=o.toLowerCase();case"m":case"d":case"y":case"h":case"s":case"e":case"g":if(t<0||c==null&&(c=Vl(t,r),c==null))return"";for(i=o;++s<e.length&&e.charAt(s).toLowerCase()===o;)i+=o;o==="m"&&l.toLowerCase()==="h"&&(o="M"),o==="h"&&(o=p),a[a.length]={t:o,v:i},l=o;break;case"A":case"a":case"":var m={t:o,v:o};if(c==null&&(c=Vl(t,r)),e.substr(s,3).toUpperCase()==="A/P"?(c!=null&&(m.v=c.H>=12?"P":"A"),m.t="T",p="h",s+=3):e.substr(s,5).toUpperCase()==="AM/PM"?(c!=null&&(m.v=c.H>=12?"PM":"AM"),m.t="T",s+=5,p="h"):e.substr(s,5).toUpperCase()==="/"?(c!=null&&(m.v=c.H>=12?"":""),m.t="T",s+=5,p="h"):(m.t="t",++s),c==null&&m.t==="T")return"";a[a.length]=m,l=o;break;case"[":for(i=o;e.charAt(s++)!=="]"&&s<e.length;)i+=e.charAt(s);if(i.slice(-1)!=="]")throw'unterminated "[" block: |'+i+"|";if(i.match(GA)){if(c==null&&(c=Vl(t,r),c==null))return"";a[a.length]={t:"Z",v:i.toLowerCase()},l=i.charAt(1)}else i.indexOf("$")>-1&&(i=(i.match(/\$([^-\[\]]*)/)||[])[1]||"$",Zu(e)||(a[a.length]={t:"t",v:i}));break;case".":if(c!=null){for(i=o;++s<e.length&&(o=e.charAt(s))==="0";)i+=o;a[a.length]={t:"s",v:i};break}case"0":case"#":for(i=o;++s<e.length&&"0#?.,E+-%".indexOf(o=e.charAt(s))>-1;)i+=o;a[a.length]={t:"n",v:i};break;case"?":for(i=o;e.charAt(++s)===o;)i+=o;a[a.length]={t:o,v:i},l=o;break;case"*":++s,(e.charAt(s)==" "||e.charAt(s)=="*")&&++s;break;case"(":case")":a[a.length]={t:n===1?"t":o,v:o},++s;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(i=o;s<e.length&&"0123456789".indexOf(e.charAt(++s))>-1;)i+=e.charAt(s);a[a.length]={t:"D",v:i};break;case" ":a[a.length]={t:o,v:o},++s;break;case"$":a[a.length]={t:"t",v:"$"},++s;break;default:if(",$-+/():!^&'~{}<>=acfijklopqrtuvwxzP".indexOf(o)===-1)throw new Error("unrecognized character "+o+" in "+e);a[a.length]={t:"t",v:o},++s;break}var b=0,x=0,w;for(s=a.length-1,l="t";s>=0;--s)switch(a[s].t){case"h":case"H":a[s].t=p,l="h",b<1&&(b=1);break;case"s":(w=a[s].v.match(/\.0+$/))&&(x=Math.max(x,w[0].length-1)),b<3&&(b=3);case"d":case"y":case"M":case"e":l=a[s].t;break;case"m":l==="s"&&(a[s].t="M",b<2&&(b=2));break;case"X":break;case"Z":b<1&&a[s].v.match(/[Hh]/)&&(b=1),b<2&&a[s].v.match(/[Mm]/)&&(b=2),b<3&&a[s].v.match(/[Ss]/)&&(b=3)}switch(b){case 0:break;case 1:c.u>=.5&&(c.u=0,++c.S),c.S>=60&&(c.S=0,++c.M),c.M>=60&&(c.M=0,++c.H);break;case 2:c.u>=.5&&(c.u=0,++c.S),c.S>=60&&(c.S=0,++c.M);break}var y="",A;for(s=0;s<a.length;++s)switch(a[s].t){case"t":case"T":case" ":case"D":break;case"X":a[s].v="",a[s].t=";";break;case"d":case"m":case"y":case"h":case"H":case"M":case"s":case"e":case"b":case"Z":a[s].v=uU(a[s].t.charCodeAt(0),a[s].v,c,x),a[s].t="t";break;case"n":case"?":for(A=s+1;a[A]!=null&&((o=a[A].t)==="?"||o==="D"||(o===" "||o==="t")&&a[A+1]!=null&&(a[A+1].t==="?"||a[A+1].t==="t"&&a[A+1].v==="/")||a[s].t==="("&&(o===" "||o==="n"||o===")")||o==="t"&&(a[A].v==="/"||a[A].v===" "&&a[A+1]!=null&&a[A+1].t=="?"));)a[s].v+=a[A].v,a[A]={v:"",t:";"},++A;y+=a[s].v,s=A-1;break;case"G":a[s].t="t",a[s].v=tc(t,r);break}var L="",D,T;if(y.length>0){y.charCodeAt(0)==40?(D=t<0&&y.charCodeAt(0)===45?-t:t,T=Hs("n",y,D)):(D=t<0&&n>1?-t:t,T=Hs("n",y,D),D<0&&a[0]&&a[0].t=="t"&&(T=T.substr(1),a[0].v="-"+a[0].v)),A=T.length-1;var F=a.length;for(s=0;s<a.length;++s)if(a[s]!=null&&a[s].t!="t"&&a[s].v.indexOf(".")>-1){F=s;break}var R=a.length;if(F===a.length&&T.indexOf("E")===-1){for(s=a.length-1;s>=0;--s)a[s]==null||"n?".indexOf(a[s].t)===-1||(A>=a[s].v.length-1?(A-=a[s].v.length,a[s].v=T.substr(A+1,a[s].v.length)):A<0?a[s].v="":(a[s].v=T.substr(0,A+1),A=-1),a[s].t="t",R=s);A>=0&&R<a.length&&(a[R].v=T.substr(0,A+1)+a[R].v)}else if(F!==a.length&&T.indexOf("E")===-1){for(A=T.indexOf(".")-1,s=F;s>=0;--s)if(!(a[s]==null||"n?".indexOf(a[s].t)===-1)){for(u=a[s].v.indexOf(".")>-1&&s===F?a[s].v.indexOf(".")-1:a[s].v.length-1,L=a[s].v.substr(u+1);u>=0;--u)A>=0&&(a[s].v.charAt(u)==="0"||a[s].v.charAt(u)==="#")&&(L=T.charAt(A--)+L);a[s].v=L,a[s].t="t",R=s}for(A>=0&&R<a.length&&(a[R].v=T.substr(0,A+1)+a[R].v),A=T.indexOf(".")+1,s=F;s<a.length;++s)if(!(a[s]==null||"n?(".indexOf(a[s].t)===-1&&s!==F)){for(u=a[s].v.indexOf(".")>-1&&s===F?a[s].v.indexOf(".")+1:0,L=a[s].v.substr(0,u);u<a[s].v.length;++u)A<T.length&&(L+=T.charAt(A++));a[s].v=L,a[s].t="t",R=s}}}for(s=0;s<a.length;++s)a[s]!=null&&"n?".indexOf(a[s].t)>-1&&(D=n>1&&t<0&&s>0&&a[s-1].v==="-"?-t:t,a[s].v=Hs(a[s].t,a[s].v,D),a[s].t="t");var X="";for(s=0;s!==a.length;++s)a[s]!=null&&(X+=a[s].v);return X}var g3=/\[(=|>[=]?|<[>=]?)(-?\d+(?:\.\d*)?)\]/;function v3(e,t){if(t==null)return!1;var r=parseFloat(t[2]);switch(t[1]){case"=":if(e==r)return!0;break;case">":if(e>r)return!0;break;case"<":if(e<r)return!0;break;case"<>":if(e!=r)return!0;break;case">=":if(e>=r)return!0;break;case"<=":if(e<=r)return!0;break}return!1}function bU(e,t){var r=yU(e),n=r.length,a=r[n-1].indexOf("@");if(n<4&&a>-1&&--n,r.length>4)throw new Error("cannot find right format for |"+r.join("|")+"|");if(typeof t!="number")return[4,r.length===4||a>-1?r[r.length-1]:"@"];switch(r.length){case 1:r=a>-1?["General","General","General",r[0]]:[r[0],r[0],r[0],"@"];break;case 2:r=a>-1?[r[0],r[0],r[0],r[1]]:[r[0],r[1],r[0],"@"];break;case 3:r=a>-1?[r[0],r[1],r[0],r[2]]:[r[0],r[1],r[2],"@"];break}var i=t>0?r[0]:t<0?r[1]:r[2];if(r[0].indexOf("[")===-1&&r[1].indexOf("[")===-1)return[n,i];if(r[0].match(/\[[=<>]/)!=null||r[1].match(/\[[=<>]/)!=null){var s=r[0].match(g3),o=r[1].match(g3);return v3(t,s)?[n,r[0]]:v3(t,o)?[n,r[1]]:[n,r[s!=null&&o!=null?2:1]]}return[n,i]}function fi(e,t,r){r==null&&(r={});var n="";switch(typeof e){case"string":e=="m/d/yy"&&r.dateNF?n=r.dateNF:n=e;break;case"number":e==14&&r.dateNF?n=r.dateNF:n=(r.table!=null?r.table:Ft)[e],n==null&&(n=r.table&&r.table[d3[e]]||Ft[d3[e]]),n==null&&(n=nU[e]||"General");break}if(S1(n,0))return tc(t,r);t instanceof Date&&(t=BA(t,r.date1904));var a=bU(n,t);if(S1(a[1]))return tc(t,r);if(t===!0)t="TRUE";else if(t===!1)t="FALSE";else if(t===""||t==null)return"";return wU(a[1],t,r,a[0])}function ql(e,t){if(typeof t!="number"){t=+t||-1;for(var r=0;r<392;++r){if(Ft[r]==null){t<0&&(t=r);continue}if(Ft[r]==e){t=r;break}}t<0&&(t=391)}return Ft[t]=e,t}function KA(){Ft=rU()}var _U={5:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',23:"General",24:"General",25:"General",26:"General",27:"m/d/yy",28:"m/d/yy",29:"m/d/yy",30:"m/d/yy",31:"m/d/yy",32:"h:mm:ss",33:"h:mm:ss",34:"h:mm:ss",35:"h:mm:ss",36:"m/d/yy",41:'_(* #,##0_);_(* (#,##0);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* (#,##0);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* (#,##0.00);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* (#,##0.00);_("$"* "-"??_);_(@_)',50:"m/d/yy",51:"m/d/yy",52:"m/d/yy",53:"m/d/yy",54:"m/d/yy",55:"m/d/yy",56:"m/d/yy",57:"m/d/yy",58:"m/d/yy",59:"0",60:"0.00",61:"#,##0",62:"#,##0.00",63:'"$"#,##0_);\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',67:"0%",68:"0.00%",69:"# ?/?",70:"# ??/??",71:"m/d/yy",72:"m/d/yy",73:"d-mmm-yy",74:"d-mmm",75:"mmm-yy",76:"h:mm",77:"h:mm:ss",78:"m/d/yy h:mm",79:"mm:ss",80:"[h]:mm:ss",81:"mmss.0"},XA=/[dD]+|[mM]+|[yYeE]+|[Hh]+|[Ss]+/g;function SU(e){var t=typeof e=="number"?Ft[e]:e;return t=t.replace(XA,"(\\d+)"),new RegExp("^"+t+"$")}function kU(e,t,r){var n=-1,a=-1,i=-1,s=-1,o=-1,l=-1;(t.match(XA)||[]).forEach(function(f,p){var h=parseInt(r[p+1],10);switch(f.toLowerCase().charAt(0)){case"y":n=h;break;case"d":i=h;break;case"h":s=h;break;case"s":l=h;break;case"m":s>=0?o=h:a=h;break}}),l>=0&&o==-1&&a>=0&&(o=a,a=-1);var c=(""+(n>=0?n:new Date().getFullYear())).slice(-4)+"-"+("00"+(a>=1?a:1)).slice(-2)+"-"+("00"+(i>=1?i:1)).slice(-2);c.length==7&&(c="0"+c),c.length==8&&(c="20"+c);var u=("00"+(s>=0?s:0)).slice(-2)+":"+("00"+(o>=0?o:0)).slice(-2)+":"+("00"+(l>=0?l:0)).slice(-2);return s==-1&&o==-1&&l==-1?c:n==-1&&a==-1&&i==-1?u:c+"T"+u}var EU=function(){var e={};e.version="1.2.0";function t(){for(var T=0,F=new Array(256),R=0;R!=256;++R)T=R,T=T&1?-306674912^T>>>1:T>>>1,T=T&1?-306674912^T>>>1:T>>>1,T=T&1?-306674912^T>>>1:T>>>1,T=T&1?-306674912^T>>>1:T>>>1,T=T&1?-306674912^T>>>1:T>>>1,T=T&1?-306674912^T>>>1:T>>>1,T=T&1?-306674912^T>>>1:T>>>1,T=T&1?-306674912^T>>>1:T>>>1,F[R]=T;return typeof Int32Array<"u"?new Int32Array(F):F}var r=t();function n(T){var F=0,R=0,X=0,N=typeof Int32Array<"u"?new Int32Array(4096):new Array(4096);for(X=0;X!=256;++X)N[X]=T[X];for(X=0;X!=256;++X)for(R=T[X],F=256+X;F<4096;F+=256)R=N[F]=R>>>8^T[R&255];var P=[];for(X=1;X!=16;++X)P[X-1]=typeof Int32Array<"u"?N.subarray(X*256,X*256+256):N.slice(X*256,X*256+256);return P}var a=n(r),i=a[0],s=a[1],o=a[2],l=a[3],c=a[4],u=a[5],f=a[6],p=a[7],h=a[8],g=a[9],m=a[10],b=a[11],x=a[12],w=a[13],y=a[14];function A(T,F){for(var R=F^-1,X=0,N=T.length;X<N;)R=R>>>8^r[(R^T.charCodeAt(X++))&255];return~R}function L(T,F){for(var R=F^-1,X=T.length-15,N=0;N<X;)R=y[T[N++]^R&255]^w[T[N++]^R>>8&255]^x[T[N++]^R>>16&255]^b[T[N++]^R>>>24]^m[T[N++]]^g[T[N++]]^h[T[N++]]^p[T[N++]]^f[T[N++]]^u[T[N++]]^c[T[N++]]^l[T[N++]]^o[T[N++]]^s[T[N++]]^i[T[N++]]^r[T[N++]];for(X+=15;N<X;)R=R>>>8^r[(R^T[N++])&255];return~R}function D(T,F){for(var R=F^-1,X=0,N=T.length,P=0,J=0;X<N;)P=T.charCodeAt(X++),P<128?R=R>>>8^r[(R^P)&255]:P<2048?(R=R>>>8^r[(R^(192|P>>6&31))&255],R=R>>>8^r[(R^(128|P&63))&255]):P>=55296&&P<57344?(P=(P&1023)+64,J=T.charCodeAt(X++)&1023,R=R>>>8^r[(R^(240|P>>8&7))&255],R=R>>>8^r[(R^(128|P>>2&63))&255],R=R>>>8^r[(R^(128|J>>6&15|(P&3)<<4))&255],R=R>>>8^r[(R^(128|J&63))&255]):(R=R>>>8^r[(R^(224|P>>12&15))&255],R=R>>>8^r[(R^(128|P>>6&63))&255],R=R>>>8^r[(R^(128|P&63))&255]);return~R}return e.table=r,e.bstr=A,e.buf=L,e.str=D,e}(),Bt=function(){var t={};t.version="1.2.1";function r(z,le){for(var ee=z.split("/"),te=le.split("/"),oe=0,ce=0,ke=Math.min(ee.length,te.length);oe<ke;++oe){if(ce=ee[oe].length-te[oe].length)return ce;if(ee[oe]!=te[oe])return ee[oe]<te[oe]?-1:1}return ee.length-te.length}function n(z){if(z.charAt(z.length-1)=="/")return z.slice(0,-1).indexOf("/")===-1?z:n(z.slice(0,-1));var le=z.lastIndexOf("/");return le===-1?z:z.slice(0,le+1)}function a(z){if(z.charAt(z.length-1)=="/")return a(z.slice(0,-1));var le=z.lastIndexOf("/");return le===-1?z:z.slice(le+1)}function i(z,le){typeof le=="string"&&(le=new Date(le));var ee=le.getHours();ee=ee<<6|le.getMinutes(),ee=ee<<5|le.getSeconds()>>>1,z.write_shift(2,ee);var te=le.getFullYear()-1980;te=te<<4|le.getMonth()+1,te=te<<5|le.getDate(),z.write_shift(2,te)}function s(z){var le=z.read_shift(2)&65535,ee=z.read_shift(2)&65535,te=new Date,oe=ee&31;ee>>>=5;var ce=ee&15;ee>>>=4,te.setMilliseconds(0),te.setFullYear(ee+1980),te.setMonth(ce-1),te.setDate(oe);var ke=le&31;le>>>=5;var Le=le&63;return le>>>=6,te.setHours(le),te.setMinutes(Le),te.setSeconds(ke<<1),te}function o(z){bn(z,0);for(var le={},ee=0;z.l<=z.length-4;){var te=z.read_shift(2),oe=z.read_shift(2),ce=z.l+oe,ke={};switch(te){case 21589:ee=z.read_shift(1),ee&1&&(ke.mtime=z.read_shift(4)),oe>5&&(ee&2&&(ke.atime=z.read_shift(4)),ee&4&&(ke.ctime=z.read_shift(4))),ke.mtime&&(ke.mt=new Date(ke.mtime*1e3));break}z.l=ce,le[te]=ke}return le}var l;function c(){return l||(l={})}function u(z,le){if(z[0]==80&&z[1]==75)return mr(z,le);if((z[0]|32)==109&&(z[1]|32)==105)return Ha(z,le);if(z.length<512)throw new Error("CFB file size "+z.length+" < 512");var ee=3,te=512,oe=0,ce=0,ke=0,Le=0,Se=0,Te=[],Ne=z.slice(0,512);bn(Ne,0);var $e=f(Ne);switch(ee=$e[0],ee){case 3:te=512;break;case 4:te=4096;break;case 0:if($e[1]==0)return mr(z,le);default:throw new Error("Major Version: Expected 3 or 4 saw "+ee)}te!==512&&(Ne=z.slice(0,te),bn(Ne,28));var Ge=z.slice(0,te);p(Ne,ee);var rt=Ne.read_shift(4,"i");if(ee===3&&rt!==0)throw new Error("# Directory Sectors: Expected 0 saw "+rt);Ne.l+=4,ke=Ne.read_shift(4,"i"),Ne.l+=4,Ne.chk("00100000","Mini Stream Cutoff Size: "),Le=Ne.read_shift(4,"i"),oe=Ne.read_shift(4,"i"),Se=Ne.read_shift(4,"i"),ce=Ne.read_shift(4,"i");for(var We=-1,tt=0;tt<109&&(We=Ne.read_shift(4,"i"),!(We<0));++tt)Te[tt]=We;var bt=h(z,te);b(Se,ce,bt,te,Te);var Xt=w(bt,ke,Te,te);Xt[ke].name="!Directory",oe>0&&Le!==J&&(Xt[Le].name="!MiniFAT"),Xt[Te[0]].name="!FAT",Xt.fat_addrs=Te,Xt.ssz=te;var nr={},Hr=[],pi=[],ys=[];y(ke,Xt,bt,Hr,oe,nr,pi,Le),g(pi,ys,Hr),Hr.shift();var Gi={FileIndex:pi,FullPaths:ys};return le&&le.raw&&(Gi.raw={header:Ge,sectors:bt}),Gi}function f(z){if(z[z.l]==80&&z[z.l+1]==75)return[0,0];z.chk(W,"Header Signature: "),z.l+=16;var le=z.read_shift(2,"u");return[z.read_shift(2,"u"),le]}function p(z,le){var ee=9;switch(z.l+=2,ee=z.read_shift(2)){case 9:if(le!=3)throw new Error("Sector Shift: Expected 9 saw "+ee);break;case 12:if(le!=4)throw new Error("Sector Shift: Expected 12 saw "+ee);break;default:throw new Error("Sector Shift: Expected 9 or 12 saw "+ee)}z.chk("0600","Mini Sector Shift: "),z.chk("000000000000","Reserved: ")}function h(z,le){for(var ee=Math.ceil(z.length/le)-1,te=[],oe=1;oe<ee;++oe)te[oe-1]=z.slice(oe*le,(oe+1)*le);return te[ee-1]=z.slice(ee*le),te}function g(z,le,ee){for(var te=0,oe=0,ce=0,ke=0,Le=0,Se=ee.length,Te=[],Ne=[];te<Se;++te)Te[te]=Ne[te]=te,le[te]=ee[te];for(;Le<Ne.length;++Le)te=Ne[Le],oe=z[te].L,ce=z[te].R,ke=z[te].C,Te[te]===te&&(oe!==-1&&Te[oe]!==oe&&(Te[te]=Te[oe]),ce!==-1&&Te[ce]!==ce&&(Te[te]=Te[ce])),ke!==-1&&(Te[ke]=te),oe!==-1&&te!=Te[te]&&(Te[oe]=Te[te],Ne.lastIndexOf(oe)<Le&&Ne.push(oe)),ce!==-1&&te!=Te[te]&&(Te[ce]=Te[te],Ne.lastIndexOf(ce)<Le&&Ne.push(ce));for(te=1;te<Se;++te)Te[te]===te&&(ce!==-1&&Te[ce]!==ce?Te[te]=Te[ce]:oe!==-1&&Te[oe]!==oe&&(Te[te]=Te[oe]));for(te=1;te<Se;++te)if(z[te].type!==0){if(Le=te,Le!=Te[Le])do Le=Te[Le],le[te]=le[Le]+"/"+le[te];while(Le!==0&&Te[Le]!==-1&&Le!=Te[Le]);Te[te]=-1}for(le[0]+="/",te=1;te<Se;++te)z[te].type!==2&&(le[te]+="/")}function m(z,le,ee){for(var te=z.start,oe=z.size,ce=[],ke=te;ee&&oe>0&&ke>=0;)ce.push(le.slice(ke*P,ke*P+P)),oe-=P,ke=Dl(ee,ke*4);return ce.length===0?rn(0):Do(ce).slice(0,z.size)}function b(z,le,ee,te,oe){var ce=J;if(z===J){if(le!==0)throw new Error("DIFAT chain shorter than expected")}else if(z!==-1){var ke=ee[z],Le=(te>>>2)-1;if(!ke)return;for(var Se=0;Se<Le&&(ce=Dl(ke,Se*4))!==J;++Se)oe.push(ce);b(Dl(ke,te-4),le-1,ee,te,oe)}}function x(z,le,ee,te,oe){var ce=[],ke=[];oe||(oe=[]);var Le=te-1,Se=0,Te=0;for(Se=le;Se>=0;){oe[Se]=!0,ce[ce.length]=Se,ke.push(z[Se]);var Ne=ee[Math.floor(Se*4/te)];if(Te=Se*4&Le,te<4+Te)throw new Error("FAT boundary crossed: "+Se+" 4 "+te);if(!z[Ne])break;Se=Dl(z[Ne],Te)}return{nodes:ce,data:T3([ke])}}function w(z,le,ee,te){var oe=z.length,ce=[],ke=[],Le=[],Se=[],Te=te-1,Ne=0,$e=0,Ge=0,rt=0;for(Ne=0;Ne<oe;++Ne)if(Le=[],Ge=Ne+le,Ge>=oe&&(Ge-=oe),!ke[Ge]){Se=[];var We=[];for($e=Ge;$e>=0;){We[$e]=!0,ke[$e]=!0,Le[Le.length]=$e,Se.push(z[$e]);var tt=ee[Math.floor($e*4/te)];if(rt=$e*4&Te,te<4+rt)throw new Error("FAT boundary crossed: "+$e+" 4 "+te);if(!z[tt]||($e=Dl(z[tt],rt),We[$e]))break}ce[Ge]={nodes:Le,data:T3([Se])}}return ce}function y(z,le,ee,te,oe,ce,ke,Le){for(var Se=0,Te=te.length?2:0,Ne=le[z].data,$e=0,Ge=0,rt;$e<Ne.length;$e+=128){var We=Ne.slice($e,$e+128);bn(We,64),Ge=We.read_shift(2),rt=g5(We,0,Ge-Te),te.push(rt);var tt={name:rt,type:We.read_shift(1),color:We.read_shift(1),L:We.read_shift(4,"i"),R:We.read_shift(4,"i"),C:We.read_shift(4,"i"),clsid:We.read_shift(16),state:We.read_shift(4,"i"),start:0,size:0},bt=We.read_shift(2)+We.read_shift(2)+We.read_shift(2)+We.read_shift(2);bt!==0&&(tt.ct=A(We,We.l-8));var Xt=We.read_shift(2)+We.read_shift(2)+We.read_shift(2)+We.read_shift(2);Xt!==0&&(tt.mt=A(We,We.l-8)),tt.start=We.read_shift(4,"i"),tt.size=We.read_shift(4,"i"),tt.size<0&&tt.start<0&&(tt.size=tt.type=0,tt.start=J,tt.name=""),tt.type===5?(Se=tt.start,oe>0&&Se!==J&&(le[Se].name="!StreamData")):tt.size>=4096?(tt.storage="fat",le[tt.start]===void 0&&(le[tt.start]=x(ee,tt.start,le.fat_addrs,le.ssz)),le[tt.start].name=tt.name,tt.content=le[tt.start].data.slice(0,tt.size)):(tt.storage="minifat",tt.size<0?tt.size=0:Se!==J&&tt.start!==J&&le[Se]&&(tt.content=m(tt,le[Se].data,(le[Le]||{}).data))),tt.content&&bn(tt.content,0),ce[rt]=tt,ke.push(tt)}}function A(z,le){return new Date((Fa(z,le+4)/1e7*Math.pow(2,32)+Fa(z,le)/1e7-11644473600)*1e3)}function L(z,le){return c(),u(l.readFileSync(z),le)}function D(z,le){var ee=le&&le.type;switch(ee||jt&&Buffer.isBuffer(z)&&(ee="buffer"),ee||"base64"){case"file":return L(z,le);case"base64":return u(Di(Ba(z)),le);case"binary":return u(Di(z),le)}return u(z,le)}function T(z,le){var ee=le||{},te=ee.root||"Root Entry";if(z.FullPaths||(z.FullPaths=[]),z.FileIndex||(z.FileIndex=[]),z.FullPaths.length!==z.FileIndex.length)throw new Error("inconsistent CFB structure");z.FullPaths.length===0&&(z.FullPaths[0]=te+"/",z.FileIndex[0]={name:te,type:5}),ee.CLSID&&(z.FileIndex[0].clsid=ee.CLSID),F(z)}function F(z){var le="Sh33tJ5";if(!Bt.find(z,"/"+le)){var ee=rn(4);ee[0]=55,ee[1]=ee[3]=50,ee[2]=54,z.FileIndex.push({name:le,type:2,content:ee,size:4,L:69,R:69,C:69}),z.FullPaths.push(z.FullPaths[0]+le),R(z)}}function R(z,le){T(z);for(var ee=!1,te=!1,oe=z.FullPaths.length-1;oe>=0;--oe){var ce=z.FileIndex[oe];switch(ce.type){case 0:te?ee=!0:(z.FileIndex.pop(),z.FullPaths.pop());break;case 1:case 2:case 5:te=!0,isNaN(ce.R*ce.L*ce.C)&&(ee=!0),ce.R>-1&&ce.L>-1&&ce.R==ce.L&&(ee=!0);break;default:ee=!0;break}}if(!(!ee&&!le)){var ke=new Date(1987,1,19),Le=0,Se=Object.create?Object.create(null):{},Te=[];for(oe=0;oe<z.FullPaths.length;++oe)Se[z.FullPaths[oe]]=!0,z.FileIndex[oe].type!==0&&Te.push([z.FullPaths[oe],z.FileIndex[oe]]);for(oe=0;oe<Te.length;++oe){var Ne=n(Te[oe][0]);te=Se[Ne],te||(Te.push([Ne,{name:a(Ne).replace("/",""),type:1,clsid:fe,ct:ke,mt:ke,content:null}]),Se[Ne]=!0)}for(Te.sort(function(rt,We){return r(rt[0],We[0])}),z.FullPaths=[],z.FileIndex=[],oe=0;oe<Te.length;++oe)z.FullPaths[oe]=Te[oe][0],z.FileIndex[oe]=Te[oe][1];for(oe=0;oe<Te.length;++oe){var $e=z.FileIndex[oe],Ge=z.FullPaths[oe];if($e.name=a(Ge).replace("/",""),$e.L=$e.R=$e.C=-($e.color=1),$e.size=$e.content?$e.content.length:0,$e.start=0,$e.clsid=$e.clsid||fe,oe===0)$e.C=Te.length>1?1:-1,$e.size=0,$e.type=5;else if(Ge.slice(-1)=="/"){for(Le=oe+1;Le<Te.length&&n(z.FullPaths[Le])!=Ge;++Le);for($e.C=Le>=Te.length?-1:Le,Le=oe+1;Le<Te.length&&n(z.FullPaths[Le])!=n(Ge);++Le);$e.R=Le>=Te.length?-1:Le,$e.type=1}else n(z.FullPaths[oe+1]||"")==n(Ge)&&($e.R=oe+1),$e.type=2}}}function X(z,le){var ee=le||{};if(ee.fileType=="mad")return dt(z,ee);switch(R(z),ee.fileType){case"zip":return di(z,ee)}var te=function(rt){for(var We=0,tt=0,bt=0;bt<rt.FileIndex.length;++bt){var Xt=rt.FileIndex[bt];if(Xt.content){var nr=Xt.content.length;nr>0&&(nr<4096?We+=nr+63>>6:tt+=nr+511>>9)}}for(var Hr=rt.FullPaths.length+3>>2,pi=We+7>>3,ys=We+127>>7,Gi=pi+tt+Hr+ys,mi=Gi+127>>7,Ki=mi<=109?0:Math.ceil((mi-109)/127);Gi+mi+Ki+127>>7>mi;)Ki=++mi<=109?0:Math.ceil((mi-109)/127);var Aa=[1,Ki,mi,ys,Hr,tt,We,0];return rt.FileIndex[0].size=We<<6,Aa[7]=(rt.FileIndex[0].start=Aa[0]+Aa[1]+Aa[2]+Aa[3]+Aa[4]+Aa[5])+(Aa[6]+7>>3),Aa}(z),oe=rn(te[7]<<9),ce=0,ke=0;{for(ce=0;ce<8;++ce)oe.write_shift(1,se[ce]);for(ce=0;ce<8;++ce)oe.write_shift(2,0);for(oe.write_shift(2,62),oe.write_shift(2,3),oe.write_shift(2,65534),oe.write_shift(2,9),oe.write_shift(2,6),ce=0;ce<3;++ce)oe.write_shift(2,0);for(oe.write_shift(4,0),oe.write_shift(4,te[2]),oe.write_shift(4,te[0]+te[1]+te[2]+te[3]-1),oe.write_shift(4,0),oe.write_shift(4,4096),oe.write_shift(4,te[3]?te[0]+te[1]+te[2]-1:J),oe.write_shift(4,te[3]),oe.write_shift(-4,te[1]?te[0]-1:J),oe.write_shift(4,te[1]),ce=0;ce<109;++ce)oe.write_shift(-4,ce<te[2]?te[1]+ce:-1)}if(te[1])for(ke=0;ke<te[1];++ke){for(;ce<236+ke*127;++ce)oe.write_shift(-4,ce<te[2]?te[1]+ce:-1);oe.write_shift(-4,ke===te[1]-1?J:ke+1)}var Le=function(rt){for(ke+=rt;ce<ke-1;++ce)oe.write_shift(-4,ce+1);rt&&(++ce,oe.write_shift(-4,J))};for(ke=ce=0,ke+=te[1];ce<ke;++ce)oe.write_shift(-4,U.DIFSECT);for(ke+=te[2];ce<ke;++ce)oe.write_shift(-4,U.FATSECT);Le(te[3]),Le(te[4]);for(var Se=0,Te=0,Ne=z.FileIndex[0];Se<z.FileIndex.length;++Se)Ne=z.FileIndex[Se],Ne.content&&(Te=Ne.content.length,!(Te<4096)&&(Ne.start=ke,Le(Te+511>>9)));for(Le(te[6]+7>>3);oe.l&511;)oe.write_shift(-4,U.ENDOFCHAIN);for(ke=ce=0,Se=0;Se<z.FileIndex.length;++Se)Ne=z.FileIndex[Se],Ne.content&&(Te=Ne.content.length,!(!Te||Te>=4096)&&(Ne.start=ke,Le(Te+63>>6)));for(;oe.l&511;)oe.write_shift(-4,U.ENDOFCHAIN);for(ce=0;ce<te[4]<<2;++ce){var $e=z.FullPaths[ce];if(!$e||$e.length===0){for(Se=0;Se<17;++Se)oe.write_shift(4,0);for(Se=0;Se<3;++Se)oe.write_shift(4,-1);for(Se=0;Se<12;++Se)oe.write_shift(4,0);continue}Ne=z.FileIndex[ce],ce===0&&(Ne.start=Ne.size?Ne.start-1:J);var Ge=ce===0&&ee.root||Ne.name;if(Te=2*(Ge.length+1),oe.write_shift(64,Ge,"utf16le"),oe.write_shift(2,Te),oe.write_shift(1,Ne.type),oe.write_shift(1,Ne.color),oe.write_shift(-4,Ne.L),oe.write_shift(-4,Ne.R),oe.write_shift(-4,Ne.C),Ne.clsid)oe.write_shift(16,Ne.clsid,"hex");else for(Se=0;Se<4;++Se)oe.write_shift(4,0);oe.write_shift(4,Ne.state||0),oe.write_shift(4,0),oe.write_shift(4,0),oe.write_shift(4,0),oe.write_shift(4,0),oe.write_shift(4,Ne.start),oe.write_shift(4,Ne.size),oe.write_shift(4,0)}for(ce=1;ce<z.FileIndex.length;++ce)if(Ne=z.FileIndex[ce],Ne.size>=4096)if(oe.l=Ne.start+1<<9,jt&&Buffer.isBuffer(Ne.content))Ne.content.copy(oe,oe.l,0,Ne.size),oe.l+=Ne.size+511&-512;else{for(Se=0;Se<Ne.size;++Se)oe.write_shift(1,Ne.content[Se]);for(;Se&511;++Se)oe.write_shift(1,0)}for(ce=1;ce<z.FileIndex.length;++ce)if(Ne=z.FileIndex[ce],Ne.size>0&&Ne.size<4096)if(jt&&Buffer.isBuffer(Ne.content))Ne.content.copy(oe,oe.l,0,Ne.size),oe.l+=Ne.size+63&-64;else{for(Se=0;Se<Ne.size;++Se)oe.write_shift(1,Ne.content[Se]);for(;Se&63;++Se)oe.write_shift(1,0)}if(jt)oe.l=oe.length;else for(;oe.l<oe.length;)oe.write_shift(1,0);return oe}function N(z,le){var ee=z.FullPaths.map(function(Se){return Se.toUpperCase()}),te=ee.map(function(Se){var Te=Se.split("/");return Te[Te.length-(Se.slice(-1)=="/"?2:1)]}),oe=!1;le.charCodeAt(0)===47?(oe=!0,le=ee[0].slice(0,-1)+le):oe=le.indexOf("/")!==-1;var ce=le.toUpperCase(),ke=oe===!0?ee.indexOf(ce):te.indexOf(ce);if(ke!==-1)return z.FileIndex[ke];var Le=!ce.match(Zf);for(ce=ce.replace(aa,""),Le&&(ce=ce.replace(Zf,"!")),ke=0;ke<ee.length;++ke)if((Le?ee[ke].replace(Zf,"!"):ee[ke]).replace(aa,"")==ce||(Le?te[ke].replace(Zf,"!"):te[ke]).replace(aa,"")==ce)return z.FileIndex[ke];return null}var P=64,J=-2,W="d0cf11e0a1b11ae1",se=[208,207,17,224,161,177,26,225],fe="00000000000000000000000000000000",U={MAXREGSECT:-6,DIFSECT:-4,FATSECT:-3,ENDOFCHAIN:J,FREESECT:-1,HEADER_SIGNATURE:W,HEADER_MINOR_VERSION:"3e00",MAXREGSID:-6,NOSTREAM:-1,HEADER_CLSID:fe,EntryTypes:["unknown","storage","stream","lockbytes","property","root"]};function Q(z,le,ee){c();var te=X(z,ee);l.writeFileSync(le,te)}function q(z){for(var le=new Array(z.length),ee=0;ee<z.length;++ee)le[ee]=String.fromCharCode(z[ee]);return le.join("")}function he(z,le){var ee=X(z,le);switch(le&&le.type||"buffer"){case"file":return c(),l.writeFileSync(le.filename,ee),ee;case"binary":return typeof ee=="string"?ee:q(ee);case"base64":return c3(typeof ee=="string"?ee:q(ee));case"buffer":if(jt)return Buffer.isBuffer(ee)?ee:fc(ee);case"array":return typeof ee=="string"?Di(ee):ee}return ee}var xe;function E(z){try{var le=z.InflateRaw,ee=new le;if(ee._processChunk(new Uint8Array([3,0]),ee._finishFlushFlag),ee.bytesRead)xe=z;else throw new Error("zlib does not expose bytesRead")}catch(te){console.error("cannot use native zlib: "+(te.message||te))}}function I(z,le){if(!xe)return Vt(z,le);var ee=xe.InflateRaw,te=new ee,oe=te._processChunk(z.slice(z.l),te._finishFlushFlag);return z.l+=te.bytesRead,oe}function O(z){return xe?xe.deflateRawSync(z):Ze(z)}var j=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],K=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258],ne=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577];function pe(z){var le=(z<<1|z<<11)&139536|(z<<5|z<<15)&558144;return(le>>16|le>>8|le)&255}for(var de=typeof Uint8Array<"u",we=de?new Uint8Array(256):[],Pe=0;Pe<256;++Pe)we[Pe]=pe(Pe);function Z(z,le){var ee=we[z&255];return le<=8?ee>>>8-le:(ee=ee<<8|we[z>>8&255],le<=16?ee>>>16-le:(ee=ee<<8|we[z>>16&255],ee>>>24-le))}function Ve(z,le){var ee=le&7,te=le>>>3;return(z[te]|(ee<=6?0:z[te+1]<<8))>>>ee&3}function Ke(z,le){var ee=le&7,te=le>>>3;return(z[te]|(ee<=5?0:z[te+1]<<8))>>>ee&7}function Ce(z,le){var ee=le&7,te=le>>>3;return(z[te]|(ee<=4?0:z[te+1]<<8))>>>ee&15}function ae(z,le){var ee=le&7,te=le>>>3;return(z[te]|(ee<=3?0:z[te+1]<<8))>>>ee&31}function De(z,le){var ee=le&7,te=le>>>3;return(z[te]|(ee<=1?0:z[te+1]<<8))>>>ee&127}function Xe(z,le,ee){var te=le&7,oe=le>>>3,ce=(1<<ee)-1,ke=z[oe]>>>te;return ee<8-te||(ke|=z[oe+1]<<8-te,ee<16-te)||(ke|=z[oe+2]<<16-te,ee<24-te)||(ke|=z[oe+3]<<24-te),ke&ce}function Me(z,le,ee){var te=le&7,oe=le>>>3;return te<=5?z[oe]|=(ee&7)<<te:(z[oe]|=ee<<te&255,z[oe+1]=(ee&7)>>8-te),le+3}function qe(z,le,ee){var te=le&7,oe=le>>>3;return ee=(ee&1)<<te,z[oe]|=ee,le+1}function Ye(z,le,ee){var te=le&7,oe=le>>>3;return ee<<=te,z[oe]|=ee&255,ee>>>=8,z[oe+1]=ee,le+8}function Je(z,le,ee){var te=le&7,oe=le>>>3;return ee<<=te,z[oe]|=ee&255,ee>>>=8,z[oe+1]=ee&255,z[oe+2]=ee>>>8,le+16}function st(z,le){var ee=z.length,te=2*ee>le?2*ee:le+5,oe=0;if(ee>=le)return z;if(jt){var ce=u3(te);if(z.copy)z.copy(ce);else for(;oe<z.length;++oe)ce[oe]=z[oe];return ce}else if(de){var ke=new Uint8Array(te);if(ke.set)ke.set(z);else for(;oe<ee;++oe)ke[oe]=z[oe];return ke}return z.length=te,z}function lt(z){for(var le=new Array(z),ee=0;ee<z;++ee)le[ee]=0;return le}function mt(z,le,ee){var te=1,oe=0,ce=0,ke=0,Le=0,Se=z.length,Te=de?new Uint16Array(32):lt(32);for(ce=0;ce<32;++ce)Te[ce]=0;for(ce=Se;ce<ee;++ce)z[ce]=0;Se=z.length;var Ne=de?new Uint16Array(Se):lt(Se);for(ce=0;ce<Se;++ce)Te[oe=z[ce]]++,te<oe&&(te=oe),Ne[ce]=0;for(Te[0]=0,ce=1;ce<=te;++ce)Te[ce+16]=Le=Le+Te[ce-1]<<1;for(ce=0;ce<Se;++ce)Le=z[ce],Le!=0&&(Ne[ce]=Te[Le+16]++);var $e=0;for(ce=0;ce<Se;++ce)if($e=z[ce],$e!=0)for(Le=Z(Ne[ce],te)>>te-$e,ke=(1<<te+4-$e)-1;ke>=0;--ke)le[Le|ke<<$e]=$e&15|ce<<4;return te}var wt=de?new Uint16Array(512):lt(512),Ot=de?new Uint16Array(32):lt(32);if(!de){for(var kt=0;kt<512;++kt)wt[kt]=0;for(kt=0;kt<32;++kt)Ot[kt]=0}(function(){for(var z=[],le=0;le<32;le++)z.push(5);mt(z,Ot,32);var ee=[];for(le=0;le<=143;le++)ee.push(8);for(;le<=255;le++)ee.push(9);for(;le<=279;le++)ee.push(7);for(;le<=287;le++)ee.push(8);mt(ee,wt,288)})();var ct=function(){for(var le=de?new Uint8Array(32768):[],ee=0,te=0;ee<ne.length-1;++ee)for(;te<ne[ee+1];++te)le[te]=ee;for(;te<32768;++te)le[te]=29;var oe=de?new Uint8Array(259):[];for(ee=0,te=0;ee<K.length-1;++ee)for(;te<K[ee+1];++te)oe[te]=ee;function ce(Le,Se){for(var Te=0;Te<Le.length;){var Ne=Math.min(65535,Le.length-Te),$e=Te+Ne==Le.length;for(Se.write_shift(1,+$e),Se.write_shift(2,Ne),Se.write_shift(2,~Ne&65535);Ne-- >0;)Se[Se.l++]=Le[Te++]}return Se.l}function ke(Le,Se){for(var Te=0,Ne=0,$e=de?new Uint16Array(32768):[];Ne<Le.length;){var Ge=Math.min(65535,Le.length-Ne);if(Ge<10){for(Te=Me(Se,Te,+(Ne+Ge==Le.length)),Te&7&&(Te+=8-(Te&7)),Se.l=Te/8|0,Se.write_shift(2,Ge),Se.write_shift(2,~Ge&65535);Ge-- >0;)Se[Se.l++]=Le[Ne++];Te=Se.l*8;continue}Te=Me(Se,Te,+(Ne+Ge==Le.length)+2);for(var rt=0;Ge-- >0;){var We=Le[Ne];rt=(rt<<5^We)&32767;var tt=-1,bt=0;if((tt=$e[rt])&&(tt|=Ne&-32768,tt>Ne&&(tt-=32768),tt<Ne))for(;Le[tt+bt]==Le[Ne+bt]&&bt<250;)++bt;if(bt>2){We=oe[bt],We<=22?Te=Ye(Se,Te,we[We+1]>>1)-1:(Ye(Se,Te,3),Te+=5,Ye(Se,Te,we[We-23]>>5),Te+=3);var Xt=We<8?0:We-4>>2;Xt>0&&(Je(Se,Te,bt-K[We]),Te+=Xt),We=le[Ne-tt],Te=Ye(Se,Te,we[We]>>3),Te-=3;var nr=We<4?0:We-2>>1;nr>0&&(Je(Se,Te,Ne-tt-ne[We]),Te+=nr);for(var Hr=0;Hr<bt;++Hr)$e[rt]=Ne&32767,rt=(rt<<5^Le[Ne])&32767,++Ne;Ge-=bt-1}else We<=143?We=We+48:Te=qe(Se,Te,1),Te=Ye(Se,Te,we[We]),$e[rt]=Ne&32767,++Ne}Te=Ye(Se,Te,0)-1}return Se.l=(Te+7)/8|0,Se.l}return function(Se,Te){return Se.length<8?ce(Se,Te):ke(Se,Te)}}();function Ze(z){var le=rn(50+Math.floor(z.length*1.1)),ee=ct(z,le);return le.slice(0,ee)}var ze=de?new Uint16Array(32768):lt(32768),Jt=de?new Uint16Array(32768):lt(32768),ht=de?new Uint16Array(128):lt(128),Zr=1,Kt=1;function lr(z,le){var ee=ae(z,le)+257;le+=5;var te=ae(z,le)+1;le+=5;var oe=Ce(z,le)+4;le+=4;for(var ce=0,ke=de?new Uint8Array(19):lt(19),Le=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],Se=1,Te=de?new Uint8Array(8):lt(8),Ne=de?new Uint8Array(8):lt(8),$e=ke.length,Ge=0;Ge<oe;++Ge)ke[j[Ge]]=ce=Ke(z,le),Se<ce&&(Se=ce),Te[ce]++,le+=3;var rt=0;for(Te[0]=0,Ge=1;Ge<=Se;++Ge)Ne[Ge]=rt=rt+Te[Ge-1]<<1;for(Ge=0;Ge<$e;++Ge)(rt=ke[Ge])!=0&&(Le[Ge]=Ne[rt]++);var We=0;for(Ge=0;Ge<$e;++Ge)if(We=ke[Ge],We!=0){rt=we[Le[Ge]]>>8-We;for(var tt=(1<<7-We)-1;tt>=0;--tt)ht[rt|tt<<We]=We&7|Ge<<3}var bt=[];for(Se=1;bt.length<ee+te;)switch(rt=ht[De(z,le)],le+=rt&7,rt>>>=3){case 16:for(ce=3+Ve(z,le),le+=2,rt=bt[bt.length-1];ce-- >0;)bt.push(rt);break;case 17:for(ce=3+Ke(z,le),le+=3;ce-- >0;)bt.push(0);break;case 18:for(ce=11+De(z,le),le+=7;ce-- >0;)bt.push(0);break;default:bt.push(rt),Se<rt&&(Se=rt);break}var Xt=bt.slice(0,ee),nr=bt.slice(ee);for(Ge=ee;Ge<286;++Ge)Xt[Ge]=0;for(Ge=te;Ge<30;++Ge)nr[Ge]=0;return Zr=mt(Xt,ze,286),Kt=mt(nr,Jt,30),le}function $a(z,le){if(z[0]==3&&!(z[1]&3))return[rl(le),2];for(var ee=0,te=0,oe=u3(le||1<<18),ce=0,ke=oe.length>>>0,Le=0,Se=0;!(te&1);){if(te=Ke(z,ee),ee+=3,te>>>1)te>>1==1?(Le=9,Se=5):(ee=lr(z,ee),Le=Zr,Se=Kt);else{ee&7&&(ee+=8-(ee&7));var Te=z[ee>>>3]|z[(ee>>>3)+1]<<8;if(ee+=32,Te>0)for(!le&&ke<ce+Te&&(oe=st(oe,ce+Te),ke=oe.length);Te-- >0;)oe[ce++]=z[ee>>>3],ee+=8;continue}for(;;){!le&&ke<ce+32767&&(oe=st(oe,ce+32767),ke=oe.length);var Ne=Xe(z,ee,Le),$e=te>>>1==1?wt[Ne]:ze[Ne];if(ee+=$e&15,$e>>>=4,!($e>>>8&255))oe[ce++]=$e;else{if($e==256)break;$e-=257;var Ge=$e<8?0:$e-4>>2;Ge>5&&(Ge=0);var rt=ce+K[$e];Ge>0&&(rt+=Xe(z,ee,Ge),ee+=Ge),Ne=Xe(z,ee,Se),$e=te>>>1==1?Ot[Ne]:Jt[Ne],ee+=$e&15,$e>>>=4;var We=$e<4?0:$e-2>>1,tt=ne[$e];for(We>0&&(tt+=Xe(z,ee,We),ee+=We),!le&&ke<rt&&(oe=st(oe,rt+100),ke=oe.length);ce<rt;)oe[ce]=oe[ce-tt],++ce}}}return le?[oe,ee+7>>>3]:[oe.slice(0,ce),ee+7>>>3]}function Vt(z,le){var ee=z.slice(z.l||0),te=$a(ee,le);return z.l+=te[1],te[0]}function qi(z,le){if(z)typeof console<"u"&&console.error(le);else throw new Error(le)}function mr(z,le){var ee=z;bn(ee,0);var te=[],oe=[],ce={FileIndex:te,FullPaths:oe};T(ce,{root:le.root});for(var ke=ee.length-4;(ee[ke]!=80||ee[ke+1]!=75||ee[ke+2]!=5||ee[ke+3]!=6)&&ke>=0;)--ke;ee.l=ke+4,ee.l+=4;var Le=ee.read_shift(2);ee.l+=6;var Se=ee.read_shift(4);for(ee.l=Se,ke=0;ke<Le;++ke){ee.l+=20;var Te=ee.read_shift(4),Ne=ee.read_shift(4),$e=ee.read_shift(2),Ge=ee.read_shift(2),rt=ee.read_shift(2);ee.l+=8;var We=ee.read_shift(4),tt=o(ee.slice(ee.l+$e,ee.l+$e+Ge));ee.l+=$e+Ge+rt;var bt=ee.l;ee.l=We+4,ka(ee,Te,Ne,ce,tt),ee.l=bt}return ce}function ka(z,le,ee,te,oe){z.l+=2;var ce=z.read_shift(2),ke=z.read_shift(2),Le=s(z);if(ce&8257)throw new Error("Unsupported ZIP encryption");for(var Se=z.read_shift(4),Te=z.read_shift(4),Ne=z.read_shift(4),$e=z.read_shift(2),Ge=z.read_shift(2),rt="",We=0;We<$e;++We)rt+=String.fromCharCode(z[z.l++]);if(Ge){var tt=o(z.slice(z.l,z.l+Ge));(tt[21589]||{}).mt&&(Le=tt[21589].mt),((oe||{})[21589]||{}).mt&&(Le=oe[21589].mt)}z.l+=Ge;var bt=z.slice(z.l,z.l+Te);switch(ke){case 8:bt=I(z,Ne);break;case 0:break;default:throw new Error("Unsupported ZIP Compression method "+ke)}var Xt=!1;ce&8&&(Se=z.read_shift(4),Se==134695760&&(Se=z.read_shift(4),Xt=!0),Te=z.read_shift(4),Ne=z.read_shift(4)),Te!=le&&qi(Xt,"Bad compressed size: "+le+" != "+Te),Ne!=ee&&qi(Xt,"Bad uncompressed size: "+ee+" != "+Ne),la(te,rt,bt,{unsafe:!0,mt:Le})}function di(z,le){var ee=le||{},te=[],oe=[],ce=rn(1),ke=ee.compression?8:0,Le=0,Se=0,Te=0,Ne=0,$e=0,Ge=z.FullPaths[0],rt=Ge,We=z.FileIndex[0],tt=[],bt=0;for(Se=1;Se<z.FullPaths.length;++Se)if(rt=z.FullPaths[Se].slice(Ge.length),We=z.FileIndex[Se],!(!We.size||!We.content||rt=="Sh33tJ5")){var Xt=Ne,nr=rn(rt.length);for(Te=0;Te<rt.length;++Te)nr.write_shift(1,rt.charCodeAt(Te)&127);nr=nr.slice(0,nr.l),tt[$e]=EU.buf(We.content,0);var Hr=We.content;ke==8&&(Hr=O(Hr)),ce=rn(30),ce.write_shift(4,67324752),ce.write_shift(2,20),ce.write_shift(2,Le),ce.write_shift(2,ke),We.mt?i(ce,We.mt):ce.write_shift(4,0),ce.write_shift(-4,tt[$e]),ce.write_shift(4,Hr.length),ce.write_shift(4,We.content.length),ce.write_shift(2,nr.length),ce.write_shift(2,0),Ne+=ce.length,te.push(ce),Ne+=nr.length,te.push(nr),Ne+=Hr.length,te.push(Hr),ce=rn(46),ce.write_shift(4,33639248),ce.write_shift(2,0),ce.write_shift(2,20),ce.write_shift(2,Le),ce.write_shift(2,ke),ce.write_shift(4,0),ce.write_shift(-4,tt[$e]),ce.write_shift(4,Hr.length),ce.write_shift(4,We.content.length),ce.write_shift(2,nr.length),ce.write_shift(2,0),ce.write_shift(2,0),ce.write_shift(2,0),ce.write_shift(2,0),ce.write_shift(4,0),ce.write_shift(4,Xt),bt+=ce.l,oe.push(ce),bt+=nr.length,oe.push(nr),++$e}return ce=rn(22),ce.write_shift(4,101010256),ce.write_shift(2,0),ce.write_shift(2,0),ce.write_shift(2,$e),ce.write_shift(2,$e),ce.write_shift(4,bt),ce.write_shift(4,Ne),ce.write_shift(2,0),Do([Do(te),Do(oe),ce])}var ir={htm:"text/html",xml:"text/xml",gif:"image/gif",jpg:"image/jpeg",png:"image/png",mso:"application/x-mso",thmx:"application/vnd.ms-officetheme",sh33tj5:"application/octet-stream"};function _t(z,le){if(z.ctype)return z.ctype;var ee=z.name||"",te=ee.match(/\.([^\.]+)$/);return te&&ir[te[1]]||le&&(te=(ee=le).match(/[\.\\]([^\.\\])+$/),te&&ir[te[1]])?ir[te[1]]:"application/octet-stream"}function Wt(z){for(var le=c3(z),ee=[],te=0;te<le.length;te+=76)ee.push(le.slice(te,te+76));return ee.join(`\r
`)+`\r
`}function xs(z){var le=z.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF=]/g,function(Te){var Ne=Te.charCodeAt(0).toString(16).toUpperCase();return"="+(Ne.length==1?"0"+Ne:Ne)});le=le.replace(/ $/mg,"=20").replace(/\t$/mg,"=09"),le.charAt(0)==`
`&&(le="=0D"+le.slice(1)),le=le.replace(/\r(?!\n)/mg,"=0D").replace(/\n\n/mg,`
=0A`).replace(/([^\r\n])\n/mg,"$1=0A");for(var ee=[],te=le.split(`\r
`),oe=0;oe<te.length;++oe){var ce=te[oe];if(ce.length==0){ee.push("");continue}for(var ke=0;ke<ce.length;){var Le=76,Se=ce.slice(ke,ke+Le);Se.charAt(Le-1)=="="?Le--:Se.charAt(Le-2)=="="?Le-=2:Se.charAt(Le-3)=="="&&(Le-=3),Se=ce.slice(ke,ke+Le),ke+=Le,ke<ce.length&&(Se+="="),ee.push(Se)}}return ee.join(`\r
`)}function en(z){for(var le=[],ee=0;ee<z.length;++ee){for(var te=z[ee];ee<=z.length&&te.charAt(te.length-1)=="=";)te=te.slice(0,te.length-1)+z[++ee];le.push(te)}for(var oe=0;oe<le.length;++oe)le[oe]=le[oe].replace(/[=][0-9A-Fa-f]{2}/g,function(ce){return String.fromCharCode(parseInt(ce.slice(1),16))});return Di(le.join(`\r
`))}function za(z,le,ee){for(var te="",oe="",ce="",ke,Le=0;Le<10;++Le){var Se=le[Le];if(!Se||Se.match(/^\s*$/))break;var Te=Se.match(/^(.*?):\s*([^\s].*)$/);if(Te)switch(Te[1].toLowerCase()){case"content-location":te=Te[2].trim();break;case"content-type":ce=Te[2].trim();break;case"content-transfer-encoding":oe=Te[2].trim();break}}switch(++Le,oe.toLowerCase()){case"base64":ke=Di(Ba(le.slice(Le).join("")));break;case"quoted-printable":ke=en(le.slice(Le));break;default:throw new Error("Unsupported Content-Transfer-Encoding "+oe)}var Ne=la(z,te.slice(ee.length),ke,{unsafe:!0});ce&&(Ne.ctype=ce)}function Ha(z,le){if(q(z.slice(0,13)).toLowerCase()!="mime-version:")throw new Error("Unsupported MAD header");var ee=le&&le.root||"",te=(jt&&Buffer.isBuffer(z)?z.toString("binary"):q(z)).split(`\r
`),oe=0,ce="";for(oe=0;oe<te.length;++oe)if(ce=te[oe],!!/^Content-Location:/i.test(ce)&&(ce=ce.slice(ce.indexOf("file")),ee||(ee=ce.slice(0,ce.lastIndexOf("/")+1)),ce.slice(0,ee.length)!=ee))for(;ee.length>0&&(ee=ee.slice(0,ee.length-1),ee=ee.slice(0,ee.lastIndexOf("/")+1),ce.slice(0,ee.length)!=ee););var ke=(te[1]||"").match(/boundary="(.*?)"/);if(!ke)throw new Error("MAD cannot find boundary");var Le="--"+(ke[1]||""),Se=[],Te=[],Ne={FileIndex:Se,FullPaths:Te};T(Ne);var $e,Ge=0;for(oe=0;oe<te.length;++oe){var rt=te[oe];rt!==Le&&rt!==Le+"--"||(Ge++&&za(Ne,te.slice($e,oe),ee),$e=oe)}return Ne}function dt(z,le){var ee=le||{},te=ee.boundary||"SheetJS";te="------="+te;for(var oe=["MIME-Version: 1.0",'Content-Type: multipart/related; boundary="'+te.slice(2)+'"',"","",""],ce=z.FullPaths[0],ke=ce,Le=z.FileIndex[0],Se=1;Se<z.FullPaths.length;++Se)if(ke=z.FullPaths[Se].slice(ce.length),Le=z.FileIndex[Se],!(!Le.size||!Le.content||ke=="Sh33tJ5")){ke=ke.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF]/g,function(bt){return"_x"+bt.charCodeAt(0).toString(16)+"_"}).replace(/[\u0080-\uFFFF]/g,function(bt){return"_u"+bt.charCodeAt(0).toString(16)+"_"});for(var Te=Le.content,Ne=jt&&Buffer.isBuffer(Te)?Te.toString("binary"):q(Te),$e=0,Ge=Math.min(1024,Ne.length),rt=0,We=0;We<=Ge;++We)(rt=Ne.charCodeAt(We))>=32&&rt<128&&++$e;var tt=$e>=Ge*4/5;oe.push(te),oe.push("Content-Location: "+(ee.root||"file:///C:/SheetJS/")+ke),oe.push("Content-Transfer-Encoding: "+(tt?"quoted-printable":"base64")),oe.push("Content-Type: "+_t(Le,ke)),oe.push(""),oe.push(tt?xs(Ne):Wt(Ne))}return oe.push(te+`--\r
`),oe.join(`\r
`)}function Ea(z){var le={};return T(le,z),le}function la(z,le,ee,te){var oe=te&&te.unsafe;oe||T(z);var ce=!oe&&Bt.find(z,le);if(!ce){var ke=z.FullPaths[0];le.slice(0,ke.length)==ke?ke=le:(ke.slice(-1)!="/"&&(ke+="/"),ke=(ke+le).replace("//","/")),ce={name:a(le),type:2},z.FileIndex.push(ce),z.FullPaths.push(ke),oe||Bt.utils.cfb_gc(z)}return ce.content=ee,ce.size=ee?ee.length:0,te&&(te.CLSID&&(ce.clsid=te.CLSID),te.mt&&(ce.mt=te.mt),te.ct&&(ce.ct=te.ct)),ce}function An(z,le){T(z);var ee=Bt.find(z,le);if(ee){for(var te=0;te<z.FileIndex.length;++te)if(z.FileIndex[te]==ee)return z.FileIndex.splice(te,1),z.FullPaths.splice(te,1),!0}return!1}function Dr(z,le,ee){T(z);var te=Bt.find(z,le);if(te){for(var oe=0;oe<z.FileIndex.length;++oe)if(z.FileIndex[oe]==te)return z.FileIndex[oe].name=a(ee),z.FullPaths[oe]=ee,!0}return!1}function Tr(z){R(z,!0)}return t.find=N,t.read=D,t.parse=u,t.write=he,t.writeFile=Q,t.utils={cfb_new:Ea,cfb_add:la,cfb_del:An,cfb_mov:Dr,cfb_gc:Tr,ReadShift:_0,CheckField:vT,prep_blob:bn,bconcat:Do,use_zlib:E,_deflateRaw:Ze,_inflateRaw:Vt,consts:U},t}();function AU(e){if(typeof Deno<"u")return Deno.readFileSync(e);if(typeof $<"u"&&typeof File<"u"&&typeof Folder<"u")try{var t=File(e);t.open("r"),t.encoding="binary";var r=t.read();return t.close(),r}catch(n){if(!n.message||!n.message.match(/onstruct/))throw n}throw new Error("Cannot access file "+e)}function hs(e){for(var t=Object.keys(e),r=[],n=0;n<t.length;++n)Object.prototype.hasOwnProperty.call(e,t[n])&&r.push(t[n]);return r}function h5(e){for(var t=[],r=hs(e),n=0;n!==r.length;++n)t[e[r[n]]]=r[n];return t}var E1=new Date(1899,11,30,0,0,0);function ia(e,t){var r=e.getTime(),n=E1.getTime()+(e.getTimezoneOffset()-E1.getTimezoneOffset())*6e4;return(r-n)/(24*60*60*1e3)}var YA=new Date,TU=E1.getTime()+(YA.getTimezoneOffset()-E1.getTimezoneOffset())*6e4,x3=YA.getTimezoneOffset();function Tm(e){var t=new Date;return t.setTime(e*24*60*60*1e3+TU),t.getTimezoneOffset()!==x3&&t.setTime(t.getTime()+(t.getTimezoneOffset()-x3)*6e4),t}function CU(e){var t=0,r=0,n=!1,a=e.match(/P([0-9\.]+Y)?([0-9\.]+M)?([0-9\.]+D)?T([0-9\.]+H)?([0-9\.]+M)?([0-9\.]+S)?/);if(!a)throw new Error("|"+e+"| is not an ISO8601 Duration");for(var i=1;i!=a.length;++i)if(a[i]){switch(r=1,i>3&&(n=!0),a[i].slice(a[i].length-1)){case"Y":throw new Error("Unsupported ISO Duration Field: "+a[i].slice(a[i].length-1));case"D":r*=24;case"H":r*=60;case"M":if(n)r*=60;else throw new Error("Unsupported ISO Duration Field: M")}t+=r*parseInt(a[i],10)}return t}var y3=new Date("2017-02-19T19:06:09.000Z"),JA=isNaN(y3.getFullYear())?new Date("2/19/17"):y3,NU=JA.getFullYear()==2017;function vn(e,t){var r=new Date(e);if(NU)return t>0?r.setTime(r.getTime()+r.getTimezoneOffset()*60*1e3):t<0&&r.setTime(r.getTime()-r.getTimezoneOffset()*60*1e3),r;if(e instanceof Date)return e;if(JA.getFullYear()==1917&&!isNaN(r.getFullYear())){var n=r.getFullYear();return e.indexOf(""+n)>-1||r.setFullYear(r.getFullYear()+100),r}var a=e.match(/\d+/g)||["2017","2","19","0","0","0"],i=new Date(+a[0],+a[1]-1,+a[2],+a[3]||0,+a[4]||0,+a[5]||0);return e.indexOf("Z")>-1&&(i=new Date(i.getTime()-i.getTimezoneOffset()*60*1e3)),i}function rc(e,t){if(jt&&Buffer.isBuffer(e)){if(t){if(e[0]==255&&e[1]==254)return t0(e.slice(2).toString("utf16le"));if(e[1]==254&&e[2]==255)return t0(jA(e.slice(2).toString("binary")))}return e.toString("binary")}if(typeof TextDecoder<"u")try{if(t){if(e[0]==255&&e[1]==254)return t0(new TextDecoder("utf-16le").decode(e.slice(2)));if(e[0]==254&&e[1]==255)return t0(new TextDecoder("utf-16be").decode(e.slice(2)))}var r={"":"","":"",:"","":"","":"","":"","":"","":"","":"",:"","":"",:"",:"","":"","":"","":"","":"","":"","":"","":"","":"","":"",:"","":"",:"",:"",:""};return Array.isArray(e)&&(e=new Uint8Array(e)),new TextDecoder("latin1").decode(e).replace(/[]/g,function(i){return r[i]||i})}catch{}for(var n=[],a=0;a!=e.length;++a)n.push(String.fromCharCode(e[a]));return n.join("")}function Sn(e){if(typeof JSON<"u"&&!Array.isArray(e))return JSON.parse(JSON.stringify(e));if(typeof e!="object"||e==null)return e;if(e instanceof Date)return new Date(e.getTime());var t={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=Sn(e[r]));return t}function Fr(e,t){for(var r="";r.length<t;)r+=e;return r}function Ui(e){var t=Number(e);if(!isNaN(t))return isFinite(t)?t:NaN;if(!/\d/.test(e))return t;var r=1,n=e.replace(/([\d]),([\d])/g,"$1$2").replace(/[$]/g,"").replace(/[%]/g,function(){return r*=100,""});return!isNaN(t=Number(n))||(n=n.replace(/[(](.*)[)]/,function(a,i){return r=-r,i}),!isNaN(t=Number(n)))?t/r:t}var PU=["january","february","march","april","may","june","july","august","september","october","november","december"];function zu(e){var t=new Date(e),r=new Date(NaN),n=t.getYear(),a=t.getMonth(),i=t.getDate();if(isNaN(i))return r;var s=e.toLowerCase();if(s.match(/jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec/)){if(s=s.replace(/[^a-z]/g,"").replace(/([^a-z]|^)[ap]m?([^a-z]|$)/,""),s.length>3&&PU.indexOf(s)==-1)return r}else if(s.match(/[a-z]/))return r;return n<0||n>8099?r:(a>0||i>1)&&n!=101?t:e.match(/[^-0-9:,\/\\]/)?r:t}var LU=function(){var e="abacaba".split(/(:?b)/i).length==5;return function(r,n,a){if(e||typeof n=="string")return r.split(n);for(var i=r.split(n),s=[i[0]],o=1;o<i.length;++o)s.push(a),s.push(i[o]);return s}}();function QA(e){return e?e.content&&e.type?rc(e.content,!0):e.data?Qf(e.data):e.asNodeBuffer&&jt?Qf(e.asNodeBuffer().toString("binary")):e.asBinary?Qf(e.asBinary()):e._data&&e._data.getContent?Qf(rc(Array.prototype.slice.call(e._data.getContent(),0))):null:null}function ZA(e){if(!e)return null;if(e.data)return o3(e.data);if(e.asNodeBuffer&&jt)return e.asNodeBuffer();if(e._data&&e._data.getContent){var t=e._data.getContent();return typeof t=="string"?o3(t):Array.prototype.slice.call(t)}return e.content&&e.type?e.content:null}function FU(e){return e&&e.name.slice(-4)===".bin"?ZA(e):QA(e)}function ri(e,t){for(var r=e.FullPaths||hs(e.files),n=t.toLowerCase().replace(/[\/]/g,"\\"),a=n.replace(/\\/g,"/"),i=0;i<r.length;++i){var s=r[i].replace(/^Root Entry[\/]/,"").toLowerCase();if(n==s||a==s)return e.files?e.files[r[i]]:e.FileIndex[i]}return null}function d5(e,t){var r=ri(e,t);if(r==null)throw new Error("Cannot find file "+t+" in zip");return r}function Yr(e,t,r){if(!r)return FU(d5(e,t));if(!t)return null;try{return Yr(e,t)}catch{return null}}function Oa(e,t,r){if(!r)return QA(d5(e,t));if(!t)return null;try{return Oa(e,t)}catch{return null}}function OU(e,t,r){return ZA(d5(e,t))}function w3(e){for(var t=e.FullPaths||hs(e.files),r=[],n=0;n<t.length;++n)t[n].slice(-1)!="/"&&r.push(t[n].replace(/^Root Entry[\/]/,""));return r.sort()}function DU(e,t,r){if(e.FullPaths){if(typeof r=="string"){var n;return jt?n=fc(r):n=ZB(r),Bt.utils.cfb_add(e,t,n)}Bt.utils.cfb_add(e,t,r)}else e.file(t,r)}function eT(e,t){switch(t.type){case"base64":return Bt.read(e,{type:"base64"});case"binary":return Bt.read(e,{type:"binary"});case"buffer":case"array":return Bt.read(e,{type:"buffer"})}throw new Error("Unrecognized type "+t.type)}function e0(e,t){if(e.charAt(0)=="/")return e.slice(1);var r=t.split("/");t.slice(-1)!="/"&&r.pop();for(var n=e.split("/");n.length!==0;){var a=n.shift();a===".."?r.pop():a!=="."&&r.push(a)}return r.join("/")}var tT=`<?xml version="1.0" encoding="UTF-8" standalone="yes"?>\r
`,IU=/([^"\s?>\/]+)\s*=\s*((?:")([^"]*)(?:")|(?:')([^']*)(?:')|([^'">\s]+))/g,b3=/<[\/\?]?[a-zA-Z0-9:_-]+(?:\s+[^"\s?>\/]+\s*=\s*(?:"[^"]*"|'[^']*'|[^'">\s=]+))*\s*[\/\?]?>/mg,RU=/<[^>]*>/g,Gn=tT.match(b3)?b3:RU,jU=/<\w*:/,MU=/<(\/?)\w+:/;function yt(e,t,r){for(var n={},a=0,i=0;a!==e.length&&!((i=e.charCodeAt(a))===32||i===10||i===13);++a);if(t||(n[0]=e.slice(0,a)),a===e.length)return n;var s=e.match(IU),o=0,l="",c=0,u="",f="",p=1;if(s)for(c=0;c!=s.length;++c){for(f=s[c],i=0;i!=f.length&&f.charCodeAt(i)!==61;++i);for(u=f.slice(0,i).trim();f.charCodeAt(i+1)==32;)++i;for(p=(a=f.charCodeAt(i+1))==34||a==39?1:0,l=f.slice(i+1+p,f.length-p),o=0;o!=u.length&&u.charCodeAt(o)!==58;++o);if(o===u.length)u.indexOf("_")>0&&(u=u.slice(0,u.indexOf("_"))),n[u]=l,n[u.toLowerCase()]=l;else{var h=(o===5&&u.slice(0,5)==="xmlns"?"xmlns":"")+u.slice(o+1);if(n[h]&&u.slice(o-3,o)=="ext")continue;n[h]=l,n[h.toLowerCase()]=l}}return n}function ms(e){return e.replace(MU,"<$1")}var rT={"&quot;":'"',"&apos;":"'","&gt;":">","&lt;":"<","&amp;":"&"},BU=h5(rT),Ht=function(){var e=/&(?:quot|apos|gt|lt|amp|#x?([\da-fA-F]+));/ig,t=/_x([\da-fA-F]{4})_/ig;return function r(n){var a=n+"",i=a.indexOf("<![CDATA[");if(i==-1)return a.replace(e,function(o,l){return rT[o]||String.fromCharCode(parseInt(l,o.indexOf("x")>-1?16:10))||o}).replace(t,function(o,l){return String.fromCharCode(parseInt(l,16))});var s=a.indexOf("]]>");return r(a.slice(0,i))+a.slice(i+9,s)+r(a.slice(s+3))}}(),UU=/[&<>'"]/g,VU=/[\u0000-\u001f]/g;function p5(e){var t=e+"";return t.replace(UU,function(r){return BU[r]}).replace(/\n/g,"<br/>").replace(VU,function(r){return"&#x"+("000"+r.charCodeAt(0).toString(16)).slice(-4)+";"})}var _3=function(){var e=/&#(\d+);/g;function t(r,n){return String.fromCharCode(parseInt(n,10))}return function(n){return n.replace(e,t)}}();function wr(e){switch(e){case 1:case!0:case"1":case"true":case"TRUE":return!0;default:return!1}}function h2(e){for(var t="",r=0,n=0,a=0,i=0,s=0,o=0;r<e.length;){if(n=e.charCodeAt(r++),n<128){t+=String.fromCharCode(n);continue}if(a=e.charCodeAt(r++),n>191&&n<224){s=(n&31)<<6,s|=a&63,t+=String.fromCharCode(s);continue}if(i=e.charCodeAt(r++),n<240){t+=String.fromCharCode((n&15)<<12|(a&63)<<6|i&63);continue}s=e.charCodeAt(r++),o=((n&7)<<18|(a&63)<<12|(i&63)<<6|s&63)-65536,t+=String.fromCharCode(55296+(o>>>10&1023)),t+=String.fromCharCode(56320+(o&1023))}return t}function S3(e){var t=rl(2*e.length),r,n,a=1,i=0,s=0,o;for(n=0;n<e.length;n+=a)a=1,(o=e.charCodeAt(n))<128?r=o:o<224?(r=(o&31)*64+(e.charCodeAt(n+1)&63),a=2):o<240?(r=(o&15)*4096+(e.charCodeAt(n+1)&63)*64+(e.charCodeAt(n+2)&63),a=3):(a=4,r=(o&7)*262144+(e.charCodeAt(n+1)&63)*4096+(e.charCodeAt(n+2)&63)*64+(e.charCodeAt(n+3)&63),r-=65536,s=55296+(r>>>10&1023),r=56320+(r&1023)),s!==0&&(t[i++]=s&255,t[i++]=s>>>8,s=0),t[i++]=r%256,t[i++]=r>>>8;return t.slice(0,i).toString("ucs2")}function k3(e){return fc(e,"binary").toString("utf8")}var rp="foo bar baz",pr=jt&&(k3(rp)==h2(rp)&&k3||S3(rp)==h2(rp)&&S3)||h2,t0=jt?function(e){return fc(e,"utf8").toString("binary")}:function(e){for(var t=[],r=0,n=0,a=0;r<e.length;)switch(n=e.charCodeAt(r++),!0){case n<128:t.push(String.fromCharCode(n));break;case n<2048:t.push(String.fromCharCode(192+(n>>6))),t.push(String.fromCharCode(128+(n&63)));break;case(n>=55296&&n<57344):n-=55296,a=e.charCodeAt(r++)-56320+(n<<10),t.push(String.fromCharCode(240+(a>>18&7))),t.push(String.fromCharCode(144+(a>>12&63))),t.push(String.fromCharCode(128+(a>>6&63))),t.push(String.fromCharCode(128+(a&63)));break;default:t.push(String.fromCharCode(224+(n>>12))),t.push(String.fromCharCode(128+(n>>6&63))),t.push(String.fromCharCode(128+(n&63)))}return t.join("")},ih=function(){var e={};return function(r,n){var a=r+"|"+(n||"");return e[a]?e[a]:e[a]=new RegExp("<(?:\\w+:)?"+r+'(?: xml:space="preserve")?(?:[^>]*)>([\\s\\S]*?)</(?:\\w+:)?'+r+">",n||"")}}(),nT=function(){var e=[["nbsp"," "],["middot",""],["quot",'"'],["apos","'"],["gt",">"],["lt","<"],["amp","&"]].map(function(t){return[new RegExp("&"+t[0]+";","ig"),t[1]]});return function(r){for(var n=r.replace(/^[\t\n\r ]+/,"").replace(/[\t\n\r ]+$/,"").replace(/>\s+/g,">").replace(/\s+</g,"<").replace(/[\t\n\r ]+/g," ").replace(/<\s*[bB][rR]\s*\/?>/g,`
`).replace(/<[^>]*>/g,""),a=0;a<e.length;++a)n=n.replace(e[a][0],e[a][1]);return n}}(),$U=function(){var e={};return function(r){return e[r]!==void 0?e[r]:e[r]=new RegExp("<(?:vt:)?"+r+">([\\s\\S]*?)</(?:vt:)?"+r+">","g")}}(),zU=/<\/?(?:vt:)?variant>/g,HU=/<(?:vt:)([^>]*)>([\s\S]*)</;function E3(e,t){var r=yt(e),n=e.match($U(r.baseType))||[],a=[];if(n.length!=r.size){if(t.WTF)throw new Error("unexpected vector length "+n.length+" != "+r.size);return a}return n.forEach(function(i){var s=i.replace(zU,"").match(HU);s&&a.push({v:pr(s[2]),t:s[1]})}),a}var WU=/(^\s|\s$|\n)/;function qU(e){return hs(e).map(function(t){return" "+t+'="'+e[t]+'"'}).join("")}function GU(e,t,r){return"<"+e+(r!=null?qU(r):"")+(t!=null?(t.match(WU)?' xml:space="preserve"':"")+">"+t+"</"+e:"/")+">"}function m5(e){if(jt&&Buffer.isBuffer(e))return e.toString("utf8");if(typeof e=="string")return e;if(typeof Uint8Array<"u"&&e instanceof Uint8Array)return pr(hc(c5(e)));throw new Error("Bad input format: expected Buffer or string")}var sh=/<(\/?)([^\s?><!\/:]*:|)([^\s?<>:\/]+)(?:[\s?:\/][^>]*)?>/mg,KU={CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/metadata/core-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/custom-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/extended-properties",CT:"http://schemas.openxmlformats.org/package/2006/content-types",RELS:"http://schemas.openxmlformats.org/package/2006/relationships",TCMNT:"http://schemas.microsoft.com/office/spreadsheetml/2018/threadedcomments",dc:"http://purl.org/dc/elements/1.1/",dcterms:"http://purl.org/dc/terms/",dcmitype:"http://purl.org/dc/dcmitype/",mx:"http://schemas.microsoft.com/office/mac/excel/2008/main",r:"http://schemas.openxmlformats.org/officeDocument/2006/relationships",sjs:"http://schemas.openxmlformats.org/package/2006/sheetjs/core-properties",vt:"http://schemas.openxmlformats.org/officeDocument/2006/docPropsVTypes",xsi:"http://www.w3.org/2001/XMLSchema-instance",xsd:"http://www.w3.org/2001/XMLSchema"},XU=["http://schemas.openxmlformats.org/spreadsheetml/2006/main","http://purl.oclc.org/ooxml/spreadsheetml/main","http://schemas.microsoft.com/office/excel/2006/main","http://schemas.microsoft.com/office/excel/2006/2"];function YU(e,t){for(var r=1-2*(e[t+7]>>>7),n=((e[t+7]&127)<<4)+(e[t+6]>>>4&15),a=e[t+6]&15,i=5;i>=0;--i)a=a*256+e[t+i];return n==2047?a==0?r*(1/0):NaN:(n==0?n=-1022:(n-=1023,a+=Math.pow(2,52)),r*Math.pow(2,n-52)*a)}function JU(e,t,r){var n=(t<0||1/t==-1/0?1:0)<<7,a=0,i=0,s=n?-t:t;isFinite(s)?s==0?a=i=0:(a=Math.floor(Math.log(s)/Math.LN2),i=s*Math.pow(2,52-a),a<=-1023&&(!isFinite(i)||i<Math.pow(2,52))?a=-1022:(i-=Math.pow(2,52),a+=1023)):(a=2047,i=isNaN(t)?26985:0);for(var o=0;o<=5;++o,i/=256)e[r+o]=i&255;e[r+6]=(a&15)<<4|i&15,e[r+7]=a>>4|n}var A3=function(e){for(var t=[],r=10240,n=0;n<e[0].length;++n)if(e[0][n])for(var a=0,i=e[0][n].length;a<i;a+=r)t.push.apply(t,e[0][n].slice(a,a+r));return t},T3=jt?function(e){return e[0].length>0&&Buffer.isBuffer(e[0][0])?Buffer.concat(e[0].map(function(t){return Buffer.isBuffer(t)?t:fc(t)})):A3(e)}:A3,C3=function(e,t,r){for(var n=[],a=t;a<r;a+=2)n.push(String.fromCharCode(Ms(e,a)));return n.join("").replace(aa,"")},g5=jt?function(e,t,r){return Buffer.isBuffer(e)?e.toString("utf16le",t,r).replace(aa,""):C3(e,t,r)}:C3,N3=function(e,t,r){for(var n=[],a=t;a<t+r;++a)n.push(("0"+e[a].toString(16)).slice(-2));return n.join("")},aT=jt?function(e,t,r){return Buffer.isBuffer(e)?e.toString("hex",t,t+r):N3(e,t,r)}:N3,P3=function(e,t,r){for(var n=[],a=t;a<r;a++)n.push(String.fromCharCode(Xc(e,a)));return n.join("")},Fh=jt?function(t,r,n){return Buffer.isBuffer(t)?t.toString("utf8",r,n):P3(t,r,n)}:P3,iT=function(e,t){var r=Fa(e,t);return r>0?Fh(e,t+4,t+4+r-1):""},sT=iT,oT=function(e,t){var r=Fa(e,t);return r>0?Fh(e,t+4,t+4+r-1):""},lT=oT,cT=function(e,t){var r=2*Fa(e,t);return r>0?Fh(e,t+4,t+4+r-1):""},uT=cT,fT=function(t,r){var n=Fa(t,r);return n>0?g5(t,r+4,r+4+n):""},hT=fT,dT=function(e,t){var r=Fa(e,t);return r>0?Fh(e,t+4,t+4+r):""},pT=dT,mT=function(e,t){return YU(e,t)},A1=mT,gT=function(t){return Array.isArray(t)||typeof Uint8Array<"u"&&t instanceof Uint8Array};jt&&(sT=function(t,r){if(!Buffer.isBuffer(t))return iT(t,r);var n=t.readUInt32LE(r);return n>0?t.toString("utf8",r+4,r+4+n-1):""},lT=function(t,r){if(!Buffer.isBuffer(t))return oT(t,r);var n=t.readUInt32LE(r);return n>0?t.toString("utf8",r+4,r+4+n-1):""},uT=function(t,r){if(!Buffer.isBuffer(t))return cT(t,r);var n=2*t.readUInt32LE(r);return t.toString("utf16le",r+4,r+4+n-1)},hT=function(t,r){if(!Buffer.isBuffer(t))return fT(t,r);var n=t.readUInt32LE(r);return t.toString("utf16le",r+4,r+4+n)},pT=function(t,r){if(!Buffer.isBuffer(t))return dT(t,r);var n=t.readUInt32LE(r);return t.toString("utf8",r+4,r+4+n)},A1=function(t,r){return Buffer.isBuffer(t)?t.readDoubleLE(r):mT(t,r)},gT=function(t){return Buffer.isBuffer(t)||Array.isArray(t)||typeof Uint8Array<"u"&&t instanceof Uint8Array});var Xc=function(e,t){return e[t]},Ms=function(e,t){return e[t+1]*256+e[t]},QU=function(e,t){var r=e[t+1]*256+e[t];return r<32768?r:(65535-r+1)*-1},Fa=function(e,t){return e[t+3]*(1<<24)+(e[t+2]<<16)+(e[t+1]<<8)+e[t]},Dl=function(e,t){return e[t+3]<<24|e[t+2]<<16|e[t+1]<<8|e[t]},ZU=function(e,t){return e[t]<<24|e[t+1]<<16|e[t+2]<<8|e[t+3]};function _0(e,t){var r="",n,a,i=[],s,o,l,c;switch(t){case"dbcs":if(c=this.l,jt&&Buffer.isBuffer(this))r=this.slice(this.l,this.l+2*e).toString("utf16le");else for(l=0;l<e;++l)r+=String.fromCharCode(Ms(this,c)),c+=2;e*=2;break;case"utf8":r=Fh(this,this.l,this.l+e);break;case"utf16le":e*=2,r=g5(this,this.l,this.l+e);break;case"wstr":return _0.call(this,e,"dbcs");case"lpstr-ansi":r=sT(this,this.l),e=4+Fa(this,this.l);break;case"lpstr-cp":r=lT(this,this.l),e=4+Fa(this,this.l);break;case"lpwstr":r=uT(this,this.l),e=4+2*Fa(this,this.l);break;case"lpp4":e=4+Fa(this,this.l),r=hT(this,this.l),e&2&&(e+=2);break;case"8lpp4":e=4+Fa(this,this.l),r=pT(this,this.l),e&3&&(e+=4-(e&3));break;case"cstr":for(e=0,r="";(s=Xc(this,this.l+e++))!==0;)i.push(tp(s));r=i.join("");break;case"_wstr":for(e=0,r="";(s=Ms(this,this.l+e))!==0;)i.push(tp(s)),e+=2;e+=2,r=i.join("");break;case"dbcs-cont":for(r="",c=this.l,l=0;l<e;++l){if(this.lens&&this.lens.indexOf(c)!==-1)return s=Xc(this,c),this.l=c+1,o=_0.call(this,e-l,s?"dbcs-cont":"sbcs-cont"),i.join("")+o;i.push(tp(Ms(this,c))),c+=2}r=i.join(""),e*=2;break;case"cpstr":case"sbcs-cont":for(r="",c=this.l,l=0;l!=e;++l){if(this.lens&&this.lens.indexOf(c)!==-1)return s=Xc(this,c),this.l=c+1,o=_0.call(this,e-l,s?"dbcs-cont":"sbcs-cont"),i.join("")+o;i.push(tp(Xc(this,c))),c+=1}r=i.join("");break;default:switch(e){case 1:return n=Xc(this,this.l),this.l++,n;case 2:return n=(t==="i"?QU:Ms)(this,this.l),this.l+=2,n;case 4:case-4:return t==="i"||!(this[this.l+3]&128)?(n=(e>0?Dl:ZU)(this,this.l),this.l+=4,n):(a=Fa(this,this.l),this.l+=4,a);case 8:case-8:if(t==="f")return e==8?a=A1(this,this.l):a=A1([this[this.l+7],this[this.l+6],this[this.l+5],this[this.l+4],this[this.l+3],this[this.l+2],this[this.l+1],this[this.l+0]],0),this.l+=8,a;e=8;case 16:r=aT(this,this.l,e);break}}return this.l+=e,r}var eV=function(e,t,r){e[r]=t&255,e[r+1]=t>>>8&255,e[r+2]=t>>>16&255,e[r+3]=t>>>24&255},tV=function(e,t,r){e[r]=t&255,e[r+1]=t>>8&255,e[r+2]=t>>16&255,e[r+3]=t>>24&255},rV=function(e,t,r){e[r]=t&255,e[r+1]=t>>>8&255};function nV(e,t,r){var n=0,a=0;if(r==="dbcs"){for(a=0;a!=t.length;++a)rV(this,t.charCodeAt(a),this.l+2*a);n=2*t.length}else if(r==="sbcs"){for(t=t.replace(/[^\x00-\x7F]/g,"_"),a=0;a!=t.length;++a)this[this.l+a]=t.charCodeAt(a)&255;n=t.length}else if(r==="hex"){for(;a<e;++a)this[this.l++]=parseInt(t.slice(2*a,2*a+2),16)||0;return this}else if(r==="utf16le"){var i=Math.min(this.l+e,this.length);for(a=0;a<Math.min(t.length,e);++a){var s=t.charCodeAt(a);this[this.l++]=s&255,this[this.l++]=s>>8}for(;this.l<i;)this[this.l++]=0;return this}else switch(e){case 1:n=1,this[this.l]=t&255;break;case 2:n=2,this[this.l]=t&255,t>>>=8,this[this.l+1]=t&255;break;case 3:n=3,this[this.l]=t&255,t>>>=8,this[this.l+1]=t&255,t>>>=8,this[this.l+2]=t&255;break;case 4:n=4,eV(this,t,this.l);break;case 8:if(n=8,r==="f"){JU(this,t,this.l);break}case 16:break;case-4:n=4,tV(this,t,this.l);break}return this.l+=n,this}function vT(e,t){var r=aT(this,this.l,e.length>>1);if(r!==e)throw new Error(t+"Expected "+e+" saw "+r);this.l+=e.length>>1}function bn(e,t){e.l=t,e.read_shift=_0,e.chk=vT,e.write_shift=nV}function qn(e,t){e.l+=t}function rn(e){var t=rl(e);return bn(t,0),t}function no(e,t,r){if(e){var n,a,i;bn(e,e.l||0);for(var s=e.length,o=0,l=0;e.l<s;){o=e.read_shift(1),o&128&&(o=(o&127)+((e.read_shift(1)&127)<<7));var c=F1[o]||F1[65535];for(n=e.read_shift(1),i=n&127,a=1;a<4&&n&128;++a)i+=((n=e.read_shift(1))&127)<<7*a;l=e.l+i;var u=c.f&&c.f(e,i,r);if(e.l=l,t(u,c,o))return}}}function ax(){var e=[],t=jt?256:2048,r=function(c){var u=rn(c);return bn(u,0),u},n=r(t),a=function(){n&&(n.length>n.l&&(n=n.slice(0,n.l),n.l=n.length),n.length>0&&e.push(n),n=null)},i=function(c){return n&&c<n.length-n.l?n:(a(),n=r(Math.max(c+1,t)))},s=function(){return a(),Do(e)},o=function(c){a(),n=c,n.l==null&&(n.l=n.length),i(t)};return{next:i,push:o,end:s,_bufs:e}}function S0(e,t,r){var n=Sn(e);if(t.s?(n.cRel&&(n.c+=t.s.c),n.rRel&&(n.r+=t.s.r)):(n.cRel&&(n.c+=t.c),n.rRel&&(n.r+=t.r)),!r||r.biff<12){for(;n.c>=256;)n.c-=256;for(;n.r>=65536;)n.r-=65536}return n}function L3(e,t,r){var n=Sn(e);return n.s=S0(n.s,t.s,r),n.e=S0(n.e,t.s,r),n}function k0(e,t){if(e.cRel&&e.c<0)for(e=Sn(e);e.c<0;)e.c+=t>8?16384:256;if(e.rRel&&e.r<0)for(e=Sn(e);e.r<0;)e.r+=t>8?1048576:t>5?65536:16384;var r=Ct(e);return!e.cRel&&e.cRel!=null&&(r=sV(r)),!e.rRel&&e.rRel!=null&&(r=aV(r)),r}function d2(e,t){return e.s.r==0&&!e.s.rRel&&e.e.r==(t.biff>=12?1048575:t.biff>=8?65536:16384)&&!e.e.rRel?(e.s.cRel?"":"$")+sn(e.s.c)+":"+(e.e.cRel?"":"$")+sn(e.e.c):e.s.c==0&&!e.s.cRel&&e.e.c==(t.biff>=12?16383:255)&&!e.e.cRel?(e.s.rRel?"":"$")+kn(e.s.r)+":"+(e.e.rRel?"":"$")+kn(e.e.r):k0(e.s,t.biff)+":"+k0(e.e,t.biff)}function v5(e){return parseInt(iV(e),10)-1}function kn(e){return""+(e+1)}function aV(e){return e.replace(/([A-Z]|^)(\d+)$/,"$1$$$2")}function iV(e){return e.replace(/\$(\d+)$/,"$1")}function x5(e){for(var t=oV(e),r=0,n=0;n!==t.length;++n)r=26*r+t.charCodeAt(n)-64;return r-1}function sn(e){if(e<0)throw new Error("invalid column "+e);var t="";for(++e;e;e=Math.floor((e-1)/26))t=String.fromCharCode((e-1)%26+65)+t;return t}function sV(e){return e.replace(/^([A-Z])/,"$$$1")}function oV(e){return e.replace(/^\$([A-Z])/,"$1")}function lV(e){return e.replace(/(\$?[A-Z]*)(\$?\d*)/,"$1,$2").split(",")}function ra(e){for(var t=0,r=0,n=0;n<e.length;++n){var a=e.charCodeAt(n);a>=48&&a<=57?t=10*t+(a-48):a>=65&&a<=90&&(r=26*r+(a-64))}return{c:r-1,r:t-1}}function Ct(e){for(var t=e.c+1,r="";t;t=(t-1)/26|0)r=String.fromCharCode((t-1)%26+65)+r;return r+(e.r+1)}function ef(e){var t=e.indexOf(":");return t==-1?{s:ra(e),e:ra(e)}:{s:ra(e.slice(0,t)),e:ra(e.slice(t+1))}}function Ut(e,t){return typeof t>"u"||typeof t=="number"?Ut(e.s,e.e):(typeof e!="string"&&(e=Ct(e)),typeof t!="string"&&(t=Ct(t)),e==t?e:e+":"+t)}function Or(e){var t={s:{c:0,r:0},e:{c:0,r:0}},r=0,n=0,a=0,i=e.length;for(r=0;n<i&&!((a=e.charCodeAt(n)-64)<1||a>26);++n)r=26*r+a;for(t.s.c=--r,r=0;n<i&&!((a=e.charCodeAt(n)-48)<0||a>9);++n)r=10*r+a;if(t.s.r=--r,n===i||a!=10)return t.e.c=t.s.c,t.e.r=t.s.r,t;for(++n,r=0;n!=i&&!((a=e.charCodeAt(n)-64)<1||a>26);++n)r=26*r+a;for(t.e.c=--r,r=0;n!=i&&!((a=e.charCodeAt(n)-48)<0||a>9);++n)r=10*r+a;return t.e.r=--r,t}function F3(e,t){var r=e.t=="d"&&t instanceof Date;if(e.z!=null)try{return e.w=fi(e.z,r?ia(t):t)}catch{}try{return e.w=fi((e.XF||{}).numFmtId||(r?14:0),r?ia(t):t)}catch{return""+t}}function Zs(e,t,r){return e==null||e.t==null||e.t=="z"?"":e.w!==void 0?e.w:(e.t=="d"&&!e.z&&r&&r.dateNF&&(e.z=r.dateNF),e.t=="e"?mc[e.v]||e.v:t==null?F3(e,e.v):F3(e,t))}function hl(e,t){var r=t&&t.sheet?t.sheet:"Sheet1",n={};return n[r]=e,{SheetNames:[r],Sheets:n}}function xT(e,t,r){var n=r||{},a=e?Array.isArray(e):n.dense,i=e||(a?[]:{}),s=0,o=0;if(i&&n.origin!=null){if(typeof n.origin=="number")s=n.origin;else{var l=typeof n.origin=="string"?ra(n.origin):n.origin;s=l.r,o=l.c}i["!ref"]||(i["!ref"]="A1:A1")}var c={s:{c:1e7,r:1e7},e:{c:0,r:0}};if(i["!ref"]){var u=Or(i["!ref"]);c.s.c=u.s.c,c.s.r=u.s.r,c.e.c=Math.max(c.e.c,u.e.c),c.e.r=Math.max(c.e.r,u.e.r),s==-1&&(c.e.r=s=u.e.r+1)}for(var f=0;f!=t.length;++f)if(t[f]){if(!Array.isArray(t[f]))throw new Error("aoa_to_sheet expects an array of arrays");for(var p=0;p!=t[f].length;++p)if(!(typeof t[f][p]>"u")){var h={v:t[f][p]},g=s+f,m=o+p;if(c.s.r>g&&(c.s.r=g),c.s.c>m&&(c.s.c=m),c.e.r<g&&(c.e.r=g),c.e.c<m&&(c.e.c=m),t[f][p]&&typeof t[f][p]=="object"&&!Array.isArray(t[f][p])&&!(t[f][p]instanceof Date))h=t[f][p];else if(Array.isArray(h.v)&&(h.f=t[f][p][1],h.v=h.v[0]),h.v===null)if(h.f)h.t="n";else if(n.nullError)h.t="e",h.v=0;else if(n.sheetStubs)h.t="z";else continue;else typeof h.v=="number"?h.t="n":typeof h.v=="boolean"?h.t="b":h.v instanceof Date?(h.z=n.dateNF||Ft[14],n.cellDates?(h.t="d",h.w=fi(h.z,ia(h.v))):(h.t="n",h.v=ia(h.v),h.w=fi(h.z,h.v))):h.t="s";if(a)i[g]||(i[g]=[]),i[g][m]&&i[g][m].z&&(h.z=i[g][m].z),i[g][m]=h;else{var b=Ct({c:m,r:g});i[b]&&i[b].z&&(h.z=i[b].z),i[b]=h}}}return c.s.c<1e7&&(i["!ref"]=Ut(c)),i}function tf(e,t){return xT(null,e,t)}function cV(e){return e.read_shift(4,"i")}function Hn(e){var t=e.read_shift(4);return t===0?"":e.read_shift(t,"dbcs")}function uV(e){return{ich:e.read_shift(2),ifnt:e.read_shift(2)}}function y5(e,t){var r=e.l,n=e.read_shift(1),a=Hn(e),i=[],s={t:a,h:a};if(n&1){for(var o=e.read_shift(4),l=0;l!=o;++l)i.push(uV(e));s.r=i}else s.r=[{ich:0,ifnt:0}];return e.l=r+t,s}var fV=y5;function hi(e){var t=e.read_shift(4),r=e.read_shift(2);return r+=e.read_shift(1)<<16,e.l++,{c:t,iStyleRef:r}}function dc(e){var t=e.read_shift(2);return t+=e.read_shift(1)<<16,e.l++,{c:-1,iStyleRef:t}}var hV=Hn;function w5(e){var t=e.read_shift(4);return t===0||t===4294967295?"":e.read_shift(t,"dbcs")}var dV=Hn,ix=w5;function b5(e){var t=e.slice(e.l,e.l+4),r=t[0]&1,n=t[0]&2;e.l+=4;var a=n===0?A1([0,0,0,0,t[0]&252,t[1],t[2],t[3]],0):Dl(t,0)>>2;return r?a/100:a}function yT(e){var t={s:{},e:{}};return t.s.r=e.read_shift(4),t.e.r=e.read_shift(4),t.s.c=e.read_shift(4),t.e.c=e.read_shift(4),t}var pc=yT;function Vn(e){if(e.length-e.l<8)throw"XLS Xnum Buffer underflow";return e.read_shift(8,"f")}function pV(e){var t={},r=e.read_shift(1),n=r>>>1,a=e.read_shift(1),i=e.read_shift(2,"i"),s=e.read_shift(1),o=e.read_shift(1),l=e.read_shift(1);switch(e.l++,n){case 0:t.auto=1;break;case 1:t.index=a;var c=Gl[a];c&&(t.rgb=lh(c));break;case 2:t.rgb=lh([s,o,l]);break;case 3:t.theme=a;break}return i!=0&&(t.tint=i>0?i/32767:i/32768),t}function mV(e){var t=e.read_shift(1);e.l++;var r={fBold:t&1,fItalic:t&2,fUnderline:t&4,fStrikeout:t&8,fOutline:t&16,fShadow:t&32,fCondense:t&64,fExtend:t&128};return r}function wT(e,t){var r={2:"BITMAP",3:"METAFILEPICT",8:"DIB",14:"ENHMETAFILE"},n=e.read_shift(4);switch(n){case 0:return"";case 4294967295:case 4294967294:return r[e.read_shift(4)]||""}if(n>400)throw new Error("Unsupported Clipboard: "+n.toString(16));return e.l-=4,e.read_shift(0,t==1?"lpstr":"lpwstr")}function gV(e){return wT(e,1)}function vV(e){return wT(e,2)}var _5=2,ma=3,np=11,O3=12,T1=19,ap=64,xV=65,yV=71,wV=4108,bV=4126,dn=80,bT=81,_V=[dn,bT],SV={1:{n:"CodePage",t:_5},2:{n:"Category",t:dn},3:{n:"PresentationFormat",t:dn},4:{n:"ByteCount",t:ma},5:{n:"LineCount",t:ma},6:{n:"ParagraphCount",t:ma},7:{n:"SlideCount",t:ma},8:{n:"NoteCount",t:ma},9:{n:"HiddenCount",t:ma},10:{n:"MultimediaClipCount",t:ma},11:{n:"ScaleCrop",t:np},12:{n:"HeadingPairs",t:wV},13:{n:"TitlesOfParts",t:bV},14:{n:"Manager",t:dn},15:{n:"Company",t:dn},16:{n:"LinksUpToDate",t:np},17:{n:"CharacterCount",t:ma},19:{n:"SharedDoc",t:np},22:{n:"HyperlinksChanged",t:np},23:{n:"AppVersion",t:ma,p:"version"},24:{n:"DigSig",t:xV},26:{n:"ContentType",t:dn},27:{n:"ContentStatus",t:dn},28:{n:"Language",t:dn},29:{n:"Version",t:dn},255:{},2147483648:{n:"Locale",t:T1},2147483651:{n:"Behavior",t:T1},1919054434:{}},kV={1:{n:"CodePage",t:_5},2:{n:"Title",t:dn},3:{n:"Subject",t:dn},4:{n:"Author",t:dn},5:{n:"Keywords",t:dn},6:{n:"Comments",t:dn},7:{n:"Template",t:dn},8:{n:"LastAuthor",t:dn},9:{n:"RevNumber",t:dn},10:{n:"EditTime",t:ap},11:{n:"LastPrinted",t:ap},12:{n:"CreatedDate",t:ap},13:{n:"ModifiedDate",t:ap},14:{n:"PageCount",t:ma},15:{n:"WordCount",t:ma},16:{n:"CharCount",t:ma},17:{n:"Thumbnail",t:yV},18:{n:"Application",t:dn},19:{n:"DocSecurity",t:ma},255:{},2147483648:{n:"Locale",t:T1},2147483651:{n:"Behavior",t:T1},1919054434:{}},D3={1:"US",2:"CA",3:"",7:"RU",20:"EG",30:"GR",31:"NL",32:"BE",33:"FR",34:"ES",36:"HU",39:"IT",41:"CH",43:"AT",44:"GB",45:"DK",46:"SE",47:"NO",48:"PL",49:"DE",52:"MX",55:"BR",61:"AU",64:"NZ",66:"TH",81:"JP",82:"KR",84:"VN",86:"CN",90:"TR",105:"JS",213:"DZ",216:"MA",218:"LY",351:"PT",354:"IS",358:"FI",420:"CZ",886:"TW",961:"LB",962:"JO",963:"SY",964:"IQ",965:"KW",966:"SA",971:"AE",972:"IL",974:"QA",981:"IR",65535:"US"},EV=[null,"solid","mediumGray","darkGray","lightGray","darkHorizontal","darkVertical","darkDown","darkUp","darkGrid","darkTrellis","lightHorizontal","lightVertical","lightDown","lightUp","lightGrid","lightTrellis","gray125","gray0625"];function AV(e){return e.map(function(t){return[t>>16&255,t>>8&255,t&255]})}var TV=AV([0,16777215,16711680,65280,255,16776960,16711935,65535,0,16777215,16711680,65280,255,16776960,16711935,65535,8388608,32768,128,8421376,8388736,32896,12632256,8421504,10066431,10040166,16777164,13434879,6684774,16744576,26316,13421823,128,16711935,16776960,65535,8388736,8388608,32896,255,52479,13434879,13434828,16777113,10079487,16751052,13408767,16764057,3368703,3394764,10079232,16763904,16750848,16737792,6710937,9868950,13158,3381606,13056,3355392,10040064,10040166,3355545,3355443,16777215,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]),Gl=Sn(TV),mc={0:"#NULL!",7:"#DIV/0!",15:"#VALUE!",23:"#REF!",29:"#NAME?",36:"#NUM!",42:"#N/A",43:"#GETTING_DATA",255:"#WTF?"},_T={"#NULL!":0,"#DIV/0!":7,"#VALUE!":15,"#REF!":23,"#NAME?":29,"#NUM!":36,"#N/A":42,"#GETTING_DATA":43,"#WTF?":255},I3={"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml":"workbooks","application/vnd.ms-excel.sheet.macroEnabled.main+xml":"workbooks","application/vnd.ms-excel.sheet.binary.macroEnabled.main":"workbooks","application/vnd.ms-excel.addin.macroEnabled.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml":"sheets","application/vnd.ms-excel.worksheet":"sheets","application/vnd.ms-excel.binIndexWs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml":"charts","application/vnd.ms-excel.chartsheet":"charts","application/vnd.ms-excel.macrosheet+xml":"macros","application/vnd.ms-excel.macrosheet":"macros","application/vnd.ms-excel.intlmacrosheet":"TODO","application/vnd.ms-excel.binIndexMs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml":"dialogs","application/vnd.ms-excel.dialogsheet":"dialogs","application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml":"strs","application/vnd.ms-excel.sharedStrings":"strs","application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml":"styles","application/vnd.ms-excel.styles":"styles","application/vnd.openxmlformats-package.core-properties+xml":"coreprops","application/vnd.openxmlformats-officedocument.custom-properties+xml":"custprops","application/vnd.openxmlformats-officedocument.extended-properties+xml":"extprops","application/vnd.openxmlformats-officedocument.customXmlProperties+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.customProperty":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml":"comments","application/vnd.ms-excel.comments":"comments","application/vnd.ms-excel.threadedcomments+xml":"threadedcomments","application/vnd.ms-excel.person+xml":"people","application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml":"metadata","application/vnd.ms-excel.sheetMetadata":"metadata","application/vnd.ms-excel.pivotTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotTable+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.chart+xml":"TODO","application/vnd.ms-office.chartcolorstyle+xml":"TODO","application/vnd.ms-office.chartstyle+xml":"TODO","application/vnd.ms-office.chartex+xml":"TODO","application/vnd.ms-excel.calcChain":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.calcChain+xml":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.printerSettings":"TODO","application/vnd.ms-office.activeX":"TODO","application/vnd.ms-office.activeX+xml":"TODO","application/vnd.ms-excel.attachedToolbars":"TODO","application/vnd.ms-excel.connections":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.connections+xml":"TODO","application/vnd.ms-excel.externalLink":"links","application/vnd.openxmlformats-officedocument.spreadsheetml.externalLink+xml":"links","application/vnd.ms-excel.pivotCacheDefinition":"TODO","application/vnd.ms-excel.pivotCacheRecords":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheDefinition+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheRecords+xml":"TODO","application/vnd.ms-excel.queryTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.queryTable+xml":"TODO","application/vnd.ms-excel.userNames":"TODO","application/vnd.ms-excel.revisionHeaders":"TODO","application/vnd.ms-excel.revisionLog":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionHeaders+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionLog+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.userNames+xml":"TODO","application/vnd.ms-excel.tableSingleCells":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.tableSingleCells+xml":"TODO","application/vnd.ms-excel.slicer":"TODO","application/vnd.ms-excel.slicerCache":"TODO","application/vnd.ms-excel.slicer+xml":"TODO","application/vnd.ms-excel.slicerCache+xml":"TODO","application/vnd.ms-excel.wsSortMap":"TODO","application/vnd.ms-excel.table":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.table+xml":"TODO","application/vnd.openxmlformats-officedocument.theme+xml":"themes","application/vnd.openxmlformats-officedocument.themeOverride+xml":"TODO","application/vnd.ms-excel.Timeline+xml":"TODO","application/vnd.ms-excel.TimelineCache+xml":"TODO","application/vnd.ms-office.vbaProject":"vba","application/vnd.ms-office.vbaProjectSignature":"TODO","application/vnd.ms-office.volatileDependencies":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.volatileDependencies+xml":"TODO","application/vnd.ms-excel.controlproperties+xml":"TODO","application/vnd.openxmlformats-officedocument.model+data":"TODO","application/vnd.ms-excel.Survey+xml":"TODO","application/vnd.openxmlformats-officedocument.drawing+xml":"drawings","application/vnd.openxmlformats-officedocument.drawingml.chartshapes+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramColors+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramData+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramLayout+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramStyle+xml":"TODO","application/vnd.openxmlformats-officedocument.vmlDrawing":"TODO","application/vnd.openxmlformats-package.relationships+xml":"rels","application/vnd.openxmlformats-officedocument.oleObject":"TODO","image/png":"TODO",sheet:"js"};function CV(){return{workbooks:[],sheets:[],charts:[],dialogs:[],macros:[],rels:[],strs:[],comments:[],threadedcomments:[],links:[],coreprops:[],extprops:[],custprops:[],themes:[],styles:[],calcchains:[],vba:[],drawings:[],metadata:[],people:[],TODO:[],xmlns:""}}function NV(e){var t=CV();if(!e||!e.match)return t;var r={};if((e.match(Gn)||[]).forEach(function(n){var a=yt(n);switch(a[0].replace(jU,"<")){case"<?xml":break;case"<Types":t.xmlns=a["xmlns"+(a[0].match(/<(\w+):/)||["",""])[1]];break;case"<Default":r[a.Extension]=a.ContentType;break;case"<Override":t[I3[a.ContentType]]!==void 0&&t[I3[a.ContentType]].push(a.PartName);break}}),t.xmlns!==KU.CT)throw new Error("Unknown Namespace: "+t.xmlns);return t.calcchain=t.calcchains.length>0?t.calcchains[0]:"",t.sst=t.strs.length>0?t.strs[0]:"",t.style=t.styles.length>0?t.styles[0]:"",t.defaults=r,delete t.calcchains,t}var mu={WB:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/officeDocument",SHEET:"http://sheetjs.openxmlformats.org/officeDocument/2006/relationships/officeDocument",HLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/hyperlink",VML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/vmlDrawing",XPATH:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLinkPath",XMISS:"http://schemas.microsoft.com/office/2006/relationships/xlExternalLinkPath/xlPathMissing",XLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLink",CXML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXml",CXMLP:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXmlProps",CMNT:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/comments",CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/relationships/metadata/core-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/extended-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/custom-properties",SST:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sharedStrings",STY:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/styles",THEME:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/theme",CHART:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chart",CHARTEX:"http://schemas.microsoft.com/office/2014/relationships/chartEx",CS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chartsheet",WS:["http://schemas.openxmlformats.org/officeDocument/2006/relationships/worksheet","http://purl.oclc.org/ooxml/officeDocument/relationships/worksheet"],DS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/dialogsheet",MS:"http://schemas.microsoft.com/office/2006/relationships/xlMacrosheet",IMG:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/image",DRAW:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/drawing",XLMETA:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sheetMetadata",TCMNT:"http://schemas.microsoft.com/office/2017/10/relationships/threadedComment",PEOPLE:"http://schemas.microsoft.com/office/2017/10/relationships/person",VBA:"http://schemas.microsoft.com/office/2006/relationships/vbaProject"};function sx(e){var t=e.lastIndexOf("/");return e.slice(0,t+1)+"_rels/"+e.slice(t+1)+".rels"}function E0(e,t){var r={"!id":{}};if(!e)return r;t.charAt(0)!=="/"&&(t="/"+t);var n={};return(e.match(Gn)||[]).forEach(function(a){var i=yt(a);if(i[0]==="<Relationship"){var s={};s.Type=i.Type,s.Target=i.Target,s.Id=i.Id,i.TargetMode&&(s.TargetMode=i.TargetMode);var o=i.TargetMode==="External"?i.Target:e0(i.Target,t);r[o]=s,n[i.Id]=s}}),r["!id"]=n,r}var PV="application/vnd.oasis.opendocument.spreadsheet";function LV(e,t){for(var r=m5(e),n,a;n=sh.exec(r);)switch(n[3]){case"manifest":break;case"file-entry":if(a=yt(n[0],!1),a.path=="/"&&a.type!==PV)throw new Error("This OpenDocument is not a spreadsheet");break;case"encryption-data":case"algorithm":case"start-key-generation":case"key-derivation":throw new Error("Unsupported ODS Encryption");default:if(t&&t.WTF)throw n}}var A0=[["cp:category","Category"],["cp:contentStatus","ContentStatus"],["cp:keywords","Keywords"],["cp:lastModifiedBy","LastAuthor"],["cp:lastPrinted","LastPrinted"],["cp:revision","RevNumber"],["cp:version","Version"],["dc:creator","Author"],["dc:description","Comments"],["dc:identifier","Identifier"],["dc:language","Language"],["dc:subject","Subject"],["dc:title","Title"],["dcterms:created","CreatedDate","date"],["dcterms:modified","ModifiedDate","date"]],FV=function(){for(var e=new Array(A0.length),t=0;t<A0.length;++t){var r=A0[t],n="(?:"+r[0].slice(0,r[0].indexOf(":"))+":)"+r[0].slice(r[0].indexOf(":")+1);e[t]=new RegExp("<"+n+"[^>]*>([\\s\\S]*?)</"+n+">")}return e}();function ST(e){var t={};e=pr(e);for(var r=0;r<A0.length;++r){var n=A0[r],a=e.match(FV[r]);a!=null&&a.length>0&&(t[n[1]]=Ht(a[1])),n[2]==="date"&&t[n[1]]&&(t[n[1]]=vn(t[n[1]]))}return t}var OV=[["Application","Application","string"],["AppVersion","AppVersion","string"],["Company","Company","string"],["DocSecurity","DocSecurity","string"],["Manager","Manager","string"],["HyperlinksChanged","HyperlinksChanged","bool"],["SharedDoc","SharedDoc","bool"],["LinksUpToDate","LinksUpToDate","bool"],["ScaleCrop","ScaleCrop","bool"],["HeadingPairs","HeadingPairs","raw"],["TitlesOfParts","TitlesOfParts","raw"]];function kT(e,t,r,n){var a=[];if(typeof e=="string")a=E3(e,n);else for(var i=0;i<e.length;++i)a=a.concat(e[i].map(function(u){return{v:u}}));var s=typeof t=="string"?E3(t,n).map(function(u){return u.v}):t,o=0,l=0;if(s.length>0)for(var c=0;c!==a.length;c+=2){switch(l=+a[c+1].v,a[c].v){case"Worksheets":case"":case"":case" ":case"":case" ":case"Arbeitsbltter":case"alma Sayfalar":case"Feuilles de calcul":case"Fogli di lavoro":case"Folhas de clculo":case"Planilhas":case"Regneark":case"Hojas de clculo":case"Werkbladen":r.Worksheets=l,r.SheetNames=s.slice(o,o+l);break;case"Named Ranges":case"Rangos con nombre":case"":case"Benannte Bereiche":case"Navngivne omrder":r.NamedRanges=l,r.DefinedNames=s.slice(o,o+l);break;case"Charts":case"Diagramme":r.Chartsheets=l,r.ChartNames=s.slice(o,o+l);break}o+=l}}function DV(e,t,r){var n={};return t||(t={}),e=pr(e),OV.forEach(function(a){var i=(e.match(ih(a[0]))||[])[1];switch(a[2]){case"string":i&&(t[a[1]]=Ht(i));break;case"bool":t[a[1]]=i==="true";break;case"raw":var s=e.match(new RegExp("<"+a[0]+"[^>]*>([\\s\\S]*?)</"+a[0]+">"));s&&s.length>0&&(n[a[1]]=s[1]);break}}),n.HeadingPairs&&n.TitlesOfParts&&kT(n.HeadingPairs,n.TitlesOfParts,t,r),t}var IV=/<[^>]+>[^<]*/g;function RV(e,t){var r={},n="",a=e.match(IV);if(a)for(var i=0;i!=a.length;++i){var s=a[i],o=yt(s);switch(o[0]){case"<?xml":break;case"<Properties":break;case"<property":n=Ht(o.name);break;case"</property>":n=null;break;default:if(s.indexOf("<vt:")===0){var l=s.split(">"),c=l[0].slice(4),u=l[1];switch(c){case"lpstr":case"bstr":case"lpwstr":r[n]=Ht(u);break;case"bool":r[n]=wr(u);break;case"i1":case"i2":case"i4":case"i8":case"int":case"uint":r[n]=parseInt(u,10);break;case"r4":case"r8":case"decimal":r[n]=parseFloat(u);break;case"filetime":case"date":r[n]=vn(u);break;case"cy":case"error":r[n]=Ht(u);break;default:if(c.slice(-1)=="/")break;t.WTF&&typeof console<"u"&&console.warn("Unexpected",s,c,l)}}else if(s.slice(0,2)!=="</"){if(t.WTF)throw new Error(s)}}}return r}var jV={Title:"Title",Subject:"Subject",Author:"Author",Keywords:"Keywords",Comments:"Description",LastAuthor:"LastAuthor",RevNumber:"Revision",Application:"AppName",LastPrinted:"LastPrinted",CreatedDate:"Created",ModifiedDate:"LastSaved",Category:"Category",Manager:"Manager",Company:"Company",AppVersion:"Version",ContentStatus:"ContentStatus",Identifier:"Identifier",Language:"Language"},p2;function MV(e,t,r){p2||(p2=h5(jV)),t=p2[t]||t,e[t]=r}function S5(e){var t=e.read_shift(4),r=e.read_shift(4);return new Date((r/1e7*Math.pow(2,32)+t/1e7-11644473600)*1e3).toISOString().replace(/\.000/,"")}function ET(e,t,r){var n=e.l,a=e.read_shift(0,"lpstr-cp");if(r)for(;e.l-n&3;)++e.l;return a}function AT(e,t,r){var n=e.read_shift(0,"lpwstr");return n}function TT(e,t,r){return t===31?AT(e):ET(e,t,r)}function ox(e,t,r){return TT(e,t,r===!1?0:4)}function BV(e,t){if(!t)throw new Error("VtUnalignedString must have positive length");return TT(e,t,0)}function UV(e){for(var t=e.read_shift(4),r=[],n=0;n!=t;++n){var a=e.l;r[n]=e.read_shift(0,"lpwstr").replace(aa,""),e.l-a&2&&(e.l+=2)}return r}function VV(e){for(var t=e.read_shift(4),r=[],n=0;n!=t;++n)r[n]=e.read_shift(0,"lpstr-cp").replace(aa,"");return r}function $V(e){var t=e.l,r=C1(e,bT);e[e.l]==0&&e[e.l+1]==0&&e.l-t&2&&(e.l+=2);var n=C1(e,ma);return[r,n]}function zV(e){for(var t=e.read_shift(4),r=[],n=0;n<t/2;++n)r.push($V(e));return r}function R3(e,t){for(var r=e.read_shift(4),n={},a=0;a!=r;++a){var i=e.read_shift(4),s=e.read_shift(4);n[i]=e.read_shift(s,t===1200?"utf16le":"utf8").replace(aa,"").replace(Zf,"!"),t===1200&&s%2&&(e.l+=2)}return e.l&3&&(e.l=e.l>>3<<2),n}function CT(e){var t=e.read_shift(4),r=e.slice(e.l,e.l+t);return e.l+=t,(t&3)>0&&(e.l+=4-(t&3)&3),r}function HV(e){var t={};return t.Size=e.read_shift(4),e.l+=t.Size+3-(t.Size-1)%4,t}function C1(e,t,r){var n=e.read_shift(2),a,i=r||{};if(e.l+=2,t!==O3&&n!==t&&_V.indexOf(t)===-1&&!((t&65534)==4126&&(n&65534)==4126))throw new Error("Expected type "+t+" saw "+n);switch(t===O3?n:t){case 2:return a=e.read_shift(2,"i"),i.raw||(e.l+=2),a;case 3:return a=e.read_shift(4,"i"),a;case 11:return e.read_shift(4)!==0;case 19:return a=e.read_shift(4),a;case 30:return ET(e,n,4).replace(aa,"");case 31:return AT(e);case 64:return S5(e);case 65:return CT(e);case 71:return HV(e);case 80:return ox(e,n,!i.raw).replace(aa,"");case 81:return BV(e,n).replace(aa,"");case 4108:return zV(e);case 4126:case 4127:return n==4127?UV(e):VV(e);default:throw new Error("TypedPropertyValue unrecognized type "+t+" "+n)}}function j3(e,t){var r=e.l,n=e.read_shift(4),a=e.read_shift(4),i=[],s=0,o=0,l=-1,c={};for(s=0;s!=a;++s){var u=e.read_shift(4),f=e.read_shift(4);i[s]=[u,f+r]}i.sort(function(w,y){return w[1]-y[1]});var p={};for(s=0;s!=a;++s){if(e.l!==i[s][1]){var h=!0;if(s>0&&t)switch(t[i[s-1][0]].t){case 2:e.l+2===i[s][1]&&(e.l+=2,h=!1);break;case 80:e.l<=i[s][1]&&(e.l=i[s][1],h=!1);break;case 4108:e.l<=i[s][1]&&(e.l=i[s][1],h=!1);break}if((!t||s==0)&&e.l<=i[s][1]&&(h=!1,e.l=i[s][1]),h)throw new Error("Read Error: Expected address "+i[s][1]+" at "+e.l+" :"+s)}if(t){var g=t[i[s][0]];if(p[g.n]=C1(e,g.t,{raw:!0}),g.p==="version"&&(p[g.n]=String(p[g.n]>>16)+"."+("0000"+String(p[g.n]&65535)).slice(-4)),g.n=="CodePage")switch(p[g.n]){case 0:p[g.n]=1252;case 874:case 932:case 936:case 949:case 950:case 1250:case 1251:case 1253:case 1254:case 1255:case 1256:case 1257:case 1258:case 1e4:case 1200:case 1201:case 1252:case 65e3:case-536:case 65001:case-535:Ii(o=p[g.n]>>>0&65535);break;default:throw new Error("Unsupported CodePage: "+p[g.n])}}else if(i[s][0]===1){if(o=p.CodePage=C1(e,_5),Ii(o),l!==-1){var m=e.l;e.l=i[l][1],c=R3(e,o),e.l=m}}else if(i[s][0]===0){if(o===0){l=s,e.l=i[s+1][1];continue}c=R3(e,o)}else{var b=c[i[s][0]],x;switch(e[e.l]){case 65:e.l+=4,x=CT(e);break;case 30:e.l+=4,x=ox(e,e[e.l-4]).replace(/\u0000+$/,"");break;case 31:e.l+=4,x=ox(e,e[e.l-4]).replace(/\u0000+$/,"");break;case 3:e.l+=4,x=e.read_shift(4,"i");break;case 19:e.l+=4,x=e.read_shift(4);break;case 5:e.l+=4,x=e.read_shift(8,"f");break;case 11:e.l+=4,x=Mr(e,4);break;case 64:e.l+=4,x=vn(S5(e));break;default:throw new Error("unparsed value: "+e[e.l])}p[b]=x}}return e.l=r+n,p}function M3(e,t,r){var n=e.content;if(!n)return{};bn(n,0);var a,i,s,o,l=0;n.chk("feff","Byte Order: "),n.read_shift(2);var c=n.read_shift(4),u=n.read_shift(16);if(u!==Bt.utils.consts.HEADER_CLSID&&u!==r)throw new Error("Bad PropertySet CLSID "+u);if(a=n.read_shift(4),a!==1&&a!==2)throw new Error("Unrecognized #Sets: "+a);if(i=n.read_shift(16),o=n.read_shift(4),a===1&&o!==n.l)throw new Error("Length mismatch: "+o+" !== "+n.l);a===2&&(s=n.read_shift(16),l=n.read_shift(4));var f=j3(n,t),p={SystemIdentifier:c};for(var h in f)p[h]=f[h];if(p.FMTID=i,a===1)return p;if(l-n.l==2&&(n.l+=2),n.l!==l)throw new Error("Length mismatch 2: "+n.l+" !== "+l);var g;try{g=j3(n,null)}catch{}for(h in g)p[h]=g[h];return p.FMTID=[i,s],p}function wo(e,t){return e.read_shift(t),null}function WV(e,t,r){for(var n=[],a=e.l+t;e.l<a;)n.push(r(e,a-e.l));if(a!==e.l)throw new Error("Slurp error");return n}function Mr(e,t){return e.read_shift(t)===1}function Jr(e){return e.read_shift(2,"u")}function NT(e,t){return WV(e,t,Jr)}function qV(e){var t=e.read_shift(1),r=e.read_shift(1);return r===1?t:t===1}function Oh(e,t,r){var n=e.read_shift(r&&r.biff>=12?2:1),a="sbcs-cont";if(r&&r.biff>=8,!r||r.biff==8){var i=e.read_shift(1);i&&(a="dbcs-cont")}else r.biff==12&&(a="wstr");r.biff>=2&&r.biff<=5&&(a="cpstr");var s=n?e.read_shift(n,a):"";return s}function GV(e){var t=e.read_shift(2),r=e.read_shift(1),n=r&4,a=r&8,i=1+(r&1),s=0,o,l={};a&&(s=e.read_shift(2)),n&&(o=e.read_shift(4));var c=i==2?"dbcs-cont":"sbcs-cont",u=t===0?"":e.read_shift(t,c);return a&&(e.l+=4*s),n&&(e.l+=o),l.t=u,a||(l.raw="<t>"+l.t+"</t>",l.r=l.t),l}function nc(e,t,r){var n;if(r){if(r.biff>=2&&r.biff<=5)return e.read_shift(t,"cpstr");if(r.biff>=12)return e.read_shift(t,"dbcs-cont")}var a=e.read_shift(1);return a===0?n=e.read_shift(t,"sbcs-cont"):n=e.read_shift(t,"dbcs-cont"),n}function Dh(e,t,r){var n=e.read_shift(r&&r.biff==2?1:2);return n===0?(e.l++,""):nc(e,n,r)}function gc(e,t,r){if(r.biff>5)return Dh(e,t,r);var n=e.read_shift(1);return n===0?(e.l++,""):e.read_shift(n,r.biff<=4||!e.lens?"cpstr":"sbcs-cont")}function KV(e){var t=e.read_shift(1);e.l++;var r=e.read_shift(2);return e.l+=2,[t,r]}function XV(e){var t=e.read_shift(4),r=e.l,n=!1;t>24&&(e.l+=t-24,e.read_shift(16)==="795881f43b1d7f48af2c825dc4852763"&&(n=!0),e.l=r);var a=e.read_shift((n?t-24:t)>>1,"utf16le").replace(aa,"");return n&&(e.l+=24),a}function YV(e){for(var t=e.read_shift(2),r="";t-- >0;)r+="../";var n=e.read_shift(0,"lpstr-ansi");if(e.l+=2,e.read_shift(2)!=57005)throw new Error("Bad FileMoniker");var a=e.read_shift(4);if(a===0)return r+n.replace(/\\/g,"/");var i=e.read_shift(4);if(e.read_shift(2)!=3)throw new Error("Bad FileMoniker");var s=e.read_shift(i>>1,"utf16le").replace(aa,"");return r+s}function JV(e,t){var r=e.read_shift(16);switch(r){case"e0c9ea79f9bace118c8200aa004ba90b":return XV(e);case"0303000000000000c000000000000046":return YV(e);default:throw new Error("Unsupported Moniker "+r)}}function ip(e){var t=e.read_shift(4),r=t>0?e.read_shift(t,"utf16le").replace(aa,""):"";return r}function QV(e,t){var r=e.l+t,n=e.read_shift(4);if(n!==2)throw new Error("Unrecognized streamVersion: "+n);var a=e.read_shift(2);e.l+=2;var i,s,o,l,c="",u,f;a&16&&(i=ip(e,r-e.l)),a&128&&(s=ip(e,r-e.l)),(a&257)===257&&(o=ip(e,r-e.l)),(a&257)===1&&(l=JV(e,r-e.l)),a&8&&(c=ip(e,r-e.l)),a&32&&(u=e.read_shift(16)),a&64&&(f=S5(e)),e.l=r;var p=s||o||l||"";p&&c&&(p+="#"+c),p||(p="#"+c),a&2&&p.charAt(0)=="/"&&p.charAt(1)!="/"&&(p="file://"+p);var h={Target:p};return u&&(h.guid=u),f&&(h.time=f),i&&(h.Tooltip=i),h}function PT(e){var t=e.read_shift(1),r=e.read_shift(1),n=e.read_shift(1),a=e.read_shift(1);return[t,r,n,a]}function LT(e,t){var r=PT(e);return r[3]=0,r}function gs(e){var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(2);return{r:t,c:r,ixfe:n}}function ZV(e){var t=e.read_shift(2),r=e.read_shift(2);return e.l+=8,{type:t,flags:r}}function e$(e,t,r){return t===0?"":gc(e,t,r)}function t$(e,t,r){var n=r.biff>8?4:2,a=e.read_shift(n),i=e.read_shift(n,"i"),s=e.read_shift(n,"i");return[a,i,s]}function FT(e){var t=e.read_shift(2),r=b5(e);return[t,r]}function r$(e,t,r){e.l+=4,t-=4;var n=e.l+t,a=Oh(e,t,r),i=e.read_shift(2);if(n-=e.l,i!==n)throw new Error("Malformed AddinUdf: padding = "+n+" != "+i);return e.l+=i,a}function Cm(e){var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(2),a=e.read_shift(2);return{s:{c:n,r:t},e:{c:a,r}}}function OT(e){var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(1),a=e.read_shift(1);return{s:{c:n,r:t},e:{c:a,r}}}var n$=OT;function DT(e){e.l+=4;var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(2);return e.l+=12,[r,t,n]}function a$(e){var t={};return e.l+=4,e.l+=16,t.fSharedNote=e.read_shift(2),e.l+=4,t}function i$(e){var t={};return e.l+=4,e.cf=e.read_shift(2),t}function Ln(e){e.l+=2,e.l+=e.read_shift(2)}var s$={0:Ln,4:Ln,5:Ln,6:Ln,7:i$,8:Ln,9:Ln,10:Ln,11:Ln,12:Ln,13:a$,14:Ln,15:Ln,16:Ln,17:Ln,18:Ln,19:Ln,20:Ln,21:DT};function o$(e,t){for(var r=e.l+t,n=[];e.l<r;){var a=e.read_shift(2);e.l-=2;try{n.push(s$[a](e,r-e.l))}catch{return e.l=r,n}}return e.l!=r&&(e.l=r),n}function sp(e,t){var r={BIFFVer:0,dt:0};switch(r.BIFFVer=e.read_shift(2),t-=2,t>=2&&(r.dt=e.read_shift(2),e.l-=2),r.BIFFVer){case 1536:case 1280:case 1024:case 768:case 512:case 2:case 7:break;default:if(t>6)throw new Error("Unexpected BIFF Ver "+r.BIFFVer)}return e.read_shift(t),r}function l$(e,t){return t===0||e.read_shift(2),1200}function c$(e,t,r){if(r.enc)return e.l+=t,"";var n=e.l,a=gc(e,0,r);return e.read_shift(t+n-e.l),a}function u$(e,t,r){var n=r&&r.biff==8||t==2?e.read_shift(2):(e.l+=t,0);return{fDialog:n&16,fBelow:n&64,fRight:n&128}}function f$(e,t,r){var n=e.read_shift(4),a=e.read_shift(1)&3,i=e.read_shift(1);switch(i){case 0:i="Worksheet";break;case 1:i="Macrosheet";break;case 2:i="Chartsheet";break;case 6:i="VBAModule";break}var s=Oh(e,0,r);return s.length===0&&(s="Sheet1"),{pos:n,hs:a,dt:i,name:s}}function h$(e,t){for(var r=e.l+t,n=e.read_shift(4),a=e.read_shift(4),i=[],s=0;s!=a&&e.l<r;++s)i.push(GV(e));return i.Count=n,i.Unique=a,i}function d$(e,t){var r={};return r.dsst=e.read_shift(2),e.l+=t-2,r}function p$(e){var t={};t.r=e.read_shift(2),t.c=e.read_shift(2),t.cnt=e.read_shift(2)-t.c;var r=e.read_shift(2);e.l+=4;var n=e.read_shift(1);return e.l+=3,n&7&&(t.level=n&7),n&32&&(t.hidden=!0),n&64&&(t.hpt=r/20),t}function m$(e){var t=ZV(e);if(t.type!=2211)throw new Error("Invalid Future Record "+t.type);var r=e.read_shift(4);return r!==0}function g$(e){return e.read_shift(2),e.read_shift(4)}function B3(e,t,r){var n=0;r&&r.biff==2||(n=e.read_shift(2));var a=e.read_shift(2);r&&r.biff==2&&(n=1-(a>>15),a&=32767);var i={Unsynced:n&1,DyZero:(n&2)>>1,ExAsc:(n&4)>>2,ExDsc:(n&8)>>3};return[i,a]}function v$(e){var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(2),a=e.read_shift(2),i=e.read_shift(2),s=e.read_shift(2),o=e.read_shift(2),l=e.read_shift(2),c=e.read_shift(2);return{Pos:[t,r],Dim:[n,a],Flags:i,CurTab:s,FirstTab:o,Selected:l,TabRatio:c}}function x$(e,t,r){if(r&&r.biff>=2&&r.biff<5)return{};var n=e.read_shift(2);return{RTL:n&64}}function y$(){}function w$(e,t,r){var n={dyHeight:e.read_shift(2),fl:e.read_shift(2)};switch(r&&r.biff||8){case 2:break;case 3:case 4:e.l+=2;break;default:e.l+=10;break}return n.name=Oh(e,0,r),n}function b$(e){var t=gs(e);return t.isst=e.read_shift(4),t}function _$(e,t,r){r.biffguess&&r.biff==2&&(r.biff=5);var n=e.l+t,a=gs(e);r.biff==2&&e.l++;var i=Dh(e,n-e.l,r);return a.val=i,a}function S$(e,t,r){var n=e.read_shift(2),a=gc(e,0,r);return[n,a]}var k$=gc;function U3(e,t,r){var n=e.l+t,a=r.biff==8||!r.biff?4:2,i=e.read_shift(a),s=e.read_shift(a),o=e.read_shift(2),l=e.read_shift(2);return e.l=n,{s:{r:i,c:o},e:{r:s,c:l}}}function E$(e){var t=e.read_shift(2),r=e.read_shift(2),n=FT(e);return{r:t,c:r,ixfe:n[0],rknum:n[1]}}function A$(e,t){for(var r=e.l+t-2,n=e.read_shift(2),a=e.read_shift(2),i=[];e.l<r;)i.push(FT(e));if(e.l!==r)throw new Error("MulRK read error");var s=e.read_shift(2);if(i.length!=s-a+1)throw new Error("MulRK length mismatch");return{r:n,c:a,C:s,rkrec:i}}function T$(e,t){for(var r=e.l+t-2,n=e.read_shift(2),a=e.read_shift(2),i=[];e.l<r;)i.push(e.read_shift(2));if(e.l!==r)throw new Error("MulBlank read error");var s=e.read_shift(2);if(i.length!=s-a+1)throw new Error("MulBlank length mismatch");return{r:n,c:a,C:s,ixfe:i}}function C$(e,t,r,n){var a={},i=e.read_shift(4),s=e.read_shift(4),o=e.read_shift(4),l=e.read_shift(2);return a.patternType=EV[o>>26],n.cellStyles&&(a.alc=i&7,a.fWrap=i>>3&1,a.alcV=i>>4&7,a.fJustLast=i>>7&1,a.trot=i>>8&255,a.cIndent=i>>16&15,a.fShrinkToFit=i>>20&1,a.iReadOrder=i>>22&2,a.fAtrNum=i>>26&1,a.fAtrFnt=i>>27&1,a.fAtrAlc=i>>28&1,a.fAtrBdr=i>>29&1,a.fAtrPat=i>>30&1,a.fAtrProt=i>>31&1,a.dgLeft=s&15,a.dgRight=s>>4&15,a.dgTop=s>>8&15,a.dgBottom=s>>12&15,a.icvLeft=s>>16&127,a.icvRight=s>>23&127,a.grbitDiag=s>>30&3,a.icvTop=o&127,a.icvBottom=o>>7&127,a.icvDiag=o>>14&127,a.dgDiag=o>>21&15,a.icvFore=l&127,a.icvBack=l>>7&127,a.fsxButton=l>>14&1),a}function N$(e,t,r){var n={};return n.ifnt=e.read_shift(2),n.numFmtId=e.read_shift(2),n.flags=e.read_shift(2),n.fStyle=n.flags>>2&1,t-=6,n.data=C$(e,t,n.fStyle,r),n}function P$(e){e.l+=4;var t=[e.read_shift(2),e.read_shift(2)];if(t[0]!==0&&t[0]--,t[1]!==0&&t[1]--,t[0]>7||t[1]>7)throw new Error("Bad Gutters: "+t.join("|"));return t}function V3(e,t,r){var n=gs(e);(r.biff==2||t==9)&&++e.l;var a=qV(e);return n.val=a,n.t=a===!0||a===!1?"b":"e",n}function L$(e,t,r){r.biffguess&&r.biff==2&&(r.biff=5);var n=gs(e),a=Vn(e);return n.val=a,n}var $3=e$;function F$(e,t,r){var n=e.l+t,a=e.read_shift(2),i=e.read_shift(2);if(r.sbcch=i,i==1025||i==14849)return[i,a];if(i<1||i>255)throw new Error("Unexpected SupBook type: "+i);for(var s=nc(e,i),o=[];n>e.l;)o.push(Dh(e));return[i,a,s,o]}function z3(e,t,r){var n=e.read_shift(2),a,i={fBuiltIn:n&1,fWantAdvise:n>>>1&1,fWantPict:n>>>2&1,fOle:n>>>3&1,fOleLink:n>>>4&1,cf:n>>>5&1023,fIcon:n>>>15&1};return r.sbcch===14849&&(a=r$(e,t-2,r)),i.body=a||e.read_shift(t-2),typeof a=="string"&&(i.Name=a),i}var O$=["_xlnm.Consolidate_Area","_xlnm.Auto_Open","_xlnm.Auto_Close","_xlnm.Extract","_xlnm.Database","_xlnm.Criteria","_xlnm.Print_Area","_xlnm.Print_Titles","_xlnm.Recorder","_xlnm.Data_Form","_xlnm.Auto_Activate","_xlnm.Auto_Deactivate","_xlnm.Sheet_Title","_xlnm._FilterDatabase"];function H3(e,t,r){var n=e.l+t,a=e.read_shift(2),i=e.read_shift(1),s=e.read_shift(1),o=e.read_shift(r&&r.biff==2?1:2),l=0;(!r||r.biff>=5)&&(r.biff!=5&&(e.l+=2),l=e.read_shift(2),r.biff==5&&(e.l+=2),e.l+=4);var c=nc(e,s,r);a&32&&(c=O$[c.charCodeAt(0)]);var u=n-e.l;r&&r.biff==2&&--u;var f=n==e.l||o===0||!(u>0)?[]:pq(e,u,r,o);return{chKey:i,Name:c,itab:l,rgce:f}}function IT(e,t,r){if(r.biff<8)return D$(e,t,r);for(var n=[],a=e.l+t,i=e.read_shift(r.biff>8?4:2);i--!==0;)n.push(t$(e,r.biff>8?12:6,r));if(e.l!=a)throw new Error("Bad ExternSheet: "+e.l+" != "+a);return n}function D$(e,t,r){e[e.l+1]==3&&e[e.l]++;var n=Oh(e,t,r);return n.charCodeAt(0)==3?n.slice(1):n}function I$(e,t,r){if(r.biff<8){e.l+=t;return}var n=e.read_shift(2),a=e.read_shift(2),i=nc(e,n,r),s=nc(e,a,r);return[i,s]}function R$(e,t,r){var n=OT(e);e.l++;var a=e.read_shift(1);return t-=8,[mq(e,t,r),a,n]}function W3(e,t,r){var n=n$(e);switch(r.biff){case 2:e.l++,t-=7;break;case 3:case 4:e.l+=2,t-=8;break;default:e.l+=6,t-=12}return[n,hq(e,t,r)]}function j$(e){var t=e.read_shift(4)!==0,r=e.read_shift(4)!==0,n=e.read_shift(4);return[t,r,n]}function M$(e,t,r){if(!(r.biff<8)){var n=e.read_shift(2),a=e.read_shift(2),i=e.read_shift(2),s=e.read_shift(2),o=gc(e,0,r);return r.biff<8&&e.read_shift(1),[{r:n,c:a},o,s,i]}}function B$(e,t,r){return M$(e,t,r)}function U$(e,t){for(var r=[],n=e.read_shift(2);n--;)r.push(Cm(e));return r}function V$(e,t,r){if(r&&r.biff<8)return z$(e,t,r);var n=DT(e),a=o$(e,t-22,n[1]);return{cmo:n,ft:a}}var $$={8:function(e,t){var r=e.l+t;e.l+=10;var n=e.read_shift(2);e.l+=4,e.l+=2,e.l+=2,e.l+=2,e.l+=4;var a=e.read_shift(1);return e.l+=a,e.l=r,{fmt:n}}};function z$(e,t,r){e.l+=4;var n=e.read_shift(2),a=e.read_shift(2),i=e.read_shift(2);e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=6,t-=36;var s=[];return s.push(($$[n]||qn)(e,t,r)),{cmo:[a,n,i],ft:s}}function H$(e,t,r){var n=e.l,a="";try{e.l+=4;var i=(r.lastobj||{cmo:[0,0]}).cmo[1],s;[0,5,7,11,12,14].indexOf(i)==-1?e.l+=6:s=KV(e,6,r);var o=e.read_shift(2);e.read_shift(2),Jr(e,2);var l=e.read_shift(2);e.l+=l;for(var c=1;c<e.lens.length-1;++c){if(e.l-n!=e.lens[c])throw new Error("TxO: bad continue record");var u=e[e.l],f=nc(e,e.lens[c+1]-e.lens[c]-1);if(a+=f,a.length>=(u?o:2*o))break}if(a.length!==o&&a.length!==o*2)throw new Error("cchText: "+o+" != "+a.length);return e.l=n+t,{t:a}}catch{return e.l=n+t,{t:a}}}function W$(e,t){var r=Cm(e);e.l+=16;var n=QV(e,t-24);return[r,n]}function q$(e,t){e.read_shift(2);var r=Cm(e),n=e.read_shift((t-10)/2,"dbcs-cont");return n=n.replace(aa,""),[r,n]}function G$(e){var t=[0,0],r;return r=e.read_shift(2),t[0]=D3[r]||r,r=e.read_shift(2),t[1]=D3[r]||r,t}function K$(e){for(var t=e.read_shift(2),r=[];t-- >0;)r.push(LT(e));return r}function X$(e){for(var t=e.read_shift(2),r=[];t-- >0;)r.push(LT(e));return r}function Y$(e){e.l+=2;var t={cxfs:0,crc:0};return t.cxfs=e.read_shift(2),t.crc=e.read_shift(4),t}function RT(e,t,r){if(!r.cellStyles)return qn(e,t);var n=r&&r.biff>=12?4:2,a=e.read_shift(n),i=e.read_shift(n),s=e.read_shift(n),o=e.read_shift(n),l=e.read_shift(2);n==2&&(e.l+=2);var c={s:a,e:i,w:s,ixfe:o,flags:l};return(r.biff>=5||!r.biff)&&(c.level=l>>8&7),c}function J$(e,t){var r={};return t<32||(e.l+=16,r.header=Vn(e),r.footer=Vn(e),e.l+=2),r}function Q$(e,t,r){var n={area:!1};if(r.biff!=5)return e.l+=t,n;var a=e.read_shift(1);return e.l+=3,a&16&&(n.area=!0),n}var Z$=gs,ez=NT,tz=Dh;function rz(e){var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(4),a={fmt:t,env:r,len:n,data:e.slice(e.l,e.l+n)};return e.l+=n,a}function nz(e,t,r){r.biffguess&&r.biff==5&&(r.biff=2);var n=gs(e);++e.l;var a=gc(e,t-7,r);return n.t="str",n.val=a,n}function az(e){var t=gs(e);++e.l;var r=Vn(e);return t.t="n",t.val=r,t}function iz(e){var t=gs(e);++e.l;var r=e.read_shift(2);return t.t="n",t.val=r,t}function sz(e){var t=e.read_shift(1);return t===0?(e.l++,""):e.read_shift(t,"sbcs-cont")}function oz(e,t){e.l+=6,e.l+=2,e.l+=1,e.l+=3,e.l+=1,e.l+=t-13}function lz(e,t,r){var n=e.l+t,a=gs(e),i=e.read_shift(2),s=nc(e,i,r);return e.l=n,a.t="str",a.val=s,a}var cz=[2,3,48,49,131,139,140,245],q3=function(){var e={1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127,8:865,9:437,10:850,11:437,13:437,14:850,15:437,16:850,17:437,18:850,19:932,20:850,21:437,22:850,23:865,24:437,25:437,26:850,27:437,28:863,29:850,31:852,34:852,35:852,36:860,37:850,38:866,55:850,64:852,77:936,78:949,79:950,80:874,87:1252,88:1252,89:1252,108:863,134:737,135:852,136:857,204:1257,255:16969},t=h5({1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127});function r(o,l){var c=[],u=rl(1);switch(l.type){case"base64":u=Di(Ba(o));break;case"binary":u=Di(o);break;case"buffer":case"array":u=o;break}bn(u,0);var f=u.read_shift(1),p=!!(f&136),h=!1,g=!1;switch(f){case 2:break;case 3:break;case 48:h=!0,p=!0;break;case 49:h=!0,p=!0;break;case 131:break;case 139:break;case 140:g=!0;break;case 245:break;default:throw new Error("DBF Unsupported Version: "+f.toString(16))}var m=0,b=521;f==2&&(m=u.read_shift(2)),u.l+=3,f!=2&&(m=u.read_shift(4)),m>1048576&&(m=1e6),f!=2&&(b=u.read_shift(2));var x=u.read_shift(2),w=l.codepage||1252;f!=2&&(u.l+=16,u.read_shift(1),u[u.l]!==0&&(w=e[u[u.l]]),u.l+=1,u.l+=2),g&&(u.l+=36);for(var y=[],A={},L=Math.min(u.length,f==2?521:b-10-(h?264:0)),D=g?32:11;u.l<L&&u[u.l]!=13;)switch(A={},A.name=Oo.utils.decode(w,u.slice(u.l,u.l+D)).replace(/[\u0000\r\n].*$/g,""),u.l+=D,A.type=String.fromCharCode(u.read_shift(1)),f!=2&&!g&&(A.offset=u.read_shift(4)),A.len=u.read_shift(1),f==2&&(A.offset=u.read_shift(2)),A.dec=u.read_shift(1),A.name.length&&y.push(A),f!=2&&(u.l+=g?13:14),A.type){case"B":(!h||A.len!=8)&&l.WTF&&console.log("Skipping "+A.name+":"+A.type);break;case"G":case"P":l.WTF&&console.log("Skipping "+A.name+":"+A.type);break;case"+":case"0":case"@":case"C":case"D":case"F":case"I":case"L":case"M":case"N":case"O":case"T":case"Y":break;default:throw new Error("Unknown Field Type: "+A.type)}if(u[u.l]!==13&&(u.l=b-1),u.read_shift(1)!==13)throw new Error("DBF Terminator not found "+u.l+" "+u[u.l]);u.l=b;var T=0,F=0;for(c[0]=[],F=0;F!=y.length;++F)c[0][F]=y[F].name;for(;m-- >0;){if(u[u.l]===42){u.l+=x;continue}for(++u.l,c[++T]=[],F=0,F=0;F!=y.length;++F){var R=u.slice(u.l,u.l+y[F].len);u.l+=y[F].len,bn(R,0);var X=Oo.utils.decode(w,R);switch(y[F].type){case"C":X.trim().length&&(c[T][F]=X.replace(/\s+$/,""));break;case"D":X.length===8?c[T][F]=new Date(+X.slice(0,4),+X.slice(4,6)-1,+X.slice(6,8)):c[T][F]=X;break;case"F":c[T][F]=parseFloat(X.trim());break;case"+":case"I":c[T][F]=g?R.read_shift(-4,"i")^2147483648:R.read_shift(4,"i");break;case"L":switch(X.trim().toUpperCase()){case"Y":case"T":c[T][F]=!0;break;case"N":case"F":c[T][F]=!1;break;case"":case"?":break;default:throw new Error("DBF Unrecognized L:|"+X+"|")}break;case"M":if(!p)throw new Error("DBF Unexpected MEMO for type "+f.toString(16));c[T][F]="##MEMO##"+(g?parseInt(X.trim(),10):R.read_shift(4));break;case"N":X=X.replace(/\u0000/g,"").trim(),X&&X!="."&&(c[T][F]=+X||0);break;case"@":c[T][F]=new Date(R.read_shift(-8,"f")-621356832e5);break;case"T":c[T][F]=new Date((R.read_shift(4)-2440588)*864e5+R.read_shift(4));break;case"Y":c[T][F]=R.read_shift(4,"i")/1e4+R.read_shift(4,"i")/1e4*Math.pow(2,32);break;case"O":c[T][F]=-R.read_shift(-8,"f");break;case"B":if(h&&y[F].len==8){c[T][F]=R.read_shift(8,"f");break}case"G":case"P":R.l+=y[F].len;break;case"0":if(y[F].name==="_NullFlags")break;default:throw new Error("DBF Unsupported data type "+y[F].type)}}}if(f!=2&&u.l<u.length&&u[u.l++]!=26)throw new Error("DBF EOF Marker missing "+(u.l-1)+" of "+u.length+" "+u[u.l-1].toString(16));return l&&l.sheetRows&&(c=c.slice(0,l.sheetRows)),l.DBF=y,c}function n(o,l){var c=l||{};c.dateNF||(c.dateNF="yyyymmdd");var u=tf(r(o,c),c);return u["!cols"]=c.DBF.map(function(f){return{wch:f.len,DBF:f}}),delete c.DBF,u}function a(o,l){try{return hl(n(o,l),l)}catch(c){if(l&&l.WTF)throw c}return{SheetNames:[],Sheets:{}}}var i={B:8,C:250,L:1,D:8,"?":0,"":0};function s(o,l){var c=l||{};if(+c.codepage>=0&&Ii(+c.codepage),c.type=="string")throw new Error("Cannot write DBF to JS string");var u=ax(),f=px(o,{header:1,raw:!0,cellDates:!0}),p=f[0],h=f.slice(1),g=o["!cols"]||[],m=0,b=0,x=0,w=1;for(m=0;m<p.length;++m){if(((g[m]||{}).DBF||{}).name){p[m]=g[m].DBF.name,++x;continue}if(p[m]!=null){if(++x,typeof p[m]=="number"&&(p[m]=p[m].toString(10)),typeof p[m]!="string")throw new Error("DBF Invalid column name "+p[m]+" |"+typeof p[m]+"|");if(p.indexOf(p[m])!==m){for(b=0;b<1024;++b)if(p.indexOf(p[m]+"_"+b)==-1){p[m]+="_"+b;break}}}}var y=Or(o["!ref"]),A=[],L=[],D=[];for(m=0;m<=y.e.c-y.s.c;++m){var T="",F="",R=0,X=[];for(b=0;b<h.length;++b)h[b][m]!=null&&X.push(h[b][m]);if(X.length==0||p[m]==null){A[m]="?";continue}for(b=0;b<X.length;++b){switch(typeof X[b]){case"number":F="B";break;case"string":F="C";break;case"boolean":F="L";break;case"object":F=X[b]instanceof Date?"D":"C";break;default:F="C"}R=Math.max(R,String(X[b]).length),T=T&&T!=F?"C":F}R>250&&(R=250),F=((g[m]||{}).DBF||{}).type,F=="C"&&g[m].DBF.len>R&&(R=g[m].DBF.len),T=="B"&&F=="N"&&(T="N",D[m]=g[m].DBF.dec,R=g[m].DBF.len),L[m]=T=="C"||F=="N"?R:i[T]||0,w+=L[m],A[m]=T}var N=u.next(32);for(N.write_shift(4,318902576),N.write_shift(4,h.length),N.write_shift(2,296+32*x),N.write_shift(2,w),m=0;m<4;++m)N.write_shift(4,0);for(N.write_shift(4,0|(+t[IA]||3)<<8),m=0,b=0;m<p.length;++m)if(p[m]!=null){var P=u.next(32),J=(p[m].slice(-10)+"\0\0\0\0\0\0\0\0\0\0\0").slice(0,11);P.write_shift(1,J,"sbcs"),P.write_shift(1,A[m]=="?"?"C":A[m],"sbcs"),P.write_shift(4,b),P.write_shift(1,L[m]||i[A[m]]||0),P.write_shift(1,D[m]||0),P.write_shift(1,2),P.write_shift(4,0),P.write_shift(1,0),P.write_shift(4,0),P.write_shift(4,0),b+=L[m]||i[A[m]]||0}var W=u.next(264);for(W.write_shift(4,13),m=0;m<65;++m)W.write_shift(4,0);for(m=0;m<h.length;++m){var se=u.next(w);for(se.write_shift(1,0),b=0;b<p.length;++b)if(p[b]!=null)switch(A[b]){case"L":se.write_shift(1,h[m][b]==null?63:h[m][b]?84:70);break;case"B":se.write_shift(8,h[m][b]||0,"f");break;case"N":var fe="0";for(typeof h[m][b]=="number"&&(fe=h[m][b].toFixed(D[b]||0)),x=0;x<L[b]-fe.length;++x)se.write_shift(1,32);se.write_shift(1,fe,"sbcs");break;case"D":h[m][b]?(se.write_shift(4,("0000"+h[m][b].getFullYear()).slice(-4),"sbcs"),se.write_shift(2,("00"+(h[m][b].getMonth()+1)).slice(-2),"sbcs"),se.write_shift(2,("00"+h[m][b].getDate()).slice(-2),"sbcs")):se.write_shift(8,"00000000","sbcs");break;case"C":var U=String(h[m][b]!=null?h[m][b]:"").slice(0,L[b]);for(se.write_shift(1,U,"sbcs"),x=0;x<L[b]-U.length;++x)se.write_shift(1,32);break}}return u.next(1).write_shift(1,26),u.end()}return{to_workbook:a,to_sheet:n,from_sheet:s}}(),uz=function(){var e={AA:"",BA:"",CA:"",DA:195,HA:"",JA:197,AE:"",BE:"",CE:"",HE:"",AI:"",BI:"",CI:"",HI:"",AO:"",BO:"",CO:"",DO:213,HO:"",AU:"",BU:"",CU:"",HU:"",Aa:"",Ba:"",Ca:"",Da:227,Ha:"",Ja:229,Ae:"",Be:"",Ce:"",He:"",Ai:"",Bi:"",Ci:"",Hi:"",Ao:"",Bo:"",Co:"",Do:245,Ho:"",Au:"",Bu:"",Cu:"",Hu:"",KC:"",Kc:"",q:"",z:"",a:"",j:"",DN:209,Dn:241,Hy:255,S:169,c:170,R:174,"B ":180,0:176,1:177,2:178,3:179,5:181,6:182,7:183,Q:185,k:186,b:208,i:216,l:222,s:240,y:248,"!":161,'"':162,"#":163,"(":164,"%":165,"'":167,"H ":168,"+":171,";":187,"<":188,"=":189,">":190,"?":191,"{":223},t=new RegExp("\x1BN("+hs(e).join("|").replace(/\|\|\|/,"|\\||").replace(/([?()+])/g,"\\$1")+"|\\|)","gm"),r=function(p,h){var g=e[h];return typeof g=="number"?l3(g):g},n=function(p,h,g){var m=h.charCodeAt(0)-32<<4|g.charCodeAt(0)-48;return m==59?p:l3(m)};e["|"]=254;function a(p,h){switch(h.type){case"base64":return i(Ba(p),h);case"binary":return i(p,h);case"buffer":return i(jt&&Buffer.isBuffer(p)?p.toString("binary"):hc(p),h);case"array":return i(rc(p),h)}throw new Error("Unrecognized type "+h.type)}function i(p,h){var g=p.split(/[\n\r]+/),m=-1,b=-1,x=0,w=0,y=[],A=[],L=null,D={},T=[],F=[],R=[],X=0,N;for(+h.codepage>=0&&Ii(+h.codepage);x!==g.length;++x){X=0;var P=g[x].trim().replace(/\x1B([\x20-\x2F])([\x30-\x3F])/g,n).replace(t,r),J=P.replace(/;;/g,"\0").split(";").map(function(j){return j.replace(/\u0000/g,";")}),W=J[0],se;if(P.length>0)switch(W){case"ID":break;case"E":break;case"B":break;case"O":break;case"W":break;case"P":J[1].charAt(0)=="P"&&A.push(P.slice(3).replace(/;;/g,";"));break;case"C":var fe=!1,U=!1,Q=!1,q=!1,he=-1,xe=-1;for(w=1;w<J.length;++w)switch(J[w].charAt(0)){case"A":break;case"X":b=parseInt(J[w].slice(1))-1,U=!0;break;case"Y":for(m=parseInt(J[w].slice(1))-1,U||(b=0),N=y.length;N<=m;++N)y[N]=[];break;case"K":se=J[w].slice(1),se.charAt(0)==='"'?se=se.slice(1,se.length-1):se==="TRUE"?se=!0:se==="FALSE"?se=!1:isNaN(Ui(se))?isNaN(zu(se).getDate())||(se=vn(se)):(se=Ui(se),L!==null&&Zu(L)&&(se=Tm(se))),fe=!0;break;case"E":q=!0;var E=ku(J[w].slice(1),{r:m,c:b});y[m][b]=[y[m][b],E];break;case"S":Q=!0,y[m][b]=[y[m][b],"S5S"];break;case"G":break;case"R":he=parseInt(J[w].slice(1))-1;break;case"C":xe=parseInt(J[w].slice(1))-1;break;default:if(h&&h.WTF)throw new Error("SYLK bad record "+P)}if(fe&&(y[m][b]&&y[m][b].length==2?y[m][b][0]=se:y[m][b]=se,L=null),Q){if(q)throw new Error("SYLK shared formula cannot have own formula");var I=he>-1&&y[he][xe];if(!I||!I[1])throw new Error("SYLK shared formula cannot find base");y[m][b][1]=qT(I[1],{r:m-he,c:b-xe})}break;case"F":var O=0;for(w=1;w<J.length;++w)switch(J[w].charAt(0)){case"X":b=parseInt(J[w].slice(1))-1,++O;break;case"Y":for(m=parseInt(J[w].slice(1))-1,N=y.length;N<=m;++N)y[N]=[];break;case"M":X=parseInt(J[w].slice(1))/20;break;case"F":break;case"G":break;case"P":L=A[parseInt(J[w].slice(1))];break;case"S":break;case"D":break;case"N":break;case"W":for(R=J[w].slice(1).split(" "),N=parseInt(R[0],10);N<=parseInt(R[1],10);++N)X=parseInt(R[2],10),F[N-1]=X===0?{hidden:!0}:{wch:X},Hu(F[N-1]);break;case"C":b=parseInt(J[w].slice(1))-1,F[b]||(F[b]={});break;case"R":m=parseInt(J[w].slice(1))-1,T[m]||(T[m]={}),X>0?(T[m].hpt=X,T[m].hpx=ch(X)):X===0&&(T[m].hidden=!0);break;default:if(h&&h.WTF)throw new Error("SYLK bad record "+P)}O<1&&(L=null);break;default:if(h&&h.WTF)throw new Error("SYLK bad record "+P)}}return T.length>0&&(D["!rows"]=T),F.length>0&&(D["!cols"]=F),h&&h.sheetRows&&(y=y.slice(0,h.sheetRows)),[y,D]}function s(p,h){var g=a(p,h),m=g[0],b=g[1],x=tf(m,h);return hs(b).forEach(function(w){x[w]=b[w]}),x}function o(p,h){return hl(s(p,h),h)}function l(p,h,g,m){var b="C;Y"+(g+1)+";X"+(m+1)+";K";switch(p.t){case"n":b+=p.v||0,p.f&&!p.F&&(b+=";E"+YH(p.f,{r:g,c:m}));break;case"b":b+=p.v?"TRUE":"FALSE";break;case"e":b+=p.w||p.v;break;case"d":b+='"'+(p.w||p.v)+'"';break;case"s":b+='"'+p.v.replace(/"/g,"").replace(/;/g,";;")+'"';break}return b}function c(p,h){h.forEach(function(g,m){var b="F;W"+(m+1)+" "+(m+1)+" ";g.hidden?b+="0":(typeof g.width=="number"&&!g.wpx&&(g.wpx=P1(g.width)),typeof g.wpx=="number"&&!g.wch&&(g.wch=L1(g.wpx)),typeof g.wch=="number"&&(b+=Math.round(g.wch))),b.charAt(b.length-1)!=" "&&p.push(b)})}function u(p,h){h.forEach(function(g,m){var b="F;";g.hidden?b+="M0;":g.hpt?b+="M"+20*g.hpt+";":g.hpx&&(b+="M"+20*zT(g.hpx)+";"),b.length>2&&p.push(b+"R"+(m+1))})}function f(p,h){var g=["ID;PWXL;N;E"],m=[],b=Or(p["!ref"]),x,w=Array.isArray(p),y=`\r
`;g.push("P;PGeneral"),g.push("F;P0;DG0G8;M255"),p["!cols"]&&c(g,p["!cols"]),p["!rows"]&&u(g,p["!rows"]),g.push("B;Y"+(b.e.r-b.s.r+1)+";X"+(b.e.c-b.s.c+1)+";D"+[b.s.c,b.s.r,b.e.c,b.e.r].join(" "));for(var A=b.s.r;A<=b.e.r;++A)for(var L=b.s.c;L<=b.e.c;++L){var D=Ct({r:A,c:L});x=w?(p[A]||[])[L]:p[D],!(!x||x.v==null&&(!x.f||x.F))&&m.push(l(x,p,A,L))}return g.join(y)+y+m.join(y)+y+"E"+y}return{to_workbook:o,to_sheet:s,from_sheet:f}}(),fz=function(){function e(i,s){switch(s.type){case"base64":return t(Ba(i),s);case"binary":return t(i,s);case"buffer":return t(jt&&Buffer.isBuffer(i)?i.toString("binary"):hc(i),s);case"array":return t(rc(i),s)}throw new Error("Unrecognized type "+s.type)}function t(i,s){for(var o=i.split(`
`),l=-1,c=-1,u=0,f=[];u!==o.length;++u){if(o[u].trim()==="BOT"){f[++l]=[],c=0;continue}if(!(l<0)){var p=o[u].trim().split(","),h=p[0],g=p[1];++u;for(var m=o[u]||"";(m.match(/["]/g)||[]).length&1&&u<o.length-1;)m+=`
`+o[++u];switch(m=m.trim(),+h){case-1:if(m==="BOT"){f[++l]=[],c=0;continue}else if(m!=="EOD")throw new Error("Unrecognized DIF special command "+m);break;case 0:m==="TRUE"?f[l][c]=!0:m==="FALSE"?f[l][c]=!1:isNaN(Ui(g))?isNaN(zu(g).getDate())?f[l][c]=g:f[l][c]=vn(g):f[l][c]=Ui(g),++c;break;case 1:m=m.slice(1,m.length-1),m=m.replace(/""/g,'"'),m&&m.match(/^=".*"$/)&&(m=m.slice(2,-1)),f[l][c++]=m!==""?m:null;break}if(m==="EOD")break}}return s&&s.sheetRows&&(f=f.slice(0,s.sheetRows)),f}function r(i,s){return tf(e(i,s),s)}function n(i,s){return hl(r(i,s),s)}var a=function(){var i=function(l,c,u,f,p){l.push(c),l.push(u+","+f),l.push('"'+p.replace(/"/g,'""')+'"')},s=function(l,c,u,f){l.push(c+","+u),l.push(c==1?'"'+f.replace(/"/g,'""')+'"':f)};return function(l){var c=[],u=Or(l["!ref"]),f,p=Array.isArray(l);i(c,"TABLE",0,1,"sheetjs"),i(c,"VECTORS",0,u.e.r-u.s.r+1,""),i(c,"TUPLES",0,u.e.c-u.s.c+1,""),i(c,"DATA",0,0,"");for(var h=u.s.r;h<=u.e.r;++h){s(c,-1,0,"BOT");for(var g=u.s.c;g<=u.e.c;++g){var m=Ct({r:h,c:g});if(f=p?(l[h]||[])[g]:l[m],!f){s(c,1,0,"");continue}switch(f.t){case"n":var b=f.w;!b&&f.v!=null&&(b=f.v),b==null?f.f&&!f.F?s(c,1,0,"="+f.f):s(c,1,0,""):s(c,0,b,"V");break;case"b":s(c,0,f.v?1:0,f.v?"TRUE":"FALSE");break;case"s":s(c,1,0,isNaN(f.v)?f.v:'="'+f.v+'"');break;case"d":f.w||(f.w=fi(f.z||Ft[14],ia(vn(f.v)))),s(c,0,f.w,"V");break;default:s(c,1,0,"")}}}s(c,-1,0,"EOD");var x=`\r
`,w=c.join(x);return w}}();return{to_workbook:n,to_sheet:r,from_sheet:a}}(),hz=function(){function e(f){return f.replace(/\\b/g,"\\").replace(/\\c/g,":").replace(/\\n/g,`
`)}function t(f){return f.replace(/\\/g,"\\b").replace(/:/g,"\\c").replace(/\n/g,"\\n")}function r(f,p){for(var h=f.split(`
`),g=-1,m=-1,b=0,x=[];b!==h.length;++b){var w=h[b].trim().split(":");if(w[0]==="cell"){var y=ra(w[1]);if(x.length<=y.r)for(g=x.length;g<=y.r;++g)x[g]||(x[g]=[]);switch(g=y.r,m=y.c,w[2]){case"t":x[g][m]=e(w[3]);break;case"v":x[g][m]=+w[3];break;case"vtf":var A=w[w.length-1];case"vtc":switch(w[3]){case"nl":x[g][m]=!!+w[4];break;default:x[g][m]=+w[4];break}w[2]=="vtf"&&(x[g][m]=[x[g][m],A])}}}return p&&p.sheetRows&&(x=x.slice(0,p.sheetRows)),x}function n(f,p){return tf(r(f,p),p)}function a(f,p){return hl(n(f,p),p)}var i=["socialcalc:version:1.5","MIME-Version: 1.0","Content-Type: multipart/mixed; boundary=SocialCalcSpreadsheetControlSave"].join(`
`),s=["--SocialCalcSpreadsheetControlSave","Content-type: text/plain; charset=UTF-8"].join(`
`)+`
`,o=["# SocialCalc Spreadsheet Control Save","part:sheet"].join(`
`),l="--SocialCalcSpreadsheetControlSave--";function c(f){if(!f||!f["!ref"])return"";for(var p=[],h=[],g,m="",b=ef(f["!ref"]),x=Array.isArray(f),w=b.s.r;w<=b.e.r;++w)for(var y=b.s.c;y<=b.e.c;++y)if(m=Ct({r:w,c:y}),g=x?(f[w]||[])[y]:f[m],!(!g||g.v==null||g.t==="z")){switch(h=["cell",m,"t"],g.t){case"s":case"str":h.push(t(g.v));break;case"n":g.f?(h[2]="vtf",h[3]="n",h[4]=g.v,h[5]=t(g.f)):(h[2]="v",h[3]=g.v);break;case"b":h[2]="vt"+(g.f?"f":"c"),h[3]="nl",h[4]=g.v?"1":"0",h[5]=t(g.f||(g.v?"TRUE":"FALSE"));break;case"d":var A=ia(vn(g.v));h[2]="vtc",h[3]="nd",h[4]=""+A,h[5]=g.w||fi(g.z||Ft[14],A);break;case"e":continue}p.push(h.join(":"))}return p.push("sheet:c:"+(b.e.c-b.s.c+1)+":r:"+(b.e.r-b.s.r+1)+":tvf:1"),p.push("valueformat:1:text-wiki"),p.join(`
`)}function u(f){return[i,s,o,s,c(f),l].join(`
`)}return{to_workbook:a,to_sheet:n,from_sheet:u}}(),oh=function(){function e(u,f,p,h,g){g.raw?f[p][h]=u:u===""||(u==="TRUE"?f[p][h]=!0:u==="FALSE"?f[p][h]=!1:isNaN(Ui(u))?isNaN(zu(u).getDate())?f[p][h]=u:f[p][h]=vn(u):f[p][h]=Ui(u))}function t(u,f){var p=f||{},h=[];if(!u||u.length===0)return h;for(var g=u.split(/[\r\n]/),m=g.length-1;m>=0&&g[m].length===0;)--m;for(var b=10,x=0,w=0;w<=m;++w)x=g[w].indexOf(" "),x==-1?x=g[w].length:x++,b=Math.max(b,x);for(w=0;w<=m;++w){h[w]=[];var y=0;for(e(g[w].slice(0,b).trim(),h,w,y,p),y=1;y<=(g[w].length-b)/10+1;++y)e(g[w].slice(b+(y-1)*10,b+y*10).trim(),h,w,y,p)}return p.sheetRows&&(h=h.slice(0,p.sheetRows)),h}var r={44:",",9:"	",59:";",124:"|"},n={44:3,9:2,59:1,124:0};function a(u){for(var f={},p=!1,h=0,g=0;h<u.length;++h)(g=u.charCodeAt(h))==34?p=!p:!p&&g in r&&(f[g]=(f[g]||0)+1);g=[];for(h in f)Object.prototype.hasOwnProperty.call(f,h)&&g.push([f[h],h]);if(!g.length){f=n;for(h in f)Object.prototype.hasOwnProperty.call(f,h)&&g.push([f[h],h])}return g.sort(function(m,b){return m[0]-b[0]||n[m[1]]-n[b[1]]}),r[g.pop()[1]]||44}function i(u,f){var p=f||{},h="",g=p.dense?[]:{},m={s:{c:0,r:0},e:{c:0,r:0}};u.slice(0,4)=="sep="?u.charCodeAt(5)==13&&u.charCodeAt(6)==10?(h=u.charAt(4),u=u.slice(7)):u.charCodeAt(5)==13||u.charCodeAt(5)==10?(h=u.charAt(4),u=u.slice(6)):h=a(u.slice(0,1024)):p&&p.FS?h=p.FS:h=a(u.slice(0,1024));var b=0,x=0,w=0,y=0,A=0,L=h.charCodeAt(0),D=!1,T=0,F=u.charCodeAt(0);u=u.replace(/\r\n/mg,`
`);var R=p.dateNF!=null?SU(p.dateNF):null;function X(){var N=u.slice(y,A),P={};if(N.charAt(0)=='"'&&N.charAt(N.length-1)=='"'&&(N=N.slice(1,-1).replace(/""/g,'"')),N.length===0)P.t="z";else if(p.raw)P.t="s",P.v=N;else if(N.trim().length===0)P.t="s",P.v=N;else if(N.charCodeAt(0)==61)N.charCodeAt(1)==34&&N.charCodeAt(N.length-1)==34?(P.t="s",P.v=N.slice(2,-1).replace(/""/g,'"')):QH(N)?(P.t="n",P.f=N.slice(1)):(P.t="s",P.v=N);else if(N=="TRUE")P.t="b",P.v=!0;else if(N=="FALSE")P.t="b",P.v=!1;else if(!isNaN(w=Ui(N)))P.t="n",p.cellText!==!1&&(P.w=N),P.v=w;else if(!isNaN(zu(N).getDate())||R&&N.match(R)){P.z=p.dateNF||Ft[14];var J=0;R&&N.match(R)&&(N=kU(N,p.dateNF,N.match(R)||[]),J=1),p.cellDates?(P.t="d",P.v=vn(N,J)):(P.t="n",P.v=ia(vn(N,J))),p.cellText!==!1&&(P.w=fi(P.z,P.v instanceof Date?ia(P.v):P.v)),p.cellNF||delete P.z}else P.t="s",P.v=N;if(P.t=="z"||(p.dense?(g[b]||(g[b]=[]),g[b][x]=P):g[Ct({c:x,r:b})]=P),y=A+1,F=u.charCodeAt(y),m.e.c<x&&(m.e.c=x),m.e.r<b&&(m.e.r=b),T==L)++x;else if(x=0,++b,p.sheetRows&&p.sheetRows<=b)return!0}e:for(;A<u.length;++A)switch(T=u.charCodeAt(A)){case 34:F===34&&(D=!D);break;case L:case 10:case 13:if(!D&&X())break e;break}return A-y>0&&X(),g["!ref"]=Ut(m),g}function s(u,f){return!(f&&f.PRN)||f.FS||u.slice(0,4)=="sep="||u.indexOf("	")>=0||u.indexOf(",")>=0||u.indexOf(";")>=0?i(u,f):tf(t(u,f),f)}function o(u,f){var p="",h=f.type=="string"?[0,0,0,0]:L5(u,f);switch(f.type){case"base64":p=Ba(u);break;case"binary":p=u;break;case"buffer":f.codepage==65001?p=u.toString("utf8"):f.codepage&&typeof Oo<"u"?p=Oo.utils.decode(f.codepage,u):p=jt&&Buffer.isBuffer(u)?u.toString("binary"):hc(u);break;case"array":p=rc(u);break;case"string":p=u;break;default:throw new Error("Unrecognized type "+f.type)}return h[0]==239&&h[1]==187&&h[2]==191?p=pr(p.slice(3)):f.type!="string"&&f.type!="buffer"&&f.codepage==65001?p=pr(p):f.type=="binary"&&typeof Oo<"u"&&f.codepage&&(p=Oo.utils.decode(f.codepage,Oo.utils.encode(28591,p))),p.slice(0,19)=="socialcalc:version:"?hz.to_sheet(f.type=="string"?p:pr(p),f):s(p,f)}function l(u,f){return hl(o(u,f),f)}function c(u){for(var f=[],p=Or(u["!ref"]),h,g=Array.isArray(u),m=p.s.r;m<=p.e.r;++m){for(var b=[],x=p.s.c;x<=p.e.c;++x){var w=Ct({r:m,c:x});if(h=g?(u[m]||[])[x]:u[w],!h||h.v==null){b.push("          ");continue}for(var y=(h.w||(Zs(h),h.w)||"").slice(0,10);y.length<10;)y+=" ";b.push(y+(x===0?" ":""))}f.push(b.join(""))}return f.join(`
`)}return{to_workbook:l,to_sheet:o,from_sheet:c}}();function dz(e,t){var r=t||{},n=!!r.WTF;r.WTF=!0;try{var a=uz.to_workbook(e,r);return r.WTF=n,a}catch(i){if(r.WTF=n,!i.message.match(/SYLK bad record ID/)&&n)throw i;return oh.to_workbook(e,t)}}var T0=function(){function e(E,I,O){if(E){bn(E,E.l||0);for(var j=O.Enum||he;E.l<E.length;){var K=E.read_shift(2),ne=j[K]||j[65535],pe=E.read_shift(2),de=E.l+pe,we=ne.f&&ne.f(E,pe,O);if(E.l=de,I(we,ne,K))return}}}function t(E,I){switch(I.type){case"base64":return r(Di(Ba(E)),I);case"binary":return r(Di(E),I);case"buffer":case"array":return r(E,I)}throw"Unsupported type "+I.type}function r(E,I){if(!E)return E;var O=I||{},j=O.dense?[]:{},K="Sheet1",ne="",pe=0,de={},we=[],Pe=[],Z={s:{r:0,c:0},e:{r:0,c:0}},Ve=O.sheetRows||0;if(E[2]==0&&(E[3]==8||E[3]==9)&&E.length>=16&&E[14]==5&&E[15]===108)throw new Error("Unsupported Works 3 for Mac file");if(E[2]==2)O.Enum=he,e(E,function(De,Xe,Me){switch(Me){case 0:O.vers=De,De>=4096&&(O.qpro=!0);break;case 6:Z=De;break;case 204:De&&(ne=De);break;case 222:ne=De;break;case 15:case 51:O.qpro||(De[1].v=De[1].v.slice(1));case 13:case 14:case 16:Me==14&&(De[2]&112)==112&&(De[2]&15)>1&&(De[2]&15)<15&&(De[1].z=O.dateNF||Ft[14],O.cellDates&&(De[1].t="d",De[1].v=Tm(De[1].v))),O.qpro&&De[3]>pe&&(j["!ref"]=Ut(Z),de[K]=j,we.push(K),j=O.dense?[]:{},Z={s:{r:0,c:0},e:{r:0,c:0}},pe=De[3],K=ne||"Sheet"+(pe+1),ne="");var qe=O.dense?(j[De[0].r]||[])[De[0].c]:j[Ct(De[0])];if(qe){qe.t=De[1].t,qe.v=De[1].v,De[1].z!=null&&(qe.z=De[1].z),De[1].f!=null&&(qe.f=De[1].f);break}O.dense?(j[De[0].r]||(j[De[0].r]=[]),j[De[0].r][De[0].c]=De[1]):j[Ct(De[0])]=De[1];break}},O);else if(E[2]==26||E[2]==14)O.Enum=xe,E[2]==14&&(O.qpro=!0,E.l=0),e(E,function(De,Xe,Me){switch(Me){case 204:K=De;break;case 22:De[1].v=De[1].v.slice(1);case 23:case 24:case 25:case 37:case 39:case 40:if(De[3]>pe&&(j["!ref"]=Ut(Z),de[K]=j,we.push(K),j=O.dense?[]:{},Z={s:{r:0,c:0},e:{r:0,c:0}},pe=De[3],K="Sheet"+(pe+1)),Ve>0&&De[0].r>=Ve)break;O.dense?(j[De[0].r]||(j[De[0].r]=[]),j[De[0].r][De[0].c]=De[1]):j[Ct(De[0])]=De[1],Z.e.c<De[0].c&&(Z.e.c=De[0].c),Z.e.r<De[0].r&&(Z.e.r=De[0].r);break;case 27:De[14e3]&&(Pe[De[14e3][0]]=De[14e3][1]);break;case 1537:Pe[De[0]]=De[1],De[0]==pe&&(K=De[1]);break}},O);else throw new Error("Unrecognized LOTUS BOF "+E[2]);if(j["!ref"]=Ut(Z),de[ne||K]=j,we.push(ne||K),!Pe.length)return{SheetNames:we,Sheets:de};for(var Ke={},Ce=[],ae=0;ae<Pe.length;++ae)de[we[ae]]?(Ce.push(Pe[ae]||we[ae]),Ke[Pe[ae]]=de[Pe[ae]]||de[we[ae]]):(Ce.push(Pe[ae]),Ke[Pe[ae]]={"!ref":"A1"});return{SheetNames:Ce,Sheets:Ke}}function n(E,I){var O=I||{};if(+O.codepage>=0&&Ii(+O.codepage),O.type=="string")throw new Error("Cannot write WK1 to JS string");var j=ax(),K=Or(E["!ref"]),ne=Array.isArray(E),pe=[];Si(j,0,i(1030)),Si(j,6,l(K));for(var de=Math.min(K.e.r,8191),we=K.s.r;we<=de;++we)for(var Pe=kn(we),Z=K.s.c;Z<=K.e.c;++Z){we===K.s.r&&(pe[Z]=sn(Z));var Ve=pe[Z]+Pe,Ke=ne?(E[we]||[])[Z]:E[Ve];if(!(!Ke||Ke.t=="z"))if(Ke.t=="n")(Ke.v|0)==Ke.v&&Ke.v>=-32768&&Ke.v<=32767?Si(j,13,h(we,Z,Ke.v)):Si(j,14,m(we,Z,Ke.v));else{var Ce=Zs(Ke);Si(j,15,f(we,Z,Ce.slice(0,239)))}}return Si(j,1),j.end()}function a(E,I){var O=I||{};if(+O.codepage>=0&&Ii(+O.codepage),O.type=="string")throw new Error("Cannot write WK3 to JS string");var j=ax();Si(j,0,s(E));for(var K=0,ne=0;K<E.SheetNames.length;++K)(E.Sheets[E.SheetNames[K]]||{})["!ref"]&&Si(j,27,q(E.SheetNames[K],ne++));var pe=0;for(K=0;K<E.SheetNames.length;++K){var de=E.Sheets[E.SheetNames[K]];if(!(!de||!de["!ref"])){for(var we=Or(de["!ref"]),Pe=Array.isArray(de),Z=[],Ve=Math.min(we.e.r,8191),Ke=we.s.r;Ke<=Ve;++Ke)for(var Ce=kn(Ke),ae=we.s.c;ae<=we.e.c;++ae){Ke===we.s.r&&(Z[ae]=sn(ae));var De=Z[ae]+Ce,Xe=Pe?(de[Ke]||[])[ae]:de[De];if(!(!Xe||Xe.t=="z"))if(Xe.t=="n")Si(j,23,X(Ke,ae,pe,Xe.v));else{var Me=Zs(Xe);Si(j,22,T(Ke,ae,pe,Me.slice(0,239)))}}++pe}}return Si(j,1),j.end()}function i(E){var I=rn(2);return I.write_shift(2,E),I}function s(E){var I=rn(26);I.write_shift(2,4096),I.write_shift(2,4),I.write_shift(4,0);for(var O=0,j=0,K=0,ne=0;ne<E.SheetNames.length;++ne){var pe=E.SheetNames[ne],de=E.Sheets[pe];if(!(!de||!de["!ref"])){++K;var we=ef(de["!ref"]);O<we.e.r&&(O=we.e.r),j<we.e.c&&(j=we.e.c)}}return O>8191&&(O=8191),I.write_shift(2,O),I.write_shift(1,K),I.write_shift(1,j),I.write_shift(2,0),I.write_shift(2,0),I.write_shift(1,1),I.write_shift(1,2),I.write_shift(4,0),I.write_shift(4,0),I}function o(E,I,O){var j={s:{c:0,r:0},e:{c:0,r:0}};return I==8&&O.qpro?(j.s.c=E.read_shift(1),E.l++,j.s.r=E.read_shift(2),j.e.c=E.read_shift(1),E.l++,j.e.r=E.read_shift(2),j):(j.s.c=E.read_shift(2),j.s.r=E.read_shift(2),I==12&&O.qpro&&(E.l+=2),j.e.c=E.read_shift(2),j.e.r=E.read_shift(2),I==12&&O.qpro&&(E.l+=2),j.s.c==65535&&(j.s.c=j.e.c=j.s.r=j.e.r=0),j)}function l(E){var I=rn(8);return I.write_shift(2,E.s.c),I.write_shift(2,E.s.r),I.write_shift(2,E.e.c),I.write_shift(2,E.e.r),I}function c(E,I,O){var j=[{c:0,r:0},{t:"n",v:0},0,0];return O.qpro&&O.vers!=20768?(j[0].c=E.read_shift(1),j[3]=E.read_shift(1),j[0].r=E.read_shift(2),E.l+=2):(j[2]=E.read_shift(1),j[0].c=E.read_shift(2),j[0].r=E.read_shift(2)),j}function u(E,I,O){var j=E.l+I,K=c(E,I,O);if(K[1].t="s",O.vers==20768){E.l++;var ne=E.read_shift(1);return K[1].v=E.read_shift(ne,"utf8"),K}return O.qpro&&E.l++,K[1].v=E.read_shift(j-E.l,"cstr"),K}function f(E,I,O){var j=rn(7+O.length);j.write_shift(1,255),j.write_shift(2,I),j.write_shift(2,E),j.write_shift(1,39);for(var K=0;K<j.length;++K){var ne=O.charCodeAt(K);j.write_shift(1,ne>=128?95:ne)}return j.write_shift(1,0),j}function p(E,I,O){var j=c(E,I,O);return j[1].v=E.read_shift(2,"i"),j}function h(E,I,O){var j=rn(7);return j.write_shift(1,255),j.write_shift(2,I),j.write_shift(2,E),j.write_shift(2,O,"i"),j}function g(E,I,O){var j=c(E,I,O);return j[1].v=E.read_shift(8,"f"),j}function m(E,I,O){var j=rn(13);return j.write_shift(1,255),j.write_shift(2,I),j.write_shift(2,E),j.write_shift(8,O,"f"),j}function b(E,I,O){var j=E.l+I,K=c(E,I,O);if(K[1].v=E.read_shift(8,"f"),O.qpro)E.l=j;else{var ne=E.read_shift(2);A(E.slice(E.l,E.l+ne),K),E.l+=ne}return K}function x(E,I,O){var j=I&32768;return I&=-32769,I=(j?E:0)+(I>=8192?I-16384:I),(j?"":"$")+(O?sn(I):kn(I))}var w={51:["FALSE",0],52:["TRUE",0],70:["LEN",1],80:["SUM",69],81:["AVERAGEA",69],82:["COUNTA",69],83:["MINA",69],84:["MAXA",69],111:["T",1]},y=["","","","","","","","","","+","-","*","/","^","=","<>","<=",">=","<",">","","","","","&","","","","","","",""];function A(E,I){bn(E,0);for(var O=[],j=0,K="",ne="",pe="",de="";E.l<E.length;){var we=E[E.l++];switch(we){case 0:O.push(E.read_shift(8,"f"));break;case 1:ne=x(I[0].c,E.read_shift(2),!0),K=x(I[0].r,E.read_shift(2),!1),O.push(ne+K);break;case 2:{var Pe=x(I[0].c,E.read_shift(2),!0),Z=x(I[0].r,E.read_shift(2),!1);ne=x(I[0].c,E.read_shift(2),!0),K=x(I[0].r,E.read_shift(2),!1),O.push(Pe+Z+":"+ne+K)}break;case 3:if(E.l<E.length){console.error("WK1 premature formula end");return}break;case 4:O.push("("+O.pop()+")");break;case 5:O.push(E.read_shift(2));break;case 6:{for(var Ve="";we=E[E.l++];)Ve+=String.fromCharCode(we);O.push('"'+Ve.replace(/"/g,'""')+'"')}break;case 8:O.push("-"+O.pop());break;case 23:O.push("+"+O.pop());break;case 22:O.push("NOT("+O.pop()+")");break;case 20:case 21:de=O.pop(),pe=O.pop(),O.push(["AND","OR"][we-20]+"("+pe+","+de+")");break;default:if(we<32&&y[we])de=O.pop(),pe=O.pop(),O.push(pe+y[we]+de);else if(w[we]){if(j=w[we][1],j==69&&(j=E[E.l++]),j>O.length){console.error("WK1 bad formula parse 0x"+we.toString(16)+":|"+O.join("|")+"|");return}var Ke=O.slice(-j);O.length-=j,O.push(w[we][0]+"("+Ke.join(",")+")")}else return we<=7?console.error("WK1 invalid opcode "+we.toString(16)):we<=24?console.error("WK1 unsupported op "+we.toString(16)):we<=30?console.error("WK1 invalid opcode "+we.toString(16)):we<=115?console.error("WK1 unsupported function opcode "+we.toString(16)):console.error("WK1 unrecognized opcode "+we.toString(16))}}O.length==1?I[1].f=""+O[0]:console.error("WK1 bad formula parse |"+O.join("|")+"|")}function L(E){var I=[{c:0,r:0},{t:"n",v:0},0];return I[0].r=E.read_shift(2),I[3]=E[E.l++],I[0].c=E[E.l++],I}function D(E,I){var O=L(E);return O[1].t="s",O[1].v=E.read_shift(I-4,"cstr"),O}function T(E,I,O,j){var K=rn(6+j.length);K.write_shift(2,E),K.write_shift(1,O),K.write_shift(1,I),K.write_shift(1,39);for(var ne=0;ne<j.length;++ne){var pe=j.charCodeAt(ne);K.write_shift(1,pe>=128?95:pe)}return K.write_shift(1,0),K}function F(E,I){var O=L(E);O[1].v=E.read_shift(2);var j=O[1].v>>1;if(O[1].v&1)switch(j&7){case 0:j=(j>>3)*5e3;break;case 1:j=(j>>3)*500;break;case 2:j=(j>>3)/20;break;case 3:j=(j>>3)/200;break;case 4:j=(j>>3)/2e3;break;case 5:j=(j>>3)/2e4;break;case 6:j=(j>>3)/16;break;case 7:j=(j>>3)/64;break}return O[1].v=j,O}function R(E,I){var O=L(E),j=E.read_shift(4),K=E.read_shift(4),ne=E.read_shift(2);if(ne==65535)return j===0&&K===3221225472?(O[1].t="e",O[1].v=15):j===0&&K===3489660928?(O[1].t="e",O[1].v=42):O[1].v=0,O;var pe=ne&32768;return ne=(ne&32767)-16446,O[1].v=(1-pe*2)*(K*Math.pow(2,ne+32)+j*Math.pow(2,ne)),O}function X(E,I,O,j){var K=rn(14);if(K.write_shift(2,E),K.write_shift(1,O),K.write_shift(1,I),j==0)return K.write_shift(4,0),K.write_shift(4,0),K.write_shift(2,65535),K;var ne=0,pe=0,de=0,we=0;return j<0&&(ne=1,j=-j),pe=Math.log2(j)|0,j/=Math.pow(2,pe-31),we=j>>>0,we&2147483648||(j/=2,++pe,we=j>>>0),j-=we,we|=2147483648,we>>>=0,j*=Math.pow(2,32),de=j>>>0,K.write_shift(4,de),K.write_shift(4,we),pe+=16383+(ne?32768:0),K.write_shift(2,pe),K}function N(E,I){var O=R(E);return E.l+=I-14,O}function P(E,I){var O=L(E),j=E.read_shift(4);return O[1].v=j>>6,O}function J(E,I){var O=L(E),j=E.read_shift(8,"f");return O[1].v=j,O}function W(E,I){var O=J(E);return E.l+=I-10,O}function se(E,I){return E[E.l+I-1]==0?E.read_shift(I,"cstr"):""}function fe(E,I){var O=E[E.l++];O>I-1&&(O=I-1);for(var j="";j.length<O;)j+=String.fromCharCode(E[E.l++]);return j}function U(E,I,O){if(!(!O.qpro||I<21)){var j=E.read_shift(1);E.l+=17,E.l+=1,E.l+=2;var K=E.read_shift(I-21,"cstr");return[j,K]}}function Q(E,I){for(var O={},j=E.l+I;E.l<j;){var K=E.read_shift(2);if(K==14e3){for(O[K]=[0,""],O[K][0]=E.read_shift(2);E[E.l];)O[K][1]+=String.fromCharCode(E[E.l]),E.l++;E.l++}}return O}function q(E,I){var O=rn(5+E.length);O.write_shift(2,14e3),O.write_shift(2,I);for(var j=0;j<E.length;++j){var K=E.charCodeAt(j);O[O.l++]=K>127?95:K}return O[O.l++]=0,O}var he={0:{n:"BOF",f:Jr},1:{n:"EOF"},2:{n:"CALCMODE"},3:{n:"CALCORDER"},4:{n:"SPLIT"},5:{n:"SYNC"},6:{n:"RANGE",f:o},7:{n:"WINDOW1"},8:{n:"COLW1"},9:{n:"WINTWO"},10:{n:"COLW2"},11:{n:"NAME"},12:{n:"BLANK"},13:{n:"INTEGER",f:p},14:{n:"NUMBER",f:g},15:{n:"LABEL",f:u},16:{n:"FORMULA",f:b},24:{n:"TABLE"},25:{n:"ORANGE"},26:{n:"PRANGE"},27:{n:"SRANGE"},28:{n:"FRANGE"},29:{n:"KRANGE1"},32:{n:"HRANGE"},35:{n:"KRANGE2"},36:{n:"PROTEC"},37:{n:"FOOTER"},38:{n:"HEADER"},39:{n:"SETUP"},40:{n:"MARGINS"},41:{n:"LABELFMT"},42:{n:"TITLES"},43:{n:"SHEETJS"},45:{n:"GRAPH"},46:{n:"NGRAPH"},47:{n:"CALCCOUNT"},48:{n:"UNFORMATTED"},49:{n:"CURSORW12"},50:{n:"WINDOW"},51:{n:"STRING",f:u},55:{n:"PASSWORD"},56:{n:"LOCKED"},60:{n:"QUERY"},61:{n:"QUERYNAME"},62:{n:"PRINT"},63:{n:"PRINTNAME"},64:{n:"GRAPH2"},65:{n:"GRAPHNAME"},66:{n:"ZOOM"},67:{n:"SYMSPLIT"},68:{n:"NSROWS"},69:{n:"NSCOLS"},70:{n:"RULER"},71:{n:"NNAME"},72:{n:"ACOMM"},73:{n:"AMACRO"},74:{n:"PARSE"},102:{n:"PRANGES??"},103:{n:"RRANGES??"},104:{n:"FNAME??"},105:{n:"MRANGES??"},204:{n:"SHEETNAMECS",f:se},222:{n:"SHEETNAMELP",f:fe},65535:{n:""}},xe={0:{n:"BOF"},1:{n:"EOF"},2:{n:"PASSWORD"},3:{n:"CALCSET"},4:{n:"WINDOWSET"},5:{n:"SHEETCELLPTR"},6:{n:"SHEETLAYOUT"},7:{n:"COLUMNWIDTH"},8:{n:"HIDDENCOLUMN"},9:{n:"USERRANGE"},10:{n:"SYSTEMRANGE"},11:{n:"ZEROFORCE"},12:{n:"SORTKEYDIR"},13:{n:"FILESEAL"},14:{n:"DATAFILLNUMS"},15:{n:"PRINTMAIN"},16:{n:"PRINTSTRING"},17:{n:"GRAPHMAIN"},18:{n:"GRAPHSTRING"},19:{n:"??"},20:{n:"ERRCELL"},21:{n:"NACELL"},22:{n:"LABEL16",f:D},23:{n:"NUMBER17",f:R},24:{n:"NUMBER18",f:F},25:{n:"FORMULA19",f:N},26:{n:"FORMULA1A"},27:{n:"XFORMAT",f:Q},28:{n:"DTLABELMISC"},29:{n:"DTLABELCELL"},30:{n:"GRAPHWINDOW"},31:{n:"CPA"},32:{n:"LPLAUTO"},33:{n:"QUERY"},34:{n:"HIDDENSHEET"},35:{n:"??"},37:{n:"NUMBER25",f:P},38:{n:"??"},39:{n:"NUMBER27",f:J},40:{n:"FORMULA28",f:W},142:{n:"??"},147:{n:"??"},150:{n:"??"},151:{n:"??"},152:{n:"??"},153:{n:"??"},154:{n:"??"},155:{n:"??"},156:{n:"??"},163:{n:"??"},174:{n:"??"},175:{n:"??"},176:{n:"??"},177:{n:"??"},184:{n:"??"},185:{n:"??"},186:{n:"??"},187:{n:"??"},188:{n:"??"},195:{n:"??"},201:{n:"??"},204:{n:"SHEETNAMECS",f:se},205:{n:"??"},206:{n:"??"},207:{n:"??"},208:{n:"??"},256:{n:"??"},259:{n:"??"},260:{n:"??"},261:{n:"??"},262:{n:"??"},263:{n:"??"},265:{n:"??"},266:{n:"??"},267:{n:"??"},268:{n:"??"},270:{n:"??"},271:{n:"??"},384:{n:"??"},389:{n:"??"},390:{n:"??"},393:{n:"??"},396:{n:"??"},512:{n:"??"},514:{n:"??"},513:{n:"??"},516:{n:"??"},517:{n:"??"},640:{n:"??"},641:{n:"??"},642:{n:"??"},643:{n:"??"},644:{n:"??"},645:{n:"??"},646:{n:"??"},647:{n:"??"},648:{n:"??"},658:{n:"??"},659:{n:"??"},660:{n:"??"},661:{n:"??"},662:{n:"??"},665:{n:"??"},666:{n:"??"},768:{n:"??"},772:{n:"??"},1537:{n:"SHEETINFOQP",f:U},1600:{n:"??"},1602:{n:"??"},1793:{n:"??"},1794:{n:"??"},1795:{n:"??"},1796:{n:"??"},1920:{n:"??"},2048:{n:"??"},2049:{n:"??"},2052:{n:"??"},2688:{n:"??"},10998:{n:"??"},12849:{n:"??"},28233:{n:"??"},28484:{n:"??"},65535:{n:""}};return{sheet_to_wk1:n,book_to_wk3:a,to_workbook:t}}();function pz(e){var t={},r=e.match(Gn),n=0,a=!1;if(r)for(;n!=r.length;++n){var i=yt(r[n]);switch(i[0].replace(/\w*:/g,"")){case"<condense":break;case"<extend":break;case"<shadow":if(!i.val)break;case"<shadow>":case"<shadow/>":t.shadow=1;break;case"</shadow>":break;case"<charset":if(i.val=="1")break;t.cp=o5[parseInt(i.val,10)];break;case"<outline":if(!i.val)break;case"<outline>":case"<outline/>":t.outline=1;break;case"</outline>":break;case"<rFont":t.name=i.val;break;case"<sz":t.sz=i.val;break;case"<strike":if(!i.val)break;case"<strike>":case"<strike/>":t.strike=1;break;case"</strike>":break;case"<u":if(!i.val)break;switch(i.val){case"double":t.uval="double";break;case"singleAccounting":t.uval="single-accounting";break;case"doubleAccounting":t.uval="double-accounting";break}case"<u>":case"<u/>":t.u=1;break;case"</u>":break;case"<b":if(i.val=="0")break;case"<b>":case"<b/>":t.b=1;break;case"</b>":break;case"<i":if(i.val=="0")break;case"<i>":case"<i/>":t.i=1;break;case"</i>":break;case"<color":i.rgb&&(t.color=i.rgb.slice(2,8));break;case"<color>":case"<color/>":case"</color>":break;case"<family":t.family=i.val;break;case"<family>":case"<family/>":case"</family>":break;case"<vertAlign":t.valign=i.val;break;case"<vertAlign>":case"<vertAlign/>":case"</vertAlign>":break;case"<scheme":break;case"<scheme>":case"<scheme/>":case"</scheme>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":a=!0;break;case"</ext>":a=!1;break;default:if(i[0].charCodeAt(1)!==47&&!a)throw new Error("Unrecognized rich format "+i[0])}}return t}var mz=function(){var e=ih("t"),t=ih("rPr");function r(i){var s=i.match(e);if(!s)return{t:"s",v:""};var o={t:"s",v:Ht(s[1])},l=i.match(t);return l&&(o.s=pz(l[1])),o}var n=/<(?:\w+:)?r>/g,a=/<\/(?:\w+:)?r>/;return function(s){return s.replace(n,"").split(a).map(r).filter(function(o){return o.v})}}(),gz=function(){var t=/(\r\n|\n)/g;function r(a,i,s){var o=[];a.u&&o.push("text-decoration: underline;"),a.uval&&o.push("text-underline-style:"+a.uval+";"),a.sz&&o.push("font-size:"+a.sz+"pt;"),a.outline&&o.push("text-effect: outline;"),a.shadow&&o.push("text-shadow: auto;"),i.push('<span style="'+o.join("")+'">'),a.b&&(i.push("<b>"),s.push("</b>")),a.i&&(i.push("<i>"),s.push("</i>")),a.strike&&(i.push("<s>"),s.push("</s>"));var l=a.valign||"";return l=="superscript"||l=="super"?l="sup":l=="subscript"&&(l="sub"),l!=""&&(i.push("<"+l+">"),s.push("</"+l+">")),s.push("</span>"),a}function n(a){var i=[[],a.v,[]];return a.v?(a.s&&r(a.s,i[0],i[2]),i[0].join("")+i[1].replace(t,"<br/>")+i[2].join("")):""}return function(i){return i.map(n).join("")}}(),vz=/<(?:\w+:)?t[^>]*>([^<]*)<\/(?:\w+:)?t>/g,xz=/<(?:\w+:)?r>/,yz=/<(?:\w+:)?rPh.*?>([\s\S]*?)<\/(?:\w+:)?rPh>/g;function k5(e,t){var r=t?t.cellHTML:!0,n={};return e?(e.match(/^\s*<(?:\w+:)?t[^>]*>/)?(n.t=Ht(pr(e.slice(e.indexOf(">")+1).split(/<\/(?:\w+:)?t>/)[0]||"")),n.r=pr(e),r&&(n.h=p5(n.t))):e.match(xz)&&(n.r=pr(e),n.t=Ht(pr((e.replace(yz,"").match(vz)||[]).join("").replace(Gn,""))),r&&(n.h=gz(mz(n.r)))),n):{t:""}}var wz=/<(?:\w+:)?sst([^>]*)>([\s\S]*)<\/(?:\w+:)?sst>/,bz=/<(?:\w+:)?(?:si|sstItem)>/g,_z=/<\/(?:\w+:)?(?:si|sstItem)>/;function Sz(e,t){var r=[],n="";if(!e)return r;var a=e.match(wz);if(a){n=a[2].replace(bz,"").split(_z);for(var i=0;i!=n.length;++i){var s=k5(n[i].trim(),t);s!=null&&(r[r.length]=s)}a=yt(a[1]),r.Count=a.count,r.Unique=a.uniqueCount}return r}function kz(e){return[e.read_shift(4),e.read_shift(4)]}function Ez(e,t){var r=[],n=!1;return no(e,function(i,s,o){switch(o){case 159:r.Count=i[0],r.Unique=i[1];break;case 19:r.push(i);break;case 160:return!0;case 35:n=!0;break;case 36:n=!1;break;default:if(s.T,!n||t.WTF)throw new Error("Unexpected record 0x"+o.toString(16))}}),r}function jT(e){for(var t=[],r=e.split(""),n=0;n<r.length;++n)t[n]=r[n].charCodeAt(0);return t}function Ws(e,t){var r={};return r.Major=e.read_shift(2),r.Minor=e.read_shift(2),t>=4&&(e.l+=t-4),r}function Az(e){var t={};return t.id=e.read_shift(0,"lpp4"),t.R=Ws(e,4),t.U=Ws(e,4),t.W=Ws(e,4),t}function Tz(e){for(var t=e.read_shift(4),r=e.l+t-4,n={},a=e.read_shift(4),i=[];a-- >0;)i.push({t:e.read_shift(4),v:e.read_shift(0,"lpp4")});if(n.name=e.read_shift(0,"lpp4"),n.comps=i,e.l!=r)throw new Error("Bad DataSpaceMapEntry: "+e.l+" != "+r);return n}function Cz(e){var t=[];e.l+=4;for(var r=e.read_shift(4);r-- >0;)t.push(Tz(e));return t}function Nz(e){var t=[];e.l+=4;for(var r=e.read_shift(4);r-- >0;)t.push(e.read_shift(0,"lpp4"));return t}function Pz(e){var t={};return e.read_shift(4),e.l+=4,t.id=e.read_shift(0,"lpp4"),t.name=e.read_shift(0,"lpp4"),t.R=Ws(e,4),t.U=Ws(e,4),t.W=Ws(e,4),t}function Lz(e){var t=Pz(e);if(t.ename=e.read_shift(0,"8lpp4"),t.blksz=e.read_shift(4),t.cmode=e.read_shift(4),e.read_shift(4)!=4)throw new Error("Bad !Primary record");return t}function MT(e,t){var r=e.l+t,n={};n.Flags=e.read_shift(4)&63,e.l+=4,n.AlgID=e.read_shift(4);var a=!1;switch(n.AlgID){case 26126:case 26127:case 26128:a=n.Flags==36;break;case 26625:a=n.Flags==4;break;case 0:a=n.Flags==16||n.Flags==4||n.Flags==36;break;default:throw"Unrecognized encryption algorithm: "+n.AlgID}if(!a)throw new Error("Encryption Flags/AlgID mismatch");return n.AlgIDHash=e.read_shift(4),n.KeySize=e.read_shift(4),n.ProviderType=e.read_shift(4),e.l+=8,n.CSPName=e.read_shift(r-e.l>>1,"utf16le"),e.l=r,n}function BT(e,t){var r={},n=e.l+t;return e.l+=4,r.Salt=e.slice(e.l,e.l+16),e.l+=16,r.Verifier=e.slice(e.l,e.l+16),e.l+=16,e.read_shift(4),r.VerifierHash=e.slice(e.l,n),e.l=n,r}function Fz(e){var t=Ws(e);switch(t.Minor){case 2:return[t.Minor,Oz(e)];case 3:return[t.Minor,Dz()];case 4:return[t.Minor,Iz(e)]}throw new Error("ECMA-376 Encrypted file unrecognized Version: "+t.Minor)}function Oz(e){var t=e.read_shift(4);if((t&63)!=36)throw new Error("EncryptionInfo mismatch");var r=e.read_shift(4),n=MT(e,r),a=BT(e,e.length-e.l);return{t:"Std",h:n,v:a}}function Dz(){throw new Error("File is password-protected: ECMA-376 Extensible")}function Iz(e){var t=["saltSize","blockSize","keyBits","hashSize","cipherAlgorithm","cipherChaining","hashAlgorithm","saltValue"];e.l+=4;var r=e.read_shift(e.length-e.l,"utf8"),n={};return r.replace(Gn,function(i){var s=yt(i);switch(ms(s[0])){case"<?xml":break;case"<encryption":case"</encryption>":break;case"<keyData":t.forEach(function(o){n[o]=s[o]});break;case"<dataIntegrity":n.encryptedHmacKey=s.encryptedHmacKey,n.encryptedHmacValue=s.encryptedHmacValue;break;case"<keyEncryptors>":case"<keyEncryptors":n.encs=[];break;case"</keyEncryptors>":break;case"<keyEncryptor":n.uri=s.uri;break;case"</keyEncryptor>":break;case"<encryptedKey":n.encs.push(s);break;default:throw s[0]}}),n}function Rz(e,t){var r={},n=r.EncryptionVersionInfo=Ws(e,4);if(t-=4,n.Minor!=2)throw new Error("unrecognized minor version code: "+n.Minor);if(n.Major>4||n.Major<2)throw new Error("unrecognized major version code: "+n.Major);r.Flags=e.read_shift(4),t-=4;var a=e.read_shift(4);return t-=4,r.EncryptionHeader=MT(e,a),t-=a,r.EncryptionVerifier=BT(e,t),r}function jz(e){var t={},r=t.EncryptionVersionInfo=Ws(e,4);if(r.Major!=1||r.Minor!=1)throw"unrecognized version code "+r.Major+" : "+r.Minor;return t.Salt=e.read_shift(16),t.EncryptedVerifier=e.read_shift(16),t.EncryptedVerifierHash=e.read_shift(16),t}function Mz(e){var t=0,r,n=jT(e),a=n.length+1,i,s,o,l,c;for(r=rl(a),r[0]=n.length,i=1;i!=a;++i)r[i]=n[i-1];for(i=a-1;i>=0;--i)s=r[i],o=t&16384?1:0,l=t<<1&32767,c=o|l,t=c^s;return t^52811}var UT=function(){var e=[187,255,255,186,255,255,185,128,0,190,15,0,191,15,0],t=[57840,7439,52380,33984,4364,3600,61902,12606,6258,57657,54287,34041,10252,43370,20163],r=[44796,19929,39858,10053,20106,40212,10761,31585,63170,64933,60267,50935,40399,11199,17763,35526,1453,2906,5812,11624,23248,885,1770,3540,7080,14160,28320,56640,55369,41139,20807,41614,21821,43642,17621,28485,56970,44341,19019,38038,14605,29210,60195,50791,40175,10751,21502,43004,24537,18387,36774,3949,7898,15796,31592,63184,47201,24803,49606,37805,14203,28406,56812,17824,35648,1697,3394,6788,13576,27152,43601,17539,35078,557,1114,2228,4456,30388,60776,51953,34243,7079,14158,28316,14128,28256,56512,43425,17251,34502,7597,13105,26210,52420,35241,883,1766,3532,4129,8258,16516,33032,4657,9314,18628],n=function(s){return(s/2|s*128)&255},a=function(s,o){return n(s^o)},i=function(s){for(var o=t[s.length-1],l=104,c=s.length-1;c>=0;--c)for(var u=s[c],f=0;f!=7;++f)u&64&&(o^=r[l]),u*=2,--l;return o};return function(s){for(var o=jT(s),l=i(o),c=o.length,u=rl(16),f=0;f!=16;++f)u[f]=0;var p,h,g;for((c&1)===1&&(p=l>>8,u[c]=a(e[0],p),--c,p=l&255,h=o[o.length-1],u[c]=a(h,p));c>0;)--c,p=l>>8,u[c]=a(o[c],p),--c,p=l&255,u[c]=a(o[c],p);for(c=15,g=15-o.length;g>0;)p=l>>8,u[c]=a(e[g],p),--c,--g,p=l&255,u[c]=a(o[c],p),--c,--g;return u}}(),Bz=function(e,t,r,n,a){a||(a=t),n||(n=UT(e));var i,s;for(i=0;i!=t.length;++i)s=t[i],s^=n[r],s=(s>>5|s<<3)&255,a[i]=s,++r;return[a,r,n]},Uz=function(e){var t=0,r=UT(e);return function(n){var a=Bz("",n,t,r);return t=a[1],a[0]}};function Vz(e,t,r,n){var a={key:Jr(e),verificationBytes:Jr(e)};return r.password&&(a.verifier=Mz(r.password)),n.valid=a.verificationBytes===a.verifier,n.valid&&(n.insitu=Uz(r.password)),a}function $z(e,t,r){var n=r||{};return n.Info=e.read_shift(2),e.l-=2,n.Info===1?n.Data=jz(e):n.Data=Rz(e,t),n}function zz(e,t,r){var n={Type:r.biff>=8?e.read_shift(2):0};return n.Type?$z(e,t-2,n):Vz(e,r.biff>=8?t:t-2,r,n),n}var Hz=function(){function e(a,i){switch(i.type){case"base64":return t(Ba(a),i);case"binary":return t(a,i);case"buffer":return t(jt&&Buffer.isBuffer(a)?a.toString("binary"):hc(a),i);case"array":return t(rc(a),i)}throw new Error("Unrecognized type "+i.type)}function t(a,i){var s=i||{},o=s.dense?[]:{},l=a.match(/\\trowd.*?\\row\b/g);if(!l.length)throw new Error("RTF missing table");var c={s:{c:0,r:0},e:{c:0,r:l.length-1}};return l.forEach(function(u,f){Array.isArray(o)&&(o[f]=[]);for(var p=/\\\w+\b/g,h=0,g,m=-1;g=p.exec(u);){switch(g[0]){case"\\cell":var b=u.slice(h,p.lastIndex-g[0].length);if(b[0]==" "&&(b=b.slice(1)),++m,b.length){var x={v:b,t:"s"};Array.isArray(o)?o[f][m]=x:o[Ct({r:f,c:m})]=x}break}h=p.lastIndex}m>c.e.c&&(c.e.c=m)}),o["!ref"]=Ut(c),o}function r(a,i){return hl(e(a,i),i)}function n(a){for(var i=["{\\rtf1\\ansi"],s=Or(a["!ref"]),o,l=Array.isArray(a),c=s.s.r;c<=s.e.r;++c){i.push("\\trowd\\trautofit1");for(var u=s.s.c;u<=s.e.c;++u)i.push("\\cellx"+(u+1));for(i.push("\\pard\\intbl"),u=s.s.c;u<=s.e.c;++u){var f=Ct({r:c,c:u});o=l?(a[c]||[])[u]:a[f],!(!o||o.v==null&&(!o.f||o.F))&&(i.push(" "+(o.w||(Zs(o),o.w))),i.push("\\cell"))}i.push("\\pard\\intbl\\row")}return i.join("")+"}"}return{to_workbook:r,to_sheet:e,from_sheet:n}}();function Wz(e){var t=e.slice(e[0]==="#"?1:0).slice(0,6);return[parseInt(t.slice(0,2),16),parseInt(t.slice(2,4),16),parseInt(t.slice(4,6),16)]}function lh(e){for(var t=0,r=1;t!=3;++t)r=r*256+(e[t]>255?255:e[t]<0?0:e[t]);return r.toString(16).toUpperCase().slice(1)}function qz(e){var t=e[0]/255,r=e[1]/255,n=e[2]/255,a=Math.max(t,r,n),i=Math.min(t,r,n),s=a-i;if(s===0)return[0,0,t];var o=0,l=0,c=a+i;switch(l=s/(c>1?2-c:c),a){case t:o=((r-n)/s+6)%6;break;case r:o=(n-t)/s+2;break;case n:o=(t-r)/s+4;break}return[o/6,l,c/2]}function Gz(e){var t=e[0],r=e[1],n=e[2],a=r*2*(n<.5?n:1-n),i=n-a/2,s=[i,i,i],o=6*t,l;if(r!==0)switch(o|0){case 0:case 6:l=a*o,s[0]+=a,s[1]+=l;break;case 1:l=a*(2-o),s[0]+=l,s[1]+=a;break;case 2:l=a*(o-2),s[1]+=a,s[2]+=l;break;case 3:l=a*(4-o),s[1]+=l,s[2]+=a;break;case 4:l=a*(o-4),s[2]+=a,s[0]+=l;break;case 5:l=a*(6-o),s[2]+=l,s[0]+=a;break}for(var c=0;c!=3;++c)s[c]=Math.round(s[c]*255);return s}function N1(e,t){if(t===0)return e;var r=qz(Wz(e));return t<0?r[2]=r[2]*(1+t):r[2]=1-(1-r[2])*(1-t),lh(Gz(r))}var VT=6,Kz=15,Xz=1,ta=VT;function P1(e){return Math.floor((e+Math.round(128/ta)/256)*ta)}function L1(e){return Math.floor((e-5)/ta*100+.5)/100}function lx(e){return Math.round((e*ta+5)/ta*256)/256}function m2(e){return lx(L1(P1(e)))}function E5(e){var t=Math.abs(e-m2(e)),r=ta;if(t>.005)for(ta=Xz;ta<Kz;++ta)Math.abs(e-m2(e))<=t&&(t=Math.abs(e-m2(e)),r=ta);ta=r}function Hu(e){e.width?(e.wpx=P1(e.width),e.wch=L1(e.wpx),e.MDW=ta):e.wpx?(e.wch=L1(e.wpx),e.width=lx(e.wch),e.MDW=ta):typeof e.wch=="number"&&(e.width=lx(e.wch),e.wpx=P1(e.width),e.MDW=ta),e.customWidth&&delete e.customWidth}var Yz=96,$T=Yz;function zT(e){return e*96/$T}function ch(e){return e*$T/96}var Jz={None:"none",Solid:"solid",Gray50:"mediumGray",Gray75:"darkGray",Gray25:"lightGray",HorzStripe:"darkHorizontal",VertStripe:"darkVertical",ReverseDiagStripe:"darkDown",DiagStripe:"darkUp",DiagCross:"darkGrid",ThickDiagCross:"darkTrellis",ThinHorzStripe:"lightHorizontal",ThinVertStripe:"lightVertical",ThinReverseDiagStripe:"lightDown",ThinHorzCross:"lightGrid"};function Qz(e,t,r,n){t.Borders=[];var a={},i=!1;(e[0].match(Gn)||[]).forEach(function(s){var o=yt(s);switch(ms(o[0])){case"<borders":case"<borders>":case"</borders>":break;case"<border":case"<border>":case"<border/>":a={},o.diagonalUp&&(a.diagonalUp=wr(o.diagonalUp)),o.diagonalDown&&(a.diagonalDown=wr(o.diagonalDown)),t.Borders.push(a);break;case"</border>":break;case"<left/>":break;case"<left":case"<left>":break;case"</left>":break;case"<right/>":break;case"<right":case"<right>":break;case"</right>":break;case"<top/>":break;case"<top":case"<top>":break;case"</top>":break;case"<bottom/>":break;case"<bottom":case"<bottom>":break;case"</bottom>":break;case"<diagonal":case"<diagonal>":case"<diagonal/>":break;case"</diagonal>":break;case"<horizontal":case"<horizontal>":case"<horizontal/>":break;case"</horizontal>":break;case"<vertical":case"<vertical>":case"<vertical/>":break;case"</vertical>":break;case"<start":case"<start>":case"<start/>":break;case"</start>":break;case"<end":case"<end>":case"<end/>":break;case"</end>":break;case"<color":case"<color>":break;case"<color/>":case"</color>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":i=!0;break;case"</ext>":i=!1;break;default:if(n&&n.WTF&&!i)throw new Error("unrecognized "+o[0]+" in borders")}})}function Zz(e,t,r,n){t.Fills=[];var a={},i=!1;(e[0].match(Gn)||[]).forEach(function(s){var o=yt(s);switch(ms(o[0])){case"<fills":case"<fills>":case"</fills>":break;case"<fill>":case"<fill":case"<fill/>":a={},t.Fills.push(a);break;case"</fill>":break;case"<gradientFill>":break;case"<gradientFill":case"</gradientFill>":t.Fills.push(a),a={};break;case"<patternFill":case"<patternFill>":o.patternType&&(a.patternType=o.patternType);break;case"<patternFill/>":case"</patternFill>":break;case"<bgColor":a.bgColor||(a.bgColor={}),o.indexed&&(a.bgColor.indexed=parseInt(o.indexed,10)),o.theme&&(a.bgColor.theme=parseInt(o.theme,10)),o.tint&&(a.bgColor.tint=parseFloat(o.tint)),o.rgb&&(a.bgColor.rgb=o.rgb.slice(-6));break;case"<bgColor/>":case"</bgColor>":break;case"<fgColor":a.fgColor||(a.fgColor={}),o.theme&&(a.fgColor.theme=parseInt(o.theme,10)),o.tint&&(a.fgColor.tint=parseFloat(o.tint)),o.rgb!=null&&(a.fgColor.rgb=o.rgb.slice(-6));break;case"<fgColor/>":case"</fgColor>":break;case"<stop":case"<stop/>":break;case"</stop>":break;case"<color":case"<color/>":break;case"</color>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":i=!0;break;case"</ext>":i=!1;break;default:if(n&&n.WTF&&!i)throw new Error("unrecognized "+o[0]+" in fills")}})}function eH(e,t,r,n){t.Fonts=[];var a={},i=!1;(e[0].match(Gn)||[]).forEach(function(s){var o=yt(s);switch(ms(o[0])){case"<fonts":case"<fonts>":case"</fonts>":break;case"<font":case"<font>":break;case"</font>":case"<font/>":t.Fonts.push(a),a={};break;case"<name":o.val&&(a.name=pr(o.val));break;case"<name/>":case"</name>":break;case"<b":a.bold=o.val?wr(o.val):1;break;case"<b/>":a.bold=1;break;case"<i":a.italic=o.val?wr(o.val):1;break;case"<i/>":a.italic=1;break;case"<u":switch(o.val){case"none":a.underline=0;break;case"single":a.underline=1;break;case"double":a.underline=2;break;case"singleAccounting":a.underline=33;break;case"doubleAccounting":a.underline=34;break}break;case"<u/>":a.underline=1;break;case"<strike":a.strike=o.val?wr(o.val):1;break;case"<strike/>":a.strike=1;break;case"<outline":a.outline=o.val?wr(o.val):1;break;case"<outline/>":a.outline=1;break;case"<shadow":a.shadow=o.val?wr(o.val):1;break;case"<shadow/>":a.shadow=1;break;case"<condense":a.condense=o.val?wr(o.val):1;break;case"<condense/>":a.condense=1;break;case"<extend":a.extend=o.val?wr(o.val):1;break;case"<extend/>":a.extend=1;break;case"<sz":o.val&&(a.sz=+o.val);break;case"<sz/>":case"</sz>":break;case"<vertAlign":o.val&&(a.vertAlign=o.val);break;case"<vertAlign/>":case"</vertAlign>":break;case"<family":o.val&&(a.family=parseInt(o.val,10));break;case"<family/>":case"</family>":break;case"<scheme":o.val&&(a.scheme=o.val);break;case"<scheme/>":case"</scheme>":break;case"<charset":if(o.val=="1")break;o.codepage=o5[parseInt(o.val,10)];break;case"<color":if(a.color||(a.color={}),o.auto&&(a.color.auto=wr(o.auto)),o.rgb)a.color.rgb=o.rgb.slice(-6);else if(o.indexed){a.color.index=parseInt(o.indexed,10);var l=Gl[a.color.index];a.color.index==81&&(l=Gl[1]),l||(l=Gl[1]),a.color.rgb=l[0].toString(16)+l[1].toString(16)+l[2].toString(16)}else o.theme&&(a.color.theme=parseInt(o.theme,10),o.tint&&(a.color.tint=parseFloat(o.tint)),o.theme&&r.themeElements&&r.themeElements.clrScheme&&(a.color.rgb=N1(r.themeElements.clrScheme[a.color.theme].rgb,a.color.tint||0)));break;case"<color/>":case"</color>":break;case"<AlternateContent":i=!0;break;case"</AlternateContent>":i=!1;break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":i=!0;break;case"</ext>":i=!1;break;default:if(n&&n.WTF&&!i)throw new Error("unrecognized "+o[0]+" in fonts")}})}function tH(e,t,r){t.NumberFmt=[];for(var n=hs(Ft),a=0;a<n.length;++a)t.NumberFmt[n[a]]=Ft[n[a]];var i=e[0].match(Gn);if(i)for(a=0;a<i.length;++a){var s=yt(i[a]);switch(ms(s[0])){case"<numFmts":case"</numFmts>":case"<numFmts/>":case"<numFmts>":break;case"<numFmt":{var o=Ht(pr(s.formatCode)),l=parseInt(s.numFmtId,10);if(t.NumberFmt[l]=o,l>0){if(l>392){for(l=392;l>60&&t.NumberFmt[l]!=null;--l);t.NumberFmt[l]=o}ql(o,l)}}break;case"</numFmt>":break;default:if(r.WTF)throw new Error("unrecognized "+s[0]+" in numFmts")}}}var op=["numFmtId","fillId","fontId","borderId","xfId"],lp=["applyAlignment","applyBorder","applyFill","applyFont","applyNumberFormat","applyProtection","pivotButton","quotePrefix"];function rH(e,t,r){t.CellXf=[];var n,a=!1;(e[0].match(Gn)||[]).forEach(function(i){var s=yt(i),o=0;switch(ms(s[0])){case"<cellXfs":case"<cellXfs>":case"<cellXfs/>":case"</cellXfs>":break;case"<xf":case"<xf/>":for(n=s,delete n[0],o=0;o<op.length;++o)n[op[o]]&&(n[op[o]]=parseInt(n[op[o]],10));for(o=0;o<lp.length;++o)n[lp[o]]&&(n[lp[o]]=wr(n[lp[o]]));if(t.NumberFmt&&n.numFmtId>392){for(o=392;o>60;--o)if(t.NumberFmt[n.numFmtId]==t.NumberFmt[o]){n.numFmtId=o;break}}t.CellXf.push(n);break;case"</xf>":break;case"<alignment":case"<alignment/>":var l={};s.vertical&&(l.vertical=s.vertical),s.horizontal&&(l.horizontal=s.horizontal),s.textRotation!=null&&(l.textRotation=s.textRotation),s.indent&&(l.indent=s.indent),s.wrapText&&(l.wrapText=wr(s.wrapText)),n.alignment=l;break;case"</alignment>":break;case"<protection":break;case"</protection>":case"<protection/>":break;case"<AlternateContent":a=!0;break;case"</AlternateContent>":a=!1;break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":a=!0;break;case"</ext>":a=!1;break;default:if(r&&r.WTF&&!a)throw new Error("unrecognized "+s[0]+" in cellXfs")}})}var nH=function(){var t=/<(?:\w+:)?numFmts([^>]*)>[\S\s]*?<\/(?:\w+:)?numFmts>/,r=/<(?:\w+:)?cellXfs([^>]*)>[\S\s]*?<\/(?:\w+:)?cellXfs>/,n=/<(?:\w+:)?fills([^>]*)>[\S\s]*?<\/(?:\w+:)?fills>/,a=/<(?:\w+:)?fonts([^>]*)>[\S\s]*?<\/(?:\w+:)?fonts>/,i=/<(?:\w+:)?borders([^>]*)>[\S\s]*?<\/(?:\w+:)?borders>/;return function(o,l,c){var u={};if(!o)return u;o=o.replace(/<!--([\s\S]*?)-->/mg,"").replace(/<!DOCTYPE[^\[]*\[[^\]]*\]>/gm,"");var f;return(f=o.match(t))&&tH(f,u,c),(f=o.match(a))&&eH(f,u,l,c),(f=o.match(n))&&Zz(f,u,l,c),(f=o.match(i))&&Qz(f,u,l,c),(f=o.match(r))&&rH(f,u,c),u}}();function aH(e,t){var r=e.read_shift(2),n=Hn(e);return[r,n]}function iH(e,t,r){var n={};n.sz=e.read_shift(2)/20;var a=mV(e);a.fItalic&&(n.italic=1),a.fCondense&&(n.condense=1),a.fExtend&&(n.extend=1),a.fShadow&&(n.shadow=1),a.fOutline&&(n.outline=1),a.fStrikeout&&(n.strike=1);var i=e.read_shift(2);switch(i===700&&(n.bold=1),e.read_shift(2)){case 1:n.vertAlign="superscript";break;case 2:n.vertAlign="subscript";break}var s=e.read_shift(1);s!=0&&(n.underline=s);var o=e.read_shift(1);o>0&&(n.family=o);var l=e.read_shift(1);switch(l>0&&(n.charset=l),e.l++,n.color=pV(e),e.read_shift(1)){case 1:n.scheme="major";break;case 2:n.scheme="minor";break}return n.name=Hn(e),n}var sH=qn;function oH(e,t){var r=e.l+t,n=e.read_shift(2),a=e.read_shift(2);return e.l=r,{ixfe:n,numFmtId:a}}var lH=qn;function cH(e,t,r){var n={};n.NumberFmt=[];for(var a in Ft)n.NumberFmt[a]=Ft[a];n.CellXf=[],n.Fonts=[];var i=[],s=!1;return no(e,function(l,c,u){switch(u){case 44:n.NumberFmt[l[0]]=l[1],ql(l[1],l[0]);break;case 43:n.Fonts.push(l),l.color.theme!=null&&t&&t.themeElements&&t.themeElements.clrScheme&&(l.color.rgb=N1(t.themeElements.clrScheme[l.color.theme].rgb,l.color.tint||0));break;case 1025:break;case 45:break;case 46:break;case 47:i[i.length-1]==617&&n.CellXf.push(l);break;case 48:case 507:case 572:case 475:break;case 1171:case 2102:case 1130:case 512:case 2095:case 3072:break;case 35:s=!0;break;case 36:s=!1;break;case 37:i.push(u),s=!0;break;case 38:i.pop(),s=!1;break;default:if(c.T>0)i.push(u);else if(c.T<0)i.pop();else if(!s||r.WTF&&i[i.length-1]!=37)throw new Error("Unexpected record 0x"+u.toString(16))}}),n}var uH=["</a:lt1>","</a:dk1>","</a:lt2>","</a:dk2>","</a:accent1>","</a:accent2>","</a:accent3>","</a:accent4>","</a:accent5>","</a:accent6>","</a:hlink>","</a:folHlink>"];function fH(e,t,r){t.themeElements.clrScheme=[];var n={};(e[0].match(Gn)||[]).forEach(function(a){var i=yt(a);switch(i[0]){case"<a:clrScheme":case"</a:clrScheme>":break;case"<a:srgbClr":n.rgb=i.val;break;case"<a:sysClr":n.rgb=i.lastClr;break;case"<a:dk1>":case"</a:dk1>":case"<a:lt1>":case"</a:lt1>":case"<a:dk2>":case"</a:dk2>":case"<a:lt2>":case"</a:lt2>":case"<a:accent1>":case"</a:accent1>":case"<a:accent2>":case"</a:accent2>":case"<a:accent3>":case"</a:accent3>":case"<a:accent4>":case"</a:accent4>":case"<a:accent5>":case"</a:accent5>":case"<a:accent6>":case"</a:accent6>":case"<a:hlink>":case"</a:hlink>":case"<a:folHlink>":case"</a:folHlink>":i[0].charAt(1)==="/"?(t.themeElements.clrScheme[uH.indexOf(i[0])]=n,n={}):n.name=i[0].slice(3,i[0].length-1);break;default:if(r&&r.WTF)throw new Error("Unrecognized "+i[0]+" in clrScheme")}})}function hH(){}function dH(){}var pH=/<a:clrScheme([^>]*)>[\s\S]*<\/a:clrScheme>/,mH=/<a:fontScheme([^>]*)>[\s\S]*<\/a:fontScheme>/,gH=/<a:fmtScheme([^>]*)>[\s\S]*<\/a:fmtScheme>/;function vH(e,t,r){t.themeElements={};var n;[["clrScheme",pH,fH],["fontScheme",mH,hH],["fmtScheme",gH,dH]].forEach(function(a){if(!(n=e.match(a[1])))throw new Error(a[0]+" not found in themeElements");a[2](n,t,r)})}var xH=/<a:themeElements([^>]*)>[\s\S]*<\/a:themeElements>/;function HT(e,t){(!e||e.length===0)&&(e=yH());var r,n={};if(!(r=e.match(xH)))throw new Error("themeElements not found in theme");return vH(r[0],n,t),n.raw=e,n}function yH(e,t){var r=[tT];return r[r.length]='<a:theme xmlns:a="http://schemas.openxmlformats.org/drawingml/2006/main" name="Office Theme">',r[r.length]="<a:themeElements>",r[r.length]='<a:clrScheme name="Office">',r[r.length]='<a:dk1><a:sysClr val="windowText" lastClr="000000"/></a:dk1>',r[r.length]='<a:lt1><a:sysClr val="window" lastClr="FFFFFF"/></a:lt1>',r[r.length]='<a:dk2><a:srgbClr val="1F497D"/></a:dk2>',r[r.length]='<a:lt2><a:srgbClr val="EEECE1"/></a:lt2>',r[r.length]='<a:accent1><a:srgbClr val="4F81BD"/></a:accent1>',r[r.length]='<a:accent2><a:srgbClr val="C0504D"/></a:accent2>',r[r.length]='<a:accent3><a:srgbClr val="9BBB59"/></a:accent3>',r[r.length]='<a:accent4><a:srgbClr val="8064A2"/></a:accent4>',r[r.length]='<a:accent5><a:srgbClr val="4BACC6"/></a:accent5>',r[r.length]='<a:accent6><a:srgbClr val="F79646"/></a:accent6>',r[r.length]='<a:hlink><a:srgbClr val="0000FF"/></a:hlink>',r[r.length]='<a:folHlink><a:srgbClr val="800080"/></a:folHlink>',r[r.length]="</a:clrScheme>",r[r.length]='<a:fontScheme name="Office">',r[r.length]="<a:majorFont>",r[r.length]='<a:latin typeface="Cambria"/>',r[r.length]='<a:ea typeface=""/>',r[r.length]='<a:cs typeface=""/>',r[r.length]='<a:font script="Jpan" typeface=" "/>',r[r.length]='<a:font script="Hang" typeface=" "/>',r[r.length]='<a:font script="Hans" typeface=""/>',r[r.length]='<a:font script="Hant" typeface=""/>',r[r.length]='<a:font script="Arab" typeface="Times New Roman"/>',r[r.length]='<a:font script="Hebr" typeface="Times New Roman"/>',r[r.length]='<a:font script="Thai" typeface="Tahoma"/>',r[r.length]='<a:font script="Ethi" typeface="Nyala"/>',r[r.length]='<a:font script="Beng" typeface="Vrinda"/>',r[r.length]='<a:font script="Gujr" typeface="Shruti"/>',r[r.length]='<a:font script="Khmr" typeface="MoolBoran"/>',r[r.length]='<a:font script="Knda" typeface="Tunga"/>',r[r.length]='<a:font script="Guru" typeface="Raavi"/>',r[r.length]='<a:font script="Cans" typeface="Euphemia"/>',r[r.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',r[r.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',r[r.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',r[r.length]='<a:font script="Thaa" typeface="MV Boli"/>',r[r.length]='<a:font script="Deva" typeface="Mangal"/>',r[r.length]='<a:font script="Telu" typeface="Gautami"/>',r[r.length]='<a:font script="Taml" typeface="Latha"/>',r[r.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',r[r.length]='<a:font script="Orya" typeface="Kalinga"/>',r[r.length]='<a:font script="Mlym" typeface="Kartika"/>',r[r.length]='<a:font script="Laoo" typeface="DokChampa"/>',r[r.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',r[r.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',r[r.length]='<a:font script="Viet" typeface="Times New Roman"/>',r[r.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',r[r.length]='<a:font script="Geor" typeface="Sylfaen"/>',r[r.length]="</a:majorFont>",r[r.length]="<a:minorFont>",r[r.length]='<a:latin typeface="Calibri"/>',r[r.length]='<a:ea typeface=""/>',r[r.length]='<a:cs typeface=""/>',r[r.length]='<a:font script="Jpan" typeface=" "/>',r[r.length]='<a:font script="Hang" typeface=" "/>',r[r.length]='<a:font script="Hans" typeface=""/>',r[r.length]='<a:font script="Hant" typeface=""/>',r[r.length]='<a:font script="Arab" typeface="Arial"/>',r[r.length]='<a:font script="Hebr" typeface="Arial"/>',r[r.length]='<a:font script="Thai" typeface="Tahoma"/>',r[r.length]='<a:font script="Ethi" typeface="Nyala"/>',r[r.length]='<a:font script="Beng" typeface="Vrinda"/>',r[r.length]='<a:font script="Gujr" typeface="Shruti"/>',r[r.length]='<a:font script="Khmr" typeface="DaunPenh"/>',r[r.length]='<a:font script="Knda" typeface="Tunga"/>',r[r.length]='<a:font script="Guru" typeface="Raavi"/>',r[r.length]='<a:font script="Cans" typeface="Euphemia"/>',r[r.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',r[r.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',r[r.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',r[r.length]='<a:font script="Thaa" typeface="MV Boli"/>',r[r.length]='<a:font script="Deva" typeface="Mangal"/>',r[r.length]='<a:font script="Telu" typeface="Gautami"/>',r[r.length]='<a:font script="Taml" typeface="Latha"/>',r[r.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',r[r.length]='<a:font script="Orya" typeface="Kalinga"/>',r[r.length]='<a:font script="Mlym" typeface="Kartika"/>',r[r.length]='<a:font script="Laoo" typeface="DokChampa"/>',r[r.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',r[r.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',r[r.length]='<a:font script="Viet" typeface="Arial"/>',r[r.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',r[r.length]='<a:font script="Geor" typeface="Sylfaen"/>',r[r.length]="</a:minorFont>",r[r.length]="</a:fontScheme>",r[r.length]='<a:fmtScheme name="Office">',r[r.length]="<a:fillStyleLst>",r[r.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="50000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="35000"><a:schemeClr val="phClr"><a:tint val="37000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="15000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:lin ang="16200000" scaled="1"/>',r[r.length]="</a:gradFill>",r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="100000"/><a:shade val="100000"/><a:satMod val="130000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="50000"/><a:shade val="100000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:lin ang="16200000" scaled="0"/>',r[r.length]="</a:gradFill>",r[r.length]="</a:fillStyleLst>",r[r.length]="<a:lnStyleLst>",r[r.length]='<a:ln w="9525" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"><a:shade val="95000"/><a:satMod val="105000"/></a:schemeClr></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]='<a:ln w="25400" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]='<a:ln w="38100" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]="</a:lnStyleLst>",r[r.length]="<a:effectStyleLst>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="20000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="38000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]="</a:effectStyle>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]="</a:effectStyle>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]='<a:scene3d><a:camera prst="orthographicFront"><a:rot lat="0" lon="0" rev="0"/></a:camera><a:lightRig rig="threePt" dir="t"><a:rot lat="0" lon="0" rev="1200000"/></a:lightRig></a:scene3d>',r[r.length]='<a:sp3d><a:bevelT w="63500" h="25400"/></a:sp3d>',r[r.length]="</a:effectStyle>",r[r.length]="</a:effectStyleLst>",r[r.length]="<a:bgFillStyleLst>",r[r.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="40000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="40000"><a:schemeClr val="phClr"><a:tint val="45000"/><a:shade val="99000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="20000"/><a:satMod val="255000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:path path="circle"><a:fillToRect l="50000" t="-80000" r="50000" b="180000"/></a:path>',r[r.length]="</a:gradFill>",r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="80000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="30000"/><a:satMod val="200000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:path path="circle"><a:fillToRect l="50000" t="50000" r="50000" b="50000"/></a:path>',r[r.length]="</a:gradFill>",r[r.length]="</a:bgFillStyleLst>",r[r.length]="</a:fmtScheme>",r[r.length]="</a:themeElements>",r[r.length]="<a:objectDefaults>",r[r.length]="<a:spDef>",r[r.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="1"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="3"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="2"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="lt1"/></a:fontRef></a:style>',r[r.length]="</a:spDef>",r[r.length]="<a:lnDef>",r[r.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="2"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="0"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="1"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="tx1"/></a:fontRef></a:style>',r[r.length]="</a:lnDef>",r[r.length]="</a:objectDefaults>",r[r.length]="<a:extraClrSchemeLst/>",r[r.length]="</a:theme>",r.join("")}function wH(e,t,r){var n=e.l+t,a=e.read_shift(4);if(a!==124226){if(!r.cellStyles){e.l=n;return}var i=e.slice(e.l);e.l=n;var s;try{s=eT(i,{type:"array"})}catch{return}var o=Oa(s,"theme/theme/theme1.xml",!0);if(o)return HT(o,r)}}function bH(e){return e.read_shift(4)}function _H(e){var t={};switch(t.xclrType=e.read_shift(2),t.nTintShade=e.read_shift(2),t.xclrType){case 0:e.l+=4;break;case 1:t.xclrValue=SH(e,4);break;case 2:t.xclrValue=PT(e);break;case 3:t.xclrValue=bH(e);break;case 4:e.l+=4;break}return e.l+=8,t}function SH(e,t){return qn(e,t)}function kH(e,t){return qn(e,t)}function EH(e){var t=e.read_shift(2),r=e.read_shift(2)-4,n=[t];switch(t){case 4:case 5:case 7:case 8:case 9:case 10:case 11:case 13:n[1]=_H(e);break;case 6:n[1]=kH(e,r);break;case 14:case 15:n[1]=e.read_shift(r===1?1:2);break;default:throw new Error("Unrecognized ExtProp type: "+t+" "+r)}return n}function AH(e,t){var r=e.l+t;e.l+=2;var n=e.read_shift(2);e.l+=2;for(var a=e.read_shift(2),i=[];a-- >0;)i.push(EH(e,r-e.l));return{ixfe:n,ext:i}}function TH(e,t){t.forEach(function(r){switch(r[0]){}})}function CH(e,t){return{flags:e.read_shift(4),version:e.read_shift(4),name:Hn(e)}}function NH(e){for(var t=[],r=e.read_shift(4);r-- >0;)t.push([e.read_shift(4),e.read_shift(4)]);return t}function PH(e){return e.l+=4,e.read_shift(4)!=0}function LH(e,t,r){var n={Types:[],Cell:[],Value:[]},a=r||{},i=[],s=!1,o=2;return no(e,function(l,c,u){switch(u){case 335:n.Types.push({name:l.name});break;case 51:l.forEach(function(f){o==1?n.Cell.push({type:n.Types[f[0]-1].name,index:f[1]}):o==0&&n.Value.push({type:n.Types[f[0]-1].name,index:f[1]})});break;case 337:o=l?1:0;break;case 338:o=2;break;case 35:i.push(u),s=!0;break;case 36:i.pop(),s=!1;break;default:if(!c.T){if(!s||a.WTF&&i[i.length-1]!=35)throw new Error("Unexpected record 0x"+u.toString(16))}}}),n}function FH(e,t,r){var n={Types:[],Cell:[],Value:[]};if(!e)return n;var a=!1,i=2,s;return e.replace(Gn,function(o){var l=yt(o);switch(ms(l[0])){case"<?xml":break;case"<metadata":case"</metadata>":break;case"<metadataTypes":case"</metadataTypes>":break;case"<metadataType":n.Types.push({name:l.name});break;case"</metadataType>":break;case"<futureMetadata":for(var c=0;c<n.Types.length;++c)n.Types[c].name==l.name&&(s=n.Types[c]);break;case"</futureMetadata>":break;case"<bk>":break;case"</bk>":break;case"<rc":i==1?n.Cell.push({type:n.Types[l.t-1].name,index:+l.v}):i==0&&n.Value.push({type:n.Types[l.t-1].name,index:+l.v});break;case"</rc>":break;case"<cellMetadata":i=1;break;case"</cellMetadata>":i=2;break;case"<valueMetadata":i=0;break;case"</valueMetadata>":i=2;break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":a=!0;break;case"</ext>":a=!1;break;case"<rvb":if(!s)break;s.offsets||(s.offsets=[]),s.offsets.push(+l.i);break;default:if(!a&&r.WTF)throw new Error("unrecognized "+l[0]+" in metadata")}return o}),n}function OH(e){var t=[];if(!e)return t;var r=1;return(e.match(Gn)||[]).forEach(function(n){var a=yt(n);switch(a[0]){case"<?xml":break;case"<calcChain":case"<calcChain>":case"</calcChain>":break;case"<c":delete a[0],a.i?r=a.i:a.i=r,t.push(a);break}}),t}function DH(e){var t={};t.i=e.read_shift(4);var r={};r.r=e.read_shift(4),r.c=e.read_shift(4),t.r=Ct(r);var n=e.read_shift(1);return n&2&&(t.l="1"),n&8&&(t.a="1"),t}function IH(e,t,r){var n=[];return no(e,function(i,s,o){switch(o){case 63:n.push(i);break;default:if(!s.T)throw new Error("Unexpected record 0x"+o.toString(16))}}),n}function RH(e,t,r,n){if(!e)return e;var a=n||{},i=!1;no(e,function(o,l,c){switch(c){case 359:case 363:case 364:case 366:case 367:case 368:case 369:case 370:case 371:case 472:case 577:case 578:case 579:case 580:case 581:case 582:case 583:case 584:case 585:case 586:case 587:break;case 35:i=!0;break;case 36:i=!1;break;default:if(!l.T){if(!i||a.WTF)throw new Error("Unexpected record 0x"+c.toString(16))}}},a)}function jH(e,t){if(!e)return"??";var r=(e.match(/<c:chart [^>]*r:id="([^"]*)"/)||["",""])[1];return t["!id"][r].Target}function G3(e,t,r,n){var a=Array.isArray(e),i;t.forEach(function(s){var o=ra(s.ref);if(a?(e[o.r]||(e[o.r]=[]),i=e[o.r][o.c]):i=e[s.ref],!i){i={t:"z"},a?e[o.r][o.c]=i:e[s.ref]=i;var l=Or(e["!ref"]||"BDWGO1000001:A1");l.s.r>o.r&&(l.s.r=o.r),l.e.r<o.r&&(l.e.r=o.r),l.s.c>o.c&&(l.s.c=o.c),l.e.c<o.c&&(l.e.c=o.c);var c=Ut(l);c!==e["!ref"]&&(e["!ref"]=c)}i.c||(i.c=[]);var u={a:s.author,t:s.t,r:s.r,T:r};s.h&&(u.h=s.h);for(var f=i.c.length-1;f>=0;--f){if(!r&&i.c[f].T)return;r&&!i.c[f].T&&i.c.splice(f,1)}if(r&&n){for(f=0;f<n.length;++f)if(u.a==n[f].id){u.a=n[f].name||u.a;break}}i.c.push(u)})}function MH(e,t){if(e.match(/<(?:\w+:)?comments *\/>/))return[];var r=[],n=[],a=e.match(/<(?:\w+:)?authors>([\s\S]*)<\/(?:\w+:)?authors>/);a&&a[1]&&a[1].split(/<\/\w*:?author>/).forEach(function(s){if(!(s===""||s.trim()==="")){var o=s.match(/<(?:\w+:)?author[^>]*>(.*)/);o&&r.push(o[1])}});var i=e.match(/<(?:\w+:)?commentList>([\s\S]*)<\/(?:\w+:)?commentList>/);return i&&i[1]&&i[1].split(/<\/\w*:?comment>/).forEach(function(s){if(!(s===""||s.trim()==="")){var o=s.match(/<(?:\w+:)?comment[^>]*>/);if(o){var l=yt(o[0]),c={author:l.authorId&&r[l.authorId]||"sheetjsghost",ref:l.ref,guid:l.guid},u=ra(l.ref);if(!(t.sheetRows&&t.sheetRows<=u.r)){var f=s.match(/<(?:\w+:)?text>([\s\S]*)<\/(?:\w+:)?text>/),p=!!f&&!!f[1]&&k5(f[1])||{r:"",t:"",h:""};c.r=p.r,p.r=="<t></t>"&&(p.t=p.h=""),c.t=(p.t||"").replace(/\r\n/g,`
`).replace(/\r/g,`
`),t.cellHTML&&(c.h=p.h),n.push(c)}}}}),n}function BH(e,t){var r=[],n=!1,a={},i=0;return e.replace(Gn,function(o,l){var c=yt(o);switch(ms(c[0])){case"<?xml":break;case"<ThreadedComments":break;case"</ThreadedComments>":break;case"<threadedComment":a={author:c.personId,guid:c.id,ref:c.ref,T:1};break;case"</threadedComment>":a.t!=null&&r.push(a);break;case"<text>":case"<text":i=l+o.length;break;case"</text>":a.t=e.slice(i,l).replace(/\r\n/g,`
`).replace(/\r/g,`
`);break;case"<mentions":case"<mentions>":n=!0;break;case"</mentions>":n=!1;break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":n=!0;break;case"</ext>":n=!1;break;default:if(!n&&t.WTF)throw new Error("unrecognized "+c[0]+" in threaded comments")}return o}),r}function UH(e,t){var r=[],n=!1;return e.replace(Gn,function(i){var s=yt(i);switch(ms(s[0])){case"<?xml":break;case"<personList":break;case"</personList>":break;case"<person":r.push({name:s.displayname,id:s.id});break;case"</person>":break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":n=!0;break;case"</ext>":n=!1;break;default:if(!n&&t.WTF)throw new Error("unrecognized "+s[0]+" in threaded comments")}return i}),r}function VH(e){var t={};t.iauthor=e.read_shift(4);var r=pc(e);return t.rfx=r.s,t.ref=Ct(r.s),e.l+=16,t}var $H=Hn;function zH(e,t){var r=[],n=[],a={},i=!1;return no(e,function(o,l,c){switch(c){case 632:n.push(o);break;case 635:a=o;break;case 637:a.t=o.t,a.h=o.h,a.r=o.r;break;case 636:if(a.author=n[a.iauthor],delete a.iauthor,t.sheetRows&&a.rfx&&t.sheetRows<=a.rfx.r)break;a.t||(a.t=""),delete a.rfx,r.push(a);break;case 3072:break;case 35:i=!0;break;case 36:i=!1;break;case 37:break;case 38:break;default:if(!l.T){if(!i||t.WTF)throw new Error("Unexpected record 0x"+c.toString(16))}}}),r}var HH="application/vnd.ms-office.vbaProject";function WH(e){var t=Bt.utils.cfb_new({root:"R"});return e.FullPaths.forEach(function(r,n){if(!(r.slice(-1)==="/"||!r.match(/_VBA_PROJECT_CUR/))){var a=r.replace(/^[^\/]*/,"R").replace(/\/_VBA_PROJECT_CUR\u0000*/,"");Bt.utils.cfb_add(t,a,e.FileIndex[n].content)}}),Bt.write(t)}function qH(){return{"!type":"dialog"}}function GH(){return{"!type":"dialog"}}function KH(){return{"!type":"macro"}}function XH(){return{"!type":"macro"}}var ku=function(){var e=/(^|[^A-Za-z_])R(\[?-?\d+\]|[1-9]\d*|)C(\[?-?\d+\]|[1-9]\d*|)(?![A-Za-z0-9_])/g,t={r:0,c:0};function r(n,a,i,s){var o=!1,l=!1;i.length==0?l=!0:i.charAt(0)=="["&&(l=!0,i=i.slice(1,-1)),s.length==0?o=!0:s.charAt(0)=="["&&(o=!0,s=s.slice(1,-1));var c=i.length>0?parseInt(i,10)|0:0,u=s.length>0?parseInt(s,10)|0:0;return o?u+=t.c:--u,l?c+=t.r:--c,a+(o?"":"$")+sn(u)+(l?"":"$")+kn(c)}return function(a,i){return t=i,a.replace(e,r)}}(),WT=/(^|[^._A-Z0-9])([$]?)([A-Z]{1,2}|[A-W][A-Z]{2}|X[A-E][A-Z]|XF[A-D])([$]?)(10[0-3]\d{4}|104[0-7]\d{3}|1048[0-4]\d{2}|10485[0-6]\d|104857[0-6]|[1-9]\d{0,5})(?![_.\(A-Za-z0-9])/g,YH=function(){return function(t,r){return t.replace(WT,function(n,a,i,s,o,l){var c=x5(s)-(i?0:r.c),u=v5(l)-(o?0:r.r),f=u==0?"":o?u+1:"["+u+"]",p=c==0?"":i?c+1:"["+c+"]";return a+"R"+f+"C"+p})}}();function qT(e,t){return e.replace(WT,function(r,n,a,i,s,o){return n+(a=="$"?a+i:sn(x5(i)+t.c))+(s=="$"?s+o:kn(v5(o)+t.r))})}function JH(e,t,r){var n=ef(t),a=n.s,i=ra(r),s={r:i.r-a.r,c:i.c-a.c};return qT(e,s)}function QH(e){return e.length!=1}function K3(e){return e.replace(/_xlfn\./g,"")}function Kr(e){e.l+=1}function nl(e,t){var r=e.read_shift(2);return[r&16383,r>>14&1,r>>15&1]}function GT(e,t,r){var n=2;if(r){if(r.biff>=2&&r.biff<=5)return KT(e);r.biff==12&&(n=4)}var a=e.read_shift(n),i=e.read_shift(n),s=nl(e),o=nl(e);return{s:{r:a,c:s[0],cRel:s[1],rRel:s[2]},e:{r:i,c:o[0],cRel:o[1],rRel:o[2]}}}function KT(e){var t=nl(e),r=nl(e),n=e.read_shift(1),a=e.read_shift(1);return{s:{r:t[0],c:n,cRel:t[1],rRel:t[2]},e:{r:r[0],c:a,cRel:r[1],rRel:r[2]}}}function ZH(e,t,r){if(r.biff<8)return KT(e);var n=e.read_shift(r.biff==12?4:2),a=e.read_shift(r.biff==12?4:2),i=nl(e),s=nl(e);return{s:{r:n,c:i[0],cRel:i[1],rRel:i[2]},e:{r:a,c:s[0],cRel:s[1],rRel:s[2]}}}function XT(e,t,r){if(r&&r.biff>=2&&r.biff<=5)return eW(e);var n=e.read_shift(r&&r.biff==12?4:2),a=nl(e);return{r:n,c:a[0],cRel:a[1],rRel:a[2]}}function eW(e){var t=nl(e),r=e.read_shift(1);return{r:t[0],c:r,cRel:t[1],rRel:t[2]}}function tW(e){var t=e.read_shift(2),r=e.read_shift(2);return{r:t,c:r&255,fQuoted:!!(r&16384),cRel:r>>15,rRel:r>>15}}function rW(e,t,r){var n=r&&r.biff?r.biff:8;if(n>=2&&n<=5)return nW(e);var a=e.read_shift(n>=12?4:2),i=e.read_shift(2),s=(i&16384)>>14,o=(i&32768)>>15;if(i&=16383,o==1)for(;a>524287;)a-=1048576;if(s==1)for(;i>8191;)i=i-16384;return{r:a,c:i,cRel:s,rRel:o}}function nW(e){var t=e.read_shift(2),r=e.read_shift(1),n=(t&32768)>>15,a=(t&16384)>>14;return t&=16383,n==1&&t>=8192&&(t=t-16384),a==1&&r>=128&&(r=r-256),{r:t,c:r,cRel:a,rRel:n}}function aW(e,t,r){var n=(e[e.l++]&96)>>5,a=GT(e,r.biff>=2&&r.biff<=5?6:8,r);return[n,a]}function iW(e,t,r){var n=(e[e.l++]&96)>>5,a=e.read_shift(2,"i"),i=8;if(r)switch(r.biff){case 5:e.l+=12,i=6;break;case 12:i=12;break}var s=GT(e,i,r);return[n,a,s]}function sW(e,t,r){var n=(e[e.l++]&96)>>5;return e.l+=r&&r.biff>8?12:r.biff<8?6:8,[n]}function oW(e,t,r){var n=(e[e.l++]&96)>>5,a=e.read_shift(2),i=8;if(r)switch(r.biff){case 5:e.l+=12,i=6;break;case 12:i=12;break}return e.l+=i,[n,a]}function lW(e,t,r){var n=(e[e.l++]&96)>>5,a=ZH(e,t-1,r);return[n,a]}function cW(e,t,r){var n=(e[e.l++]&96)>>5;return e.l+=r.biff==2?6:r.biff==12?14:7,[n]}function X3(e){var t=e[e.l+1]&1,r=1;return e.l+=4,[t,r]}function uW(e,t,r){e.l+=2;for(var n=e.read_shift(r&&r.biff==2?1:2),a=[],i=0;i<=n;++i)a.push(e.read_shift(r&&r.biff==2?1:2));return a}function fW(e,t,r){var n=e[e.l+1]&255?1:0;return e.l+=2,[n,e.read_shift(r&&r.biff==2?1:2)]}function hW(e,t,r){var n=e[e.l+1]&255?1:0;return e.l+=2,[n,e.read_shift(r&&r.biff==2?1:2)]}function dW(e){var t=e[e.l+1]&255?1:0;return e.l+=2,[t,e.read_shift(2)]}function pW(e,t,r){var n=e[e.l+1]&255?1:0;return e.l+=r&&r.biff==2?3:4,[n]}function YT(e){var t=e.read_shift(1),r=e.read_shift(1);return[t,r]}function mW(e){return e.read_shift(2),YT(e)}function gW(e){return e.read_shift(2),YT(e)}function vW(e,t,r){var n=(e[e.l]&96)>>5;e.l+=1;var a=XT(e,0,r);return[n,a]}function xW(e,t,r){var n=(e[e.l]&96)>>5;e.l+=1;var a=rW(e,0,r);return[n,a]}function yW(e,t,r){var n=(e[e.l]&96)>>5;e.l+=1;var a=e.read_shift(2);r&&r.biff==5&&(e.l+=12);var i=XT(e,0,r);return[n,a,i]}function wW(e,t,r){var n=(e[e.l]&96)>>5;e.l+=1;var a=e.read_shift(r&&r.biff<=3?1:2);return[bq[a],ZT[a],n]}function bW(e,t,r){var n=e[e.l++],a=e.read_shift(1),i=r&&r.biff<=3?[n==88?-1:0,e.read_shift(1)]:_W(e);return[a,(i[0]===0?ZT:wq)[i[1]]]}function _W(e){return[e[e.l+1]>>7,e.read_shift(2)&32767]}function SW(e,t,r){e.l+=r&&r.biff==2?3:4}function kW(e,t,r){if(e.l++,r&&r.biff==12)return[e.read_shift(4,"i"),0];var n=e.read_shift(2),a=e.read_shift(r&&r.biff==2?1:2);return[n,a]}function EW(e){return e.l++,mc[e.read_shift(1)]}function AW(e){return e.l++,e.read_shift(2)}function TW(e){return e.l++,e.read_shift(1)!==0}function CW(e){return e.l++,Vn(e)}function NW(e,t,r){return e.l++,Oh(e,t-1,r)}function PW(e,t){var r=[e.read_shift(1)];if(t==12)switch(r[0]){case 2:r[0]=4;break;case 4:r[0]=16;break;case 0:r[0]=1;break;case 1:r[0]=2;break}switch(r[0]){case 4:r[1]=Mr(e,1)?"TRUE":"FALSE",t!=12&&(e.l+=7);break;case 37:case 16:r[1]=mc[e[e.l]],e.l+=t==12?4:8;break;case 0:e.l+=8;break;case 1:r[1]=Vn(e);break;case 2:r[1]=gc(e,0,{biff:t>0&&t<8?2:t});break;default:throw new Error("Bad SerAr: "+r[0])}return r}function LW(e,t,r){for(var n=e.read_shift(r.biff==12?4:2),a=[],i=0;i!=n;++i)a.push((r.biff==12?pc:Cm)(e));return a}function FW(e,t,r){var n=0,a=0;r.biff==12?(n=e.read_shift(4),a=e.read_shift(4)):(a=1+e.read_shift(1),n=1+e.read_shift(2)),r.biff>=2&&r.biff<8&&(--n,--a==0&&(a=256));for(var i=0,s=[];i!=n&&(s[i]=[]);++i)for(var o=0;o!=a;++o)s[i][o]=PW(e,r.biff);return s}function OW(e,t,r){var n=e.read_shift(1)>>>5&3,a=!r||r.biff>=8?4:2,i=e.read_shift(a);switch(r.biff){case 2:e.l+=5;break;case 3:case 4:e.l+=8;break;case 5:e.l+=12;break}return[n,0,i]}function DW(e,t,r){if(r.biff==5)return IW(e);var n=e.read_shift(1)>>>5&3,a=e.read_shift(2),i=e.read_shift(4);return[n,a,i]}function IW(e){var t=e.read_shift(1)>>>5&3,r=e.read_shift(2,"i");e.l+=8;var n=e.read_shift(2);return e.l+=12,[t,r,n]}function RW(e,t,r){var n=e.read_shift(1)>>>5&3;e.l+=r&&r.biff==2?3:4;var a=e.read_shift(r&&r.biff==2?1:2);return[n,a]}function jW(e,t,r){var n=e.read_shift(1)>>>5&3,a=e.read_shift(r&&r.biff==2?1:2);return[n,a]}function MW(e,t,r){var n=e.read_shift(1)>>>5&3;return e.l+=4,r.biff<8&&e.l--,r.biff==12&&(e.l+=2),[n]}function BW(e,t,r){var n=(e[e.l++]&96)>>5,a=e.read_shift(2),i=4;if(r)switch(r.biff){case 5:i=15;break;case 12:i=6;break}return e.l+=i,[n,a]}var UW=qn,VW=qn,$W=qn;function Ih(e,t,r){return e.l+=2,[tW(e)]}function A5(e){return e.l+=6,[]}var zW=Ih,HW=A5,WW=A5,qW=Ih;function JT(e){return e.l+=2,[Jr(e),e.read_shift(2)&1]}var GW=Ih,KW=JT,XW=A5,YW=Ih,JW=Ih,QW=["Data","All","Headers","??","?Data2","??","?DataHeaders","??","Totals","??","??","??","?DataTotals","??","??","??","?Current"];function ZW(e){e.l+=2;var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(4),a=e.read_shift(2),i=e.read_shift(2),s=QW[r>>2&31];return{ixti:t,coltype:r&3,rt:s,idx:n,c:a,C:i}}function eq(e){return e.l+=2,[e.read_shift(4)]}function tq(e,t,r){return e.l+=5,e.l+=2,e.l+=r.biff==2?1:4,["PTGSHEET"]}function rq(e,t,r){return e.l+=r.biff==2?4:5,["PTGENDSHEET"]}function nq(e){var t=e.read_shift(1)>>>5&3,r=e.read_shift(2);return[t,r]}function aq(e){var t=e.read_shift(1)>>>5&3,r=e.read_shift(2);return[t,r]}function iq(e){return e.l+=4,[0,0]}var Y3={1:{n:"PtgExp",f:kW},2:{n:"PtgTbl",f:$W},3:{n:"PtgAdd",f:Kr},4:{n:"PtgSub",f:Kr},5:{n:"PtgMul",f:Kr},6:{n:"PtgDiv",f:Kr},7:{n:"PtgPower",f:Kr},8:{n:"PtgConcat",f:Kr},9:{n:"PtgLt",f:Kr},10:{n:"PtgLe",f:Kr},11:{n:"PtgEq",f:Kr},12:{n:"PtgGe",f:Kr},13:{n:"PtgGt",f:Kr},14:{n:"PtgNe",f:Kr},15:{n:"PtgIsect",f:Kr},16:{n:"PtgUnion",f:Kr},17:{n:"PtgRange",f:Kr},18:{n:"PtgUplus",f:Kr},19:{n:"PtgUminus",f:Kr},20:{n:"PtgPercent",f:Kr},21:{n:"PtgParen",f:Kr},22:{n:"PtgMissArg",f:Kr},23:{n:"PtgStr",f:NW},26:{n:"PtgSheet",f:tq},27:{n:"PtgEndSheet",f:rq},28:{n:"PtgErr",f:EW},29:{n:"PtgBool",f:TW},30:{n:"PtgInt",f:AW},31:{n:"PtgNum",f:CW},32:{n:"PtgArray",f:cW},33:{n:"PtgFunc",f:wW},34:{n:"PtgFuncVar",f:bW},35:{n:"PtgName",f:OW},36:{n:"PtgRef",f:vW},37:{n:"PtgArea",f:aW},38:{n:"PtgMemArea",f:RW},39:{n:"PtgMemErr",f:UW},40:{n:"PtgMemNoMem",f:VW},41:{n:"PtgMemFunc",f:jW},42:{n:"PtgRefErr",f:MW},43:{n:"PtgAreaErr",f:sW},44:{n:"PtgRefN",f:xW},45:{n:"PtgAreaN",f:lW},46:{n:"PtgMemAreaN",f:nq},47:{n:"PtgMemNoMemN",f:aq},57:{n:"PtgNameX",f:DW},58:{n:"PtgRef3d",f:yW},59:{n:"PtgArea3d",f:iW},60:{n:"PtgRefErr3d",f:BW},61:{n:"PtgAreaErr3d",f:oW},255:{}},sq={64:32,96:32,65:33,97:33,66:34,98:34,67:35,99:35,68:36,100:36,69:37,101:37,70:38,102:38,71:39,103:39,72:40,104:40,73:41,105:41,74:42,106:42,75:43,107:43,76:44,108:44,77:45,109:45,78:46,110:46,79:47,111:47,88:34,120:34,89:57,121:57,90:58,122:58,91:59,123:59,92:60,124:60,93:61,125:61},oq={1:{n:"PtgElfLel",f:JT},2:{n:"PtgElfRw",f:YW},3:{n:"PtgElfCol",f:zW},6:{n:"PtgElfRwV",f:JW},7:{n:"PtgElfColV",f:qW},10:{n:"PtgElfRadical",f:GW},11:{n:"PtgElfRadicalS",f:XW},13:{n:"PtgElfColS",f:HW},15:{n:"PtgElfColSV",f:WW},16:{n:"PtgElfRadicalLel",f:KW},25:{n:"PtgList",f:ZW},29:{n:"PtgSxName",f:eq},255:{}},lq={0:{n:"PtgAttrNoop",f:iq},1:{n:"PtgAttrSemi",f:pW},2:{n:"PtgAttrIf",f:hW},4:{n:"PtgAttrChoose",f:uW},8:{n:"PtgAttrGoto",f:fW},16:{n:"PtgAttrSum",f:SW},32:{n:"PtgAttrBaxcel",f:X3},33:{n:"PtgAttrBaxcel",f:X3},64:{n:"PtgAttrSpace",f:mW},65:{n:"PtgAttrSpaceSemi",f:gW},128:{n:"PtgAttrIfError",f:dW},255:{}};function Rh(e,t,r,n){if(n.biff<8)return qn(e,t);for(var a=e.l+t,i=[],s=0;s!==r.length;++s)switch(r[s][0]){case"PtgArray":r[s][1]=FW(e,0,n),i.push(r[s][1]);break;case"PtgMemArea":r[s][2]=LW(e,r[s][1],n),i.push(r[s][2]);break;case"PtgExp":n&&n.biff==12&&(r[s][1][1]=e.read_shift(4),i.push(r[s][1]));break;case"PtgList":case"PtgElfRadicalS":case"PtgElfColS":case"PtgElfColSV":throw"Unsupported "+r[s][0]}return t=a-e.l,t!==0&&i.push(qn(e,t)),i}function jh(e,t,r){for(var n=e.l+t,a,i,s=[];n!=e.l;)t=n-e.l,i=e[e.l],a=Y3[i]||Y3[sq[i]],(i===24||i===25)&&(a=(i===24?oq:lq)[e[e.l+1]]),!a||!a.f?qn(e,t):s.push([a.n,a.f(e,t,r)]);return s}function cq(e){for(var t=[],r=0;r<e.length;++r){for(var n=e[r],a=[],i=0;i<n.length;++i){var s=n[i];if(s)switch(s[0]){case 2:a.push('"'+s[1].replace(/"/g,'""')+'"');break;default:a.push(s[1])}else a.push("")}t.push(a.join(","))}return t.join(";")}var uq={PtgAdd:"+",PtgConcat:"&",PtgDiv:"/",PtgEq:"=",PtgGe:">=",PtgGt:">",PtgLe:"<=",PtgLt:"<",PtgMul:"*",PtgNe:"<>",PtgPower:"^",PtgSub:"-"};function fq(e,t){if(!e&&!(t&&t.biff<=5&&t.biff>=2))throw new Error("empty sheet name");return/[^\w\u4E00-\u9FFF\u3040-\u30FF]/.test(e)?"'"+e+"'":e}function QT(e,t,r){if(!e)return"SH33TJSERR0";if(r.biff>8&&(!e.XTI||!e.XTI[t]))return e.SheetNames[t];if(!e.XTI)return"SH33TJSERR6";var n=e.XTI[t];if(r.biff<8)return t>1e4&&(t-=65536),t<0&&(t=-t),t==0?"":e.XTI[t-1];if(!n)return"SH33TJSERR1";var a="";if(r.biff>8)switch(e[n[0]][0]){case 357:return a=n[1]==-1?"#REF":e.SheetNames[n[1]],n[1]==n[2]?a:a+":"+e.SheetNames[n[2]];case 358:return r.SID!=null?e.SheetNames[r.SID]:"SH33TJSSAME"+e[n[0]][0];case 355:default:return"SH33TJSSRC"+e[n[0]][0]}switch(e[n[0]][0][0]){case 1025:return a=n[1]==-1?"#REF":e.SheetNames[n[1]]||"SH33TJSERR3",n[1]==n[2]?a:a+":"+e.SheetNames[n[2]];case 14849:return e[n[0]].slice(1).map(function(i){return i.Name}).join(";;");default:return e[n[0]][0][3]?(a=n[1]==-1?"#REF":e[n[0]][0][3][n[1]]||"SH33TJSERR4",n[1]==n[2]?a:a+":"+e[n[0]][0][3][n[2]]):"SH33TJSERR2"}}function J3(e,t,r){var n=QT(e,t,r);return n=="#REF"?n:fq(n,r)}function Bn(e,t,r,n,a){var i=a&&a.biff||8,s={s:{c:0,r:0},e:{c:0,r:0}},o=[],l,c,u,f=0,p=0,h,g="";if(!e[0]||!e[0][0])return"";for(var m=-1,b="",x=0,w=e[0].length;x<w;++x){var y=e[0][x];switch(y[0]){case"PtgUminus":o.push("-"+o.pop());break;case"PtgUplus":o.push("+"+o.pop());break;case"PtgPercent":o.push(o.pop()+"%");break;case"PtgAdd":case"PtgConcat":case"PtgDiv":case"PtgEq":case"PtgGe":case"PtgGt":case"PtgLe":case"PtgLt":case"PtgMul":case"PtgNe":case"PtgPower":case"PtgSub":if(l=o.pop(),c=o.pop(),m>=0){switch(e[0][m][1][0]){case 0:b=Fr(" ",e[0][m][1][1]);break;case 1:b=Fr("\r",e[0][m][1][1]);break;default:if(b="",a.WTF)throw new Error("Unexpected PtgAttrSpaceType "+e[0][m][1][0])}c=c+b,m=-1}o.push(c+uq[y[0]]+l);break;case"PtgIsect":l=o.pop(),c=o.pop(),o.push(c+" "+l);break;case"PtgUnion":l=o.pop(),c=o.pop(),o.push(c+","+l);break;case"PtgRange":l=o.pop(),c=o.pop(),o.push(c+":"+l);break;case"PtgAttrChoose":break;case"PtgAttrGoto":break;case"PtgAttrIf":break;case"PtgAttrIfError":break;case"PtgRef":u=S0(y[1][1],s,a),o.push(k0(u,i));break;case"PtgRefN":u=r?S0(y[1][1],r,a):y[1][1],o.push(k0(u,i));break;case"PtgRef3d":f=y[1][1],u=S0(y[1][2],s,a),g=J3(n,f,a),o.push(g+"!"+k0(u,i));break;case"PtgFunc":case"PtgFuncVar":var A=y[1][0],L=y[1][1];A||(A=0),A&=127;var D=A==0?[]:o.slice(-A);o.length-=A,L==="User"&&(L=D.shift()),o.push(L+"("+D.join(",")+")");break;case"PtgBool":o.push(y[1]?"TRUE":"FALSE");break;case"PtgInt":o.push(y[1]);break;case"PtgNum":o.push(String(y[1]));break;case"PtgStr":o.push('"'+y[1].replace(/"/g,'""')+'"');break;case"PtgErr":o.push(y[1]);break;case"PtgAreaN":h=L3(y[1][1],r?{s:r}:s,a),o.push(d2(h,a));break;case"PtgArea":h=L3(y[1][1],s,a),o.push(d2(h,a));break;case"PtgArea3d":f=y[1][1],h=y[1][2],g=J3(n,f,a),o.push(g+"!"+d2(h,a));break;case"PtgAttrSum":o.push("SUM("+o.pop()+")");break;case"PtgAttrBaxcel":case"PtgAttrSemi":break;case"PtgName":p=y[1][2];var T=(n.names||[])[p-1]||(n[0]||[])[p],F=T?T.Name:"SH33TJSNAME"+String(p);F&&F.slice(0,6)=="_xlfn."&&!a.xlfn&&(F=F.slice(6)),o.push(F);break;case"PtgNameX":var R=y[1][1];p=y[1][2];var X;if(a.biff<=5)R<0&&(R=-R),n[R]&&(X=n[R][p]);else{var N="";if(((n[R]||[])[0]||[])[0]==14849||(((n[R]||[])[0]||[])[0]==1025?n[R][p]&&n[R][p].itab>0&&(N=n.SheetNames[n[R][p].itab-1]+"!"):N=n.SheetNames[p-1]+"!"),n[R]&&n[R][p])N+=n[R][p].Name;else if(n[0]&&n[0][p])N+=n[0][p].Name;else{var P=(QT(n,R,a)||"").split(";;");P[p-1]?N=P[p-1]:N+="SH33TJSERRX"}o.push(N);break}X||(X={Name:"SH33TJSERRY"}),o.push(X.Name);break;case"PtgParen":var J="(",W=")";if(m>=0){switch(b="",e[0][m][1][0]){case 2:J=Fr(" ",e[0][m][1][1])+J;break;case 3:J=Fr("\r",e[0][m][1][1])+J;break;case 4:W=Fr(" ",e[0][m][1][1])+W;break;case 5:W=Fr("\r",e[0][m][1][1])+W;break;default:if(a.WTF)throw new Error("Unexpected PtgAttrSpaceType "+e[0][m][1][0])}m=-1}o.push(J+o.pop()+W);break;case"PtgRefErr":o.push("#REF!");break;case"PtgRefErr3d":o.push("#REF!");break;case"PtgExp":u={c:y[1][1],r:y[1][0]};var se={c:r.c,r:r.r};if(n.sharedf[Ct(u)]){var fe=n.sharedf[Ct(u)];o.push(Bn(fe,s,se,n,a))}else{var U=!1;for(l=0;l!=n.arrayf.length;++l)if(c=n.arrayf[l],!(u.c<c[0].s.c||u.c>c[0].e.c)&&!(u.r<c[0].s.r||u.r>c[0].e.r)){o.push(Bn(c[1],s,se,n,a)),U=!0;break}U||o.push(y[1])}break;case"PtgArray":o.push("{"+cq(y[1])+"}");break;case"PtgMemArea":break;case"PtgAttrSpace":case"PtgAttrSpaceSemi":m=x;break;case"PtgTbl":break;case"PtgMemErr":break;case"PtgMissArg":o.push("");break;case"PtgAreaErr":o.push("#REF!");break;case"PtgAreaErr3d":o.push("#REF!");break;case"PtgList":o.push("Table"+y[1].idx+"[#"+y[1].rt+"]");break;case"PtgMemAreaN":case"PtgMemNoMemN":case"PtgAttrNoop":case"PtgSheet":case"PtgEndSheet":break;case"PtgMemFunc":break;case"PtgMemNoMem":break;case"PtgElfCol":case"PtgElfColS":case"PtgElfColSV":case"PtgElfColV":case"PtgElfLel":case"PtgElfRadical":case"PtgElfRadicalLel":case"PtgElfRadicalS":case"PtgElfRw":case"PtgElfRwV":throw new Error("Unsupported ELFs");case"PtgSxName":throw new Error("Unrecognized Formula Token: "+String(y));default:throw new Error("Unrecognized Formula Token: "+String(y))}var Q=["PtgAttrSpace","PtgAttrSpaceSemi","PtgAttrGoto"];if(a.biff!=3&&m>=0&&Q.indexOf(e[0][x][0])==-1){y=e[0][m];var q=!0;switch(y[1][0]){case 4:q=!1;case 0:b=Fr(" ",y[1][1]);break;case 5:q=!1;case 1:b=Fr("\r",y[1][1]);break;default:if(b="",a.WTF)throw new Error("Unexpected PtgAttrSpaceType "+y[1][0])}o.push((q?b:"")+o.pop()+(q?"":b)),m=-1}}if(o.length>1&&a.WTF)throw new Error("bad formula stack");return o[0]}function hq(e,t,r){var n=e.l+t,a=r.biff==2?1:2,i,s=e.read_shift(a);if(s==65535)return[[],qn(e,t-2)];var o=jh(e,s,r);return t!==s+a&&(i=Rh(e,t-s-a,o,r)),e.l=n,[o,i]}function dq(e,t,r){var n=e.l+t,a=r.biff==2?1:2,i,s=e.read_shift(a);if(s==65535)return[[],qn(e,t-2)];var o=jh(e,s,r);return t!==s+a&&(i=Rh(e,t-s-a,o,r)),e.l=n,[o,i]}function pq(e,t,r,n){var a=e.l+t,i=jh(e,n,r),s;return a!==e.l&&(s=Rh(e,a-e.l,i,r)),[i,s]}function mq(e,t,r){var n=e.l+t,a,i=e.read_shift(2),s=jh(e,i,r);return i==65535?[[],qn(e,t-2)]:(t!==i+2&&(a=Rh(e,n-i-2,s,r)),[s,a])}function gq(e){var t;if(Ms(e,e.l+6)!==65535)return[Vn(e),"n"];switch(e[e.l]){case 0:return e.l+=8,["String","s"];case 1:return t=e[e.l+2]===1,e.l+=8,[t,"b"];case 2:return t=e[e.l+2],e.l+=8,[t,"e"];case 3:return e.l+=8,["","s"]}return[]}function g2(e,t,r){var n=e.l+t,a=gs(e);r.biff==2&&++e.l;var i=gq(e),s=e.read_shift(1);r.biff!=2&&(e.read_shift(1),r.biff>=5&&e.read_shift(4));var o=dq(e,n-e.l,r);return{cell:a,val:i[0],formula:o,shared:s>>3&1,tt:i[1]}}function Nm(e,t,r){var n=e.read_shift(4),a=jh(e,n,r),i=e.read_shift(4),s=i>0?Rh(e,i,a,r):null;return[a,s]}var vq=Nm,Pm=Nm,xq=Nm,yq=Nm,wq={0:"BEEP",1:"OPEN",2:"OPEN.LINKS",3:"CLOSE.ALL",4:"SAVE",5:"SAVE.AS",6:"FILE.DELETE",7:"PAGE.SETUP",8:"PRINT",9:"PRINTER.SETUP",10:"QUIT",11:"NEW.WINDOW",12:"ARRANGE.ALL",13:"WINDOW.SIZE",14:"WINDOW.MOVE",15:"FULL",16:"CLOSE",17:"RUN",22:"SET.PRINT.AREA",23:"SET.PRINT.TITLES",24:"SET.PAGE.BREAK",25:"REMOVE.PAGE.BREAK",26:"FONT",27:"DISPLAY",28:"PROTECT.DOCUMENT",29:"PRECISION",30:"A1.R1C1",31:"CALCULATE.NOW",32:"CALCULATION",34:"DATA.FIND",35:"EXTRACT",36:"DATA.DELETE",37:"SET.DATABASE",38:"SET.CRITERIA",39:"SORT",40:"DATA.SERIES",41:"TABLE",42:"FORMAT.NUMBER",43:"ALIGNMENT",44:"STYLE",45:"BORDER",46:"CELL.PROTECTION",47:"COLUMN.WIDTH",48:"UNDO",49:"CUT",50:"COPY",51:"PASTE",52:"CLEAR",53:"PASTE.SPECIAL",54:"EDIT.DELETE",55:"INSERT",56:"FILL.RIGHT",57:"FILL.DOWN",61:"DEFINE.NAME",62:"CREATE.NAMES",63:"FORMULA.GOTO",64:"FORMULA.FIND",65:"SELECT.LAST.CELL",66:"SHOW.ACTIVE.CELL",67:"GALLERY.AREA",68:"GALLERY.BAR",69:"GALLERY.COLUMN",70:"GALLERY.LINE",71:"GALLERY.PIE",72:"GALLERY.SCATTER",73:"COMBINATION",74:"PREFERRED",75:"ADD.OVERLAY",76:"GRIDLINES",77:"SET.PREFERRED",78:"AXES",79:"LEGEND",80:"ATTACH.TEXT",81:"ADD.ARROW",82:"SELECT.CHART",83:"SELECT.PLOT.AREA",84:"PATTERNS",85:"MAIN.CHART",86:"OVERLAY",87:"SCALE",88:"FORMAT.LEGEND",89:"FORMAT.TEXT",90:"EDIT.REPEAT",91:"PARSE",92:"JUSTIFY",93:"HIDE",94:"UNHIDE",95:"WORKSPACE",96:"FORMULA",97:"FORMULA.FILL",98:"FORMULA.ARRAY",99:"DATA.FIND.NEXT",100:"DATA.FIND.PREV",101:"FORMULA.FIND.NEXT",102:"FORMULA.FIND.PREV",103:"ACTIVATE",104:"ACTIVATE.NEXT",105:"ACTIVATE.PREV",106:"UNLOCKED.NEXT",107:"UNLOCKED.PREV",108:"COPY.PICTURE",109:"SELECT",110:"DELETE.NAME",111:"DELETE.FORMAT",112:"VLINE",113:"HLINE",114:"VPAGE",115:"HPAGE",116:"VSCROLL",117:"HSCROLL",118:"ALERT",119:"NEW",120:"CANCEL.COPY",121:"SHOW.CLIPBOARD",122:"MESSAGE",124:"PASTE.LINK",125:"APP.ACTIVATE",126:"DELETE.ARROW",127:"ROW.HEIGHT",128:"FORMAT.MOVE",129:"FORMAT.SIZE",130:"FORMULA.REPLACE",131:"SEND.KEYS",132:"SELECT.SPECIAL",133:"APPLY.NAMES",134:"REPLACE.FONT",135:"FREEZE.PANES",136:"SHOW.INFO",137:"SPLIT",138:"ON.WINDOW",139:"ON.DATA",140:"DISABLE.INPUT",142:"OUTLINE",143:"LIST.NAMES",144:"FILE.CLOSE",145:"SAVE.WORKBOOK",146:"DATA.FORM",147:"COPY.CHART",148:"ON.TIME",149:"WAIT",150:"FORMAT.FONT",151:"FILL.UP",152:"FILL.LEFT",153:"DELETE.OVERLAY",155:"SHORT.MENUS",159:"SET.UPDATE.STATUS",161:"COLOR.PALETTE",162:"DELETE.STYLE",163:"WINDOW.RESTORE",164:"WINDOW.MAXIMIZE",166:"CHANGE.LINK",167:"CALCULATE.DOCUMENT",168:"ON.KEY",169:"APP.RESTORE",170:"APP.MOVE",171:"APP.SIZE",172:"APP.MINIMIZE",173:"APP.MAXIMIZE",174:"BRING.TO.FRONT",175:"SEND.TO.BACK",185:"MAIN.CHART.TYPE",186:"OVERLAY.CHART.TYPE",187:"SELECT.END",188:"OPEN.MAIL",189:"SEND.MAIL",190:"STANDARD.FONT",191:"CONSOLIDATE",192:"SORT.SPECIAL",193:"GALLERY.3D.AREA",194:"GALLERY.3D.COLUMN",195:"GALLERY.3D.LINE",196:"GALLERY.3D.PIE",197:"VIEW.3D",198:"GOAL.SEEK",199:"WORKGROUP",200:"FILL.GROUP",201:"UPDATE.LINK",202:"PROMOTE",203:"DEMOTE",204:"SHOW.DETAIL",206:"UNGROUP",207:"OBJECT.PROPERTIES",208:"SAVE.NEW.OBJECT",209:"SHARE",210:"SHARE.NAME",211:"DUPLICATE",212:"APPLY.STYLE",213:"ASSIGN.TO.OBJECT",214:"OBJECT.PROTECTION",215:"HIDE.OBJECT",216:"SET.EXTRACT",217:"CREATE.PUBLISHER",218:"SUBSCRIBE.TO",219:"ATTRIBUTES",220:"SHOW.TOOLBAR",222:"PRINT.PREVIEW",223:"EDIT.COLOR",224:"SHOW.LEVELS",225:"FORMAT.MAIN",226:"FORMAT.OVERLAY",227:"ON.RECALC",228:"EDIT.SERIES",229:"DEFINE.STYLE",240:"LINE.PRINT",243:"ENTER.DATA",249:"GALLERY.RADAR",250:"MERGE.STYLES",251:"EDITION.OPTIONS",252:"PASTE.PICTURE",253:"PASTE.PICTURE.LINK",254:"SPELLING",256:"ZOOM",259:"INSERT.OBJECT",260:"WINDOW.MINIMIZE",265:"SOUND.NOTE",266:"SOUND.PLAY",267:"FORMAT.SHAPE",268:"EXTEND.POLYGON",269:"FORMAT.AUTO",272:"GALLERY.3D.BAR",273:"GALLERY.3D.SURFACE",274:"FILL.AUTO",276:"CUSTOMIZE.TOOLBAR",277:"ADD.TOOL",278:"EDIT.OBJECT",279:"ON.DOUBLECLICK",280:"ON.ENTRY",281:"WORKBOOK.ADD",282:"WORKBOOK.MOVE",283:"WORKBOOK.COPY",284:"WORKBOOK.OPTIONS",285:"SAVE.WORKSPACE",288:"CHART.WIZARD",289:"DELETE.TOOL",290:"MOVE.TOOL",291:"WORKBOOK.SELECT",292:"WORKBOOK.ACTIVATE",293:"ASSIGN.TO.TOOL",295:"COPY.TOOL",296:"RESET.TOOL",297:"CONSTRAIN.NUMERIC",298:"PASTE.TOOL",302:"WORKBOOK.NEW",305:"SCENARIO.CELLS",306:"SCENARIO.DELETE",307:"SCENARIO.ADD",308:"SCENARIO.EDIT",309:"SCENARIO.SHOW",310:"SCENARIO.SHOW.NEXT",311:"SCENARIO.SUMMARY",312:"PIVOT.TABLE.WIZARD",313:"PIVOT.FIELD.PROPERTIES",314:"PIVOT.FIELD",315:"PIVOT.ITEM",316:"PIVOT.ADD.FIELDS",318:"OPTIONS.CALCULATION",319:"OPTIONS.EDIT",320:"OPTIONS.VIEW",321:"ADDIN.MANAGER",322:"MENU.EDITOR",323:"ATTACH.TOOLBARS",324:"VBAActivate",325:"OPTIONS.CHART",328:"VBA.INSERT.FILE",330:"VBA.PROCEDURE.DEFINITION",336:"ROUTING.SLIP",338:"ROUTE.DOCUMENT",339:"MAIL.LOGON",342:"INSERT.PICTURE",343:"EDIT.TOOL",344:"GALLERY.DOUGHNUT",350:"CHART.TREND",352:"PIVOT.ITEM.PROPERTIES",354:"WORKBOOK.INSERT",355:"OPTIONS.TRANSITION",356:"OPTIONS.GENERAL",370:"FILTER.ADVANCED",373:"MAIL.ADD.MAILER",374:"MAIL.DELETE.MAILER",375:"MAIL.REPLY",376:"MAIL.REPLY.ALL",377:"MAIL.FORWARD",378:"MAIL.NEXT.LETTER",379:"DATA.LABEL",380:"INSERT.TITLE",381:"FONT.PROPERTIES",382:"MACRO.OPTIONS",383:"WORKBOOK.HIDE",384:"WORKBOOK.UNHIDE",385:"WORKBOOK.DELETE",386:"WORKBOOK.NAME",388:"GALLERY.CUSTOM",390:"ADD.CHART.AUTOFORMAT",391:"DELETE.CHART.AUTOFORMAT",392:"CHART.ADD.DATA",393:"AUTO.OUTLINE",394:"TAB.ORDER",395:"SHOW.DIALOG",396:"SELECT.ALL",397:"UNGROUP.SHEETS",398:"SUBTOTAL.CREATE",399:"SUBTOTAL.REMOVE",400:"RENAME.OBJECT",412:"WORKBOOK.SCROLL",413:"WORKBOOK.NEXT",414:"WORKBOOK.PREV",415:"WORKBOOK.TAB.SPLIT",416:"FULL.SCREEN",417:"WORKBOOK.PROTECT",420:"SCROLLBAR.PROPERTIES",421:"PIVOT.SHOW.PAGES",422:"TEXT.TO.COLUMNS",423:"FORMAT.CHARTTYPE",424:"LINK.FORMAT",425:"TRACER.DISPLAY",430:"TRACER.NAVIGATE",431:"TRACER.CLEAR",432:"TRACER.ERROR",433:"PIVOT.FIELD.GROUP",434:"PIVOT.FIELD.UNGROUP",435:"CHECKBOX.PROPERTIES",436:"LABEL.PROPERTIES",437:"LISTBOX.PROPERTIES",438:"EDITBOX.PROPERTIES",439:"PIVOT.REFRESH",440:"LINK.COMBO",441:"OPEN.TEXT",442:"HIDE.DIALOG",443:"SET.DIALOG.FOCUS",444:"ENABLE.OBJECT",445:"PUSHBUTTON.PROPERTIES",446:"SET.DIALOG.DEFAULT",447:"FILTER",448:"FILTER.SHOW.ALL",449:"CLEAR.OUTLINE",450:"FUNCTION.WIZARD",451:"ADD.LIST.ITEM",452:"SET.LIST.ITEM",453:"REMOVE.LIST.ITEM",454:"SELECT.LIST.ITEM",455:"SET.CONTROL.VALUE",456:"SAVE.COPY.AS",458:"OPTIONS.LISTS.ADD",459:"OPTIONS.LISTS.DELETE",460:"SERIES.AXES",461:"SERIES.X",462:"SERIES.Y",463:"ERRORBAR.X",464:"ERRORBAR.Y",465:"FORMAT.CHART",466:"SERIES.ORDER",467:"MAIL.LOGOFF",468:"CLEAR.ROUTING.SLIP",469:"APP.ACTIVATE.MICROSOFT",470:"MAIL.EDIT.MAILER",471:"ON.SHEET",472:"STANDARD.WIDTH",473:"SCENARIO.MERGE",474:"SUMMARY.INFO",475:"FIND.FILE",476:"ACTIVE.CELL.FONT",477:"ENABLE.TIPWIZARD",478:"VBA.MAKE.ADDIN",480:"INSERTDATATABLE",481:"WORKGROUP.OPTIONS",482:"MAIL.SEND.MAILER",485:"AUTOCORRECT",489:"POST.DOCUMENT",491:"PICKLIST",493:"VIEW.SHOW",494:"VIEW.DEFINE",495:"VIEW.DELETE",509:"SHEET.BACKGROUND",510:"INSERT.MAP.OBJECT",511:"OPTIONS.MENONO",517:"MSOCHECKS",518:"NORMAL",519:"LAYOUT",520:"RM.PRINT.AREA",521:"CLEAR.PRINT.AREA",522:"ADD.PRINT.AREA",523:"MOVE.BRK",545:"HIDECURR.NOTE",546:"HIDEALL.NOTES",547:"DELETE.NOTE",548:"TRAVERSE.NOTES",549:"ACTIVATE.NOTES",620:"PROTECT.REVISIONS",621:"UNPROTECT.REVISIONS",647:"OPTIONS.ME",653:"WEB.PUBLISH",667:"NEWWEBQUERY",673:"PIVOT.TABLE.CHART",753:"OPTIONS.SAVE",755:"OPTIONS.SPELL",808:"HIDEALL.INKANNOTS"},ZT={0:"COUNT",1:"IF",2:"ISNA",3:"ISERROR",4:"SUM",5:"AVERAGE",6:"MIN",7:"MAX",8:"ROW",9:"COLUMN",10:"NA",11:"NPV",12:"STDEV",13:"DOLLAR",14:"FIXED",15:"SIN",16:"COS",17:"TAN",18:"ATAN",19:"PI",20:"SQRT",21:"EXP",22:"LN",23:"LOG10",24:"ABS",25:"INT",26:"SIGN",27:"ROUND",28:"LOOKUP",29:"INDEX",30:"REPT",31:"MID",32:"LEN",33:"VALUE",34:"TRUE",35:"FALSE",36:"AND",37:"OR",38:"NOT",39:"MOD",40:"DCOUNT",41:"DSUM",42:"DAVERAGE",43:"DMIN",44:"DMAX",45:"DSTDEV",46:"VAR",47:"DVAR",48:"TEXT",49:"LINEST",50:"TREND",51:"LOGEST",52:"GROWTH",53:"GOTO",54:"HALT",55:"RETURN",56:"PV",57:"FV",58:"NPER",59:"PMT",60:"RATE",61:"MIRR",62:"IRR",63:"RAND",64:"MATCH",65:"DATE",66:"TIME",67:"DAY",68:"MONTH",69:"YEAR",70:"WEEKDAY",71:"HOUR",72:"MINUTE",73:"SECOND",74:"NOW",75:"AREAS",76:"ROWS",77:"COLUMNS",78:"OFFSET",79:"ABSREF",80:"RELREF",81:"ARGUMENT",82:"SEARCH",83:"TRANSPOSE",84:"ERROR",85:"STEP",86:"TYPE",87:"ECHO",88:"SET.NAME",89:"CALLER",90:"DEREF",91:"WINDOWS",92:"SERIES",93:"DOCUMENTS",94:"ACTIVE.CELL",95:"SELECTION",96:"RESULT",97:"ATAN2",98:"ASIN",99:"ACOS",100:"CHOOSE",101:"HLOOKUP",102:"VLOOKUP",103:"LINKS",104:"INPUT",105:"ISREF",106:"GET.FORMULA",107:"GET.NAME",108:"SET.VALUE",109:"LOG",110:"EXEC",111:"CHAR",112:"LOWER",113:"UPPER",114:"PROPER",115:"LEFT",116:"RIGHT",117:"EXACT",118:"TRIM",119:"REPLACE",120:"SUBSTITUTE",121:"CODE",122:"NAMES",123:"DIRECTORY",124:"FIND",125:"CELL",126:"ISERR",127:"ISTEXT",128:"ISNUMBER",129:"ISBLANK",130:"T",131:"N",132:"FOPEN",133:"FCLOSE",134:"FSIZE",135:"FREADLN",136:"FREAD",137:"FWRITELN",138:"FWRITE",139:"FPOS",140:"DATEVALUE",141:"TIMEVALUE",142:"SLN",143:"SYD",144:"DDB",145:"GET.DEF",146:"REFTEXT",147:"TEXTREF",148:"INDIRECT",149:"REGISTER",150:"CALL",151:"ADD.BAR",152:"ADD.MENU",153:"ADD.COMMAND",154:"ENABLE.COMMAND",155:"CHECK.COMMAND",156:"RENAME.COMMAND",157:"SHOW.BAR",158:"DELETE.MENU",159:"DELETE.COMMAND",160:"GET.CHART.ITEM",161:"DIALOG.BOX",162:"CLEAN",163:"MDETERM",164:"MINVERSE",165:"MMULT",166:"FILES",167:"IPMT",168:"PPMT",169:"COUNTA",170:"CANCEL.KEY",171:"FOR",172:"WHILE",173:"BREAK",174:"NEXT",175:"INITIATE",176:"REQUEST",177:"POKE",178:"EXECUTE",179:"TERMINATE",180:"RESTART",181:"HELP",182:"GET.BAR",183:"PRODUCT",184:"FACT",185:"GET.CELL",186:"GET.WORKSPACE",187:"GET.WINDOW",188:"GET.DOCUMENT",189:"DPRODUCT",190:"ISNONTEXT",191:"GET.NOTE",192:"NOTE",193:"STDEVP",194:"VARP",195:"DSTDEVP",196:"DVARP",197:"TRUNC",198:"ISLOGICAL",199:"DCOUNTA",200:"DELETE.BAR",201:"UNREGISTER",204:"USDOLLAR",205:"FINDB",206:"SEARCHB",207:"REPLACEB",208:"LEFTB",209:"RIGHTB",210:"MIDB",211:"LENB",212:"ROUNDUP",213:"ROUNDDOWN",214:"ASC",215:"DBCS",216:"RANK",219:"ADDRESS",220:"DAYS360",221:"TODAY",222:"VDB",223:"ELSE",224:"ELSE.IF",225:"END.IF",226:"FOR.CELL",227:"MEDIAN",228:"SUMPRODUCT",229:"SINH",230:"COSH",231:"TANH",232:"ASINH",233:"ACOSH",234:"ATANH",235:"DGET",236:"CREATE.OBJECT",237:"VOLATILE",238:"LAST.ERROR",239:"CUSTOM.UNDO",240:"CUSTOM.REPEAT",241:"FORMULA.CONVERT",242:"GET.LINK.INFO",243:"TEXT.BOX",244:"INFO",245:"GROUP",246:"GET.OBJECT",247:"DB",248:"PAUSE",251:"RESUME",252:"FREQUENCY",253:"ADD.TOOLBAR",254:"DELETE.TOOLBAR",255:"User",256:"RESET.TOOLBAR",257:"EVALUATE",258:"GET.TOOLBAR",259:"GET.TOOL",260:"SPELLING.CHECK",261:"ERROR.TYPE",262:"APP.TITLE",263:"WINDOW.TITLE",264:"SAVE.TOOLBAR",265:"ENABLE.TOOL",266:"PRESS.TOOL",267:"REGISTER.ID",268:"GET.WORKBOOK",269:"AVEDEV",270:"BETADIST",271:"GAMMALN",272:"BETAINV",273:"BINOMDIST",274:"CHIDIST",275:"CHIINV",276:"COMBIN",277:"CONFIDENCE",278:"CRITBINOM",279:"EVEN",280:"EXPONDIST",281:"FDIST",282:"FINV",283:"FISHER",284:"FISHERINV",285:"FLOOR",286:"GAMMADIST",287:"GAMMAINV",288:"CEILING",289:"HYPGEOMDIST",290:"LOGNORMDIST",291:"LOGINV",292:"NEGBINOMDIST",293:"NORMDIST",294:"NORMSDIST",295:"NORMINV",296:"NORMSINV",297:"STANDARDIZE",298:"ODD",299:"PERMUT",300:"POISSON",301:"TDIST",302:"WEIBULL",303:"SUMXMY2",304:"SUMX2MY2",305:"SUMX2PY2",306:"CHITEST",307:"CORREL",308:"COVAR",309:"FORECAST",310:"FTEST",311:"INTERCEPT",312:"PEARSON",313:"RSQ",314:"STEYX",315:"SLOPE",316:"TTEST",317:"PROB",318:"DEVSQ",319:"GEOMEAN",320:"HARMEAN",321:"SUMSQ",322:"KURT",323:"SKEW",324:"ZTEST",325:"LARGE",326:"SMALL",327:"QUARTILE",328:"PERCENTILE",329:"PERCENTRANK",330:"MODE",331:"TRIMMEAN",332:"TINV",334:"MOVIE.COMMAND",335:"GET.MOVIE",336:"CONCATENATE",337:"POWER",338:"PIVOT.ADD.DATA",339:"GET.PIVOT.TABLE",340:"GET.PIVOT.FIELD",341:"GET.PIVOT.ITEM",342:"RADIANS",343:"DEGREES",344:"SUBTOTAL",345:"SUMIF",346:"COUNTIF",347:"COUNTBLANK",348:"SCENARIO.GET",349:"OPTIONS.LISTS.GET",350:"ISPMT",351:"DATEDIF",352:"DATESTRING",353:"NUMBERSTRING",354:"ROMAN",355:"OPEN.DIALOG",356:"SAVE.DIALOG",357:"VIEW.GET",358:"GETPIVOTDATA",359:"HYPERLINK",360:"PHONETIC",361:"AVERAGEA",362:"MAXA",363:"MINA",364:"STDEVPA",365:"VARPA",366:"STDEVA",367:"VARA",368:"BAHTTEXT",369:"THAIDAYOFWEEK",370:"THAIDIGIT",371:"THAIMONTHOFYEAR",372:"THAINUMSOUND",373:"THAINUMSTRING",374:"THAISTRINGLENGTH",375:"ISTHAIDIGIT",376:"ROUNDBAHTDOWN",377:"ROUNDBAHTUP",378:"THAIYEAR",379:"RTD",380:"CUBEVALUE",381:"CUBEMEMBER",382:"CUBEMEMBERPROPERTY",383:"CUBERANKEDMEMBER",384:"HEX2BIN",385:"HEX2DEC",386:"HEX2OCT",387:"DEC2BIN",388:"DEC2HEX",389:"DEC2OCT",390:"OCT2BIN",391:"OCT2HEX",392:"OCT2DEC",393:"BIN2DEC",394:"BIN2OCT",395:"BIN2HEX",396:"IMSUB",397:"IMDIV",398:"IMPOWER",399:"IMABS",400:"IMSQRT",401:"IMLN",402:"IMLOG2",403:"IMLOG10",404:"IMSIN",405:"IMCOS",406:"IMEXP",407:"IMARGUMENT",408:"IMCONJUGATE",409:"IMAGINARY",410:"IMREAL",411:"COMPLEX",412:"IMSUM",413:"IMPRODUCT",414:"SERIESSUM",415:"FACTDOUBLE",416:"SQRTPI",417:"QUOTIENT",418:"DELTA",419:"GESTEP",420:"ISEVEN",421:"ISODD",422:"MROUND",423:"ERF",424:"ERFC",425:"BESSELJ",426:"BESSELK",427:"BESSELY",428:"BESSELI",429:"XIRR",430:"XNPV",431:"PRICEMAT",432:"YIELDMAT",433:"INTRATE",434:"RECEIVED",435:"DISC",436:"PRICEDISC",437:"YIELDDISC",438:"TBILLEQ",439:"TBILLPRICE",440:"TBILLYIELD",441:"PRICE",442:"YIELD",443:"DOLLARDE",444:"DOLLARFR",445:"NOMINAL",446:"EFFECT",447:"CUMPRINC",448:"CUMIPMT",449:"EDATE",450:"EOMONTH",451:"YEARFRAC",452:"COUPDAYBS",453:"COUPDAYS",454:"COUPDAYSNC",455:"COUPNCD",456:"COUPNUM",457:"COUPPCD",458:"DURATION",459:"MDURATION",460:"ODDLPRICE",461:"ODDLYIELD",462:"ODDFPRICE",463:"ODDFYIELD",464:"RANDBETWEEN",465:"WEEKNUM",466:"AMORDEGRC",467:"AMORLINC",468:"CONVERT",724:"SHEETJS",469:"ACCRINT",470:"ACCRINTM",471:"WORKDAY",472:"NETWORKDAYS",473:"GCD",474:"MULTINOMIAL",475:"LCM",476:"FVSCHEDULE",477:"CUBEKPIMEMBER",478:"CUBESET",479:"CUBESETCOUNT",480:"IFERROR",481:"COUNTIFS",482:"SUMIFS",483:"AVERAGEIF",484:"AVERAGEIFS"},bq={2:1,3:1,10:0,15:1,16:1,17:1,18:1,19:0,20:1,21:1,22:1,23:1,24:1,25:1,26:1,27:2,30:2,31:3,32:1,33:1,34:0,35:0,38:1,39:2,40:3,41:3,42:3,43:3,44:3,45:3,47:3,48:2,53:1,61:3,63:0,65:3,66:3,67:1,68:1,69:1,70:1,71:1,72:1,73:1,74:0,75:1,76:1,77:1,79:2,80:2,83:1,85:0,86:1,89:0,90:1,94:0,95:0,97:2,98:1,99:1,101:3,102:3,105:1,106:1,108:2,111:1,112:1,113:1,114:1,117:2,118:1,119:4,121:1,126:1,127:1,128:1,129:1,130:1,131:1,133:1,134:1,135:1,136:2,137:2,138:2,140:1,141:1,142:3,143:4,144:4,161:1,162:1,163:1,164:1,165:2,172:1,175:2,176:2,177:3,178:2,179:1,184:1,186:1,189:3,190:1,195:3,196:3,197:1,198:1,199:3,201:1,207:4,210:3,211:1,212:2,213:2,214:1,215:1,225:0,229:1,230:1,231:1,232:1,233:1,234:1,235:3,244:1,247:4,252:2,257:1,261:1,271:1,273:4,274:2,275:2,276:2,277:3,278:3,279:1,280:3,281:3,282:3,283:1,284:1,285:2,286:4,287:3,288:2,289:4,290:3,291:3,292:3,293:4,294:1,295:3,296:1,297:3,298:1,299:2,300:3,301:3,302:4,303:2,304:2,305:2,306:2,307:2,308:2,309:3,310:2,311:2,312:2,313:2,314:2,315:2,316:4,325:2,326:2,327:2,328:2,331:2,332:2,337:2,342:1,343:1,346:2,347:1,350:4,351:3,352:1,353:2,360:1,368:1,369:1,370:1,371:1,372:1,373:1,374:1,375:1,376:1,377:1,378:1,382:3,385:1,392:1,393:1,396:2,397:2,398:2,399:1,400:1,401:1,402:1,403:1,404:1,405:1,406:1,407:1,408:1,409:1,410:1,414:4,415:1,416:1,417:2,420:1,421:1,422:2,424:1,425:2,426:2,427:2,428:2,430:3,438:3,439:3,440:3,443:2,444:2,445:2,446:2,447:6,448:6,449:2,450:2,464:2,468:3,476:2,479:1,480:2,65535:0};function Q3(e){return e.slice(0,3)=="of:"&&(e=e.slice(3)),e.charCodeAt(0)==61&&(e=e.slice(1),e.charCodeAt(0)==61&&(e=e.slice(1))),e=e.replace(/COM\.MICROSOFT\./g,""),e=e.replace(/\[((?:\.[A-Z]+[0-9]+)(?::\.[A-Z]+[0-9]+)?)\]/g,function(t,r){return r.replace(/\./g,"")}),e=e.replace(/\[.(#[A-Z]*[?!])\]/g,"$1"),e.replace(/[;~]/g,",").replace(/\|/g,";")}function v2(e){var t=e.split(":"),r=t[0].split(".")[0];return[r,t[0].split(".")[1]+(t.length>1?":"+(t[1].split(".")[1]||t[1].split(".")[0]):"")]}var C0={},Eu={};function N0(e,t){if(e){var r=[.7,.7,.75,.75,.3,.3];t=="xlml"&&(r=[1,1,1,1,.5,.5]),e.left==null&&(e.left=r[0]),e.right==null&&(e.right=r[1]),e.top==null&&(e.top=r[2]),e.bottom==null&&(e.bottom=r[3]),e.header==null&&(e.header=r[4]),e.footer==null&&(e.footer=r[5])}}function eC(e,t,r,n,a,i){try{n.cellNF&&(e.z=Ft[t])}catch(o){if(n.WTF)throw o}if(!(e.t==="z"&&!n.cellStyles)){if(e.t==="d"&&typeof e.v=="string"&&(e.v=vn(e.v)),(!n||n.cellText!==!1)&&e.t!=="z")try{if(Ft[t]==null&&ql(_U[t]||"General",t),e.t==="e")e.w=e.w||mc[e.v];else if(t===0)if(e.t==="n")(e.v|0)===e.v?e.w=e.v.toString(10):e.w=ah(e.v);else if(e.t==="d"){var s=ia(e.v);(s|0)===s?e.w=s.toString(10):e.w=ah(s)}else{if(e.v===void 0)return"";e.w=tc(e.v,Eu)}else e.t==="d"?e.w=fi(t,ia(e.v),Eu):e.w=fi(t,e.v,Eu)}catch(o){if(n.WTF)throw o}if(n.cellStyles&&r!=null)try{e.s=i.Fills[r],e.s.fgColor&&e.s.fgColor.theme&&!e.s.fgColor.rgb&&(e.s.fgColor.rgb=N1(a.themeElements.clrScheme[e.s.fgColor.theme].rgb,e.s.fgColor.tint||0),n.WTF&&(e.s.fgColor.raw_rgb=a.themeElements.clrScheme[e.s.fgColor.theme].rgb)),e.s.bgColor&&e.s.bgColor.theme&&(e.s.bgColor.rgb=N1(a.themeElements.clrScheme[e.s.bgColor.theme].rgb,e.s.bgColor.tint||0),n.WTF&&(e.s.bgColor.raw_rgb=a.themeElements.clrScheme[e.s.bgColor.theme].rgb))}catch(o){if(n.WTF&&i.Fills)throw o}}}function _q(e,t){var r=Or(t);r.s.r<=r.e.r&&r.s.c<=r.e.c&&r.s.r>=0&&r.s.c>=0&&(e["!ref"]=Ut(r))}var Sq=/<(?:\w:)?mergeCell ref="[A-Z0-9:]+"\s*[\/]?>/g,kq=/<(?:\w+:)?sheetData[^>]*>([\s\S]*)<\/(?:\w+:)?sheetData>/,Eq=/<(?:\w:)?hyperlink [^>]*>/mg,Aq=/"(\w*:\w*)"/,Tq=/<(?:\w:)?col\b[^>]*[\/]?>/g,Cq=/<(?:\w:)?autoFilter[^>]*([\/]|>([\s\S]*)<\/(?:\w:)?autoFilter)>/g,Nq=/<(?:\w:)?pageMargins[^>]*\/>/g,tC=/<(?:\w:)?sheetPr\b(?:[^>a-z][^>]*)?\/>/,Pq=/<(?:\w:)?sheetPr[^>]*(?:[\/]|>([\s\S]*)<\/(?:\w:)?sheetPr)>/,Lq=/<(?:\w:)?sheetViews[^>]*(?:[\/]|>([\s\S]*)<\/(?:\w:)?sheetViews)>/;function Fq(e,t,r,n,a,i,s){if(!e)return e;n||(n={"!id":{}});var o=t.dense?[]:{},l={s:{r:2e6,c:2e6},e:{r:0,c:0}},c="",u="",f=e.match(kq);f?(c=e.slice(0,f.index),u=e.slice(f.index+f[0].length)):c=u=e;var p=c.match(tC);p?T5(p[0],o,a,r):(p=c.match(Pq))&&Oq(p[0],p[1]||"",o,a,r);var h=(c.match(/<(?:\w*:)?dimension/)||{index:-1}).index;if(h>0){var g=c.slice(h,h+50).match(Aq);g&&_q(o,g[1])}var m=c.match(Lq);m&&m[1]&&Bq(m[1],a);var b=[];if(t.cellStyles){var x=c.match(Tq);x&&Rq(b,x)}f&&Uq(f[1],o,t,l,i,s);var w=u.match(Cq);w&&(o["!autofilter"]=jq(w[0]));var y=[],A=u.match(Sq);if(A)for(h=0;h!=A.length;++h)y[h]=Or(A[h].slice(A[h].indexOf('"')+1));var L=u.match(Eq);L&&Dq(o,L,n);var D=u.match(Nq);if(D&&(o["!margins"]=Iq(yt(D[0]))),!o["!ref"]&&l.e.c>=l.s.c&&l.e.r>=l.s.r&&(o["!ref"]=Ut(l)),t.sheetRows>0&&o["!ref"]){var T=Or(o["!ref"]);t.sheetRows<=+T.e.r&&(T.e.r=t.sheetRows-1,T.e.r>l.e.r&&(T.e.r=l.e.r),T.e.r<T.s.r&&(T.s.r=T.e.r),T.e.c>l.e.c&&(T.e.c=l.e.c),T.e.c<T.s.c&&(T.s.c=T.e.c),o["!fullref"]=o["!ref"],o["!ref"]=Ut(T))}return b.length>0&&(o["!cols"]=b),y.length>0&&(o["!merges"]=y),o}function T5(e,t,r,n){var a=yt(e);r.Sheets[n]||(r.Sheets[n]={}),a.codeName&&(r.Sheets[n].CodeName=Ht(pr(a.codeName)))}function Oq(e,t,r,n,a){T5(e.slice(0,e.indexOf(">")),r,n,a)}function Dq(e,t,r){for(var n=Array.isArray(e),a=0;a!=t.length;++a){var i=yt(pr(t[a]),!0);if(!i.ref)return;var s=((r||{})["!id"]||[])[i.id];s?(i.Target=s.Target,i.location&&(i.Target+="#"+Ht(i.location))):(i.Target="#"+Ht(i.location),s={Target:i.Target,TargetMode:"Internal"}),i.Rel=s,i.tooltip&&(i.Tooltip=i.tooltip,delete i.tooltip);for(var o=Or(i.ref),l=o.s.r;l<=o.e.r;++l)for(var c=o.s.c;c<=o.e.c;++c){var u=Ct({c,r:l});n?(e[l]||(e[l]=[]),e[l][c]||(e[l][c]={t:"z",v:void 0}),e[l][c].l=i):(e[u]||(e[u]={t:"z",v:void 0}),e[u].l=i)}}}function Iq(e){var t={};return["left","right","top","bottom","header","footer"].forEach(function(r){e[r]&&(t[r]=parseFloat(e[r]))}),t}function Rq(e,t){for(var r=!1,n=0;n!=t.length;++n){var a=yt(t[n],!0);a.hidden&&(a.hidden=wr(a.hidden));var i=parseInt(a.min,10)-1,s=parseInt(a.max,10)-1;for(a.outlineLevel&&(a.level=+a.outlineLevel||0),delete a.min,delete a.max,a.width=+a.width,!r&&a.width&&(r=!0,E5(a.width)),Hu(a);i<=s;)e[i++]=Sn(a)}}function jq(e){var t={ref:(e.match(/ref="([^"]*)"/)||[])[1]};return t}var Mq=/<(?:\w:)?sheetView(?:[^>a-z][^>]*)?\/?>/;function Bq(e,t){t.Views||(t.Views=[{}]),(e.match(Mq)||[]).forEach(function(r,n){var a=yt(r);t.Views[n]||(t.Views[n]={}),+a.zoomScale&&(t.Views[n].zoom=+a.zoomScale),wr(a.rightToLeft)&&(t.Views[n].RTL=!0)})}var Uq=function(){var e=/<(?:\w+:)?c[ \/>]/,t=/<\/(?:\w+:)?row>/,r=/r=["']([^"']*)["']/,n=/<(?:\w+:)?is>([\S\s]*?)<\/(?:\w+:)?is>/,a=/ref=["']([^"']*)["']/,i=ih("v"),s=ih("f");return function(l,c,u,f,p,h){for(var g=0,m="",b=[],x=[],w=0,y=0,A=0,L="",D,T,F=0,R=0,X,N,P=0,J=0,W=Array.isArray(h.CellXf),se,fe=[],U=[],Q=Array.isArray(c),q=[],he={},xe=!1,E=!!u.sheetStubs,I=l.split(t),O=0,j=I.length;O!=j;++O){m=I[O].trim();var K=m.length;if(K!==0){var ne=0;e:for(g=0;g<K;++g)switch(m[g]){case">":if(m[g-1]!="/"){++g;break e}if(u&&u.cellStyles){if(T=yt(m.slice(ne,g),!0),F=T.r!=null?parseInt(T.r,10):F+1,R=-1,u.sheetRows&&u.sheetRows<F)continue;he={},xe=!1,T.ht&&(xe=!0,he.hpt=parseFloat(T.ht),he.hpx=ch(he.hpt)),T.hidden=="1"&&(xe=!0,he.hidden=!0),T.outlineLevel!=null&&(xe=!0,he.level=+T.outlineLevel),xe&&(q[F-1]=he)}break;case"<":ne=g;break}if(ne>=g)break;if(T=yt(m.slice(ne,g),!0),F=T.r!=null?parseInt(T.r,10):F+1,R=-1,!(u.sheetRows&&u.sheetRows<F)){f.s.r>F-1&&(f.s.r=F-1),f.e.r<F-1&&(f.e.r=F-1),u&&u.cellStyles&&(he={},xe=!1,T.ht&&(xe=!0,he.hpt=parseFloat(T.ht),he.hpx=ch(he.hpt)),T.hidden=="1"&&(xe=!0,he.hidden=!0),T.outlineLevel!=null&&(xe=!0,he.level=+T.outlineLevel),xe&&(q[F-1]=he)),b=m.slice(g).split(e);for(var pe=0;pe!=b.length&&b[pe].trim().charAt(0)=="<";++pe);for(b=b.slice(pe),g=0;g!=b.length;++g)if(m=b[g].trim(),m.length!==0){if(x=m.match(r),w=g,y=0,A=0,m="<c "+(m.slice(0,1)=="<"?">":"")+m,x!=null&&x.length===2){for(w=0,L=x[1],y=0;y!=L.length&&!((A=L.charCodeAt(y)-64)<1||A>26);++y)w=26*w+A;--w,R=w}else++R;for(y=0;y!=m.length&&m.charCodeAt(y)!==62;++y);if(++y,T=yt(m.slice(0,y),!0),T.r||(T.r=Ct({r:F-1,c:R})),L=m.slice(y),D={t:""},(x=L.match(i))!=null&&x[1]!==""&&(D.v=Ht(x[1])),u.cellFormula){if((x=L.match(s))!=null&&x[1]!==""){if(D.f=Ht(pr(x[1])).replace(/\r\n/g,`
`),u.xlfn||(D.f=K3(D.f)),x[0].indexOf('t="array"')>-1)D.F=(L.match(a)||[])[1],D.F.indexOf(":")>-1&&fe.push([Or(D.F),D.F]);else if(x[0].indexOf('t="shared"')>-1){N=yt(x[0]);var de=Ht(pr(x[1]));u.xlfn||(de=K3(de)),U[parseInt(N.si,10)]=[N,de,T.r]}}else(x=L.match(/<f[^>]*\/>/))&&(N=yt(x[0]),U[N.si]&&(D.f=JH(U[N.si][1],U[N.si][2],T.r)));var we=ra(T.r);for(y=0;y<fe.length;++y)we.r>=fe[y][0].s.r&&we.r<=fe[y][0].e.r&&we.c>=fe[y][0].s.c&&we.c<=fe[y][0].e.c&&(D.F=fe[y][1])}if(T.t==null&&D.v===void 0)if(D.f||D.F)D.v=0,D.t="n";else if(E)D.t="z";else continue;else D.t=T.t||"n";switch(f.s.c>R&&(f.s.c=R),f.e.c<R&&(f.e.c=R),D.t){case"n":if(D.v==""||D.v==null){if(!E)continue;D.t="z"}else D.v=parseFloat(D.v);break;case"s":if(typeof D.v>"u"){if(!E)continue;D.t="z"}else X=C0[parseInt(D.v,10)],D.v=X.t,D.r=X.r,u.cellHTML&&(D.h=X.h);break;case"str":D.t="s",D.v=D.v!=null?pr(D.v):"",u.cellHTML&&(D.h=p5(D.v));break;case"inlineStr":x=L.match(n),D.t="s",x!=null&&(X=k5(x[1]))?(D.v=X.t,u.cellHTML&&(D.h=X.h)):D.v="";break;case"b":D.v=wr(D.v);break;case"d":u.cellDates?D.v=vn(D.v,1):(D.v=ia(vn(D.v,1)),D.t="n");break;case"e":(!u||u.cellText!==!1)&&(D.w=D.v),D.v=_T[D.v];break}if(P=J=0,se=null,W&&T.s!==void 0&&(se=h.CellXf[T.s],se!=null&&(se.numFmtId!=null&&(P=se.numFmtId),u.cellStyles&&se.fillId!=null&&(J=se.fillId))),eC(D,P,J,u,p,h),u.cellDates&&W&&D.t=="n"&&Zu(Ft[P])&&(D.t="d",D.v=Tm(D.v)),T.cm&&u.xlmeta){var Pe=(u.xlmeta.Cell||[])[+T.cm-1];Pe&&Pe.type=="XLDAPR"&&(D.D=!0)}if(Q){var Z=ra(T.r);c[Z.r]||(c[Z.r]=[]),c[Z.r][Z.c]=D}else c[T.r]=D}}}}q.length>0&&(c["!rows"]=q)}}();function Vq(e,t){var r={},n=e.l+t;r.r=e.read_shift(4),e.l+=4;var a=e.read_shift(2);e.l+=1;var i=e.read_shift(1);return e.l=n,i&7&&(r.level=i&7),i&16&&(r.hidden=!0),i&32&&(r.hpt=a/20),r}var $q=pc;function zq(){}function Hq(e,t){var r={},n=e[e.l];return++e.l,r.above=!(n&64),r.left=!(n&128),e.l+=18,r.name=hV(e),r}function Wq(e){var t=hi(e);return[t]}function qq(e){var t=dc(e);return[t]}function Gq(e){var t=hi(e),r=e.read_shift(1);return[t,r,"b"]}function Kq(e){var t=dc(e),r=e.read_shift(1);return[t,r,"b"]}function Xq(e){var t=hi(e),r=e.read_shift(1);return[t,r,"e"]}function Yq(e){var t=dc(e),r=e.read_shift(1);return[t,r,"e"]}function Jq(e){var t=hi(e),r=e.read_shift(4);return[t,r,"s"]}function Qq(e){var t=dc(e),r=e.read_shift(4);return[t,r,"s"]}function Zq(e){var t=hi(e),r=Vn(e);return[t,r,"n"]}function rC(e){var t=dc(e),r=Vn(e);return[t,r,"n"]}function eG(e){var t=hi(e),r=b5(e);return[t,r,"n"]}function tG(e){var t=dc(e),r=b5(e);return[t,r,"n"]}function rG(e){var t=hi(e),r=y5(e);return[t,r,"is"]}function nG(e){var t=hi(e),r=Hn(e);return[t,r,"str"]}function aG(e){var t=dc(e),r=Hn(e);return[t,r,"str"]}function iG(e,t,r){var n=e.l+t,a=hi(e);a.r=r["!row"];var i=e.read_shift(1),s=[a,i,"b"];if(r.cellFormula){e.l+=2;var o=Pm(e,n-e.l,r);s[3]=Bn(o,null,a,r.supbooks,r)}else e.l=n;return s}function sG(e,t,r){var n=e.l+t,a=hi(e);a.r=r["!row"];var i=e.read_shift(1),s=[a,i,"e"];if(r.cellFormula){e.l+=2;var o=Pm(e,n-e.l,r);s[3]=Bn(o,null,a,r.supbooks,r)}else e.l=n;return s}function oG(e,t,r){var n=e.l+t,a=hi(e);a.r=r["!row"];var i=Vn(e),s=[a,i,"n"];if(r.cellFormula){e.l+=2;var o=Pm(e,n-e.l,r);s[3]=Bn(o,null,a,r.supbooks,r)}else e.l=n;return s}function lG(e,t,r){var n=e.l+t,a=hi(e);a.r=r["!row"];var i=Hn(e),s=[a,i,"str"];if(r.cellFormula){e.l+=2;var o=Pm(e,n-e.l,r);s[3]=Bn(o,null,a,r.supbooks,r)}else e.l=n;return s}var cG=pc;function uG(e,t){var r=e.l+t,n=pc(e),a=w5(e),i=Hn(e),s=Hn(e),o=Hn(e);e.l=r;var l={rfx:n,relId:a,loc:i,display:o};return s&&(l.Tooltip=s),l}function fG(){}function hG(e,t,r){var n=e.l+t,a=yT(e),i=e.read_shift(1),s=[a];if(s[2]=i,r.cellFormula){var o=vq(e,n-e.l,r);s[1]=o}else e.l=n;return s}function dG(e,t,r){var n=e.l+t,a=pc(e),i=[a];if(r.cellFormula){var s=yq(e,n-e.l,r);i[1]=s,e.l=n}else e.l=n;return i}var pG=["left","right","top","bottom","header","footer"];function mG(e){var t={};return pG.forEach(function(r){t[r]=Vn(e)}),t}function gG(e){var t=e.read_shift(2);return e.l+=28,{RTL:t&32}}function vG(){}function xG(){}function yG(e,t,r,n,a,i,s){if(!e)return e;var o=t||{};n||(n={"!id":{}});var l=o.dense?[]:{},c,u={s:{r:2e6,c:2e6},e:{r:0,c:0}},f=!1,p=!1,h,g,m,b,x,w,y,A,L,D=[];o.biff=12,o["!row"]=0;var T=0,F=!1,R=[],X={},N=o.supbooks||a.supbooks||[[]];if(N.sharedf=X,N.arrayf=R,N.SheetNames=a.SheetNames||a.Sheets.map(function(Q){return Q.name}),!o.supbooks&&(o.supbooks=N,a.Names))for(var P=0;P<a.Names.length;++P)N[0][P+1]=a.Names[P];var J=[],W=[],se=!1;F1[16]={n:"BrtShortReal",f:rC};var fe;if(no(e,function(q,he,xe){if(!p)switch(xe){case 148:c=q;break;case 0:h=q,o.sheetRows&&o.sheetRows<=h.r&&(p=!0),A=kn(b=h.r),o["!row"]=h.r,(q.hidden||q.hpt||q.level!=null)&&(q.hpt&&(q.hpx=ch(q.hpt)),W[q.r]=q);break;case 2:case 3:case 4:case 5:case 6:case 7:case 8:case 9:case 10:case 11:case 13:case 14:case 15:case 16:case 17:case 18:case 62:switch(g={t:q[2]},q[2]){case"n":g.v=q[1];break;case"s":y=C0[q[1]],g.v=y.t,g.r=y.r;break;case"b":g.v=!!q[1];break;case"e":g.v=q[1],o.cellText!==!1&&(g.w=mc[g.v]);break;case"str":g.t="s",g.v=q[1];break;case"is":g.t="s",g.v=q[1].t;break}if((m=s.CellXf[q[0].iStyleRef])&&eC(g,m.numFmtId,null,o,i,s),x=q[0].c==-1?x+1:q[0].c,o.dense?(l[b]||(l[b]=[]),l[b][x]=g):l[sn(x)+A]=g,o.cellFormula){for(F=!1,T=0;T<R.length;++T){var E=R[T];h.r>=E[0].s.r&&h.r<=E[0].e.r&&x>=E[0].s.c&&x<=E[0].e.c&&(g.F=Ut(E[0]),F=!0)}!F&&q.length>3&&(g.f=q[3])}if(u.s.r>h.r&&(u.s.r=h.r),u.s.c>x&&(u.s.c=x),u.e.r<h.r&&(u.e.r=h.r),u.e.c<x&&(u.e.c=x),o.cellDates&&m&&g.t=="n"&&Zu(Ft[m.numFmtId])){var I=Vl(g.v);I&&(g.t="d",g.v=new Date(I.y,I.m-1,I.d,I.H,I.M,I.S,I.u))}fe&&(fe.type=="XLDAPR"&&(g.D=!0),fe=void 0);break;case 1:case 12:if(!o.sheetStubs||f)break;g={t:"z",v:void 0},x=q[0].c==-1?x+1:q[0].c,o.dense?(l[b]||(l[b]=[]),l[b][x]=g):l[sn(x)+A]=g,u.s.r>h.r&&(u.s.r=h.r),u.s.c>x&&(u.s.c=x),u.e.r<h.r&&(u.e.r=h.r),u.e.c<x&&(u.e.c=x),fe&&(fe.type=="XLDAPR"&&(g.D=!0),fe=void 0);break;case 176:D.push(q);break;case 49:fe=((o.xlmeta||{}).Cell||[])[q-1];break;case 494:var O=n["!id"][q.relId];for(O?(q.Target=O.Target,q.loc&&(q.Target+="#"+q.loc),q.Rel=O):q.relId==""&&(q.Target="#"+q.loc),b=q.rfx.s.r;b<=q.rfx.e.r;++b)for(x=q.rfx.s.c;x<=q.rfx.e.c;++x)o.dense?(l[b]||(l[b]=[]),l[b][x]||(l[b][x]={t:"z",v:void 0}),l[b][x].l=q):(w=Ct({c:x,r:b}),l[w]||(l[w]={t:"z",v:void 0}),l[w].l=q);break;case 426:if(!o.cellFormula)break;R.push(q),L=o.dense?l[b][x]:l[sn(x)+A],L.f=Bn(q[1],u,{r:h.r,c:x},N,o),L.F=Ut(q[0]);break;case 427:if(!o.cellFormula)break;X[Ct(q[0].s)]=q[1],L=o.dense?l[b][x]:l[sn(x)+A],L.f=Bn(q[1],u,{r:h.r,c:x},N,o);break;case 60:if(!o.cellStyles)break;for(;q.e>=q.s;)J[q.e--]={width:q.w/256,hidden:!!(q.flags&1),level:q.level},se||(se=!0,E5(q.w/256)),Hu(J[q.e+1]);break;case 161:l["!autofilter"]={ref:Ut(q)};break;case 476:l["!margins"]=q;break;case 147:a.Sheets[r]||(a.Sheets[r]={}),q.name&&(a.Sheets[r].CodeName=q.name),(q.above||q.left)&&(l["!outline"]={above:q.above,left:q.left});break;case 137:a.Views||(a.Views=[{}]),a.Views[0]||(a.Views[0]={}),q.RTL&&(a.Views[0].RTL=!0);break;case 485:break;case 64:case 1053:break;case 151:break;case 152:case 175:case 644:case 625:case 562:case 396:case 1112:case 1146:case 471:case 1050:case 649:case 1105:case 589:case 607:case 564:case 1055:case 168:case 174:case 1180:case 499:case 507:case 550:case 171:case 167:case 1177:case 169:case 1181:case 551:case 552:case 661:case 639:case 478:case 537:case 477:case 536:case 1103:case 680:case 1104:case 1024:case 663:case 535:case 678:case 504:case 1043:case 428:case 170:case 3072:case 50:case 2070:case 1045:break;case 35:f=!0;break;case 36:f=!1;break;case 37:f=!0;break;case 38:f=!1;break;default:if(!he.T){if(!f||o.WTF)throw new Error("Unexpected record 0x"+xe.toString(16))}}},o),delete o.supbooks,delete o["!row"],!l["!ref"]&&(u.s.r<2e6||c&&(c.e.r>0||c.e.c>0||c.s.r>0||c.s.c>0))&&(l["!ref"]=Ut(c||u)),o.sheetRows&&l["!ref"]){var U=Or(l["!ref"]);o.sheetRows<=+U.e.r&&(U.e.r=o.sheetRows-1,U.e.r>u.e.r&&(U.e.r=u.e.r),U.e.r<U.s.r&&(U.s.r=U.e.r),U.e.c>u.e.c&&(U.e.c=u.e.c),U.e.c<U.s.c&&(U.s.c=U.e.c),l["!fullref"]=l["!ref"],l["!ref"]=Ut(U))}return D.length>0&&(l["!merges"]=D),J.length>0&&(l["!cols"]=J),W.length>0&&(l["!rows"]=W),l}function wG(e){var t=[],r=e.match(/^<c:numCache>/),n;(e.match(/<c:pt idx="(\d*)">(.*?)<\/c:pt>/mg)||[]).forEach(function(i){var s=i.match(/<c:pt idx="(\d*?)"><c:v>(.*)<\/c:v><\/c:pt>/);s&&(t[+s[1]]=r?+s[2]:s[2])});var a=Ht((e.match(/<c:formatCode>([\s\S]*?)<\/c:formatCode>/)||["","General"])[1]);return(e.match(/<c:f>(.*?)<\/c:f>/mg)||[]).forEach(function(i){n=i.replace(/<.*?>/g,"")}),[t,a,n]}function bG(e,t,r,n,a,i){var s=i||{"!type":"chart"};if(!e)return i;var o=0,l=0,c="A",u={s:{r:2e6,c:2e6},e:{r:0,c:0}};return(e.match(/<c:numCache>[\s\S]*?<\/c:numCache>/gm)||[]).forEach(function(f){var p=wG(f);u.s.r=u.s.c=0,u.e.c=o,c=sn(o),p[0].forEach(function(h,g){s[c+kn(g)]={t:"n",v:h,z:p[1]},l=g}),u.e.r<l&&(u.e.r=l),++o}),o>0&&(s["!ref"]=Ut(u)),s}function _G(e,t,r,n,a){if(!e)return e;n||(n={"!id":{}});var i={"!type":"chart","!drawel":null,"!rel":""},s,o=e.match(tC);return o&&T5(o[0],i,a,r),(s=e.match(/drawing r:id="(.*?)"/))&&(i["!rel"]=s[1]),n["!id"][i["!rel"]]&&(i["!drawel"]=n["!id"][i["!rel"]]),i}function SG(e,t){e.l+=10;var r=Hn(e);return{name:r}}function kG(e,t,r,n,a){if(!e)return e;n||(n={"!id":{}});var i={"!type":"chart","!drawel":null,"!rel":""},s=!1;return no(e,function(l,c,u){switch(u){case 550:i["!rel"]=l;break;case 651:a.Sheets[r]||(a.Sheets[r]={}),l.name&&(a.Sheets[r].CodeName=l.name);break;case 562:case 652:case 669:case 679:case 551:case 552:case 476:case 3072:break;case 35:s=!0;break;case 36:s=!1;break;case 37:break;case 38:break;default:if(!(c.T>0)){if(!(c.T<0)){if(!s||t.WTF)throw new Error("Unexpected record 0x"+u.toString(16))}}}},t),n["!id"][i["!rel"]]&&(i["!drawel"]=n["!id"][i["!rel"]]),i}var nC=[["allowRefreshQuery",!1,"bool"],["autoCompressPictures",!0,"bool"],["backupFile",!1,"bool"],["checkCompatibility",!1,"bool"],["CodeName",""],["date1904",!1,"bool"],["defaultThemeVersion",0,"int"],["filterPrivacy",!1,"bool"],["hidePivotFieldList",!1,"bool"],["promptedSolutions",!1,"bool"],["publishItems",!1,"bool"],["refreshAllConnections",!1,"bool"],["saveExternalLinkValues",!0,"bool"],["showBorderUnselectedTables",!0,"bool"],["showInkAnnotation",!0,"bool"],["showObjects","all"],["showPivotChartFilter",!1,"bool"],["updateLinks","userSet"]],EG=[["activeTab",0,"int"],["autoFilterDateGrouping",!0,"bool"],["firstSheet",0,"int"],["minimized",!1,"bool"],["showHorizontalScroll",!0,"bool"],["showSheetTabs",!0,"bool"],["showVerticalScroll",!0,"bool"],["tabRatio",600,"int"],["visibility","visible"]],AG=[],TG=[["calcCompleted","true"],["calcMode","auto"],["calcOnSave","true"],["concurrentCalc","true"],["fullCalcOnLoad","false"],["fullPrecision","true"],["iterate","false"],["iterateCount","100"],["iterateDelta","0.001"],["refMode","A1"]];function Z3(e,t){for(var r=0;r!=e.length;++r)for(var n=e[r],a=0;a!=t.length;++a){var i=t[a];if(n[i[0]]==null)n[i[0]]=i[1];else switch(i[2]){case"bool":typeof n[i[0]]=="string"&&(n[i[0]]=wr(n[i[0]]));break;case"int":typeof n[i[0]]=="string"&&(n[i[0]]=parseInt(n[i[0]],10));break}}}function e_(e,t){for(var r=0;r!=t.length;++r){var n=t[r];if(e[n[0]]==null)e[n[0]]=n[1];else switch(n[2]){case"bool":typeof e[n[0]]=="string"&&(e[n[0]]=wr(e[n[0]]));break;case"int":typeof e[n[0]]=="string"&&(e[n[0]]=parseInt(e[n[0]],10));break}}}function aC(e){e_(e.WBProps,nC),e_(e.CalcPr,TG),Z3(e.WBView,EG),Z3(e.Sheets,AG),Eu.date1904=wr(e.WBProps.date1904)}var CG="][*?/\\".split("");function NG(e,t){if(e.length>31)throw new Error("Sheet names cannot exceed 31 chars");var r=!0;return CG.forEach(function(n){if(e.indexOf(n)!=-1)throw new Error("Sheet name cannot contain : \\ / ? * [ ]")}),r}var PG=/<\w+:workbook/;function LG(e,t){if(!e)throw new Error("Could not find file");var r={AppVersion:{},WBProps:{},WBView:[],Sheets:[],CalcPr:{},Names:[],xmlns:""},n=!1,a="xmlns",i={},s=0;if(e.replace(Gn,function(l,c){var u=yt(l);switch(ms(u[0])){case"<?xml":break;case"<workbook":l.match(PG)&&(a="xmlns"+l.match(/<(\w+):/)[1]),r.xmlns=u[a];break;case"</workbook>":break;case"<fileVersion":delete u[0],r.AppVersion=u;break;case"<fileVersion/>":case"</fileVersion>":break;case"<fileSharing":break;case"<fileSharing/>":break;case"<workbookPr":case"<workbookPr/>":nC.forEach(function(f){if(u[f[0]]!=null)switch(f[2]){case"bool":r.WBProps[f[0]]=wr(u[f[0]]);break;case"int":r.WBProps[f[0]]=parseInt(u[f[0]],10);break;default:r.WBProps[f[0]]=u[f[0]]}}),u.codeName&&(r.WBProps.CodeName=pr(u.codeName));break;case"</workbookPr>":break;case"<workbookProtection":break;case"<workbookProtection/>":break;case"<bookViews":case"<bookViews>":case"</bookViews>":break;case"<workbookView":case"<workbookView/>":delete u[0],r.WBView.push(u);break;case"</workbookView>":break;case"<sheets":case"<sheets>":case"</sheets>":break;case"<sheet":switch(u.state){case"hidden":u.Hidden=1;break;case"veryHidden":u.Hidden=2;break;default:u.Hidden=0}delete u.state,u.name=Ht(pr(u.name)),delete u[0],r.Sheets.push(u);break;case"</sheet>":break;case"<functionGroups":case"<functionGroups/>":break;case"<functionGroup":break;case"<externalReferences":case"</externalReferences>":case"<externalReferences>":break;case"<externalReference":break;case"<definedNames/>":break;case"<definedNames>":case"<definedNames":n=!0;break;case"</definedNames>":n=!1;break;case"<definedName":i={},i.Name=pr(u.name),u.comment&&(i.Comment=u.comment),u.localSheetId&&(i.Sheet=+u.localSheetId),wr(u.hidden||"0")&&(i.Hidden=!0),s=c+l.length;break;case"</definedName>":i.Ref=Ht(pr(e.slice(s,c))),r.Names.push(i);break;case"<definedName/>":break;case"<calcPr":delete u[0],r.CalcPr=u;break;case"<calcPr/>":delete u[0],r.CalcPr=u;break;case"</calcPr>":break;case"<oleSize":break;case"<customWorkbookViews>":case"</customWorkbookViews>":case"<customWorkbookViews":break;case"<customWorkbookView":case"</customWorkbookView>":break;case"<pivotCaches>":case"</pivotCaches>":case"<pivotCaches":break;case"<pivotCache":break;case"<smartTagPr":case"<smartTagPr/>":break;case"<smartTagTypes":case"<smartTagTypes>":case"</smartTagTypes>":break;case"<smartTagType":break;case"<webPublishing":case"<webPublishing/>":break;case"<fileRecoveryPr":case"<fileRecoveryPr/>":break;case"<webPublishObjects>":case"<webPublishObjects":case"</webPublishObjects>":break;case"<webPublishObject":break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":n=!0;break;case"</ext>":n=!1;break;case"<ArchID":break;case"<AlternateContent":case"<AlternateContent>":n=!0;break;case"</AlternateContent>":n=!1;break;case"<revisionPtr":break;default:if(!n&&t.WTF)throw new Error("unrecognized "+u[0]+" in workbook")}return l}),XU.indexOf(r.xmlns)===-1)throw new Error("Unknown Namespace: "+r.xmlns);return aC(r),r}function FG(e,t){var r={};return r.Hidden=e.read_shift(4),r.iTabID=e.read_shift(4),r.strRelID=ix(e),r.name=Hn(e),r}function OG(e,t){var r={},n=e.read_shift(4);r.defaultThemeVersion=e.read_shift(4);var a=t>8?Hn(e):"";return a.length>0&&(r.CodeName=a),r.autoCompressPictures=!!(n&65536),r.backupFile=!!(n&64),r.checkCompatibility=!!(n&4096),r.date1904=!!(n&1),r.filterPrivacy=!!(n&8),r.hidePivotFieldList=!!(n&1024),r.promptedSolutions=!!(n&16),r.publishItems=!!(n&2048),r.refreshAllConnections=!!(n&262144),r.saveExternalLinkValues=!!(n&128),r.showBorderUnselectedTables=!!(n&4),r.showInkAnnotation=!!(n&32),r.showObjects=["all","placeholders","none"][n>>13&3],r.showPivotChartFilter=!!(n&32768),r.updateLinks=["userSet","never","always"][n>>8&3],r}function DG(e,t){var r={};return e.read_shift(4),r.ArchID=e.read_shift(4),e.l+=t-8,r}function IG(e,t,r){var n=e.l+t;e.l+=4,e.l+=1;var a=e.read_shift(4),i=dV(e),s=xq(e,0,r),o=w5(e);e.l=n;var l={Name:i,Ptg:s};return a<268435455&&(l.Sheet=a),o&&(l.Comment=o),l}function RG(e,t){var r={AppVersion:{},WBProps:{},WBView:[],Sheets:[],CalcPr:{},xmlns:""},n=[],a=!1;t||(t={}),t.biff=12;var i=[],s=[[]];return s.SheetNames=[],s.XTI=[],F1[16]={n:"BrtFRTArchID$",f:DG},no(e,function(l,c,u){switch(u){case 156:s.SheetNames.push(l.name),r.Sheets.push(l);break;case 153:r.WBProps=l;break;case 39:l.Sheet!=null&&(t.SID=l.Sheet),l.Ref=Bn(l.Ptg,null,null,s,t),delete t.SID,delete l.Ptg,i.push(l);break;case 1036:break;case 357:case 358:case 355:case 667:s[0].length?s.push([u,l]):s[0]=[u,l],s[s.length-1].XTI=[];break;case 362:s.length===0&&(s[0]=[],s[0].XTI=[]),s[s.length-1].XTI=s[s.length-1].XTI.concat(l),s.XTI=s.XTI.concat(l);break;case 361:break;case 2071:case 158:case 143:case 664:case 353:break;case 3072:case 3073:case 534:case 677:case 157:case 610:case 2050:case 155:case 548:case 676:case 128:case 665:case 2128:case 2125:case 549:case 2053:case 596:case 2076:case 2075:case 2082:case 397:case 154:case 1117:case 553:case 2091:break;case 35:n.push(u),a=!0;break;case 36:n.pop(),a=!1;break;case 37:n.push(u),a=!0;break;case 38:n.pop(),a=!1;break;case 16:break;default:if(!c.T){if(!a||t.WTF&&n[n.length-1]!=37&&n[n.length-1]!=35)throw new Error("Unexpected record 0x"+u.toString(16))}}},t),aC(r),r.Names=i,r.supbooks=s,r}function jG(e,t,r){return t.slice(-4)===".bin"?RG(e,r):LG(e,r)}function MG(e,t,r,n,a,i,s,o){return t.slice(-4)===".bin"?yG(e,n,r,a,i,s,o):Fq(e,n,r,a,i,s,o)}function BG(e,t,r,n,a,i,s,o){return t.slice(-4)===".bin"?kG(e,n,r,a,i):_G(e,n,r,a,i)}function UG(e,t,r,n,a,i,s,o){return t.slice(-4)===".bin"?KH():XH()}function VG(e,t,r,n,a,i,s,o){return t.slice(-4)===".bin"?qH():GH()}function $G(e,t,r,n){return t.slice(-4)===".bin"?cH(e,r,n):nH(e,r,n)}function zG(e,t,r){return HT(e,r)}function HG(e,t,r){return t.slice(-4)===".bin"?Ez(e,r):Sz(e,r)}function WG(e,t,r){return t.slice(-4)===".bin"?zH(e,r):MH(e,r)}function qG(e,t,r){return t.slice(-4)===".bin"?IH(e):OH(e)}function GG(e,t,r,n){return r.slice(-4)===".bin"?RH(e,t,r,n):void 0}function KG(e,t,r){return t.slice(-4)===".bin"?LH(e,t,r):FH(e,t,r)}var iC=/([\w:]+)=((?:")([^"]*)(?:")|(?:')([^']*)(?:'))/g,sC=/([\w:]+)=((?:")(?:[^"]*)(?:")|(?:')(?:[^']*)(?:'))/;function _i(e,t){var r=e.split(/\s+/),n=[];if(n[0]=r[0],r.length===1)return n;var a=e.match(iC),i,s,o,l;if(a)for(l=0;l!=a.length;++l)i=a[l].match(sC),(s=i[1].indexOf(":"))===-1?n[i[1]]=i[2].slice(1,i[2].length-1):(i[1].slice(0,6)==="xmlns:"?o="xmlns"+i[1].slice(6):o=i[1].slice(s+1),n[o]=i[2].slice(1,i[2].length-1));return n}function XG(e){var t=e.split(/\s+/),r={};if(t.length===1)return r;var n=e.match(iC),a,i,s,o;if(n)for(o=0;o!=n.length;++o)a=n[o].match(sC),(i=a[1].indexOf(":"))===-1?r[a[1]]=a[2].slice(1,a[2].length-1):(a[1].slice(0,6)==="xmlns:"?s="xmlns"+a[1].slice(6):s=a[1].slice(i+1),r[s]=a[2].slice(1,a[2].length-1));return r}var P0;function YG(e,t){var r=P0[e]||Ht(e);return r==="General"?tc(t):fi(r,t)}function JG(e,t,r,n){var a=n;switch((r[0].match(/dt:dt="([\w.]+)"/)||["",""])[1]){case"boolean":a=wr(n);break;case"i2":case"int":a=parseInt(n,10);break;case"r4":case"float":a=parseFloat(n);break;case"date":case"dateTime.tz":a=vn(n);break;case"i8":case"string":case"fixed":case"uuid":case"bin.base64":break;default:throw new Error("bad custprop:"+r[0])}e[Ht(t)]=a}function QG(e,t,r){if(e.t!=="z"){if(!r||r.cellText!==!1)try{e.t==="e"?e.w=e.w||mc[e.v]:t==="General"?e.t==="n"?(e.v|0)===e.v?e.w=e.v.toString(10):e.w=ah(e.v):e.w=tc(e.v):e.w=YG(t||"General",e.v)}catch(i){if(r.WTF)throw i}try{var n=P0[t]||t||"General";if(r.cellNF&&(e.z=n),r.cellDates&&e.t=="n"&&Zu(n)){var a=Vl(e.v);a&&(e.t="d",e.v=new Date(a.y,a.m-1,a.d,a.H,a.M,a.S,a.u))}}catch(i){if(r.WTF)throw i}}}function ZG(e,t,r){if(r.cellStyles&&t.Interior){var n=t.Interior;n.Pattern&&(n.patternType=Jz[n.Pattern]||n.Pattern)}e[t.ID]=t}function eK(e,t,r,n,a,i,s,o,l,c){var u="General",f=n.StyleID,p={};c=c||{};var h=[],g=0;for(f===void 0&&o&&(f=o.StyleID),f===void 0&&s&&(f=s.StyleID);i[f]!==void 0&&(i[f].nf&&(u=i[f].nf),i[f].Interior&&h.push(i[f].Interior),!!i[f].Parent);)f=i[f].Parent;switch(r.Type){case"Boolean":n.t="b",n.v=wr(e);break;case"String":n.t="s",n.r=_3(Ht(e)),n.v=e.indexOf("<")>-1?Ht(t||e).replace(/<.*?>/g,""):n.r;break;case"DateTime":e.slice(-1)!="Z"&&(e+="Z"),n.v=(vn(e)-new Date(Date.UTC(1899,11,30)))/(24*60*60*1e3),n.v!==n.v?n.v=Ht(e):n.v<60&&(n.v=n.v-1),(!u||u=="General")&&(u="yyyy-mm-dd");case"Number":n.v===void 0&&(n.v=+e),n.t||(n.t="n");break;case"Error":n.t="e",n.v=_T[e],c.cellText!==!1&&(n.w=e);break;default:e==""&&t==""?n.t="z":(n.t="s",n.v=_3(t||e));break}if(QG(n,u,c),c.cellFormula!==!1)if(n.Formula){var m=Ht(n.Formula);m.charCodeAt(0)==61&&(m=m.slice(1)),n.f=ku(m,a),delete n.Formula,n.ArrayRange=="RC"?n.F=ku("RC:RC",a):n.ArrayRange&&(n.F=ku(n.ArrayRange,a),l.push([Or(n.F),n.F]))}else for(g=0;g<l.length;++g)a.r>=l[g][0].s.r&&a.r<=l[g][0].e.r&&a.c>=l[g][0].s.c&&a.c<=l[g][0].e.c&&(n.F=l[g][1]);c.cellStyles&&(h.forEach(function(b){!p.patternType&&b.patternType&&(p.patternType=b.patternType)}),n.s=p),n.StyleID!==void 0&&(n.ixfe=n.StyleID)}function tK(e){e.t=e.v||"",e.t=e.t.replace(/\r\n/g,`
`).replace(/\r/g,`
`),e.v=e.w=e.ixfe=void 0}function x2(e,t){var r=t||{};KA();var n=Qf(m5(e));(r.type=="binary"||r.type=="array"||r.type=="base64")&&(n=pr(n));var a=n.slice(0,1024).toLowerCase(),i=!1;if(a=a.replace(/".*?"/g,""),(a.indexOf(">")&1023)>Math.min(a.indexOf(",")&1023,a.indexOf(";")&1023)){var s=Sn(r);return s.type="string",oh.to_workbook(n,s)}if(a.indexOf("<?xml")==-1&&["html","table","head","meta","script","style","div"].forEach(function(Xe){a.indexOf("<"+Xe)>=0&&(i=!0)}),i)return uK(n,r);P0={"General Number":"General","General Date":Ft[22],"Long Date":"dddd, mmmm dd, yyyy","Medium Date":Ft[15],"Short Date":Ft[14],"Long Time":Ft[19],"Medium Time":Ft[18],"Short Time":Ft[20],Currency:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',Fixed:Ft[2],Standard:Ft[4],Percent:Ft[10],Scientific:Ft[11],"Yes/No":'"Yes";"Yes";"No";@',"True/False":'"True";"True";"False";@',"On/Off":'"Yes";"Yes";"No";@'};var o,l=[],c,u={},f=[],p=r.dense?[]:{},h="",g={},m={},b=_i('<Data ss:Type="String">'),x=0,w=0,y=0,A={s:{r:2e6,c:2e6},e:{r:0,c:0}},L={},D={},T="",F=0,R=[],X={},N={},P=0,J=[],W=[],se={},fe=[],U,Q=!1,q=[],he=[],xe={},E=0,I=0,O={Sheets:[],WBProps:{date1904:!1}},j={};sh.lastIndex=0,n=n.replace(/<!--([\s\S]*?)-->/mg,"");for(var K="";o=sh.exec(n);)switch(o[3]=(K=o[3]).toLowerCase()){case"data":if(K=="data"){if(o[1]==="/"){if((c=l.pop())[0]!==o[3])throw new Error("Bad state: "+c.join("|"))}else o[0].charAt(o[0].length-2)!=="/"&&l.push([o[3],!0]);break}if(l[l.length-1][1])break;o[1]==="/"?eK(n.slice(x,o.index),T,b,l[l.length-1][0]=="comment"?se:g,{c:w,r:y},L,fe[w],m,q,r):(T="",b=_i(o[0]),x=o.index+o[0].length);break;case"cell":if(o[1]==="/")if(W.length>0&&(g.c=W),(!r.sheetRows||r.sheetRows>y)&&g.v!==void 0&&(r.dense?(p[y]||(p[y]=[]),p[y][w]=g):p[sn(w)+kn(y)]=g),g.HRef&&(g.l={Target:Ht(g.HRef)},g.HRefScreenTip&&(g.l.Tooltip=g.HRefScreenTip),delete g.HRef,delete g.HRefScreenTip),(g.MergeAcross||g.MergeDown)&&(E=w+(parseInt(g.MergeAcross,10)|0),I=y+(parseInt(g.MergeDown,10)|0),R.push({s:{c:w,r:y},e:{c:E,r:I}})),!r.sheetStubs)g.MergeAcross?w=E+1:++w;else if(g.MergeAcross||g.MergeDown){for(var ne=w;ne<=E;++ne)for(var pe=y;pe<=I;++pe)(ne>w||pe>y)&&(r.dense?(p[pe]||(p[pe]=[]),p[pe][ne]={t:"z"}):p[sn(ne)+kn(pe)]={t:"z"});w=E+1}else++w;else g=XG(o[0]),g.Index&&(w=+g.Index-1),w<A.s.c&&(A.s.c=w),w>A.e.c&&(A.e.c=w),o[0].slice(-2)==="/>"&&++w,W=[];break;case"row":o[1]==="/"||o[0].slice(-2)==="/>"?(y<A.s.r&&(A.s.r=y),y>A.e.r&&(A.e.r=y),o[0].slice(-2)==="/>"&&(m=_i(o[0]),m.Index&&(y=+m.Index-1)),w=0,++y):(m=_i(o[0]),m.Index&&(y=+m.Index-1),xe={},(m.AutoFitHeight=="0"||m.Height)&&(xe.hpx=parseInt(m.Height,10),xe.hpt=zT(xe.hpx),he[y]=xe),m.Hidden=="1"&&(xe.hidden=!0,he[y]=xe));break;case"worksheet":if(o[1]==="/"){if((c=l.pop())[0]!==o[3])throw new Error("Bad state: "+c.join("|"));f.push(h),A.s.r<=A.e.r&&A.s.c<=A.e.c&&(p["!ref"]=Ut(A),r.sheetRows&&r.sheetRows<=A.e.r&&(p["!fullref"]=p["!ref"],A.e.r=r.sheetRows-1,p["!ref"]=Ut(A))),R.length&&(p["!merges"]=R),fe.length>0&&(p["!cols"]=fe),he.length>0&&(p["!rows"]=he),u[h]=p}else A={s:{r:2e6,c:2e6},e:{r:0,c:0}},y=w=0,l.push([o[3],!1]),c=_i(o[0]),h=Ht(c.Name),p=r.dense?[]:{},R=[],q=[],he=[],j={name:h,Hidden:0},O.Sheets.push(j);break;case"table":if(o[1]==="/"){if((c=l.pop())[0]!==o[3])throw new Error("Bad state: "+c.join("|"))}else{if(o[0].slice(-2)=="/>")break;l.push([o[3],!1]),fe=[],Q=!1}break;case"style":o[1]==="/"?ZG(L,D,r):D=_i(o[0]);break;case"numberformat":D.nf=Ht(_i(o[0]).Format||"General"),P0[D.nf]&&(D.nf=P0[D.nf]);for(var de=0;de!=392&&Ft[de]!=D.nf;++de);if(de==392){for(de=57;de!=392;++de)if(Ft[de]==null){ql(D.nf,de);break}}break;case"column":if(l[l.length-1][0]!=="table")break;if(U=_i(o[0]),U.Hidden&&(U.hidden=!0,delete U.Hidden),U.Width&&(U.wpx=parseInt(U.Width,10)),!Q&&U.wpx>10){Q=!0,ta=VT;for(var we=0;we<fe.length;++we)fe[we]&&Hu(fe[we])}Q&&Hu(U),fe[U.Index-1||fe.length]=U;for(var Pe=0;Pe<+U.Span;++Pe)fe[fe.length]=Sn(U);break;case"namedrange":if(o[1]==="/")break;O.Names||(O.Names=[]);var Z=yt(o[0]),Ve={Name:Z.Name,Ref:ku(Z.RefersTo.slice(1),{r:0,c:0})};O.Sheets.length>0&&(Ve.Sheet=O.Sheets.length-1),O.Names.push(Ve);break;case"namedcell":break;case"b":break;case"i":break;case"u":break;case"s":break;case"em":break;case"h2":break;case"h3":break;case"sub":break;case"sup":break;case"span":break;case"alignment":break;case"borders":break;case"border":break;case"font":if(o[0].slice(-2)==="/>")break;o[1]==="/"?T+=n.slice(F,o.index):F=o.index+o[0].length;break;case"interior":if(!r.cellStyles)break;D.Interior=_i(o[0]);break;case"protection":break;case"author":case"title":case"description":case"created":case"keywords":case"subject":case"category":case"company":case"lastauthor":case"lastsaved":case"lastprinted":case"version":case"revision":case"totaltime":case"hyperlinkbase":case"manager":case"contentstatus":case"identifier":case"language":case"appname":if(o[0].slice(-2)==="/>")break;o[1]==="/"?MV(X,K,n.slice(P,o.index)):P=o.index+o[0].length;break;case"paragraphs":break;case"styles":case"workbook":if(o[1]==="/"){if((c=l.pop())[0]!==o[3])throw new Error("Bad state: "+c.join("|"))}else l.push([o[3],!1]);break;case"comment":if(o[1]==="/"){if((c=l.pop())[0]!==o[3])throw new Error("Bad state: "+c.join("|"));tK(se),W.push(se)}else l.push([o[3],!1]),c=_i(o[0]),se={a:c.Author};break;case"autofilter":if(o[1]==="/"){if((c=l.pop())[0]!==o[3])throw new Error("Bad state: "+c.join("|"))}else if(o[0].charAt(o[0].length-2)!=="/"){var Ke=_i(o[0]);p["!autofilter"]={ref:ku(Ke.Range).replace(/\$/g,"")},l.push([o[3],!0])}break;case"name":break;case"datavalidation":if(o[1]==="/"){if((c=l.pop())[0]!==o[3])throw new Error("Bad state: "+c.join("|"))}else o[0].charAt(o[0].length-2)!=="/"&&l.push([o[3],!0]);break;case"pixelsperinch":break;case"componentoptions":case"documentproperties":case"customdocumentproperties":case"officedocumentsettings":case"pivottable":case"pivotcache":case"names":case"mapinfo":case"pagebreaks":case"querytable":case"sorting":case"schema":case"conditionalformatting":case"smarttagtype":case"smarttags":case"excelworkbook":case"workbookoptions":case"worksheetoptions":if(o[1]==="/"){if((c=l.pop())[0]!==o[3])throw new Error("Bad state: "+c.join("|"))}else o[0].charAt(o[0].length-2)!=="/"&&l.push([o[3],!0]);break;case"null":break;default:if(l.length==0&&o[3]=="document"||l.length==0&&o[3]=="uof")return s_(n,r);var Ce=!0;switch(l[l.length-1][0]){case"officedocumentsettings":switch(o[3]){case"allowpng":break;case"removepersonalinformation":break;case"downloadcomponents":break;case"locationofcomponents":break;case"colors":break;case"color":break;case"index":break;case"rgb":break;case"targetscreensize":break;case"readonlyrecommended":break;default:Ce=!1}break;case"componentoptions":switch(o[3]){case"toolbar":break;case"hideofficelogo":break;case"spreadsheetautofit":break;case"label":break;case"caption":break;case"maxheight":break;case"maxwidth":break;case"nextsheetnumber":break;default:Ce=!1}break;case"excelworkbook":switch(o[3]){case"date1904":O.WBProps.date1904=!0;break;case"windowheight":break;case"windowwidth":break;case"windowtopx":break;case"windowtopy":break;case"tabratio":break;case"protectstructure":break;case"protectwindow":break;case"protectwindows":break;case"activesheet":break;case"displayinknotes":break;case"firstvisiblesheet":break;case"supbook":break;case"sheetname":break;case"sheetindex":break;case"sheetindexfirst":break;case"sheetindexlast":break;case"dll":break;case"acceptlabelsinformulas":break;case"donotsavelinkvalues":break;case"iteration":break;case"maxiterations":break;case"maxchange":break;case"path":break;case"xct":break;case"count":break;case"selectedsheets":break;case"calculation":break;case"uncalced":break;case"startupprompt":break;case"crn":break;case"externname":break;case"formula":break;case"colfirst":break;case"collast":break;case"wantadvise":break;case"boolean":break;case"error":break;case"text":break;case"ole":break;case"noautorecover":break;case"publishobjects":break;case"donotcalculatebeforesave":break;case"number":break;case"refmoder1c1":break;case"embedsavesmarttags":break;default:Ce=!1}break;case"workbookoptions":switch(o[3]){case"owcversion":break;case"height":break;case"width":break;default:Ce=!1}break;case"worksheetoptions":switch(o[3]){case"visible":if(o[0].slice(-2)!=="/>")if(o[1]==="/")switch(n.slice(P,o.index)){case"SheetHidden":j.Hidden=1;break;case"SheetVeryHidden":j.Hidden=2;break}else P=o.index+o[0].length;break;case"header":p["!margins"]||N0(p["!margins"]={},"xlml"),isNaN(+yt(o[0]).Margin)||(p["!margins"].header=+yt(o[0]).Margin);break;case"footer":p["!margins"]||N0(p["!margins"]={},"xlml"),isNaN(+yt(o[0]).Margin)||(p["!margins"].footer=+yt(o[0]).Margin);break;case"pagemargins":var ae=yt(o[0]);p["!margins"]||N0(p["!margins"]={},"xlml"),isNaN(+ae.Top)||(p["!margins"].top=+ae.Top),isNaN(+ae.Left)||(p["!margins"].left=+ae.Left),isNaN(+ae.Right)||(p["!margins"].right=+ae.Right),isNaN(+ae.Bottom)||(p["!margins"].bottom=+ae.Bottom);break;case"displayrighttoleft":O.Views||(O.Views=[]),O.Views[0]||(O.Views[0]={}),O.Views[0].RTL=!0;break;case"freezepanes":break;case"frozennosplit":break;case"splithorizontal":case"splitvertical":break;case"donotdisplaygridlines":break;case"activerow":break;case"activecol":break;case"toprowbottompane":break;case"leftcolumnrightpane":break;case"unsynced":break;case"print":break;case"printerrors":break;case"panes":break;case"scale":break;case"pane":break;case"number":break;case"layout":break;case"pagesetup":break;case"selected":break;case"protectobjects":break;case"enableselection":break;case"protectscenarios":break;case"validprinterinfo":break;case"horizontalresolution":break;case"verticalresolution":break;case"numberofcopies":break;case"activepane":break;case"toprowvisible":break;case"leftcolumnvisible":break;case"fittopage":break;case"rangeselection":break;case"papersizeindex":break;case"pagelayoutzoom":break;case"pagebreakzoom":break;case"filteron":break;case"fitwidth":break;case"fitheight":break;case"commentslayout":break;case"zoom":break;case"lefttoright":break;case"gridlines":break;case"allowsort":break;case"allowfilter":break;case"allowinsertrows":break;case"allowdeleterows":break;case"allowinsertcols":break;case"allowdeletecols":break;case"allowinserthyperlinks":break;case"allowformatcells":break;case"allowsizecols":break;case"allowsizerows":break;case"nosummaryrowsbelowdetail":p["!outline"]||(p["!outline"]={}),p["!outline"].above=!0;break;case"tabcolorindex":break;case"donotdisplayheadings":break;case"showpagelayoutzoom":break;case"nosummarycolumnsrightdetail":p["!outline"]||(p["!outline"]={}),p["!outline"].left=!0;break;case"blackandwhite":break;case"donotdisplayzeros":break;case"displaypagebreak":break;case"rowcolheadings":break;case"donotdisplayoutline":break;case"noorientation":break;case"allowusepivottables":break;case"zeroheight":break;case"viewablerange":break;case"selection":break;case"protectcontents":break;default:Ce=!1}break;case"pivottable":case"pivotcache":switch(o[3]){case"immediateitemsondrop":break;case"showpagemultipleitemlabel":break;case"compactrowindent":break;case"location":break;case"pivotfield":break;case"orientation":break;case"layoutform":break;case"layoutsubtotallocation":break;case"layoutcompactrow":break;case"position":break;case"pivotitem":break;case"datatype":break;case"datafield":break;case"sourcename":break;case"parentfield":break;case"ptlineitems":break;case"ptlineitem":break;case"countofsameitems":break;case"item":break;case"itemtype":break;case"ptsource":break;case"cacheindex":break;case"consolidationreference":break;case"filename":break;case"reference":break;case"nocolumngrand":break;case"norowgrand":break;case"blanklineafteritems":break;case"hidden":break;case"subtotal":break;case"basefield":break;case"mapchilditems":break;case"function":break;case"refreshonfileopen":break;case"printsettitles":break;case"mergelabels":break;case"defaultversion":break;case"refreshname":break;case"refreshdate":break;case"refreshdatecopy":break;case"versionlastrefresh":break;case"versionlastupdate":break;case"versionupdateablemin":break;case"versionrefreshablemin":break;case"calculation":break;default:Ce=!1}break;case"pagebreaks":switch(o[3]){case"colbreaks":break;case"colbreak":break;case"rowbreaks":break;case"rowbreak":break;case"colstart":break;case"colend":break;case"rowend":break;default:Ce=!1}break;case"autofilter":switch(o[3]){case"autofiltercolumn":break;case"autofiltercondition":break;case"autofilterand":break;case"autofilteror":break;default:Ce=!1}break;case"querytable":switch(o[3]){case"id":break;case"autoformatfont":break;case"autoformatpattern":break;case"querysource":break;case"querytype":break;case"enableredirections":break;case"refreshedinxl9":break;case"urlstring":break;case"htmltables":break;case"connection":break;case"commandtext":break;case"refreshinfo":break;case"notitles":break;case"nextid":break;case"columninfo":break;case"overwritecells":break;case"donotpromptforfile":break;case"textwizardsettings":break;case"source":break;case"number":break;case"decimal":break;case"thousandseparator":break;case"trailingminusnumbers":break;case"formatsettings":break;case"fieldtype":break;case"delimiters":break;case"tab":break;case"comma":break;case"autoformatname":break;case"versionlastedit":break;case"versionlastrefresh":break;default:Ce=!1}break;case"datavalidation":switch(o[3]){case"range":break;case"type":break;case"min":break;case"max":break;case"sort":break;case"descending":break;case"order":break;case"casesensitive":break;case"value":break;case"errorstyle":break;case"errormessage":break;case"errortitle":break;case"inputmessage":break;case"inputtitle":break;case"combohide":break;case"inputhide":break;case"condition":break;case"qualifier":break;case"useblank":break;case"value1":break;case"value2":break;case"format":break;case"cellrangelist":break;default:Ce=!1}break;case"sorting":case"conditionalformatting":switch(o[3]){case"range":break;case"type":break;case"min":break;case"max":break;case"sort":break;case"descending":break;case"order":break;case"casesensitive":break;case"value":break;case"errorstyle":break;case"errormessage":break;case"errortitle":break;case"cellrangelist":break;case"inputmessage":break;case"inputtitle":break;case"combohide":break;case"inputhide":break;case"condition":break;case"qualifier":break;case"useblank":break;case"value1":break;case"value2":break;case"format":break;default:Ce=!1}break;case"mapinfo":case"schema":case"data":switch(o[3]){case"map":break;case"entry":break;case"range":break;case"xpath":break;case"field":break;case"xsdtype":break;case"filteron":break;case"aggregate":break;case"elementtype":break;case"attributetype":break;case"schema":case"element":case"complextype":case"datatype":case"all":case"attribute":case"extends":break;case"row":break;default:Ce=!1}break;case"smarttags":break;default:Ce=!1;break}if(Ce||o[3].match(/!\[CDATA/))break;if(!l[l.length-1][1])throw"Unrecognized tag: "+o[3]+"|"+l.join("|");if(l[l.length-1][0]==="customdocumentproperties"){if(o[0].slice(-2)==="/>")break;o[1]==="/"?JG(N,K,J,n.slice(P,o.index)):(J=o,P=o.index+o[0].length);break}if(r.WTF)throw"Unrecognized tag: "+o[3]+"|"+l.join("|")}var De={};return!r.bookSheets&&!r.bookProps&&(De.Sheets=u),De.SheetNames=f,De.Workbook=O,De.SSF=Sn(Ft),De.Props=X,De.Custprops=N,De}function cx(e,t){switch(P5(t=t||{}),t.type||"base64"){case"base64":return x2(Ba(e),t);case"binary":case"buffer":case"file":return x2(e,t);case"array":return x2(hc(e),t)}}function rK(e){var t={},r=e.content;if(r.l=28,t.AnsiUserType=r.read_shift(0,"lpstr-ansi"),t.AnsiClipboardFormat=gV(r),r.length-r.l<=4)return t;var n=r.read_shift(4);if(n==0||n>40||(r.l-=4,t.Reserved1=r.read_shift(0,"lpstr-ansi"),r.length-r.l<=4)||(n=r.read_shift(4),n!==1907505652)||(t.UnicodeClipboardFormat=vV(r),n=r.read_shift(4),n==0||n>40))return t;r.l-=4,t.Reserved2=r.read_shift(0,"lpwstr")}var nK=[60,1084,2066,2165,2175];function aK(e,t,r,n,a){var i=n,s=[],o=r.slice(r.l,r.l+i);if(a&&a.enc&&a.enc.insitu&&o.length>0)switch(e){case 9:case 521:case 1033:case 2057:case 47:case 405:case 225:case 406:case 312:case 404:case 10:break;case 133:break;default:a.enc.insitu(o)}s.push(o),r.l+=i;for(var l=Ms(r,r.l),c=ux[l],u=0;c!=null&&nK.indexOf(l)>-1;)i=Ms(r,r.l+2),u=r.l+4,l==2066?u+=4:(l==2165||l==2175)&&(u+=12),o=r.slice(u,r.l+4+i),s.push(o),r.l+=4+i,c=ux[l=Ms(r,r.l)];var f=Do(s);bn(f,0);var p=0;f.lens=[];for(var h=0;h<s.length;++h)f.lens.push(p),p+=s[h].length;if(f.length<n)throw"XLS Record 0x"+e.toString(16)+" Truncated: "+f.length+" < "+n;return t.f(f,f.length,a)}function es(e,t,r){if(e.t!=="z"&&e.XF){var n=0;try{n=e.z||e.XF.numFmtId||0,t.cellNF&&(e.z=Ft[n])}catch(i){if(t.WTF)throw i}if(!t||t.cellText!==!1)try{e.t==="e"?e.w=e.w||mc[e.v]:n===0||n=="General"?e.t==="n"?(e.v|0)===e.v?e.w=e.v.toString(10):e.w=ah(e.v):e.w=tc(e.v):e.w=fi(n,e.v,{date1904:!!r,dateNF:t&&t.dateNF})}catch(i){if(t.WTF)throw i}if(t.cellDates&&n&&e.t=="n"&&Zu(Ft[n]||String(n))){var a=Vl(e.v);a&&(e.t="d",e.v=new Date(a.y,a.m-1,a.d,a.H,a.M,a.S,a.u))}}}function cp(e,t,r){return{v:e,ixfe:t,t:r}}function iK(e,t){var r={opts:{}},n={},a=t.dense?[]:{},i={},s={},o=null,l=[],c="",u={},f,p="",h,g,m,b,x={},w=[],y,A,L=[],D=[],T={Sheets:[],WBProps:{date1904:!1},Views:[{}]},F={},R=function(Ze){return Ze<8?Gl[Ze]:Ze<64&&D[Ze-8]||Gl[Ze]},X=function(Ze,ze,Jt){var ht=ze.XF.data;if(!(!ht||!ht.patternType||!Jt||!Jt.cellStyles)){ze.s={},ze.s.patternType=ht.patternType;var Zr;(Zr=lh(R(ht.icvFore)))&&(ze.s.fgColor={rgb:Zr}),(Zr=lh(R(ht.icvBack)))&&(ze.s.bgColor={rgb:Zr})}},N=function(Ze,ze,Jt){if(!(xe>1)&&!(Jt.sheetRows&&Ze.r>=Jt.sheetRows)){if(Jt.cellStyles&&ze.XF&&ze.XF.data&&X(Ze,ze,Jt),delete ze.ixfe,delete ze.XF,f=Ze,p=Ct(Ze),(!s||!s.s||!s.e)&&(s={s:{r:0,c:0},e:{r:0,c:0}}),Ze.r<s.s.r&&(s.s.r=Ze.r),Ze.c<s.s.c&&(s.s.c=Ze.c),Ze.r+1>s.e.r&&(s.e.r=Ze.r+1),Ze.c+1>s.e.c&&(s.e.c=Ze.c+1),Jt.cellFormula&&ze.f){for(var ht=0;ht<w.length;++ht)if(!(w[ht][0].s.c>Ze.c||w[ht][0].s.r>Ze.r)&&!(w[ht][0].e.c<Ze.c||w[ht][0].e.r<Ze.r)){ze.F=Ut(w[ht][0]),(w[ht][0].s.c!=Ze.c||w[ht][0].s.r!=Ze.r)&&delete ze.f,ze.f&&(ze.f=""+Bn(w[ht][1],s,Ze,q,P));break}}Jt.dense?(a[Ze.r]||(a[Ze.r]=[]),a[Ze.r][Ze.c]=ze):a[p]=ze}},P={enc:!1,sbcch:0,snames:[],sharedf:x,arrayf:w,rrtabid:[],lastuser:"",biff:8,codepage:0,winlocked:0,cellStyles:!!t&&!!t.cellStyles,WTF:!!t&&!!t.wtf};t.password&&(P.password=t.password);var J,W=[],se=[],fe=[],U=[],Q=!1,q=[];q.SheetNames=P.snames,q.sharedf=P.sharedf,q.arrayf=P.arrayf,q.names=[],q.XTI=[];var he=0,xe=0,E=0,I=[],O=[],j;P.codepage=1200,Ii(1200);for(var K=!1;e.l<e.length-1;){var ne=e.l,pe=e.read_shift(2);if(pe===0&&he===10)break;var de=e.l===e.length?0:e.read_shift(2),we=ux[pe];if(we&&we.f){if(t.bookSheets&&he===133&&pe!==133)break;if(he=pe,we.r===2||we.r==12){var Pe=e.read_shift(2);if(de-=2,!P.enc&&Pe!==pe&&((Pe&255)<<8|Pe>>8)!==pe)throw new Error("rt mismatch: "+Pe+"!="+pe);we.r==12&&(e.l+=10,de-=10)}var Z={};if(pe===10?Z=we.f(e,de,P):Z=aK(pe,we,e,de,P),xe==0&&[9,521,1033,2057].indexOf(he)===-1)continue;switch(pe){case 34:r.opts.Date1904=T.WBProps.date1904=Z;break;case 134:r.opts.WriteProtect=!0;break;case 47:if(P.enc||(e.l=0),P.enc=Z,!t.password)throw new Error("File is password-protected");if(Z.valid==null)throw new Error("Encryption scheme unsupported");if(!Z.valid)throw new Error("Password is incorrect");break;case 92:P.lastuser=Z;break;case 66:var Ve=Number(Z);switch(Ve){case 21010:Ve=1200;break;case 32768:Ve=1e4;break;case 32769:Ve=1252;break}Ii(P.codepage=Ve),K=!0;break;case 317:P.rrtabid=Z;break;case 25:P.winlocked=Z;break;case 439:r.opts.RefreshAll=Z;break;case 12:r.opts.CalcCount=Z;break;case 16:r.opts.CalcDelta=Z;break;case 17:r.opts.CalcIter=Z;break;case 13:r.opts.CalcMode=Z;break;case 14:r.opts.CalcPrecision=Z;break;case 95:r.opts.CalcSaveRecalc=Z;break;case 15:P.CalcRefMode=Z;break;case 2211:r.opts.FullCalc=Z;break;case 129:Z.fDialog&&(a["!type"]="dialog"),Z.fBelow||((a["!outline"]||(a["!outline"]={})).above=!0),Z.fRight||((a["!outline"]||(a["!outline"]={})).left=!0);break;case 224:L.push(Z);break;case 430:q.push([Z]),q[q.length-1].XTI=[];break;case 35:case 547:q[q.length-1].push(Z);break;case 24:case 536:j={Name:Z.Name,Ref:Bn(Z.rgce,s,null,q,P)},Z.itab>0&&(j.Sheet=Z.itab-1),q.names.push(j),q[0]||(q[0]=[],q[0].XTI=[]),q[q.length-1].push(Z),Z.Name=="_xlnm._FilterDatabase"&&Z.itab>0&&Z.rgce&&Z.rgce[0]&&Z.rgce[0][0]&&Z.rgce[0][0][0]=="PtgArea3d"&&(O[Z.itab-1]={ref:Ut(Z.rgce[0][0][1][2])});break;case 22:P.ExternCount=Z;break;case 23:q.length==0&&(q[0]=[],q[0].XTI=[]),q[q.length-1].XTI=q[q.length-1].XTI.concat(Z),q.XTI=q.XTI.concat(Z);break;case 2196:if(P.biff<8)break;j!=null&&(j.Comment=Z[1]);break;case 18:a["!protect"]=Z;break;case 19:Z!==0&&P.WTF&&console.error("Password verifier: "+Z);break;case 133:i[Z.pos]=Z,P.snames.push(Z.name);break;case 10:{if(--xe)break;if(s.e){if(s.e.r>0&&s.e.c>0){if(s.e.r--,s.e.c--,a["!ref"]=Ut(s),t.sheetRows&&t.sheetRows<=s.e.r){var Ke=s.e.r;s.e.r=t.sheetRows-1,a["!fullref"]=a["!ref"],a["!ref"]=Ut(s),s.e.r=Ke}s.e.r++,s.e.c++}W.length>0&&(a["!merges"]=W),se.length>0&&(a["!objects"]=se),fe.length>0&&(a["!cols"]=fe),U.length>0&&(a["!rows"]=U),T.Sheets.push(F)}c===""?u=a:n[c]=a,a=t.dense?[]:{}}break;case 9:case 521:case 1033:case 2057:{if(P.biff===8&&(P.biff={9:2,521:3,1033:4}[pe]||{512:2,768:3,1024:4,1280:5,1536:8,2:2,7:2}[Z.BIFFVer]||8),P.biffguess=Z.BIFFVer==0,Z.BIFFVer==0&&Z.dt==4096&&(P.biff=5,K=!0,Ii(P.codepage=28591)),P.biff==8&&Z.BIFFVer==0&&Z.dt==16&&(P.biff=2),xe++)break;if(a=t.dense?[]:{},P.biff<8&&!K&&(K=!0,Ii(P.codepage=t.codepage||1252)),P.biff<5||Z.BIFFVer==0&&Z.dt==4096){c===""&&(c="Sheet1"),s={s:{r:0,c:0},e:{r:0,c:0}};var Ce={pos:e.l-de,name:c};i[Ce.pos]=Ce,P.snames.push(c)}else c=(i[ne]||{name:""}).name;Z.dt==32&&(a["!type"]="chart"),Z.dt==64&&(a["!type"]="macro"),W=[],se=[],P.arrayf=w=[],fe=[],U=[],Q=!1,F={Hidden:(i[ne]||{hs:0}).hs,name:c}}break;case 515:case 3:case 2:a["!type"]=="chart"&&(t.dense?(a[Z.r]||[])[Z.c]:a[Ct({c:Z.c,r:Z.r})])&&++Z.c,y={ixfe:Z.ixfe,XF:L[Z.ixfe]||{},v:Z.val,t:"n"},E>0&&(y.z=I[y.ixfe>>8&63]),es(y,t,r.opts.Date1904),N({c:Z.c,r:Z.r},y,t);break;case 5:case 517:y={ixfe:Z.ixfe,XF:L[Z.ixfe],v:Z.val,t:Z.t},E>0&&(y.z=I[y.ixfe>>8&63]),es(y,t,r.opts.Date1904),N({c:Z.c,r:Z.r},y,t);break;case 638:y={ixfe:Z.ixfe,XF:L[Z.ixfe],v:Z.rknum,t:"n"},E>0&&(y.z=I[y.ixfe>>8&63]),es(y,t,r.opts.Date1904),N({c:Z.c,r:Z.r},y,t);break;case 189:for(var ae=Z.c;ae<=Z.C;++ae){var De=Z.rkrec[ae-Z.c][0];y={ixfe:De,XF:L[De],v:Z.rkrec[ae-Z.c][1],t:"n"},E>0&&(y.z=I[y.ixfe>>8&63]),es(y,t,r.opts.Date1904),N({c:ae,r:Z.r},y,t)}break;case 6:case 518:case 1030:{if(Z.val=="String"){o=Z;break}if(y=cp(Z.val,Z.cell.ixfe,Z.tt),y.XF=L[y.ixfe],t.cellFormula){var Xe=Z.formula;if(Xe&&Xe[0]&&Xe[0][0]&&Xe[0][0][0]=="PtgExp"){var Me=Xe[0][0][1][0],qe=Xe[0][0][1][1],Ye=Ct({r:Me,c:qe});x[Ye]?y.f=""+Bn(Z.formula,s,Z.cell,q,P):y.F=((t.dense?(a[Me]||[])[qe]:a[Ye])||{}).F}else y.f=""+Bn(Z.formula,s,Z.cell,q,P)}E>0&&(y.z=I[y.ixfe>>8&63]),es(y,t,r.opts.Date1904),N(Z.cell,y,t),o=Z}break;case 7:case 519:if(o)o.val=Z,y=cp(Z,o.cell.ixfe,"s"),y.XF=L[y.ixfe],t.cellFormula&&(y.f=""+Bn(o.formula,s,o.cell,q,P)),E>0&&(y.z=I[y.ixfe>>8&63]),es(y,t,r.opts.Date1904),N(o.cell,y,t),o=null;else throw new Error("String record expects Formula");break;case 33:case 545:{w.push(Z);var Je=Ct(Z[0].s);if(h=t.dense?(a[Z[0].s.r]||[])[Z[0].s.c]:a[Je],t.cellFormula&&h){if(!o||!Je||!h)break;h.f=""+Bn(Z[1],s,Z[0],q,P),h.F=Ut(Z[0])}}break;case 1212:{if(!t.cellFormula)break;if(p){if(!o)break;x[Ct(o.cell)]=Z[0],h=t.dense?(a[o.cell.r]||[])[o.cell.c]:a[Ct(o.cell)],(h||{}).f=""+Bn(Z[0],s,f,q,P)}}break;case 253:y=cp(l[Z.isst].t,Z.ixfe,"s"),l[Z.isst].h&&(y.h=l[Z.isst].h),y.XF=L[y.ixfe],E>0&&(y.z=I[y.ixfe>>8&63]),es(y,t,r.opts.Date1904),N({c:Z.c,r:Z.r},y,t);break;case 513:t.sheetStubs&&(y={ixfe:Z.ixfe,XF:L[Z.ixfe],t:"z"},E>0&&(y.z=I[y.ixfe>>8&63]),es(y,t,r.opts.Date1904),N({c:Z.c,r:Z.r},y,t));break;case 190:if(t.sheetStubs)for(var st=Z.c;st<=Z.C;++st){var lt=Z.ixfe[st-Z.c];y={ixfe:lt,XF:L[lt],t:"z"},E>0&&(y.z=I[y.ixfe>>8&63]),es(y,t,r.opts.Date1904),N({c:st,r:Z.r},y,t)}break;case 214:case 516:case 4:y=cp(Z.val,Z.ixfe,"s"),y.XF=L[y.ixfe],E>0&&(y.z=I[y.ixfe>>8&63]),es(y,t,r.opts.Date1904),N({c:Z.c,r:Z.r},y,t);break;case 0:case 512:xe===1&&(s=Z);break;case 252:l=Z;break;case 1054:if(P.biff==4){I[E++]=Z[1];for(var mt=0;mt<E+163&&Ft[mt]!=Z[1];++mt);mt>=163&&ql(Z[1],E+163)}else ql(Z[1],Z[0]);break;case 30:{I[E++]=Z;for(var wt=0;wt<E+163&&Ft[wt]!=Z;++wt);wt>=163&&ql(Z,E+163)}break;case 229:W=W.concat(Z);break;case 93:se[Z.cmo[0]]=P.lastobj=Z;break;case 438:P.lastobj.TxO=Z;break;case 127:P.lastobj.ImData=Z;break;case 440:for(b=Z[0].s.r;b<=Z[0].e.r;++b)for(m=Z[0].s.c;m<=Z[0].e.c;++m)h=t.dense?(a[b]||[])[m]:a[Ct({c:m,r:b})],h&&(h.l=Z[1]);break;case 2048:for(b=Z[0].s.r;b<=Z[0].e.r;++b)for(m=Z[0].s.c;m<=Z[0].e.c;++m)h=t.dense?(a[b]||[])[m]:a[Ct({c:m,r:b})],h&&h.l&&(h.l.Tooltip=Z[1]);break;case 28:{if(P.biff<=5&&P.biff>=2)break;h=t.dense?(a[Z[0].r]||[])[Z[0].c]:a[Ct(Z[0])];var Ot=se[Z[2]];h||(t.dense?(a[Z[0].r]||(a[Z[0].r]=[]),h=a[Z[0].r][Z[0].c]={t:"z"}):h=a[Ct(Z[0])]={t:"z"},s.e.r=Math.max(s.e.r,Z[0].r),s.s.r=Math.min(s.s.r,Z[0].r),s.e.c=Math.max(s.e.c,Z[0].c),s.s.c=Math.min(s.s.c,Z[0].c)),h.c||(h.c=[]),g={a:Z[1],t:Ot.TxO.t},h.c.push(g)}break;case 2173:TH(L[Z.ixfe],Z.ext);break;case 125:{if(!P.cellStyles)break;for(;Z.e>=Z.s;)fe[Z.e--]={width:Z.w/256,level:Z.level||0,hidden:!!(Z.flags&1)},Q||(Q=!0,E5(Z.w/256)),Hu(fe[Z.e+1])}break;case 520:{var kt={};Z.level!=null&&(U[Z.r]=kt,kt.level=Z.level),Z.hidden&&(U[Z.r]=kt,kt.hidden=!0),Z.hpt&&(U[Z.r]=kt,kt.hpt=Z.hpt,kt.hpx=ch(Z.hpt))}break;case 38:case 39:case 40:case 41:a["!margins"]||N0(a["!margins"]={}),a["!margins"][{38:"left",39:"right",40:"top",41:"bottom"}[pe]]=Z;break;case 161:a["!margins"]||N0(a["!margins"]={}),a["!margins"].header=Z.header,a["!margins"].footer=Z.footer;break;case 574:Z.RTL&&(T.Views[0].RTL=!0);break;case 146:D=Z;break;case 2198:J=Z;break;case 140:A=Z;break;case 442:c?F.CodeName=Z||F.name:T.WBProps.CodeName=Z||"ThisWorkbook";break}}else we||console.error("Missing Info for XLS Record 0x"+pe.toString(16)),e.l+=de}return r.SheetNames=hs(i).sort(function(ct,Ze){return Number(ct)-Number(Ze)}).map(function(ct){return i[ct].name}),t.bookSheets||(r.Sheets=n),!r.SheetNames.length&&u["!ref"]?(r.SheetNames.push("Sheet1"),r.Sheets&&(r.Sheets.Sheet1=u)):r.Preamble=u,r.Sheets&&O.forEach(function(ct,Ze){r.Sheets[r.SheetNames[Ze]]["!autofilter"]=ct}),r.Strings=l,r.SSF=Sn(Ft),P.enc&&(r.Encryption=P.enc),J&&(r.Themes=J),r.Metadata={},A!==void 0&&(r.Metadata.Country=A),q.names.length>0&&(T.Names=q.names),r.Workbook=T,r}var t_={SI:"e0859ff2f94f6810ab9108002b27b3d9",DSI:"02d5cdd59c2e1b10939708002b2cf9ae",UDI:"05d5cdd59c2e1b10939708002b2cf9ae"};function sK(e,t,r){var n=Bt.find(e,"/!DocumentSummaryInformation");if(n&&n.size>0)try{var a=M3(n,SV,t_.DSI);for(var i in a)t[i]=a[i]}catch(c){if(r.WTF)throw c}var s=Bt.find(e,"/!SummaryInformation");if(s&&s.size>0)try{var o=M3(s,kV,t_.SI);for(var l in o)t[l]==null&&(t[l]=o[l])}catch(c){if(r.WTF)throw c}t.HeadingPairs&&t.TitlesOfParts&&(kT(t.HeadingPairs,t.TitlesOfParts,t,r),delete t.HeadingPairs,delete t.TitlesOfParts)}function oC(e,t){t||(t={}),P5(t),RA(),t.codepage&&l5(t.codepage);var r,n;if(e.FullPaths){if(Bt.find(e,"/encryption"))throw new Error("File is password-protected");r=Bt.find(e,"!CompObj"),n=Bt.find(e,"/Workbook")||Bt.find(e,"/Book")}else{switch(t.type){case"base64":e=Di(Ba(e));break;case"binary":e=Di(e);break;case"buffer":break;case"array":Array.isArray(e)||(e=Array.prototype.slice.call(e));break}bn(e,0),n={content:e}}var a,i;if(r&&rK(r),t.bookProps&&!t.bookSheets)a={};else{var s=jt?"buffer":"array";if(n&&n.content)a=iK(n.content,t);else if((i=Bt.find(e,"PerfectOffice_MAIN"))&&i.content)a=T0.to_workbook(i.content,(t.type=s,t));else if((i=Bt.find(e,"NativeContent_MAIN"))&&i.content)a=T0.to_workbook(i.content,(t.type=s,t));else throw(i=Bt.find(e,"MN0"))&&i.content?new Error("Unsupported Works 4 for Mac file"):new Error("Cannot find Workbook stream");t.bookVBA&&e.FullPaths&&Bt.find(e,"/_VBA_PROJECT_CUR/VBA/dir")&&(a.vbaraw=WH(e))}var o={};return e.FullPaths&&sK(e,o,t),a.Props=a.Custprops=o,t.bookFiles&&(a.cfb=e),a}var F1={0:{f:Vq},1:{f:Wq},2:{f:eG},3:{f:Xq},4:{f:Gq},5:{f:Zq},6:{f:nG},7:{f:Jq},8:{f:lG},9:{f:oG},10:{f:iG},11:{f:sG},12:{f:qq},13:{f:tG},14:{f:Yq},15:{f:Kq},16:{f:rC},17:{f:aG},18:{f:Qq},19:{f:y5},20:{},21:{},22:{},23:{},24:{},25:{},26:{},27:{},28:{},29:{},30:{},31:{},32:{},33:{},34:{},35:{T:1},36:{T:-1},37:{T:1},38:{T:-1},39:{f:IG},40:{},42:{},43:{f:iH},44:{f:aH},45:{f:sH},46:{f:lH},47:{f:oH},48:{},49:{f:cV},50:{},51:{f:NH},52:{T:1},53:{T:-1},54:{T:1},55:{T:-1},56:{T:1},57:{T:-1},58:{},59:{},60:{f:RT},62:{f:rG},63:{f:DH},64:{f:vG},65:{},66:{},67:{},68:{},69:{},70:{},128:{},129:{T:1},130:{T:-1},131:{T:1,f:qn,p:0},132:{T:-1},133:{T:1},134:{T:-1},135:{T:1},136:{T:-1},137:{T:1,f:gG},138:{T:-1},139:{T:1},140:{T:-1},141:{T:1},142:{T:-1},143:{T:1},144:{T:-1},145:{T:1},146:{T:-1},147:{f:Hq},148:{f:$q,p:16},151:{f:fG},152:{},153:{f:OG},154:{},155:{},156:{f:FG},157:{},158:{},159:{T:1,f:kz},160:{T:-1},161:{T:1,f:pc},162:{T:-1},163:{T:1},164:{T:-1},165:{T:1},166:{T:-1},167:{},168:{},169:{},170:{},171:{},172:{T:1},173:{T:-1},174:{},175:{},176:{f:cG},177:{T:1},178:{T:-1},179:{T:1},180:{T:-1},181:{T:1},182:{T:-1},183:{T:1},184:{T:-1},185:{T:1},186:{T:-1},187:{T:1},188:{T:-1},189:{T:1},190:{T:-1},191:{T:1},192:{T:-1},193:{T:1},194:{T:-1},195:{T:1},196:{T:-1},197:{T:1},198:{T:-1},199:{T:1},200:{T:-1},201:{T:1},202:{T:-1},203:{T:1},204:{T:-1},205:{T:1},206:{T:-1},207:{T:1},208:{T:-1},209:{T:1},210:{T:-1},211:{T:1},212:{T:-1},213:{T:1},214:{T:-1},215:{T:1},216:{T:-1},217:{T:1},218:{T:-1},219:{T:1},220:{T:-1},221:{T:1},222:{T:-1},223:{T:1},224:{T:-1},225:{T:1},226:{T:-1},227:{T:1},228:{T:-1},229:{T:1},230:{T:-1},231:{T:1},232:{T:-1},233:{T:1},234:{T:-1},235:{T:1},236:{T:-1},237:{T:1},238:{T:-1},239:{T:1},240:{T:-1},241:{T:1},242:{T:-1},243:{T:1},244:{T:-1},245:{T:1},246:{T:-1},247:{T:1},248:{T:-1},249:{T:1},250:{T:-1},251:{T:1},252:{T:-1},253:{T:1},254:{T:-1},255:{T:1},256:{T:-1},257:{T:1},258:{T:-1},259:{T:1},260:{T:-1},261:{T:1},262:{T:-1},263:{T:1},264:{T:-1},265:{T:1},266:{T:-1},267:{T:1},268:{T:-1},269:{T:1},270:{T:-1},271:{T:1},272:{T:-1},273:{T:1},274:{T:-1},275:{T:1},276:{T:-1},277:{},278:{T:1},279:{T:-1},280:{T:1},281:{T:-1},282:{T:1},283:{T:1},284:{T:-1},285:{T:1},286:{T:-1},287:{T:1},288:{T:-1},289:{T:1},290:{T:-1},291:{T:1},292:{T:-1},293:{T:1},294:{T:-1},295:{T:1},296:{T:-1},297:{T:1},298:{T:-1},299:{T:1},300:{T:-1},301:{T:1},302:{T:-1},303:{T:1},304:{T:-1},305:{T:1},306:{T:-1},307:{T:1},308:{T:-1},309:{T:1},310:{T:-1},311:{T:1},312:{T:-1},313:{T:-1},314:{T:1},315:{T:-1},316:{T:1},317:{T:-1},318:{T:1},319:{T:-1},320:{T:1},321:{T:-1},322:{T:1},323:{T:-1},324:{T:1},325:{T:-1},326:{T:1},327:{T:-1},328:{T:1},329:{T:-1},330:{T:1},331:{T:-1},332:{T:1},333:{T:-1},334:{T:1},335:{f:CH},336:{T:-1},337:{f:PH,T:1},338:{T:-1},339:{T:1},340:{T:-1},341:{T:1},342:{T:-1},343:{T:1},344:{T:-1},345:{T:1},346:{T:-1},347:{T:1},348:{T:-1},349:{T:1},350:{T:-1},351:{},352:{},353:{T:1},354:{T:-1},355:{f:ix},357:{},358:{},359:{},360:{T:1},361:{},362:{f:IT},363:{},364:{},366:{},367:{},368:{},369:{},370:{},371:{},372:{T:1},373:{T:-1},374:{T:1},375:{T:-1},376:{T:1},377:{T:-1},378:{T:1},379:{T:-1},380:{T:1},381:{T:-1},382:{T:1},383:{T:-1},384:{T:1},385:{T:-1},386:{T:1},387:{T:-1},388:{T:1},389:{T:-1},390:{T:1},391:{T:-1},392:{T:1},393:{T:-1},394:{T:1},395:{T:-1},396:{},397:{},398:{},399:{},400:{},401:{T:1},403:{},404:{},405:{},406:{},407:{},408:{},409:{},410:{},411:{},412:{},413:{},414:{},415:{},416:{},417:{},418:{},419:{},420:{},421:{},422:{T:1},423:{T:1},424:{T:-1},425:{T:-1},426:{f:hG},427:{f:dG},428:{},429:{T:1},430:{T:-1},431:{T:1},432:{T:-1},433:{T:1},434:{T:-1},435:{T:1},436:{T:-1},437:{T:1},438:{T:-1},439:{T:1},440:{T:-1},441:{T:1},442:{T:-1},443:{T:1},444:{T:-1},445:{T:1},446:{T:-1},447:{T:1},448:{T:-1},449:{T:1},450:{T:-1},451:{T:1},452:{T:-1},453:{T:1},454:{T:-1},455:{T:1},456:{T:-1},457:{T:1},458:{T:-1},459:{T:1},460:{T:-1},461:{T:1},462:{T:-1},463:{T:1},464:{T:-1},465:{T:1},466:{T:-1},467:{T:1},468:{T:-1},469:{T:1},470:{T:-1},471:{},472:{},473:{T:1},474:{T:-1},475:{},476:{f:mG},477:{},478:{},479:{T:1},480:{T:-1},481:{T:1},482:{T:-1},483:{T:1},484:{T:-1},485:{f:zq},486:{T:1},487:{T:-1},488:{T:1},489:{T:-1},490:{T:1},491:{T:-1},492:{T:1},493:{T:-1},494:{f:uG},495:{T:1},496:{T:-1},497:{T:1},498:{T:-1},499:{},500:{T:1},501:{T:-1},502:{T:1},503:{T:-1},504:{},505:{T:1},506:{T:-1},507:{},508:{T:1},509:{T:-1},510:{T:1},511:{T:-1},512:{},513:{},514:{T:1},515:{T:-1},516:{T:1},517:{T:-1},518:{T:1},519:{T:-1},520:{T:1},521:{T:-1},522:{},523:{},524:{},525:{},526:{},527:{},528:{T:1},529:{T:-1},530:{T:1},531:{T:-1},532:{T:1},533:{T:-1},534:{},535:{},536:{},537:{},538:{T:1},539:{T:-1},540:{T:1},541:{T:-1},542:{T:1},548:{},549:{},550:{f:ix},551:{},552:{},553:{},554:{T:1},555:{T:-1},556:{T:1},557:{T:-1},558:{T:1},559:{T:-1},560:{T:1},561:{T:-1},562:{},564:{},565:{T:1},566:{T:-1},569:{T:1},570:{T:-1},572:{},573:{T:1},574:{T:-1},577:{},578:{},579:{},580:{},581:{},582:{},583:{},584:{},585:{},586:{},587:{},588:{T:-1},589:{},590:{T:1},591:{T:-1},592:{T:1},593:{T:-1},594:{T:1},595:{T:-1},596:{},597:{T:1},598:{T:-1},599:{T:1},600:{T:-1},601:{T:1},602:{T:-1},603:{T:1},604:{T:-1},605:{T:1},606:{T:-1},607:{},608:{T:1},609:{T:-1},610:{},611:{T:1},612:{T:-1},613:{T:1},614:{T:-1},615:{T:1},616:{T:-1},617:{T:1},618:{T:-1},619:{T:1},620:{T:-1},625:{},626:{T:1},627:{T:-1},628:{T:1},629:{T:-1},630:{T:1},631:{T:-1},632:{f:$H},633:{T:1},634:{T:-1},635:{T:1,f:VH},636:{T:-1},637:{f:fV},638:{T:1},639:{},640:{T:-1},641:{T:1},642:{T:-1},643:{T:1},644:{},645:{T:-1},646:{T:1},648:{T:1},649:{},650:{T:-1},651:{f:SG},652:{},653:{T:1},654:{T:-1},655:{T:1},656:{T:-1},657:{T:1},658:{T:-1},659:{},660:{T:1},661:{},662:{T:-1},663:{},664:{T:1},665:{},666:{T:-1},667:{},668:{},669:{},671:{T:1},672:{T:-1},673:{T:1},674:{T:-1},675:{},676:{},677:{},678:{},679:{},680:{},681:{},1024:{},1025:{},1026:{T:1},1027:{T:-1},1028:{T:1},1029:{T:-1},1030:{},1031:{T:1},1032:{T:-1},1033:{T:1},1034:{T:-1},1035:{},1036:{},1037:{},1038:{T:1},1039:{T:-1},1040:{},1041:{T:1},1042:{T:-1},1043:{},1044:{},1045:{},1046:{T:1},1047:{T:-1},1048:{T:1},1049:{T:-1},1050:{},1051:{T:1},1052:{T:1},1053:{f:xG},1054:{T:1},1055:{},1056:{T:1},1057:{T:-1},1058:{T:1},1059:{T:-1},1061:{},1062:{T:1},1063:{T:-1},1064:{T:1},1065:{T:-1},1066:{T:1},1067:{T:-1},1068:{T:1},1069:{T:-1},1070:{T:1},1071:{T:-1},1072:{T:1},1073:{T:-1},1075:{T:1},1076:{T:-1},1077:{T:1},1078:{T:-1},1079:{T:1},1080:{T:-1},1081:{T:1},1082:{T:-1},1083:{T:1},1084:{T:-1},1085:{},1086:{T:1},1087:{T:-1},1088:{T:1},1089:{T:-1},1090:{T:1},1091:{T:-1},1092:{T:1},1093:{T:-1},1094:{T:1},1095:{T:-1},1096:{},1097:{T:1},1098:{},1099:{T:-1},1100:{T:1},1101:{T:-1},1102:{},1103:{},1104:{},1105:{},1111:{},1112:{},1113:{T:1},1114:{T:-1},1115:{T:1},1116:{T:-1},1117:{},1118:{T:1},1119:{T:-1},1120:{T:1},1121:{T:-1},1122:{T:1},1123:{T:-1},1124:{T:1},1125:{T:-1},1126:{},1128:{T:1},1129:{T:-1},1130:{},1131:{T:1},1132:{T:-1},1133:{T:1},1134:{T:-1},1135:{T:1},1136:{T:-1},1137:{T:1},1138:{T:-1},1139:{T:1},1140:{T:-1},1141:{},1142:{T:1},1143:{T:-1},1144:{T:1},1145:{T:-1},1146:{},1147:{T:1},1148:{T:-1},1149:{T:1},1150:{T:-1},1152:{T:1},1153:{T:-1},1154:{T:-1},1155:{T:-1},1156:{T:-1},1157:{T:1},1158:{T:-1},1159:{T:1},1160:{T:-1},1161:{T:1},1162:{T:-1},1163:{T:1},1164:{T:-1},1165:{T:1},1166:{T:-1},1167:{T:1},1168:{T:-1},1169:{T:1},1170:{T:-1},1171:{},1172:{T:1},1173:{T:-1},1177:{},1178:{T:1},1180:{},1181:{},1182:{},2048:{T:1},2049:{T:-1},2050:{},2051:{T:1},2052:{T:-1},2053:{},2054:{},2055:{T:1},2056:{T:-1},2057:{T:1},2058:{T:-1},2060:{},2067:{},2068:{T:1},2069:{T:-1},2070:{},2071:{},2072:{T:1},2073:{T:-1},2075:{},2076:{},2077:{T:1},2078:{T:-1},2079:{},2080:{T:1},2081:{T:-1},2082:{},2083:{T:1},2084:{T:-1},2085:{T:1},2086:{T:-1},2087:{T:1},2088:{T:-1},2089:{T:1},2090:{T:-1},2091:{},2092:{},2093:{T:1},2094:{T:-1},2095:{},2096:{T:1},2097:{T:-1},2098:{T:1},2099:{T:-1},2100:{T:1},2101:{T:-1},2102:{},2103:{T:1},2104:{T:-1},2105:{},2106:{T:1},2107:{T:-1},2108:{},2109:{T:1},2110:{T:-1},2111:{T:1},2112:{T:-1},2113:{T:1},2114:{T:-1},2115:{},2116:{},2117:{},2118:{T:1},2119:{T:-1},2120:{},2121:{T:1},2122:{T:-1},2123:{T:1},2124:{T:-1},2125:{},2126:{T:1},2127:{T:-1},2128:{},2129:{T:1},2130:{T:-1},2131:{T:1},2132:{T:-1},2133:{T:1},2134:{},2135:{},2136:{},2137:{T:1},2138:{T:-1},2139:{T:1},2140:{T:-1},2141:{},3072:{},3073:{},4096:{T:1},4097:{T:-1},5002:{T:1},5003:{T:-1},5081:{T:1},5082:{T:-1},5083:{},5084:{T:1},5085:{T:-1},5086:{T:1},5087:{T:-1},5088:{},5089:{},5090:{},5092:{T:1},5093:{T:-1},5094:{},5095:{T:1},5096:{T:-1},5097:{},5099:{},65535:{n:""}},ux={6:{f:g2},10:{f:wo},12:{f:Jr},13:{f:Jr},14:{f:Mr},15:{f:Mr},16:{f:Vn},17:{f:Mr},18:{f:Mr},19:{f:Jr},20:{f:$3},21:{f:$3},23:{f:IT},24:{f:H3},25:{f:Mr},26:{},27:{},28:{f:B$},29:{},34:{f:Mr},35:{f:z3},38:{f:Vn},39:{f:Vn},40:{f:Vn},41:{f:Vn},42:{f:Mr},43:{f:Mr},47:{f:zz},49:{f:w$},51:{f:Jr},60:{},61:{f:v$},64:{f:Mr},65:{f:y$},66:{f:Jr},77:{},80:{},81:{},82:{},85:{f:Jr},89:{},90:{},91:{},92:{f:c$},93:{f:V$},94:{},95:{f:Mr},96:{},97:{},99:{f:Mr},125:{f:RT},128:{f:P$},129:{f:u$},130:{f:Jr},131:{f:Mr},132:{f:Mr},133:{f:f$},134:{},140:{f:G$},141:{f:Jr},144:{},146:{f:X$},151:{},152:{},153:{},154:{},155:{},156:{f:Jr},157:{},158:{},160:{f:ez},161:{f:J$},174:{},175:{},176:{},177:{},178:{},180:{},181:{},182:{},184:{},185:{},189:{f:A$},190:{f:T$},193:{f:wo},197:{},198:{},199:{},200:{},201:{},202:{f:Mr},203:{},204:{},205:{},206:{},207:{},208:{},209:{},210:{},211:{},213:{},215:{},216:{},217:{},218:{f:Jr},220:{},221:{f:Mr},222:{},224:{f:N$},225:{f:l$},226:{f:wo},227:{},229:{f:U$},233:{},235:{},236:{},237:{},239:{},240:{},241:{},242:{},244:{},245:{},246:{},247:{},248:{},249:{},251:{},252:{f:h$},253:{f:b$},255:{f:d$},256:{},259:{},290:{},311:{},312:{},315:{},317:{f:NT},318:{},319:{},320:{},330:{},331:{},333:{},334:{},335:{},336:{},337:{},338:{},339:{},340:{},351:{},352:{f:Mr},353:{f:wo},401:{},402:{},403:{},404:{},405:{},406:{},407:{},408:{},425:{},426:{},427:{},428:{},429:{},430:{f:F$},431:{f:Mr},432:{},433:{},434:{},437:{},438:{f:H$},439:{f:Mr},440:{f:W$},441:{},442:{f:Dh},443:{},444:{f:Jr},445:{},446:{},448:{f:wo},449:{f:g$,r:2},450:{f:wo},512:{f:U3},513:{f:Z$},515:{f:L$},516:{f:_$},517:{f:V3},519:{f:tz},520:{f:p$},523:{},545:{f:W3},549:{f:B3},566:{},574:{f:x$},638:{f:E$},659:{},1048:{},1054:{f:S$},1084:{},1212:{f:R$},2048:{f:q$},2049:{},2050:{},2051:{},2052:{},2053:{},2054:{},2055:{},2056:{},2057:{f:sp},2058:{},2059:{},2060:{},2061:{},2062:{},2063:{},2064:{},2066:{},2067:{},2128:{},2129:{},2130:{},2131:{},2132:{},2133:{},2134:{},2135:{},2136:{},2137:{},2138:{},2146:{},2147:{r:12},2148:{},2149:{},2150:{},2151:{f:wo},2152:{},2154:{},2155:{},2156:{},2161:{},2162:{},2164:{},2165:{},2166:{},2167:{},2168:{},2169:{},2170:{},2171:{},2172:{f:Y$,r:12},2173:{f:AH,r:12},2174:{},2175:{},2180:{},2181:{},2182:{},2183:{},2184:{},2185:{},2186:{},2187:{},2188:{f:Mr,r:12},2189:{},2190:{r:12},2191:{},2192:{},2194:{},2195:{},2196:{f:I$,r:12},2197:{},2198:{f:wH,r:12},2199:{},2200:{},2201:{},2202:{f:j$,r:12},2203:{f:wo},2204:{},2205:{},2206:{},2207:{},2211:{f:m$},2212:{},2213:{},2214:{},2215:{},4097:{},4098:{},4099:{},4102:{},4103:{},4105:{},4106:{},4107:{},4108:{},4109:{},4116:{},4117:{},4118:{},4119:{},4120:{},4121:{},4122:{},4123:{},4124:{},4125:{},4126:{},4127:{},4128:{},4129:{},4130:{},4132:{},4133:{},4134:{f:Jr},4135:{},4146:{},4147:{},4148:{},4149:{},4154:{},4156:{},4157:{},4158:{},4159:{},4160:{},4161:{},4163:{},4164:{f:Q$},4165:{},4166:{},4168:{},4170:{},4171:{},4174:{},4175:{},4176:{},4177:{},4187:{},4188:{f:K$},4189:{},4191:{},4192:{},4193:{},4194:{},4195:{},4196:{},4197:{},4198:{},4199:{},4200:{},0:{f:U3},1:{},2:{f:iz},3:{f:az},4:{f:nz},5:{f:V3},7:{f:sz},8:{},9:{f:sp},11:{},22:{f:Jr},30:{f:k$},31:{},32:{},33:{f:W3},36:{},37:{f:B3},50:{f:oz},62:{},52:{},67:{},68:{f:Jr},69:{},86:{},126:{},127:{f:rz},135:{},136:{},137:{},145:{},148:{},149:{},150:{},169:{},171:{},188:{},191:{},192:{},194:{},195:{},214:{f:lz},223:{},234:{},354:{},421:{},518:{f:g2},521:{f:sp},536:{f:H3},547:{f:z3},561:{},579:{},1030:{f:g2},1033:{f:sp},1091:{},2157:{},2163:{},2177:{},2240:{},2241:{},2242:{},2243:{},2244:{},2245:{},2246:{},2247:{},2248:{},2249:{},2250:{},2251:{},2262:{r:12},29282:{}};function Si(e,t,r,n){var a=t;if(!isNaN(a)){var i=(r||[]).length||0,s=e.next(4);s.write_shift(2,a),s.write_shift(2,i),i>0&&gT(r)&&e.push(r)}}function r_(e,t){var r=t||{},n=r.dense?[]:{};e=e.replace(/<!--.*?-->/g,"");var a=e.match(/<table/i);if(!a)throw new Error("Invalid HTML: could not find <table>");var i=e.match(/<\/table/i),s=a.index,o=i&&i.index||e.length,l=LU(e.slice(s,o),/(:?<tr[^>]*>)/i,"<tr>"),c=-1,u=0,f=0,p=0,h={s:{r:1e7,c:1e7},e:{r:0,c:0}},g=[];for(s=0;s<l.length;++s){var m=l[s].trim(),b=m.slice(0,3).toLowerCase();if(b=="<tr"){if(++c,r.sheetRows&&r.sheetRows<=c){--c;break}u=0;continue}if(!(b!="<td"&&b!="<th")){var x=m.split(/<\/t[dh]>/i);for(o=0;o<x.length;++o){var w=x[o].trim();if(w.match(/<t[dh]/i)){for(var y=w,A=0;y.charAt(0)=="<"&&(A=y.indexOf(">"))>-1;)y=y.slice(A+1);for(var L=0;L<g.length;++L){var D=g[L];D.s.c==u&&D.s.r<c&&c<=D.e.r&&(u=D.e.c+1,L=-1)}var T=yt(w.slice(0,w.indexOf(">")));p=T.colspan?+T.colspan:1,((f=+T.rowspan)>1||p>1)&&g.push({s:{r:c,c:u},e:{r:c+(f||1)-1,c:u+p-1}});var F=T.t||T["data-t"]||"";if(!y.length){u+=p;continue}if(y=nT(y),h.s.r>c&&(h.s.r=c),h.e.r<c&&(h.e.r=c),h.s.c>u&&(h.s.c=u),h.e.c<u&&(h.e.c=u),!y.length){u+=p;continue}var R={t:"s",v:y};r.raw||!y.trim().length||F=="s"||(y==="TRUE"?R={t:"b",v:!0}:y==="FALSE"?R={t:"b",v:!1}:isNaN(Ui(y))?isNaN(zu(y).getDate())||(R={t:"d",v:vn(y)},r.cellDates||(R={t:"n",v:ia(R.v)}),R.z=r.dateNF||Ft[14]):R={t:"n",v:Ui(y)}),r.dense?(n[c]||(n[c]=[]),n[c][u]=R):n[Ct({r:c,c:u})]=R,u+=p}}}}return n["!ref"]=Ut(h),g.length&&(n["!merges"]=g),n}function oK(e,t,r,n){for(var a=e["!merges"]||[],i=[],s=t.s.c;s<=t.e.c;++s){for(var o=0,l=0,c=0;c<a.length;++c)if(!(a[c].s.r>r||a[c].s.c>s)&&!(a[c].e.r<r||a[c].e.c<s)){if(a[c].s.r<r||a[c].s.c<s){o=-1;break}o=a[c].e.r-a[c].s.r+1,l=a[c].e.c-a[c].s.c+1;break}if(!(o<0)){var u=Ct({r,c:s}),f=n.dense?(e[r]||[])[s]:e[u],p=f&&f.v!=null&&(f.h||p5(f.w||(Zs(f),f.w)||""))||"",h={};o>1&&(h.rowspan=o),l>1&&(h.colspan=l),n.editable?p='<span contenteditable="true">'+p+"</span>":f&&(h["data-t"]=f&&f.t||"z",f.v!=null&&(h["data-v"]=f.v),f.z!=null&&(h["data-z"]=f.z),f.l&&(f.l.Target||"#").charAt(0)!="#"&&(p='<a href="'+f.l.Target+'">'+p+"</a>")),h.id=(n.id||"sjs")+"-"+u,i.push(GU("td",p,h))}}var g="<tr>";return g+i.join("")+"</tr>"}var lK='<html><head><meta charset="utf-8"/><title>SheetJS Table Export</title></head><body>',cK="</body></html>";function uK(e,t){var r=e.match(/<table[\s\S]*?>[\s\S]*?<\/table>/gi);if(!r||r.length==0)throw new Error("Invalid HTML: could not find <table>");if(r.length==1)return hl(r_(r[0],t),t);var n=F5();return r.forEach(function(a,i){O5(n,r_(a,t),"Sheet"+(i+1))}),n}function fK(e,t,r){var n=[];return n.join("")+"<table"+(r&&r.id?' id="'+r.id+'"':"")+">"}function hK(e,t){var r=t||{},n=r.header!=null?r.header:lK,a=r.footer!=null?r.footer:cK,i=[n],s=ef(e["!ref"]);r.dense=Array.isArray(e),i.push(fK(e,s,r));for(var o=s.s.r;o<=s.e.r;++o)i.push(oK(e,s,o,r));return i.push("</table>"+a),i.join("")}function lC(e,t,r){var n=r||{},a=0,i=0;if(n.origin!=null)if(typeof n.origin=="number")a=n.origin;else{var s=typeof n.origin=="string"?ra(n.origin):n.origin;a=s.r,i=s.c}var o=t.getElementsByTagName("tr"),l=Math.min(n.sheetRows||1e7,o.length),c={s:{r:0,c:0},e:{r:a,c:i}};if(e["!ref"]){var u=ef(e["!ref"]);c.s.r=Math.min(c.s.r,u.s.r),c.s.c=Math.min(c.s.c,u.s.c),c.e.r=Math.max(c.e.r,u.e.r),c.e.c=Math.max(c.e.c,u.e.c),a==-1&&(c.e.r=a=u.e.r+1)}var f=[],p=0,h=e["!rows"]||(e["!rows"]=[]),g=0,m=0,b=0,x=0,w=0,y=0;for(e["!cols"]||(e["!cols"]=[]);g<o.length&&m<l;++g){var A=o[g];if(n_(A)){if(n.display)continue;h[m]={hidden:!0}}var L=A.children;for(b=x=0;b<L.length;++b){var D=L[b];if(!(n.display&&n_(D))){var T=D.hasAttribute("data-v")?D.getAttribute("data-v"):D.hasAttribute("v")?D.getAttribute("v"):nT(D.innerHTML),F=D.getAttribute("data-z")||D.getAttribute("z");for(p=0;p<f.length;++p){var R=f[p];R.s.c==x+i&&R.s.r<m+a&&m+a<=R.e.r&&(x=R.e.c+1-i,p=-1)}y=+D.getAttribute("colspan")||1,((w=+D.getAttribute("rowspan")||1)>1||y>1)&&f.push({s:{r:m+a,c:x+i},e:{r:m+a+(w||1)-1,c:x+i+(y||1)-1}});var X={t:"s",v:T},N=D.getAttribute("data-t")||D.getAttribute("t")||"";T!=null&&(T.length==0?X.t=N||"z":n.raw||T.trim().length==0||N=="s"||(T==="TRUE"?X={t:"b",v:!0}:T==="FALSE"?X={t:"b",v:!1}:isNaN(Ui(T))?isNaN(zu(T).getDate())||(X={t:"d",v:vn(T)},n.cellDates||(X={t:"n",v:ia(X.v)}),X.z=n.dateNF||Ft[14]):X={t:"n",v:Ui(T)})),X.z===void 0&&F!=null&&(X.z=F);var P="",J=D.getElementsByTagName("A");if(J&&J.length)for(var W=0;W<J.length&&!(J[W].hasAttribute("href")&&(P=J[W].getAttribute("href"),P.charAt(0)!="#"));++W);P&&P.charAt(0)!="#"&&(X.l={Target:P}),n.dense?(e[m+a]||(e[m+a]=[]),e[m+a][x+i]=X):e[Ct({c:x+i,r:m+a})]=X,c.e.c<x+i&&(c.e.c=x+i),x+=y}}++m}return f.length&&(e["!merges"]=(e["!merges"]||[]).concat(f)),c.e.r=Math.max(c.e.r,m-1+a),e["!ref"]=Ut(c),m>=l&&(e["!fullref"]=Ut((c.e.r=o.length-g+m-1+a,c))),e}function cC(e,t){var r=t||{},n=r.dense?[]:{};return lC(n,e,t)}function dK(e,t){return hl(cC(e,t),t)}function n_(e){var t="",r=pK(e);return r&&(t=r(e).getPropertyValue("display")),t||(t=e.style&&e.style.display),t==="none"}function pK(e){return e.ownerDocument.defaultView&&typeof e.ownerDocument.defaultView.getComputedStyle=="function"?e.ownerDocument.defaultView.getComputedStyle:typeof getComputedStyle=="function"?getComputedStyle:null}function mK(e){var t=e.replace(/[\t\r\n]/g," ").trim().replace(/ +/g," ").replace(/<text:s\/>/g," ").replace(/<text:s text:c="(\d+)"\/>/g,function(n,a){return Array(parseInt(a,10)+1).join(" ")}).replace(/<text:tab[^>]*\/>/g,"	").replace(/<text:line-break\/>/g,`
`),r=Ht(t.replace(/<[^>]*>/g,""));return[r]}var a_={day:["d","dd"],month:["m","mm"],year:["y","yy"],hours:["h","hh"],minutes:["m","mm"],seconds:["s","ss"],"am-pm":["A/P","AM/PM"],"day-of-week":["ddd","dddd"],era:["e","ee"],quarter:["\\Qm",'m\\"th quarter"']};function uC(e,t){var r=t||{},n=m5(e),a=[],i,s,o={name:""},l="",c=0,u,f,p={},h=[],g=r.dense?[]:{},m,b,x={value:""},w="",y=0,A=[],L=-1,D=-1,T={s:{r:1e6,c:1e7},e:{r:0,c:0}},F=0,R={},X=[],N={},P=0,J=0,W=[],se=1,fe=1,U=[],Q={Names:[]},q={},he=["",""],xe=[],E={},I="",O=0,j=!1,K=!1,ne=0;for(sh.lastIndex=0,n=n.replace(/<!--([\s\S]*?)-->/mg,"").replace(/<!DOCTYPE[^\[]*\[[^\]]*\]>/gm,"");m=sh.exec(n);)switch(m[3]=m[3].replace(/_.*$/,"")){case"table":case"":m[1]==="/"?(T.e.c>=T.s.c&&T.e.r>=T.s.r?g["!ref"]=Ut(T):g["!ref"]="A1:A1",r.sheetRows>0&&r.sheetRows<=T.e.r&&(g["!fullref"]=g["!ref"],T.e.r=r.sheetRows-1,g["!ref"]=Ut(T)),X.length&&(g["!merges"]=X),W.length&&(g["!rows"]=W),u.name=u.||u.name,typeof JSON<"u"&&JSON.stringify(u),h.push(u.name),p[u.name]=g,K=!1):m[0].charAt(m[0].length-2)!=="/"&&(u=yt(m[0],!1),L=D=-1,T.s.r=T.s.c=1e7,T.e.r=T.e.c=0,g=r.dense?[]:{},X=[],W=[],K=!0);break;case"table-row-group":m[1]==="/"?--F:++F;break;case"table-row":case"":if(m[1]==="/"){L+=se,se=1;break}if(f=yt(m[0],!1),f.?L=f.-1:L==-1&&(L=0),se=+f["number-rows-repeated"]||1,se<10)for(ne=0;ne<se;++ne)F>0&&(W[L+ne]={level:F});D=-1;break;case"covered-table-cell":m[1]!=="/"&&++D,r.sheetStubs&&(r.dense?(g[L]||(g[L]=[]),g[L][D]={t:"z"}):g[Ct({r:L,c:D})]={t:"z"}),w="",A=[];break;case"table-cell":case"":if(m[0].charAt(m[0].length-2)==="/")++D,x=yt(m[0],!1),fe=parseInt(x["number-columns-repeated"]||"1",10),b={t:"z",v:null},x.formula&&r.cellFormula!=!1&&(b.f=Q3(Ht(x.formula))),(x.||x["value-type"])=="string"&&(b.t="s",b.v=Ht(x["string-value"]||""),r.dense?(g[L]||(g[L]=[]),g[L][D]=b):g[Ct({r:L,c:D})]=b),D+=fe-1;else if(m[1]!=="/"){++D,w="",y=0,A=[],fe=1;var pe=se?L+se-1:L;if(D>T.e.c&&(T.e.c=D),D<T.s.c&&(T.s.c=D),L<T.s.r&&(T.s.r=L),pe>T.e.r&&(T.e.r=pe),x=yt(m[0],!1),xe=[],E={},b={t:x.||x["value-type"],v:null},r.cellFormula)if(x.formula&&(x.formula=Ht(x.formula)),x["number-matrix-columns-spanned"]&&x["number-matrix-rows-spanned"]&&(P=parseInt(x["number-matrix-rows-spanned"],10)||0,J=parseInt(x["number-matrix-columns-spanned"],10)||0,N={s:{r:L,c:D},e:{r:L+P-1,c:D+J-1}},b.F=Ut(N),U.push([N,b.F])),x.formula)b.f=Q3(x.formula);else for(ne=0;ne<U.length;++ne)L>=U[ne][0].s.r&&L<=U[ne][0].e.r&&D>=U[ne][0].s.c&&D<=U[ne][0].e.c&&(b.F=U[ne][1]);switch((x["number-columns-spanned"]||x["number-rows-spanned"])&&(P=parseInt(x["number-rows-spanned"],10)||0,J=parseInt(x["number-columns-spanned"],10)||0,N={s:{r:L,c:D},e:{r:L+P-1,c:D+J-1}},X.push(N)),x["number-columns-repeated"]&&(fe=parseInt(x["number-columns-repeated"],10)),b.t){case"boolean":b.t="b",b.v=wr(x["boolean-value"]);break;case"float":b.t="n",b.v=parseFloat(x.value);break;case"percentage":b.t="n",b.v=parseFloat(x.value);break;case"currency":b.t="n",b.v=parseFloat(x.value);break;case"date":b.t="d",b.v=vn(x["date-value"]),r.cellDates||(b.t="n",b.v=ia(b.v)),b.z="m/d/yy";break;case"time":b.t="n",b.v=CU(x["time-value"])/86400,r.cellDates&&(b.t="d",b.v=Tm(b.v)),b.z="HH:MM:SS";break;case"number":b.t="n",b.v=parseFloat(x.);break;default:if(b.t==="string"||b.t==="text"||!b.t)b.t="s",x["string-value"]!=null&&(w=Ht(x["string-value"]),A=[]);else throw new Error("Unsupported value type "+b.t)}}else{if(j=!1,b.t==="s"&&(b.v=w||"",A.length&&(b.R=A),j=y==0),q.Target&&(b.l=q),xe.length>0&&(b.c=xe,xe=[]),w&&r.cellText!==!1&&(b.w=w),j&&(b.t="z",delete b.v),(!j||r.sheetStubs)&&!(r.sheetRows&&r.sheetRows<=L))for(var de=0;de<se;++de){if(fe=parseInt(x["number-columns-repeated"]||"1",10),r.dense)for(g[L+de]||(g[L+de]=[]),g[L+de][D]=de==0?b:Sn(b);--fe>0;)g[L+de][D+fe]=Sn(b);else for(g[Ct({r:L+de,c:D})]=b;--fe>0;)g[Ct({r:L+de,c:D+fe})]=Sn(b);T.e.c<=D&&(T.e.c=D)}fe=parseInt(x["number-columns-repeated"]||"1",10),D+=fe-1,fe=0,b={},w="",A=[]}q={};break;case"document":case"document-content":case"":case"spreadsheet":case"":case"scripts":case"styles":case"font-face-decls":case"master-styles":if(m[1]==="/"){if((i=a.pop())[0]!==m[3])throw"Bad state: "+i}else m[0].charAt(m[0].length-2)!=="/"&&a.push([m[3],!0]);break;case"annotation":if(m[1]==="/"){if((i=a.pop())[0]!==m[3])throw"Bad state: "+i;E.t=w,A.length&&(E.R=A),E.a=I,xe.push(E)}else m[0].charAt(m[0].length-2)!=="/"&&a.push([m[3],!1]);I="",O=0,w="",y=0,A=[];break;case"creator":m[1]==="/"?I=n.slice(O,m.index):O=m.index+m[0].length;break;case"meta":case"":case"settings":case"config-item-set":case"config-item-map-indexed":case"config-item-map-entry":case"config-item-map-named":case"shapes":case"frame":case"text-box":case"image":case"data-pilot-tables":case"list-style":case"form":case"dde-links":case"event-listeners":case"chart":if(m[1]==="/"){if((i=a.pop())[0]!==m[3])throw"Bad state: "+i}else m[0].charAt(m[0].length-2)!=="/"&&a.push([m[3],!1]);w="",y=0,A=[];break;case"scientific-number":break;case"currency-symbol":break;case"currency-style":break;case"number-style":case"percentage-style":case"date-style":case"time-style":if(m[1]==="/"){if(R[o.name]=l,(i=a.pop())[0]!==m[3])throw"Bad state: "+i}else m[0].charAt(m[0].length-2)!=="/"&&(l="",o=yt(m[0],!1),a.push([m[3],!0]));break;case"script":break;case"libraries":break;case"automatic-styles":break;case"default-style":case"page-layout":break;case"style":break;case"map":break;case"font-face":break;case"paragraph-properties":break;case"table-properties":break;case"table-column-properties":break;case"table-row-properties":break;case"table-cell-properties":break;case"number":switch(a[a.length-1][0]){case"time-style":case"date-style":s=yt(m[0],!1),l+=a_[m[3]][s.style==="long"?1:0];break}break;case"fraction":break;case"day":case"month":case"year":case"era":case"day-of-week":case"week-of-year":case"quarter":case"hours":case"minutes":case"seconds":case"am-pm":switch(a[a.length-1][0]){case"time-style":case"date-style":s=yt(m[0],!1),l+=a_[m[3]][s.style==="long"?1:0];break}break;case"boolean-style":break;case"boolean":break;case"text-style":break;case"text":if(m[0].slice(-2)==="/>")break;if(m[1]==="/")switch(a[a.length-1][0]){case"number-style":case"date-style":case"time-style":l+=n.slice(c,m.index);break}else c=m.index+m[0].length;break;case"named-range":s=yt(m[0],!1),he=v2(s["cell-range-address"]);var we={Name:s.name,Ref:he[0]+"!"+he[1]};K&&(we.Sheet=h.length),Q.Names.push(we);break;case"text-content":break;case"text-properties":break;case"embedded-text":break;case"body":case"":break;case"forms":break;case"table-column":break;case"table-header-rows":break;case"table-rows":break;case"table-column-group":break;case"table-header-columns":break;case"table-columns":break;case"null-date":break;case"graphic-properties":break;case"calculation-settings":break;case"named-expressions":break;case"label-range":break;case"label-ranges":break;case"named-expression":break;case"sort":break;case"sort-by":break;case"sort-groups":break;case"tab":break;case"line-break":break;case"span":break;case"p":case"":if(["master-styles"].indexOf(a[a.length-1][0])>-1)break;if(m[1]==="/"&&(!x||!x["string-value"])){var Pe=mK(n.slice(y,m.index));w=(w.length>0?w+`
`:"")+Pe[0]}else yt(m[0],!1),y=m.index+m[0].length;break;case"s":break;case"database-range":if(m[1]==="/")break;try{he=v2(yt(m[0])["target-range-address"]),p[he[0]]["!autofilter"]={ref:he[1]}}catch{}break;case"date":break;case"object":break;case"title":case"":break;case"desc":break;case"binary-data":break;case"table-source":break;case"scenario":break;case"iteration":break;case"content-validations":break;case"content-validation":break;case"help-message":break;case"error-message":break;case"database-ranges":break;case"filter":break;case"filter-and":break;case"filter-or":break;case"filter-condition":break;case"list-level-style-bullet":break;case"list-level-style-number":break;case"list-level-properties":break;case"sender-firstname":case"sender-lastname":case"sender-initials":case"sender-title":case"sender-position":case"sender-email":case"sender-phone-private":case"sender-fax":case"sender-company":case"sender-phone-work":case"sender-street":case"sender-city":case"sender-postal-code":case"sender-country":case"sender-state-or-province":case"author-name":case"author-initials":case"chapter":case"file-name":case"template-name":case"sheet-name":break;case"event-listener":break;case"initial-creator":case"creation-date":case"print-date":case"generator":case"document-statistic":case"user-defined":case"editing-duration":case"editing-cycles":break;case"config-item":break;case"page-number":break;case"page-count":break;case"time":break;case"cell-range-source":break;case"detective":break;case"operation":break;case"highlighted-range":break;case"data-pilot-table":case"source-cell-range":case"source-service":case"data-pilot-field":case"data-pilot-level":case"data-pilot-subtotals":case"data-pilot-subtotal":case"data-pilot-members":case"data-pilot-member":case"data-pilot-display-info":case"data-pilot-sort-info":case"data-pilot-layout-info":case"data-pilot-field-reference":case"data-pilot-groups":case"data-pilot-group":case"data-pilot-group-member":break;case"rect":break;case"dde-connection-decls":case"dde-connection-decl":case"dde-link":case"dde-source":break;case"properties":break;case"property":break;case"a":if(m[1]!=="/"){if(q=yt(m[0],!1),!q.href)break;q.Target=Ht(q.href),delete q.href,q.Target.charAt(0)=="#"&&q.Target.indexOf(".")>-1?(he=v2(q.Target.slice(1)),q.Target="#"+he[0]+"!"+he[1]):q.Target.match(/^\.\.[\\\/]/)&&(q.Target=q.Target.slice(3))}break;case"table-protection":break;case"data-pilot-grand-total":break;case"office-document-common-attrs":break;default:switch(m[2]){case"dc:":case"calcext:":case"loext:":case"ooo:":case"chartooo:":case"draw:":case"style:":case"chart:":case"form:":case"uof:":case":":case":":break;default:if(r.WTF)throw new Error(m)}}var Z={Sheets:p,SheetNames:h,Workbook:Q};return r.bookSheets&&delete Z.Sheets,Z}function i_(e,t){t=t||{},ri(e,"META-INF/manifest.xml")&&LV(Yr(e,"META-INF/manifest.xml"),t);var r=Oa(e,"content.xml");if(!r)throw new Error("Missing content.xml in ODS / UOF file");var n=uC(pr(r),t);return ri(e,"meta.xml")&&(n.Props=ST(Yr(e,"meta.xml"))),n}function s_(e,t){return uC(e,t)}/*! sheetjs (C) 2013-present SheetJS -- http://sheetjs.com */function C5(e){return new DataView(e.buffer,e.byteOffset,e.byteLength)}function fx(e){return typeof TextDecoder<"u"?new TextDecoder().decode(e):pr(hc(e))}function hx(e){var t=e.reduce(function(a,i){return a+i.length},0),r=new Uint8Array(t),n=0;return e.forEach(function(a){r.set(a,n),n+=a.length}),r}function o_(e){return e-=e>>1&1431655765,e=(e&858993459)+(e>>2&858993459),(e+(e>>4)&252645135)*16843009>>>24}function gK(e,t){for(var r=(e[t+15]&127)<<7|e[t+14]>>1,n=e[t+14]&1,a=t+13;a>=t;--a)n=n*256+e[a];return(e[t+15]&128?-n:n)*Math.pow(10,r-6176)}function uh(e,t){var r=t?t[0]:0,n=e[r]&127;e:if(e[r++]>=128&&(n|=(e[r]&127)<<7,e[r++]<128||(n|=(e[r]&127)<<14,e[r++]<128)||(n|=(e[r]&127)<<21,e[r++]<128)||(n+=(e[r]&127)*Math.pow(2,28),++r,e[r++]<128)||(n+=(e[r]&127)*Math.pow(2,35),++r,e[r++]<128)||(n+=(e[r]&127)*Math.pow(2,42),++r,e[r++]<128)))break e;return t&&(t[0]=r),n}function ln(e){var t=0,r=e[t]&127;e:if(e[t++]>=128){if(r|=(e[t]&127)<<7,e[t++]<128||(r|=(e[t]&127)<<14,e[t++]<128)||(r|=(e[t]&127)<<21,e[t++]<128))break e;r|=(e[t]&127)<<28}return r}function zn(e){for(var t=[],r=[0];r[0]<e.length;){var n=r[0],a=uh(e,r),i=a&7;a=Math.floor(a/8);var s=0,o;if(a==0)break;switch(i){case 0:{for(var l=r[0];e[r[0]++]>=128;);o=e.slice(l,r[0])}break;case 5:s=4,o=e.slice(r[0],r[0]+s),r[0]+=s;break;case 1:s=8,o=e.slice(r[0],r[0]+s),r[0]+=s;break;case 2:s=uh(e,r),o=e.slice(r[0],r[0]+s),r[0]+=s;break;case 3:case 4:default:throw new Error("PB Type ".concat(i," for Field ").concat(a," at offset ").concat(n))}var c={data:o,type:i};t[a]==null?t[a]=[c]:t[a].push(c)}return t}function N5(e,t){return(e==null?void 0:e.map(function(r){return t(r.data)}))||[]}function vK(e){for(var t,r=[],n=[0];n[0]<e.length;){var a=uh(e,n),i=zn(e.slice(n[0],n[0]+a));n[0]+=a;var s={id:ln(i[1][0].data),messages:[]};i[2].forEach(function(o){var l=zn(o.data),c=ln(l[3][0].data);s.messages.push({meta:l,data:e.slice(n[0],n[0]+c)}),n[0]+=c}),(t=i[3])!=null&&t[0]&&(s.merge=ln(i[3][0].data)>>>0>0),r.push(s)}return r}function xK(e,t){if(e!=0)throw new Error("Unexpected Snappy chunk type ".concat(e));for(var r=[0],n=uh(t,r),a=[];r[0]<t.length;){var i=t[r[0]]&3;if(i==0){var s=t[r[0]++]>>2;if(s<60)++s;else{var o=s-59;s=t[r[0]],o>1&&(s|=t[r[0]+1]<<8),o>2&&(s|=t[r[0]+2]<<16),o>3&&(s|=t[r[0]+3]<<24),s>>>=0,s++,r[0]+=o}a.push(t.slice(r[0],r[0]+s)),r[0]+=s;continue}else{var l=0,c=0;if(i==1?(c=(t[r[0]]>>2&7)+4,l=(t[r[0]++]&224)<<3,l|=t[r[0]++]):(c=(t[r[0]++]>>2)+1,i==2?(l=t[r[0]]|t[r[0]+1]<<8,r[0]+=2):(l=(t[r[0]]|t[r[0]+1]<<8|t[r[0]+2]<<16|t[r[0]+3]<<24)>>>0,r[0]+=4)),a=[hx(a)],l==0)throw new Error("Invalid offset 0");if(l>a[0].length)throw new Error("Invalid offset beyond length");if(c>=l)for(a.push(a[0].slice(-l)),c-=l;c>=a[a.length-1].length;)a.push(a[a.length-1]),c-=a[a.length-1].length;a.push(a[0].slice(-l,-l+c))}}var u=hx(a);if(u.length!=n)throw new Error("Unexpected length: ".concat(u.length," != ").concat(n));return u}function yK(e){for(var t=[],r=0;r<e.length;){var n=e[r++],a=e[r]|e[r+1]<<8|e[r+2]<<16;r+=3,t.push(xK(n,e.slice(r,r+a))),r+=a}if(r!==e.length)throw new Error("data is not a valid framed stream!");return hx(t)}function wK(e,t,r,n){var a=C5(e),i=a.getUint32(4,!0),s=(n>1?12:8)+o_(i&(n>1?3470:398))*4,o=-1,l=-1,c=NaN,u=new Date(2001,0,1);i&512&&(o=a.getUint32(s,!0),s+=4),s+=o_(i&(n>1?12288:4096))*4,i&16&&(l=a.getUint32(s,!0),s+=4),i&32&&(c=a.getFloat64(s,!0),s+=8),i&64&&(u.setTime(u.getTime()+a.getFloat64(s,!0)*1e3),s+=8);var f;switch(e[2]){case 0:break;case 2:f={t:"n",v:c};break;case 3:f={t:"s",v:t[l]};break;case 5:f={t:"d",v:u};break;case 6:f={t:"b",v:c>0};break;case 7:f={t:"n",v:c/86400};break;case 8:f={t:"e",v:0};break;case 9:if(o>-1)f={t:"s",v:r[o]};else if(l>-1)f={t:"s",v:t[l]};else if(!isNaN(c))f={t:"n",v:c};else throw new Error("Unsupported cell type ".concat(e.slice(0,4)));break;default:throw new Error("Unsupported cell type ".concat(e.slice(0,4)))}return f}function bK(e,t,r){var n=C5(e),a=n.getUint32(8,!0),i=12,s=-1,o=-1,l=NaN,c=NaN,u=new Date(2001,0,1);a&1&&(l=gK(e,i),i+=16),a&2&&(c=n.getFloat64(i,!0),i+=8),a&4&&(u.setTime(u.getTime()+n.getFloat64(i,!0)*1e3),i+=8),a&8&&(o=n.getUint32(i,!0),i+=4),a&16&&(s=n.getUint32(i,!0),i+=4);var f;switch(e[1]){case 0:break;case 2:f={t:"n",v:l};break;case 3:f={t:"s",v:t[o]};break;case 5:f={t:"d",v:u};break;case 6:f={t:"b",v:c>0};break;case 7:f={t:"n",v:c/86400};break;case 8:f={t:"e",v:0};break;case 9:if(s>-1)f={t:"s",v:r[s]};else throw new Error("Unsupported cell type ".concat(e[1]," : ").concat(a&31," : ").concat(e.slice(0,4)));break;case 10:f={t:"n",v:l};break;default:throw new Error("Unsupported cell type ".concat(e[1]," : ").concat(a&31," : ").concat(e.slice(0,4)))}return f}function _K(e,t,r){switch(e[0]){case 0:case 1:case 2:case 3:return wK(e,t,r,e[0]);case 5:return bK(e,t,r);default:throw new Error("Unsupported payload version ".concat(e[0]))}}function Yo(e){var t=zn(e);return uh(t[1][0].data)}function l_(e,t){var r=zn(t.data),n=ln(r[1][0].data),a=r[3],i=[];return(a||[]).forEach(function(s){var o=zn(s.data),l=ln(o[1][0].data)>>>0;switch(n){case 1:i[l]=fx(o[3][0].data);break;case 8:{var c=e[Yo(o[9][0].data)][0],u=zn(c.data),f=e[Yo(u[1][0].data)][0],p=ln(f.meta[1][0].data);if(p!=2001)throw new Error("2000 unexpected reference to ".concat(p));var h=zn(f.data);i[l]=h[3].map(function(g){return fx(g.data)}).join("")}break}}),i}function SK(e,t){var r,n,a,i,s,o,l,c,u,f,p,h,g,m,b=zn(e),x=ln(b[1][0].data)>>>0,w=ln(b[2][0].data)>>>0,y=((n=(r=b[8])==null?void 0:r[0])==null?void 0:n.data)&&ln(b[8][0].data)>0||!1,A,L;if((i=(a=b[7])==null?void 0:a[0])!=null&&i.data&&t!=0)A=(o=(s=b[7])==null?void 0:s[0])==null?void 0:o.data,L=(c=(l=b[6])==null?void 0:l[0])==null?void 0:c.data;else if((f=(u=b[4])==null?void 0:u[0])!=null&&f.data&&t!=1)A=(h=(p=b[4])==null?void 0:p[0])==null?void 0:h.data,L=(m=(g=b[3])==null?void 0:g[0])==null?void 0:m.data;else throw"NUMBERS Tile missing ".concat(t," cell storage");for(var D=y?4:1,T=C5(A),F=[],R=0;R<A.length/2;++R){var X=T.getUint16(R*2,!0);X<65535&&F.push([R,X])}if(F.length!=w)throw"Expected ".concat(w," cells, found ").concat(F.length);var N=[];for(R=0;R<F.length-1;++R)N[F[R][0]]=L.subarray(F[R][1]*D,F[R+1][1]*D);return F.length>=1&&(N[F[F.length-1][0]]=L.subarray(F[F.length-1][1]*D)),{R:x,cells:N}}function kK(e,t){var r,n=zn(t.data),a=(r=n==null?void 0:n[7])!=null&&r[0]?ln(n[7][0].data)>>>0>0?1:0:-1,i=N5(n[5],function(s){return SK(s,a)});return{nrows:ln(n[4][0].data)>>>0,data:i.reduce(function(s,o){return s[o.R]||(s[o.R]=[]),o.cells.forEach(function(l,c){if(s[o.R][c])throw new Error("Duplicate cell r=".concat(o.R," c=").concat(c));s[o.R][c]=l}),s},[])}}function EK(e,t,r){var n,a=zn(t.data),i={s:{r:0,c:0},e:{r:0,c:0}};if(i.e.r=(ln(a[6][0].data)>>>0)-1,i.e.r<0)throw new Error("Invalid row varint ".concat(a[6][0].data));if(i.e.c=(ln(a[7][0].data)>>>0)-1,i.e.c<0)throw new Error("Invalid col varint ".concat(a[7][0].data));r["!ref"]=Ut(i);var s=zn(a[4][0].data),o=l_(e,e[Yo(s[4][0].data)][0]),l=(n=s[17])!=null&&n[0]?l_(e,e[Yo(s[17][0].data)][0]):[],c=zn(s[3][0].data),u=0;c[1].forEach(function(f){var p=zn(f.data),h=e[Yo(p[2][0].data)][0],g=ln(h.meta[1][0].data);if(g!=6002)throw new Error("6001 unexpected reference to ".concat(g));var m=kK(e,h);m.data.forEach(function(b,x){b.forEach(function(w,y){var A=Ct({r:u+x,c:y}),L=_K(w,o,l);L&&(r[A]=L)})}),u+=m.nrows})}function AK(e,t){var r=zn(t.data),n={"!ref":"A1"},a=e[Yo(r[2][0].data)],i=ln(a[0].meta[1][0].data);if(i!=6001)throw new Error("6000 unexpected reference to ".concat(i));return EK(e,a[0],n),n}function TK(e,t){var r,n=zn(t.data),a={name:(r=n[1])!=null&&r[0]?fx(n[1][0].data):"",sheets:[]},i=N5(n[2],Yo);return i.forEach(function(s){e[s].forEach(function(o){var l=ln(o.meta[1][0].data);l==6e3&&a.sheets.push(AK(e,o))})}),a}function CK(e,t){var r=F5(),n=zn(t.data),a=N5(n[1],Yo);if(a.forEach(function(i){e[i].forEach(function(s){var o=ln(s.meta[1][0].data);if(o==2){var l=TK(e,s);l.sheets.forEach(function(c,u){O5(r,c,u==0?l.name:l.name+"_"+u,!0)})}})}),r.SheetNames.length==0)throw new Error("Empty NUMBERS file");return r}function y2(e){var t,r,n,a,i={},s=[];if(e.FullPaths.forEach(function(l){if(l.match(/\.iwpv2/))throw new Error("Unsupported password protection")}),e.FileIndex.forEach(function(l){if(l.name.match(/\.iwa$/)){var c;try{c=yK(l.content)}catch(f){return console.log("?? "+l.content.length+" "+(f.message||f))}var u;try{u=vK(c)}catch(f){return console.log("## "+(f.message||f))}u.forEach(function(f){i[f.id]=f.messages,s.push(f.id)})}}),!s.length)throw new Error("File has no messages");var o=((a=(n=(r=(t=i==null?void 0:i[1])==null?void 0:t[0])==null?void 0:r.meta)==null?void 0:n[1])==null?void 0:a[0].data)&&ln(i[1][0].meta[1][0].data)==1&&i[1][0];if(o||s.forEach(function(l){i[l].forEach(function(c){var u=ln(c.meta[1][0].data)>>>0;if(u==1)if(!o)o=c;else throw new Error("Document has multiple roots")})}),!o)throw new Error("Cannot find Document root");return CK(i,o)}function NK(e){return function(r){for(var n=0;n!=e.length;++n){var a=e[n];r[a[0]]===void 0&&(r[a[0]]=a[1]),a[2]==="n"&&(r[a[0]]=Number(r[a[0]]))}}}function P5(e){NK([["cellNF",!1],["cellHTML",!0],["cellFormula",!0],["cellStyles",!1],["cellText",!0],["cellDates",!1],["sheetStubs",!1],["sheetRows",0,"n"],["bookDeps",!1],["bookSheets",!1],["bookProps",!1],["bookFiles",!1],["bookVBA",!1],["password",""],["WTF",!1]])(e)}function PK(e){return mu.WS.indexOf(e)>-1?"sheet":e==mu.CS?"chart":e==mu.DS?"dialog":e==mu.MS?"macro":e&&e.length?e:"sheet"}function LK(e,t){if(!e)return 0;try{e=t.map(function(n){return n.id||(n.id=n.strRelID),[n.name,e["!id"][n.id].Target,PK(e["!id"][n.id].Type)]})}catch{return null}return!e||e.length===0?null:e}function FK(e,t,r,n,a,i,s,o,l,c,u,f){try{i[n]=E0(Oa(e,r,!0),t);var p=Yr(e,t),h;switch(o){case"sheet":h=MG(p,t,a,l,i[n],c,u,f);break;case"chart":if(h=BG(p,t,a,l,i[n],c,u,f),!h||!h["!drawel"])break;var g=e0(h["!drawel"].Target,t),m=sx(g),b=jH(Oa(e,g,!0),E0(Oa(e,m,!0),g)),x=e0(b,g),w=sx(x);h=bG(Oa(e,x,!0),x,l,E0(Oa(e,w,!0),x),c,h);break;case"macro":h=UG(p,t,a,l,i[n],c,u,f);break;case"dialog":h=VG(p,t,a,l,i[n],c,u,f);break;default:throw new Error("Unrecognized sheet type "+o)}s[n]=h;var y=[];i&&i[n]&&hs(i[n]).forEach(function(A){var L="";if(i[n][A].Type==mu.CMNT){L=e0(i[n][A].Target,t);var D=WG(Yr(e,L,!0),L,l);if(!D||!D.length)return;G3(h,D,!1)}i[n][A].Type==mu.TCMNT&&(L=e0(i[n][A].Target,t),y=y.concat(BH(Yr(e,L,!0),l)))}),y&&y.length&&G3(h,y,!0,l.people||[])}catch(A){if(l.WTF)throw A}}function Za(e){return e.charAt(0)=="/"?e.slice(1):e}function OK(e,t){if(KA(),t=t||{},P5(t),ri(e,"META-INF/manifest.xml")||ri(e,"objectdata.xml"))return i_(e,t);if(ri(e,"Index/Document.iwa")){if(typeof Uint8Array>"u")throw new Error("NUMBERS file parsing requires Uint8Array support");if(typeof y2<"u"){if(e.FileIndex)return y2(e);var r=Bt.utils.cfb_new();return w3(e).forEach(function(W){DU(r,W,OU(e,W))}),y2(r)}throw new Error("Unsupported NUMBERS file")}if(!ri(e,"[Content_Types].xml"))throw ri(e,"index.xml.gz")?new Error("Unsupported NUMBERS 08 file"):ri(e,"index.xml")?new Error("Unsupported NUMBERS 09 file"):new Error("Unsupported ZIP file");var n=w3(e),a=NV(Oa(e,"[Content_Types].xml")),i=!1,s,o;if(a.workbooks.length===0&&(o="xl/workbook.xml",Yr(e,o,!0)&&a.workbooks.push(o)),a.workbooks.length===0){if(o="xl/workbook.bin",!Yr(e,o,!0))throw new Error("Could not find workbook");a.workbooks.push(o),i=!0}a.workbooks[0].slice(-3)=="bin"&&(i=!0);var l={},c={};if(!t.bookSheets&&!t.bookProps){if(C0=[],a.sst)try{C0=HG(Yr(e,Za(a.sst)),a.sst,t)}catch(W){if(t.WTF)throw W}t.cellStyles&&a.themes.length&&(l=zG(Oa(e,a.themes[0].replace(/^\//,""),!0)||"",a.themes[0],t)),a.style&&(c=$G(Yr(e,Za(a.style)),a.style,l,t))}a.links.map(function(W){try{var se=E0(Oa(e,sx(Za(W))),W);return GG(Yr(e,Za(W)),se,W,t)}catch{}});var u=jG(Yr(e,Za(a.workbooks[0])),a.workbooks[0],t),f={},p="";a.coreprops.length&&(p=Yr(e,Za(a.coreprops[0]),!0),p&&(f=ST(p)),a.extprops.length!==0&&(p=Yr(e,Za(a.extprops[0]),!0),p&&DV(p,f,t)));var h={};(!t.bookSheets||t.bookProps)&&a.custprops.length!==0&&(p=Oa(e,Za(a.custprops[0]),!0),p&&(h=RV(p,t)));var g={};if((t.bookSheets||t.bookProps)&&(u.Sheets?s=u.Sheets.map(function(se){return se.name}):f.Worksheets&&f.SheetNames.length>0&&(s=f.SheetNames),t.bookProps&&(g.Props=f,g.Custprops=h),t.bookSheets&&typeof s<"u"&&(g.SheetNames=s),t.bookSheets?g.SheetNames:t.bookProps))return g;s={};var m={};t.bookDeps&&a.calcchain&&(m=qG(Yr(e,Za(a.calcchain)),a.calcchain));var b=0,x={},w,y;{var A=u.Sheets;f.Worksheets=A.length,f.SheetNames=[];for(var L=0;L!=A.length;++L)f.SheetNames[L]=A[L].name}var D=i?"bin":"xml",T=a.workbooks[0].lastIndexOf("/"),F=(a.workbooks[0].slice(0,T+1)+"_rels/"+a.workbooks[0].slice(T+1)+".rels").replace(/^\//,"");ri(e,F)||(F="xl/_rels/workbook."+D+".rels");var R=E0(Oa(e,F,!0),F.replace(/_rels.*/,"s5s"));(a.metadata||[]).length>=1&&(t.xlmeta=KG(Yr(e,Za(a.metadata[0])),a.metadata[0],t)),(a.people||[]).length>=1&&(t.people=UH(Yr(e,Za(a.people[0])),t)),R&&(R=LK(R,u.Sheets));var X=Yr(e,"xl/worksheets/sheet.xml",!0)?1:0;e:for(b=0;b!=f.Worksheets;++b){var N="sheet";if(R&&R[b]?(w="xl/"+R[b][1].replace(/[\/]?xl\//,""),ri(e,w)||(w=R[b][1]),ri(e,w)||(w=F.replace(/_rels\/.*$/,"")+R[b][1]),N=R[b][2]):(w="xl/worksheets/sheet"+(b+1-X)+"."+D,w=w.replace(/sheet0\./,"sheet.")),y=w.replace(/^(.*)(\/)([^\/]*)$/,"$1/_rels/$3.rels"),t&&t.sheets!=null)switch(typeof t.sheets){case"number":if(b!=t.sheets)continue e;break;case"string":if(f.SheetNames[b].toLowerCase()!=t.sheets.toLowerCase())continue e;break;default:if(Array.isArray&&Array.isArray(t.sheets)){for(var P=!1,J=0;J!=t.sheets.length;++J)typeof t.sheets[J]=="number"&&t.sheets[J]==b&&(P=1),typeof t.sheets[J]=="string"&&t.sheets[J].toLowerCase()==f.SheetNames[b].toLowerCase()&&(P=1);if(!P)continue e}}FK(e,w,y,f.SheetNames[b],b,x,s,N,t,u,l,c)}return g={Directory:a,Workbook:u,Props:f,Custprops:h,Deps:m,Sheets:s,SheetNames:f.SheetNames,Strings:C0,Styles:c,Themes:l,SSF:Sn(Ft)},t&&t.bookFiles&&(e.files?(g.keys=n,g.files=e.files):(g.keys=[],g.files={},e.FullPaths.forEach(function(W,se){W=W.replace(/^Root Entry[\/]/,""),g.keys.push(W),g.files[W]=e.FileIndex[se]}))),t&&t.bookVBA&&(a.vba.length>0?g.vbaraw=Yr(e,Za(a.vba[0]),!0):a.defaults&&a.defaults.bin===HH&&(g.vbaraw=Yr(e,"xl/vbaProject.bin",!0))),g}function DK(e,t){var r=t||{},n="Workbook",a=Bt.find(e,n);try{if(n="/!DataSpaces/Version",a=Bt.find(e,n),!a||!a.content)throw new Error("ECMA-376 Encrypted file missing "+n);if(Az(a.content),n="/!DataSpaces/DataSpaceMap",a=Bt.find(e,n),!a||!a.content)throw new Error("ECMA-376 Encrypted file missing "+n);var i=Cz(a.content);if(i.length!==1||i[0].comps.length!==1||i[0].comps[0].t!==0||i[0].name!=="StrongEncryptionDataSpace"||i[0].comps[0].v!=="EncryptedPackage")throw new Error("ECMA-376 Encrypted file bad "+n);if(n="/!DataSpaces/DataSpaceInfo/StrongEncryptionDataSpace",a=Bt.find(e,n),!a||!a.content)throw new Error("ECMA-376 Encrypted file missing "+n);var s=Nz(a.content);if(s.length!=1||s[0]!="StrongEncryptionTransform")throw new Error("ECMA-376 Encrypted file bad "+n);if(n="/!DataSpaces/TransformInfo/StrongEncryptionTransform/!Primary",a=Bt.find(e,n),!a||!a.content)throw new Error("ECMA-376 Encrypted file missing "+n);Lz(a.content)}catch{}if(n="/EncryptionInfo",a=Bt.find(e,n),!a||!a.content)throw new Error("ECMA-376 Encrypted file missing "+n);var o=Fz(a.content);if(n="/EncryptedPackage",a=Bt.find(e,n),!a||!a.content)throw new Error("ECMA-376 Encrypted file missing "+n);if(o[0]==4&&typeof decrypt_agile<"u")return decrypt_agile(o[1],a.content,r.password||"",r);if(o[0]==2&&typeof decrypt_std76<"u")return decrypt_std76(o[1],a.content,r.password||"",r);throw new Error("File is password-protected")}function L5(e,t){var r="";switch((t||{}).type||"base64"){case"buffer":return[e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7]];case"base64":r=Ba(e.slice(0,12));break;case"binary":r=e;break;case"array":return[e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7]];default:throw new Error("Unrecognized type "+(t&&t.type||"undefined"))}return[r.charCodeAt(0),r.charCodeAt(1),r.charCodeAt(2),r.charCodeAt(3),r.charCodeAt(4),r.charCodeAt(5),r.charCodeAt(6),r.charCodeAt(7)]}function IK(e,t){return Bt.find(e,"EncryptedPackage")?DK(e,t):oC(e,t)}function RK(e,t){var r,n=e,a=t||{};return a.type||(a.type=jt&&Buffer.isBuffer(e)?"buffer":"base64"),r=eT(n,a),OK(r,a)}function fC(e,t){var r=0;e:for(;r<e.length;)switch(e.charCodeAt(r)){case 10:case 13:case 32:++r;break;case 60:return cx(e.slice(r),t);default:break e}return oh.to_workbook(e,t)}function jK(e,t){var r="",n=L5(e,t);switch(t.type){case"base64":r=Ba(e);break;case"binary":r=e;break;case"buffer":r=e.toString("binary");break;case"array":r=rc(e);break;default:throw new Error("Unrecognized type "+t.type)}return n[0]==239&&n[1]==187&&n[2]==191&&(r=pr(r)),t.type="binary",fC(r,t)}function MK(e,t){var r=e;return t.type=="base64"&&(r=Ba(r)),r=Oo.utils.decode(1200,r.slice(2),"str"),t.type="binary",fC(r,t)}function BK(e){return e.match(/[^\x00-\x7F]/)?t0(e):e}function w2(e,t,r,n){return n?(r.type="string",oh.to_workbook(e,r)):oh.to_workbook(t,r)}function dx(e,t){RA();var r=t||{};if(typeof ArrayBuffer<"u"&&e instanceof ArrayBuffer)return dx(new Uint8Array(e),(r=Sn(r),r.type="array",r));typeof Uint8Array<"u"&&e instanceof Uint8Array&&!r.type&&(r.type=typeof Deno<"u"?"buffer":"array");var n=e,a=[0,0,0,0],i=!1;if(r.cellStyles&&(r.cellNF=!0,r.sheetStubs=!0),Eu={},r.dateNF&&(Eu.dateNF=r.dateNF),r.type||(r.type=jt&&Buffer.isBuffer(e)?"buffer":"base64"),r.type=="file"&&(r.type=jt?"buffer":"binary",n=AU(e),typeof Uint8Array<"u"&&!jt&&(r.type="array")),r.type=="string"&&(i=!0,r.type="binary",r.codepage=65001,n=BK(e)),r.type=="array"&&typeof Uint8Array<"u"&&e instanceof Uint8Array&&typeof ArrayBuffer<"u"){var s=new ArrayBuffer(3),o=new Uint8Array(s);if(o.foo="bar",!o.foo)return r=Sn(r),r.type="array",dx(c5(n),r)}switch((a=L5(n,r))[0]){case 208:if(a[1]===207&&a[2]===17&&a[3]===224&&a[4]===161&&a[5]===177&&a[6]===26&&a[7]===225)return IK(Bt.read(n,r),r);break;case 9:if(a[1]<=8)return oC(n,r);break;case 60:return cx(n,r);case 73:if(a[1]===73&&a[2]===42&&a[3]===0)throw new Error("TIFF Image File is not a spreadsheet");if(a[1]===68)return dz(n,r);break;case 84:if(a[1]===65&&a[2]===66&&a[3]===76)return fz.to_workbook(n,r);break;case 80:return a[1]===75&&a[2]<9&&a[3]<9?RK(n,r):w2(e,n,r,i);case 239:return a[3]===60?cx(n,r):w2(e,n,r,i);case 255:if(a[1]===254)return MK(n,r);if(a[1]===0&&a[2]===2&&a[3]===0)return T0.to_workbook(n,r);break;case 0:if(a[1]===0&&(a[2]>=2&&a[3]===0||a[2]===0&&(a[3]===8||a[3]===9)))return T0.to_workbook(n,r);break;case 3:case 131:case 139:case 140:return q3.to_workbook(n,r);case 123:if(a[1]===92&&a[2]===114&&a[3]===116)return Hz.to_workbook(n,r);break;case 10:case 13:case 32:return jK(n,r);case 137:if(a[1]===80&&a[2]===78&&a[3]===71)throw new Error("PNG Image File is not a spreadsheet");break}return cz.indexOf(a[0])>-1&&a[2]<=12&&a[3]<=31?q3.to_workbook(n,r):w2(e,n,r,i)}function UK(e,t,r,n,a,i,s,o){var l=kn(r),c=o.defval,u=o.raw||!Object.prototype.hasOwnProperty.call(o,"raw"),f=!0,p=a===1?[]:{};if(a!==1)if(Object.defineProperty)try{Object.defineProperty(p,"__rowNum__",{value:r,enumerable:!1})}catch{p.__rowNum__=r}else p.__rowNum__=r;if(!s||e[r])for(var h=t.s.c;h<=t.e.c;++h){var g=s?e[r][h]:e[n[h]+l];if(g===void 0||g.t===void 0){if(c===void 0)continue;i[h]!=null&&(p[i[h]]=c);continue}var m=g.v;switch(g.t){case"z":if(m==null)break;continue;case"e":m=m==0?null:void 0;break;case"s":case"d":case"b":case"n":break;default:throw new Error("unrecognized type "+g.t)}if(i[h]!=null){if(m==null)if(g.t=="e"&&m===null)p[i[h]]=null;else if(c!==void 0)p[i[h]]=c;else if(u&&m===null)p[i[h]]=null;else continue;else p[i[h]]=u&&(g.t!=="n"||g.t==="n"&&o.rawNumbers!==!1)?m:Zs(g,m,o);m!=null&&(f=!1)}}return{row:p,isempty:f}}function px(e,t){if(e==null||e["!ref"]==null)return[];var r={t:"n",v:0},n=0,a=1,i=[],s=0,o="",l={s:{r:0,c:0},e:{r:0,c:0}},c=t||{},u=c.range!=null?c.range:e["!ref"];switch(c.header===1?n=1:c.header==="A"?n=2:Array.isArray(c.header)?n=3:c.header==null&&(n=0),typeof u){case"string":l=Or(u);break;case"number":l=Or(e["!ref"]),l.s.r=u;break;default:l=u}n>0&&(a=0);var f=kn(l.s.r),p=[],h=[],g=0,m=0,b=Array.isArray(e),x=l.s.r,w=0,y={};b&&!e[x]&&(e[x]=[]);var A=c.skipHidden&&e["!cols"]||[],L=c.skipHidden&&e["!rows"]||[];for(w=l.s.c;w<=l.e.c;++w)if(!(A[w]||{}).hidden)switch(p[w]=sn(w),r=b?e[x][w]:e[p[w]+f],n){case 1:i[w]=w-l.s.c;break;case 2:i[w]=p[w];break;case 3:i[w]=c.header[w-l.s.c];break;default:if(r==null&&(r={w:"__EMPTY",t:"s"}),o=s=Zs(r,null,c),m=y[s]||0,!m)y[s]=1;else{do o=s+"_"+m++;while(y[o]);y[s]=m,y[o]=1}i[w]=o}for(x=l.s.r+a;x<=l.e.r;++x)if(!(L[x]||{}).hidden){var D=UK(e,l,x,p,n,i,b,c);(D.isempty===!1||(n===1?c.blankrows!==!1:c.blankrows))&&(h[g++]=D.row)}return h.length=g,h}var c_=/"/g;function VK(e,t,r,n,a,i,s,o){for(var l=!0,c=[],u="",f=kn(r),p=t.s.c;p<=t.e.c;++p)if(n[p]){var h=o.dense?(e[r]||[])[p]:e[n[p]+f];if(h==null)u="";else if(h.v!=null){l=!1,u=""+(o.rawNumbers&&h.t=="n"?h.v:Zs(h,null,o));for(var g=0,m=0;g!==u.length;++g)if((m=u.charCodeAt(g))===a||m===i||m===34||o.forceQuotes){u='"'+u.replace(c_,'""')+'"';break}u=="ID"&&(u='"ID"')}else h.f!=null&&!h.F?(l=!1,u="="+h.f,u.indexOf(",")>=0&&(u='"'+u.replace(c_,'""')+'"')):u="";c.push(u)}return o.blankrows===!1&&l?null:c.join(s)}function hC(e,t){var r=[],n=t??{};if(e==null||e["!ref"]==null)return"";var a=Or(e["!ref"]),i=n.FS!==void 0?n.FS:",",s=i.charCodeAt(0),o=n.RS!==void 0?n.RS:`
`,l=o.charCodeAt(0),c=new RegExp((i=="|"?"\\|":i)+"+$"),u="",f=[];n.dense=Array.isArray(e);for(var p=n.skipHidden&&e["!cols"]||[],h=n.skipHidden&&e["!rows"]||[],g=a.s.c;g<=a.e.c;++g)(p[g]||{}).hidden||(f[g]=sn(g));for(var m=0,b=a.s.r;b<=a.e.r;++b)(h[b]||{}).hidden||(u=VK(e,a,b,f,s,l,i,n),u!=null&&(n.strip&&(u=u.replace(c,"")),(u||n.blankrows!==!1)&&r.push((m++?o:"")+u)));return delete n.dense,r.join("")}function $K(e,t){t||(t={}),t.FS="	",t.RS=`
`;var r=hC(e,t);return r}function zK(e){var t="",r,n="";if(e==null||e["!ref"]==null)return[];var a=Or(e["!ref"]),i="",s=[],o,l=[],c=Array.isArray(e);for(o=a.s.c;o<=a.e.c;++o)s[o]=sn(o);for(var u=a.s.r;u<=a.e.r;++u)for(i=kn(u),o=a.s.c;o<=a.e.c;++o)if(t=s[o]+i,r=c?(e[u]||[])[o]:e[t],n="",r!==void 0){if(r.F!=null){if(t=r.F,!r.f)continue;n=r.f,t.indexOf(":")==-1&&(t=t+":"+t)}if(r.f!=null)n=r.f;else{if(r.t=="z")continue;if(r.t=="n"&&r.v!=null)n=""+r.v;else if(r.t=="b")n=r.v?"TRUE":"FALSE";else if(r.w!==void 0)n="'"+r.w;else{if(r.v===void 0)continue;r.t=="s"?n="'"+r.v:n=""+r.v}}l[l.length]=t+"="+n}return l}function dC(e,t,r){var n=r||{},a=+!n.skipHeader,i=e||{},s=0,o=0;if(i&&n.origin!=null)if(typeof n.origin=="number")s=n.origin;else{var l=typeof n.origin=="string"?ra(n.origin):n.origin;s=l.r,o=l.c}var c,u={s:{c:0,r:0},e:{c:o,r:s+t.length-1+a}};if(i["!ref"]){var f=Or(i["!ref"]);u.e.c=Math.max(u.e.c,f.e.c),u.e.r=Math.max(u.e.r,f.e.r),s==-1&&(s=f.e.r+1,u.e.r=s+t.length-1+a)}else s==-1&&(s=0,u.e.r=t.length-1+a);var p=n.header||[],h=0;t.forEach(function(m,b){hs(m).forEach(function(x){(h=p.indexOf(x))==-1&&(p[h=p.length]=x);var w=m[x],y="z",A="",L=Ct({c:o+h,r:s+b+a});c=fh(i,L),w&&typeof w=="object"&&!(w instanceof Date)?i[L]=w:(typeof w=="number"?y="n":typeof w=="boolean"?y="b":typeof w=="string"?y="s":w instanceof Date?(y="d",n.cellDates||(y="n",w=ia(w)),A=n.dateNF||Ft[14]):w===null&&n.nullError&&(y="e",w=0),c?(c.t=y,c.v=w,delete c.w,delete c.R,A&&(c.z=A)):i[L]=c={t:y,v:w},A&&(c.z=A))})}),u.e.c=Math.max(u.e.c,o+p.length-1);var g=kn(s);if(a)for(h=0;h<p.length;++h)i[sn(h+o)+g]={t:"s",v:p[h]};return i["!ref"]=Ut(u),i}function HK(e,t){return dC(null,e,t)}function fh(e,t,r){if(typeof t=="string"){if(Array.isArray(e)){var n=ra(t);return e[n.r]||(e[n.r]=[]),e[n.r][n.c]||(e[n.r][n.c]={t:"z"})}return e[t]||(e[t]={t:"z"})}return typeof t!="number"?fh(e,Ct(t)):fh(e,Ct({r:t,c:r||0}))}function WK(e,t){if(typeof t=="number"){if(t>=0&&e.SheetNames.length>t)return t;throw new Error("Cannot find sheet # "+t)}else if(typeof t=="string"){var r=e.SheetNames.indexOf(t);if(r>-1)return r;throw new Error("Cannot find sheet name |"+t+"|")}else throw new Error("Cannot find sheet |"+t+"|")}function F5(){return{SheetNames:[],Sheets:{}}}function O5(e,t,r,n){var a=1;if(!r)for(;a<=65535&&e.SheetNames.indexOf(r="Sheet"+a)!=-1;++a,r=void 0);if(!r||e.SheetNames.length>=65535)throw new Error("Too many worksheets");if(n&&e.SheetNames.indexOf(r)>=0){var i=r.match(/(^.*?)(\d+)$/);a=i&&+i[2]||0;var s=i&&i[1]||r;for(++a;a<=65535&&e.SheetNames.indexOf(r=s+a)!=-1;++a);}if(NG(r),e.SheetNames.indexOf(r)>=0)throw new Error("Worksheet with name |"+r+"| already exists!");return e.SheetNames.push(r),e.Sheets[r]=t,r}function qK(e,t,r){e.Workbook||(e.Workbook={}),e.Workbook.Sheets||(e.Workbook.Sheets=[]);var n=WK(e,t);switch(e.Workbook.Sheets[n]||(e.Workbook.Sheets[n]={}),r){case 0:case 1:case 2:break;default:throw new Error("Bad sheet visibility setting "+r)}e.Workbook.Sheets[n].Hidden=r}function GK(e,t){return e.z=t,e}function pC(e,t,r){return t?(e.l={Target:t},r&&(e.l.Tooltip=r)):delete e.l,e}function KK(e,t,r){return pC(e,"#"+t,r)}function XK(e,t,r){e.c||(e.c=[]),e.c.push({t,a:r||"SheetJS"})}function YK(e,t,r,n){for(var a=typeof t!="string"?t:Or(t),i=typeof t=="string"?t:Ut(t),s=a.s.r;s<=a.e.r;++s)for(var o=a.s.c;o<=a.e.c;++o){var l=fh(e,s,o);l.t="n",l.F=i,delete l.v,s==a.s.r&&o==a.s.c&&(l.f=r,n&&(l.D=!0))}return e}var b2={encode_col:sn,encode_row:kn,encode_cell:Ct,encode_range:Ut,decode_col:x5,decode_row:v5,split_cell:lV,decode_cell:ra,decode_range:ef,format_cell:Zs,sheet_add_aoa:xT,sheet_add_json:dC,sheet_add_dom:lC,aoa_to_sheet:tf,json_to_sheet:HK,table_to_sheet:cC,table_to_book:dK,sheet_to_csv:hC,sheet_to_txt:$K,sheet_to_json:px,sheet_to_html:hK,sheet_to_formulae:zK,sheet_to_row_object_array:px,sheet_get_cell:fh,book_new:F5,book_append_sheet:O5,book_set_sheet_visibility:qK,cell_set_number_format:GK,cell_set_hyperlink:pC,cell_set_internal_link:KK,cell_add_comment:XK,sheet_set_array_formula:YK,consts:{SHEET_VISIBLE:0,SHEET_HIDDEN:1,SHEET_VERY_HIDDEN:2}};function up(e){return e.normalize("NFD").replace(/[\u0300-\u036f]/g,"").replace(/\s+/g," ").trim().toUpperCase()}function JK(e){const t=new Date(Date.UTC(1899,11,30)),n=Math.floor(e)*24*60*60*1e3;return new Date(t.getTime()+n).toISOString().slice(0,10)}const QK=()=>{const{addArticle:e,addMovement:t,articles:r}=ds(),n=ie.useRef(null),[a,i]=ie.useState(null),[s,o]=ie.useState([]),[l,c]=ie.useState([]),[u,f]=ie.useState(!1),[p,h]=ie.useState(!1),[g,m]=ie.useState(null),[b,x]=ie.useState(!1),w=async R=>{var xe;o([]),c([]),i(null);const X=(xe=R.target.files)==null?void 0:xe[0];if(!X)return;const N=await X.arrayBuffer(),P=dx(N);let J=[],W=[],se=[],fe=[],U=!1;P.SheetNames.forEach(E=>{const I=b2.sheet_to_json(P.Sheets[E],{defval:"",raw:!1});if(I.length>0&&I[0].Nombre_Articulo&&I[0].Costo_Unitario){U=!0;for(const O of I)O.Nombre_Articulo&&J.push({nombre:O.Nombre_Articulo.toString().trim(),costo:Number(O.Costo_Unitario)||0})}});let Q=!1;P.SheetNames.forEach(E=>{const I=b2.sheet_to_json(P.Sheets[E],{defval:"",raw:!1});if(I.length>0&&I[0].Nombre_Articulo&&I[0].Tipo_Movimiento&&I[0].Cantidad&&I[0].Fecha){Q=!0;for(const O of I)!O.Nombre_Articulo||!O.Tipo_Movimiento||!O.Cantidad||W.push({articulo:O.Nombre_Articulo.toString().trim(),tipo:O.Tipo_Movimiento==="Entrada"?"Entrada":"Salida",fecha:O.Fecha,descripcion:O.Descripcion||"",cantidad:Math.round(Number(O.Cantidad)),costo:O.Costo_Unitario?Number(O.Costo_Unitario):0})}else if(I.length>0&&I[0].ID_Articulo&&I[0].Tipo_Movimiento&&I[0].Cantidad&&I[0].Fecha){Q=!0;for(const O of I)!O.ID_Articulo||!O.Tipo_Movimiento||!O.Cantidad||W.push({articulo:"",tipo:O.Tipo_Movimiento==="Entrada"?"Entrada":"Salida",fecha:O.Fecha,descripcion:O.Descripcion||"",cantidad:Math.round(Number(O.Cantidad)),costo:O.Costo_Unitario?Number(O.Costo_Unitario):0,id_articulo:Number(O.ID_Articulo)})}}),!U&&!Q&&P.SheetNames.forEach(E=>{const I=b2.sheet_to_json(P.Sheets[E],{header:1,blankrows:!1});let O=null,j=!1;for(let K=0;K<I.length;K++){const ne=I[K];if(!(!Array.isArray(ne)||ne.length===0)){if(typeof ne[0]=="string"&&ne[0].toUpperCase().includes("PRODUCTO:")){const pe=(ne[0].split(":")[1]||"").trim()+(ne[1]?" "+ne[1]:"");if(!pe){fe.push(`Se detect un artculo sin nombre en la hoja '${E}', fila ${K+1}.`);continue}O={nombre:pe,costo:0},J.push(O),j=!1}if(typeof ne[0]=="string"&&ne[0].toUpperCase().includes("FEC")){j=!0;continue}if(j&&O){let pe="";if(typeof ne[0]=="number"?pe=JK(ne[0]):typeof ne[0]=="string"&&ne[0].match(/^\d{4}-\d{2}-\d{2}/)&&(pe=ne[0]),pe){const de=ne[1]||"";ne[2]&&!isNaN(Number(ne[2]))&&(W.push({articulo:O.nombre,tipo:"Entrada",fecha:pe,descripcion:de,cantidad:Math.round(Number(ne[2])),costo:Number(ne[3])||0}),Number(ne[3])>(O.costo||0)&&(O.costo=Number(ne[3]))),ne[7]&&!isNaN(Number(ne[7]))&&W.push({articulo:O.nombre,tipo:"Salida",fecha:pe,descripcion:de,cantidad:Math.round(Number(ne[7])),costo:Number(ne[8])||0})}}}}});const q=W.filter(E=>E.cantidad>0),he=W.filter(E=>E.cantidad<=0);o(se),c(fe),i({articles:J,movements:q,movimientosDescartados:he})},y={};r.forEach(R=>{y[R.nombre.trim().toUpperCase()]=R.id}),a&&a.articles.forEach(R=>{y[R.nombre.trim().toUpperCase()]=1});const A=a?a.movements.filter(R=>y[R.articulo.trim().toUpperCase()]).length:0,L=a?a.movements.length-A:0,D=async()=>{if(!a||l.length>0)return;f(!0),await vr.from("articulos").delete().neq("id",0);const R=[],X=new Set;for(const N of a.articles){const P=up(N.nombre);X.has(P)||(R.push({...N,nombre:P}),X.add(P))}for(const N of R)await e({nombre:N.nombre,costo:N.costo});f(!1),x(!0),m({articulos:R.length,movimientos:0,advertencia:void 0}),h(!0)},T=async()=>{if(!a||l.length>0)return;f(!0),await vr.from("movimientos").delete().neq("id",0);const{data:R}=await vr.from("articulos").select("id, nombre"),X={};Array.isArray(R)&&R.forEach(W=>{const se=up(W.nombre);X[se]=W.id});let N=0,P=0,J=[];for(const W of a.movements){let se=W.id_articulo;if(W.articulo&&W.articulo.length>0){const fe=up(W.articulo);se=X[fe]}se?(await t({id_articulo:se,tipo:W.tipo,cantidad:W.cantidad,fecha:W.fecha,descripcion:W.descripcion,costo:W.costo}),P++):(N++,J.push({original:W.articulo,normalizado:W.id_articulo?`ID: ${W.id_articulo}`:up(W.articulo),tipo:W.tipo,fecha:W.fecha,descripcion:W.descripcion,cantidad:W.cantidad,costo:W.costo,motivo:"No se encontr artculo con ese nombre o ID"}))}f(!1),m({articulos:0,movimientos:P,advertencia:N>0?`${N} movimientos no se importaron por no tener artculo asociado.`:void 0,movimientosNoAsociadosDetalle:J}),h(!0)},F=a&&a.movimientosDescartados?a.movimientosDescartados:[];return _.jsxs("div",{className:"max-w-3xl mx-auto py-10",children:[_.jsxs("div",{className:"bg-white rounded-2xl shadow-lg p-8 border border-gray-100",children:[_.jsx("h2",{className:"text-2xl font-bold mb-4",children:"Importar artculos y movimientos desde Excel"}),_.jsx("input",{ref:n,type:"file",accept:".xlsx,.xls",onChange:w,className:"mb-4"}),l.length>0&&_.jsxs("div",{className:"mb-2 text-red-600",children:[_.jsx("b",{children:"Errores crticos detectados:"}),_.jsx("ul",{className:"list-disc ml-6",children:l.map((R,X)=>_.jsx("li",{children:R},X))})]}),s.length>0&&_.jsxs("div",{className:"mb-2 text-yellow-700",children:[_.jsx("b",{children:"Advertencias:"}),_.jsx("ul",{className:"list-disc ml-6",children:s.map((R,X)=>_.jsx("li",{children:R},X))})]}),a&&_.jsxs("div",{className:"mb-4",children:[_.jsx("h3",{className:"font-semibold mb-2",children:"Resumen de importacin"}),_.jsxs("div",{children:["Artculos detectados: ",a.articles.length]}),_.jsxs("div",{children:["Movimientos detectados: ",a.movements.length]}),_.jsxs("div",{className:"flex gap-4 mt-4",children:[_.jsx("button",{onClick:D,disabled:u||l.length>0,className:"px-4 py-2 bg-green-600 text-white rounded-lg",children:"Importar solo artculos"}),_.jsx("button",{onClick:T,disabled:u||l.length>0||!b,className:`px-4 py-2 rounded-lg ${b?"bg-blue-600 text-white":"bg-gray-300 text-gray-500 cursor-not-allowed"}`,children:"Importar solo movimientos"})]}),_.jsx("div",{className:"text-xs text-gray-500 mt-2",children:"Primero importa los artculos, luego los movimientos."}),_.jsxs("div",{className:"text-sm text-gray-700 mb-2",children:[_.jsxs("span",{className:"mr-4",children:["Movimientos que se asociarn correctamente: ",_.jsx("b",{children:A})]}),_.jsxs("span",{children:["Movimientos sin artculo asociado: ",_.jsx("b",{children:L})]})]}),_.jsxs("div",{className:"mt-4",children:[_.jsx("h4",{className:"font-semibold mb-1",children:"Artculos"}),_.jsxs("table",{className:"min-w-full text-sm border mb-2",children:[_.jsx("thead",{children:_.jsx("tr",{className:"bg-gray-100",children:_.jsx("th",{className:"px-2 py-1 border",children:"Nombre"})})}),_.jsx("tbody",{children:a.articles.map((R,X)=>_.jsx("tr",{children:_.jsx("td",{className:"px-2 py-1 border",children:R.nombre})},X))})]}),_.jsx("h4",{className:"font-semibold mb-1",children:"Primeros movimientos"}),_.jsxs("table",{className:"min-w-full text-sm border",children:[_.jsx("thead",{children:_.jsxs("tr",{className:"bg-gray-100",children:[_.jsx("th",{className:"px-2 py-1 border",children:"Artculo"}),_.jsx("th",{className:"px-2 py-1 border",children:"Tipo"}),_.jsx("th",{className:"px-2 py-1 border",children:"Fecha"}),_.jsx("th",{className:"px-2 py-1 border",children:"Descripcin"}),_.jsx("th",{className:"px-2 py-1 border",children:"Cantidad"}),_.jsx("th",{className:"px-2 py-1 border",children:"Costo"})]})}),_.jsx("tbody",{children:a.movements.slice(0,5).map((R,X)=>_.jsxs("tr",{children:[_.jsx("td",{className:"px-2 py-1 border",children:R.articulo}),_.jsx("td",{className:"px-2 py-1 border",children:R.tipo}),_.jsx("td",{className:"px-2 py-1 border",children:R.fecha}),_.jsx("td",{className:"px-2 py-1 border",children:R.descripcion}),_.jsx("td",{className:"px-2 py-1 border",children:R.cantidad}),_.jsx("td",{className:"px-2 py-1 border",children:R.costo})]},X))})]})]})]})]}),_.jsxs(nx,{isOpen:p,onRequestClose:()=>h(!1),className:"bg-white rounded-2xl shadow-lg p-8 border border-gray-100 max-w-lg mx-auto mt-20 outline-none",overlayClassName:"fixed inset-0 bg-black bg-opacity-40 flex items-center justify-center z-50",ariaHideApp:!1,children:[_.jsx("h2",{className:"text-2xl font-bold mb-4 text-center",children:"Importacin completada"}),g&&_.jsxs("div",{children:[_.jsxs("div",{className:"mb-2",children:["Artculos importados: ",_.jsx("b",{children:g.articulos})]}),_.jsxs("div",{className:"mb-2",children:["Movimientos importados: ",_.jsx("b",{children:g.movimientos})]}),g.advertencia&&_.jsxs("div",{className:"mt-4 text-yellow-700 font-semibold",children:[" ",g.advertencia]}),g.movimientosNoAsociadosDetalle&&g.movimientosNoAsociadosDetalle.length>0&&_.jsxs("div",{className:"mt-4",children:[_.jsx("h4",{className:"font-semibold mb-2",children:"Movimientos no asociados"}),_.jsxs("div",{className:"overflow-x-auto max-h-64",children:[_.jsxs("table",{className:"min-w-full text-xs border",children:[_.jsx("thead",{children:_.jsxs("tr",{className:"bg-gray-100",children:[_.jsx("th",{className:"px-2 py-1 border",children:"Artculo original"}),_.jsx("th",{className:"px-2 py-1 border",children:"Normalizado"}),_.jsx("th",{className:"px-2 py-1 border",children:"Tipo"}),_.jsx("th",{className:"px-2 py-1 border",children:"Fecha"}),_.jsx("th",{className:"px-2 py-1 border",children:"Descripcin"}),_.jsx("th",{className:"px-2 py-1 border",children:"Cantidad"}),_.jsx("th",{className:"px-2 py-1 border",children:"Costo"}),_.jsx("th",{className:"px-2 py-1 border",children:"Motivo"})]})}),_.jsx("tbody",{children:g.movimientosNoAsociadosDetalle.slice(0,20).map((R,X)=>_.jsxs("tr",{children:[_.jsx("td",{className:"px-2 py-1 border",children:R.original}),_.jsx("td",{className:"px-2 py-1 border",children:R.normalizado}),_.jsx("td",{className:"px-2 py-1 border",children:R.tipo}),_.jsx("td",{className:"px-2 py-1 border",children:R.fecha}),_.jsx("td",{className:"px-2 py-1 border",children:R.descripcion}),_.jsx("td",{className:"px-2 py-1 border",children:R.cantidad}),_.jsx("td",{className:"px-2 py-1 border",children:R.costo}),_.jsx("td",{className:"px-2 py-1 border text-red-600",children:R.motivo})]},X))})]}),_.jsx("div",{className:"text-xs text-gray-500 mt-1",children:"Mostrando mximo 20 movimientos no asociados."})]})]}),F.length>0&&_.jsxs("div",{className:"mt-4 text-yellow-700 font-semibold",children:[" ",F.length," movimientos fueron descartados por cantidad invlida ( 0).",_.jsxs("div",{className:"overflow-x-auto max-h-40 mt-2",children:[_.jsxs("table",{className:"min-w-full text-xs border",children:[_.jsx("thead",{children:_.jsxs("tr",{className:"bg-gray-100",children:[_.jsx("th",{className:"px-2 py-1 border",children:"Artculo"}),_.jsx("th",{className:"px-2 py-1 border",children:"Tipo"}),_.jsx("th",{className:"px-2 py-1 border",children:"Fecha"}),_.jsx("th",{className:"px-2 py-1 border",children:"Descripcin"}),_.jsx("th",{className:"px-2 py-1 border",children:"Cantidad"}),_.jsx("th",{className:"px-2 py-1 border",children:"Costo"})]})}),_.jsx("tbody",{children:F.slice(0,20).map((R,X)=>_.jsxs("tr",{children:[_.jsx("td",{className:"px-2 py-1 border",children:R.articulo}),_.jsx("td",{className:"px-2 py-1 border",children:R.tipo}),_.jsx("td",{className:"px-2 py-1 border",children:R.fecha}),_.jsx("td",{className:"px-2 py-1 border",children:R.descripcion}),_.jsx("td",{className:"px-2 py-1 border text-red-600",children:R.cantidad}),_.jsx("td",{className:"px-2 py-1 border",children:R.costo})]},X))})]}),_.jsx("div",{className:"text-xs text-gray-500 mt-1",children:"Mostrando mximo 20 movimientos descartados."})]})]}),_.jsx("button",{onClick:()=>h(!1),className:"mt-6 px-4 py-2 bg-blue-600 text-white rounded-lg w-full",children:"Cerrar"})]})]})]})};function tr(e){"@babel/helpers - typeof";return tr=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},tr(e)}var $n=Uint8Array,Ia=Uint16Array,D5=Int32Array,Lm=new $n([0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,0,0,0]),Fm=new $n([0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13,0,0]),mx=new $n([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),mC=function(e,t){for(var r=new Ia(31),n=0;n<31;++n)r[n]=t+=1<<e[n-1];for(var a=new D5(r[30]),n=1;n<30;++n)for(var i=r[n];i<r[n+1];++i)a[i]=i-r[n]<<5|n;return{b:r,r:a}},gC=mC(Lm,2),vC=gC.b,gx=gC.r;vC[28]=258,gx[258]=28;var xC=mC(Fm,0),ZK=xC.b,u_=xC.r,vx=new Ia(32768);for(var xr=0;xr<32768;++xr){var bo=(xr&43690)>>1|(xr&21845)<<1;bo=(bo&52428)>>2|(bo&13107)<<2,bo=(bo&61680)>>4|(bo&3855)<<4,vx[xr]=((bo&65280)>>8|(bo&255)<<8)>>1}var us=function(e,t,r){for(var n=e.length,a=0,i=new Ia(t);a<n;++a)e[a]&&++i[e[a]-1];var s=new Ia(t);for(a=1;a<t;++a)s[a]=s[a-1]+i[a-1]<<1;var o;if(r){o=new Ia(1<<t);var l=15-t;for(a=0;a<n;++a)if(e[a])for(var c=a<<4|e[a],u=t-e[a],f=s[e[a]-1]++<<u,p=f|(1<<u)-1;f<=p;++f)o[vx[f]>>l]=c}else for(o=new Ia(n),a=0;a<n;++a)e[a]&&(o[a]=vx[s[e[a]-1]++]>>15-e[a]);return o},al=new $n(288);for(var xr=0;xr<144;++xr)al[xr]=8;for(var xr=144;xr<256;++xr)al[xr]=9;for(var xr=256;xr<280;++xr)al[xr]=7;for(var xr=280;xr<288;++xr)al[xr]=8;var hh=new $n(32);for(var xr=0;xr<32;++xr)hh[xr]=5;var eX=us(al,9,0),tX=us(al,9,1),rX=us(hh,5,0),nX=us(hh,5,1),_2=function(e){for(var t=e[0],r=1;r<e.length;++r)e[r]>t&&(t=e[r]);return t},ki=function(e,t,r){var n=t/8|0;return(e[n]|e[n+1]<<8)>>(t&7)&r},S2=function(e,t){var r=t/8|0;return(e[r]|e[r+1]<<8|e[r+2]<<16)>>(t&7)},I5=function(e){return(e+7)/8|0},yC=function(e,t,r){return(r==null||r>e.length)&&(r=e.length),new $n(e.subarray(t,r))},aX=["unexpected EOF","invalid block type","invalid length/literal","invalid distance","stream finished","no stream handler",,"no callback","invalid UTF-8 data","extra field too long","date not in range 1980-2099","filename too long","stream finishing","invalid zip data"],Ni=function(e,t,r){var n=new Error(t||aX[e]);if(n.code=e,Error.captureStackTrace&&Error.captureStackTrace(n,Ni),!r)throw n;return n},iX=function(e,t,r,n){var a=e.length,i=0;if(!a||t.f&&!t.l)return r||new $n(0);var s=!r,o=s||t.i!=2,l=t.i;s&&(r=new $n(a*3));var c=function(Pe){var Z=r.length;if(Pe>Z){var Ve=new $n(Math.max(Z*2,Pe));Ve.set(r),r=Ve}},u=t.f||0,f=t.p||0,p=t.b||0,h=t.l,g=t.d,m=t.m,b=t.n,x=a*8;do{if(!h){u=ki(e,f,1);var w=ki(e,f+1,3);if(f+=3,w)if(w==1)h=tX,g=nX,m=9,b=5;else if(w==2){var D=ki(e,f,31)+257,T=ki(e,f+10,15)+4,F=D+ki(e,f+5,31)+1;f+=14;for(var R=new $n(F),X=new $n(19),N=0;N<T;++N)X[mx[N]]=ki(e,f+N*3,7);f+=T*3;for(var P=_2(X),J=(1<<P)-1,W=us(X,P,1),N=0;N<F;){var se=W[ki(e,f,J)];f+=se&15;var y=se>>4;if(y<16)R[N++]=y;else{var fe=0,U=0;for(y==16?(U=3+ki(e,f,3),f+=2,fe=R[N-1]):y==17?(U=3+ki(e,f,7),f+=3):y==18&&(U=11+ki(e,f,127),f+=7);U--;)R[N++]=fe}}var Q=R.subarray(0,D),q=R.subarray(D);m=_2(Q),b=_2(q),h=us(Q,m,1),g=us(q,b,1)}else Ni(1);else{var y=I5(f)+4,A=e[y-4]|e[y-3]<<8,L=y+A;if(L>a){l&&Ni(0);break}o&&c(p+A),r.set(e.subarray(y,L),p),t.b=p+=A,t.p=f=L*8,t.f=u;continue}if(f>x){l&&Ni(0);break}}o&&c(p+131072);for(var he=(1<<m)-1,xe=(1<<b)-1,E=f;;E=f){var fe=h[S2(e,f)&he],I=fe>>4;if(f+=fe&15,f>x){l&&Ni(0);break}if(fe||Ni(2),I<256)r[p++]=I;else if(I==256){E=f,h=null;break}else{var O=I-254;if(I>264){var N=I-257,j=Lm[N];O=ki(e,f,(1<<j)-1)+vC[N],f+=j}var K=g[S2(e,f)&xe],ne=K>>4;K||Ni(3),f+=K&15;var q=ZK[ne];if(ne>3){var j=Fm[ne];q+=S2(e,f)&(1<<j)-1,f+=j}if(f>x){l&&Ni(0);break}o&&c(p+131072);var pe=p+O;if(p<q){var de=i-q,we=Math.min(q,pe);for(de+p<0&&Ni(3);p<we;++p)r[p]=n[de+p]}for(;p<pe;++p)r[p]=r[p-q]}}t.l=h,t.p=E,t.b=p,t.f=u,h&&(u=1,t.m=m,t.d=g,t.n=b)}while(!u);return p!=r.length&&s?yC(r,0,p):r.subarray(0,p)},Ps=function(e,t,r){r<<=t&7;var n=t/8|0;e[n]|=r,e[n+1]|=r>>8},Hf=function(e,t,r){r<<=t&7;var n=t/8|0;e[n]|=r,e[n+1]|=r>>8,e[n+2]|=r>>16},k2=function(e,t){for(var r=[],n=0;n<e.length;++n)e[n]&&r.push({s:n,f:e[n]});var a=r.length,i=r.slice();if(!a)return{t:bC,l:0};if(a==1){var s=new $n(r[0].s+1);return s[r[0].s]=1,{t:s,l:1}}r.sort(function(L,D){return L.f-D.f}),r.push({s:-1,f:25001});var o=r[0],l=r[1],c=0,u=1,f=2;for(r[0]={s:-1,f:o.f+l.f,l:o,r:l};u!=a-1;)o=r[r[c].f<r[f].f?c++:f++],l=r[c!=u&&r[c].f<r[f].f?c++:f++],r[u++]={s:-1,f:o.f+l.f,l:o,r:l};for(var p=i[0].s,n=1;n<a;++n)i[n].s>p&&(p=i[n].s);var h=new Ia(p+1),g=xx(r[u-1],h,0);if(g>t){var n=0,m=0,b=g-t,x=1<<b;for(i.sort(function(D,T){return h[T.s]-h[D.s]||D.f-T.f});n<a;++n){var w=i[n].s;if(h[w]>t)m+=x-(1<<g-h[w]),h[w]=t;else break}for(m>>=b;m>0;){var y=i[n].s;h[y]<t?m-=1<<t-h[y]++-1:++n}for(;n>=0&&m;--n){var A=i[n].s;h[A]==t&&(--h[A],++m)}g=t}return{t:new $n(h),l:g}},xx=function(e,t,r){return e.s==-1?Math.max(xx(e.l,t,r+1),xx(e.r,t,r+1)):t[e.s]=r},f_=function(e){for(var t=e.length;t&&!e[--t];);for(var r=new Ia(++t),n=0,a=e[0],i=1,s=function(l){r[n++]=l},o=1;o<=t;++o)if(e[o]==a&&o!=t)++i;else{if(!a&&i>2){for(;i>138;i-=138)s(32754);i>2&&(s(i>10?i-11<<5|28690:i-3<<5|12305),i=0)}else if(i>3){for(s(a),--i;i>6;i-=6)s(8304);i>2&&(s(i-3<<5|8208),i=0)}for(;i--;)s(a);i=1,a=e[o]}return{c:r.subarray(0,n),n:t}},Wf=function(e,t){for(var r=0,n=0;n<t.length;++n)r+=e[n]*t[n];return r},wC=function(e,t,r){var n=r.length,a=I5(t+2);e[a]=n&255,e[a+1]=n>>8,e[a+2]=e[a]^255,e[a+3]=e[a+1]^255;for(var i=0;i<n;++i)e[a+i+4]=r[i];return(a+4+n)*8},h_=function(e,t,r,n,a,i,s,o,l,c,u){Ps(t,u++,r),++a[256];for(var f=k2(a,15),p=f.t,h=f.l,g=k2(i,15),m=g.t,b=g.l,x=f_(p),w=x.c,y=x.n,A=f_(m),L=A.c,D=A.n,T=new Ia(19),F=0;F<w.length;++F)++T[w[F]&31];for(var F=0;F<L.length;++F)++T[L[F]&31];for(var R=k2(T,7),X=R.t,N=R.l,P=19;P>4&&!X[mx[P-1]];--P);var J=c+5<<3,W=Wf(a,al)+Wf(i,hh)+s,se=Wf(a,p)+Wf(i,m)+s+14+3*P+Wf(T,X)+2*T[16]+3*T[17]+7*T[18];if(l>=0&&J<=W&&J<=se)return wC(t,u,e.subarray(l,l+c));var fe,U,Q,q;if(Ps(t,u,1+(se<W)),u+=2,se<W){fe=us(p,h,0),U=p,Q=us(m,b,0),q=m;var he=us(X,N,0);Ps(t,u,y-257),Ps(t,u+5,D-1),Ps(t,u+10,P-4),u+=14;for(var F=0;F<P;++F)Ps(t,u+3*F,X[mx[F]]);u+=3*P;for(var xe=[w,L],E=0;E<2;++E)for(var I=xe[E],F=0;F<I.length;++F){var O=I[F]&31;Ps(t,u,he[O]),u+=X[O],O>15&&(Ps(t,u,I[F]>>5&127),u+=I[F]>>12)}}else fe=eX,U=al,Q=rX,q=hh;for(var F=0;F<o;++F){var j=n[F];if(j>255){var O=j>>18&31;Hf(t,u,fe[O+257]),u+=U[O+257],O>7&&(Ps(t,u,j>>23&31),u+=Lm[O]);var K=j&31;Hf(t,u,Q[K]),u+=q[K],K>3&&(Hf(t,u,j>>5&8191),u+=Fm[K])}else Hf(t,u,fe[j]),u+=U[j]}return Hf(t,u,fe[256]),u+U[256]},sX=new D5([65540,131080,131088,131104,262176,1048704,1048832,2114560,2117632]),bC=new $n(0),oX=function(e,t,r,n,a,i){var s=i.z||e.length,o=new $n(n+s+5*(1+Math.ceil(s/7e3))+a),l=o.subarray(n,o.length-a),c=i.l,u=(i.r||0)&7;if(t){u&&(l[0]=i.r>>3);for(var f=sX[t-1],p=f>>13,h=f&8191,g=(1<<r)-1,m=i.p||new Ia(32768),b=i.h||new Ia(g+1),x=Math.ceil(r/3),w=2*x,y=function(Ke){return(e[Ke]^e[Ke+1]<<x^e[Ke+2]<<w)&g},A=new D5(25e3),L=new Ia(288),D=new Ia(32),T=0,F=0,R=i.i||0,X=0,N=i.w||0,P=0;R+2<s;++R){var J=y(R),W=R&32767,se=b[J];if(m[W]=se,b[J]=W,N<=R){var fe=s-R;if((T>7e3||X>24576)&&(fe>423||!c)){u=h_(e,l,0,A,L,D,F,X,P,R-P,u),X=T=F=0,P=R;for(var U=0;U<286;++U)L[U]=0;for(var U=0;U<30;++U)D[U]=0}var Q=2,q=0,he=h,xe=W-se&32767;if(fe>2&&J==y(R-xe))for(var E=Math.min(p,fe)-1,I=Math.min(32767,R),O=Math.min(258,fe);xe<=I&&--he&&W!=se;){if(e[R+Q]==e[R+Q-xe]){for(var j=0;j<O&&e[R+j]==e[R+j-xe];++j);if(j>Q){if(Q=j,q=xe,j>E)break;for(var K=Math.min(xe,j-2),ne=0,U=0;U<K;++U){var pe=R-xe+U&32767,de=m[pe],we=pe-de&32767;we>ne&&(ne=we,se=pe)}}}W=se,se=m[W],xe+=W-se&32767}if(q){A[X++]=268435456|gx[Q]<<18|u_[q];var Pe=gx[Q]&31,Z=u_[q]&31;F+=Lm[Pe]+Fm[Z],++L[257+Pe],++D[Z],N=R+Q,++T}else A[X++]=e[R],++L[e[R]]}}for(R=Math.max(R,N);R<s;++R)A[X++]=e[R],++L[e[R]];u=h_(e,l,c,A,L,D,F,X,P,R-P,u),c||(i.r=u&7|l[u/8|0]<<3,u-=7,i.h=b,i.p=m,i.i=R,i.w=N)}else{for(var R=i.w||0;R<s+c;R+=65535){var Ve=R+65535;Ve>=s&&(l[u/8|0]=c,Ve=s),u=wC(l,u+1,e.subarray(R,Ve))}i.i=s}return yC(o,0,n+I5(u)+a)},_C=function(){var e=1,t=0;return{p:function(r){for(var n=e,a=t,i=r.length|0,s=0;s!=i;){for(var o=Math.min(s+2655,i);s<o;++s)a+=n+=r[s];n=(n&65535)+15*(n>>16),a=(a&65535)+15*(a>>16)}e=n,t=a},d:function(){return e%=65521,t%=65521,(e&255)<<24|(e&65280)<<8|(t&255)<<8|t>>8}}},lX=function(e,t,r,n,a){if(!a&&(a={l:1},t.dictionary)){var i=t.dictionary.subarray(-32768),s=new $n(i.length+e.length);s.set(i),s.set(e,i.length),e=s,a.w=i.length}return oX(e,t.level==null?6:t.level,t.mem==null?a.l?Math.ceil(Math.max(8,Math.min(13,Math.log(e.length)))*1.5):20:12+t.mem,r,n,a)},SC=function(e,t,r){for(;r;++t)e[t]=r,r>>>=8},cX=function(e,t){var r=t.level,n=r==0?0:r<6?1:r==9?3:2;if(e[0]=120,e[1]=n<<6|(t.dictionary&&32),e[1]|=31-(e[0]<<8|e[1])%31,t.dictionary){var a=_C();a.p(t.dictionary),SC(e,2,a.d())}},uX=function(e,t){return((e[0]&15)!=8||e[0]>>4>7||(e[0]<<8|e[1])%31)&&Ni(6,"invalid zlib data"),(e[1]>>5&1)==+!t&&Ni(6,"invalid zlib data: "+(e[1]&32?"need":"unexpected")+" dictionary"),(e[1]>>3&4)+2};function yx(e,t){t||(t={});var r=_C();r.p(e);var n=lX(e,t,t.dictionary?6:2,4);return cX(n,t),SC(n,n.length-4,r.d()),n}function fX(e,t){return iX(e.subarray(uX(e,t),-4),{i:2},t,t)}var hX=typeof TextDecoder<"u"&&new TextDecoder,dX=0;try{hX.decode(bC,{stream:!0}),dX=1}catch{}var xt=function(){return typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:this}();function E2(){xt.console&&typeof xt.console.log=="function"&&xt.console.log.apply(xt.console,arguments)}var or={log:E2,warn:function(e){xt.console&&(typeof xt.console.warn=="function"?xt.console.warn.apply(xt.console,arguments):E2.call(null,arguments))},error:function(e){xt.console&&(typeof xt.console.error=="function"?xt.console.error.apply(xt.console,arguments):E2(e))}};function A2(e,t,r){var n=new XMLHttpRequest;n.open("GET",e),n.responseType="blob",n.onload=function(){Fl(n.response,t,r)},n.onerror=function(){or.error("could not download file")},n.send()}function d_(e){var t=new XMLHttpRequest;t.open("HEAD",e,!1);try{t.send()}catch{}return t.status>=200&&t.status<=299}function fp(e){try{e.dispatchEvent(new MouseEvent("click"))}catch{var t=document.createEvent("MouseEvents");t.initMouseEvent("click",!0,!0,window,0,0,0,80,20,!1,!1,!1,!1,0,null),e.dispatchEvent(t)}}var L0,wx,Fl=xt.saveAs||((typeof window>"u"?"undefined":tr(window))!=="object"||window!==xt?function(){}:typeof HTMLAnchorElement<"u"&&"download"in HTMLAnchorElement.prototype?function(e,t,r){var n=xt.URL||xt.webkitURL,a=document.createElement("a");t=t||e.name||"download",a.download=t,a.rel="noopener",typeof e=="string"?(a.href=e,a.origin!==location.origin?d_(a.href)?A2(e,t,r):fp(a,a.target="_blank"):fp(a)):(a.href=n.createObjectURL(e),setTimeout(function(){n.revokeObjectURL(a.href)},4e4),setTimeout(function(){fp(a)},0))}:"msSaveOrOpenBlob"in navigator?function(e,t,r){if(t=t||e.name||"download",typeof e=="string")if(d_(e))A2(e,t,r);else{var n=document.createElement("a");n.href=e,n.target="_blank",setTimeout(function(){fp(n)})}else navigator.msSaveOrOpenBlob(function(a,i){return i===void 0?i={autoBom:!1}:tr(i)!=="object"&&(or.warn("Deprecated: Expected third argument to be a object"),i={autoBom:!i}),i.autoBom&&/^\s*(?:text\/\S*|application\/xml|\S*\/\S*\+xml)\s*;.*charset\s*=\s*utf-8/i.test(a.type)?new Blob(["\uFEFF",a],{type:a.type}):a}(e,r),t)}:function(e,t,r,n){if((n=n||open("","_blank"))&&(n.document.title=n.document.body.innerText="downloading..."),typeof e=="string")return A2(e,t,r);var a=e.type==="application/octet-stream",i=/constructor/i.test(xt.HTMLElement)||xt.safari,s=/CriOS\/[\d]+/.test(navigator.userAgent);if((s||a&&i)&&(typeof FileReader>"u"?"undefined":tr(FileReader))==="object"){var o=new FileReader;o.onloadend=function(){var u=o.result;u=s?u:u.replace(/^data:[^;]*;/,"data:attachment/file;"),n?n.location.href=u:location=u,n=null},o.readAsDataURL(e)}else{var l=xt.URL||xt.webkitURL,c=l.createObjectURL(e);n?n.location=c:location.href=c,n=null,setTimeout(function(){l.revokeObjectURL(c)},4e4)}});/**
 * A class to parse color values
 * @author Stoyan Stefanov <sstoo@gmail.com>
 * {@link   http://www.phpied.com/rgb-color-parser-in-javascript/}
 * @license Use it if you like it
 */function kC(e){var t;e=e||"",this.ok=!1,e.charAt(0)=="#"&&(e=e.substr(1,6)),e={aliceblue:"f0f8ff",antiquewhite:"faebd7",aqua:"00ffff",aquamarine:"7fffd4",azure:"f0ffff",beige:"f5f5dc",bisque:"ffe4c4",black:"000000",blanchedalmond:"ffebcd",blue:"0000ff",blueviolet:"8a2be2",brown:"a52a2a",burlywood:"deb887",cadetblue:"5f9ea0",chartreuse:"7fff00",chocolate:"d2691e",coral:"ff7f50",cornflowerblue:"6495ed",cornsilk:"fff8dc",crimson:"dc143c",cyan:"00ffff",darkblue:"00008b",darkcyan:"008b8b",darkgoldenrod:"b8860b",darkgray:"a9a9a9",darkgreen:"006400",darkkhaki:"bdb76b",darkmagenta:"8b008b",darkolivegreen:"556b2f",darkorange:"ff8c00",darkorchid:"9932cc",darkred:"8b0000",darksalmon:"e9967a",darkseagreen:"8fbc8f",darkslateblue:"483d8b",darkslategray:"2f4f4f",darkturquoise:"00ced1",darkviolet:"9400d3",deeppink:"ff1493",deepskyblue:"00bfff",dimgray:"696969",dodgerblue:"1e90ff",feldspar:"d19275",firebrick:"b22222",floralwhite:"fffaf0",forestgreen:"228b22",fuchsia:"ff00ff",gainsboro:"dcdcdc",ghostwhite:"f8f8ff",gold:"ffd700",goldenrod:"daa520",gray:"808080",green:"008000",greenyellow:"adff2f",honeydew:"f0fff0",hotpink:"ff69b4",indianred:"cd5c5c",indigo:"4b0082",ivory:"fffff0",khaki:"f0e68c",lavender:"e6e6fa",lavenderblush:"fff0f5",lawngreen:"7cfc00",lemonchiffon:"fffacd",lightblue:"add8e6",lightcoral:"f08080",lightcyan:"e0ffff",lightgoldenrodyellow:"fafad2",lightgrey:"d3d3d3",lightgreen:"90ee90",lightpink:"ffb6c1",lightsalmon:"ffa07a",lightseagreen:"20b2aa",lightskyblue:"87cefa",lightslateblue:"8470ff",lightslategray:"778899",lightsteelblue:"b0c4de",lightyellow:"ffffe0",lime:"00ff00",limegreen:"32cd32",linen:"faf0e6",magenta:"ff00ff",maroon:"800000",mediumaquamarine:"66cdaa",mediumblue:"0000cd",mediumorchid:"ba55d3",mediumpurple:"9370d8",mediumseagreen:"3cb371",mediumslateblue:"7b68ee",mediumspringgreen:"00fa9a",mediumturquoise:"48d1cc",mediumvioletred:"c71585",midnightblue:"191970",mintcream:"f5fffa",mistyrose:"ffe4e1",moccasin:"ffe4b5",navajowhite:"ffdead",navy:"000080",oldlace:"fdf5e6",olive:"808000",olivedrab:"6b8e23",orange:"ffa500",orangered:"ff4500",orchid:"da70d6",palegoldenrod:"eee8aa",palegreen:"98fb98",paleturquoise:"afeeee",palevioletred:"d87093",papayawhip:"ffefd5",peachpuff:"ffdab9",peru:"cd853f",pink:"ffc0cb",plum:"dda0dd",powderblue:"b0e0e6",purple:"800080",red:"ff0000",rosybrown:"bc8f8f",royalblue:"4169e1",saddlebrown:"8b4513",salmon:"fa8072",sandybrown:"f4a460",seagreen:"2e8b57",seashell:"fff5ee",sienna:"a0522d",silver:"c0c0c0",skyblue:"87ceeb",slateblue:"6a5acd",slategray:"708090",snow:"fffafa",springgreen:"00ff7f",steelblue:"4682b4",tan:"d2b48c",teal:"008080",thistle:"d8bfd8",tomato:"ff6347",turquoise:"40e0d0",violet:"ee82ee",violetred:"d02090",wheat:"f5deb3",white:"ffffff",whitesmoke:"f5f5f5",yellow:"ffff00",yellowgreen:"9acd32"}[e=(e=e.replace(/ /g,"")).toLowerCase()]||e;for(var r=[{re:/^rgb\((\d{1,3}),\s*(\d{1,3}),\s*(\d{1,3})\)$/,example:["rgb(123, 234, 45)","rgb(255,234,245)"],process:function(o){return[parseInt(o[1]),parseInt(o[2]),parseInt(o[3])]}},{re:/^(\w{2})(\w{2})(\w{2})$/,example:["#00ff00","336699"],process:function(o){return[parseInt(o[1],16),parseInt(o[2],16),parseInt(o[3],16)]}},{re:/^(\w{1})(\w{1})(\w{1})$/,example:["#fb0","f0f"],process:function(o){return[parseInt(o[1]+o[1],16),parseInt(o[2]+o[2],16),parseInt(o[3]+o[3],16)]}}],n=0;n<r.length;n++){var a=r[n].re,i=r[n].process,s=a.exec(e);s&&(t=i(s),this.r=t[0],this.g=t[1],this.b=t[2],this.ok=!0)}this.r=this.r<0||isNaN(this.r)?0:this.r>255?255:this.r,this.g=this.g<0||isNaN(this.g)?0:this.g>255?255:this.g,this.b=this.b<0||isNaN(this.b)?0:this.b>255?255:this.b,this.toRGB=function(){return"rgb("+this.r+", "+this.g+", "+this.b+")"},this.toHex=function(){var o=this.r.toString(16),l=this.g.toString(16),c=this.b.toString(16);return o.length==1&&(o="0"+o),l.length==1&&(l="0"+l),c.length==1&&(c="0"+c),"#"+o+l+c}}/**
 * @license
 * Joseph Myers does not specify a particular license for his work.
 *
 * Author: Joseph Myers
 * Accessed from: http://www.myersdaily.org/joseph/javascript/md5.js
 *
 * Modified by: Owen Leong
 */function T2(e,t){var r=e[0],n=e[1],a=e[2],i=e[3];r=Fn(r,n,a,i,t[0],7,-680876936),i=Fn(i,r,n,a,t[1],12,-389564586),a=Fn(a,i,r,n,t[2],17,606105819),n=Fn(n,a,i,r,t[3],22,-1044525330),r=Fn(r,n,a,i,t[4],7,-176418897),i=Fn(i,r,n,a,t[5],12,1200080426),a=Fn(a,i,r,n,t[6],17,-1473231341),n=Fn(n,a,i,r,t[7],22,-45705983),r=Fn(r,n,a,i,t[8],7,1770035416),i=Fn(i,r,n,a,t[9],12,-1958414417),a=Fn(a,i,r,n,t[10],17,-42063),n=Fn(n,a,i,r,t[11],22,-1990404162),r=Fn(r,n,a,i,t[12],7,1804603682),i=Fn(i,r,n,a,t[13],12,-40341101),a=Fn(a,i,r,n,t[14],17,-1502002290),r=On(r,n=Fn(n,a,i,r,t[15],22,1236535329),a,i,t[1],5,-165796510),i=On(i,r,n,a,t[6],9,-1069501632),a=On(a,i,r,n,t[11],14,643717713),n=On(n,a,i,r,t[0],20,-373897302),r=On(r,n,a,i,t[5],5,-701558691),i=On(i,r,n,a,t[10],9,38016083),a=On(a,i,r,n,t[15],14,-660478335),n=On(n,a,i,r,t[4],20,-405537848),r=On(r,n,a,i,t[9],5,568446438),i=On(i,r,n,a,t[14],9,-1019803690),a=On(a,i,r,n,t[3],14,-187363961),n=On(n,a,i,r,t[8],20,1163531501),r=On(r,n,a,i,t[13],5,-1444681467),i=On(i,r,n,a,t[2],9,-51403784),a=On(a,i,r,n,t[7],14,1735328473),r=Dn(r,n=On(n,a,i,r,t[12],20,-1926607734),a,i,t[5],4,-378558),i=Dn(i,r,n,a,t[8],11,-2022574463),a=Dn(a,i,r,n,t[11],16,1839030562),n=Dn(n,a,i,r,t[14],23,-35309556),r=Dn(r,n,a,i,t[1],4,-1530992060),i=Dn(i,r,n,a,t[4],11,1272893353),a=Dn(a,i,r,n,t[7],16,-155497632),n=Dn(n,a,i,r,t[10],23,-1094730640),r=Dn(r,n,a,i,t[13],4,681279174),i=Dn(i,r,n,a,t[0],11,-358537222),a=Dn(a,i,r,n,t[3],16,-722521979),n=Dn(n,a,i,r,t[6],23,76029189),r=Dn(r,n,a,i,t[9],4,-640364487),i=Dn(i,r,n,a,t[12],11,-421815835),a=Dn(a,i,r,n,t[15],16,530742520),r=In(r,n=Dn(n,a,i,r,t[2],23,-995338651),a,i,t[0],6,-198630844),i=In(i,r,n,a,t[7],10,1126891415),a=In(a,i,r,n,t[14],15,-1416354905),n=In(n,a,i,r,t[5],21,-57434055),r=In(r,n,a,i,t[12],6,1700485571),i=In(i,r,n,a,t[3],10,-1894986606),a=In(a,i,r,n,t[10],15,-1051523),n=In(n,a,i,r,t[1],21,-2054922799),r=In(r,n,a,i,t[8],6,1873313359),i=In(i,r,n,a,t[15],10,-30611744),a=In(a,i,r,n,t[6],15,-1560198380),n=In(n,a,i,r,t[13],21,1309151649),r=In(r,n,a,i,t[4],6,-145523070),i=In(i,r,n,a,t[11],10,-1120210379),a=In(a,i,r,n,t[2],15,718787259),n=In(n,a,i,r,t[9],21,-343485551),e[0]=Uo(r,e[0]),e[1]=Uo(n,e[1]),e[2]=Uo(a,e[2]),e[3]=Uo(i,e[3])}function Om(e,t,r,n,a,i){return t=Uo(Uo(t,e),Uo(n,i)),Uo(t<<a|t>>>32-a,r)}function Fn(e,t,r,n,a,i,s){return Om(t&r|~t&n,e,t,a,i,s)}function On(e,t,r,n,a,i,s){return Om(t&n|r&~n,e,t,a,i,s)}function Dn(e,t,r,n,a,i,s){return Om(t^r^n,e,t,a,i,s)}function In(e,t,r,n,a,i,s){return Om(r^(t|~n),e,t,a,i,s)}function EC(e){var t,r=e.length,n=[1732584193,-271733879,-1732584194,271733878];for(t=64;t<=e.length;t+=64)T2(n,pX(e.substring(t-64,t)));e=e.substring(t-64);var a=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0];for(t=0;t<e.length;t++)a[t>>2]|=e.charCodeAt(t)<<(t%4<<3);if(a[t>>2]|=128<<(t%4<<3),t>55)for(T2(n,a),t=0;t<16;t++)a[t]=0;return a[14]=8*r,T2(n,a),n}function pX(e){var t,r=[];for(t=0;t<64;t+=4)r[t>>2]=e.charCodeAt(t)+(e.charCodeAt(t+1)<<8)+(e.charCodeAt(t+2)<<16)+(e.charCodeAt(t+3)<<24);return r}L0=xt.atob.bind(xt),wx=xt.btoa.bind(xt);var p_="0123456789abcdef".split("");function mX(e){for(var t="",r=0;r<4;r++)t+=p_[e>>8*r+4&15]+p_[e>>8*r&15];return t}function gX(e){return String.fromCharCode((255&e)>>0,(65280&e)>>8,(16711680&e)>>16,(4278190080&e)>>24)}function bx(e){return EC(e).map(gX).join("")}var vX=function(e){for(var t=0;t<e.length;t++)e[t]=mX(e[t]);return e.join("")}(EC("hello"))!="5d41402abc4b2a76b9719d911017c592";function Uo(e,t){if(vX){var r=(65535&e)+(65535&t);return(e>>16)+(t>>16)+(r>>16)<<16|65535&r}return e+t&4294967295}/**
 * @license
 * FPDF is released under a permissive license: there is no usage restriction.
 * You may embed it freely in your application (commercial or not), with or
 * without modifications.
 *
 * Reference: http://www.fpdf.org/en/script/script37.php
 */function _x(e,t){var r,n,a,i;if(e!==r){for(var s=(a=e,i=1+(256/e.length>>0),new Array(i+1).join(a)),o=[],l=0;l<256;l++)o[l]=l;var c=0;for(l=0;l<256;l++){var u=o[l];c=(c+u+s.charCodeAt(l))%256,o[l]=o[c],o[c]=u}r=e,n=o}else o=n;var f=t.length,p=0,h=0,g="";for(l=0;l<f;l++)h=(h+(u=o[p=(p+1)%256]))%256,o[p]=o[h],o[h]=u,s=o[(o[p]+o[h])%256],g+=String.fromCharCode(t.charCodeAt(l)^s);return g}/**
 * @license
 * Licensed under the MIT License.
 * http://opensource.org/licenses/mit-license
 * Author: Owen Leong (@owenl131)
 * Date: 15 Oct 2020
 * References:
 * https://www.cs.cmu.edu/~dst/Adobe/Gallery/anon21jul01-pdf-encryption.txt
 * https://github.com/foliojs/pdfkit/blob/master/lib/security.js
 * http://www.fpdf.org/en/script/script37.php
 */var m_={print:4,modify:8,copy:16,"annot-forms":32};function Yc(e,t,r,n){this.v=1,this.r=2;var a=192;e.forEach(function(o){if(m_.perm!==void 0)throw new Error("Invalid permission: "+o);a+=m_[o]}),this.padding="(N^NuAd\0NV\b..\0h>/\fdSiz";var i=(t+this.padding).substr(0,32),s=(r+this.padding).substr(0,32);this.O=this.processOwnerPassword(i,s),this.P=-(1+(255^a)),this.encryptionKey=bx(i+this.O+this.lsbFirstWord(this.P)+this.hexToBytes(n)).substr(0,5),this.U=_x(this.encryptionKey,this.padding)}function Jc(e){if(/[^\u0000-\u00ff]/.test(e))throw new Error("Invalid PDF Name Object: "+e+", Only accept ASCII characters.");for(var t="",r=e.length,n=0;n<r;n++){var a=e.charCodeAt(n);a<33||a===35||a===37||a===40||a===41||a===47||a===60||a===62||a===91||a===93||a===123||a===125||a>126?t+="#"+("0"+a.toString(16)).slice(-2):t+=e[n]}return t}function g_(e){if(tr(e)!=="object")throw new Error("Invalid Context passed to initialize PubSub (jsPDF-module)");var t={};this.subscribe=function(r,n,a){if(a=a||!1,typeof r!="string"||typeof n!="function"||typeof a!="boolean")throw new Error("Invalid arguments passed to PubSub.subscribe (jsPDF-module)");t.hasOwnProperty(r)||(t[r]={});var i=Math.random().toString(35);return t[r][i]=[n,!!a],i},this.unsubscribe=function(r){for(var n in t)if(t[n][r])return delete t[n][r],Object.keys(t[n]).length===0&&delete t[n],!0;return!1},this.publish=function(r){if(t.hasOwnProperty(r)){var n=Array.prototype.slice.call(arguments,1),a=[];for(var i in t[r]){var s=t[r][i];try{s[0].apply(e,n)}catch(o){xt.console&&or.error("jsPDF PubSub Error",o.message,o)}s[1]&&a.push(i)}a.length&&a.forEach(this.unsubscribe)}},this.getTopics=function(){return t}}function O1(e){if(!(this instanceof O1))return new O1(e);var t="opacity,stroke-opacity".split(",");for(var r in e)e.hasOwnProperty(r)&&t.indexOf(r)>=0&&(this[r]=e[r]);this.id="",this.objectNumber=-1}function AC(e,t){this.gState=e,this.matrix=t,this.id="",this.objectNumber=-1}function Il(e,t,r,n,a){if(!(this instanceof Il))return new Il(e,t,r,n,a);this.type=e==="axial"?2:3,this.coords=t,this.colors=r,AC.call(this,n,a)}function gu(e,t,r,n,a){if(!(this instanceof gu))return new gu(e,t,r,n,a);this.boundingBox=e,this.xStep=t,this.yStep=r,this.stream="",this.cloneIndex=0,AC.call(this,n,a)}function vt(e){var t,r=typeof arguments[0]=="string"?arguments[0]:"p",n=arguments[1],a=arguments[2],i=arguments[3],s=[],o=1,l=16,c="S",u=null;tr(e=e||{})==="object"&&(r=e.orientation,n=e.unit||n,a=e.format||a,i=e.compress||e.compressPdf||i,(u=e.encryption||null)!==null&&(u.userPassword=u.userPassword||"",u.ownerPassword=u.ownerPassword||"",u.userPermissions=u.userPermissions||[]),o=typeof e.userUnit=="number"?Math.abs(e.userUnit):1,e.precision!==void 0&&(t=e.precision),e.floatPrecision!==void 0&&(l=e.floatPrecision),c=e.defaultPathOperation||"S"),s=e.filters||(i===!0?["FlateEncode"]:s),n=n||"mm",r=(""+(r||"P")).toLowerCase();var f=e.putOnlyUsedFonts||!1,p={},h={internal:{},__private__:{}};h.__private__.PubSub=g_;var g="1.3",m=h.__private__.getPdfVersion=function(){return g};h.__private__.setPdfVersion=function(S){g=S};var b={a0:[2383.94,3370.39],a1:[1683.78,2383.94],a2:[1190.55,1683.78],a3:[841.89,1190.55],a4:[595.28,841.89],a5:[419.53,595.28],a6:[297.64,419.53],a7:[209.76,297.64],a8:[147.4,209.76],a9:[104.88,147.4],a10:[73.7,104.88],b0:[2834.65,4008.19],b1:[2004.09,2834.65],b2:[1417.32,2004.09],b3:[1000.63,1417.32],b4:[708.66,1000.63],b5:[498.9,708.66],b6:[354.33,498.9],b7:[249.45,354.33],b8:[175.75,249.45],b9:[124.72,175.75],b10:[87.87,124.72],c0:[2599.37,3676.54],c1:[1836.85,2599.37],c2:[1298.27,1836.85],c3:[918.43,1298.27],c4:[649.13,918.43],c5:[459.21,649.13],c6:[323.15,459.21],c7:[229.61,323.15],c8:[161.57,229.61],c9:[113.39,161.57],c10:[79.37,113.39],dl:[311.81,623.62],letter:[612,792],"government-letter":[576,756],legal:[612,1008],"junior-legal":[576,360],ledger:[1224,792],tabloid:[792,1224],"credit-card":[153,243]};h.__private__.getPageFormats=function(){return b};var x=h.__private__.getPageFormat=function(S){return b[S]};a=a||"a4";var w={COMPAT:"compat",ADVANCED:"advanced"},y=w.COMPAT;function A(){this.saveGraphicsState(),ae(new dt(ze,0,0,-ze,0,so()*ze).toString()+" cm"),this.setFontSize(this.getFontSize()/ze),c="n",y=w.ADVANCED}function L(){this.restoreGraphicsState(),c="S",y=w.COMPAT}var D=h.__private__.combineFontStyleAndFontWeight=function(S,B){if(S=="bold"&&B=="normal"||S=="bold"&&B==400||S=="normal"&&B=="italic"||S=="bold"&&B=="italic")throw new Error("Invalid Combination of fontweight and fontstyle");return B&&(S=B==400||B==="normal"?S==="italic"?"italic":"normal":B!=700&&B!=="bold"||S!=="normal"?(B==700?"bold":B)+""+S:"bold"),S};h.advancedAPI=function(S){var B=y===w.COMPAT;return B&&A.call(this),typeof S!="function"||(S(this),B&&L.call(this)),this},h.compatAPI=function(S){var B=y===w.ADVANCED;return B&&L.call(this),typeof S!="function"||(S(this),B&&A.call(this)),this},h.isAdvancedAPI=function(){return y===w.ADVANCED};var T,F=function(S){if(y!==w.ADVANCED)throw new Error(S+" is only available in 'advanced' API mode. You need to call advancedAPI() first.")},R=h.roundToPrecision=h.__private__.roundToPrecision=function(S,B){var ue=t||B;if(isNaN(S)||isNaN(ue))throw new Error("Invalid argument passed to jsPDF.roundToPrecision");return S.toFixed(ue).replace(/0+$/,"")};T=h.hpf=h.__private__.hpf=typeof l=="number"?function(S){if(isNaN(S))throw new Error("Invalid argument passed to jsPDF.hpf");return R(S,l)}:l==="smart"?function(S){if(isNaN(S))throw new Error("Invalid argument passed to jsPDF.hpf");return R(S,S>-1&&S<1?16:5)}:function(S){if(isNaN(S))throw new Error("Invalid argument passed to jsPDF.hpf");return R(S,16)};var X=h.f2=h.__private__.f2=function(S){if(isNaN(S))throw new Error("Invalid argument passed to jsPDF.f2");return R(S,2)},N=h.__private__.f3=function(S){if(isNaN(S))throw new Error("Invalid argument passed to jsPDF.f3");return R(S,3)},P=h.scale=h.__private__.scale=function(S){if(isNaN(S))throw new Error("Invalid argument passed to jsPDF.scale");return y===w.COMPAT?S*ze:y===w.ADVANCED?S:void 0},J=function(S){return y===w.COMPAT?so()-S:y===w.ADVANCED?S:void 0},W=function(S){return P(J(S))};h.__private__.setPrecision=h.setPrecision=function(S){typeof parseInt(S,10)=="number"&&(t=parseInt(S,10))};var se,fe="00000000000000000000000000000000",U=h.__private__.getFileId=function(){return fe},Q=h.__private__.setFileId=function(S){return fe=S!==void 0&&/^[a-fA-F0-9]{32}$/.test(S)?S.toUpperCase():fe.split("").map(function(){return"ABCDEF0123456789".charAt(Math.floor(16*Math.random()))}).join(""),u!==null&&(Tn=new Yc(u.userPermissions,u.userPassword,u.ownerPassword,fe)),fe};h.setFileId=function(S){return Q(S),this},h.getFileId=function(){return U()};var q=h.__private__.convertDateToPDFDate=function(S){var B=S.getTimezoneOffset(),ue=B<0?"+":"-",me=Math.floor(Math.abs(B/60)),_e=Math.abs(B%60),Oe=[ue,O(me),"'",O(_e),"'"].join("");return["D:",S.getFullYear(),O(S.getMonth()+1),O(S.getDate()),O(S.getHours()),O(S.getMinutes()),O(S.getSeconds()),Oe].join("")},he=h.__private__.convertPDFDateToDate=function(S){var B=parseInt(S.substr(2,4),10),ue=parseInt(S.substr(6,2),10)-1,me=parseInt(S.substr(8,2),10),_e=parseInt(S.substr(10,2),10),Oe=parseInt(S.substr(12,2),10),Ue=parseInt(S.substr(14,2),10);return new Date(B,ue,me,_e,Oe,Ue,0)},xe=h.__private__.setCreationDate=function(S){var B;if(S===void 0&&(S=new Date),S instanceof Date)B=q(S);else{if(!/^D:(20[0-2][0-9]|203[0-7]|19[7-9][0-9])(0[0-9]|1[0-2])([0-2][0-9]|3[0-1])(0[0-9]|1[0-9]|2[0-3])(0[0-9]|[1-5][0-9])(0[0-9]|[1-5][0-9])(\+0[0-9]|\+1[0-4]|-0[0-9]|-1[0-1])'(0[0-9]|[1-5][0-9])'?$/.test(S))throw new Error("Invalid argument passed to jsPDF.setCreationDate");B=S}return se=B},E=h.__private__.getCreationDate=function(S){var B=se;return S==="jsDate"&&(B=he(se)),B};h.setCreationDate=function(S){return xe(S),this},h.getCreationDate=function(S){return E(S)};var I,O=h.__private__.padd2=function(S){return("0"+parseInt(S)).slice(-2)},j=h.__private__.padd2Hex=function(S){return("00"+(S=S.toString())).substr(S.length)},K=0,ne=[],pe=[],de=0,we=[],Pe=[],Z=!1,Ve=pe,Ke=function(){K=0,de=0,pe=[],ne=[],we=[],ee=Tr(),te=Tr()};h.__private__.setCustomOutputDestination=function(S){Z=!0,Ve=S};var Ce=function(S){Z||(Ve=S)};h.__private__.resetCustomOutputDestination=function(){Z=!1,Ve=pe};var ae=h.__private__.out=function(S){return S=S.toString(),de+=S.length+1,Ve.push(S),Ve},De=h.__private__.write=function(S){return ae(arguments.length===1?S.toString():Array.prototype.join.call(arguments," "))},Xe=h.__private__.getArrayBuffer=function(S){for(var B=S.length,ue=new ArrayBuffer(B),me=new Uint8Array(ue);B--;)me[B]=S.charCodeAt(B);return ue},Me=[["Helvetica","helvetica","normal","WinAnsiEncoding"],["Helvetica-Bold","helvetica","bold","WinAnsiEncoding"],["Helvetica-Oblique","helvetica","italic","WinAnsiEncoding"],["Helvetica-BoldOblique","helvetica","bolditalic","WinAnsiEncoding"],["Courier","courier","normal","WinAnsiEncoding"],["Courier-Bold","courier","bold","WinAnsiEncoding"],["Courier-Oblique","courier","italic","WinAnsiEncoding"],["Courier-BoldOblique","courier","bolditalic","WinAnsiEncoding"],["Times-Roman","times","normal","WinAnsiEncoding"],["Times-Bold","times","bold","WinAnsiEncoding"],["Times-Italic","times","italic","WinAnsiEncoding"],["Times-BoldItalic","times","bolditalic","WinAnsiEncoding"],["ZapfDingbats","zapfdingbats","normal",null],["Symbol","symbol","normal",null]];h.__private__.getStandardFonts=function(){return Me};var qe=e.fontSize||16;h.__private__.setFontSize=h.setFontSize=function(S){return qe=y===w.ADVANCED?S/ze:S,this};var Ye,Je=h.__private__.getFontSize=h.getFontSize=function(){return y===w.COMPAT?qe:qe*ze},st=e.R2L||!1;h.__private__.setR2L=h.setR2L=function(S){return st=S,this},h.__private__.getR2L=h.getR2L=function(){return st};var lt,mt=h.__private__.setZoomMode=function(S){var B=[void 0,null,"fullwidth","fullheight","fullpage","original"];if(/^(?:\d+\.\d*|\d*\.\d+|\d+)%$/.test(S))Ye=S;else if(isNaN(S)){if(B.indexOf(S)===-1)throw new Error('zoom must be Integer (e.g. 2), a percentage Value (e.g. 300%) or fullwidth, fullheight, fullpage, original. "'+S+'" is not recognized.');Ye=S}else Ye=parseInt(S,10)};h.__private__.getZoomMode=function(){return Ye};var wt,Ot=h.__private__.setPageMode=function(S){if([void 0,null,"UseNone","UseOutlines","UseThumbs","FullScreen"].indexOf(S)==-1)throw new Error('Page mode must be one of UseNone, UseOutlines, UseThumbs, or FullScreen. "'+S+'" is not recognized.');lt=S};h.__private__.getPageMode=function(){return lt};var kt=h.__private__.setLayoutMode=function(S){if([void 0,null,"continuous","single","twoleft","tworight","two"].indexOf(S)==-1)throw new Error('Layout mode must be one of continuous, single, twoleft, tworight. "'+S+'" is not recognized.');wt=S};h.__private__.getLayoutMode=function(){return wt},h.__private__.setDisplayMode=h.setDisplayMode=function(S,B,ue){return mt(S),kt(B),Ot(ue),this};var ct={title:"",subject:"",author:"",keywords:"",creator:""};h.__private__.getDocumentProperty=function(S){if(Object.keys(ct).indexOf(S)===-1)throw new Error("Invalid argument passed to jsPDF.getDocumentProperty");return ct[S]},h.__private__.getDocumentProperties=function(){return ct},h.__private__.setDocumentProperties=h.setProperties=h.setDocumentProperties=function(S){for(var B in ct)ct.hasOwnProperty(B)&&S[B]&&(ct[B]=S[B]);return this},h.__private__.setDocumentProperty=function(S,B){if(Object.keys(ct).indexOf(S)===-1)throw new Error("Invalid arguments passed to jsPDF.setDocumentProperty");return ct[S]=B};var Ze,ze,Jt,ht,Zr,Kt={},lr={},$a=[],Vt={},qi={},mr={},ka={},di=null,ir=0,_t=[],Wt=new g_(h),xs=e.hotfixes||[],en={},za={},Ha=[],dt=function S(B,ue,me,_e,Oe,Ue){if(!(this instanceof S))return new S(B,ue,me,_e,Oe,Ue);isNaN(B)&&(B=1),isNaN(ue)&&(ue=0),isNaN(me)&&(me=0),isNaN(_e)&&(_e=1),isNaN(Oe)&&(Oe=0),isNaN(Ue)&&(Ue=0),this._matrix=[B,ue,me,_e,Oe,Ue]};Object.defineProperty(dt.prototype,"sx",{get:function(){return this._matrix[0]},set:function(S){this._matrix[0]=S}}),Object.defineProperty(dt.prototype,"shy",{get:function(){return this._matrix[1]},set:function(S){this._matrix[1]=S}}),Object.defineProperty(dt.prototype,"shx",{get:function(){return this._matrix[2]},set:function(S){this._matrix[2]=S}}),Object.defineProperty(dt.prototype,"sy",{get:function(){return this._matrix[3]},set:function(S){this._matrix[3]=S}}),Object.defineProperty(dt.prototype,"tx",{get:function(){return this._matrix[4]},set:function(S){this._matrix[4]=S}}),Object.defineProperty(dt.prototype,"ty",{get:function(){return this._matrix[5]},set:function(S){this._matrix[5]=S}}),Object.defineProperty(dt.prototype,"a",{get:function(){return this._matrix[0]},set:function(S){this._matrix[0]=S}}),Object.defineProperty(dt.prototype,"b",{get:function(){return this._matrix[1]},set:function(S){this._matrix[1]=S}}),Object.defineProperty(dt.prototype,"c",{get:function(){return this._matrix[2]},set:function(S){this._matrix[2]=S}}),Object.defineProperty(dt.prototype,"d",{get:function(){return this._matrix[3]},set:function(S){this._matrix[3]=S}}),Object.defineProperty(dt.prototype,"e",{get:function(){return this._matrix[4]},set:function(S){this._matrix[4]=S}}),Object.defineProperty(dt.prototype,"f",{get:function(){return this._matrix[5]},set:function(S){this._matrix[5]=S}}),Object.defineProperty(dt.prototype,"rotation",{get:function(){return Math.atan2(this.shx,this.sx)}}),Object.defineProperty(dt.prototype,"scaleX",{get:function(){return this.decompose().scale.sx}}),Object.defineProperty(dt.prototype,"scaleY",{get:function(){return this.decompose().scale.sy}}),Object.defineProperty(dt.prototype,"isIdentity",{get:function(){return this.sx===1&&this.shy===0&&this.shx===0&&this.sy===1&&this.tx===0&&this.ty===0}}),dt.prototype.join=function(S){return[this.sx,this.shy,this.shx,this.sy,this.tx,this.ty].map(T).join(S)},dt.prototype.multiply=function(S){var B=S.sx*this.sx+S.shy*this.shx,ue=S.sx*this.shy+S.shy*this.sy,me=S.shx*this.sx+S.sy*this.shx,_e=S.shx*this.shy+S.sy*this.sy,Oe=S.tx*this.sx+S.ty*this.shx+this.tx,Ue=S.tx*this.shy+S.ty*this.sy+this.ty;return new dt(B,ue,me,_e,Oe,Ue)},dt.prototype.decompose=function(){var S=this.sx,B=this.shy,ue=this.shx,me=this.sy,_e=this.tx,Oe=this.ty,Ue=Math.sqrt(S*S+B*B),nt=(S/=Ue)*ue+(B/=Ue)*me;ue-=S*nt,me-=B*nt;var ut=Math.sqrt(ue*ue+me*me);return nt/=ut,S*(me/=ut)<B*(ue/=ut)&&(S=-S,B=-B,nt=-nt,Ue=-Ue),{scale:new dt(Ue,0,0,ut,0,0),translate:new dt(1,0,0,1,_e,Oe),rotate:new dt(S,B,-B,S,0,0),skew:new dt(1,0,nt,1,0,0)}},dt.prototype.toString=function(S){return this.join(" ")},dt.prototype.inversed=function(){var S=this.sx,B=this.shy,ue=this.shx,me=this.sy,_e=this.tx,Oe=this.ty,Ue=1/(S*me-B*ue),nt=me*Ue,ut=-B*Ue,Nt=-ue*Ue,Et=S*Ue;return new dt(nt,ut,Nt,Et,-nt*_e-Nt*Oe,-ut*_e-Et*Oe)},dt.prototype.applyToPoint=function(S){var B=S.x*this.sx+S.y*this.shx+this.tx,ue=S.x*this.shy+S.y*this.sy+this.ty;return new kc(B,ue)},dt.prototype.applyToRectangle=function(S){var B=this.applyToPoint(S),ue=this.applyToPoint(new kc(S.x+S.w,S.y+S.h));return new hf(B.x,B.y,ue.x-B.x,ue.y-B.y)},dt.prototype.clone=function(){var S=this.sx,B=this.shy,ue=this.shx,me=this.sy,_e=this.tx,Oe=this.ty;return new dt(S,B,ue,me,_e,Oe)},h.Matrix=dt;var Ea=h.matrixMult=function(S,B){return B.multiply(S)},la=new dt(1,0,0,1,0,0);h.unitMatrix=h.identityMatrix=la;var An=function(S,B){if(!qi[S]){var ue=(B instanceof Il?"Sh":"P")+(Object.keys(Vt).length+1).toString(10);B.id=ue,qi[S]=ue,Vt[ue]=B,Wt.publish("addPattern",B)}};h.ShadingPattern=Il,h.TilingPattern=gu,h.addShadingPattern=function(S,B){return F("addShadingPattern()"),An(S,B),this},h.beginTilingPattern=function(S){F("beginTilingPattern()"),Zh(S.boundingBox[0],S.boundingBox[1],S.boundingBox[2]-S.boundingBox[0],S.boundingBox[3]-S.boundingBox[1],S.matrix)},h.endTilingPattern=function(S,B){F("endTilingPattern()"),B.stream=Pe[I].join(`
`),An(S,B),Wt.publish("endTilingPattern",B),Ha.pop().restore()};var Dr=h.__private__.newObject=function(){var S=Tr();return z(S,!0),S},Tr=h.__private__.newObjectDeferred=function(){return K++,ne[K]=function(){return de},K},z=function(S,B){return B=typeof B=="boolean"&&B,ne[S]=de,B&&ae(S+" 0 obj"),S},le=h.__private__.newAdditionalObject=function(){var S={objId:Tr(),content:""};return we.push(S),S},ee=Tr(),te=Tr(),oe=h.__private__.decodeColorString=function(S){var B=S.split(" ");if(B.length!==2||B[1]!=="g"&&B[1]!=="G")B.length===5&&(B[4]==="k"||B[4]==="K")&&(B=[(1-B[0])*(1-B[3]),(1-B[1])*(1-B[3]),(1-B[2])*(1-B[3]),"r"]);else{var ue=parseFloat(B[0]);B=[ue,ue,ue,"r"]}for(var me="#",_e=0;_e<3;_e++)me+=("0"+Math.floor(255*parseFloat(B[_e])).toString(16)).slice(-2);return me},ce=h.__private__.encodeColorString=function(S){var B;typeof S=="string"&&(S={ch1:S});var ue=S.ch1,me=S.ch2,_e=S.ch3,Oe=S.ch4,Ue=S.pdfColorType==="draw"?["G","RG","K"]:["g","rg","k"];if(typeof ue=="string"&&ue.charAt(0)!=="#"){var nt=new kC(ue);if(nt.ok)ue=nt.toHex();else if(!/^\d*\.?\d*$/.test(ue))throw new Error('Invalid color "'+ue+'" passed to jsPDF.encodeColorString.')}if(typeof ue=="string"&&/^#[0-9A-Fa-f]{3}$/.test(ue)&&(ue="#"+ue[1]+ue[1]+ue[2]+ue[2]+ue[3]+ue[3]),typeof ue=="string"&&/^#[0-9A-Fa-f]{6}$/.test(ue)){var ut=parseInt(ue.substr(1),16);ue=ut>>16&255,me=ut>>8&255,_e=255&ut}if(me===void 0||Oe===void 0&&ue===me&&me===_e)if(typeof ue=="string")B=ue+" "+Ue[0];else switch(S.precision){case 2:B=X(ue/255)+" "+Ue[0];break;case 3:default:B=N(ue/255)+" "+Ue[0]}else if(Oe===void 0||tr(Oe)==="object"){if(Oe&&!isNaN(Oe.a)&&Oe.a===0)return B=["1.","1.","1.",Ue[1]].join(" ");if(typeof ue=="string")B=[ue,me,_e,Ue[1]].join(" ");else switch(S.precision){case 2:B=[X(ue/255),X(me/255),X(_e/255),Ue[1]].join(" ");break;default:case 3:B=[N(ue/255),N(me/255),N(_e/255),Ue[1]].join(" ")}}else if(typeof ue=="string")B=[ue,me,_e,Oe,Ue[2]].join(" ");else switch(S.precision){case 2:B=[X(ue),X(me),X(_e),X(Oe),Ue[2]].join(" ");break;case 3:default:B=[N(ue),N(me),N(_e),N(Oe),Ue[2]].join(" ")}return B},ke=h.__private__.getFilters=function(){return s},Le=h.__private__.putStream=function(S){var B=(S=S||{}).data||"",ue=S.filters||ke(),me=S.alreadyAppliedFilters||[],_e=S.addLength1||!1,Oe=B.length,Ue=S.objectId,nt=function(Cn){return Cn};if(u!==null&&Ue===void 0)throw new Error("ObjectId must be passed to putStream for file encryption");u!==null&&(nt=Tn.encryptor(Ue,0));var ut={};ue===!0&&(ue=["FlateEncode"]);var Nt=S.additionalKeyValues||[],Et=(ut=vt.API.processDataByFilters!==void 0?vt.API.processDataByFilters(B,ue):{data:B,reverseChain:[]}).reverseChain+(Array.isArray(me)?me.join(" "):me.toString());if(ut.data.length!==0&&(Nt.push({key:"Length",value:ut.data.length}),_e===!0&&Nt.push({key:"Length1",value:Oe})),Et.length!=0)if(Et.split("/").length-1==1)Nt.push({key:"Filter",value:Et});else{Nt.push({key:"Filter",value:"["+Et+"]"});for(var Mt=0;Mt<Nt.length;Mt+=1)if(Nt[Mt].key==="DecodeParms"){for(var _r=[],Cr=0;Cr<ut.reverseChain.split("/").length-1;Cr+=1)_r.push("null");_r.push(Nt[Mt].value),Nt[Mt].value="["+_r.join(" ")+"]"}}ae("<<");for(var Wr=0;Wr<Nt.length;Wr++)ae("/"+Nt[Wr].key+" "+Nt[Wr].value);ae(">>"),ut.data.length!==0&&(ae("stream"),ae(nt(ut.data)),ae("endstream"))},Se=h.__private__.putPage=function(S){var B=S.number,ue=S.data,me=S.objId,_e=S.contentsObjId;z(me,!0),ae("<</Type /Page"),ae("/Parent "+S.rootDictionaryObjId+" 0 R"),ae("/Resources "+S.resourceDictionaryObjId+" 0 R"),ae("/MediaBox ["+parseFloat(T(S.mediaBox.bottomLeftX))+" "+parseFloat(T(S.mediaBox.bottomLeftY))+" "+T(S.mediaBox.topRightX)+" "+T(S.mediaBox.topRightY)+"]"),S.cropBox!==null&&ae("/CropBox ["+T(S.cropBox.bottomLeftX)+" "+T(S.cropBox.bottomLeftY)+" "+T(S.cropBox.topRightX)+" "+T(S.cropBox.topRightY)+"]"),S.bleedBox!==null&&ae("/BleedBox ["+T(S.bleedBox.bottomLeftX)+" "+T(S.bleedBox.bottomLeftY)+" "+T(S.bleedBox.topRightX)+" "+T(S.bleedBox.topRightY)+"]"),S.trimBox!==null&&ae("/TrimBox ["+T(S.trimBox.bottomLeftX)+" "+T(S.trimBox.bottomLeftY)+" "+T(S.trimBox.topRightX)+" "+T(S.trimBox.topRightY)+"]"),S.artBox!==null&&ae("/ArtBox ["+T(S.artBox.bottomLeftX)+" "+T(S.artBox.bottomLeftY)+" "+T(S.artBox.topRightX)+" "+T(S.artBox.topRightY)+"]"),typeof S.userUnit=="number"&&S.userUnit!==1&&ae("/UserUnit "+S.userUnit),Wt.publish("putPage",{objId:me,pageContext:_t[B],pageNumber:B,page:ue}),ae("/Contents "+_e+" 0 R"),ae(">>"),ae("endobj");var Oe=ue.join(`
`);return y===w.ADVANCED&&(Oe+=`
Q`),z(_e,!0),Le({data:Oe,filters:ke(),objectId:_e}),ae("endobj"),me},Te=h.__private__.putPages=function(){var S,B,ue=[];for(S=1;S<=ir;S++)_t[S].objId=Tr(),_t[S].contentsObjId=Tr();for(S=1;S<=ir;S++)ue.push(Se({number:S,data:Pe[S],objId:_t[S].objId,contentsObjId:_t[S].contentsObjId,mediaBox:_t[S].mediaBox,cropBox:_t[S].cropBox,bleedBox:_t[S].bleedBox,trimBox:_t[S].trimBox,artBox:_t[S].artBox,userUnit:_t[S].userUnit,rootDictionaryObjId:ee,resourceDictionaryObjId:te}));z(ee,!0),ae("<</Type /Pages");var me="/Kids [";for(B=0;B<ir;B++)me+=ue[B]+" 0 R ";ae(me+"]"),ae("/Count "+ir),ae(">>"),ae("endobj"),Wt.publish("postPutPages")},Ne=function(S){Wt.publish("putFont",{font:S,out:ae,newObject:Dr,putStream:Le}),S.isAlreadyPutted!==!0&&(S.objectNumber=Dr(),ae("<<"),ae("/Type /Font"),ae("/BaseFont /"+Jc(S.postScriptName)),ae("/Subtype /Type1"),typeof S.encoding=="string"&&ae("/Encoding /"+S.encoding),ae("/FirstChar 32"),ae("/LastChar 255"),ae(">>"),ae("endobj"))},$e=function(){for(var S in Kt)Kt.hasOwnProperty(S)&&(f===!1||f===!0&&p.hasOwnProperty(S))&&Ne(Kt[S])},Ge=function(S){S.objectNumber=Dr();var B=[];B.push({key:"Type",value:"/XObject"}),B.push({key:"Subtype",value:"/Form"}),B.push({key:"BBox",value:"["+[T(S.x),T(S.y),T(S.x+S.width),T(S.y+S.height)].join(" ")+"]"}),B.push({key:"Matrix",value:"["+S.matrix.toString()+"]"});var ue=S.pages[1].join(`
`);Le({data:ue,additionalKeyValues:B,objectId:S.objectNumber}),ae("endobj")},rt=function(){for(var S in en)en.hasOwnProperty(S)&&Ge(en[S])},We=function(S,B){var ue,me=[],_e=1/(B-1);for(ue=0;ue<1;ue+=_e)me.push(ue);if(me.push(1),S[0].offset!=0){var Oe={offset:0,color:S[0].color};S.unshift(Oe)}if(S[S.length-1].offset!=1){var Ue={offset:1,color:S[S.length-1].color};S.push(Ue)}for(var nt="",ut=0,Nt=0;Nt<me.length;Nt++){for(ue=me[Nt];ue>S[ut+1].offset;)ut++;var Et=S[ut].offset,Mt=(ue-Et)/(S[ut+1].offset-Et),_r=S[ut].color,Cr=S[ut+1].color;nt+=j(Math.round((1-Mt)*_r[0]+Mt*Cr[0]).toString(16))+j(Math.round((1-Mt)*_r[1]+Mt*Cr[1]).toString(16))+j(Math.round((1-Mt)*_r[2]+Mt*Cr[2]).toString(16))}return nt.trim()},tt=function(S,B){B||(B=21);var ue=Dr(),me=We(S.colors,B),_e=[];_e.push({key:"FunctionType",value:"0"}),_e.push({key:"Domain",value:"[0.0 1.0]"}),_e.push({key:"Size",value:"["+B+"]"}),_e.push({key:"BitsPerSample",value:"8"}),_e.push({key:"Range",value:"[0.0 1.0 0.0 1.0 0.0 1.0]"}),_e.push({key:"Decode",value:"[0.0 1.0 0.0 1.0 0.0 1.0]"}),Le({data:me,additionalKeyValues:_e,alreadyAppliedFilters:["/ASCIIHexDecode"],objectId:ue}),ae("endobj"),S.objectNumber=Dr(),ae("<< /ShadingType "+S.type),ae("/ColorSpace /DeviceRGB");var Oe="/Coords ["+T(parseFloat(S.coords[0]))+" "+T(parseFloat(S.coords[1]))+" ";S.type===2?Oe+=T(parseFloat(S.coords[2]))+" "+T(parseFloat(S.coords[3])):Oe+=T(parseFloat(S.coords[2]))+" "+T(parseFloat(S.coords[3]))+" "+T(parseFloat(S.coords[4]))+" "+T(parseFloat(S.coords[5])),ae(Oe+="]"),S.matrix&&ae("/Matrix ["+S.matrix.toString()+"]"),ae("/Function "+ue+" 0 R"),ae("/Extend [true true]"),ae(">>"),ae("endobj")},bt=function(S,B){var ue=Tr(),me=Dr();B.push({resourcesOid:ue,objectOid:me}),S.objectNumber=me;var _e=[];_e.push({key:"Type",value:"/Pattern"}),_e.push({key:"PatternType",value:"1"}),_e.push({key:"PaintType",value:"1"}),_e.push({key:"TilingType",value:"1"}),_e.push({key:"BBox",value:"["+S.boundingBox.map(T).join(" ")+"]"}),_e.push({key:"XStep",value:T(S.xStep)}),_e.push({key:"YStep",value:T(S.yStep)}),_e.push({key:"Resources",value:ue+" 0 R"}),S.matrix&&_e.push({key:"Matrix",value:"["+S.matrix.toString()+"]"}),Le({data:S.stream,additionalKeyValues:_e,objectId:S.objectNumber}),ae("endobj")},Xt=function(S){var B;for(B in Vt)Vt.hasOwnProperty(B)&&(Vt[B]instanceof Il?tt(Vt[B]):Vt[B]instanceof gu&&bt(Vt[B],S))},nr=function(S){for(var B in S.objectNumber=Dr(),ae("<<"),S)switch(B){case"opacity":ae("/ca "+X(S[B]));break;case"stroke-opacity":ae("/CA "+X(S[B]))}ae(">>"),ae("endobj")},Hr=function(){var S;for(S in mr)mr.hasOwnProperty(S)&&nr(mr[S])},pi=function(){for(var S in ae("/XObject <<"),en)en.hasOwnProperty(S)&&en[S].objectNumber>=0&&ae("/"+S+" "+en[S].objectNumber+" 0 R");Wt.publish("putXobjectDict"),ae(">>")},ys=function(){Tn.oid=Dr(),ae("<<"),ae("/Filter /Standard"),ae("/V "+Tn.v),ae("/R "+Tn.r),ae("/U <"+Tn.toHexString(Tn.U)+">"),ae("/O <"+Tn.toHexString(Tn.O)+">"),ae("/P "+Tn.P),ae(">>"),ae("endobj")},Gi=function(){for(var S in ae("/Font <<"),Kt)Kt.hasOwnProperty(S)&&(f===!1||f===!0&&p.hasOwnProperty(S))&&ae("/"+S+" "+Kt[S].objectNumber+" 0 R");ae(">>")},mi=function(){if(Object.keys(Vt).length>0){for(var S in ae("/Shading <<"),Vt)Vt.hasOwnProperty(S)&&Vt[S]instanceof Il&&Vt[S].objectNumber>=0&&ae("/"+S+" "+Vt[S].objectNumber+" 0 R");Wt.publish("putShadingPatternDict"),ae(">>")}},Ki=function(S){if(Object.keys(Vt).length>0){for(var B in ae("/Pattern <<"),Vt)Vt.hasOwnProperty(B)&&Vt[B]instanceof h.TilingPattern&&Vt[B].objectNumber>=0&&Vt[B].objectNumber<S&&ae("/"+B+" "+Vt[B].objectNumber+" 0 R");Wt.publish("putTilingPatternDict"),ae(">>")}},Aa=function(){if(Object.keys(mr).length>0){var S;for(S in ae("/ExtGState <<"),mr)mr.hasOwnProperty(S)&&mr[S].objectNumber>=0&&ae("/"+S+" "+mr[S].objectNumber+" 0 R");Wt.publish("putGStateDict"),ae(">>")}},Ir=function(S){z(S.resourcesOid,!0),ae("<<"),ae("/ProcSet [/PDF /Text /ImageB /ImageC /ImageI]"),Gi(),mi(),Ki(S.objectOid),Aa(),pi(),ae(">>"),ae("endobj")},Mh=function(){var S=[];$e(),Hr(),rt(),Xt(S),Wt.publish("putResources"),S.forEach(Ir),Ir({resourcesOid:te,objectOid:Number.MAX_SAFE_INTEGER}),Wt.publish("postPutResources")},Bh=function(){Wt.publish("putAdditionalObjects");for(var S=0;S<we.length;S++){var B=we[S];z(B.objId,!0),ae(B.content),ae("endobj")}Wt.publish("postPutAdditionalObjects")},Uh=function(S){lr[S.fontName]=lr[S.fontName]||{},lr[S.fontName][S.fontStyle]=S.id},rf=function(S,B,ue,me,_e){var Oe={id:"F"+(Object.keys(Kt).length+1).toString(10),postScriptName:S,fontName:B,fontStyle:ue,encoding:me,isStandardFont:_e||!1,metadata:{}};return Wt.publish("addFont",{font:Oe,instance:this}),Kt[Oe.id]=Oe,Uh(Oe),Oe.id},Im=function(S){for(var B=0,ue=Me.length;B<ue;B++){var me=rf.call(this,S[B][0],S[B][1],S[B][2],Me[B][3],!0);f===!1&&(p[me]=!0);var _e=S[B][0].split("-");Uh({id:me,fontName:_e[0],fontStyle:_e[1]||""})}Wt.publish("addFonts",{fonts:Kt,dictionary:lr})},gi=function(S){return S.foo=function(){try{return S.apply(this,arguments)}catch(me){var B=me.stack||"";~B.indexOf(" at ")&&(B=B.split(" at ")[1]);var ue="Error in function "+B.split(`
`)[0].split("<")[0]+": "+me.message;if(!xt.console)throw new Error(ue);xt.console.error(ue,me),xt.alert&&alert(ue)}},S.foo.bar=S,S.foo},xc=function(S,B){var ue,me,_e,Oe,Ue,nt,ut,Nt,Et;if(_e=(B=B||{}).sourceEncoding||"Unicode",Ue=B.outputEncoding,(B.autoencode||Ue)&&Kt[Ze].metadata&&Kt[Ze].metadata[_e]&&Kt[Ze].metadata[_e].encoding&&(Oe=Kt[Ze].metadata[_e].encoding,!Ue&&Kt[Ze].encoding&&(Ue=Kt[Ze].encoding),!Ue&&Oe.codePages&&(Ue=Oe.codePages[0]),typeof Ue=="string"&&(Ue=Oe[Ue]),Ue)){for(ut=!1,nt=[],ue=0,me=S.length;ue<me;ue++)(Nt=Ue[S.charCodeAt(ue)])?nt.push(String.fromCharCode(Nt)):nt.push(S[ue]),nt[ue].charCodeAt(0)>>8&&(ut=!0);S=nt.join("")}for(ue=S.length;ut===void 0&&ue!==0;)S.charCodeAt(ue-1)>>8&&(ut=!0),ue--;if(!ut)return S;for(nt=B.noBOM?[]:[254,255],ue=0,me=S.length;ue<me;ue++){if((Et=(Nt=S.charCodeAt(ue))>>8)>>8)throw new Error("Character at position "+ue+" of string '"+S+"' exceeds 16bits. Cannot be encoded into UCS-2 BE");nt.push(Et),nt.push(Nt-(Et<<8))}return String.fromCharCode.apply(void 0,nt)},ca=h.__private__.pdfEscape=h.pdfEscape=function(S,B){return xc(S,B).replace(/\\/g,"\\\\").replace(/\(/g,"\\(").replace(/\)/g,"\\)")},nf=h.__private__.beginPage=function(S){Pe[++ir]=[],_t[ir]={objId:0,contentsObjId:0,userUnit:Number(o),artBox:null,bleedBox:null,cropBox:null,trimBox:null,mediaBox:{bottomLeftX:0,bottomLeftY:0,topRightX:Number(S[0]),topRightY:Number(S[1])}},$h(ir),Ce(Pe[I])},Vh=function(S,B){var ue,me,_e;switch(r=B||r,typeof S=="string"&&(ue=x(S.toLowerCase()),Array.isArray(ue)&&(me=ue[0],_e=ue[1])),Array.isArray(S)&&(me=S[0]*ze,_e=S[1]*ze),isNaN(me)&&(me=a[0],_e=a[1]),(me>14400||_e>14400)&&(or.warn("A page in a PDF can not be wider or taller than 14400 userUnit. jsPDF limits the width/height to 14400"),me=Math.min(14400,me),_e=Math.min(14400,_e)),a=[me,_e],r.substr(0,1)){case"l":_e>me&&(a=[_e,me]);break;case"p":me>_e&&(a=[_e,me])}nf(a),Kh(lf),ae(vi),uf!==0&&ae(uf+" J"),ff!==0&&ae(ff+" j"),Wt.publish("addPage",{pageNumber:ir})},Rm=function(S){S>0&&S<=ir&&(Pe.splice(S,1),_t.splice(S,1),ir--,I>ir&&(I=ir),this.setPage(I))},$h=function(S){S>0&&S<=ir&&(I=S)},jm=h.__private__.getNumberOfPages=h.getNumberOfPages=function(){return Pe.length-1},zh=function(S,B,ue){var me,_e=void 0;return ue=ue||{},S=S!==void 0?S:Kt[Ze].fontName,B=B!==void 0?B:Kt[Ze].fontStyle,me=S.toLowerCase(),lr[me]!==void 0&&lr[me][B]!==void 0?_e=lr[me][B]:lr[S]!==void 0&&lr[S][B]!==void 0?_e=lr[S][B]:ue.disableWarning===!1&&or.warn("Unable to look up font label for font '"+S+"', '"+B+"'. Refer to getFontList() for available fonts."),_e||ue.noFallback||(_e=lr.times[B])==null&&(_e=lr.times.normal),_e},Mm=h.__private__.putInfo=function(){var S=Dr(),B=function(me){return me};for(var ue in u!==null&&(B=Tn.encryptor(S,0)),ae("<<"),ae("/Producer ("+ca(B("jsPDF "+vt.version))+")"),ct)ct.hasOwnProperty(ue)&&ct[ue]&&ae("/"+ue.substr(0,1).toUpperCase()+ue.substr(1)+" ("+ca(B(ct[ue]))+")");ae("/CreationDate ("+ca(B(se))+")"),ae(">>"),ae("endobj")},af=h.__private__.putCatalog=function(S){var B=(S=S||{}).rootDictionaryObjId||ee;switch(Dr(),ae("<<"),ae("/Type /Catalog"),ae("/Pages "+B+" 0 R"),Ye||(Ye="fullwidth"),Ye){case"fullwidth":ae("/OpenAction [3 0 R /FitH null]");break;case"fullheight":ae("/OpenAction [3 0 R /FitV null]");break;case"fullpage":ae("/OpenAction [3 0 R /Fit]");break;case"original":ae("/OpenAction [3 0 R /XYZ null null 1]");break;default:var ue=""+Ye;ue.substr(ue.length-1)==="%"&&(Ye=parseInt(Ye)/100),typeof Ye=="number"&&ae("/OpenAction [3 0 R /XYZ null null "+X(Ye)+"]")}switch(wt||(wt="continuous"),wt){case"continuous":ae("/PageLayout /OneColumn");break;case"single":ae("/PageLayout /SinglePage");break;case"two":case"twoleft":ae("/PageLayout /TwoColumnLeft");break;case"tworight":ae("/PageLayout /TwoColumnRight")}lt&&ae("/PageMode /"+lt),Wt.publish("putCatalog"),ae(">>"),ae("endobj")},Bm=h.__private__.putTrailer=function(){ae("trailer"),ae("<<"),ae("/Size "+(K+1)),ae("/Root "+K+" 0 R"),ae("/Info "+(K-1)+" 0 R"),u!==null&&ae("/Encrypt "+Tn.oid+" 0 R"),ae("/ID [ <"+fe+"> <"+fe+"> ]"),ae(">>")},Um=h.__private__.putHeader=function(){ae("%PDF-"+g),ae("%")},Vm=h.__private__.putXRef=function(){var S="0000000000";ae("xref"),ae("0 "+(K+1)),ae("0000000000 65535 f ");for(var B=1;B<=K;B++)typeof ne[B]=="function"?ae((S+ne[B]()).slice(-10)+" 00000 n "):ne[B]!==void 0?ae((S+ne[B]).slice(-10)+" 00000 n "):ae("0000000000 00000 n ")},ws=h.__private__.buildDocument=function(){Ke(),Ce(pe),Wt.publish("buildDocument"),Um(),Te(),Bh(),Mh(),u!==null&&ys(),Mm(),af();var S=de;return Vm(),Bm(),ae("startxref"),ae(""+S),ae("%%EOF"),Ce(Pe[I]),pe.join(`
`)},yc=h.__private__.getBlob=function(S){return new Blob([Xe(S)],{type:"application/pdf"})},wc=h.output=h.__private__.output=gi(function(S,B){switch(typeof(B=B||{})=="string"?B={filename:B}:B.filename=B.filename||"generated.pdf",S){case void 0:return ws();case"save":h.save(B.filename);break;case"arraybuffer":return Xe(ws());case"blob":return yc(ws());case"bloburi":case"bloburl":if(xt.URL!==void 0&&typeof xt.URL.createObjectURL=="function")return xt.URL&&xt.URL.createObjectURL(yc(ws()))||void 0;or.warn("bloburl is not supported by your system, because URL.createObjectURL is not supported by your browser.");break;case"datauristring":case"dataurlstring":var ue="",me=ws();try{ue=wx(me)}catch{ue=wx(unescape(encodeURIComponent(me)))}return"data:application/pdf;filename="+B.filename+";base64,"+ue;case"pdfobjectnewwindow":if(Object.prototype.toString.call(xt)==="[object Window]"){var _e="https://cdnjs.cloudflare.com/ajax/libs/pdfobject/2.1.1/pdfobject.min.js",Oe=' integrity="sha512-4ze/a9/4jqu+tX9dfOqJYSvyYd5M6qum/3HpCLr+/Jqf0whc37VUbkpNGHR7/8pSnCFw47T1fmIpwBV7UySh3g==" crossorigin="anonymous"';B.pdfObjectUrl&&(_e=B.pdfObjectUrl,Oe="");var Ue='<html><style>html, body { padding: 0; margin: 0; } iframe { width: 100%; height: 100%; border: 0;}  </style><body><script src="'+_e+'"'+Oe+'><\/script><script >PDFObject.embed("'+this.output("dataurlstring")+'", '+JSON.stringify(B)+");<\/script></body></html>",nt=xt.open();return nt!==null&&nt.document.write(Ue),nt}throw new Error("The option pdfobjectnewwindow just works in a browser-environment.");case"pdfjsnewwindow":if(Object.prototype.toString.call(xt)==="[object Window]"){var ut='<html><style>html, body { padding: 0; margin: 0; } iframe { width: 100%; height: 100%; border: 0;}  </style><body><iframe id="pdfViewer" src="'+(B.pdfJsUrl||"examples/PDF.js/web/viewer.html")+"?file=&downloadName="+B.filename+'" width="500px" height="400px" /></body></html>',Nt=xt.open();if(Nt!==null){Nt.document.write(ut);var Et=this;Nt.document.documentElement.querySelector("#pdfViewer").onload=function(){Nt.document.title=B.filename,Nt.document.documentElement.querySelector("#pdfViewer").contentWindow.PDFViewerApplication.open(Et.output("bloburl"))}}return Nt}throw new Error("The option pdfjsnewwindow just works in a browser-environment.");case"dataurlnewwindow":if(Object.prototype.toString.call(xt)!=="[object Window]")throw new Error("The option dataurlnewwindow just works in a browser-environment.");var Mt='<html><style>html, body { padding: 0; margin: 0; } iframe { width: 100%; height: 100%; border: 0;}  </style><body><iframe src="'+this.output("datauristring",B)+'"></iframe></body></html>',_r=xt.open();if(_r!==null&&(_r.document.write(Mt),_r.document.title=B.filename),_r||typeof safari>"u")return _r;break;case"datauri":case"dataurl":return xt.document.location.href=this.output("datauristring",B);default:return null}}),Hh=function(S){return Array.isArray(xs)===!0&&xs.indexOf(S)>-1};switch(n){case"pt":ze=1;break;case"mm":ze=72/25.4;break;case"cm":ze=72/2.54;break;case"in":ze=72;break;case"px":ze=Hh("px_scaling")==1?.75:96/72;break;case"pc":case"em":ze=12;break;case"ex":ze=6;break;default:if(typeof n!="number")throw new Error("Invalid unit: "+n);ze=n}var Tn=null;xe(),Q();var $m=function(S){return u!==null?Tn.encryptor(S,0):function(B){return B}},Wh=h.__private__.getPageInfo=h.getPageInfo=function(S){if(isNaN(S)||S%1!=0)throw new Error("Invalid argument passed to jsPDF.getPageInfo");return{objId:_t[S].objId,pageNumber:S,pageContext:_t[S]}},St=h.__private__.getPageInfoByObjId=function(S){if(isNaN(S)||S%1!=0)throw new Error("Invalid argument passed to jsPDF.getPageInfoByObjId");for(var B in _t)if(_t[B].objId===S)break;return Wh(B)},zm=h.__private__.getCurrentPageInfo=h.getCurrentPageInfo=function(){return{objId:_t[I].objId,pageNumber:I,pageContext:_t[I]}};h.addPage=function(){return Vh.apply(this,arguments),this},h.setPage=function(){return $h.apply(this,arguments),Ce.call(this,Pe[I]),this},h.insertPage=function(S){return this.addPage(),this.movePage(I,S),this},h.movePage=function(S,B){var ue,me;if(S>B){ue=Pe[S],me=_t[S];for(var _e=S;_e>B;_e--)Pe[_e]=Pe[_e-1],_t[_e]=_t[_e-1];Pe[B]=ue,_t[B]=me,this.setPage(B)}else if(S<B){ue=Pe[S],me=_t[S];for(var Oe=S;Oe<B;Oe++)Pe[Oe]=Pe[Oe+1],_t[Oe]=_t[Oe+1];Pe[B]=ue,_t[B]=me,this.setPage(B)}return this},h.deletePage=function(){return Rm.apply(this,arguments),this},h.__private__.text=h.text=function(S,B,ue,me,_e){var Oe,Ue,nt,ut,Nt,Et,Mt,_r,Cr,Wr=(me=me||{}).scope||this;if(typeof S=="number"&&typeof B=="number"&&(typeof ue=="string"||Array.isArray(ue))){var Cn=ue;ue=B,B=S,S=Cn}if(arguments[3]instanceof dt?(F("The transform parameter of text() with a Matrix value"),Cr=_e):(nt=arguments[4],ut=arguments[5],tr(Mt=arguments[3])==="object"&&Mt!==null||(typeof nt=="string"&&(ut=nt,nt=null),typeof Mt=="string"&&(ut=Mt,Mt=null),typeof Mt=="number"&&(nt=Mt,Mt=null),me={flags:Mt,angle:nt,align:ut})),isNaN(B)||isNaN(ue)||S==null)throw new Error("Invalid arguments passed to jsPDF.text");if(S.length===0)return Wr;var cn="",xi=!1,Ta=typeof me.lineHeightFactor=="number"?me.lineHeightFactor:pl,Ji=Wr.internal.scaleFactor;function ed(cr){return cr=cr.split("	").join(Array(me.TabLen||9).join(" ")),ca(cr,Mt)}function gf(cr){for(var ur,jr=cr.concat(),tn=[],Es=jr.length;Es--;)typeof(ur=jr.shift())=="string"?tn.push(ur):Array.isArray(cr)&&(ur.length===1||ur[1]===void 0&&ur[2]===void 0)?tn.push(ur[0]):tn.push([ur[0],ur[1],ur[2]]);return tn}function vf(cr,ur){var jr;if(typeof cr=="string")jr=ur(cr)[0];else if(Array.isArray(cr)){for(var tn,Es,Ef=cr.concat(),Ic=[],id=Ef.length;id--;)typeof(tn=Ef.shift())=="string"?Ic.push(ur(tn)[0]):Array.isArray(tn)&&typeof tn[0]=="string"&&(Es=ur(tn[0],tn[1],tn[2]),Ic.push([Es[0],Es[1],Es[2]]));jr=Ic}return jr}var Ac=!1,xf=!0;if(typeof S=="string")Ac=!0;else if(Array.isArray(S)){var yf=S.concat();Ue=[];for(var Tc,xn=yf.length;xn--;)(typeof(Tc=yf.shift())!="string"||Array.isArray(Tc)&&typeof Tc[0]!="string")&&(xf=!1);Ac=xf}if(Ac===!1)throw new Error('Type of text must be string or Array. "'+S+'" is not recognized.');typeof S=="string"&&(S=S.match(/[\r?\n]/)?S.split(/\r\n|\r|\n/g):[S]);var Cc=qe/Wr.internal.scaleFactor,Nc=Cc*(Ta-1);switch(me.baseline){case"bottom":ue-=Nc;break;case"top":ue+=Cc-Nc;break;case"hanging":ue+=Cc-2*Nc;break;case"middle":ue+=Cc/2-Nc}if((Et=me.maxWidth||0)>0&&(typeof S=="string"?S=Wr.splitTextToSize(S,Et):Object.prototype.toString.call(S)==="[object Array]"&&(S=S.reduce(function(cr,ur){return cr.concat(Wr.splitTextToSize(ur,Et))},[]))),Oe={text:S,x:B,y:ue,options:me,mutex:{pdfEscape:ca,activeFontKey:Ze,fonts:Kt,activeFontSize:qe}},Wt.publish("preProcessText",Oe),S=Oe.text,nt=(me=Oe.options).angle,!(Cr instanceof dt)&&nt&&typeof nt=="number"){nt*=Math.PI/180,me.rotationDirection===0&&(nt=-nt),y===w.ADVANCED&&(nt=-nt);var Pc=Math.cos(nt),wf=Math.sin(nt);Cr=new dt(Pc,wf,-wf,Pc,0,0)}else nt&&nt instanceof dt&&(Cr=nt);y!==w.ADVANCED||Cr||(Cr=la),(Nt=me.charSpace||Sc)!==void 0&&(cn+=T(P(Nt))+` Tc
`,this.setCharSpace(this.getCharSpace()||0)),(_r=me.horizontalScale)!==void 0&&(cn+=T(100*_r)+` Tz
`),me.lang;var ua=-1,Zm=me.renderingMode!==void 0?me.renderingMode:me.stroke,bf=Wr.internal.getCurrentPageInfo().pageContext;switch(Zm){case 0:case!1:case"fill":ua=0;break;case 1:case!0:case"stroke":ua=1;break;case 2:case"fillThenStroke":ua=2;break;case 3:case"invisible":ua=3;break;case 4:case"fillAndAddForClipping":ua=4;break;case 5:case"strokeAndAddPathForClipping":ua=5;break;case 6:case"fillThenStrokeAndAddToPathForClipping":ua=6;break;case 7:case"addToPathForClipping":ua=7}var td=bf.usedRenderingMode!==void 0?bf.usedRenderingMode:-1;ua!==-1?cn+=ua+` Tr
`:td!==-1&&(cn+=`0 Tr
`),ua!==-1&&(bf.usedRenderingMode=ua),ut=me.align||"left";var Wa,Lc=qe*Ta,rd=Wr.internal.pageSize.getWidth(),nd=Kt[Ze];Nt=me.charSpace||Sc,Et=me.maxWidth||0,Mt=Object.assign({autoencode:!0,noBOM:!0},me.flags);var oo=[],vl=function(cr){return Wr.getStringUnitWidth(cr,{font:nd,charSpace:Nt,fontSize:qe,doKerning:!1})*qe/Ji};if(Object.prototype.toString.call(S)==="[object Array]"){var fa;Ue=gf(S),ut!=="left"&&(Wa=Ue.map(vl));var Kn,lo=0;if(ut==="right"){B-=Wa[0],S=[],xn=Ue.length;for(var _s=0;_s<xn;_s++)_s===0?(Kn=Yi(B),fa=bs(ue)):(Kn=P(lo-Wa[_s]),fa=-Lc),S.push([Ue[_s],Kn,fa]),lo=Wa[_s]}else if(ut==="center"){B-=Wa[0]/2,S=[],xn=Ue.length;for(var Ss=0;Ss<xn;Ss++)Ss===0?(Kn=Yi(B),fa=bs(ue)):(Kn=P((lo-Wa[Ss])/2),fa=-Lc),S.push([Ue[Ss],Kn,fa]),lo=Wa[Ss]}else if(ut==="left"){S=[],xn=Ue.length;for(var Fc=0;Fc<xn;Fc++)S.push(Ue[Fc])}else if(ut==="justify"&&nd.encoding==="Identity-H"){S=[],xn=Ue.length,Et=Et!==0?Et:rd;for(var ks=0,Rr=0;Rr<xn;Rr++)if(fa=Rr===0?bs(ue):-Lc,Kn=Rr===0?Yi(B):ks,Rr<xn-1){var _f=P((Et-Wa[Rr])/(Ue[Rr].split(" ").length-1)),Xn=Ue[Rr].split(" ");S.push([Xn[0]+" ",Kn,fa]),ks=0;for(var qa=1;qa<Xn.length;qa++){var Oc=(vl(Xn[qa-1]+" "+Xn[qa])-vl(Xn[qa]))*Ji+_f;qa==Xn.length-1?S.push([Xn[qa],Oc,0]):S.push([Xn[qa]+" ",Oc,0]),ks-=Oc}}else S.push([Ue[Rr],Kn,fa]);S.push(["",ks,0])}else{if(ut!=="justify")throw new Error('Unrecognized alignment option, use "left", "center", "right" or "justify".');for(S=[],xn=Ue.length,Et=Et!==0?Et:rd,Rr=0;Rr<xn;Rr++)fa=Rr===0?bs(ue):-Lc,Kn=Rr===0?Yi(B):0,Rr<xn-1?oo.push(T(P((Et-Wa[Rr])/(Ue[Rr].split(" ").length-1)))):oo.push(0),S.push([Ue[Rr],Kn,fa])}}var ad=typeof me.R2L=="boolean"?me.R2L:st;ad===!0&&(S=vf(S,function(cr,ur,jr){return[cr.split("").reverse().join(""),ur,jr]})),Oe={text:S,x:B,y:ue,options:me,mutex:{pdfEscape:ca,activeFontKey:Ze,fonts:Kt,activeFontSize:qe}},Wt.publish("postProcessText",Oe),S=Oe.text,xi=Oe.mutex.isHex||!1;var Sf=Kt[Ze].encoding;Sf!=="WinAnsiEncoding"&&Sf!=="StandardEncoding"||(S=vf(S,function(cr,ur,jr){return[ed(cr),ur,jr]})),Ue=gf(S),S=[];for(var xl,yl,co,wl=0,Dc=1,bl=Array.isArray(Ue[0])?Dc:wl,uo="",kf=function(cr,ur,jr){var tn="";return jr instanceof dt?(jr=typeof me.angle=="number"?Ea(jr,new dt(1,0,0,1,cr,ur)):Ea(new dt(1,0,0,1,cr,ur),jr),y===w.ADVANCED&&(jr=Ea(new dt(1,0,0,-1,0,0),jr)),tn=jr.join(" ")+` Tm
`):tn=T(cr)+" "+T(ur)+` Td
`,tn},Ga=0;Ga<Ue.length;Ga++){switch(uo="",bl){case Dc:co=(xi?"<":"(")+Ue[Ga][0]+(xi?">":")"),xl=parseFloat(Ue[Ga][1]),yl=parseFloat(Ue[Ga][2]);break;case wl:co=(xi?"<":"(")+Ue[Ga]+(xi?">":")"),xl=Yi(B),yl=bs(ue)}oo!==void 0&&oo[Ga]!==void 0&&(uo=oo[Ga]+` Tw
`),Ga===0?S.push(uo+kf(xl,yl,Cr)+co):bl===wl?S.push(uo+co):bl===Dc&&S.push(uo+kf(xl,yl,Cr)+co)}S=bl===wl?S.join(` Tj
T* `):S.join(` Tj
`),S+=` Tj
`;var Ka=`BT
/`;return Ka+=Ze+" "+qe+` Tf
`,Ka+=T(qe*Ta)+` TL
`,Ka+=ml+`
`,Ka+=cn,Ka+=S,ae(Ka+="ET"),p[Ze]=!0,Wr};var Hm=h.__private__.clip=h.clip=function(S){return ae(S==="evenodd"?"W*":"W"),this};h.clipEvenOdd=function(){return Hm("evenodd")},h.__private__.discardPath=h.discardPath=function(){return ae("n"),this};var Xi=h.__private__.isValidStyle=function(S){var B=!1;return[void 0,null,"S","D","F","DF","FD","f","f*","B","B*","n"].indexOf(S)!==-1&&(B=!0),B};h.__private__.setDefaultPathOperation=h.setDefaultPathOperation=function(S){return Xi(S)&&(c=S),this};var qh=h.__private__.getStyle=h.getStyle=function(S){var B=c;switch(S){case"D":case"S":B="S";break;case"F":B="f";break;case"FD":case"DF":B="B";break;case"f":case"f*":case"B":case"B*":B=S}return B},Gh=h.close=function(){return ae("h"),this};h.stroke=function(){return ae("S"),this},h.fill=function(S){return bc("f",S),this},h.fillEvenOdd=function(S){return bc("f*",S),this},h.fillStroke=function(S){return bc("B",S),this},h.fillStrokeEvenOdd=function(S){return bc("B*",S),this};var bc=function(S,B){tr(B)==="object"?qm(B,S):ae(S)},sf=function(S){S===null||y===w.ADVANCED&&S===void 0||(S=qh(S),ae(S))};function Wm(S,B,ue,me,_e){var Oe=new gu(B||this.boundingBox,ue||this.xStep,me||this.yStep,this.gState,_e||this.matrix);Oe.stream=this.stream;var Ue=S+"$$"+this.cloneIndex+++"$$";return An(Ue,Oe),Oe}var qm=function(S,B){var ue=qi[S.key],me=Vt[ue];if(me instanceof Il)ae("q"),ae(Gm(B)),me.gState&&h.setGState(me.gState),ae(S.matrix.toString()+" cm"),ae("/"+ue+" sh"),ae("Q");else if(me instanceof gu){var _e=new dt(1,0,0,-1,0,so());S.matrix&&(_e=_e.multiply(S.matrix||la),ue=Wm.call(me,S.key,S.boundingBox,S.xStep,S.yStep,_e).id),ae("q"),ae("/Pattern cs"),ae("/"+ue+" scn"),me.gState&&h.setGState(me.gState),ae(B),ae("Q")}},Gm=function(S){switch(S){case"f":case"F":return"W n";case"f*":return"W* n";case"B":return"W S";case"B*":return"W* S";case"S":return"W S";case"n":return"W n"}},of=h.moveTo=function(S,B){return ae(T(P(S))+" "+T(W(B))+" m"),this},dl=h.lineTo=function(S,B){return ae(T(P(S))+" "+T(W(B))+" l"),this},ao=h.curveTo=function(S,B,ue,me,_e,Oe){return ae([T(P(S)),T(W(B)),T(P(ue)),T(W(me)),T(P(_e)),T(W(Oe)),"c"].join(" ")),this};h.__private__.line=h.line=function(S,B,ue,me,_e){if(isNaN(S)||isNaN(B)||isNaN(ue)||isNaN(me)||!Xi(_e))throw new Error("Invalid arguments passed to jsPDF.line");return y===w.COMPAT?this.lines([[ue-S,me-B]],S,B,[1,1],_e||"S"):this.lines([[ue-S,me-B]],S,B,[1,1]).stroke()},h.__private__.lines=h.lines=function(S,B,ue,me,_e,Oe){var Ue,nt,ut,Nt,Et,Mt,_r,Cr,Wr,Cn,cn,xi;if(typeof S=="number"&&(xi=ue,ue=B,B=S,S=xi),me=me||[1,1],Oe=Oe||!1,isNaN(B)||isNaN(ue)||!Array.isArray(S)||!Array.isArray(me)||!Xi(_e)||typeof Oe!="boolean")throw new Error("Invalid arguments passed to jsPDF.lines");for(of(B,ue),Ue=me[0],nt=me[1],Nt=S.length,Cn=B,cn=ue,ut=0;ut<Nt;ut++)(Et=S[ut]).length===2?(Cn=Et[0]*Ue+Cn,cn=Et[1]*nt+cn,dl(Cn,cn)):(Mt=Et[0]*Ue+Cn,_r=Et[1]*nt+cn,Cr=Et[2]*Ue+Cn,Wr=Et[3]*nt+cn,Cn=Et[4]*Ue+Cn,cn=Et[5]*nt+cn,ao(Mt,_r,Cr,Wr,Cn,cn));return Oe&&Gh(),sf(_e),this},h.path=function(S){for(var B=0;B<S.length;B++){var ue=S[B],me=ue.c;switch(ue.op){case"m":of(me[0],me[1]);break;case"l":dl(me[0],me[1]);break;case"c":ao.apply(this,me);break;case"h":Gh()}}return this},h.__private__.rect=h.rect=function(S,B,ue,me,_e){if(isNaN(S)||isNaN(B)||isNaN(ue)||isNaN(me)||!Xi(_e))throw new Error("Invalid arguments passed to jsPDF.rect");return y===w.COMPAT&&(me=-me),ae([T(P(S)),T(W(B)),T(P(ue)),T(P(me)),"re"].join(" ")),sf(_e),this},h.__private__.triangle=h.triangle=function(S,B,ue,me,_e,Oe,Ue){if(isNaN(S)||isNaN(B)||isNaN(ue)||isNaN(me)||isNaN(_e)||isNaN(Oe)||!Xi(Ue))throw new Error("Invalid arguments passed to jsPDF.triangle");return this.lines([[ue-S,me-B],[_e-ue,Oe-me],[S-_e,B-Oe]],S,B,[1,1],Ue,!0),this},h.__private__.roundedRect=h.roundedRect=function(S,B,ue,me,_e,Oe,Ue){if(isNaN(S)||isNaN(B)||isNaN(ue)||isNaN(me)||isNaN(_e)||isNaN(Oe)||!Xi(Ue))throw new Error("Invalid arguments passed to jsPDF.roundedRect");var nt=4/3*(Math.SQRT2-1);return _e=Math.min(_e,.5*ue),Oe=Math.min(Oe,.5*me),this.lines([[ue-2*_e,0],[_e*nt,0,_e,Oe-Oe*nt,_e,Oe],[0,me-2*Oe],[0,Oe*nt,-_e*nt,Oe,-_e,Oe],[2*_e-ue,0],[-_e*nt,0,-_e,-Oe*nt,-_e,-Oe],[0,2*Oe-me],[0,-Oe*nt,_e*nt,-Oe,_e,-Oe]],S+_e,B,[1,1],Ue,!0),this},h.__private__.ellipse=h.ellipse=function(S,B,ue,me,_e){if(isNaN(S)||isNaN(B)||isNaN(ue)||isNaN(me)||!Xi(_e))throw new Error("Invalid arguments passed to jsPDF.ellipse");var Oe=4/3*(Math.SQRT2-1)*ue,Ue=4/3*(Math.SQRT2-1)*me;return of(S+ue,B),ao(S+ue,B-Ue,S+Oe,B-me,S,B-me),ao(S-Oe,B-me,S-ue,B-Ue,S-ue,B),ao(S-ue,B+Ue,S-Oe,B+me,S,B+me),ao(S+Oe,B+me,S+ue,B+Ue,S+ue,B),sf(_e),this},h.__private__.circle=h.circle=function(S,B,ue,me){if(isNaN(S)||isNaN(B)||isNaN(ue)||!Xi(me))throw new Error("Invalid arguments passed to jsPDF.circle");return this.ellipse(S,B,ue,ue,me)},h.setFont=function(S,B,ue){return ue&&(B=D(B,ue)),Ze=zh(S,B,{disableWarning:!1}),this};var Km=h.__private__.getFont=h.getFont=function(){return Kt[zh.apply(h,arguments)]};h.__private__.getFontList=h.getFontList=function(){var S,B,ue={};for(S in lr)if(lr.hasOwnProperty(S))for(B in ue[S]=[],lr[S])lr[S].hasOwnProperty(B)&&ue[S].push(B);return ue},h.addFont=function(S,B,ue,me,_e){var Oe=["StandardEncoding","MacRomanEncoding","Identity-H","WinAnsiEncoding"];return arguments[3]&&Oe.indexOf(arguments[3])!==-1?_e=arguments[3]:arguments[3]&&Oe.indexOf(arguments[3])==-1&&(ue=D(ue,me)),_e=_e||"Identity-H",rf.call(this,S,B,ue,_e)};var pl,lf=e.lineWidth||.200025,_c=h.__private__.getLineWidth=h.getLineWidth=function(){return lf},Kh=h.__private__.setLineWidth=h.setLineWidth=function(S){return lf=S,ae(T(P(S))+" w"),this};h.__private__.setLineDash=vt.API.setLineDash=vt.API.setLineDashPattern=function(S,B){if(S=S||[],B=B||0,isNaN(B)||!Array.isArray(S))throw new Error("Invalid arguments passed to jsPDF.setLineDash");return S=S.map(function(ue){return T(P(ue))}).join(" "),B=T(P(B)),ae("["+S+"] "+B+" d"),this};var Xh=h.__private__.getLineHeight=h.getLineHeight=function(){return qe*pl};h.__private__.getLineHeight=h.getLineHeight=function(){return qe*pl};var Yh=h.__private__.setLineHeightFactor=h.setLineHeightFactor=function(S){return typeof(S=S||1.15)=="number"&&(pl=S),this},Jh=h.__private__.getLineHeightFactor=h.getLineHeightFactor=function(){return pl};Yh(e.lineHeight);var Yi=h.__private__.getHorizontalCoordinate=function(S){return P(S)},bs=h.__private__.getVerticalCoordinate=function(S){return y===w.ADVANCED?S:_t[I].mediaBox.topRightY-_t[I].mediaBox.bottomLeftY-P(S)},Xm=h.__private__.getHorizontalCoordinateString=h.getHorizontalCoordinateString=function(S){return T(Yi(S))},io=h.__private__.getVerticalCoordinateString=h.getVerticalCoordinateString=function(S){return T(bs(S))},vi=e.strokeColor||"0 G";h.__private__.getStrokeColor=h.getDrawColor=function(){return oe(vi)},h.__private__.setStrokeColor=h.setDrawColor=function(S,B,ue,me){return vi=ce({ch1:S,ch2:B,ch3:ue,ch4:me,pdfColorType:"draw",precision:2}),ae(vi),this};var cf=e.fillColor||"0 g";h.__private__.getFillColor=h.getFillColor=function(){return oe(cf)},h.__private__.setFillColor=h.setFillColor=function(S,B,ue,me){return cf=ce({ch1:S,ch2:B,ch3:ue,ch4:me,pdfColorType:"fill",precision:2}),ae(cf),this};var ml=e.textColor||"0 g",Ym=h.__private__.getTextColor=h.getTextColor=function(){return oe(ml)};h.__private__.setTextColor=h.setTextColor=function(S,B,ue,me){return ml=ce({ch1:S,ch2:B,ch3:ue,ch4:me,pdfColorType:"text",precision:3}),this};var Sc=e.charSpace,Jm=h.__private__.getCharSpace=h.getCharSpace=function(){return parseFloat(Sc||0)};h.__private__.setCharSpace=h.setCharSpace=function(S){if(isNaN(S))throw new Error("Invalid argument passed to jsPDF.setCharSpace");return Sc=S,this};var uf=0;h.CapJoinStyles={0:0,butt:0,but:0,miter:0,1:1,round:1,rounded:1,circle:1,2:2,projecting:2,project:2,square:2,bevel:2},h.__private__.setLineCap=h.setLineCap=function(S){var B=h.CapJoinStyles[S];if(B===void 0)throw new Error("Line cap style of '"+S+"' is not recognized. See or extend .CapJoinStyles property for valid styles");return uf=B,ae(B+" J"),this};var ff=0;h.__private__.setLineJoin=h.setLineJoin=function(S){var B=h.CapJoinStyles[S];if(B===void 0)throw new Error("Line join style of '"+S+"' is not recognized. See or extend .CapJoinStyles property for valid styles");return ff=B,ae(B+" j"),this},h.__private__.setLineMiterLimit=h.__private__.setMiterLimit=h.setLineMiterLimit=h.setMiterLimit=function(S){if(S=S||0,isNaN(S))throw new Error("Invalid argument passed to jsPDF.setLineMiterLimit");return ae(T(P(S))+" M"),this},h.GState=O1,h.setGState=function(S){(S=typeof S=="string"?mr[ka[S]]:Qh(null,S)).equals(di)||(ae("/"+S.id+" gs"),di=S)};var Qh=function(S,B){if(!S||!ka[S]){var ue=!1;for(var me in mr)if(mr.hasOwnProperty(me)&&mr[me].equals(B)){ue=!0;break}if(ue)B=mr[me];else{var _e="GS"+(Object.keys(mr).length+1).toString(10);mr[_e]=B,B.id=_e}return S&&(ka[S]=B.id),Wt.publish("addGState",B),B}};h.addGState=function(S,B){return Qh(S,B),this},h.saveGraphicsState=function(){return ae("q"),$a.push({key:Ze,size:qe,color:ml}),this},h.restoreGraphicsState=function(){ae("Q");var S=$a.pop();return Ze=S.key,qe=S.size,ml=S.color,di=null,this},h.setCurrentTransformationMatrix=function(S){return ae(S.toString()+" cm"),this},h.comment=function(S){return ae("#"+S),this};var kc=function(S,B){var ue=S||0;Object.defineProperty(this,"x",{enumerable:!0,get:function(){return ue},set:function(Oe){isNaN(Oe)||(ue=parseFloat(Oe))}});var me=B||0;Object.defineProperty(this,"y",{enumerable:!0,get:function(){return me},set:function(Oe){isNaN(Oe)||(me=parseFloat(Oe))}});var _e="pt";return Object.defineProperty(this,"type",{enumerable:!0,get:function(){return _e},set:function(Oe){_e=Oe.toString()}}),this},hf=function(S,B,ue,me){kc.call(this,S,B),this.type="rect";var _e=ue||0;Object.defineProperty(this,"w",{enumerable:!0,get:function(){return _e},set:function(Ue){isNaN(Ue)||(_e=parseFloat(Ue))}});var Oe=me||0;return Object.defineProperty(this,"h",{enumerable:!0,get:function(){return Oe},set:function(Ue){isNaN(Ue)||(Oe=parseFloat(Ue))}}),this},df=function(){this.page=ir,this.currentPage=I,this.pages=Pe.slice(0),this.pagesContext=_t.slice(0),this.x=Jt,this.y=ht,this.matrix=Zr,this.width=gl(I),this.height=so(I),this.outputDestination=Ve,this.id="",this.objectNumber=-1};df.prototype.restore=function(){ir=this.page,I=this.currentPage,_t=this.pagesContext,Pe=this.pages,Jt=this.x,ht=this.y,Zr=this.matrix,pf(I,this.width),mf(I,this.height),Ve=this.outputDestination};var Zh=function(S,B,ue,me,_e){Ha.push(new df),ir=I=0,Pe=[],Jt=S,ht=B,Zr=_e,nf([ue,me])},Qm=function(S){if(za[S])Ha.pop().restore();else{var B=new df,ue="Xo"+(Object.keys(en).length+1).toString(10);B.id=ue,za[S]=ue,en[ue]=B,Wt.publish("addFormObject",B),Ha.pop().restore()}};for(var Ec in h.beginFormObject=function(S,B,ue,me,_e){return Zh(S,B,ue,me,_e),this},h.endFormObject=function(S){return Qm(S),this},h.doFormObject=function(S,B){var ue=en[za[S]];return ae("q"),ae(B.toString()+" cm"),ae("/"+ue.id+" Do"),ae("Q"),this},h.getFormObject=function(S){var B=en[za[S]];return{x:B.x,y:B.y,width:B.width,height:B.height,matrix:B.matrix}},h.save=function(S,B){return S=S||"generated.pdf",(B=B||{}).returnPromise=B.returnPromise||!1,B.returnPromise===!1?(Fl(yc(ws()),S),typeof Fl.unload=="function"&&xt.setTimeout&&setTimeout(Fl.unload,911),this):new Promise(function(ue,me){try{var _e=Fl(yc(ws()),S);typeof Fl.unload=="function"&&xt.setTimeout&&setTimeout(Fl.unload,911),ue(_e)}catch(Oe){me(Oe.message)}})},vt.API)vt.API.hasOwnProperty(Ec)&&(Ec==="events"&&vt.API.events.length?function(S,B){var ue,me,_e;for(_e=B.length-1;_e!==-1;_e--)ue=B[_e][0],me=B[_e][1],S.subscribe.apply(S,[ue].concat(typeof me=="function"?[me]:me))}(Wt,vt.API.events):h[Ec]=vt.API[Ec]);var gl=h.getPageWidth=function(S){return(_t[S=S||I].mediaBox.topRightX-_t[S].mediaBox.bottomLeftX)/ze},pf=h.setPageWidth=function(S,B){_t[S].mediaBox.topRightX=B*ze+_t[S].mediaBox.bottomLeftX},so=h.getPageHeight=function(S){return(_t[S=S||I].mediaBox.topRightY-_t[S].mediaBox.bottomLeftY)/ze},mf=h.setPageHeight=function(S,B){_t[S].mediaBox.topRightY=B*ze+_t[S].mediaBox.bottomLeftY};return h.internal={pdfEscape:ca,getStyle:qh,getFont:Km,getFontSize:Je,getCharSpace:Jm,getTextColor:Ym,getLineHeight:Xh,getLineHeightFactor:Jh,getLineWidth:_c,write:De,getHorizontalCoordinate:Yi,getVerticalCoordinate:bs,getCoordinateString:Xm,getVerticalCoordinateString:io,collections:{},newObject:Dr,newAdditionalObject:le,newObjectDeferred:Tr,newObjectDeferredBegin:z,getFilters:ke,putStream:Le,events:Wt,scaleFactor:ze,pageSize:{getWidth:function(){return gl(I)},setWidth:function(S){pf(I,S)},getHeight:function(){return so(I)},setHeight:function(S){mf(I,S)}},encryptionOptions:u,encryption:Tn,getEncryptor:$m,output:wc,getNumberOfPages:jm,pages:Pe,out:ae,f2:X,f3:N,getPageInfo:Wh,getPageInfoByObjId:St,getCurrentPageInfo:zm,getPDFVersion:m,Point:kc,Rectangle:hf,Matrix:dt,hasHotfix:Hh},Object.defineProperty(h.internal.pageSize,"width",{get:function(){return gl(I)},set:function(S){pf(I,S)},enumerable:!0,configurable:!0}),Object.defineProperty(h.internal.pageSize,"height",{get:function(){return so(I)},set:function(S){mf(I,S)},enumerable:!0,configurable:!0}),Im.call(h,Me),Ze="F1",Vh(a,r),Wt.publish("initialized"),h}Yc.prototype.lsbFirstWord=function(e){return String.fromCharCode(e>>0&255,e>>8&255,e>>16&255,e>>24&255)},Yc.prototype.toHexString=function(e){return e.split("").map(function(t){return("0"+(255&t.charCodeAt(0)).toString(16)).slice(-2)}).join("")},Yc.prototype.hexToBytes=function(e){for(var t=[],r=0;r<e.length;r+=2)t.push(String.fromCharCode(parseInt(e.substr(r,2),16)));return t.join("")},Yc.prototype.processOwnerPassword=function(e,t){return _x(bx(t).substr(0,5),e)},Yc.prototype.encryptor=function(e,t){var r=bx(this.encryptionKey+String.fromCharCode(255&e,e>>8&255,e>>16&255,255&t,t>>8&255)).substr(0,10);return function(n){return _x(r,n)}},O1.prototype.equals=function(e){var t,r="id,objectNumber,equals";if(!e||tr(e)!==tr(this))return!1;var n=0;for(t in this)if(!(r.indexOf(t)>=0)){if(this.hasOwnProperty(t)&&!e.hasOwnProperty(t)||this[t]!==e[t])return!1;n++}for(t in e)e.hasOwnProperty(t)&&r.indexOf(t)<0&&n--;return n===0},vt.API={events:[]},vt.version="3.0.1";var Pr=vt.API,R5=1,vc=function(e){return e.replace(/\\/g,"\\\\").replace(/\(/g,"\\(").replace(/\)/g,"\\)")},qc=function(e){return e.replace(/\\\\/g,"\\").replace(/\\\(/g,"(").replace(/\\\)/g,")")},Tt=function(e){return e.toFixed(2)},_o=function(e){return e.toFixed(5)};Pr.__acroform__={};var Sa=function(e,t){e.prototype=Object.create(t.prototype),e.prototype.constructor=e},v_=function(e){return e*R5},rs=function(e){var t=new CC,r=ot.internal.getHeight(e)||0,n=ot.internal.getWidth(e)||0;return t.BBox=[0,0,Number(Tt(n)),Number(Tt(r))],t},xX=Pr.__acroform__.setBit=function(e,t){if(e=e||0,t=t||0,isNaN(e)||isNaN(t))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.setBit");return e|=1<<t},yX=Pr.__acroform__.clearBit=function(e,t){if(e=e||0,t=t||0,isNaN(e)||isNaN(t))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.clearBit");return e&=~(1<<t)},wX=Pr.__acroform__.getBit=function(e,t){if(isNaN(e)||isNaN(t))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.getBit");return e&1<<t?1:0},Ur=Pr.__acroform__.getBitForPdf=function(e,t){if(isNaN(e)||isNaN(t))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.getBitForPdf");return wX(e,t-1)},Vr=Pr.__acroform__.setBitForPdf=function(e,t){if(isNaN(e)||isNaN(t))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.setBitForPdf");return xX(e,t-1)},$r=Pr.__acroform__.clearBitForPdf=function(e,t){if(isNaN(e)||isNaN(t))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.clearBitForPdf");return yX(e,t-1)},bX=Pr.__acroform__.calculateCoordinates=function(e,t){var r=t.internal.getHorizontalCoordinate,n=t.internal.getVerticalCoordinate,a=e[0],i=e[1],s=e[2],o=e[3],l={};return l.lowerLeft_X=r(a)||0,l.lowerLeft_Y=n(i+o)||0,l.upperRight_X=r(a+s)||0,l.upperRight_Y=n(i)||0,[Number(Tt(l.lowerLeft_X)),Number(Tt(l.lowerLeft_Y)),Number(Tt(l.upperRight_X)),Number(Tt(l.upperRight_Y))]},_X=function(e){if(e.appearanceStreamContent)return e.appearanceStreamContent;if(e.V||e.DV){var t=[],r=e._V||e.DV,n=Sx(e,r),a=e.scope.internal.getFont(e.fontName,e.fontStyle).id;t.push("/Tx BMC"),t.push("q"),t.push("BT"),t.push(e.scope.__private__.encodeColorString(e.color)),t.push("/"+a+" "+Tt(n.fontSize)+" Tf"),t.push("1 0 0 1 0 0 Tm"),t.push(n.text),t.push("ET"),t.push("Q"),t.push("EMC");var i=rs(e);return i.scope=e.scope,i.stream=t.join(`
`),i}},Sx=function(e,t){var r=e.fontSize===0?e.maxFontSize:e.fontSize,n={text:"",fontSize:""},a=(t=(t=t.substr(0,1)=="("?t.substr(1):t).substr(t.length-1)==")"?t.substr(0,t.length-1):t).split(" ");a=e.multiline?a.map(function(N){return N.split(`
`)}):a.map(function(N){return[N]});var i=r,s=ot.internal.getHeight(e)||0;s=s<0?-s:s;var o=ot.internal.getWidth(e)||0;o=o<0?-o:o;var l=function(N,P,J){if(N+1<a.length){var W=P+" "+a[N+1][0];return hp(W,e,J).width<=o-4}return!1};i++;e:for(;i>0;){t="",i--;var c,u,f=hp("3",e,i).height,p=e.multiline?s-i:(s-f)/2,h=p+=2,g=0,m=0,b=0;if(i<=0){t=`(...) Tj
`,t+="% Width of Text: "+hp(t,e,i=12).width+", FieldWidth:"+o+`
`;break}for(var x="",w=0,y=0;y<a.length;y++)if(a.hasOwnProperty(y)){var A=!1;if(a[y].length!==1&&b!==a[y].length-1){if((f+2)*(w+2)+2>s)continue e;x+=a[y][b],A=!0,m=y,y--}else{x=(x+=a[y][b]+" ").substr(x.length-1)==" "?x.substr(0,x.length-1):x;var L=parseInt(y),D=l(L,x,i),T=y>=a.length-1;if(D&&!T){x+=" ",b=0;continue}if(D||T){if(T)m=L;else if(e.multiline&&(f+2)*(w+2)+2>s)continue e}else{if(!e.multiline||(f+2)*(w+2)+2>s)continue e;m=L}}for(var F="",R=g;R<=m;R++){var X=a[R];if(e.multiline){if(R===m){F+=X[b]+" ",b=(b+1)%X.length;continue}if(R===g){F+=X[X.length-1]+" ";continue}}F+=X[0]+" "}switch(F=F.substr(F.length-1)==" "?F.substr(0,F.length-1):F,u=hp(F,e,i).width,e.textAlign){case"right":c=o-u-2;break;case"center":c=(o-u)/2;break;case"left":default:c=2}t+=Tt(c)+" "+Tt(h)+` Td
`,t+="("+vc(F)+`) Tj
`,t+=-Tt(c)+` 0 Td
`,h=-(i+2),u=0,g=A?m:m+1,w++,x=""}break}return n.text=t,n.fontSize=i,n},hp=function(e,t,r){var n=t.scope.internal.getFont(t.fontName,t.fontStyle),a=t.scope.getStringUnitWidth(e,{font:n,fontSize:parseFloat(r),charSpace:0})*parseFloat(r);return{height:t.scope.getStringUnitWidth("3",{font:n,fontSize:parseFloat(r),charSpace:0})*parseFloat(r)*1.5,width:a}},SX={fields:[],xForms:[],acroFormDictionaryRoot:null,printedOut:!1,internal:null,isInitialized:!1},kX=function(e,t){var r={type:"reference",object:e};t.internal.getPageInfo(e.page).pageContext.annotations.find(function(n){return n.type===r.type&&n.object===r.object})===void 0&&t.internal.getPageInfo(e.page).pageContext.annotations.push(r)},EX=function(e,t){for(var r in e)if(e.hasOwnProperty(r)){var n=r,a=e[r];t.internal.newObjectDeferredBegin(a.objId,!0),tr(a)==="object"&&typeof a.putStream=="function"&&a.putStream(),delete e[n]}},AX=function(e,t){if(t.scope=e,e.internal!==void 0&&(e.internal.acroformPlugin===void 0||e.internal.acroformPlugin.isInitialized===!1)){if(Hi.FieldNum=0,e.internal.acroformPlugin=JSON.parse(JSON.stringify(SX)),e.internal.acroformPlugin.acroFormDictionaryRoot)throw new Error("Exception while creating AcroformDictionary");R5=e.internal.scaleFactor,e.internal.acroformPlugin.acroFormDictionaryRoot=new NC,e.internal.acroformPlugin.acroFormDictionaryRoot.scope=e,e.internal.acroformPlugin.acroFormDictionaryRoot._eventID=e.internal.events.subscribe("postPutResources",function(){(function(r){r.internal.events.unsubscribe(r.internal.acroformPlugin.acroFormDictionaryRoot._eventID),delete r.internal.acroformPlugin.acroFormDictionaryRoot._eventID,r.internal.acroformPlugin.printedOut=!0})(e)}),e.internal.events.subscribe("buildDocument",function(){(function(r){r.internal.acroformPlugin.acroFormDictionaryRoot.objId=void 0;var n=r.internal.acroformPlugin.acroFormDictionaryRoot.Fields;for(var a in n)if(n.hasOwnProperty(a)){var i=n[a];i.objId=void 0,i.hasAnnotation&&kX(i,r)}})(e)}),e.internal.events.subscribe("putCatalog",function(){(function(r){if(r.internal.acroformPlugin.acroFormDictionaryRoot===void 0)throw new Error("putCatalogCallback: Root missing.");r.internal.write("/AcroForm "+r.internal.acroformPlugin.acroFormDictionaryRoot.objId+" 0 R")})(e)}),e.internal.events.subscribe("postPutPages",function(r){(function(n,a){var i=!n;for(var s in n||(a.internal.newObjectDeferredBegin(a.internal.acroformPlugin.acroFormDictionaryRoot.objId,!0),a.internal.acroformPlugin.acroFormDictionaryRoot.putStream()),n=n||a.internal.acroformPlugin.acroFormDictionaryRoot.Kids)if(n.hasOwnProperty(s)){var o=n[s],l=[],c=o.Rect;if(o.Rect&&(o.Rect=bX(o.Rect,a)),a.internal.newObjectDeferredBegin(o.objId,!0),o.DA=ot.createDefaultAppearanceStream(o),tr(o)==="object"&&typeof o.getKeyValueListForStream=="function"&&(l=o.getKeyValueListForStream()),o.Rect=c,o.hasAppearanceStream&&!o.appearanceStreamContent){var u=_X(o);l.push({key:"AP",value:"<</N "+u+">>"}),a.internal.acroformPlugin.xForms.push(u)}if(o.appearanceStreamContent){var f="";for(var p in o.appearanceStreamContent)if(o.appearanceStreamContent.hasOwnProperty(p)){var h=o.appearanceStreamContent[p];if(f+="/"+p+" ",f+="<<",Object.keys(h).length>=1||Array.isArray(h)){for(var s in h)if(h.hasOwnProperty(s)){var g=h[s];typeof g=="function"&&(g=g.call(a,o)),f+="/"+s+" "+g+" ",a.internal.acroformPlugin.xForms.indexOf(g)>=0||a.internal.acroformPlugin.xForms.push(g)}}else typeof(g=h)=="function"&&(g=g.call(a,o)),f+="/"+s+" "+g,a.internal.acroformPlugin.xForms.indexOf(g)>=0||a.internal.acroformPlugin.xForms.push(g);f+=">>"}l.push({key:"AP",value:`<<
`+f+">>"})}a.internal.putStream({additionalKeyValues:l,objectId:o.objId}),a.internal.out("endobj")}i&&EX(a.internal.acroformPlugin.xForms,a)})(r,e)}),e.internal.acroformPlugin.isInitialized=!0}},TC=Pr.__acroform__.arrayToPdfArray=function(e,t,r){var n=function(s){return s};if(Array.isArray(e)){for(var a="[",i=0;i<e.length;i++)switch(i!==0&&(a+=" "),tr(e[i])){case"boolean":case"number":case"object":a+=e[i].toString();break;case"string":e[i].substr(0,1)!=="/"?(t!==void 0&&r&&(n=r.internal.getEncryptor(t)),a+="("+vc(n(e[i].toString()))+")"):a+=e[i].toString()}return a+="]"}throw new Error("Invalid argument passed to jsPDF.__acroform__.arrayToPdfArray")},C2=function(e,t,r){var n=function(a){return a};return t!==void 0&&r&&(n=r.internal.getEncryptor(t)),(e=e||"").toString(),e="("+vc(n(e))+")"},ss=function(){this._objId=void 0,this._scope=void 0,Object.defineProperty(this,"objId",{get:function(){if(this._objId===void 0){if(this.scope===void 0)return;this._objId=this.scope.internal.newObjectDeferred()}return this._objId},set:function(e){this._objId=e}}),Object.defineProperty(this,"scope",{value:this._scope,writable:!0})};ss.prototype.toString=function(){return this.objId+" 0 R"},ss.prototype.putStream=function(){var e=this.getKeyValueListForStream();this.scope.internal.putStream({data:this.stream,additionalKeyValues:e,objectId:this.objId}),this.scope.internal.out("endobj")},ss.prototype.getKeyValueListForStream=function(){var e=[],t=Object.getOwnPropertyNames(this).filter(function(i){return i!="content"&&i!="appearanceStreamContent"&&i!="scope"&&i!="objId"&&i.substring(0,1)!="_"});for(var r in t)if(Object.getOwnPropertyDescriptor(this,t[r]).configurable===!1){var n=t[r],a=this[n];a&&(Array.isArray(a)?e.push({key:n,value:TC(a,this.objId,this.scope)}):a instanceof ss?(a.scope=this.scope,e.push({key:n,value:a.objId+" 0 R"})):typeof a!="function"&&e.push({key:n,value:a}))}return e};var CC=function(){ss.call(this),Object.defineProperty(this,"Type",{value:"/XObject",configurable:!1,writable:!0}),Object.defineProperty(this,"Subtype",{value:"/Form",configurable:!1,writable:!0}),Object.defineProperty(this,"FormType",{value:1,configurable:!1,writable:!0});var e,t=[];Object.defineProperty(this,"BBox",{configurable:!1,get:function(){return t},set:function(r){t=r}}),Object.defineProperty(this,"Resources",{value:"2 0 R",configurable:!1,writable:!0}),Object.defineProperty(this,"stream",{enumerable:!1,configurable:!0,set:function(r){e=r.trim()},get:function(){return e||null}})};Sa(CC,ss);var NC=function(){ss.call(this);var e,t=[];Object.defineProperty(this,"Kids",{enumerable:!1,configurable:!0,get:function(){return t.length>0?t:void 0}}),Object.defineProperty(this,"Fields",{enumerable:!1,configurable:!1,get:function(){return t}}),Object.defineProperty(this,"DA",{enumerable:!1,configurable:!1,get:function(){if(e){var r=function(n){return n};return this.scope&&(r=this.scope.internal.getEncryptor(this.objId)),"("+vc(r(e))+")"}},set:function(r){e=r}})};Sa(NC,ss);var Hi=function e(){ss.call(this);var t=4;Object.defineProperty(this,"F",{enumerable:!1,configurable:!1,get:function(){return t},set:function(x){if(isNaN(x))throw new Error('Invalid value "'+x+'" for attribute F supplied.');t=x}}),Object.defineProperty(this,"showWhenPrinted",{enumerable:!0,configurable:!0,get:function(){return!!Ur(t,3)},set:function(x){x?this.F=Vr(t,3):this.F=$r(t,3)}});var r=0;Object.defineProperty(this,"Ff",{enumerable:!1,configurable:!1,get:function(){return r},set:function(x){if(isNaN(x))throw new Error('Invalid value "'+x+'" for attribute Ff supplied.');r=x}});var n=[];Object.defineProperty(this,"Rect",{enumerable:!1,configurable:!1,get:function(){if(n.length!==0)return n},set:function(x){n=x!==void 0?x:[]}}),Object.defineProperty(this,"x",{enumerable:!0,configurable:!0,get:function(){return!n||isNaN(n[0])?0:n[0]},set:function(x){n[0]=x}}),Object.defineProperty(this,"y",{enumerable:!0,configurable:!0,get:function(){return!n||isNaN(n[1])?0:n[1]},set:function(x){n[1]=x}}),Object.defineProperty(this,"width",{enumerable:!0,configurable:!0,get:function(){return!n||isNaN(n[2])?0:n[2]},set:function(x){n[2]=x}}),Object.defineProperty(this,"height",{enumerable:!0,configurable:!0,get:function(){return!n||isNaN(n[3])?0:n[3]},set:function(x){n[3]=x}});var a="";Object.defineProperty(this,"FT",{enumerable:!0,configurable:!1,get:function(){return a},set:function(x){switch(x){case"/Btn":case"/Tx":case"/Ch":case"/Sig":a=x;break;default:throw new Error('Invalid value "'+x+'" for attribute FT supplied.')}}});var i=null;Object.defineProperty(this,"T",{enumerable:!0,configurable:!1,get:function(){if(!i||i.length<1){if(this instanceof D1)return;i="FieldObject"+e.FieldNum++}var x=function(w){return w};return this.scope&&(x=this.scope.internal.getEncryptor(this.objId)),"("+vc(x(i))+")"},set:function(x){i=x.toString()}}),Object.defineProperty(this,"fieldName",{configurable:!0,enumerable:!0,get:function(){return i},set:function(x){i=x}});var s="helvetica";Object.defineProperty(this,"fontName",{enumerable:!0,configurable:!0,get:function(){return s},set:function(x){s=x}});var o="normal";Object.defineProperty(this,"fontStyle",{enumerable:!0,configurable:!0,get:function(){return o},set:function(x){o=x}});var l=0;Object.defineProperty(this,"fontSize",{enumerable:!0,configurable:!0,get:function(){return l},set:function(x){l=x}});var c=void 0;Object.defineProperty(this,"maxFontSize",{enumerable:!0,configurable:!0,get:function(){return c===void 0?50/R5:c},set:function(x){c=x}});var u="black";Object.defineProperty(this,"color",{enumerable:!0,configurable:!0,get:function(){return u},set:function(x){u=x}});var f="/F1 0 Tf 0 g";Object.defineProperty(this,"DA",{enumerable:!0,configurable:!1,get:function(){if(!(!f||this instanceof D1||this instanceof Kl))return C2(f,this.objId,this.scope)},set:function(x){x=x.toString(),f=x}});var p=null;Object.defineProperty(this,"DV",{enumerable:!1,configurable:!1,get:function(){if(p)return this instanceof mn?p:C2(p,this.objId,this.scope)},set:function(x){x=x.toString(),p=this instanceof mn?x:x.substr(0,1)==="("?qc(x.substr(1,x.length-2)):qc(x)}}),Object.defineProperty(this,"defaultValue",{enumerable:!0,configurable:!0,get:function(){return this instanceof mn?qc(p.substr(1,p.length-1)):p},set:function(x){x=x.toString(),p=this instanceof mn?"/"+x:x}});var h=null;Object.defineProperty(this,"_V",{enumerable:!1,configurable:!1,get:function(){if(h)return h},set:function(x){this.V=x}}),Object.defineProperty(this,"V",{enumerable:!1,configurable:!1,get:function(){if(h)return this instanceof mn?h:C2(h,this.objId,this.scope)},set:function(x){x=x.toString(),h=this instanceof mn?x:x.substr(0,1)==="("?qc(x.substr(1,x.length-2)):qc(x)}}),Object.defineProperty(this,"value",{enumerable:!0,configurable:!0,get:function(){return this instanceof mn?qc(h.substr(1,h.length-1)):h},set:function(x){x=x.toString(),h=this instanceof mn?"/"+x:x}}),Object.defineProperty(this,"hasAnnotation",{enumerable:!0,configurable:!0,get:function(){return this.Rect}}),Object.defineProperty(this,"Type",{enumerable:!0,configurable:!1,get:function(){return this.hasAnnotation?"/Annot":null}}),Object.defineProperty(this,"Subtype",{enumerable:!0,configurable:!1,get:function(){return this.hasAnnotation?"/Widget":null}});var g,m=!1;Object.defineProperty(this,"hasAppearanceStream",{enumerable:!0,configurable:!0,get:function(){return m},set:function(x){x=!!x,m=x}}),Object.defineProperty(this,"page",{enumerable:!0,configurable:!0,get:function(){if(g)return g},set:function(x){g=x}}),Object.defineProperty(this,"readOnly",{enumerable:!0,configurable:!0,get:function(){return!!Ur(this.Ff,1)},set:function(x){x?this.Ff=Vr(this.Ff,1):this.Ff=$r(this.Ff,1)}}),Object.defineProperty(this,"required",{enumerable:!0,configurable:!0,get:function(){return!!Ur(this.Ff,2)},set:function(x){x?this.Ff=Vr(this.Ff,2):this.Ff=$r(this.Ff,2)}}),Object.defineProperty(this,"noExport",{enumerable:!0,configurable:!0,get:function(){return!!Ur(this.Ff,3)},set:function(x){x?this.Ff=Vr(this.Ff,3):this.Ff=$r(this.Ff,3)}});var b=null;Object.defineProperty(this,"Q",{enumerable:!0,configurable:!1,get:function(){if(b!==null)return b},set:function(x){if([0,1,2].indexOf(x)===-1)throw new Error('Invalid value "'+x+'" for attribute Q supplied.');b=x}}),Object.defineProperty(this,"textAlign",{get:function(){var x;switch(b){case 0:default:x="left";break;case 1:x="center";break;case 2:x="right"}return x},configurable:!0,enumerable:!0,set:function(x){switch(x){case"right":case 2:b=2;break;case"center":case 1:b=1;break;case"left":case 0:default:b=0}}})};Sa(Hi,ss);var Au=function(){Hi.call(this),this.FT="/Ch",this.V="()",this.fontName="zapfdingbats";var e=0;Object.defineProperty(this,"TI",{enumerable:!0,configurable:!1,get:function(){return e},set:function(r){e=r}}),Object.defineProperty(this,"topIndex",{enumerable:!0,configurable:!0,get:function(){return e},set:function(r){e=r}});var t=[];Object.defineProperty(this,"Opt",{enumerable:!0,configurable:!1,get:function(){return TC(t,this.objId,this.scope)},set:function(r){var n,a;a=[],typeof(n=r)=="string"&&(a=function(i,s,o){o||(o=1);for(var l,c=[];l=s.exec(i);)c.push(l[o]);return c}(n,/\((.*?)\)/g)),t=a}}),this.getOptions=function(){return t},this.setOptions=function(r){t=r,this.sort&&t.sort()},this.addOption=function(r){r=(r=r||"").toString(),t.push(r),this.sort&&t.sort()},this.removeOption=function(r,n){for(n=n||!1,r=(r=r||"").toString();t.indexOf(r)!==-1&&(t.splice(t.indexOf(r),1),n!==!1););},Object.defineProperty(this,"combo",{enumerable:!0,configurable:!0,get:function(){return!!Ur(this.Ff,18)},set:function(r){r?this.Ff=Vr(this.Ff,18):this.Ff=$r(this.Ff,18)}}),Object.defineProperty(this,"edit",{enumerable:!0,configurable:!0,get:function(){return!!Ur(this.Ff,19)},set:function(r){this.combo===!0&&(r?this.Ff=Vr(this.Ff,19):this.Ff=$r(this.Ff,19))}}),Object.defineProperty(this,"sort",{enumerable:!0,configurable:!0,get:function(){return!!Ur(this.Ff,20)},set:function(r){r?(this.Ff=Vr(this.Ff,20),t.sort()):this.Ff=$r(this.Ff,20)}}),Object.defineProperty(this,"multiSelect",{enumerable:!0,configurable:!0,get:function(){return!!Ur(this.Ff,22)},set:function(r){r?this.Ff=Vr(this.Ff,22):this.Ff=$r(this.Ff,22)}}),Object.defineProperty(this,"doNotSpellCheck",{enumerable:!0,configurable:!0,get:function(){return!!Ur(this.Ff,23)},set:function(r){r?this.Ff=Vr(this.Ff,23):this.Ff=$r(this.Ff,23)}}),Object.defineProperty(this,"commitOnSelChange",{enumerable:!0,configurable:!0,get:function(){return!!Ur(this.Ff,27)},set:function(r){r?this.Ff=Vr(this.Ff,27):this.Ff=$r(this.Ff,27)}}),this.hasAppearanceStream=!1};Sa(Au,Hi);var Tu=function(){Au.call(this),this.fontName="helvetica",this.combo=!1};Sa(Tu,Au);var Cu=function(){Tu.call(this),this.combo=!0};Sa(Cu,Tu);var Fp=function(){Cu.call(this),this.edit=!0};Sa(Fp,Cu);var mn=function(){Hi.call(this),this.FT="/Btn",Object.defineProperty(this,"noToggleToOff",{enumerable:!0,configurable:!0,get:function(){return!!Ur(this.Ff,15)},set:function(r){r?this.Ff=Vr(this.Ff,15):this.Ff=$r(this.Ff,15)}}),Object.defineProperty(this,"radio",{enumerable:!0,configurable:!0,get:function(){return!!Ur(this.Ff,16)},set:function(r){r?this.Ff=Vr(this.Ff,16):this.Ff=$r(this.Ff,16)}}),Object.defineProperty(this,"pushButton",{enumerable:!0,configurable:!0,get:function(){return!!Ur(this.Ff,17)},set:function(r){r?this.Ff=Vr(this.Ff,17):this.Ff=$r(this.Ff,17)}}),Object.defineProperty(this,"radioIsUnison",{enumerable:!0,configurable:!0,get:function(){return!!Ur(this.Ff,26)},set:function(r){r?this.Ff=Vr(this.Ff,26):this.Ff=$r(this.Ff,26)}});var e,t={};Object.defineProperty(this,"MK",{enumerable:!1,configurable:!1,get:function(){var r=function(i){return i};if(this.scope&&(r=this.scope.internal.getEncryptor(this.objId)),Object.keys(t).length!==0){var n,a=[];for(n in a.push("<<"),t)a.push("/"+n+" ("+vc(r(t[n]))+")");return a.push(">>"),a.join(`
`)}},set:function(r){tr(r)==="object"&&(t=r)}}),Object.defineProperty(this,"caption",{enumerable:!0,configurable:!0,get:function(){return t.CA||""},set:function(r){typeof r=="string"&&(t.CA=r)}}),Object.defineProperty(this,"AS",{enumerable:!1,configurable:!1,get:function(){return e},set:function(r){e=r}}),Object.defineProperty(this,"appearanceState",{enumerable:!0,configurable:!0,get:function(){return e.substr(1,e.length-1)},set:function(r){e="/"+r}})};Sa(mn,Hi);var Op=function(){mn.call(this),this.pushButton=!0};Sa(Op,mn);var Nu=function(){mn.call(this),this.radio=!0,this.pushButton=!1;var e=[];Object.defineProperty(this,"Kids",{enumerable:!0,configurable:!1,get:function(){return e},set:function(t){e=t!==void 0?t:[]}})};Sa(Nu,mn);var D1=function(){var e,t;Hi.call(this),Object.defineProperty(this,"Parent",{enumerable:!1,configurable:!1,get:function(){return e},set:function(a){e=a}}),Object.defineProperty(this,"optionName",{enumerable:!1,configurable:!0,get:function(){return t},set:function(a){t=a}});var r,n={};Object.defineProperty(this,"MK",{enumerable:!1,configurable:!1,get:function(){var a=function(o){return o};this.scope&&(a=this.scope.internal.getEncryptor(this.objId));var i,s=[];for(i in s.push("<<"),n)s.push("/"+i+" ("+vc(a(n[i]))+")");return s.push(">>"),s.join(`
`)},set:function(a){tr(a)==="object"&&(n=a)}}),Object.defineProperty(this,"caption",{enumerable:!0,configurable:!0,get:function(){return n.CA||""},set:function(a){typeof a=="string"&&(n.CA=a)}}),Object.defineProperty(this,"AS",{enumerable:!1,configurable:!1,get:function(){return r},set:function(a){r=a}}),Object.defineProperty(this,"appearanceState",{enumerable:!0,configurable:!0,get:function(){return r.substr(1,r.length-1)},set:function(a){r="/"+a}}),this.caption="l",this.appearanceState="Off",this._AppearanceType=ot.RadioButton.Circle,this.appearanceStreamContent=this._AppearanceType.createAppearanceStream(this.optionName)};Sa(D1,Hi),Nu.prototype.setAppearance=function(e){if(!("createAppearanceStream"in e)||!("getCA"in e))throw new Error("Couldn't assign Appearance to RadioButton. Appearance was Invalid!");for(var t in this.Kids)if(this.Kids.hasOwnProperty(t)){var r=this.Kids[t];r.appearanceStreamContent=e.createAppearanceStream(r.optionName),r.caption=e.getCA()}},Nu.prototype.createOption=function(e){var t=new D1;return t.Parent=this,t.optionName=e,this.Kids.push(t),TX.call(this.scope,t),t};var Dp=function(){mn.call(this),this.fontName="zapfdingbats",this.caption="3",this.appearanceState="On",this.value="On",this.textAlign="center",this.appearanceStreamContent=ot.CheckBox.createAppearanceStream()};Sa(Dp,mn);var Kl=function(){Hi.call(this),this.FT="/Tx",Object.defineProperty(this,"multiline",{enumerable:!0,configurable:!0,get:function(){return!!Ur(this.Ff,13)},set:function(t){t?this.Ff=Vr(this.Ff,13):this.Ff=$r(this.Ff,13)}}),Object.defineProperty(this,"fileSelect",{enumerable:!0,configurable:!0,get:function(){return!!Ur(this.Ff,21)},set:function(t){t?this.Ff=Vr(this.Ff,21):this.Ff=$r(this.Ff,21)}}),Object.defineProperty(this,"doNotSpellCheck",{enumerable:!0,configurable:!0,get:function(){return!!Ur(this.Ff,23)},set:function(t){t?this.Ff=Vr(this.Ff,23):this.Ff=$r(this.Ff,23)}}),Object.defineProperty(this,"doNotScroll",{enumerable:!0,configurable:!0,get:function(){return!!Ur(this.Ff,24)},set:function(t){t?this.Ff=Vr(this.Ff,24):this.Ff=$r(this.Ff,24)}}),Object.defineProperty(this,"comb",{enumerable:!0,configurable:!0,get:function(){return!!Ur(this.Ff,25)},set:function(t){t?this.Ff=Vr(this.Ff,25):this.Ff=$r(this.Ff,25)}}),Object.defineProperty(this,"richText",{enumerable:!0,configurable:!0,get:function(){return!!Ur(this.Ff,26)},set:function(t){t?this.Ff=Vr(this.Ff,26):this.Ff=$r(this.Ff,26)}});var e=null;Object.defineProperty(this,"MaxLen",{enumerable:!0,configurable:!1,get:function(){return e},set:function(t){e=t}}),Object.defineProperty(this,"maxLength",{enumerable:!0,configurable:!0,get:function(){return e},set:function(t){Number.isInteger(t)&&(e=t)}}),Object.defineProperty(this,"hasAppearanceStream",{enumerable:!0,configurable:!0,get:function(){return this.V||this.DV}})};Sa(Kl,Hi);var Ip=function(){Kl.call(this),Object.defineProperty(this,"password",{enumerable:!0,configurable:!0,get:function(){return!!Ur(this.Ff,14)},set:function(e){e?this.Ff=Vr(this.Ff,14):this.Ff=$r(this.Ff,14)}}),this.password=!0};Sa(Ip,Kl);var ot={CheckBox:{createAppearanceStream:function(){return{N:{On:ot.CheckBox.YesNormal},D:{On:ot.CheckBox.YesPushDown,Off:ot.CheckBox.OffPushDown}}},YesPushDown:function(e){var t=rs(e);t.scope=e.scope;var r=[],n=e.scope.internal.getFont(e.fontName,e.fontStyle).id,a=e.scope.__private__.encodeColorString(e.color),i=Sx(e,e.caption);return r.push("0.749023 g"),r.push("0 0 "+Tt(ot.internal.getWidth(e))+" "+Tt(ot.internal.getHeight(e))+" re"),r.push("f"),r.push("BMC"),r.push("q"),r.push("0 0 1 rg"),r.push("/"+n+" "+Tt(i.fontSize)+" Tf "+a),r.push("BT"),r.push(i.text),r.push("ET"),r.push("Q"),r.push("EMC"),t.stream=r.join(`
`),t},YesNormal:function(e){var t=rs(e);t.scope=e.scope;var r=e.scope.internal.getFont(e.fontName,e.fontStyle).id,n=e.scope.__private__.encodeColorString(e.color),a=[],i=ot.internal.getHeight(e),s=ot.internal.getWidth(e),o=Sx(e,e.caption);return a.push("1 g"),a.push("0 0 "+Tt(s)+" "+Tt(i)+" re"),a.push("f"),a.push("q"),a.push("0 0 1 rg"),a.push("0 0 "+Tt(s-1)+" "+Tt(i-1)+" re"),a.push("W"),a.push("n"),a.push("0 g"),a.push("BT"),a.push("/"+r+" "+Tt(o.fontSize)+" Tf "+n),a.push(o.text),a.push("ET"),a.push("Q"),t.stream=a.join(`
`),t},OffPushDown:function(e){var t=rs(e);t.scope=e.scope;var r=[];return r.push("0.749023 g"),r.push("0 0 "+Tt(ot.internal.getWidth(e))+" "+Tt(ot.internal.getHeight(e))+" re"),r.push("f"),t.stream=r.join(`
`),t}},RadioButton:{Circle:{createAppearanceStream:function(e){var t={D:{Off:ot.RadioButton.Circle.OffPushDown},N:{}};return t.N[e]=ot.RadioButton.Circle.YesNormal,t.D[e]=ot.RadioButton.Circle.YesPushDown,t},getCA:function(){return"l"},YesNormal:function(e){var t=rs(e);t.scope=e.scope;var r=[],n=ot.internal.getWidth(e)<=ot.internal.getHeight(e)?ot.internal.getWidth(e)/4:ot.internal.getHeight(e)/4;n=Number((.9*n).toFixed(5));var a=ot.internal.Bezier_C,i=Number((n*a).toFixed(5));return r.push("q"),r.push("1 0 0 1 "+_o(ot.internal.getWidth(e)/2)+" "+_o(ot.internal.getHeight(e)/2)+" cm"),r.push(n+" 0 m"),r.push(n+" "+i+" "+i+" "+n+" 0 "+n+" c"),r.push("-"+i+" "+n+" -"+n+" "+i+" -"+n+" 0 c"),r.push("-"+n+" -"+i+" -"+i+" -"+n+" 0 -"+n+" c"),r.push(i+" -"+n+" "+n+" -"+i+" "+n+" 0 c"),r.push("f"),r.push("Q"),t.stream=r.join(`
`),t},YesPushDown:function(e){var t=rs(e);t.scope=e.scope;var r=[],n=ot.internal.getWidth(e)<=ot.internal.getHeight(e)?ot.internal.getWidth(e)/4:ot.internal.getHeight(e)/4;n=Number((.9*n).toFixed(5));var a=Number((2*n).toFixed(5)),i=Number((a*ot.internal.Bezier_C).toFixed(5)),s=Number((n*ot.internal.Bezier_C).toFixed(5));return r.push("0.749023 g"),r.push("q"),r.push("1 0 0 1 "+_o(ot.internal.getWidth(e)/2)+" "+_o(ot.internal.getHeight(e)/2)+" cm"),r.push(a+" 0 m"),r.push(a+" "+i+" "+i+" "+a+" 0 "+a+" c"),r.push("-"+i+" "+a+" -"+a+" "+i+" -"+a+" 0 c"),r.push("-"+a+" -"+i+" -"+i+" -"+a+" 0 -"+a+" c"),r.push(i+" -"+a+" "+a+" -"+i+" "+a+" 0 c"),r.push("f"),r.push("Q"),r.push("0 g"),r.push("q"),r.push("1 0 0 1 "+_o(ot.internal.getWidth(e)/2)+" "+_o(ot.internal.getHeight(e)/2)+" cm"),r.push(n+" 0 m"),r.push(n+" "+s+" "+s+" "+n+" 0 "+n+" c"),r.push("-"+s+" "+n+" -"+n+" "+s+" -"+n+" 0 c"),r.push("-"+n+" -"+s+" -"+s+" -"+n+" 0 -"+n+" c"),r.push(s+" -"+n+" "+n+" -"+s+" "+n+" 0 c"),r.push("f"),r.push("Q"),t.stream=r.join(`
`),t},OffPushDown:function(e){var t=rs(e);t.scope=e.scope;var r=[],n=ot.internal.getWidth(e)<=ot.internal.getHeight(e)?ot.internal.getWidth(e)/4:ot.internal.getHeight(e)/4;n=Number((.9*n).toFixed(5));var a=Number((2*n).toFixed(5)),i=Number((a*ot.internal.Bezier_C).toFixed(5));return r.push("0.749023 g"),r.push("q"),r.push("1 0 0 1 "+_o(ot.internal.getWidth(e)/2)+" "+_o(ot.internal.getHeight(e)/2)+" cm"),r.push(a+" 0 m"),r.push(a+" "+i+" "+i+" "+a+" 0 "+a+" c"),r.push("-"+i+" "+a+" -"+a+" "+i+" -"+a+" 0 c"),r.push("-"+a+" -"+i+" -"+i+" -"+a+" 0 -"+a+" c"),r.push(i+" -"+a+" "+a+" -"+i+" "+a+" 0 c"),r.push("f"),r.push("Q"),t.stream=r.join(`
`),t}},Cross:{createAppearanceStream:function(e){var t={D:{Off:ot.RadioButton.Cross.OffPushDown},N:{}};return t.N[e]=ot.RadioButton.Cross.YesNormal,t.D[e]=ot.RadioButton.Cross.YesPushDown,t},getCA:function(){return"8"},YesNormal:function(e){var t=rs(e);t.scope=e.scope;var r=[],n=ot.internal.calculateCross(e);return r.push("q"),r.push("1 1 "+Tt(ot.internal.getWidth(e)-2)+" "+Tt(ot.internal.getHeight(e)-2)+" re"),r.push("W"),r.push("n"),r.push(Tt(n.x1.x)+" "+Tt(n.x1.y)+" m"),r.push(Tt(n.x2.x)+" "+Tt(n.x2.y)+" l"),r.push(Tt(n.x4.x)+" "+Tt(n.x4.y)+" m"),r.push(Tt(n.x3.x)+" "+Tt(n.x3.y)+" l"),r.push("s"),r.push("Q"),t.stream=r.join(`
`),t},YesPushDown:function(e){var t=rs(e);t.scope=e.scope;var r=ot.internal.calculateCross(e),n=[];return n.push("0.749023 g"),n.push("0 0 "+Tt(ot.internal.getWidth(e))+" "+Tt(ot.internal.getHeight(e))+" re"),n.push("f"),n.push("q"),n.push("1 1 "+Tt(ot.internal.getWidth(e)-2)+" "+Tt(ot.internal.getHeight(e)-2)+" re"),n.push("W"),n.push("n"),n.push(Tt(r.x1.x)+" "+Tt(r.x1.y)+" m"),n.push(Tt(r.x2.x)+" "+Tt(r.x2.y)+" l"),n.push(Tt(r.x4.x)+" "+Tt(r.x4.y)+" m"),n.push(Tt(r.x3.x)+" "+Tt(r.x3.y)+" l"),n.push("s"),n.push("Q"),t.stream=n.join(`
`),t},OffPushDown:function(e){var t=rs(e);t.scope=e.scope;var r=[];return r.push("0.749023 g"),r.push("0 0 "+Tt(ot.internal.getWidth(e))+" "+Tt(ot.internal.getHeight(e))+" re"),r.push("f"),t.stream=r.join(`
`),t}}},createDefaultAppearanceStream:function(e){var t=e.scope.internal.getFont(e.fontName,e.fontStyle).id,r=e.scope.__private__.encodeColorString(e.color);return"/"+t+" "+e.fontSize+" Tf "+r}};ot.internal={Bezier_C:.551915024494,calculateCross:function(e){var t=ot.internal.getWidth(e),r=ot.internal.getHeight(e),n=Math.min(t,r);return{x1:{x:(t-n)/2,y:(r-n)/2+n},x2:{x:(t-n)/2+n,y:(r-n)/2},x3:{x:(t-n)/2,y:(r-n)/2},x4:{x:(t-n)/2+n,y:(r-n)/2+n}}}},ot.internal.getWidth=function(e){var t=0;return tr(e)==="object"&&(t=v_(e.Rect[2])),t},ot.internal.getHeight=function(e){var t=0;return tr(e)==="object"&&(t=v_(e.Rect[3])),t};var TX=Pr.addField=function(e){if(AX(this,e),!(e instanceof Hi))throw new Error("Invalid argument passed to jsPDF.addField.");var t;return(t=e).scope.internal.acroformPlugin.printedOut&&(t.scope.internal.acroformPlugin.printedOut=!1,t.scope.internal.acroformPlugin.acroFormDictionaryRoot=null),t.scope.internal.acroformPlugin.acroFormDictionaryRoot.Fields.push(t),e.page=e.scope.internal.getCurrentPageInfo().pageNumber,this};Pr.AcroFormChoiceField=Au,Pr.AcroFormListBox=Tu,Pr.AcroFormComboBox=Cu,Pr.AcroFormEditBox=Fp,Pr.AcroFormButton=mn,Pr.AcroFormPushButton=Op,Pr.AcroFormRadioButton=Nu,Pr.AcroFormCheckBox=Dp,Pr.AcroFormTextField=Kl,Pr.AcroFormPasswordField=Ip,Pr.AcroFormAppearance=ot,Pr.AcroForm={ChoiceField:Au,ListBox:Tu,ComboBox:Cu,EditBox:Fp,Button:mn,PushButton:Op,RadioButton:Nu,CheckBox:Dp,TextField:Kl,PasswordField:Ip,Appearance:ot},vt.AcroForm={ChoiceField:Au,ListBox:Tu,ComboBox:Cu,EditBox:Fp,Button:mn,PushButton:Op,RadioButton:Nu,CheckBox:Dp,TextField:Kl,PasswordField:Ip,Appearance:ot};function PC(e){return e.reduce(function(t,r,n){return t[r]=n,t},{})}(function(e){e.__addimage__={};var t="UNKNOWN",r={PNG:[[137,80,78,71]],TIFF:[[77,77,0,42],[73,73,42,0]],JPEG:[[255,216,255,224,void 0,void 0,74,70,73,70,0],[255,216,255,225,void 0,void 0,69,120,105,102,0,0],[255,216,255,219],[255,216,255,238]],JPEG2000:[[0,0,0,12,106,80,32,32]],GIF87a:[[71,73,70,56,55,97]],GIF89a:[[71,73,70,56,57,97]],WEBP:[[82,73,70,70,void 0,void 0,void 0,void 0,87,69,66,80]],BMP:[[66,77],[66,65],[67,73],[67,80],[73,67],[80,84]]},n=e.__addimage__.getImageFileTypeByImageData=function(N,P){var J,W,se,fe,U,Q=t;if((P=P||t)==="RGBA"||N.data!==void 0&&N.data instanceof Uint8ClampedArray&&"height"in N&&"width"in N)return"RGBA";if(D(N))for(U in r)for(se=r[U],J=0;J<se.length;J+=1){for(fe=!0,W=0;W<se[J].length;W+=1)if(se[J][W]!==void 0&&se[J][W]!==N[W]){fe=!1;break}if(fe===!0){Q=U;break}}else for(U in r)for(se=r[U],J=0;J<se.length;J+=1){for(fe=!0,W=0;W<se[J].length;W+=1)if(se[J][W]!==void 0&&se[J][W]!==N.charCodeAt(W)){fe=!1;break}if(fe===!0){Q=U;break}}return Q===t&&P!==t&&(Q=P),Q},a=function N(P){for(var J=this.internal.write,W=this.internal.putStream,se=(0,this.internal.getFilters)();se.indexOf("FlateEncode")!==-1;)se.splice(se.indexOf("FlateEncode"),1);P.objectId=this.internal.newObject();var fe=[];if(fe.push({key:"Type",value:"/XObject"}),fe.push({key:"Subtype",value:"/Image"}),fe.push({key:"Width",value:P.width}),fe.push({key:"Height",value:P.height}),P.colorSpace===b.INDEXED?fe.push({key:"ColorSpace",value:"[/Indexed /DeviceRGB "+(P.palette.length/3-1)+" "+("sMask"in P&&P.sMask!==void 0?P.objectId+2:P.objectId+1)+" 0 R]"}):(fe.push({key:"ColorSpace",value:"/"+P.colorSpace}),P.colorSpace===b.DEVICE_CMYK&&fe.push({key:"Decode",value:"[1 0 1 0 1 0 1 0]"})),fe.push({key:"BitsPerComponent",value:P.bitsPerComponent}),"decodeParameters"in P&&P.decodeParameters!==void 0&&fe.push({key:"DecodeParms",value:"<<"+P.decodeParameters+">>"}),"transparency"in P&&Array.isArray(P.transparency)){for(var U="",Q=0,q=P.transparency.length;Q<q;Q++)U+=P.transparency[Q]+" "+P.transparency[Q]+" ";fe.push({key:"Mask",value:"["+U+"]"})}P.sMask!==void 0&&fe.push({key:"SMask",value:P.objectId+1+" 0 R"});var he=P.filter!==void 0?["/"+P.filter]:void 0;if(W({data:P.data,additionalKeyValues:fe,alreadyAppliedFilters:he,objectId:P.objectId}),J("endobj"),"sMask"in P&&P.sMask!==void 0){var xe="/Predictor "+P.predictor+" /Colors 1 /BitsPerComponent "+P.bitsPerComponent+" /Columns "+P.width,E={width:P.width,height:P.height,colorSpace:"DeviceGray",bitsPerComponent:P.bitsPerComponent,decodeParameters:xe,data:P.sMask};"filter"in P&&(E.filter=P.filter),N.call(this,E)}if(P.colorSpace===b.INDEXED){var I=this.internal.newObject();W({data:F(new Uint8Array(P.palette)),objectId:I}),J("endobj")}},i=function(){var N=this.internal.collections.addImage_images;for(var P in N)a.call(this,N[P])},s=function(){var N,P=this.internal.collections.addImage_images,J=this.internal.write;for(var W in P)J("/I"+(N=P[W]).index,N.objectId,"0","R")},o=function(){this.internal.collections.addImage_images||(this.internal.collections.addImage_images={},this.internal.events.subscribe("putResources",i),this.internal.events.subscribe("putXobjectDict",s))},l=function(){var N=this.internal.collections.addImage_images;return o.call(this),N},c=function(){return Object.keys(this.internal.collections.addImage_images).length},u=function(N){return typeof e["process"+N.toUpperCase()]=="function"},f=function(N){return tr(N)==="object"&&N.nodeType===1},p=function(N,P){if(N.nodeName==="IMG"&&N.hasAttribute("src")){var J=""+N.getAttribute("src");if(J.indexOf("data:image/")===0)return L0(unescape(J).split("base64,").pop());var W=e.loadFile(J,!0);if(W!==void 0)return W}if(N.nodeName==="CANVAS"){if(N.width===0||N.height===0)throw new Error("Given canvas must have data. Canvas width: "+N.width+", height: "+N.height);var se;switch(P){case"PNG":se="image/png";break;case"WEBP":se="image/webp";break;case"JPEG":case"JPG":default:se="image/jpeg"}return L0(N.toDataURL(se,1).split("base64,").pop())}},h=function(N){var P=this.internal.collections.addImage_images;if(P){for(var J in P)if(N===P[J].alias)return P[J]}},g=function(N,P,J){return N||P||(N=-96,P=-96),N<0&&(N=-1*J.width*72/N/this.internal.scaleFactor),P<0&&(P=-1*J.height*72/P/this.internal.scaleFactor),N===0&&(N=P*J.width/J.height),P===0&&(P=N*J.height/J.width),[N,P]},m=function(N,P,J,W,se,fe){var U=g.call(this,J,W,se),Q=this.internal.getCoordinateString,q=this.internal.getVerticalCoordinateString,he=l.call(this);if(J=U[0],W=U[1],he[se.index]=se,fe){fe*=Math.PI/180;var xe=Math.cos(fe),E=Math.sin(fe),I=function(j){return j.toFixed(4)},O=[I(xe),I(E),I(-1*E),I(xe),0,0,"cm"]}this.internal.write("q"),fe?(this.internal.write([1,"0","0",1,Q(N),q(P+W),"cm"].join(" ")),this.internal.write(O.join(" ")),this.internal.write([Q(J),"0","0",Q(W),"0","0","cm"].join(" "))):this.internal.write([Q(J),"0","0",Q(W),Q(N),q(P+W),"cm"].join(" ")),this.isAdvancedAPI()&&this.internal.write([1,0,0,-1,0,0,"cm"].join(" ")),this.internal.write("/I"+se.index+" Do"),this.internal.write("Q")},b=e.color_spaces={DEVICE_RGB:"DeviceRGB",DEVICE_GRAY:"DeviceGray",DEVICE_CMYK:"DeviceCMYK",CAL_GREY:"CalGray",CAL_RGB:"CalRGB",LAB:"Lab",ICC_BASED:"ICCBased",INDEXED:"Indexed",PATTERN:"Pattern",SEPARATION:"Separation",DEVICE_N:"DeviceN"};e.decode={DCT_DECODE:"DCTDecode",FLATE_DECODE:"FlateDecode",LZW_DECODE:"LZWDecode",JPX_DECODE:"JPXDecode",JBIG2_DECODE:"JBIG2Decode",ASCII85_DECODE:"ASCII85Decode",ASCII_HEX_DECODE:"ASCIIHexDecode",RUN_LENGTH_DECODE:"RunLengthDecode",CCITT_FAX_DECODE:"CCITTFaxDecode"};var x=e.image_compression={NONE:"NONE",FAST:"FAST",MEDIUM:"MEDIUM",SLOW:"SLOW"},w=e.__addimage__.sHashCode=function(N){var P,J,W=0;if(typeof N=="string")for(J=N.length,P=0;P<J;P++)W=(W<<5)-W+N.charCodeAt(P),W|=0;else if(D(N))for(J=N.byteLength/2,P=0;P<J;P++)W=(W<<5)-W+N[P],W|=0;return W},y=e.__addimage__.validateStringAsBase64=function(N){(N=N||"").toString().trim();var P=!0;return N.length===0&&(P=!1),N.length%4!=0&&(P=!1),/^[A-Za-z0-9+/]+$/.test(N.substr(0,N.length-2))===!1&&(P=!1),/^[A-Za-z0-9/][A-Za-z0-9+/]|[A-Za-z0-9+/]=|==$/.test(N.substr(-2))===!1&&(P=!1),P},A=e.__addimage__.extractImageFromDataUrl=function(N){if(N==null||!(N=N.trim()).startsWith("data:"))return null;var P=N.indexOf(",");return P<0?null:N.substring(0,P).trim().endsWith("base64")?N.substring(P+1):null},L=e.__addimage__.supportsArrayBuffer=function(){return typeof ArrayBuffer<"u"&&typeof Uint8Array<"u"};e.__addimage__.isArrayBuffer=function(N){return L()&&N instanceof ArrayBuffer};var D=e.__addimage__.isArrayBufferView=function(N){return L()&&typeof Uint32Array<"u"&&(N instanceof Int8Array||N instanceof Uint8Array||typeof Uint8ClampedArray<"u"&&N instanceof Uint8ClampedArray||N instanceof Int16Array||N instanceof Uint16Array||N instanceof Int32Array||N instanceof Uint32Array||N instanceof Float32Array||N instanceof Float64Array)},T=e.__addimage__.binaryStringToUint8Array=function(N){for(var P=N.length,J=new Uint8Array(P),W=0;W<P;W++)J[W]=N.charCodeAt(W);return J},F=e.__addimage__.arrayBufferToBinaryString=function(N){for(var P="",J=D(N)?N:new Uint8Array(N),W=0;W<J.length;W+=8192)P+=String.fromCharCode.apply(null,J.subarray(W,W+8192));return P};e.addImage=function(){var N,P,J,W,se,fe,U,Q,q;if(typeof arguments[1]=="number"?(P=t,J=arguments[1],W=arguments[2],se=arguments[3],fe=arguments[4],U=arguments[5],Q=arguments[6],q=arguments[7]):(P=arguments[1],J=arguments[2],W=arguments[3],se=arguments[4],fe=arguments[5],U=arguments[6],Q=arguments[7],q=arguments[8]),tr(N=arguments[0])==="object"&&!f(N)&&"imageData"in N){var he=N;N=he.imageData,P=he.format||P||t,J=he.x||J||0,W=he.y||W||0,se=he.w||he.width||se,fe=he.h||he.height||fe,U=he.alias||U,Q=he.compression||Q,q=he.rotation||he.angle||q}var xe=this.internal.getFilters();if(Q===void 0&&xe.indexOf("FlateEncode")!==-1&&(Q="SLOW"),isNaN(J)||isNaN(W))throw new Error("Invalid coordinates passed to jsPDF.addImage");o.call(this);var E=R.call(this,N,P,U,Q);return m.call(this,J,W,se,fe,E,q),this};var R=function(N,P,J,W){var se,fe,U;if(typeof N=="string"&&n(N)===t){N=unescape(N);var Q=X(N,!1);(Q!==""||(Q=e.loadFile(N,!0))!==void 0)&&(N=Q)}if(f(N)&&(N=p(N,P)),P=n(N,P),!u(P))throw new Error("addImage does not support files of type '"+P+"', please ensure that a plugin for '"+P+"' support is added.");if(((U=J)==null||U.length===0)&&(J=function(q){return typeof q=="string"||D(q)?w(q):D(q.data)?w(q.data):null}(N)),(se=h.call(this,J))||(L()&&(N instanceof Uint8Array||P==="RGBA"||(fe=N,N=T(N))),se=this["process"+P.toUpperCase()](N,c.call(this),J,function(q){return q&&typeof q=="string"&&(q=q.toUpperCase()),q in e.image_compression?q:x.NONE}(W),fe)),!se)throw new Error("An unknown error occurred whilst processing the image.");return se},X=e.__addimage__.convertBase64ToBinaryString=function(N,P){P=typeof P!="boolean"||P;var J,W="";if(typeof N=="string"){var se;J=(se=A(N))!==null&&se!==void 0?se:N;try{W=L0(J)}catch(fe){if(P)throw y(J)?new Error("atob-Error in jsPDF.convertBase64ToBinaryString "+fe.message):new Error("Supplied Data is not a valid base64-String jsPDF.convertBase64ToBinaryString ")}}return W};e.getImageProperties=function(N){var P,J,W="";if(f(N)&&(N=p(N)),typeof N=="string"&&n(N)===t&&((W=X(N,!1))===""&&(W=e.loadFile(N)||""),N=W),J=n(N),!u(J))throw new Error("addImage does not support files of type '"+J+"', please ensure that a plugin for '"+J+"' support is added.");if(!L()||N instanceof Uint8Array||(N=T(N)),!(P=this["process"+J.toUpperCase()](N)))throw new Error("An unknown error occurred whilst processing the image");return P.fileType=J,P}})(vt.API),function(e){var t=function(r){if(r!==void 0&&r!="")return!0};vt.API.events.push(["addPage",function(r){this.internal.getPageInfo(r.pageNumber).pageContext.annotations=[]}]),e.events.push(["putPage",function(r){for(var n,a,i,s=this.internal.getCoordinateString,o=this.internal.getVerticalCoordinateString,l=this.internal.getPageInfoByObjId(r.objId),c=r.pageContext.annotations,u=!1,f=0;f<c.length&&!u;f++)switch((n=c[f]).type){case"link":(t(n.options.url)||t(n.options.pageNumber))&&(u=!0);break;case"reference":case"text":case"freetext":u=!0}if(u!=0){this.internal.write("/Annots [");for(var p=0;p<c.length;p++){n=c[p];var h=this.internal.pdfEscape,g=this.internal.getEncryptor(r.objId);switch(n.type){case"reference":this.internal.write(" "+n.object.objId+" 0 R ");break;case"text":var m=this.internal.newAdditionalObject(),b=this.internal.newAdditionalObject(),x=this.internal.getEncryptor(m.objId),w=n.title||"Note";i="<</Type /Annot /Subtype /Text "+(a="/Rect ["+s(n.bounds.x)+" "+o(n.bounds.y+n.bounds.h)+" "+s(n.bounds.x+n.bounds.w)+" "+o(n.bounds.y)+"] ")+"/Contents ("+h(x(n.contents))+")",i+=" /Popup "+b.objId+" 0 R",i+=" /P "+l.objId+" 0 R",i+=" /T ("+h(x(w))+") >>",m.content=i;var y=m.objId+" 0 R";i="<</Type /Annot /Subtype /Popup "+(a="/Rect ["+s(n.bounds.x+30)+" "+o(n.bounds.y+n.bounds.h)+" "+s(n.bounds.x+n.bounds.w+30)+" "+o(n.bounds.y)+"] ")+" /Parent "+y,n.open&&(i+=" /Open true"),i+=" >>",b.content=i,this.internal.write(m.objId,"0 R",b.objId,"0 R");break;case"freetext":a="/Rect ["+s(n.bounds.x)+" "+o(n.bounds.y)+" "+s(n.bounds.x+n.bounds.w)+" "+o(n.bounds.y+n.bounds.h)+"] ";var A=n.color||"#000000";i="<</Type /Annot /Subtype /FreeText "+a+"/Contents ("+h(g(n.contents))+")",i+=" /DS(font: Helvetica,sans-serif 12.0pt; text-align:left; color:#"+A+")",i+=" /Border [0 0 0]",i+=" >>",this.internal.write(i);break;case"link":if(n.options.name){var L=this.annotations._nameMap[n.options.name];n.options.pageNumber=L.page,n.options.top=L.y}else n.options.top||(n.options.top=0);if(a="/Rect ["+n.finalBounds.x+" "+n.finalBounds.y+" "+n.finalBounds.w+" "+n.finalBounds.h+"] ",i="",n.options.url)i="<</Type /Annot /Subtype /Link "+a+"/Border [0 0 0] /A <</S /URI /URI ("+h(g(n.options.url))+") >>";else if(n.options.pageNumber)switch(i="<</Type /Annot /Subtype /Link "+a+"/Border [0 0 0] /Dest ["+this.internal.getPageInfo(n.options.pageNumber).objId+" 0 R",n.options.magFactor=n.options.magFactor||"XYZ",n.options.magFactor){case"Fit":i+=" /Fit]";break;case"FitH":i+=" /FitH "+n.options.top+"]";break;case"FitV":n.options.left=n.options.left||0,i+=" /FitV "+n.options.left+"]";break;case"XYZ":default:var D=o(n.options.top);n.options.left=n.options.left||0,n.options.zoom===void 0&&(n.options.zoom=0),i+=" /XYZ "+n.options.left+" "+D+" "+n.options.zoom+"]"}i!=""&&(i+=" >>",this.internal.write(i))}}this.internal.write("]")}}]),e.createAnnotation=function(r){var n=this.internal.getCurrentPageInfo();switch(r.type){case"link":this.link(r.bounds.x,r.bounds.y,r.bounds.w,r.bounds.h,r);break;case"text":case"freetext":n.pageContext.annotations.push(r)}},e.link=function(r,n,a,i,s){var o=this.internal.getCurrentPageInfo(),l=this.internal.getCoordinateString,c=this.internal.getVerticalCoordinateString;o.pageContext.annotations.push({finalBounds:{x:l(r),y:c(n),w:l(r+a),h:c(n+i)},options:s,type:"link"})},e.textWithLink=function(r,n,a,i){var s,o,l=this.getTextWidth(r),c=this.internal.getLineHeight()/this.internal.scaleFactor;if(i.maxWidth!==void 0){o=i.maxWidth;var u=this.splitTextToSize(r,o).length;s=Math.ceil(c*u)}else o=l,s=c;return this.text(r,n,a,i),a+=.2*c,i.align==="center"&&(n-=l/2),i.align==="right"&&(n-=l),this.link(n,a-c,o,s,i),l},e.getTextWidth=function(r){var n=this.internal.getFontSize();return this.getStringUnitWidth(r)*n/this.internal.scaleFactor}}(vt.API),function(e){var t={1569:[65152],1570:[65153,65154],1571:[65155,65156],1572:[65157,65158],1573:[65159,65160],1574:[65161,65162,65163,65164],1575:[65165,65166],1576:[65167,65168,65169,65170],1577:[65171,65172],1578:[65173,65174,65175,65176],1579:[65177,65178,65179,65180],1580:[65181,65182,65183,65184],1581:[65185,65186,65187,65188],1582:[65189,65190,65191,65192],1583:[65193,65194],1584:[65195,65196],1585:[65197,65198],1586:[65199,65200],1587:[65201,65202,65203,65204],1588:[65205,65206,65207,65208],1589:[65209,65210,65211,65212],1590:[65213,65214,65215,65216],1591:[65217,65218,65219,65220],1592:[65221,65222,65223,65224],1593:[65225,65226,65227,65228],1594:[65229,65230,65231,65232],1601:[65233,65234,65235,65236],1602:[65237,65238,65239,65240],1603:[65241,65242,65243,65244],1604:[65245,65246,65247,65248],1605:[65249,65250,65251,65252],1606:[65253,65254,65255,65256],1607:[65257,65258,65259,65260],1608:[65261,65262],1609:[65263,65264,64488,64489],1610:[65265,65266,65267,65268],1649:[64336,64337],1655:[64477],1657:[64358,64359,64360,64361],1658:[64350,64351,64352,64353],1659:[64338,64339,64340,64341],1662:[64342,64343,64344,64345],1663:[64354,64355,64356,64357],1664:[64346,64347,64348,64349],1667:[64374,64375,64376,64377],1668:[64370,64371,64372,64373],1670:[64378,64379,64380,64381],1671:[64382,64383,64384,64385],1672:[64392,64393],1676:[64388,64389],1677:[64386,64387],1678:[64390,64391],1681:[64396,64397],1688:[64394,64395],1700:[64362,64363,64364,64365],1702:[64366,64367,64368,64369],1705:[64398,64399,64400,64401],1709:[64467,64468,64469,64470],1711:[64402,64403,64404,64405],1713:[64410,64411,64412,64413],1715:[64406,64407,64408,64409],1722:[64414,64415],1723:[64416,64417,64418,64419],1726:[64426,64427,64428,64429],1728:[64420,64421],1729:[64422,64423,64424,64425],1733:[64480,64481],1734:[64473,64474],1735:[64471,64472],1736:[64475,64476],1737:[64482,64483],1739:[64478,64479],1740:[64508,64509,64510,64511],1744:[64484,64485,64486,64487],1746:[64430,64431],1747:[64432,64433]},r={65247:{65154:65269,65156:65271,65160:65273,65166:65275},65248:{65154:65270,65156:65272,65160:65274,65166:65276},65165:{65247:{65248:{65258:65010}}},1617:{1612:64606,1613:64607,1614:64608,1615:64609,1616:64610}},n={1612:64606,1613:64607,1614:64608,1615:64609,1616:64610},a=[1570,1571,1573,1575];e.__arabicParser__={};var i=e.__arabicParser__.isInArabicSubstitutionA=function(m){return t[m.charCodeAt(0)]!==void 0},s=e.__arabicParser__.isArabicLetter=function(m){return typeof m=="string"&&/^[\u0600-\u06FF\u0750-\u077F\u08A0-\u08FF\uFB50-\uFDFF\uFE70-\uFEFF]+$/.test(m)},o=e.__arabicParser__.isArabicEndLetter=function(m){return s(m)&&i(m)&&t[m.charCodeAt(0)].length<=2},l=e.__arabicParser__.isArabicAlfLetter=function(m){return s(m)&&a.indexOf(m.charCodeAt(0))>=0};e.__arabicParser__.arabicLetterHasIsolatedForm=function(m){return s(m)&&i(m)&&t[m.charCodeAt(0)].length>=1};var c=e.__arabicParser__.arabicLetterHasFinalForm=function(m){return s(m)&&i(m)&&t[m.charCodeAt(0)].length>=2};e.__arabicParser__.arabicLetterHasInitialForm=function(m){return s(m)&&i(m)&&t[m.charCodeAt(0)].length>=3};var u=e.__arabicParser__.arabicLetterHasMedialForm=function(m){return s(m)&&i(m)&&t[m.charCodeAt(0)].length==4},f=e.__arabicParser__.resolveLigatures=function(m){var b=0,x=r,w="",y=0;for(b=0;b<m.length;b+=1)x[m.charCodeAt(b)]!==void 0?(y++,typeof(x=x[m.charCodeAt(b)])=="number"&&(w+=String.fromCharCode(x),x=r,y=0),b===m.length-1&&(x=r,w+=m.charAt(b-(y-1)),b-=y-1,y=0)):(x=r,w+=m.charAt(b-y),b-=y,y=0);return w};e.__arabicParser__.isArabicDiacritic=function(m){return m!==void 0&&n[m.charCodeAt(0)]!==void 0};var p=e.__arabicParser__.getCorrectForm=function(m,b,x){return s(m)?i(m)===!1?-1:!c(m)||!s(b)&&!s(x)||!s(x)&&o(b)||o(m)&&!s(b)||o(m)&&l(b)||o(m)&&o(b)?0:u(m)&&s(b)&&!o(b)&&s(x)&&c(x)?3:o(m)||!s(x)?1:2:-1},h=function(m){var b=0,x=0,w=0,y="",A="",L="",D=(m=m||"").split("\\s+"),T=[];for(b=0;b<D.length;b+=1){for(T.push(""),x=0;x<D[b].length;x+=1)y=D[b][x],A=D[b][x-1],L=D[b][x+1],s(y)?(w=p(y,A,L),T[b]+=w!==-1?String.fromCharCode(t[y.charCodeAt(0)][w]):y):T[b]+=y;T[b]=f(T[b])}return T.join(" ")},g=e.__arabicParser__.processArabic=e.processArabic=function(){var m,b=typeof arguments[0]=="string"?arguments[0]:arguments[0].text,x=[];if(Array.isArray(b)){var w=0;for(x=[],w=0;w<b.length;w+=1)Array.isArray(b[w])?x.push([h(b[w][0]),b[w][1],b[w][2]]):x.push([h(b[w])]);m=x}else m=h(b);return typeof arguments[0]=="string"?m:(arguments[0].text=m,arguments[0])};e.events.push(["preProcessText",g])}(vt.API),vt.API.autoPrint=function(e){var t;switch((e=e||{}).variant=e.variant||"non-conform",e.variant){case"javascript":this.addJS("print({});");break;case"non-conform":default:this.internal.events.subscribe("postPutResources",function(){t=this.internal.newObject(),this.internal.out("<<"),this.internal.out("/S /Named"),this.internal.out("/Type /Action"),this.internal.out("/N /Print"),this.internal.out(">>"),this.internal.out("endobj")}),this.internal.events.subscribe("putCatalog",function(){this.internal.out("/OpenAction "+t+" 0 R")})}return this},function(e){var t=function(){var r=void 0;Object.defineProperty(this,"pdf",{get:function(){return r},set:function(o){r=o}});var n=150;Object.defineProperty(this,"width",{get:function(){return n},set:function(o){n=isNaN(o)||Number.isInteger(o)===!1||o<0?150:o,this.getContext("2d").pageWrapXEnabled&&(this.getContext("2d").pageWrapX=n+1)}});var a=300;Object.defineProperty(this,"height",{get:function(){return a},set:function(o){a=isNaN(o)||Number.isInteger(o)===!1||o<0?300:o,this.getContext("2d").pageWrapYEnabled&&(this.getContext("2d").pageWrapY=a+1)}});var i=[];Object.defineProperty(this,"childNodes",{get:function(){return i},set:function(o){i=o}});var s={};Object.defineProperty(this,"style",{get:function(){return s},set:function(o){s=o}}),Object.defineProperty(this,"parentNode",{})};t.prototype.getContext=function(r,n){var a;if((r=r||"2d")!=="2d")return null;for(a in n)this.pdf.context2d.hasOwnProperty(a)&&(this.pdf.context2d[a]=n[a]);return this.pdf.context2d._canvas=this,this.pdf.context2d},t.prototype.toDataURL=function(){throw new Error("toDataURL is not implemented.")},e.events.push(["initialized",function(){this.canvas=new t,this.canvas.pdf=this}])}(vt.API),function(e){var t={left:0,top:0,bottom:0,right:0},r=!1,n=function(){this.internal.__cell__===void 0&&(this.internal.__cell__={},this.internal.__cell__.padding=3,this.internal.__cell__.headerFunction=void 0,this.internal.__cell__.margins=Object.assign({},t),this.internal.__cell__.margins.width=this.getPageWidth(),a.call(this))},a=function(){this.internal.__cell__.lastCell=new i,this.internal.__cell__.pages=1},i=function(){var l=arguments[0];Object.defineProperty(this,"x",{enumerable:!0,get:function(){return l},set:function(m){l=m}});var c=arguments[1];Object.defineProperty(this,"y",{enumerable:!0,get:function(){return c},set:function(m){c=m}});var u=arguments[2];Object.defineProperty(this,"width",{enumerable:!0,get:function(){return u},set:function(m){u=m}});var f=arguments[3];Object.defineProperty(this,"height",{enumerable:!0,get:function(){return f},set:function(m){f=m}});var p=arguments[4];Object.defineProperty(this,"text",{enumerable:!0,get:function(){return p},set:function(m){p=m}});var h=arguments[5];Object.defineProperty(this,"lineNumber",{enumerable:!0,get:function(){return h},set:function(m){h=m}});var g=arguments[6];return Object.defineProperty(this,"align",{enumerable:!0,get:function(){return g},set:function(m){g=m}}),this};i.prototype.clone=function(){return new i(this.x,this.y,this.width,this.height,this.text,this.lineNumber,this.align)},i.prototype.toArray=function(){return[this.x,this.y,this.width,this.height,this.text,this.lineNumber,this.align]},e.setHeaderFunction=function(l){return n.call(this),this.internal.__cell__.headerFunction=typeof l=="function"?l:void 0,this},e.getTextDimensions=function(l,c){n.call(this);var u=(c=c||{}).fontSize||this.getFontSize(),f=c.font||this.getFont(),p=c.scaleFactor||this.internal.scaleFactor,h=0,g=0,m=0,b=this;if(!Array.isArray(l)&&typeof l!="string"){if(typeof l!="number")throw new Error("getTextDimensions expects text-parameter to be of type String or type Number or an Array of Strings.");l=String(l)}var x=c.maxWidth;x>0?typeof l=="string"?l=this.splitTextToSize(l,x):Object.prototype.toString.call(l)==="[object Array]"&&(l=l.reduce(function(y,A){return y.concat(b.splitTextToSize(A,x))},[])):l=Array.isArray(l)?l:[l];for(var w=0;w<l.length;w++)h<(m=this.getStringUnitWidth(l[w],{font:f})*u)&&(h=m);return h!==0&&(g=l.length),{w:h/=p,h:Math.max((g*u*this.getLineHeightFactor()-u*(this.getLineHeightFactor()-1))/p,0)}},e.cellAddPage=function(){n.call(this),this.addPage();var l=this.internal.__cell__.margins||t;return this.internal.__cell__.lastCell=new i(l.left,l.top,void 0,void 0),this.internal.__cell__.pages+=1,this};var s=e.cell=function(){var l;l=arguments[0]instanceof i?arguments[0]:new i(arguments[0],arguments[1],arguments[2],arguments[3],arguments[4],arguments[5]),n.call(this);var c=this.internal.__cell__.lastCell,u=this.internal.__cell__.padding,f=this.internal.__cell__.margins||t,p=this.internal.__cell__.tableHeaderRow,h=this.internal.__cell__.printHeaders;return c.lineNumber!==void 0&&(c.lineNumber===l.lineNumber?(l.x=(c.x||0)+(c.width||0),l.y=c.y||0):c.y+c.height+l.height+f.bottom>this.getPageHeight()?(this.cellAddPage(),l.y=f.top,h&&p&&(this.printHeaderRow(l.lineNumber,!0),l.y+=p[0].height)):l.y=c.y+c.height||l.y),l.text[0]!==void 0&&(this.rect(l.x,l.y,l.width,l.height,r===!0?"FD":void 0),l.align==="right"?this.text(l.text,l.x+l.width-u,l.y+u,{align:"right",baseline:"top"}):l.align==="center"?this.text(l.text,l.x+l.width/2,l.y+u,{align:"center",baseline:"top",maxWidth:l.width-u-u}):this.text(l.text,l.x+u,l.y+u,{align:"left",baseline:"top",maxWidth:l.width-u-u})),this.internal.__cell__.lastCell=l,this};e.table=function(l,c,u,f,p){if(n.call(this),!u)throw new Error("No data for PDF table.");var h,g,m,b,x=[],w=[],y=[],A={},L={},D=[],T=[],F=(p=p||{}).autoSize||!1,R=p.printHeaders!==!1,X=p.css&&p.css["font-size"]!==void 0?16*p.css["font-size"]:p.fontSize||12,N=p.margins||Object.assign({width:this.getPageWidth()},t),P=typeof p.padding=="number"?p.padding:3,J=p.headerBackgroundColor||"#c8c8c8",W=p.headerTextColor||"#000";if(a.call(this),this.internal.__cell__.printHeaders=R,this.internal.__cell__.margins=N,this.internal.__cell__.table_font_size=X,this.internal.__cell__.padding=P,this.internal.__cell__.headerBackgroundColor=J,this.internal.__cell__.headerTextColor=W,this.setFontSize(X),f==null)w=x=Object.keys(u[0]),y=x.map(function(){return"left"});else if(Array.isArray(f)&&tr(f[0])==="object")for(x=f.map(function(he){return he.name}),w=f.map(function(he){return he.prompt||he.name||""}),y=f.map(function(he){return he.align||"left"}),h=0;h<f.length;h+=1)L[f[h].name]=f[h].width*(19.049976/25.4);else Array.isArray(f)&&typeof f[0]=="string"&&(w=x=f,y=x.map(function(){return"left"}));if(F||Array.isArray(f)&&typeof f[0]=="string")for(h=0;h<x.length;h+=1){for(A[b=x[h]]=u.map(function(he){return he[b]}),this.setFont(void 0,"bold"),D.push(this.getTextDimensions(w[h],{fontSize:this.internal.__cell__.table_font_size,scaleFactor:this.internal.scaleFactor}).w),g=A[b],this.setFont(void 0,"normal"),m=0;m<g.length;m+=1)D.push(this.getTextDimensions(g[m],{fontSize:this.internal.__cell__.table_font_size,scaleFactor:this.internal.scaleFactor}).w);L[b]=Math.max.apply(null,D)+P+P,D=[]}if(R){var se={};for(h=0;h<x.length;h+=1)se[x[h]]={},se[x[h]].text=w[h],se[x[h]].align=y[h];var fe=o.call(this,se,L);T=x.map(function(he){return new i(l,c,L[he],fe,se[he].text,void 0,se[he].align)}),this.setTableHeaderRow(T),this.printHeaderRow(1,!1)}var U=f.reduce(function(he,xe){return he[xe.name]=xe.align,he},{});for(h=0;h<u.length;h+=1){"rowStart"in p&&p.rowStart instanceof Function&&p.rowStart({row:h,data:u[h]},this);var Q=o.call(this,u[h],L);for(m=0;m<x.length;m+=1){var q=u[h][x[m]];"cellStart"in p&&p.cellStart instanceof Function&&p.cellStart({row:h,col:m,data:q},this),s.call(this,new i(l,c,L[x[m]],Q,q,h+2,U[x[m]]))}}return this.internal.__cell__.table_x=l,this.internal.__cell__.table_y=c,this};var o=function(l,c){var u=this.internal.__cell__.padding,f=this.internal.__cell__.table_font_size,p=this.internal.scaleFactor;return Object.keys(l).map(function(h){var g=l[h];return this.splitTextToSize(g.hasOwnProperty("text")?g.text:g,c[h]-u-u)},this).map(function(h){return this.getLineHeightFactor()*h.length*f/p+u+u},this).reduce(function(h,g){return Math.max(h,g)},0)};e.setTableHeaderRow=function(l){n.call(this),this.internal.__cell__.tableHeaderRow=l},e.printHeaderRow=function(l,c){if(n.call(this),!this.internal.__cell__.tableHeaderRow)throw new Error("Property tableHeaderRow does not exist.");var u;if(r=!0,typeof this.internal.__cell__.headerFunction=="function"){var f=this.internal.__cell__.headerFunction(this,this.internal.__cell__.pages);this.internal.__cell__.lastCell=new i(f[0],f[1],f[2],f[3],void 0,-1)}this.setFont(void 0,"bold");for(var p=[],h=0;h<this.internal.__cell__.tableHeaderRow.length;h+=1){u=this.internal.__cell__.tableHeaderRow[h].clone(),c&&(u.y=this.internal.__cell__.margins.top||0,p.push(u)),u.lineNumber=l;var g=this.getTextColor();this.setTextColor(this.internal.__cell__.headerTextColor),this.setFillColor(this.internal.__cell__.headerBackgroundColor),s.call(this,u),this.setTextColor(g)}p.length>0&&this.setTableHeaderRow(p),this.setFont(void 0,"normal"),r=!1}}(vt.API);var LC={italic:["italic","oblique","normal"],oblique:["oblique","italic","normal"],normal:["normal","oblique","italic"]},FC=["ultra-condensed","extra-condensed","condensed","semi-condensed","normal","semi-expanded","expanded","extra-expanded","ultra-expanded"],kx=PC(FC),OC=[100,200,300,400,500,600,700,800,900],CX=PC(OC);function Ex(e){var t=e.family.replace(/"|'/g,"").toLowerCase(),r=function(i){return LC[i=i||"normal"]?i:"normal"}(e.style),n=function(i){if(!i)return 400;if(typeof i=="number")return i>=100&&i<=900&&i%100==0?i:400;if(/^\d00$/.test(i))return parseInt(i);switch(i){case"bold":return 700;case"normal":default:return 400}}(e.weight),a=function(i){return typeof kx[i=i||"normal"]=="number"?i:"normal"}(e.stretch);return{family:t,style:r,weight:n,stretch:a,src:e.src||[],ref:e.ref||{name:t,style:[a,r,n].join(" ")}}}function x_(e,t,r,n){var a;for(a=r;a>=0&&a<t.length;a+=n)if(e[t[a]])return e[t[a]];for(a=r;a>=0&&a<t.length;a-=n)if(e[t[a]])return e[t[a]]}var NX={"sans-serif":"helvetica",fixed:"courier",monospace:"courier",terminal:"courier",cursive:"times",fantasy:"times",serif:"times"},y_={caption:"times",icon:"times",menu:"times","message-box":"times","small-caption":"times","status-bar":"times"};function w_(e){return[e.stretch,e.style,e.weight,e.family].join(" ")}function PX(e,t,r){for(var n=(r=r||{}).defaultFontFamily||"times",a=Object.assign({},NX,r.genericFontFamilies||{}),i=null,s=null,o=0;o<t.length;++o)if(a[(i=Ex(t[o])).family]&&(i.family=a[i.family]),e.hasOwnProperty(i.family)){s=e[i.family];break}if(!(s=s||e[n]))throw new Error("Could not find a font-family for the rule '"+w_(i)+"' and default family '"+n+"'.");if(s=function(l,c){if(c[l])return c[l];var u=kx[l],f=u<=kx.normal?-1:1,p=x_(c,FC,u,f);if(!p)throw new Error("Could not find a matching font-stretch value for "+l);return p}(i.stretch,s),s=function(l,c){if(c[l])return c[l];for(var u=LC[l],f=0;f<u.length;++f)if(c[u[f]])return c[u[f]];throw new Error("Could not find a matching font-style for "+l)}(i.style,s),!(s=function(l,c){if(c[l])return c[l];if(l===400&&c[500])return c[500];if(l===500&&c[400])return c[400];var u=CX[l],f=x_(c,OC,u,l<400?-1:1);if(!f)throw new Error("Could not find a matching font-weight for value "+l);return f}(i.weight,s)))throw new Error("Failed to resolve a font for the rule '"+w_(i)+"'.");return s}function b_(e){return e.trimLeft()}function LX(e,t){for(var r=0;r<e.length;){if(e.charAt(r)===t)return[e.substring(0,r),e.substring(r+1)];r+=1}return null}function FX(e){var t=e.match(/^(-[a-z_]|[a-z_])[a-z0-9_-]*/i);return t===null?null:[t[0],e.substring(t[0].length)]}var dp,__,S_,N2=["times"];(function(e){var t,r,n,a,i,s,o,l,c,u=function(E){return E=E||{},this.isStrokeTransparent=E.isStrokeTransparent||!1,this.strokeOpacity=E.strokeOpacity||1,this.strokeStyle=E.strokeStyle||"#000000",this.fillStyle=E.fillStyle||"#000000",this.isFillTransparent=E.isFillTransparent||!1,this.fillOpacity=E.fillOpacity||1,this.font=E.font||"10px sans-serif",this.textBaseline=E.textBaseline||"alphabetic",this.textAlign=E.textAlign||"left",this.lineWidth=E.lineWidth||1,this.lineJoin=E.lineJoin||"miter",this.lineCap=E.lineCap||"butt",this.path=E.path||[],this.transform=E.transform!==void 0?E.transform.clone():new l,this.globalCompositeOperation=E.globalCompositeOperation||"normal",this.globalAlpha=E.globalAlpha||1,this.clip_path=E.clip_path||[],this.currentPoint=E.currentPoint||new s,this.miterLimit=E.miterLimit||10,this.lastPoint=E.lastPoint||new s,this.lineDashOffset=E.lineDashOffset||0,this.lineDash=E.lineDash||[],this.margin=E.margin||[0,0,0,0],this.prevPageLastElemOffset=E.prevPageLastElemOffset||0,this.ignoreClearRect=typeof E.ignoreClearRect!="boolean"||E.ignoreClearRect,this};e.events.push(["initialized",function(){this.context2d=new f(this),t=this.internal.f2,r=this.internal.getCoordinateString,n=this.internal.getVerticalCoordinateString,a=this.internal.getHorizontalCoordinate,i=this.internal.getVerticalCoordinate,s=this.internal.Point,o=this.internal.Rectangle,l=this.internal.Matrix,c=new u}]);var f=function(E){Object.defineProperty(this,"canvas",{get:function(){return{parentNode:!1,style:!1}}});var I=E;Object.defineProperty(this,"pdf",{get:function(){return I}});var O=!1;Object.defineProperty(this,"pageWrapXEnabled",{get:function(){return O},set:function(Ce){O=!!Ce}});var j=!1;Object.defineProperty(this,"pageWrapYEnabled",{get:function(){return j},set:function(Ce){j=!!Ce}});var K=0;Object.defineProperty(this,"posX",{get:function(){return K},set:function(Ce){isNaN(Ce)||(K=Ce)}});var ne=0;Object.defineProperty(this,"posY",{get:function(){return ne},set:function(Ce){isNaN(Ce)||(ne=Ce)}}),Object.defineProperty(this,"margin",{get:function(){return c.margin},set:function(Ce){var ae;typeof Ce=="number"?ae=[Ce,Ce,Ce,Ce]:((ae=new Array(4))[0]=Ce[0],ae[1]=Ce.length>=2?Ce[1]:ae[0],ae[2]=Ce.length>=3?Ce[2]:ae[0],ae[3]=Ce.length>=4?Ce[3]:ae[1]),c.margin=ae}});var pe=!1;Object.defineProperty(this,"autoPaging",{get:function(){return pe},set:function(Ce){pe=Ce}});var de=0;Object.defineProperty(this,"lastBreak",{get:function(){return de},set:function(Ce){de=Ce}});var we=[];Object.defineProperty(this,"pageBreaks",{get:function(){return we},set:function(Ce){we=Ce}}),Object.defineProperty(this,"ctx",{get:function(){return c},set:function(Ce){Ce instanceof u&&(c=Ce)}}),Object.defineProperty(this,"path",{get:function(){return c.path},set:function(Ce){c.path=Ce}});var Pe=[];Object.defineProperty(this,"ctxStack",{get:function(){return Pe},set:function(Ce){Pe=Ce}}),Object.defineProperty(this,"fillStyle",{get:function(){return this.ctx.fillStyle},set:function(Ce){var ae;ae=p(Ce),this.ctx.fillStyle=ae.style,this.ctx.isFillTransparent=ae.a===0,this.ctx.fillOpacity=ae.a,this.pdf.setFillColor(ae.r,ae.g,ae.b,{a:ae.a}),this.pdf.setTextColor(ae.r,ae.g,ae.b,{a:ae.a})}}),Object.defineProperty(this,"strokeStyle",{get:function(){return this.ctx.strokeStyle},set:function(Ce){var ae=p(Ce);this.ctx.strokeStyle=ae.style,this.ctx.isStrokeTransparent=ae.a===0,this.ctx.strokeOpacity=ae.a,ae.a===0?this.pdf.setDrawColor(255,255,255):(ae.a,this.pdf.setDrawColor(ae.r,ae.g,ae.b))}}),Object.defineProperty(this,"lineCap",{get:function(){return this.ctx.lineCap},set:function(Ce){["butt","round","square"].indexOf(Ce)!==-1&&(this.ctx.lineCap=Ce,this.pdf.setLineCap(Ce))}}),Object.defineProperty(this,"lineWidth",{get:function(){return this.ctx.lineWidth},set:function(Ce){isNaN(Ce)||(this.ctx.lineWidth=Ce,this.pdf.setLineWidth(Ce))}}),Object.defineProperty(this,"lineJoin",{get:function(){return this.ctx.lineJoin},set:function(Ce){["bevel","round","miter"].indexOf(Ce)!==-1&&(this.ctx.lineJoin=Ce,this.pdf.setLineJoin(Ce))}}),Object.defineProperty(this,"miterLimit",{get:function(){return this.ctx.miterLimit},set:function(Ce){isNaN(Ce)||(this.ctx.miterLimit=Ce,this.pdf.setMiterLimit(Ce))}}),Object.defineProperty(this,"textBaseline",{get:function(){return this.ctx.textBaseline},set:function(Ce){this.ctx.textBaseline=Ce}}),Object.defineProperty(this,"textAlign",{get:function(){return this.ctx.textAlign},set:function(Ce){["right","end","center","left","start"].indexOf(Ce)!==-1&&(this.ctx.textAlign=Ce)}});var Z=null;function Ve(Ce,ae){if(Z===null){var De=function(Xe){var Me=[];return Object.keys(Xe).forEach(function(qe){Xe[qe].forEach(function(Ye){var Je=null;switch(Ye){case"bold":Je={family:qe,weight:"bold"};break;case"italic":Je={family:qe,style:"italic"};break;case"bolditalic":Je={family:qe,weight:"bold",style:"italic"};break;case"":case"normal":Je={family:qe}}Je!==null&&(Je.ref={name:qe,style:Ye},Me.push(Je))})}),Me}(Ce.getFontList());Z=function(Xe){for(var Me={},qe=0;qe<Xe.length;++qe){var Ye=Ex(Xe[qe]),Je=Ye.family,st=Ye.stretch,lt=Ye.style,mt=Ye.weight;Me[Je]=Me[Je]||{},Me[Je][st]=Me[Je][st]||{},Me[Je][st][lt]=Me[Je][st][lt]||{},Me[Je][st][lt][mt]=Ye}return Me}(De.concat(ae))}return Z}var Ke=null;Object.defineProperty(this,"fontFaces",{get:function(){return Ke},set:function(Ce){Z=null,Ke=Ce}}),Object.defineProperty(this,"font",{get:function(){return this.ctx.font},set:function(Ce){var ae;if(this.ctx.font=Ce,(ae=/^\s*(?=(?:(?:[-a-z]+\s*){0,2}(italic|oblique))?)(?=(?:(?:[-a-z]+\s*){0,2}(small-caps))?)(?=(?:(?:[-a-z]+\s*){0,2}(bold(?:er)?|lighter|[1-9]00))?)(?:(?:normal|\1|\2|\3)\s*){0,3}((?:xx?-)?(?:small|large)|medium|smaller|larger|[.\d]+(?:\%|in|[cem]m|ex|p[ctx]))(?:\s*\/\s*(normal|[.\d]+(?:\%|in|[cem]m|ex|p[ctx])))?\s*([-_,\"\'\sa-z]+?)\s*$/i.exec(Ce))!==null){var De=ae[1];ae[2];var Xe=ae[3],Me=ae[4];ae[5];var qe=ae[6],Ye=/^([.\d]+)((?:%|in|[cem]m|ex|p[ctx]))$/i.exec(Me)[2];Me=Math.floor(Ye==="px"?parseFloat(Me)*this.pdf.internal.scaleFactor:Ye==="em"?parseFloat(Me)*this.pdf.getFontSize():parseFloat(Me)*this.pdf.internal.scaleFactor),this.pdf.setFontSize(Me);var Je=function(ct){var Ze,ze,Jt=[],ht=ct.trim();if(ht==="")return N2;if(ht in y_)return[y_[ht]];for(;ht!=="";){switch(ze=null,Ze=(ht=b_(ht)).charAt(0)){case'"':case"'":ze=LX(ht.substring(1),Ze);break;default:ze=FX(ht)}if(ze===null||(Jt.push(ze[0]),(ht=b_(ze[1]))!==""&&ht.charAt(0)!==","))return N2;ht=ht.replace(/^,/,"")}return Jt}(qe);if(this.fontFaces){var st=PX(Ve(this.pdf,this.fontFaces),Je.map(function(ct){return{family:ct,stretch:"normal",weight:Xe,style:De}}));this.pdf.setFont(st.ref.name,st.ref.style)}else{var lt="";(Xe==="bold"||parseInt(Xe,10)>=700||De==="bold")&&(lt="bold"),De==="italic"&&(lt+="italic"),lt.length===0&&(lt="normal");for(var mt="",wt={arial:"Helvetica",Arial:"Helvetica",verdana:"Helvetica",Verdana:"Helvetica",helvetica:"Helvetica",Helvetica:"Helvetica","sans-serif":"Helvetica",fixed:"Courier",monospace:"Courier",terminal:"Courier",cursive:"Times",fantasy:"Times",serif:"Times"},Ot=0;Ot<Je.length;Ot++){if(this.pdf.internal.getFont(Je[Ot],lt,{noFallback:!0,disableWarning:!0})!==void 0){mt=Je[Ot];break}if(lt==="bolditalic"&&this.pdf.internal.getFont(Je[Ot],"bold",{noFallback:!0,disableWarning:!0})!==void 0)mt=Je[Ot],lt="bold";else if(this.pdf.internal.getFont(Je[Ot],"normal",{noFallback:!0,disableWarning:!0})!==void 0){mt=Je[Ot],lt="normal";break}}if(mt===""){for(var kt=0;kt<Je.length;kt++)if(wt[Je[kt]]){mt=wt[Je[kt]];break}}mt=mt===""?"Times":mt,this.pdf.setFont(mt,lt)}}}}),Object.defineProperty(this,"globalCompositeOperation",{get:function(){return this.ctx.globalCompositeOperation},set:function(Ce){this.ctx.globalCompositeOperation=Ce}}),Object.defineProperty(this,"globalAlpha",{get:function(){return this.ctx.globalAlpha},set:function(Ce){this.ctx.globalAlpha=Ce}}),Object.defineProperty(this,"lineDashOffset",{get:function(){return this.ctx.lineDashOffset},set:function(Ce){this.ctx.lineDashOffset=Ce,xe.call(this)}}),Object.defineProperty(this,"lineDash",{get:function(){return this.ctx.lineDash},set:function(Ce){this.ctx.lineDash=Ce,xe.call(this)}}),Object.defineProperty(this,"ignoreClearRect",{get:function(){return this.ctx.ignoreClearRect},set:function(Ce){this.ctx.ignoreClearRect=!!Ce}})};f.prototype.setLineDash=function(E){this.lineDash=E},f.prototype.getLineDash=function(){return this.lineDash.length%2?this.lineDash.concat(this.lineDash):this.lineDash.slice()},f.prototype.fill=function(){A.call(this,"fill",!1)},f.prototype.stroke=function(){A.call(this,"stroke",!1)},f.prototype.beginPath=function(){this.path=[{type:"begin"}]},f.prototype.moveTo=function(E,I){if(isNaN(E)||isNaN(I))throw or.error("jsPDF.context2d.moveTo: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.moveTo");var O=this.ctx.transform.applyToPoint(new s(E,I));this.path.push({type:"mt",x:O.x,y:O.y}),this.ctx.lastPoint=new s(E,I)},f.prototype.closePath=function(){var E=new s(0,0),I=0;for(I=this.path.length-1;I!==-1;I--)if(this.path[I].type==="begin"&&tr(this.path[I+1])==="object"&&typeof this.path[I+1].x=="number"){E=new s(this.path[I+1].x,this.path[I+1].y);break}this.path.push({type:"close"}),this.ctx.lastPoint=new s(E.x,E.y)},f.prototype.lineTo=function(E,I){if(isNaN(E)||isNaN(I))throw or.error("jsPDF.context2d.lineTo: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.lineTo");var O=this.ctx.transform.applyToPoint(new s(E,I));this.path.push({type:"lt",x:O.x,y:O.y}),this.ctx.lastPoint=new s(O.x,O.y)},f.prototype.clip=function(){this.ctx.clip_path=JSON.parse(JSON.stringify(this.path)),A.call(this,null,!0)},f.prototype.quadraticCurveTo=function(E,I,O,j){if(isNaN(O)||isNaN(j)||isNaN(E)||isNaN(I))throw or.error("jsPDF.context2d.quadraticCurveTo: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.quadraticCurveTo");var K=this.ctx.transform.applyToPoint(new s(O,j)),ne=this.ctx.transform.applyToPoint(new s(E,I));this.path.push({type:"qct",x1:ne.x,y1:ne.y,x:K.x,y:K.y}),this.ctx.lastPoint=new s(K.x,K.y)},f.prototype.bezierCurveTo=function(E,I,O,j,K,ne){if(isNaN(K)||isNaN(ne)||isNaN(E)||isNaN(I)||isNaN(O)||isNaN(j))throw or.error("jsPDF.context2d.bezierCurveTo: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.bezierCurveTo");var pe=this.ctx.transform.applyToPoint(new s(K,ne)),de=this.ctx.transform.applyToPoint(new s(E,I)),we=this.ctx.transform.applyToPoint(new s(O,j));this.path.push({type:"bct",x1:de.x,y1:de.y,x2:we.x,y2:we.y,x:pe.x,y:pe.y}),this.ctx.lastPoint=new s(pe.x,pe.y)},f.prototype.arc=function(E,I,O,j,K,ne){if(isNaN(E)||isNaN(I)||isNaN(O)||isNaN(j)||isNaN(K))throw or.error("jsPDF.context2d.arc: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.arc");if(ne=!!ne,!this.ctx.transform.isIdentity){var pe=this.ctx.transform.applyToPoint(new s(E,I));E=pe.x,I=pe.y;var de=this.ctx.transform.applyToPoint(new s(0,O)),we=this.ctx.transform.applyToPoint(new s(0,0));O=Math.sqrt(Math.pow(de.x-we.x,2)+Math.pow(de.y-we.y,2))}Math.abs(K-j)>=2*Math.PI&&(j=0,K=2*Math.PI),this.path.push({type:"arc",x:E,y:I,radius:O,startAngle:j,endAngle:K,counterclockwise:ne})},f.prototype.arcTo=function(E,I,O,j,K){throw new Error("arcTo not implemented.")},f.prototype.rect=function(E,I,O,j){if(isNaN(E)||isNaN(I)||isNaN(O)||isNaN(j))throw or.error("jsPDF.context2d.rect: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.rect");this.moveTo(E,I),this.lineTo(E+O,I),this.lineTo(E+O,I+j),this.lineTo(E,I+j),this.lineTo(E,I),this.lineTo(E+O,I),this.lineTo(E,I)},f.prototype.fillRect=function(E,I,O,j){if(isNaN(E)||isNaN(I)||isNaN(O)||isNaN(j))throw or.error("jsPDF.context2d.fillRect: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.fillRect");if(!h.call(this)){var K={};this.lineCap!=="butt"&&(K.lineCap=this.lineCap,this.lineCap="butt"),this.lineJoin!=="miter"&&(K.lineJoin=this.lineJoin,this.lineJoin="miter"),this.beginPath(),this.rect(E,I,O,j),this.fill(),K.hasOwnProperty("lineCap")&&(this.lineCap=K.lineCap),K.hasOwnProperty("lineJoin")&&(this.lineJoin=K.lineJoin)}},f.prototype.strokeRect=function(E,I,O,j){if(isNaN(E)||isNaN(I)||isNaN(O)||isNaN(j))throw or.error("jsPDF.context2d.strokeRect: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.strokeRect");g.call(this)||(this.beginPath(),this.rect(E,I,O,j),this.stroke())},f.prototype.clearRect=function(E,I,O,j){if(isNaN(E)||isNaN(I)||isNaN(O)||isNaN(j))throw or.error("jsPDF.context2d.clearRect: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.clearRect");this.ignoreClearRect||(this.fillStyle="#ffffff",this.fillRect(E,I,O,j))},f.prototype.save=function(E){E=typeof E!="boolean"||E;for(var I=this.pdf.internal.getCurrentPageInfo().pageNumber,O=0;O<this.pdf.internal.getNumberOfPages();O++)this.pdf.setPage(O+1),this.pdf.internal.out("q");if(this.pdf.setPage(I),E){this.ctx.fontSize=this.pdf.internal.getFontSize();var j=new u(this.ctx);this.ctxStack.push(this.ctx),this.ctx=j}},f.prototype.restore=function(E){E=typeof E!="boolean"||E;for(var I=this.pdf.internal.getCurrentPageInfo().pageNumber,O=0;O<this.pdf.internal.getNumberOfPages();O++)this.pdf.setPage(O+1),this.pdf.internal.out("Q");this.pdf.setPage(I),E&&this.ctxStack.length!==0&&(this.ctx=this.ctxStack.pop(),this.fillStyle=this.ctx.fillStyle,this.strokeStyle=this.ctx.strokeStyle,this.font=this.ctx.font,this.lineCap=this.ctx.lineCap,this.lineWidth=this.ctx.lineWidth,this.lineJoin=this.ctx.lineJoin,this.lineDash=this.ctx.lineDash,this.lineDashOffset=this.ctx.lineDashOffset)},f.prototype.toDataURL=function(){throw new Error("toDataUrl not implemented.")};var p=function(E){var I,O,j,K;if(E.isCanvasGradient===!0&&(E=E.getColor()),!E)return{r:0,g:0,b:0,a:0,style:E};if(/transparent|rgba\s*\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*,\s*0+\s*\)/.test(E))I=0,O=0,j=0,K=0;else{var ne=/rgb\s*\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*\)/.exec(E);if(ne!==null)I=parseInt(ne[1]),O=parseInt(ne[2]),j=parseInt(ne[3]),K=1;else if((ne=/rgba\s*\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*,\s*([\d.]+)\s*\)/.exec(E))!==null)I=parseInt(ne[1]),O=parseInt(ne[2]),j=parseInt(ne[3]),K=parseFloat(ne[4]);else{if(K=1,typeof E=="string"&&E.charAt(0)!=="#"){var pe=new kC(E);E=pe.ok?pe.toHex():"#000000"}E.length===4?(I=E.substring(1,2),I+=I,O=E.substring(2,3),O+=O,j=E.substring(3,4),j+=j):(I=E.substring(1,3),O=E.substring(3,5),j=E.substring(5,7)),I=parseInt(I,16),O=parseInt(O,16),j=parseInt(j,16)}}return{r:I,g:O,b:j,a:K,style:E}},h=function(){return this.ctx.isFillTransparent||this.globalAlpha==0},g=function(){return!!(this.ctx.isStrokeTransparent||this.globalAlpha==0)};f.prototype.fillText=function(E,I,O,j){if(isNaN(I)||isNaN(O)||typeof E!="string")throw or.error("jsPDF.context2d.fillText: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.fillText");if(j=isNaN(j)?void 0:j,!h.call(this)){var K=Q(this.ctx.transform.rotation),ne=this.ctx.transform.scaleX;P.call(this,{text:E,x:I,y:O,scale:ne,angle:K,align:this.textAlign,maxWidth:j})}},f.prototype.strokeText=function(E,I,O,j){if(isNaN(I)||isNaN(O)||typeof E!="string")throw or.error("jsPDF.context2d.strokeText: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.strokeText");if(!g.call(this)){j=isNaN(j)?void 0:j;var K=Q(this.ctx.transform.rotation),ne=this.ctx.transform.scaleX;P.call(this,{text:E,x:I,y:O,scale:ne,renderingMode:"stroke",angle:K,align:this.textAlign,maxWidth:j})}},f.prototype.measureText=function(E){if(typeof E!="string")throw or.error("jsPDF.context2d.measureText: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.measureText");var I=this.pdf,O=this.pdf.internal.scaleFactor,j=I.internal.getFontSize(),K=I.getStringUnitWidth(E)*j/I.internal.scaleFactor,ne=function(pe){var de=(pe=pe||{}).width||0;return Object.defineProperty(this,"width",{get:function(){return de}}),this};return new ne({width:K*=Math.round(96*O/72*1e4)/1e4})},f.prototype.scale=function(E,I){if(isNaN(E)||isNaN(I))throw or.error("jsPDF.context2d.scale: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.scale");var O=new l(E,0,0,I,0,0);this.ctx.transform=this.ctx.transform.multiply(O)},f.prototype.rotate=function(E){if(isNaN(E))throw or.error("jsPDF.context2d.rotate: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.rotate");var I=new l(Math.cos(E),Math.sin(E),-Math.sin(E),Math.cos(E),0,0);this.ctx.transform=this.ctx.transform.multiply(I)},f.prototype.translate=function(E,I){if(isNaN(E)||isNaN(I))throw or.error("jsPDF.context2d.translate: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.translate");var O=new l(1,0,0,1,E,I);this.ctx.transform=this.ctx.transform.multiply(O)},f.prototype.transform=function(E,I,O,j,K,ne){if(isNaN(E)||isNaN(I)||isNaN(O)||isNaN(j)||isNaN(K)||isNaN(ne))throw or.error("jsPDF.context2d.transform: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.transform");var pe=new l(E,I,O,j,K,ne);this.ctx.transform=this.ctx.transform.multiply(pe)},f.prototype.setTransform=function(E,I,O,j,K,ne){E=isNaN(E)?1:E,I=isNaN(I)?0:I,O=isNaN(O)?0:O,j=isNaN(j)?1:j,K=isNaN(K)?0:K,ne=isNaN(ne)?0:ne,this.ctx.transform=new l(E,I,O,j,K,ne)};var m=function(){return this.margin[0]>0||this.margin[1]>0||this.margin[2]>0||this.margin[3]>0};f.prototype.drawImage=function(E,I,O,j,K,ne,pe,de,we){var Pe=this.pdf.getImageProperties(E),Z=1,Ve=1,Ke=1,Ce=1;j!==void 0&&de!==void 0&&(Ke=de/j,Ce=we/K,Z=Pe.width/j*de/j,Ve=Pe.height/K*we/K),ne===void 0&&(ne=I,pe=O,I=0,O=0),j!==void 0&&de===void 0&&(de=j,we=K),j===void 0&&de===void 0&&(de=Pe.width,we=Pe.height);for(var ae,De=this.ctx.transform.decompose(),Xe=Q(De.rotate.shx),Me=new l,qe=(Me=(Me=(Me=Me.multiply(De.translate)).multiply(De.skew)).multiply(De.scale)).applyToRectangle(new o(ne-I*Ke,pe-O*Ce,j*Z,K*Ve)),Ye=b.call(this,qe),Je=[],st=0;st<Ye.length;st+=1)Je.indexOf(Ye[st])===-1&&Je.push(Ye[st]);if(y(Je),this.autoPaging)for(var lt=Je[0],mt=Je[Je.length-1],wt=lt;wt<mt+1;wt++){this.pdf.setPage(wt);var Ot=this.pdf.internal.pageSize.width-this.margin[3]-this.margin[1],kt=wt===1?this.posY+this.margin[0]:this.margin[0],ct=this.pdf.internal.pageSize.height-this.posY-this.margin[0]-this.margin[2],Ze=this.pdf.internal.pageSize.height-this.margin[0]-this.margin[2],ze=wt===1?0:ct+(wt-2)*Ze;if(this.ctx.clip_path.length!==0){var Jt=this.path;ae=JSON.parse(JSON.stringify(this.ctx.clip_path)),this.path=w(ae,this.posX+this.margin[3],-ze+kt+this.ctx.prevPageLastElemOffset),L.call(this,"fill",!0),this.path=Jt}var ht=JSON.parse(JSON.stringify(qe));ht=w([ht],this.posX+this.margin[3],-ze+kt+this.ctx.prevPageLastElemOffset)[0];var Zr=(wt>lt||wt<mt)&&m.call(this);Zr&&(this.pdf.saveGraphicsState(),this.pdf.rect(this.margin[3],this.margin[0],Ot,Ze,null).clip().discardPath()),this.pdf.addImage(E,"JPEG",ht.x,ht.y,ht.w,ht.h,null,null,Xe),Zr&&this.pdf.restoreGraphicsState()}else this.pdf.addImage(E,"JPEG",qe.x,qe.y,qe.w,qe.h,null,null,Xe)};var b=function(E,I,O){var j=[];I=I||this.pdf.internal.pageSize.width,O=O||this.pdf.internal.pageSize.height-this.margin[0]-this.margin[2];var K=this.posY+this.ctx.prevPageLastElemOffset;switch(E.type){default:case"mt":case"lt":j.push(Math.floor((E.y+K)/O)+1);break;case"arc":j.push(Math.floor((E.y+K-E.radius)/O)+1),j.push(Math.floor((E.y+K+E.radius)/O)+1);break;case"qct":var ne=q(this.ctx.lastPoint.x,this.ctx.lastPoint.y,E.x1,E.y1,E.x,E.y);j.push(Math.floor((ne.y+K)/O)+1),j.push(Math.floor((ne.y+ne.h+K)/O)+1);break;case"bct":var pe=he(this.ctx.lastPoint.x,this.ctx.lastPoint.y,E.x1,E.y1,E.x2,E.y2,E.x,E.y);j.push(Math.floor((pe.y+K)/O)+1),j.push(Math.floor((pe.y+pe.h+K)/O)+1);break;case"rect":j.push(Math.floor((E.y+K)/O)+1),j.push(Math.floor((E.y+E.h+K)/O)+1)}for(var de=0;de<j.length;de+=1)for(;this.pdf.internal.getNumberOfPages()<j[de];)x.call(this);return j},x=function(){var E=this.fillStyle,I=this.strokeStyle,O=this.font,j=this.lineCap,K=this.lineWidth,ne=this.lineJoin;this.pdf.addPage(),this.fillStyle=E,this.strokeStyle=I,this.font=O,this.lineCap=j,this.lineWidth=K,this.lineJoin=ne},w=function(E,I,O){for(var j=0;j<E.length;j++)switch(E[j].type){case"bct":E[j].x2+=I,E[j].y2+=O;case"qct":E[j].x1+=I,E[j].y1+=O;case"mt":case"lt":case"arc":default:E[j].x+=I,E[j].y+=O}return E},y=function(E){return E.sort(function(I,O){return I-O})},A=function(E,I){for(var O,j,K=this.fillStyle,ne=this.strokeStyle,pe=this.lineCap,de=this.lineWidth,we=Math.abs(de*this.ctx.transform.scaleX),Pe=this.lineJoin,Z=JSON.parse(JSON.stringify(this.path)),Ve=JSON.parse(JSON.stringify(this.path)),Ke=[],Ce=0;Ce<Ve.length;Ce++)if(Ve[Ce].x!==void 0)for(var ae=b.call(this,Ve[Ce]),De=0;De<ae.length;De+=1)Ke.indexOf(ae[De])===-1&&Ke.push(ae[De]);for(var Xe=0;Xe<Ke.length;Xe++)for(;this.pdf.internal.getNumberOfPages()<Ke[Xe];)x.call(this);if(y(Ke),this.autoPaging)for(var Me=Ke[0],qe=Ke[Ke.length-1],Ye=Me;Ye<qe+1;Ye++){this.pdf.setPage(Ye),this.fillStyle=K,this.strokeStyle=ne,this.lineCap=pe,this.lineWidth=we,this.lineJoin=Pe;var Je=this.pdf.internal.pageSize.width-this.margin[3]-this.margin[1],st=Ye===1?this.posY+this.margin[0]:this.margin[0],lt=this.pdf.internal.pageSize.height-this.posY-this.margin[0]-this.margin[2],mt=this.pdf.internal.pageSize.height-this.margin[0]-this.margin[2],wt=Ye===1?0:lt+(Ye-2)*mt;if(this.ctx.clip_path.length!==0){var Ot=this.path;O=JSON.parse(JSON.stringify(this.ctx.clip_path)),this.path=w(O,this.posX+this.margin[3],-wt+st+this.ctx.prevPageLastElemOffset),L.call(this,E,!0),this.path=Ot}if(j=JSON.parse(JSON.stringify(Z)),this.path=w(j,this.posX+this.margin[3],-wt+st+this.ctx.prevPageLastElemOffset),I===!1||Ye===0){var kt=(Ye>Me||Ye<qe)&&m.call(this);kt&&(this.pdf.saveGraphicsState(),this.pdf.rect(this.margin[3],this.margin[0],Je,mt,null).clip().discardPath()),L.call(this,E,I),kt&&this.pdf.restoreGraphicsState()}this.lineWidth=de}else this.lineWidth=we,L.call(this,E,I),this.lineWidth=de;this.path=Z},L=function(E,I){if((E!=="stroke"||I||!g.call(this))&&(E==="stroke"||I||!h.call(this))){for(var O,j,K=[],ne=this.path,pe=0;pe<ne.length;pe++){var de=ne[pe];switch(de.type){case"begin":K.push({begin:!0});break;case"close":K.push({close:!0});break;case"mt":K.push({start:de,deltas:[],abs:[]});break;case"lt":var we=K.length;if(ne[pe-1]&&!isNaN(ne[pe-1].x)&&(O=[de.x-ne[pe-1].x,de.y-ne[pe-1].y],we>0)){for(;we>=0;we--)if(K[we-1].close!==!0&&K[we-1].begin!==!0){K[we-1].deltas.push(O),K[we-1].abs.push(de);break}}break;case"bct":O=[de.x1-ne[pe-1].x,de.y1-ne[pe-1].y,de.x2-ne[pe-1].x,de.y2-ne[pe-1].y,de.x-ne[pe-1].x,de.y-ne[pe-1].y],K[K.length-1].deltas.push(O);break;case"qct":var Pe=ne[pe-1].x+2/3*(de.x1-ne[pe-1].x),Z=ne[pe-1].y+2/3*(de.y1-ne[pe-1].y),Ve=de.x+2/3*(de.x1-de.x),Ke=de.y+2/3*(de.y1-de.y),Ce=de.x,ae=de.y;O=[Pe-ne[pe-1].x,Z-ne[pe-1].y,Ve-ne[pe-1].x,Ke-ne[pe-1].y,Ce-ne[pe-1].x,ae-ne[pe-1].y],K[K.length-1].deltas.push(O);break;case"arc":K.push({deltas:[],abs:[],arc:!0}),Array.isArray(K[K.length-1].abs)&&K[K.length-1].abs.push(de)}}j=I?null:E==="stroke"?"stroke":"fill";for(var De=!1,Xe=0;Xe<K.length;Xe++)if(K[Xe].arc)for(var Me=K[Xe].abs,qe=0;qe<Me.length;qe++){var Ye=Me[qe];Ye.type==="arc"?F.call(this,Ye.x,Ye.y,Ye.radius,Ye.startAngle,Ye.endAngle,Ye.counterclockwise,void 0,I,!De):J.call(this,Ye.x,Ye.y),De=!0}else if(K[Xe].close===!0)this.pdf.internal.out("h"),De=!1;else if(K[Xe].begin!==!0){var Je=K[Xe].start.x,st=K[Xe].start.y;W.call(this,K[Xe].deltas,Je,st),De=!0}j&&R.call(this,j),I&&X.call(this)}},D=function(E){var I=this.pdf.internal.getFontSize()/this.pdf.internal.scaleFactor,O=I*(this.pdf.internal.getLineHeightFactor()-1);switch(this.ctx.textBaseline){case"bottom":return E-O;case"top":return E+I-O;case"hanging":return E+I-2*O;case"middle":return E+I/2-O;case"ideographic":return E;case"alphabetic":default:return E}},T=function(E){return E+this.pdf.internal.getFontSize()/this.pdf.internal.scaleFactor*(this.pdf.internal.getLineHeightFactor()-1)};f.prototype.createLinearGradient=function(){var E=function(){};return E.colorStops=[],E.addColorStop=function(I,O){this.colorStops.push([I,O])},E.getColor=function(){return this.colorStops.length===0?"#000000":this.colorStops[0][1]},E.isCanvasGradient=!0,E},f.prototype.createPattern=function(){return this.createLinearGradient()},f.prototype.createRadialGradient=function(){return this.createLinearGradient()};var F=function(E,I,O,j,K,ne,pe,de,we){for(var Pe=fe.call(this,O,j,K,ne),Z=0;Z<Pe.length;Z++){var Ve=Pe[Z];Z===0&&(we?N.call(this,Ve.x1+E,Ve.y1+I):J.call(this,Ve.x1+E,Ve.y1+I)),se.call(this,E,I,Ve.x2,Ve.y2,Ve.x3,Ve.y3,Ve.x4,Ve.y4)}de?X.call(this):R.call(this,pe)},R=function(E){switch(E){case"stroke":this.pdf.internal.out("S");break;case"fill":this.pdf.internal.out("f")}},X=function(){this.pdf.clip(),this.pdf.discardPath()},N=function(E,I){this.pdf.internal.out(r(E)+" "+n(I)+" m")},P=function(E){var I;switch(E.align){case"right":case"end":I="right";break;case"center":I="center";break;case"left":case"start":default:I="left"}var O=this.pdf.getTextDimensions(E.text),j=D.call(this,E.y),K=T.call(this,j)-O.h,ne=this.ctx.transform.applyToPoint(new s(E.x,j)),pe=this.ctx.transform.decompose(),de=new l;de=(de=(de=de.multiply(pe.translate)).multiply(pe.skew)).multiply(pe.scale);for(var we,Pe,Z,Ve=this.ctx.transform.applyToRectangle(new o(E.x,j,O.w,O.h)),Ke=de.applyToRectangle(new o(E.x,K,O.w,O.h)),Ce=b.call(this,Ke),ae=[],De=0;De<Ce.length;De+=1)ae.indexOf(Ce[De])===-1&&ae.push(Ce[De]);if(y(ae),this.autoPaging)for(var Xe=ae[0],Me=ae[ae.length-1],qe=Xe;qe<Me+1;qe++){this.pdf.setPage(qe);var Ye=qe===1?this.posY+this.margin[0]:this.margin[0],Je=this.pdf.internal.pageSize.height-this.posY-this.margin[0]-this.margin[2],st=this.pdf.internal.pageSize.height-this.margin[2],lt=st-this.margin[0],mt=this.pdf.internal.pageSize.width-this.margin[1],wt=mt-this.margin[3],Ot=qe===1?0:Je+(qe-2)*lt;if(this.ctx.clip_path.length!==0){var kt=this.path;we=JSON.parse(JSON.stringify(this.ctx.clip_path)),this.path=w(we,this.posX+this.margin[3],-1*Ot+Ye),L.call(this,"fill",!0),this.path=kt}var ct=w([JSON.parse(JSON.stringify(Ke))],this.posX+this.margin[3],-Ot+Ye+this.ctx.prevPageLastElemOffset)[0];E.scale>=.01&&(Pe=this.pdf.internal.getFontSize(),this.pdf.setFontSize(Pe*E.scale),Z=this.lineWidth,this.lineWidth=Z*E.scale);var Ze=this.autoPaging!=="text";if(Ze||ct.y+ct.h<=st){if(Ze||ct.y>=Ye&&ct.x<=mt){var ze=Ze?E.text:this.pdf.splitTextToSize(E.text,E.maxWidth||mt-ct.x)[0],Jt=w([JSON.parse(JSON.stringify(Ve))],this.posX+this.margin[3],-Ot+Ye+this.ctx.prevPageLastElemOffset)[0],ht=Ze&&(qe>Xe||qe<Me)&&m.call(this);ht&&(this.pdf.saveGraphicsState(),this.pdf.rect(this.margin[3],this.margin[0],wt,lt,null).clip().discardPath()),this.pdf.text(ze,Jt.x,Jt.y,{angle:E.angle,align:I,renderingMode:E.renderingMode}),ht&&this.pdf.restoreGraphicsState()}}else ct.y<st&&(this.ctx.prevPageLastElemOffset+=st-ct.y);E.scale>=.01&&(this.pdf.setFontSize(Pe),this.lineWidth=Z)}else E.scale>=.01&&(Pe=this.pdf.internal.getFontSize(),this.pdf.setFontSize(Pe*E.scale),Z=this.lineWidth,this.lineWidth=Z*E.scale),this.pdf.text(E.text,ne.x+this.posX,ne.y+this.posY,{angle:E.angle,align:I,renderingMode:E.renderingMode,maxWidth:E.maxWidth}),E.scale>=.01&&(this.pdf.setFontSize(Pe),this.lineWidth=Z)},J=function(E,I,O,j){O=O||0,j=j||0,this.pdf.internal.out(r(E+O)+" "+n(I+j)+" l")},W=function(E,I,O){return this.pdf.lines(E,I,O,null,null)},se=function(E,I,O,j,K,ne,pe,de){this.pdf.internal.out([t(a(O+E)),t(i(j+I)),t(a(K+E)),t(i(ne+I)),t(a(pe+E)),t(i(de+I)),"c"].join(" "))},fe=function(E,I,O,j){for(var K=2*Math.PI,ne=Math.PI/2;I>O;)I-=K;var pe=Math.abs(O-I);pe<K&&j&&(pe=K-pe);for(var de=[],we=j?-1:1,Pe=I;pe>1e-5;){var Z=Pe+we*Math.min(pe,ne);de.push(U.call(this,E,Pe,Z)),pe-=Math.abs(Z-Pe),Pe=Z}return de},U=function(E,I,O){var j=(O-I)/2,K=E*Math.cos(j),ne=E*Math.sin(j),pe=K,de=-ne,we=pe*pe+de*de,Pe=we+pe*K+de*ne,Z=4/3*(Math.sqrt(2*we*Pe)-Pe)/(pe*ne-de*K),Ve=pe-Z*de,Ke=de+Z*pe,Ce=Ve,ae=-Ke,De=j+I,Xe=Math.cos(De),Me=Math.sin(De);return{x1:E*Math.cos(I),y1:E*Math.sin(I),x2:Ve*Xe-Ke*Me,y2:Ve*Me+Ke*Xe,x3:Ce*Xe-ae*Me,y3:Ce*Me+ae*Xe,x4:E*Math.cos(O),y4:E*Math.sin(O)}},Q=function(E){return 180*E/Math.PI},q=function(E,I,O,j,K,ne){var pe=E+.5*(O-E),de=I+.5*(j-I),we=K+.5*(O-K),Pe=ne+.5*(j-ne),Z=Math.min(E,K,pe,we),Ve=Math.max(E,K,pe,we),Ke=Math.min(I,ne,de,Pe),Ce=Math.max(I,ne,de,Pe);return new o(Z,Ke,Ve-Z,Ce-Ke)},he=function(E,I,O,j,K,ne,pe,de){var we,Pe,Z,Ve,Ke,Ce,ae,De,Xe,Me,qe,Ye,Je,st,lt=O-E,mt=j-I,wt=K-O,Ot=ne-j,kt=pe-K,ct=de-ne;for(Pe=0;Pe<41;Pe++)Xe=(ae=(Z=E+(we=Pe/40)*lt)+we*((Ke=O+we*wt)-Z))+we*(Ke+we*(K+we*kt-Ke)-ae),Me=(De=(Ve=I+we*mt)+we*((Ce=j+we*Ot)-Ve))+we*(Ce+we*(ne+we*ct-Ce)-De),Pe==0?(qe=Xe,Ye=Me,Je=Xe,st=Me):(qe=Math.min(qe,Xe),Ye=Math.min(Ye,Me),Je=Math.max(Je,Xe),st=Math.max(st,Me));return new o(Math.round(qe),Math.round(Ye),Math.round(Je-qe),Math.round(st-Ye))},xe=function(){if(this.prevLineDash||this.ctx.lineDash.length||this.ctx.lineDashOffset){var E,I,O=(E=this.ctx.lineDash,I=this.ctx.lineDashOffset,JSON.stringify({lineDash:E,lineDashOffset:I}));this.prevLineDash!==O&&(this.pdf.setLineDash(this.ctx.lineDash,this.ctx.lineDashOffset),this.prevLineDash=O)}}})(vt.API),function(e){var t=function(i){var s,o,l,c,u,f,p,h,g,m;for(o=[],l=0,c=(i+=s="\0\0\0\0".slice(i.length%4||4)).length;c>l;l+=4)(u=(i.charCodeAt(l)<<24)+(i.charCodeAt(l+1)<<16)+(i.charCodeAt(l+2)<<8)+i.charCodeAt(l+3))!==0?(f=(u=((u=((u=((u=(u-(m=u%85))/85)-(g=u%85))/85)-(h=u%85))/85)-(p=u%85))/85)%85,o.push(f+33,p+33,h+33,g+33,m+33)):o.push(122);return function(b,x){for(var w=x;w>0;w--)b.pop()}(o,s.length),String.fromCharCode.apply(String,o)+"~>"},r=function(i){var s,o,l,c,u,f=String,p="length",h=255,g="charCodeAt",m="slice",b="replace";for(i[m](-2),i=i[m](0,-2)[b](/\s/g,"")[b]("z","!!!!!"),l=[],c=0,u=(i+=s="uuuuu"[m](i[p]%5||5))[p];u>c;c+=5)o=52200625*(i[g](c)-33)+614125*(i[g](c+1)-33)+7225*(i[g](c+2)-33)+85*(i[g](c+3)-33)+(i[g](c+4)-33),l.push(h&o>>24,h&o>>16,h&o>>8,h&o);return function(x,w){for(var y=w;y>0;y--)x.pop()}(l,s[p]),f.fromCharCode.apply(f,l)},n=function(i){var s=new RegExp(/^([0-9A-Fa-f]{2})+$/);if((i=i.replace(/\s/g,"")).indexOf(">")!==-1&&(i=i.substr(0,i.indexOf(">"))),i.length%2&&(i+="0"),s.test(i)===!1)return"";for(var o="",l=0;l<i.length;l+=2)o+=String.fromCharCode("0x"+(i[l]+i[l+1]));return o},a=function(i){for(var s=new Uint8Array(i.length),o=i.length;o--;)s[o]=i.charCodeAt(o);return i=(s=yx(s)).reduce(function(l,c){return l+String.fromCharCode(c)},"")};e.processDataByFilters=function(i,s){var o=0,l=i||"",c=[];for(typeof(s=s||[])=="string"&&(s=[s]),o=0;o<s.length;o+=1)switch(s[o]){case"ASCII85Decode":case"/ASCII85Decode":l=r(l),c.push("/ASCII85Encode");break;case"ASCII85Encode":case"/ASCII85Encode":l=t(l),c.push("/ASCII85Decode");break;case"ASCIIHexDecode":case"/ASCIIHexDecode":l=n(l),c.push("/ASCIIHexEncode");break;case"ASCIIHexEncode":case"/ASCIIHexEncode":l=l.split("").map(function(u){return("0"+u.charCodeAt().toString(16)).slice(-2)}).join("")+">",c.push("/ASCIIHexDecode");break;case"FlateEncode":case"/FlateEncode":l=a(l),c.push("/FlateDecode");break;default:throw new Error('The filter: "'+s[o]+'" is not implemented')}return{data:l,reverseChain:c.reverse().join(" ")}}}(vt.API),function(e){e.loadFile=function(t,r,n){return function(a,i,s){i=i!==!1,s=typeof s=="function"?s:function(){};var o=void 0;try{o=function(l,c,u){var f=new XMLHttpRequest,p=0,h=function(g){var m=g.length,b=[],x=String.fromCharCode;for(p=0;p<m;p+=1)b.push(x(255&g.charCodeAt(p)));return b.join("")};if(f.open("GET",l,!c),f.overrideMimeType("text/plain; charset=x-user-defined"),c===!1&&(f.onload=function(){f.status===200?u(h(this.responseText)):u(void 0)}),f.send(null),c&&f.status===200)return h(f.responseText)}(a,i,s)}catch{}return o}(t,r,n)},e.loadImageFile=e.loadFile}(vt.API),function(e){function t(){return(xt.html2canvas?Promise.resolve(xt.html2canvas):Zo(()=>import("./html2canvas.esm-CBrSDip1.js"),[])).catch(function(s){return Promise.reject(new Error("Could not load html2canvas: "+s))}).then(function(s){return s.default?s.default:s})}function r(){return(xt.DOMPurify?Promise.resolve(xt.DOMPurify):Zo(()=>import("./purify.es-BFmuJLeH.js"),[])).catch(function(s){return Promise.reject(new Error("Could not load dompurify: "+s))}).then(function(s){return s.default?s.default:s})}var n=function(s){var o=tr(s);return o==="undefined"?"undefined":o==="string"||s instanceof String?"string":o==="number"||s instanceof Number?"number":o==="function"||s instanceof Function?"function":s&&s.constructor===Array?"array":s&&s.nodeType===1?"element":o==="object"?"object":"unknown"},a=function(s,o){var l=document.createElement(s);for(var c in o.className&&(l.className=o.className),o.innerHTML&&o.dompurify&&(l.innerHTML=o.dompurify.sanitize(o.innerHTML)),o.style)l.style[c]=o.style[c];return l},i=function s(o){var l=Object.assign(s.convert(Promise.resolve()),JSON.parse(JSON.stringify(s.template))),c=s.convert(Promise.resolve(),l);return c=(c=c.setProgress(1,s,1,[s])).set(o)};(i.prototype=Object.create(Promise.prototype)).constructor=i,i.convert=function(s,o){return s.__proto__=o||i.prototype,s},i.template={prop:{src:null,container:null,overlay:null,canvas:null,img:null,pdf:null,pageSize:null,callback:function(){}},progress:{val:0,state:null,n:0,stack:[]},opt:{filename:"file.pdf",margin:[0,0,0,0],enableLinks:!0,x:0,y:0,html2canvas:{},jsPDF:{},backgroundColor:"transparent"}},i.prototype.from=function(s,o){return this.then(function(){switch(o=o||function(l){switch(n(l)){case"string":return"string";case"element":return l.nodeName.toLowerCase()==="canvas"?"canvas":"element";default:return"unknown"}}(s)){case"string":return this.then(r).then(function(l){return this.set({src:a("div",{innerHTML:s,dompurify:l})})});case"element":return this.set({src:s});case"canvas":return this.set({canvas:s});case"img":return this.set({img:s});default:return this.error("Unknown source type.")}})},i.prototype.to=function(s){switch(s){case"container":return this.toContainer();case"canvas":return this.toCanvas();case"img":return this.toImg();case"pdf":return this.toPdf();default:return this.error("Invalid target.")}},i.prototype.toContainer=function(){return this.thenList([function(){return this.prop.src||this.error("Cannot duplicate - no source HTML.")},function(){return this.prop.pageSize||this.setPageSize()}]).then(function(){var s={position:"relative",display:"inline-block",width:(typeof this.opt.width!="number"||isNaN(this.opt.width)||typeof this.opt.windowWidth!="number"||isNaN(this.opt.windowWidth)?Math.max(this.prop.src.clientWidth,this.prop.src.scrollWidth,this.prop.src.offsetWidth):this.opt.windowWidth)+"px",left:0,right:0,top:0,margin:"auto",backgroundColor:this.opt.backgroundColor},o=function l(c,u){for(var f=c.nodeType===3?document.createTextNode(c.nodeValue):c.cloneNode(!1),p=c.firstChild;p;p=p.nextSibling)u!==!0&&p.nodeType===1&&p.nodeName==="SCRIPT"||f.appendChild(l(p,u));return c.nodeType===1&&(c.nodeName==="CANVAS"?(f.width=c.width,f.height=c.height,f.getContext("2d").drawImage(c,0,0)):c.nodeName!=="TEXTAREA"&&c.nodeName!=="SELECT"||(f.value=c.value),f.addEventListener("load",function(){f.scrollTop=c.scrollTop,f.scrollLeft=c.scrollLeft},!0)),f}(this.prop.src,this.opt.html2canvas.javascriptEnabled);o.tagName==="BODY"&&(s.height=Math.max(document.body.scrollHeight,document.body.offsetHeight,document.documentElement.clientHeight,document.documentElement.scrollHeight,document.documentElement.offsetHeight)+"px"),this.prop.overlay=a("div",{className:"html2pdf__overlay",style:{position:"fixed",overflow:"hidden",zIndex:1e3,left:"-100000px",right:0,bottom:0,top:0}}),this.prop.container=a("div",{className:"html2pdf__container",style:s}),this.prop.container.appendChild(o),this.prop.container.firstChild.appendChild(a("div",{style:{clear:"both",border:"0 none transparent",margin:0,padding:0,height:0}})),this.prop.container.style.float="none",this.prop.overlay.appendChild(this.prop.container),document.body.appendChild(this.prop.overlay),this.prop.container.firstChild.style.position="relative",this.prop.container.height=Math.max(this.prop.container.firstChild.clientHeight,this.prop.container.firstChild.scrollHeight,this.prop.container.firstChild.offsetHeight)+"px"})},i.prototype.toCanvas=function(){var s=[function(){return document.body.contains(this.prop.container)||this.toContainer()}];return this.thenList(s).then(t).then(function(o){var l=Object.assign({},this.opt.html2canvas);return delete l.onrendered,o(this.prop.container,l)}).then(function(o){(this.opt.html2canvas.onrendered||function(){})(o),this.prop.canvas=o,document.body.removeChild(this.prop.overlay)})},i.prototype.toContext2d=function(){var s=[function(){return document.body.contains(this.prop.container)||this.toContainer()}];return this.thenList(s).then(t).then(function(o){var l=this.opt.jsPDF,c=this.opt.fontFaces,u=typeof this.opt.width!="number"||isNaN(this.opt.width)||typeof this.opt.windowWidth!="number"||isNaN(this.opt.windowWidth)?1:this.opt.width/this.opt.windowWidth,f=Object.assign({async:!0,allowTaint:!0,scale:u,scrollX:this.opt.scrollX||0,scrollY:this.opt.scrollY||0,backgroundColor:"#ffffff",imageTimeout:15e3,logging:!0,proxy:null,removeContainer:!0,foreignObjectRendering:!1,useCORS:!1},this.opt.html2canvas);if(delete f.onrendered,l.context2d.autoPaging=this.opt.autoPaging===void 0||this.opt.autoPaging,l.context2d.posX=this.opt.x,l.context2d.posY=this.opt.y,l.context2d.margin=this.opt.margin,l.context2d.fontFaces=c,c)for(var p=0;p<c.length;++p){var h=c[p],g=h.src.find(function(m){return m.format==="truetype"});g&&l.addFont(g.url,h.ref.name,h.ref.style)}return f.windowHeight=f.windowHeight||0,f.windowHeight=f.windowHeight==0?Math.max(this.prop.container.clientHeight,this.prop.container.scrollHeight,this.prop.container.offsetHeight):f.windowHeight,l.context2d.save(!0),o(this.prop.container,f)}).then(function(o){this.opt.jsPDF.context2d.restore(!0),(this.opt.html2canvas.onrendered||function(){})(o),this.prop.canvas=o,document.body.removeChild(this.prop.overlay)})},i.prototype.toImg=function(){return this.thenList([function(){return this.prop.canvas||this.toCanvas()}]).then(function(){var s=this.prop.canvas.toDataURL("image/"+this.opt.image.type,this.opt.image.quality);this.prop.img=document.createElement("img"),this.prop.img.src=s})},i.prototype.toPdf=function(){return this.thenList([function(){return this.toContext2d()}]).then(function(){this.prop.pdf=this.prop.pdf||this.opt.jsPDF})},i.prototype.output=function(s,o,l){return(l=l||"pdf").toLowerCase()==="img"||l.toLowerCase()==="image"?this.outputImg(s,o):this.outputPdf(s,o)},i.prototype.outputPdf=function(s,o){return this.thenList([function(){return this.prop.pdf||this.toPdf()}]).then(function(){return this.prop.pdf.output(s,o)})},i.prototype.outputImg=function(s){return this.thenList([function(){return this.prop.img||this.toImg()}]).then(function(){switch(s){case void 0:case"img":return this.prop.img;case"datauristring":case"dataurlstring":return this.prop.img.src;case"datauri":case"dataurl":return document.location.href=this.prop.img.src;default:throw'Image output type "'+s+'" is not supported.'}})},i.prototype.save=function(s){return this.thenList([function(){return this.prop.pdf||this.toPdf()}]).set(s?{filename:s}:null).then(function(){this.prop.pdf.save(this.opt.filename)})},i.prototype.doCallback=function(){return this.thenList([function(){return this.prop.pdf||this.toPdf()}]).then(function(){this.prop.callback(this.prop.pdf)})},i.prototype.set=function(s){if(n(s)!=="object")return this;var o=Object.keys(s||{}).map(function(l){if(l in i.template.prop)return function(){this.prop[l]=s[l]};switch(l){case"margin":return this.setMargin.bind(this,s.margin);case"jsPDF":return function(){return this.opt.jsPDF=s.jsPDF,this.setPageSize()};case"pageSize":return this.setPageSize.bind(this,s.pageSize);default:return function(){this.opt[l]=s[l]}}},this);return this.then(function(){return this.thenList(o)})},i.prototype.get=function(s,o){return this.then(function(){var l=s in i.template.prop?this.prop[s]:this.opt[s];return o?o(l):l})},i.prototype.setMargin=function(s){return this.then(function(){switch(n(s)){case"number":s=[s,s,s,s];case"array":if(s.length===2&&(s=[s[0],s[1],s[0],s[1]]),s.length===4)break;default:return this.error("Invalid margin array.")}this.opt.margin=s}).then(this.setPageSize)},i.prototype.setPageSize=function(s){function o(l,c){return Math.floor(l*c/72*96)}return this.then(function(){(s=s||vt.getPageSize(this.opt.jsPDF)).hasOwnProperty("inner")||(s.inner={width:s.width-this.opt.margin[1]-this.opt.margin[3],height:s.height-this.opt.margin[0]-this.opt.margin[2]},s.inner.px={width:o(s.inner.width,s.k),height:o(s.inner.height,s.k)},s.inner.ratio=s.inner.height/s.inner.width),this.prop.pageSize=s})},i.prototype.setProgress=function(s,o,l,c){return s!=null&&(this.progress.val=s),o!=null&&(this.progress.state=o),l!=null&&(this.progress.n=l),c!=null&&(this.progress.stack=c),this.progress.ratio=this.progress.val/this.progress.state,this},i.prototype.updateProgress=function(s,o,l,c){return this.setProgress(s?this.progress.val+s:null,o||null,l?this.progress.n+l:null,c?this.progress.stack.concat(c):null)},i.prototype.then=function(s,o){var l=this;return this.thenCore(s,o,function(c,u){return l.updateProgress(null,null,1,[c]),Promise.prototype.then.call(this,function(f){return l.updateProgress(null,c),f}).then(c,u).then(function(f){return l.updateProgress(1),f})})},i.prototype.thenCore=function(s,o,l){l=l||Promise.prototype.then,s&&(s=s.bind(this)),o&&(o=o.bind(this));var c=Promise.toString().indexOf("[native code]")!==-1&&Promise.name==="Promise"?this:i.convert(Object.assign({},this),Promise.prototype),u=l.call(c,s,o);return i.convert(u,this.__proto__)},i.prototype.thenExternal=function(s,o){return Promise.prototype.then.call(this,s,o)},i.prototype.thenList=function(s){var o=this;return s.forEach(function(l){o=o.thenCore(l)}),o},i.prototype.catch=function(s){s&&(s=s.bind(this));var o=Promise.prototype.catch.call(this,s);return i.convert(o,this)},i.prototype.catchExternal=function(s){return Promise.prototype.catch.call(this,s)},i.prototype.error=function(s){return this.then(function(){throw new Error(s)})},i.prototype.using=i.prototype.set,i.prototype.saveAs=i.prototype.save,i.prototype.export=i.prototype.output,i.prototype.run=i.prototype.then,vt.getPageSize=function(s,o,l){if(tr(s)==="object"){var c=s;s=c.orientation,o=c.unit||o,l=c.format||l}o=o||"mm",l=l||"a4",s=(""+(s||"P")).toLowerCase();var u,f=(""+l).toLowerCase(),p={a0:[2383.94,3370.39],a1:[1683.78,2383.94],a2:[1190.55,1683.78],a3:[841.89,1190.55],a4:[595.28,841.89],a5:[419.53,595.28],a6:[297.64,419.53],a7:[209.76,297.64],a8:[147.4,209.76],a9:[104.88,147.4],a10:[73.7,104.88],b0:[2834.65,4008.19],b1:[2004.09,2834.65],b2:[1417.32,2004.09],b3:[1000.63,1417.32],b4:[708.66,1000.63],b5:[498.9,708.66],b6:[354.33,498.9],b7:[249.45,354.33],b8:[175.75,249.45],b9:[124.72,175.75],b10:[87.87,124.72],c0:[2599.37,3676.54],c1:[1836.85,2599.37],c2:[1298.27,1836.85],c3:[918.43,1298.27],c4:[649.13,918.43],c5:[459.21,649.13],c6:[323.15,459.21],c7:[229.61,323.15],c8:[161.57,229.61],c9:[113.39,161.57],c10:[79.37,113.39],dl:[311.81,623.62],letter:[612,792],"government-letter":[576,756],legal:[612,1008],"junior-legal":[576,360],ledger:[1224,792],tabloid:[792,1224],"credit-card":[153,243]};switch(o){case"pt":u=1;break;case"mm":u=72/25.4;break;case"cm":u=72/2.54;break;case"in":u=72;break;case"px":u=.75;break;case"pc":case"em":u=12;break;case"ex":u=6;break;default:throw"Invalid unit: "+o}var h,g=0,m=0;if(p.hasOwnProperty(f))g=p[f][1]/u,m=p[f][0]/u;else try{g=l[1],m=l[0]}catch{throw new Error("Invalid format: "+l)}if(s==="p"||s==="portrait")s="p",m>g&&(h=m,m=g,g=h);else{if(s!=="l"&&s!=="landscape")throw"Invalid orientation: "+s;s="l",g>m&&(h=m,m=g,g=h)}return{width:m,height:g,unit:o,k:u,orientation:s}},e.html=function(s,o){(o=o||{}).callback=o.callback||function(){},o.html2canvas=o.html2canvas||{},o.html2canvas.canvas=o.html2canvas.canvas||this.canvas,o.jsPDF=o.jsPDF||this,o.fontFaces=o.fontFaces?o.fontFaces.map(Ex):null;var l=new i(o);return o.worker?l:l.from(s).doCallback()}}(vt.API),vt.API.addJS=function(e){return S_=e,this.internal.events.subscribe("postPutResources",function(){dp=this.internal.newObject(),this.internal.out("<<"),this.internal.out("/Names [(EmbeddedJS) "+(dp+1)+" 0 R]"),this.internal.out(">>"),this.internal.out("endobj"),__=this.internal.newObject(),this.internal.out("<<"),this.internal.out("/S /JavaScript"),this.internal.out("/JS ("+S_+")"),this.internal.out(">>"),this.internal.out("endobj")}),this.internal.events.subscribe("putCatalog",function(){dp!==void 0&&__!==void 0&&this.internal.out("/Names <</JavaScript "+dp+" 0 R>>")}),this},function(e){var t;e.events.push(["postPutResources",function(){var r=this,n=/^(\d+) 0 obj$/;if(this.outline.root.children.length>0)for(var a=r.outline.render().split(/\r\n/),i=0;i<a.length;i++){var s=a[i],o=n.exec(s);if(o!=null){var l=o[1];r.internal.newObjectDeferredBegin(l,!1)}r.internal.write(s)}if(this.outline.createNamedDestinations){var c=this.internal.pages.length,u=[];for(i=0;i<c;i++){var f=r.internal.newObject();u.push(f);var p=r.internal.getPageInfo(i+1);r.internal.write("<< /D["+p.objId+" 0 R /XYZ null null null]>> endobj")}var h=r.internal.newObject();for(r.internal.write("<< /Names [ "),i=0;i<u.length;i++)r.internal.write("(page_"+(i+1)+")"+u[i]+" 0 R");r.internal.write(" ] >>","endobj"),t=r.internal.newObject(),r.internal.write("<< /Dests "+h+" 0 R"),r.internal.write(">>","endobj")}}]),e.events.push(["putCatalog",function(){this.outline.root.children.length>0&&(this.internal.write("/Outlines",this.outline.makeRef(this.outline.root)),this.outline.createNamedDestinations&&this.internal.write("/Names "+t+" 0 R"))}]),e.events.push(["initialized",function(){var r=this;r.outline={createNamedDestinations:!1,root:{children:[]}},r.outline.add=function(n,a,i){var s={title:a,options:i,children:[]};return n==null&&(n=this.root),n.children.push(s),s},r.outline.render=function(){return this.ctx={},this.ctx.val="",this.ctx.pdf=r,this.genIds_r(this.root),this.renderRoot(this.root),this.renderItems(this.root),this.ctx.val},r.outline.genIds_r=function(n){n.id=r.internal.newObjectDeferred();for(var a=0;a<n.children.length;a++)this.genIds_r(n.children[a])},r.outline.renderRoot=function(n){this.objStart(n),this.line("/Type /Outlines"),n.children.length>0&&(this.line("/First "+this.makeRef(n.children[0])),this.line("/Last "+this.makeRef(n.children[n.children.length-1]))),this.line("/Count "+this.count_r({count:0},n)),this.objEnd()},r.outline.renderItems=function(n){for(var a=this.ctx.pdf.internal.getVerticalCoordinateString,i=0;i<n.children.length;i++){var s=n.children[i];this.objStart(s),this.line("/Title "+this.makeString(s.title)),this.line("/Parent "+this.makeRef(n)),i>0&&this.line("/Prev "+this.makeRef(n.children[i-1])),i<n.children.length-1&&this.line("/Next "+this.makeRef(n.children[i+1])),s.children.length>0&&(this.line("/First "+this.makeRef(s.children[0])),this.line("/Last "+this.makeRef(s.children[s.children.length-1])));var o=this.count=this.count_r({count:0},s);if(o>0&&this.line("/Count "+o),s.options&&s.options.pageNumber){var l=r.internal.getPageInfo(s.options.pageNumber);this.line("/Dest ["+l.objId+" 0 R /XYZ 0 "+a(0)+" 0]")}this.objEnd()}for(var c=0;c<n.children.length;c++)this.renderItems(n.children[c])},r.outline.line=function(n){this.ctx.val+=n+`\r
`},r.outline.makeRef=function(n){return n.id+" 0 R"},r.outline.makeString=function(n){return"("+r.internal.pdfEscape(n)+")"},r.outline.objStart=function(n){this.ctx.val+=`\r
`+n.id+` 0 obj\r
<<\r
`},r.outline.objEnd=function(){this.ctx.val+=`>> \r
endobj\r
`},r.outline.count_r=function(n,a){for(var i=0;i<a.children.length;i++)n.count++,this.count_r(n,a.children[i]);return n.count}}])}(vt.API),function(e){var t=[192,193,194,195,196,197,198,199];e.processJPEG=function(r,n,a,i,s,o){var l,c=this.decode.DCT_DECODE,u=null;if(typeof r=="string"||this.__addimage__.isArrayBuffer(r)||this.__addimage__.isArrayBufferView(r)){switch(r=s||r,r=this.__addimage__.isArrayBuffer(r)?new Uint8Array(r):r,(l=function(f){for(var p,h=256*f.charCodeAt(4)+f.charCodeAt(5),g=f.length,m={width:0,height:0,numcomponents:1},b=4;b<g;b+=2){if(b+=h,t.indexOf(f.charCodeAt(b+1))!==-1){p=256*f.charCodeAt(b+5)+f.charCodeAt(b+6),m={width:256*f.charCodeAt(b+7)+f.charCodeAt(b+8),height:p,numcomponents:f.charCodeAt(b+9)};break}h=256*f.charCodeAt(b+2)+f.charCodeAt(b+3)}return m}(r=this.__addimage__.isArrayBufferView(r)?this.__addimage__.arrayBufferToBinaryString(r):r)).numcomponents){case 1:o=this.color_spaces.DEVICE_GRAY;break;case 4:o=this.color_spaces.DEVICE_CMYK;break;case 3:o=this.color_spaces.DEVICE_RGB}u={data:r,width:l.width,height:l.height,colorSpace:o,bitsPerComponent:8,filter:c,index:n,alias:a}}return u}}(vt.API);var Gc,pp,k_,E_,A_,OX=function(){var e,t,r;function n(i){var s,o,l,c,u,f,p,h,g,m,b,x,w,y;for(this.data=i,this.pos=8,this.palette=[],this.imgData=[],this.transparency={},this.animation=null,this.text={},f=null;;){switch(s=this.readUInt32(),g=(function(){var A,L;for(L=[],A=0;A<4;++A)L.push(String.fromCharCode(this.data[this.pos++]));return L}).call(this).join("")){case"IHDR":this.width=this.readUInt32(),this.height=this.readUInt32(),this.bits=this.data[this.pos++],this.colorType=this.data[this.pos++],this.compressionMethod=this.data[this.pos++],this.filterMethod=this.data[this.pos++],this.interlaceMethod=this.data[this.pos++];break;case"acTL":this.animation={numFrames:this.readUInt32(),numPlays:this.readUInt32()||1/0,frames:[]};break;case"PLTE":this.palette=this.read(s);break;case"fcTL":f&&this.animation.frames.push(f),this.pos+=4,f={width:this.readUInt32(),height:this.readUInt32(),xOffset:this.readUInt32(),yOffset:this.readUInt32()},u=this.readUInt16(),c=this.readUInt16()||100,f.delay=1e3*u/c,f.disposeOp=this.data[this.pos++],f.blendOp=this.data[this.pos++],f.data=[];break;case"IDAT":case"fdAT":for(g==="fdAT"&&(this.pos+=4,s-=4),i=(f!=null?f.data:void 0)||this.imgData,x=0;0<=s?x<s:x>s;0<=s?++x:--x)i.push(this.data[this.pos++]);break;case"tRNS":switch(this.transparency={},this.colorType){case 3:if(l=this.palette.length/3,this.transparency.indexed=this.read(s),this.transparency.indexed.length>l)throw new Error("More transparent colors than palette size");if((m=l-this.transparency.indexed.length)>0)for(w=0;0<=m?w<m:w>m;0<=m?++w:--w)this.transparency.indexed.push(255);break;case 0:this.transparency.grayscale=this.read(s)[0];break;case 2:this.transparency.rgb=this.read(s)}break;case"tEXt":p=(b=this.read(s)).indexOf(0),h=String.fromCharCode.apply(String,b.slice(0,p)),this.text[h]=String.fromCharCode.apply(String,b.slice(p+1));break;case"IEND":return f&&this.animation.frames.push(f),this.colors=(function(){switch(this.colorType){case 0:case 3:case 4:return 1;case 2:case 6:return 3}}).call(this),this.hasAlphaChannel=(y=this.colorType)===4||y===6,o=this.colors+(this.hasAlphaChannel?1:0),this.pixelBitlength=this.bits*o,this.colorSpace=(function(){switch(this.colors){case 1:return"DeviceGray";case 3:return"DeviceRGB"}}).call(this),void(this.imgData=new Uint8Array(this.imgData));default:this.pos+=s}if(this.pos+=4,this.pos>this.data.length)throw new Error("Incomplete or corrupt PNG file")}}n.prototype.read=function(i){var s,o;for(o=[],s=0;0<=i?s<i:s>i;0<=i?++s:--s)o.push(this.data[this.pos++]);return o},n.prototype.readUInt32=function(){return this.data[this.pos++]<<24|this.data[this.pos++]<<16|this.data[this.pos++]<<8|this.data[this.pos++]},n.prototype.readUInt16=function(){return this.data[this.pos++]<<8|this.data[this.pos++]},n.prototype.decodePixels=function(i){var s=this.pixelBitlength/8,o=new Uint8Array(this.width*this.height*s),l=0,c=this;if(i==null&&(i=this.imgData),i.length===0)return new Uint8Array(0);function u(f,p,h,g){var m,b,x,w,y,A,L,D,T,F,R,X,N,P,J,W,se,fe,U,Q,q,he=Math.ceil((c.width-f)/h),xe=Math.ceil((c.height-p)/g),E=c.width==he&&c.height==xe;for(P=s*he,X=E?o:new Uint8Array(P*xe),A=i.length,N=0,b=0;N<xe&&l<A;){switch(i[l++]){case 0:for(w=se=0;se<P;w=se+=1)X[b++]=i[l++];break;case 1:for(w=fe=0;fe<P;w=fe+=1)m=i[l++],y=w<s?0:X[b-s],X[b++]=(m+y)%256;break;case 2:for(w=U=0;U<P;w=U+=1)m=i[l++],x=(w-w%s)/s,J=N&&X[(N-1)*P+x*s+w%s],X[b++]=(J+m)%256;break;case 3:for(w=Q=0;Q<P;w=Q+=1)m=i[l++],x=(w-w%s)/s,y=w<s?0:X[b-s],J=N&&X[(N-1)*P+x*s+w%s],X[b++]=(m+Math.floor((y+J)/2))%256;break;case 4:for(w=q=0;q<P;w=q+=1)m=i[l++],x=(w-w%s)/s,y=w<s?0:X[b-s],N===0?J=W=0:(J=X[(N-1)*P+x*s+w%s],W=x&&X[(N-1)*P+(x-1)*s+w%s]),L=y+J-W,D=Math.abs(L-y),F=Math.abs(L-J),R=Math.abs(L-W),T=D<=F&&D<=R?y:F<=R?J:W,X[b++]=(m+T)%256;break;default:throw new Error("Invalid filter algorithm: "+i[l-1])}if(!E){var I=((p+N*g)*c.width+f)*s,O=N*P;for(w=0;w<he;w+=1){for(var j=0;j<s;j+=1)o[I++]=X[O++];I+=(h-1)*s}}N++}}return i=fX(i),c.interlaceMethod==1?(u(0,0,8,8),u(4,0,8,8),u(0,4,4,8),u(2,0,4,4),u(0,2,2,4),u(1,0,2,2),u(0,1,1,2)):u(0,0,1,1),o},n.prototype.decodePalette=function(){var i,s,o,l,c,u,f,p,h;for(o=this.palette,u=this.transparency.indexed||[],c=new Uint8Array((u.length||0)+o.length),l=0,i=0,s=f=0,p=o.length;f<p;s=f+=3)c[l++]=o[s],c[l++]=o[s+1],c[l++]=o[s+2],c[l++]=(h=u[i++])!=null?h:255;return c},n.prototype.copyToImageData=function(i,s){var o,l,c,u,f,p,h,g,m,b,x;if(l=this.colors,m=null,o=this.hasAlphaChannel,this.palette.length&&(m=(x=this._decodedPalette)!=null?x:this._decodedPalette=this.decodePalette(),l=4,o=!0),g=(c=i.data||i).length,f=m||s,u=p=0,l===1)for(;u<g;)h=m?4*s[u/4]:p,b=f[h++],c[u++]=b,c[u++]=b,c[u++]=b,c[u++]=o?f[h++]:255,p=h;else for(;u<g;)h=m?4*s[u/4]:p,c[u++]=f[h++],c[u++]=f[h++],c[u++]=f[h++],c[u++]=o?f[h++]:255,p=h},n.prototype.decode=function(){var i;return i=new Uint8Array(this.width*this.height*4),this.copyToImageData(i,this.decodePixels()),i};var a=function(){if(Object.prototype.toString.call(xt)==="[object Window]"){try{t=xt.document.createElement("canvas"),r=t.getContext("2d")}catch{return!1}return!0}return!1};return a(),e=function(i){var s;if(a()===!0)return r.width=i.width,r.height=i.height,r.clearRect(0,0,i.width,i.height),r.putImageData(i,0,0),(s=new Image).src=t.toDataURL(),s;throw new Error("This method requires a Browser with Canvas-capability.")},n.prototype.decodeFrames=function(i){var s,o,l,c,u,f,p,h;if(this.animation){for(h=[],o=u=0,f=(p=this.animation.frames).length;u<f;o=++u)s=p[o],l=i.createImageData(s.width,s.height),c=this.decodePixels(new Uint8Array(s.data)),this.copyToImageData(l,c),s.imageData=l,h.push(s.image=e(l));return h}},n.prototype.renderFrame=function(i,s){var o,l,c;return o=(l=this.animation.frames)[s],c=l[s-1],s===0&&i.clearRect(0,0,this.width,this.height),(c!=null?c.disposeOp:void 0)===1?i.clearRect(c.xOffset,c.yOffset,c.width,c.height):(c!=null?c.disposeOp:void 0)===2&&i.putImageData(c.imageData,c.xOffset,c.yOffset),o.blendOp===0&&i.clearRect(o.xOffset,o.yOffset,o.width,o.height),i.drawImage(o.image,o.xOffset,o.yOffset)},n.prototype.animate=function(i){var s,o,l,c,u,f,p=this;return o=0,f=this.animation,c=f.numFrames,l=f.frames,u=f.numPlays,(s=function(){var h,g;if(h=o++%c,g=l[h],p.renderFrame(i,h),c>1&&o/c<u)return p.animation._timeout=setTimeout(s,g.delay)})()},n.prototype.stopAnimation=function(){var i;return clearTimeout((i=this.animation)!=null?i._timeout:void 0)},n.prototype.render=function(i){var s,o;return i._png&&i._png.stopAnimation(),i._png=this,i.width=this.width,i.height=this.height,s=i.getContext("2d"),this.animation?(this.decodeFrames(s),this.animate(s)):(o=s.createImageData(this.width,this.height),this.copyToImageData(o,this.decodePixels()),s.putImageData(o,0,0))},n}();/**
 * @license
 *
 * Copyright (c) 2014 James Robb, https://github.com/jamesbrobb
 *
 * Permission is hereby granted, free of charge, to any person obtaining
 * a copy of this software and associated documentation files (the
 * "Software"), to deal in the Software without restriction, including
 * without limitation the rights to use, copy, modify, merge, publish,
 * distribute, sublicense, and/or sell copies of the Software, and to
 * permit persons to whom the Software is furnished to do so, subject to
 * the following conditions:
 *
 * The above copyright notice and this permission notice shall be
 * included in all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND,
 * EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF
 * MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND
 * NONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE
 * LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION
 * OF CONTRACT, TORT OR OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION
 * WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE SOFTWARE.
 * ====================================================================
 *//**
 * @license
 * (c) Dean McNamee <dean@gmail.com>, 2013.
 *
 * https://github.com/deanm/omggif
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to
 * deal in the Software without restriction, including without limitation the
 * rights to use, copy, modify, merge, publish, distribute, sublicense, and/or
 * sell copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING
 * FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS
 * IN THE SOFTWARE.
 *
 * omggif is a JavaScript implementation of a GIF 89a encoder and decoder,
 * including animation and compression.  It does not rely on any specific
 * underlying system, so should run in the browser, Node, or Plask.
 */function DX(e){var t=0;if(e[t++]!==71||e[t++]!==73||e[t++]!==70||e[t++]!==56||(e[t++]+1&253)!=56||e[t++]!==97)throw new Error("Invalid GIF 87a/89a header.");var r=e[t++]|e[t++]<<8,n=e[t++]|e[t++]<<8,a=e[t++],i=a>>7,s=1<<(7&a)+1;e[t++],e[t++];var o=null,l=null;i&&(o=t,l=s,t+=3*s);var c=!0,u=[],f=0,p=null,h=0,g=null;for(this.width=r,this.height=n;c&&t<e.length;)switch(e[t++]){case 33:switch(e[t++]){case 255:if(e[t]!==11||e[t+1]==78&&e[t+2]==69&&e[t+3]==84&&e[t+4]==83&&e[t+5]==67&&e[t+6]==65&&e[t+7]==80&&e[t+8]==69&&e[t+9]==50&&e[t+10]==46&&e[t+11]==48&&e[t+12]==3&&e[t+13]==1&&e[t+16]==0)t+=14,g=e[t++]|e[t++]<<8,t++;else for(t+=12;;){if(!((N=e[t++])>=0))throw Error("Invalid block size");if(N===0)break;t+=N}break;case 249:if(e[t++]!==4||e[t+4]!==0)throw new Error("Invalid graphics extension block.");var m=e[t++];f=e[t++]|e[t++]<<8,p=e[t++],!(1&m)&&(p=null),h=m>>2&7,t++;break;case 254:for(;;){if(!((N=e[t++])>=0))throw Error("Invalid block size");if(N===0)break;t+=N}break;default:throw new Error("Unknown graphic control label: 0x"+e[t-1].toString(16))}break;case 44:var b=e[t++]|e[t++]<<8,x=e[t++]|e[t++]<<8,w=e[t++]|e[t++]<<8,y=e[t++]|e[t++]<<8,A=e[t++],L=A>>6&1,D=1<<(7&A)+1,T=o,F=l,R=!1;A>>7&&(R=!0,T=t,F=D,t+=3*D);var X=t;for(t++;;){var N;if(!((N=e[t++])>=0))throw Error("Invalid block size");if(N===0)break;t+=N}u.push({x:b,y:x,width:w,height:y,has_local_palette:R,palette_offset:T,palette_size:F,data_offset:X,data_length:t-X,transparent_index:p,interlaced:!!L,delay:f,disposal:h});break;case 59:c=!1;break;default:throw new Error("Unknown gif block: 0x"+e[t-1].toString(16))}this.numFrames=function(){return u.length},this.loopCount=function(){return g},this.frameInfo=function(P){if(P<0||P>=u.length)throw new Error("Frame index out of range.");return u[P]},this.decodeAndBlitFrameBGRA=function(P,J){var W=this.frameInfo(P),se=W.width*W.height,fe=new Uint8Array(se);T_(e,W.data_offset,fe,se);var U=W.palette_offset,Q=W.transparent_index;Q===null&&(Q=256);var q=W.width,he=r-q,xe=q,E=4*(W.y*r+W.x),I=4*((W.y+W.height)*r+W.x),O=E,j=4*he;W.interlaced===!0&&(j+=4*r*7);for(var K=8,ne=0,pe=fe.length;ne<pe;++ne){var de=fe[ne];if(xe===0&&(xe=q,(O+=j)>=I&&(j=4*he+4*r*(K-1),O=E+(q+he)*(K<<1),K>>=1)),de===Q)O+=4;else{var we=e[U+3*de],Pe=e[U+3*de+1],Z=e[U+3*de+2];J[O++]=Z,J[O++]=Pe,J[O++]=we,J[O++]=255}--xe}},this.decodeAndBlitFrameRGBA=function(P,J){var W=this.frameInfo(P),se=W.width*W.height,fe=new Uint8Array(se);T_(e,W.data_offset,fe,se);var U=W.palette_offset,Q=W.transparent_index;Q===null&&(Q=256);var q=W.width,he=r-q,xe=q,E=4*(W.y*r+W.x),I=4*((W.y+W.height)*r+W.x),O=E,j=4*he;W.interlaced===!0&&(j+=4*r*7);for(var K=8,ne=0,pe=fe.length;ne<pe;++ne){var de=fe[ne];if(xe===0&&(xe=q,(O+=j)>=I&&(j=4*he+4*r*(K-1),O=E+(q+he)*(K<<1),K>>=1)),de===Q)O+=4;else{var we=e[U+3*de],Pe=e[U+3*de+1],Z=e[U+3*de+2];J[O++]=we,J[O++]=Pe,J[O++]=Z,J[O++]=255}--xe}}}function T_(e,t,r,n){for(var a=e[t++],i=1<<a,s=i+1,o=s+1,l=a+1,c=(1<<l)-1,u=0,f=0,p=0,h=e[t++],g=new Int32Array(4096),m=null;;){for(;u<16&&h!==0;)f|=e[t++]<<u,u+=8,h===1?h=e[t++]:--h;if(u<l)break;var b=f&c;if(f>>=l,u-=l,b!==i){if(b===s)break;for(var x=b<o?b:m,w=0,y=x;y>i;)y=g[y]>>8,++w;var A=y;if(p+w+(x!==b?1:0)>n)return void or.log("Warning, gif stream longer than expected.");r[p++]=A;var L=p+=w;for(x!==b&&(r[p++]=A),y=x;w--;)y=g[y],r[--L]=255&y,y>>=8;m!==null&&o<4096&&(g[o++]=m<<8|A,o>=c+1&&l<12&&(++l,c=c<<1|1)),m=b}else o=s+1,c=(1<<(l=a+1))-1,m=null}return p!==n&&or.log("Warning, gif stream shorter than expected."),r}/**
 * @license
  Copyright (c) 2008, Adobe Systems Incorporated
  All rights reserved.

  Redistribution and use in source and binary forms, with or without 
  modification, are permitted provided that the following conditions are
  met:

  * Redistributions of source code must retain the above copyright notice, 
    this list of conditions and the following disclaimer.
  
  * Redistributions in binary form must reproduce the above copyright
    notice, this list of conditions and the following disclaimer in the 
    documentation and/or other materials provided with the distribution.
  
  * Neither the name of Adobe Systems Incorporated nor the names of its 
    contributors may be used to endorse or promote products derived from 
    this software without specific prior written permission.

  THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS "AS
  IS" AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO,
  THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR
  PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT OWNER OR 
  CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL,
  EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO,
  PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR
  PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF
  LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING
  NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS
  SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
*/function P2(e){var t,r,n,a,i,s=Math.floor,o=new Array(64),l=new Array(64),c=new Array(64),u=new Array(64),f=new Array(65535),p=new Array(65535),h=new Array(64),g=new Array(64),m=[],b=0,x=7,w=new Array(64),y=new Array(64),A=new Array(64),L=new Array(256),D=new Array(2048),T=[0,1,5,6,14,15,27,28,2,4,7,13,16,26,29,42,3,8,12,17,25,30,41,43,9,11,18,24,31,40,44,53,10,19,23,32,39,45,52,54,20,22,33,38,46,51,55,60,21,34,37,47,50,56,59,61,35,36,48,49,57,58,62,63],F=[0,0,1,5,1,1,1,1,1,1,0,0,0,0,0,0,0],R=[0,1,2,3,4,5,6,7,8,9,10,11],X=[0,0,2,1,3,3,2,4,3,5,5,4,4,0,0,1,125],N=[1,2,3,0,4,17,5,18,33,49,65,6,19,81,97,7,34,113,20,50,129,145,161,8,35,66,177,193,21,82,209,240,36,51,98,114,130,9,10,22,23,24,25,26,37,38,39,40,41,42,52,53,54,55,56,57,58,67,68,69,70,71,72,73,74,83,84,85,86,87,88,89,90,99,100,101,102,103,104,105,106,115,116,117,118,119,120,121,122,131,132,133,134,135,136,137,138,146,147,148,149,150,151,152,153,154,162,163,164,165,166,167,168,169,170,178,179,180,181,182,183,184,185,186,194,195,196,197,198,199,200,201,202,210,211,212,213,214,215,216,217,218,225,226,227,228,229,230,231,232,233,234,241,242,243,244,245,246,247,248,249,250],P=[0,0,3,1,1,1,1,1,1,1,1,1,0,0,0,0,0],J=[0,1,2,3,4,5,6,7,8,9,10,11],W=[0,0,2,1,2,4,4,3,4,7,5,4,4,0,1,2,119],se=[0,1,2,3,17,4,5,33,49,6,18,65,81,7,97,113,19,34,50,129,8,20,66,145,161,177,193,9,35,51,82,240,21,98,114,209,10,22,36,52,225,37,241,23,24,25,26,38,39,40,41,42,53,54,55,56,57,58,67,68,69,70,71,72,73,74,83,84,85,86,87,88,89,90,99,100,101,102,103,104,105,106,115,116,117,118,119,120,121,122,130,131,132,133,134,135,136,137,138,146,147,148,149,150,151,152,153,154,162,163,164,165,166,167,168,169,170,178,179,180,181,182,183,184,185,186,194,195,196,197,198,199,200,201,202,210,211,212,213,214,215,216,217,218,226,227,228,229,230,231,232,233,234,242,243,244,245,246,247,248,249,250];function fe(E,I){for(var O=0,j=0,K=new Array,ne=1;ne<=16;ne++){for(var pe=1;pe<=E[ne];pe++)K[I[j]]=[],K[I[j]][0]=O,K[I[j]][1]=ne,j++,O++;O*=2}return K}function U(E){for(var I=E[0],O=E[1]-1;O>=0;)I&1<<O&&(b|=1<<x),O--,--x<0&&(b==255?(Q(255),Q(0)):Q(b),x=7,b=0)}function Q(E){m.push(E)}function q(E){Q(E>>8&255),Q(255&E)}function he(E,I,O,j,K){for(var ne,pe=K[0],de=K[240],we=function(Me,qe){var Ye,Je,st,lt,mt,wt,Ot,kt,ct,Ze,ze=0;for(ct=0;ct<8;++ct){Ye=Me[ze],Je=Me[ze+1],st=Me[ze+2],lt=Me[ze+3],mt=Me[ze+4],wt=Me[ze+5],Ot=Me[ze+6];var Jt=Ye+(kt=Me[ze+7]),ht=Ye-kt,Zr=Je+Ot,Kt=Je-Ot,lr=st+wt,$a=st-wt,Vt=lt+mt,qi=lt-mt,mr=Jt+Vt,ka=Jt-Vt,di=Zr+lr,ir=Zr-lr;Me[ze]=mr+di,Me[ze+4]=mr-di;var _t=.707106781*(ir+ka);Me[ze+2]=ka+_t,Me[ze+6]=ka-_t;var Wt=.382683433*((mr=qi+$a)-(ir=Kt+ht)),xs=.5411961*mr+Wt,en=1.306562965*ir+Wt,za=.707106781*(di=$a+Kt),Ha=ht+za,dt=ht-za;Me[ze+5]=dt+xs,Me[ze+3]=dt-xs,Me[ze+1]=Ha+en,Me[ze+7]=Ha-en,ze+=8}for(ze=0,ct=0;ct<8;++ct){Ye=Me[ze],Je=Me[ze+8],st=Me[ze+16],lt=Me[ze+24],mt=Me[ze+32],wt=Me[ze+40],Ot=Me[ze+48];var Ea=Ye+(kt=Me[ze+56]),la=Ye-kt,An=Je+Ot,Dr=Je-Ot,Tr=st+wt,z=st-wt,le=lt+mt,ee=lt-mt,te=Ea+le,oe=Ea-le,ce=An+Tr,ke=An-Tr;Me[ze]=te+ce,Me[ze+32]=te-ce;var Le=.707106781*(ke+oe);Me[ze+16]=oe+Le,Me[ze+48]=oe-Le;var Se=.382683433*((te=ee+z)-(ke=Dr+la)),Te=.5411961*te+Se,Ne=1.306562965*ke+Se,$e=.707106781*(ce=z+Dr),Ge=la+$e,rt=la-$e;Me[ze+40]=rt+Te,Me[ze+24]=rt-Te,Me[ze+8]=Ge+Ne,Me[ze+56]=Ge-Ne,ze++}for(ct=0;ct<64;++ct)Ze=Me[ct]*qe[ct],h[ct]=Ze>0?Ze+.5|0:Ze-.5|0;return h}(E,I),Pe=0;Pe<64;++Pe)g[T[Pe]]=we[Pe];var Z=g[0]-O;O=g[0],Z==0?U(j[0]):(U(j[p[ne=32767+Z]]),U(f[ne]));for(var Ve=63;Ve>0&&g[Ve]==0;)Ve--;if(Ve==0)return U(pe),O;for(var Ke,Ce=1;Ce<=Ve;){for(var ae=Ce;g[Ce]==0&&Ce<=Ve;)++Ce;var De=Ce-ae;if(De>=16){Ke=De>>4;for(var Xe=1;Xe<=Ke;++Xe)U(de);De&=15}ne=32767+g[Ce],U(K[(De<<4)+p[ne]]),U(f[ne]),Ce++}return Ve!=63&&U(pe),O}function xe(E){E=Math.min(Math.max(E,1),100),i!=E&&(function(I){for(var O=[16,11,10,16,24,40,51,61,12,12,14,19,26,58,60,55,14,13,16,24,40,57,69,56,14,17,22,29,51,87,80,62,18,22,37,56,68,109,103,77,24,35,55,64,81,104,113,92,49,64,78,87,103,121,120,101,72,92,95,98,112,100,103,99],j=0;j<64;j++){var K=s((O[j]*I+50)/100);K=Math.min(Math.max(K,1),255),o[T[j]]=K}for(var ne=[17,18,24,47,99,99,99,99,18,21,26,66,99,99,99,99,24,26,56,99,99,99,99,99,47,66,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99],pe=0;pe<64;pe++){var de=s((ne[pe]*I+50)/100);de=Math.min(Math.max(de,1),255),l[T[pe]]=de}for(var we=[1,1.387039845,1.306562965,1.175875602,1,.785694958,.5411961,.275899379],Pe=0,Z=0;Z<8;Z++)for(var Ve=0;Ve<8;Ve++)c[Pe]=1/(o[T[Pe]]*we[Z]*we[Ve]*8),u[Pe]=1/(l[T[Pe]]*we[Z]*we[Ve]*8),Pe++}(E<50?Math.floor(5e3/E):Math.floor(200-2*E)),i=E)}this.encode=function(E,I){I&&xe(I),m=new Array,b=0,x=7,q(65496),q(65504),q(16),Q(74),Q(70),Q(73),Q(70),Q(0),Q(1),Q(1),Q(0),q(1),q(1),Q(0),Q(0),function(){q(65499),q(132),Q(0);for(var Je=0;Je<64;Je++)Q(o[Je]);Q(1);for(var st=0;st<64;st++)Q(l[st])}(),function(Je,st){q(65472),q(17),Q(8),q(st),q(Je),Q(3),Q(1),Q(17),Q(0),Q(2),Q(17),Q(1),Q(3),Q(17),Q(1)}(E.width,E.height),function(){q(65476),q(418),Q(0);for(var Je=0;Je<16;Je++)Q(F[Je+1]);for(var st=0;st<=11;st++)Q(R[st]);Q(16);for(var lt=0;lt<16;lt++)Q(X[lt+1]);for(var mt=0;mt<=161;mt++)Q(N[mt]);Q(1);for(var wt=0;wt<16;wt++)Q(P[wt+1]);for(var Ot=0;Ot<=11;Ot++)Q(J[Ot]);Q(17);for(var kt=0;kt<16;kt++)Q(W[kt+1]);for(var ct=0;ct<=161;ct++)Q(se[ct])}(),q(65498),q(12),Q(3),Q(1),Q(0),Q(2),Q(17),Q(3),Q(17),Q(0),Q(63),Q(0);var O=0,j=0,K=0;b=0,x=7,this.encode.displayName="_encode_";for(var ne,pe,de,we,Pe,Z,Ve,Ke,Ce,ae=E.data,De=E.width,Xe=E.height,Me=4*De,qe=0;qe<Xe;){for(ne=0;ne<Me;){for(Pe=Me*qe+ne,Ve=-1,Ke=0,Ce=0;Ce<64;Ce++)Z=Pe+(Ke=Ce>>3)*Me+(Ve=4*(7&Ce)),qe+Ke>=Xe&&(Z-=Me*(qe+1+Ke-Xe)),ne+Ve>=Me&&(Z-=ne+Ve-Me+4),pe=ae[Z++],de=ae[Z++],we=ae[Z++],w[Ce]=(D[pe]+D[de+256>>0]+D[we+512>>0]>>16)-128,y[Ce]=(D[pe+768>>0]+D[de+1024>>0]+D[we+1280>>0]>>16)-128,A[Ce]=(D[pe+1280>>0]+D[de+1536>>0]+D[we+1792>>0]>>16)-128;O=he(w,c,O,t,n),j=he(y,u,j,r,a),K=he(A,u,K,r,a),ne+=32}qe+=8}if(x>=0){var Ye=[];Ye[1]=x+1,Ye[0]=(1<<x+1)-1,U(Ye)}return q(65497),new Uint8Array(m)},e=e||50,function(){for(var E=String.fromCharCode,I=0;I<256;I++)L[I]=E(I)}(),t=fe(F,R),r=fe(P,J),n=fe(X,N),a=fe(W,se),function(){for(var E=1,I=2,O=1;O<=15;O++){for(var j=E;j<I;j++)p[32767+j]=O,f[32767+j]=[],f[32767+j][1]=O,f[32767+j][0]=j;for(var K=-(I-1);K<=-E;K++)p[32767+K]=O,f[32767+K]=[],f[32767+K][1]=O,f[32767+K][0]=I-1+K;E<<=1,I<<=1}}(),function(){for(var E=0;E<256;E++)D[E]=19595*E,D[E+256>>0]=38470*E,D[E+512>>0]=7471*E+32768,D[E+768>>0]=-11059*E,D[E+1024>>0]=-21709*E,D[E+1280>>0]=32768*E+8421375,D[E+1536>>0]=-27439*E,D[E+1792>>0]=-5329*E}(),xe(e)}/**
 * @license
 * Copyright (c) 2017 Aras Abbasi
 *
 * Licensed under the MIT License.
 * http://opensource.org/licenses/mit-license
 */function Ei(e,t){if(this.pos=0,this.buffer=e,this.datav=new DataView(e.buffer),this.is_with_alpha=!!t,this.bottom_up=!0,this.flag=String.fromCharCode(this.buffer[0])+String.fromCharCode(this.buffer[1]),this.pos+=2,["BM","BA","CI","CP","IC","PT"].indexOf(this.flag)===-1)throw new Error("Invalid BMP File");this.parseHeader(),this.parseBGR()}function C_(e){function t(F){if(!F)throw Error("assert :P")}function r(F,R,X){for(var N=0;4>N;N++)if(F[R+N]!=X.charCodeAt(N))return!0;return!1}function n(F,R,X,N,P){for(var J=0;J<P;J++)F[R+J]=X[N+J]}function a(F,R,X,N){for(var P=0;P<N;P++)F[R+P]=X}function i(F){return new Int32Array(F)}function s(F,R){for(var X=[],N=0;N<F;N++)X.push(new R);return X}function o(F,R){var X=[];return function N(P,J,W){for(var se=W[J],fe=0;fe<se&&(P.push(W.length>J+1?[]:new R),!(W.length<J+1));fe++)N(P[fe],J+1,W)}(X,0,F),X}var l=function(){var F=this;function R(d,v){for(var k=1<<v-1>>>0;d&k;)k>>>=1;return k?(d&k-1)+k:d}function X(d,v,k,C,M){t(!(C%k));do d[v+(C-=k)]=M;while(0<C)}function N(d,v,k,C,M){if(t(2328>=M),512>=M)var V=i(512);else if((V=i(M))==null)return 0;return function(H,G,Y,re,ge,Ee){var Ae,be,je=G,Fe=1<<Y,ve=i(16),ye=i(16);for(t(ge!=0),t(re!=null),t(H!=null),t(0<Y),be=0;be<ge;++be){if(15<re[be])return 0;++ve[re[be]]}if(ve[0]==ge)return 0;for(ye[1]=0,Ae=1;15>Ae;++Ae){if(ve[Ae]>1<<Ae)return 0;ye[Ae+1]=ye[Ae]+ve[Ae]}for(be=0;be<ge;++be)Ae=re[be],0<re[be]&&(Ee[ye[Ae]++]=be);if(ye[15]==1)return(re=new P).g=0,re.value=Ee[0],X(H,je,1,Fe,re),Fe;var Ie,Be=-1,Re=Fe-1,at=0,Qe=1,pt=1,et=1<<Y;for(be=0,Ae=1,ge=2;Ae<=Y;++Ae,ge<<=1){if(Qe+=pt<<=1,0>(pt-=ve[Ae]))return 0;for(;0<ve[Ae];--ve[Ae])(re=new P).g=Ae,re.value=Ee[be++],X(H,je+at,ge,et,re),at=R(at,Ae)}for(Ae=Y+1,ge=2;15>=Ae;++Ae,ge<<=1){if(Qe+=pt<<=1,0>(pt-=ve[Ae]))return 0;for(;0<ve[Ae];--ve[Ae]){if(re=new P,(at&Re)!=Be){for(je+=et,Ie=1<<(Be=Ae)-Y;15>Be&&!(0>=(Ie-=ve[Be]));)++Be,Ie<<=1;Fe+=et=1<<(Ie=Be-Y),H[G+(Be=at&Re)].g=Ie+Y,H[G+Be].value=je-G-Be}re.g=Ae-Y,re.value=Ee[be++],X(H,je+(at>>Y),ge,et,re),at=R(at,Ae)}}return Qe!=2*ye[15]-1?0:Fe}(d,v,k,C,M,V)}function P(){this.value=this.g=0}function J(){this.value=this.g=0}function W(){this.G=s(5,P),this.H=i(5),this.jc=this.Qb=this.qb=this.nd=0,this.pd=s(xn,J)}function se(d,v,k,C){t(d!=null),t(v!=null),t(2147483648>C),d.Ca=254,d.I=0,d.b=-8,d.Ka=0,d.oa=v,d.pa=k,d.Jd=v,d.Yc=k+C,d.Zc=4<=C?k+C-4+1:k,ne(d)}function fe(d,v){for(var k=0;0<v--;)k|=de(d,128)<<v;return k}function U(d,v){var k=fe(d,v);return pe(d)?-k:k}function Q(d,v,k,C){var M,V=0;for(t(d!=null),t(v!=null),t(4294967288>C),d.Sb=C,d.Ra=0,d.u=0,d.h=0,4<C&&(C=4),M=0;M<C;++M)V+=v[k+M]<<8*M;d.Ra=V,d.bb=C,d.oa=v,d.pa=k}function q(d){for(;8<=d.u&&d.bb<d.Sb;)d.Ra>>>=8,d.Ra+=d.oa[d.pa+d.bb]<<Pc-8>>>0,++d.bb,d.u-=8;O(d)&&(d.h=1,d.u=0)}function he(d,v){if(t(0<=v),!d.h&&v<=Nc){var k=I(d)&Cc[v];return d.u+=v,q(d),k}return d.h=1,d.u=0}function xe(){this.b=this.Ca=this.I=0,this.oa=[],this.pa=0,this.Jd=[],this.Yc=0,this.Zc=[],this.Ka=0}function E(){this.Ra=0,this.oa=[],this.h=this.u=this.bb=this.Sb=this.pa=0}function I(d){return d.Ra>>>(d.u&Pc-1)>>>0}function O(d){return t(d.bb<=d.Sb),d.h||d.bb==d.Sb&&d.u>Pc}function j(d,v){d.u=v,d.h=O(d)}function K(d){d.u>=wf&&(t(d.u>=wf),q(d))}function ne(d){t(d!=null&&d.oa!=null),d.pa<d.Zc?(d.I=(d.oa[d.pa++]|d.I<<8)>>>0,d.b+=8):(t(d!=null&&d.oa!=null),d.pa<d.Yc?(d.b+=8,d.I=d.oa[d.pa++]|d.I<<8):d.Ka?d.b=0:(d.I<<=8,d.b+=8,d.Ka=1))}function pe(d){return fe(d,1)}function de(d,v){var k=d.Ca;0>d.b&&ne(d);var C=d.b,M=k*v>>>8,V=(d.I>>>C>M)+0;for(V?(k-=M,d.I-=M+1<<C>>>0):k=M+1,C=k,M=0;256<=C;)M+=8,C>>=8;return C=7^M+ua[C],d.b-=C,d.Ca=(k<<C)-1,V}function we(d,v,k){d[v+0]=k>>24&255,d[v+1]=k>>16&255,d[v+2]=k>>8&255,d[v+3]=k>>0&255}function Pe(d,v){return d[v+0]<<0|d[v+1]<<8}function Z(d,v){return Pe(d,v)|d[v+2]<<16}function Ve(d,v){return Pe(d,v)|Pe(d,v+2)<<16}function Ke(d,v){var k=1<<v;return t(d!=null),t(0<v),d.X=i(k),d.X==null?0:(d.Mb=32-v,d.Xa=v,1)}function Ce(d,v){t(d!=null),t(v!=null),t(d.Xa==v.Xa),n(v.X,0,d.X,0,1<<v.Xa)}function ae(){this.X=[],this.Xa=this.Mb=0}function De(d,v,k,C){t(k!=null),t(C!=null);var M=k[0],V=C[0];return M==0&&(M=(d*V+v/2)/v),V==0&&(V=(v*M+d/2)/d),0>=M||0>=V?0:(k[0]=M,C[0]=V,1)}function Xe(d,v){return d+(1<<v)-1>>>v}function Me(d,v){return((4278255360&d)+(4278255360&v)>>>0&4278255360)+((16711935&d)+(16711935&v)>>>0&16711935)>>>0}function qe(d,v){F[v]=function(k,C,M,V,H,G,Y){var re;for(re=0;re<H;++re){var ge=F[d](G[Y+re-1],M,V+re);G[Y+re]=Me(k[C+re],ge)}}}function Ye(){this.ud=this.hd=this.jd=0}function Je(d,v){return((4278124286&(d^v))>>>1)+(d&v)>>>0}function st(d){return 0<=d&&256>d?d:0>d?0:255<d?255:void 0}function lt(d,v){return st(d+(d-v+.5>>1))}function mt(d,v,k){return Math.abs(v-k)-Math.abs(d-k)}function wt(d,v,k,C,M,V,H){for(C=V[H-1],k=0;k<M;++k)V[H+k]=C=Me(d[v+k],C)}function Ot(d,v,k,C,M){var V;for(V=0;V<k;++V){var H=d[v+V],G=H>>8&255,Y=16711935&(Y=(Y=16711935&H)+((G<<16)+G));C[M+V]=(4278255360&H)+Y>>>0}}function kt(d,v){v.jd=d>>0&255,v.hd=d>>8&255,v.ud=d>>16&255}function ct(d,v,k,C,M,V){var H;for(H=0;H<C;++H){var G=v[k+H],Y=G>>>8,re=G,ge=255&(ge=(ge=G>>>16)+((d.jd<<24>>24)*(Y<<24>>24)>>>5));re=255&(re=(re=re+((d.hd<<24>>24)*(Y<<24>>24)>>>5))+((d.ud<<24>>24)*(ge<<24>>24)>>>5)),M[V+H]=(4278255360&G)+(ge<<16)+re}}function Ze(d,v,k,C,M){F[v]=function(V,H,G,Y,re,ge,Ee,Ae,be){for(Y=Ee;Y<Ae;++Y)for(Ee=0;Ee<be;++Ee)re[ge++]=M(G[C(V[H++])])},F[d]=function(V,H,G,Y,re,ge,Ee){var Ae=8>>V.b,be=V.Ea,je=V.K[0],Fe=V.w;if(8>Ae)for(V=(1<<V.b)-1,Fe=(1<<Ae)-1;H<G;++H){var ve,ye=0;for(ve=0;ve<be;++ve)ve&V||(ye=C(Y[re++])),ge[Ee++]=M(je[ye&Fe]),ye>>=Ae}else F["VP8LMapColor"+k](Y,re,je,Fe,ge,Ee,H,G,be)}}function ze(d,v,k,C,M){for(k=v+k;v<k;){var V=d[v++];C[M++]=V>>16&255,C[M++]=V>>8&255,C[M++]=V>>0&255}}function Jt(d,v,k,C,M){for(k=v+k;v<k;){var V=d[v++];C[M++]=V>>16&255,C[M++]=V>>8&255,C[M++]=V>>0&255,C[M++]=V>>24&255}}function ht(d,v,k,C,M){for(k=v+k;v<k;){var V=(H=d[v++])>>16&240|H>>12&15,H=H>>0&240|H>>28&15;C[M++]=V,C[M++]=H}}function Zr(d,v,k,C,M){for(k=v+k;v<k;){var V=(H=d[v++])>>16&248|H>>13&7,H=H>>5&224|H>>3&31;C[M++]=V,C[M++]=H}}function Kt(d,v,k,C,M){for(k=v+k;v<k;){var V=d[v++];C[M++]=V>>0&255,C[M++]=V>>8&255,C[M++]=V>>16&255}}function lr(d,v,k,C,M,V){if(V==0)for(k=v+k;v<k;)we(C,((V=d[v++])[0]>>24|V[1]>>8&65280|V[2]<<8&16711680|V[3]<<24)>>>0),M+=32;else n(C,M,d,v,k)}function $a(d,v){F[v][0]=F[d+"0"],F[v][1]=F[d+"1"],F[v][2]=F[d+"2"],F[v][3]=F[d+"3"],F[v][4]=F[d+"4"],F[v][5]=F[d+"5"],F[v][6]=F[d+"6"],F[v][7]=F[d+"7"],F[v][8]=F[d+"8"],F[v][9]=F[d+"9"],F[v][10]=F[d+"10"],F[v][11]=F[d+"11"],F[v][12]=F[d+"12"],F[v][13]=F[d+"13"],F[v][14]=F[d+"0"],F[v][15]=F[d+"0"]}function Vt(d){return d==rg||d==ng||d==fd||d==ag}function qi(){this.eb=[],this.size=this.A=this.fb=0}function mr(){this.y=[],this.f=[],this.ea=[],this.F=[],this.Tc=this.Ed=this.Cd=this.Fd=this.lb=this.Db=this.Ab=this.fa=this.J=this.W=this.N=this.O=0}function ka(){this.Rd=this.height=this.width=this.S=0,this.f={},this.f.RGBA=new qi,this.f.kb=new mr,this.sd=null}function di(){this.width=[0],this.height=[0],this.Pd=[0],this.Qd=[0],this.format=[0]}function ir(){this.Id=this.fd=this.Md=this.hb=this.ib=this.da=this.bd=this.cd=this.j=this.v=this.Da=this.Sd=this.ob=0}function _t(d){return alert("todo:WebPSamplerProcessPlane"),d.T}function Wt(d,v){var k=d.T,C=v.ba.f.RGBA,M=C.eb,V=C.fb+d.ka*C.A,H=Ya[v.ba.S],G=d.y,Y=d.O,re=d.f,ge=d.N,Ee=d.ea,Ae=d.W,be=v.cc,je=v.dc,Fe=v.Mc,ve=v.Nc,ye=d.ka,Ie=d.ka+d.T,Be=d.U,Re=Be+1>>1;for(ye==0?H(G,Y,null,null,re,ge,Ee,Ae,re,ge,Ee,Ae,M,V,null,null,Be):(H(v.ec,v.fc,G,Y,be,je,Fe,ve,re,ge,Ee,Ae,M,V-C.A,M,V,Be),++k);ye+2<Ie;ye+=2)be=re,je=ge,Fe=Ee,ve=Ae,ge+=d.Rc,Ae+=d.Rc,V+=2*C.A,H(G,(Y+=2*d.fa)-d.fa,G,Y,be,je,Fe,ve,re,ge,Ee,Ae,M,V-C.A,M,V,Be);return Y+=d.fa,d.j+Ie<d.o?(n(v.ec,v.fc,G,Y,Be),n(v.cc,v.dc,re,ge,Re),n(v.Mc,v.Nc,Ee,Ae,Re),k--):1&Ie||H(G,Y,null,null,re,ge,Ee,Ae,re,ge,Ee,Ae,M,V+C.A,null,null,Be),k}function xs(d,v,k){var C=d.F,M=[d.J];if(C!=null){var V=d.U,H=v.ba.S,G=H==ud||H==fd;v=v.ba.f.RGBA;var Y=[0],re=d.ka;Y[0]=d.T,d.Kb&&(re==0?--Y[0]:(--re,M[0]-=d.width),d.j+d.ka+d.T==d.o&&(Y[0]=d.o-d.j-re));var ge=v.eb;re=v.fb+re*v.A,d=ur(C,M[0],d.width,V,Y,ge,re+(G?0:3),v.A),t(k==Y),d&&Vt(H)&&Ka(ge,re,G,V,Y,v.A)}return 0}function en(d){var v=d.ma,k=v.ba.S,C=11>k,M=k==ld||k==cd||k==ud||k==tg||k==12||Vt(k);if(v.memory=null,v.Ib=null,v.Jb=null,v.Nd=null,!xf(v.Oa,d,M?11:12))return 0;if(M&&Vt(k)&&Ue(),d.da)alert("todo:use_scaling");else{if(C){if(v.Ib=_t,d.Kb){if(k=d.U+1>>1,v.memory=i(d.U+2*k),v.memory==null)return 0;v.ec=v.memory,v.fc=0,v.cc=v.ec,v.dc=v.fc+d.U,v.Mc=v.cc,v.Nc=v.dc+k,v.Ib=Wt,Ue()}}else alert("todo:EmitYUV");M&&(v.Jb=xs,C&&_e())}if(C&&!G5){for(d=0;256>d;++d)mN[d]=89858*(d-128)+dd>>hd,xN[d]=-22014*(d-128)+dd,vN[d]=-45773*(d-128),gN[d]=113618*(d-128)+dd>>hd;for(d=Tf;d<og;++d)v=76283*(d-16)+dd>>hd,yN[d-Tf]=Ta(v,255),wN[d-Tf]=Ta(v+8>>4,15);G5=1}return 1}function za(d){var v=d.ma,k=d.U,C=d.T;return t(!(1&d.ka)),0>=k||0>=C?0:(k=v.Ib(d,v),v.Jb!=null&&v.Jb(d,v,k),v.Dc+=k,1)}function Ha(d){d.ma.memory=null}function dt(d,v,k,C){return he(d,8)!=47?0:(v[0]=he(d,14)+1,k[0]=he(d,14)+1,C[0]=he(d,1),he(d,3)!=0?0:!d.h)}function Ea(d,v){if(4>d)return d+1;var k=d-2>>1;return(2+(1&d)<<k)+he(v,k)+1}function la(d,v){return 120<v?v-120:1<=(k=((k=tN[v-1])>>4)*d+(8-(15&k)))?k:1;var k}function An(d,v,k){var C=I(k),M=d[v+=255&C].g-8;return 0<M&&(j(k,k.u+8),C=I(k),v+=d[v].value,v+=C&(1<<M)-1),j(k,k.u+d[v].g),d[v].value}function Dr(d,v,k){return k.g+=d.g,k.value+=d.value<<v>>>0,t(8>=k.g),d.g}function Tr(d,v,k){var C=d.xc;return t((v=C==0?0:d.vc[d.md*(k>>C)+(v>>C)])<d.Wb),d.Ya[v]}function z(d,v,k,C){var M=d.ab,V=d.c*v,H=d.C;v=H+v;var G=k,Y=C;for(C=d.Ta,k=d.Ua;0<M--;){var re=d.gc[M],ge=H,Ee=v,Ae=G,be=Y,je=(Y=C,G=k,re.Ea);switch(t(ge<Ee),t(Ee<=re.nc),re.hc){case 2:td(Ae,be,(Ee-ge)*je,Y,G);break;case 0:var Fe=ge,ve=Ee,ye=Y,Ie=G,Be=(et=re).Ea;Fe==0&&(Zm(Ae,be,null,null,1,ye,Ie),wt(Ae,be+1,0,0,Be-1,ye,Ie+1),be+=Be,Ie+=Be,++Fe);for(var Re=1<<et.b,at=Re-1,Qe=Xe(Be,et.b),pt=et.K,et=et.w+(Fe>>et.b)*Qe;Fe<ve;){var qt=pt,Qt=et,$t=1;for(bf(Ae,be,ye,Ie-Be,1,ye,Ie);$t<Be;){var Rt=($t&~at)+Re;Rt>Be&&(Rt=Be),(0,oo[qt[Qt++]>>8&15])(Ae,be+ +$t,ye,Ie+$t-Be,Rt-$t,ye,Ie+$t),$t=Rt}be+=Be,Ie+=Be,++Fe&at||(et+=Qe)}Ee!=re.nc&&n(Y,G-je,Y,G+(Ee-ge-1)*je,je);break;case 1:for(je=Ae,ve=be,Be=(Ae=re.Ea)-(Ie=Ae&~(ye=(be=1<<re.b)-1)),Fe=Xe(Ae,re.b),Re=re.K,re=re.w+(ge>>re.b)*Fe;ge<Ee;){for(at=Re,Qe=re,pt=new Ye,et=ve+Ie,qt=ve+Ae;ve<et;)kt(at[Qe++],pt),vl(pt,je,ve,be,Y,G),ve+=be,G+=be;ve<qt&&(kt(at[Qe++],pt),vl(pt,je,ve,Be,Y,G),ve+=Be,G+=Be),++ge&ye||(re+=Fe)}break;case 3:if(Ae==Y&&be==G&&0<re.b){for(ve=Y,Ae=je=G+(Ee-ge)*je-(Ie=(Ee-ge)*Xe(re.Ea,re.b)),be=Y,ye=G,Fe=[],Ie=(Be=Ie)-1;0<=Ie;--Ie)Fe[Ie]=be[ye+Ie];for(Ie=Be-1;0<=Ie;--Ie)ve[Ae+Ie]=Fe[Ie];Wa(re,ge,Ee,Y,je,Y,G)}else Wa(re,ge,Ee,Ae,be,Y,G)}G=C,Y=k}Y!=k&&n(C,k,G,Y,V)}function le(d,v){var k=d.V,C=d.Ba+d.c*d.C,M=v-d.C;if(t(v<=d.l.o),t(16>=M),0<M){var V=d.l,H=d.Ta,G=d.Ua,Y=V.width;if(z(d,M,k,C),M=G=[G],t((k=d.C)<(C=v)),t(V.v<V.va),C>V.o&&(C=V.o),k<V.j){var re=V.j-k;k=V.j,M[0]+=re*Y}if(k>=C?k=0:(M[0]+=4*V.v,V.ka=k-V.j,V.U=V.va-V.v,V.T=C-k,k=1),k){if(G=G[0],11>(k=d.ca).S){var ge=k.f.RGBA,Ee=(C=k.S,M=V.U,V=V.T,re=ge.eb,ge.A),Ae=V;for(ge=ge.fb+d.Ma*ge.A;0<Ae--;){var be=H,je=G,Fe=M,ve=re,ye=ge;switch(C){case od:fa(be,je,Fe,ve,ye);break;case ld:Kn(be,je,Fe,ve,ye);break;case rg:Kn(be,je,Fe,ve,ye),Ka(ve,ye,0,Fe,1,0);break;case j5:Ss(be,je,Fe,ve,ye);break;case cd:lr(be,je,Fe,ve,ye,1);break;case ng:lr(be,je,Fe,ve,ye,1),Ka(ve,ye,0,Fe,1,0);break;case ud:lr(be,je,Fe,ve,ye,0);break;case fd:lr(be,je,Fe,ve,ye,0),Ka(ve,ye,1,Fe,1,0);break;case tg:lo(be,je,Fe,ve,ye);break;case ag:lo(be,je,Fe,ve,ye),cr(ve,ye,Fe,1,0);break;case M5:_s(be,je,Fe,ve,ye);break;default:t(0)}G+=Y,ge+=Ee}d.Ma+=V}else alert("todo:EmitRescaledRowsYUVA");t(d.Ma<=k.height)}}d.C=v,t(d.C<=d.i)}function ee(d){var v;if(0<d.ua)return 0;for(v=0;v<d.Wb;++v){var k=d.Ya[v].G,C=d.Ya[v].H;if(0<k[1][C[1]+0].g||0<k[2][C[2]+0].g||0<k[3][C[3]+0].g)return 0}return 1}function te(d,v,k,C,M,V){if(d.Z!=0){var H=d.qd,G=d.rd;for(t(ho[d.Z]!=null);v<k;++v)ho[d.Z](H,G,C,M,C,M,V),H=C,G=M,M+=V;d.qd=H,d.rd=G}}function oe(d,v){var k=d.l.ma,C=k.Z==0||k.Z==1?d.l.j:d.C;if(C=d.C<C?C:d.C,t(v<=d.l.o),v>C){var M=d.l.width,V=k.ca,H=k.tb+M*C,G=d.V,Y=d.Ba+d.c*C,re=d.gc;t(d.ab==1),t(re[0].hc==3),rd(re[0],C,v,G,Y,V,H),te(k,C,v,V,H,M)}d.C=d.Ma=v}function ce(d,v,k,C,M,V,H){var G=d.$/C,Y=d.$%C,re=d.m,ge=d.s,Ee=k+d.$,Ae=Ee;M=k+C*M;var be=k+C*V,je=280+ge.ua,Fe=d.Pb?G:16777216,ve=0<ge.ua?ge.Wa:null,ye=ge.wc,Ie=Ee<be?Tr(ge,Y,G):null;t(d.C<V),t(be<=M);var Be=!1;e:for(;;){for(;Be||Ee<be;){var Re=0;if(G>=Fe){var at=Ee-k;t((Fe=d).Pb),Fe.wd=Fe.m,Fe.xd=at,0<Fe.s.ua&&Ce(Fe.s.Wa,Fe.s.vb),Fe=G+nN}if(Y&ye||(Ie=Tr(ge,Y,G)),t(Ie!=null),Ie.Qb&&(v[Ee]=Ie.qb,Be=!0),!Be)if(K(re),Ie.jc){Re=re,at=v;var Qe=Ee,pt=Ie.pd[I(Re)&xn-1];t(Ie.jc),256>pt.g?(j(Re,Re.u+pt.g),at[Qe]=pt.value,Re=0):(j(Re,Re.u+pt.g-256),t(256<=pt.value),Re=pt.value),Re==0&&(Be=!0)}else Re=An(Ie.G[0],Ie.H[0],re);if(re.h)break;if(Be||256>Re){if(!Be)if(Ie.nd)v[Ee]=(Ie.qb|Re<<8)>>>0;else{if(K(re),Be=An(Ie.G[1],Ie.H[1],re),K(re),at=An(Ie.G[2],Ie.H[2],re),Qe=An(Ie.G[3],Ie.H[3],re),re.h)break;v[Ee]=(Qe<<24|Be<<16|Re<<8|at)>>>0}if(Be=!1,++Ee,++Y>=C&&(Y=0,++G,H!=null&&G<=V&&!(G%16)&&H(d,G),ve!=null))for(;Ae<Ee;)Re=v[Ae++],ve.X[(506832829*Re&4294967295)>>>ve.Mb]=Re}else if(280>Re){if(Re=Ea(Re-256,re),at=An(Ie.G[4],Ie.H[4],re),K(re),at=la(C,at=Ea(at,re)),re.h)break;if(Ee-k<at||M-Ee<Re)break e;for(Qe=0;Qe<Re;++Qe)v[Ee+Qe]=v[Ee+Qe-at];for(Ee+=Re,Y+=Re;Y>=C;)Y-=C,++G,H!=null&&G<=V&&!(G%16)&&H(d,G);if(t(Ee<=M),Y&ye&&(Ie=Tr(ge,Y,G)),ve!=null)for(;Ae<Ee;)Re=v[Ae++],ve.X[(506832829*Re&4294967295)>>>ve.Mb]=Re}else{if(!(Re<je))break e;for(Be=Re-280,t(ve!=null);Ae<Ee;)Re=v[Ae++],ve.X[(506832829*Re&4294967295)>>>ve.Mb]=Re;Re=Ee,t(!(Be>>>(at=ve).Xa)),v[Re]=at.X[Be],Be=!0}Be||t(re.h==O(re))}if(d.Pb&&re.h&&Ee<M)t(d.m.h),d.a=5,d.m=d.wd,d.$=d.xd,0<d.s.ua&&Ce(d.s.vb,d.s.Wa);else{if(re.h)break e;H!=null&&H(d,G>V?V:G),d.a=0,d.$=Ee-k}return 1}return d.a=3,0}function ke(d){t(d!=null),d.vc=null,d.yc=null,d.Ya=null;var v=d.Wa;v!=null&&(v.X=null),d.vb=null,t(d!=null)}function Le(){var d=new Qm;return d==null?null:(d.a=0,d.xb=V5,$a("Predictor","VP8LPredictors"),$a("Predictor","VP8LPredictors_C"),$a("PredictorAdd","VP8LPredictorsAdd"),$a("PredictorAdd","VP8LPredictorsAdd_C"),td=Ot,vl=ct,fa=ze,Kn=Jt,lo=ht,_s=Zr,Ss=Kt,F.VP8LMapColor32b=Lc,F.VP8LMapColor8b=nd,d)}function Se(d,v,k,C,M){var V=1,H=[d],G=[v],Y=C.m,re=C.s,ge=null,Ee=0;e:for(;;){if(k)for(;V&&he(Y,1);){var Ae=H,be=G,je=C,Fe=1,ve=je.m,ye=je.gc[je.ab],Ie=he(ve,2);if(je.Oc&1<<Ie)V=0;else{switch(je.Oc|=1<<Ie,ye.hc=Ie,ye.Ea=Ae[0],ye.nc=be[0],ye.K=[null],++je.ab,t(4>=je.ab),Ie){case 0:case 1:ye.b=he(ve,3)+2,Fe=Se(Xe(ye.Ea,ye.b),Xe(ye.nc,ye.b),0,je,ye.K),ye.K=ye.K[0];break;case 3:var Be,Re=he(ve,8)+1,at=16<Re?0:4<Re?1:2<Re?2:3;if(Ae[0]=Xe(ye.Ea,at),ye.b=at,Be=Fe=Se(Re,1,0,je,ye.K)){var Qe,pt=Re,et=ye,qt=1<<(8>>et.b),Qt=i(qt);if(Qt==null)Be=0;else{var $t=et.K[0],Rt=et.w;for(Qt[0]=et.K[0][0],Qe=1;Qe<1*pt;++Qe)Qt[Qe]=Me($t[Rt+Qe],Qt[Qe-1]);for(;Qe<4*qt;++Qe)Qt[Qe]=0;et.K[0]=null,et.K[0]=Qt,Be=1}}Fe=Be;break;case 2:break;default:t(0)}V=Fe}}if(H=H[0],G=G[0],V&&he(Y,1)&&!(V=1<=(Ee=he(Y,4))&&11>=Ee)){C.a=3;break e}var sr;if(sr=V)t:{var ar,Pt,qr,ha=C,Gr=H,da=G,Zt=Ee,Na=k,Pa=ha.m,un=ha.s,yn=[null],Yn=1,Ja=0,Qi=rN[Zt];r:for(;;){if(Na&&he(Pa,1)){var fn=he(Pa,3)+2,Ts=Xe(Gr,fn),_l=Xe(da,fn),Rc=Ts*_l;if(!Se(Ts,_l,0,ha,yn))break r;for(yn=yn[0],un.xc=fn,ar=0;ar<Rc;++ar){var po=yn[ar]>>8&65535;yn[ar]=po,po>=Yn&&(Yn=po+1)}}if(Pa.h)break r;for(Pt=0;5>Pt;++Pt){var Nr=B5[Pt];!Pt&&0<Zt&&(Nr+=1<<Zt),Ja<Nr&&(Ja=Nr)}var lg=s(Yn*Qi,P),Y5=Yn,J5=s(Y5,W);if(J5==null)var md=null;else t(65536>=Y5),md=J5;var Cf=i(Ja);if(md==null||Cf==null||lg==null){ha.a=1;break r}var gd=lg;for(ar=qr=0;ar<Yn;++ar){var wi=md[ar],jc=wi.G,Mc=wi.H,Q5=0,vd=1,Z5=0;for(Pt=0;5>Pt;++Pt){Nr=B5[Pt],jc[Pt]=gd,Mc[Pt]=qr,!Pt&&0<Zt&&(Nr+=1<<Zt);a:{var xd,cg=Nr,yd=ha,Nf=Cf,SN=gd,kN=qr,ug=0,mo=yd.m,EN=he(mo,1);if(a(Nf,0,0,cg),EN){var AN=he(mo,1)+1,TN=he(mo,1),ew=he(mo,TN==0?1:8);Nf[ew]=1,AN==2&&(Nf[ew=he(mo,8)]=1);var wd=1}else{var tw=i(19),rw=he(mo,4)+4;if(19<rw){yd.a=3;var bd=0;break a}for(xd=0;xd<rw;++xd)tw[eN[xd]]=he(mo,3);var fg=void 0,Pf=void 0,nw=yd,CN=tw,_d=cg,aw=Nf,hg=0,go=nw.m,iw=8,sw=s(128,P);n:for(;N(sw,0,7,CN,19);){if(he(go,1)){var NN=2+2*he(go,3);if((fg=2+he(go,NN))>_d)break n}else fg=_d;for(Pf=0;Pf<_d&&fg--;){K(go);var ow=sw[0+(127&I(go))];j(go,go.u+ow.g);var Bc=ow.value;if(16>Bc)aw[Pf++]=Bc,Bc!=0&&(iw=Bc);else{var PN=Bc==16,lw=Bc-16,LN=QC[lw],cw=he(go,JC[lw])+LN;if(Pf+cw>_d)break n;for(var FN=PN?iw:0;0<cw--;)aw[Pf++]=FN}}hg=1;break n}hg||(nw.a=3),wd=hg}(wd=wd&&!mo.h)&&(ug=N(SN,kN,8,Nf,cg)),wd&&ug!=0?bd=ug:(yd.a=3,bd=0)}if(bd==0)break r;if(vd&&ZC[Pt]==1&&(vd=gd[qr].g==0),Q5+=gd[qr].g,qr+=bd,3>=Pt){var Lf,dg=Cf[0];for(Lf=1;Lf<Nr;++Lf)Cf[Lf]>dg&&(dg=Cf[Lf]);Z5+=dg}}if(wi.nd=vd,wi.Qb=0,vd&&(wi.qb=(jc[3][Mc[3]+0].value<<24|jc[1][Mc[1]+0].value<<16|jc[2][Mc[2]+0].value)>>>0,Q5==0&&256>jc[0][Mc[0]+0].value&&(wi.Qb=1,wi.qb+=jc[0][Mc[0]+0].value<<8)),wi.jc=!wi.Qb&&6>Z5,wi.jc){var Sd,Cs=wi;for(Sd=0;Sd<xn;++Sd){var vo=Sd,xo=Cs.pd[vo],kd=Cs.G[0][Cs.H[0]+vo];256<=kd.value?(xo.g=kd.g+256,xo.value=kd.value):(xo.g=0,xo.value=0,vo>>=Dr(kd,8,xo),vo>>=Dr(Cs.G[1][Cs.H[1]+vo],16,xo),vo>>=Dr(Cs.G[2][Cs.H[2]+vo],0,xo),Dr(Cs.G[3][Cs.H[3]+vo],24,xo))}}}un.vc=yn,un.Wb=Yn,un.Ya=md,un.yc=lg,sr=1;break t}sr=0}if(!(V=sr)){C.a=3;break e}if(0<Ee){if(re.ua=1<<Ee,!Ke(re.Wa,Ee)){C.a=1,V=0;break e}}else re.ua=0;var pg=C,uw=H,ON=G,mg=pg.s,gg=mg.xc;if(pg.c=uw,pg.i=ON,mg.md=Xe(uw,gg),mg.wc=gg==0?-1:(1<<gg)-1,k){C.xb=uN;break e}if((ge=i(H*G))==null){C.a=1,V=0;break e}V=(V=ce(C,ge,0,H,G,G,null))&&!Y.h;break e}return V?(M!=null?M[0]=ge:(t(ge==null),t(k)),C.$=0,k||ke(re)):ke(re),V}function Te(d,v){var k=d.c*d.i,C=k+v+16*v;return t(d.c<=v),d.V=i(C),d.V==null?(d.Ta=null,d.Ua=0,d.a=1,0):(d.Ta=d.V,d.Ua=d.Ba+k+v,1)}function Ne(d,v){var k=d.C,C=v-k,M=d.V,V=d.Ba+d.c*k;for(t(v<=d.l.o);0<C;){var H=16<C?16:C,G=d.l.ma,Y=d.l.width,re=Y*H,ge=G.ca,Ee=G.tb+Y*k,Ae=d.Ta,be=d.Ua;z(d,H,M,V),jr(Ae,be,ge,Ee,re),te(G,k,k+H,ge,Ee,Y),C-=H,M+=H*d.c,k+=H}t(k==v),d.C=d.Ma=v}function $e(){this.ub=this.yd=this.td=this.Rb=0}function Ge(){this.Kd=this.Ld=this.Ud=this.Td=this.i=this.c=0}function rt(){this.Fb=this.Bb=this.Cb=0,this.Zb=i(4),this.Lb=i(4)}function We(){this.Yb=function(){var d=[];return function v(k,C,M){for(var V=M[C],H=0;H<V&&(k.push(M.length>C+1?[]:0),!(M.length<C+1));H++)v(k[H],C+1,M)}(d,0,[3,11]),d}()}function tt(){this.jb=i(3),this.Wc=o([4,8],We),this.Xc=o([4,17],We)}function bt(){this.Pc=this.wb=this.Tb=this.zd=0,this.vd=new i(4),this.od=new i(4)}function Xt(){this.ld=this.La=this.dd=this.tc=0}function nr(){this.Na=this.la=0}function Hr(){this.Sc=[0,0],this.Eb=[0,0],this.Qc=[0,0],this.ia=this.lc=0}function pi(){this.ad=i(384),this.Za=0,this.Ob=i(16),this.$b=this.Ad=this.ia=this.Gc=this.Hc=this.Dd=0}function ys(){this.uc=this.M=this.Nb=0,this.wa=Array(new Xt),this.Y=0,this.ya=Array(new pi),this.aa=0,this.l=new Ki}function Gi(){this.y=i(16),this.f=i(8),this.ea=i(8)}function mi(){this.cb=this.a=0,this.sc="",this.m=new xe,this.Od=new $e,this.Kc=new Ge,this.ed=new bt,this.Qa=new rt,this.Ic=this.$c=this.Aa=0,this.D=new ys,this.Xb=this.Va=this.Hb=this.zb=this.yb=this.Ub=this.za=0,this.Jc=s(8,xe),this.ia=0,this.pb=s(4,Hr),this.Pa=new tt,this.Bd=this.kc=0,this.Ac=[],this.Bc=0,this.zc=[0,0,0,0],this.Gd=Array(new Gi),this.Hd=0,this.rb=Array(new nr),this.sb=0,this.wa=Array(new Xt),this.Y=0,this.oc=[],this.pc=0,this.sa=[],this.ta=0,this.qa=[],this.ra=0,this.Ha=[],this.B=this.R=this.Ia=0,this.Ec=[],this.M=this.ja=this.Vb=this.Fc=0,this.ya=Array(new pi),this.L=this.aa=0,this.gd=o([4,2],Xt),this.ga=null,this.Fa=[],this.Cc=this.qc=this.P=0,this.Gb=[],this.Uc=0,this.mb=[],this.nb=0,this.rc=[],this.Ga=this.Vc=0}function Ki(){this.T=this.U=this.ka=this.height=this.width=0,this.y=[],this.f=[],this.ea=[],this.Rc=this.fa=this.W=this.N=this.O=0,this.ma="void",this.put="VP8IoPutHook",this.ac="VP8IoSetupHook",this.bc="VP8IoTeardownHook",this.ha=this.Kb=0,this.data=[],this.hb=this.ib=this.da=this.o=this.j=this.va=this.v=this.Da=this.ob=this.w=0,this.F=[],this.J=0}function Aa(){var d=new mi;return d!=null&&(d.a=0,d.sc="OK",d.cb=0,d.Xb=0,Af||(Af=Uh)),d}function Ir(d,v,k){return d.a==0&&(d.a=v,d.sc=k,d.cb=0),0}function Mh(d,v,k){return 3<=k&&d[v+0]==157&&d[v+1]==1&&d[v+2]==42}function Bh(d,v){if(d==null)return 0;if(d.a=0,d.sc="OK",v==null)return Ir(d,2,"null VP8Io passed to VP8GetHeaders()");var k=v.data,C=v.w,M=v.ha;if(4>M)return Ir(d,7,"Truncated header.");var V=k[C+0]|k[C+1]<<8|k[C+2]<<16,H=d.Od;if(H.Rb=!(1&V),H.td=V>>1&7,H.yd=V>>4&1,H.ub=V>>5,3<H.td)return Ir(d,3,"Incorrect keyframe parameters.");if(!H.yd)return Ir(d,4,"Frame not displayable.");C+=3,M-=3;var G=d.Kc;if(H.Rb){if(7>M)return Ir(d,7,"cannot parse picture header");if(!Mh(k,C,M))return Ir(d,3,"Bad code word");G.c=16383&(k[C+4]<<8|k[C+3]),G.Td=k[C+4]>>6,G.i=16383&(k[C+6]<<8|k[C+5]),G.Ud=k[C+6]>>6,C+=7,M-=7,d.za=G.c+15>>4,d.Ub=G.i+15>>4,v.width=G.c,v.height=G.i,v.Da=0,v.j=0,v.v=0,v.va=v.width,v.o=v.height,v.da=0,v.ib=v.width,v.hb=v.height,v.U=v.width,v.T=v.height,a((V=d.Pa).jb,0,255,V.jb.length),t((V=d.Qa)!=null),V.Cb=0,V.Bb=0,V.Fb=1,a(V.Zb,0,0,V.Zb.length),a(V.Lb,0,0,V.Lb)}if(H.ub>M)return Ir(d,7,"bad partition length");se(V=d.m,k,C,H.ub),C+=H.ub,M-=H.ub,H.Rb&&(G.Ld=pe(V),G.Kd=pe(V)),G=d.Qa;var Y,re=d.Pa;if(t(V!=null),t(G!=null),G.Cb=pe(V),G.Cb){if(G.Bb=pe(V),pe(V)){for(G.Fb=pe(V),Y=0;4>Y;++Y)G.Zb[Y]=pe(V)?U(V,7):0;for(Y=0;4>Y;++Y)G.Lb[Y]=pe(V)?U(V,6):0}if(G.Bb)for(Y=0;3>Y;++Y)re.jb[Y]=pe(V)?fe(V,8):255}else G.Bb=0;if(V.Ka)return Ir(d,3,"cannot parse segment header");if((G=d.ed).zd=pe(V),G.Tb=fe(V,6),G.wb=fe(V,3),G.Pc=pe(V),G.Pc&&pe(V)){for(re=0;4>re;++re)pe(V)&&(G.vd[re]=U(V,6));for(re=0;4>re;++re)pe(V)&&(G.od[re]=U(V,6))}if(d.L=G.Tb==0?0:G.zd?1:2,V.Ka)return Ir(d,3,"cannot parse filter header");var ge=M;if(M=Y=C,C=Y+ge,G=ge,d.Xb=(1<<fe(d.m,2))-1,ge<3*(re=d.Xb))k=7;else{for(Y+=3*re,G-=3*re,ge=0;ge<re;++ge){var Ee=k[M+0]|k[M+1]<<8|k[M+2]<<16;Ee>G&&(Ee=G),se(d.Jc[+ge],k,Y,Ee),Y+=Ee,G-=Ee,M+=3}se(d.Jc[+re],k,Y,G),k=Y<C?0:5}if(k!=0)return Ir(d,k,"cannot parse partitions");for(k=fe(Y=d.m,7),M=pe(Y)?U(Y,4):0,C=pe(Y)?U(Y,4):0,G=pe(Y)?U(Y,4):0,re=pe(Y)?U(Y,4):0,Y=pe(Y)?U(Y,4):0,ge=d.Qa,Ee=0;4>Ee;++Ee){if(ge.Cb){var Ae=ge.Zb[Ee];ge.Fb||(Ae+=k)}else{if(0<Ee){d.pb[Ee]=d.pb[0];continue}Ae=k}var be=d.pb[Ee];be.Sc[0]=ig[Ta(Ae+M,127)],be.Sc[1]=sg[Ta(Ae+0,127)],be.Eb[0]=2*ig[Ta(Ae+C,127)],be.Eb[1]=101581*sg[Ta(Ae+G,127)]>>16,8>be.Eb[1]&&(be.Eb[1]=8),be.Qc[0]=ig[Ta(Ae+re,117)],be.Qc[1]=sg[Ta(Ae+Y,127)],be.lc=Ae+Y}if(!H.Rb)return Ir(d,4,"Not a key frame.");for(pe(V),H=d.Pa,k=0;4>k;++k){for(M=0;8>M;++M)for(C=0;3>C;++C)for(G=0;11>G;++G)re=de(V,lN[k][M][C][G])?fe(V,8):sN[k][M][C][G],H.Wc[k][M].Yb[C][G]=re;for(M=0;17>M;++M)H.Xc[k][M]=H.Wc[k][cN[M]]}return d.kc=pe(V),d.kc&&(d.Bd=fe(V,8)),d.cb=1}function Uh(d,v,k,C,M,V,H){var G=v[M].Yb[k];for(k=0;16>M;++M){if(!de(d,G[k+0]))return M;for(;!de(d,G[k+1]);)if(G=v[++M].Yb[0],k=0,M==16)return 16;var Y=v[M+1].Yb;if(de(d,G[k+2])){var re=d,ge=0;if(de(re,(Ae=G)[(Ee=k)+3]))if(de(re,Ae[Ee+6])){for(G=0,Ee=2*(ge=de(re,Ae[Ee+8]))+(Ae=de(re,Ae[Ee+9+ge])),ge=0,Ae=aN[Ee];Ae[G];++G)ge+=ge+de(re,Ae[G]);ge+=3+(8<<Ee)}else de(re,Ae[Ee+7])?(ge=7+2*de(re,165),ge+=de(re,145)):ge=5+de(re,159);else ge=de(re,Ae[Ee+4])?3+de(re,Ae[Ee+5]):2;G=Y[2]}else ge=1,G=Y[1];Y=H+iN[M],0>(re=d).b&&ne(re);var Ee,Ae=re.b,be=(Ee=re.Ca>>1)-(re.I>>Ae)>>31;--re.b,re.Ca+=be,re.Ca|=1,re.I-=(Ee+1&be)<<Ae,V[Y]=((ge^be)-be)*C[(0<M)+0]}return 16}function rf(d){var v=d.rb[d.sb-1];v.la=0,v.Na=0,a(d.zc,0,0,d.zc.length),d.ja=0}function Im(d,v){if(d==null)return 0;if(v==null)return Ir(d,2,"NULL VP8Io parameter in VP8Decode().");if(!d.cb&&!Bh(d,v))return 0;if(t(d.cb),v.ac==null||v.ac(v)){v.ob&&(d.L=0);var k=pd[d.L];if(d.L==2?(d.yb=0,d.zb=0):(d.yb=v.v-k>>4,d.zb=v.j-k>>4,0>d.yb&&(d.yb=0),0>d.zb&&(d.zb=0)),d.Va=v.o+15+k>>4,d.Hb=v.va+15+k>>4,d.Hb>d.za&&(d.Hb=d.za),d.Va>d.Ub&&(d.Va=d.Ub),0<d.L){var C=d.ed;for(k=0;4>k;++k){var M;if(d.Qa.Cb){var V=d.Qa.Lb[k];d.Qa.Fb||(V+=C.Tb)}else V=C.Tb;for(M=0;1>=M;++M){var H=d.gd[k][M],G=V;if(C.Pc&&(G+=C.vd[0],M&&(G+=C.od[0])),0<(G=0>G?0:63<G?63:G)){var Y=G;0<C.wb&&(Y=4<C.wb?Y>>2:Y>>1)>9-C.wb&&(Y=9-C.wb),1>Y&&(Y=1),H.dd=Y,H.tc=2*G+Y,H.ld=40<=G?2:15<=G?1:0}else H.tc=0;H.La=M}}}k=0}else Ir(d,6,"Frame setup failed"),k=d.a;if(k=k==0){if(k){d.$c=0,0<d.Aa||(d.Ic=_N);e:{k=d.Ic,C=4*(Y=d.za);var re=32*Y,ge=Y+1,Ee=0<d.L?Y*(0<d.Aa?2:1):0,Ae=(d.Aa==2?2:1)*Y;if((H=C+832+(M=3*(16*k+pd[d.L])/2*re)+(V=d.Fa!=null&&0<d.Fa.length?d.Kc.c*d.Kc.i:0))!=H)k=0;else{if(H>d.Vb){if(d.Vb=0,d.Ec=i(H),d.Fc=0,d.Ec==null){k=Ir(d,1,"no memory during frame initialization.");break e}d.Vb=H}H=d.Ec,G=d.Fc,d.Ac=H,d.Bc=G,G+=C,d.Gd=s(re,Gi),d.Hd=0,d.rb=s(ge+1,nr),d.sb=1,d.wa=Ee?s(Ee,Xt):null,d.Y=0,d.D.Nb=0,d.D.wa=d.wa,d.D.Y=d.Y,0<d.Aa&&(d.D.Y+=Y),t(!0),d.oc=H,d.pc=G,G+=832,d.ya=s(Ae,pi),d.aa=0,d.D.ya=d.ya,d.D.aa=d.aa,d.Aa==2&&(d.D.aa+=Y),d.R=16*Y,d.B=8*Y,Y=(re=pd[d.L])*d.R,re=re/2*d.B,d.sa=H,d.ta=G+Y,d.qa=d.sa,d.ra=d.ta+16*k*d.R+re,d.Ha=d.qa,d.Ia=d.ra+8*k*d.B+re,d.$c=0,G+=M,d.mb=V?H:null,d.nb=V?G:null,t(G+V<=d.Fc+d.Vb),rf(d),a(d.Ac,d.Bc,0,C),k=1}}if(k){if(v.ka=0,v.y=d.sa,v.O=d.ta,v.f=d.qa,v.N=d.ra,v.ea=d.Ha,v.Vd=d.Ia,v.fa=d.R,v.Rc=d.B,v.F=null,v.J=0,!id){for(k=-255;255>=k;++k)tn[255+k]=0>k?-k:k;for(k=-1020;1020>=k;++k)Es[1020+k]=-128>k?-128:127<k?127:k;for(k=-112;112>=k;++k)Ef[112+k]=-16>k?-16:15<k?15:k;for(k=-255;510>=k;++k)Ic[255+k]=0>k?0:255<k?255:k;id=1}Fc=Mm,ks=Rm,_f=$h,Xn=jm,qa=zh,Rr=Vh,Oc=cf,ad=ml,Sf=Jm,xl=uf,yl=Ym,co=Sc,wl=ff,Dc=Qh,bl=Jh,uo=Yi,kf=bs,Ga=Xm,yi[0]=Xi,yi[1]=Bm,yi[2]=zm,yi[3]=Hm,yi[4]=qh,yi[5]=bc,yi[6]=Gh,yi[7]=sf,yi[8]=qm,yi[9]=Wm,fo[0]=Hh,fo[1]=Vm,fo[2]=ws,fo[3]=yc,fo[4]=Tn,fo[5]=$m,fo[6]=Wh,As[0]=ao,As[1]=Um,As[2]=Gm,As[3]=of,As[4]=pl,As[5]=Km,As[6]=lf,k=1}else k=0}k&&(k=function(be,je){for(be.M=0;be.M<be.Va;++be.M){var Fe,ve=be.Jc[be.M&be.Xb],ye=be.m,Ie=be;for(Fe=0;Fe<Ie.za;++Fe){var Be=ye,Re=Ie,at=Re.Ac,Qe=Re.Bc+4*Fe,pt=Re.zc,et=Re.ya[Re.aa+Fe];if(Re.Qa.Bb?et.$b=de(Be,Re.Pa.jb[0])?2+de(Be,Re.Pa.jb[2]):de(Be,Re.Pa.jb[1]):et.$b=0,Re.kc&&(et.Ad=de(Be,Re.Bd)),et.Za=!de(Be,145)+0,et.Za){var qt=et.Ob,Qt=0;for(Re=0;4>Re;++Re){var $t,Rt=pt[0+Re];for($t=0;4>$t;++$t){Rt=oN[at[Qe+$t]][Rt];for(var sr=U5[de(Be,Rt[0])];0<sr;)sr=U5[2*sr+de(Be,Rt[sr])];Rt=-sr,at[Qe+$t]=Rt}n(qt,Qt,at,Qe,4),Qt+=4,pt[0+Re]=Rt}}else Rt=de(Be,156)?de(Be,128)?1:3:de(Be,163)?2:0,et.Ob[0]=Rt,a(at,Qe,Rt,4),a(pt,0,Rt,4);et.Dd=de(Be,142)?de(Be,114)?de(Be,183)?1:3:2:0}if(Ie.m.Ka)return Ir(be,7,"Premature end-of-partition0 encountered.");for(;be.ja<be.za;++be.ja){if(Ie=ve,Be=(ye=be).rb[ye.sb-1],at=ye.rb[ye.sb+ye.ja],Fe=ye.ya[ye.aa+ye.ja],Qe=ye.kc?Fe.Ad:0)Be.la=at.la=0,Fe.Za||(Be.Na=at.Na=0),Fe.Hc=0,Fe.Gc=0,Fe.ia=0;else{var ar,Pt;if(Be=at,at=Ie,Qe=ye.Pa.Xc,pt=ye.ya[ye.aa+ye.ja],et=ye.pb[pt.$b],Re=pt.ad,qt=0,Qt=ye.rb[ye.sb-1],Rt=$t=0,a(Re,qt,0,384),pt.Za)var qr=0,ha=Qe[3];else{sr=i(16);var Gr=Be.Na+Qt.Na;if(Gr=Af(at,Qe[1],Gr,et.Eb,0,sr,0),Be.Na=Qt.Na=(0<Gr)+0,1<Gr)Fc(sr,0,Re,qt);else{var da=sr[0]+3>>3;for(sr=0;256>sr;sr+=16)Re[qt+sr]=da}qr=1,ha=Qe[0]}var Zt=15&Be.la,Na=15&Qt.la;for(sr=0;4>sr;++sr){var Pa=1&Na;for(da=Pt=0;4>da;++da)Zt=Zt>>1|(Pa=(Gr=Af(at,ha,Gr=Pa+(1&Zt),et.Sc,qr,Re,qt))>qr)<<7,Pt=Pt<<2|(3<Gr?3:1<Gr?2:Re[qt+0]!=0),qt+=16;Zt>>=4,Na=Na>>1|Pa<<7,$t=($t<<8|Pt)>>>0}for(ha=Zt,qr=Na>>4,ar=0;4>ar;ar+=2){for(Pt=0,Zt=Be.la>>4+ar,Na=Qt.la>>4+ar,sr=0;2>sr;++sr){for(Pa=1&Na,da=0;2>da;++da)Gr=Pa+(1&Zt),Zt=Zt>>1|(Pa=0<(Gr=Af(at,Qe[2],Gr,et.Qc,0,Re,qt)))<<3,Pt=Pt<<2|(3<Gr?3:1<Gr?2:Re[qt+0]!=0),qt+=16;Zt>>=2,Na=Na>>1|Pa<<5}Rt|=Pt<<4*ar,ha|=Zt<<4<<ar,qr|=(240&Na)<<ar}Be.la=ha,Qt.la=qr,pt.Hc=$t,pt.Gc=Rt,pt.ia=43690&Rt?0:et.ia,Qe=!($t|Rt)}if(0<ye.L&&(ye.wa[ye.Y+ye.ja]=ye.gd[Fe.$b][Fe.Za],ye.wa[ye.Y+ye.ja].La|=!Qe),Ie.Ka)return Ir(be,7,"Premature end-of-file encountered.")}if(rf(be),ye=je,Ie=1,Fe=(ve=be).D,Be=0<ve.L&&ve.M>=ve.zb&&ve.M<=ve.Va,ve.Aa==0)e:{if(Fe.M=ve.M,Fe.uc=Be,vf(ve,Fe),Ie=1,Fe=(Pt=ve.D).Nb,Be=(Rt=pd[ve.L])*ve.R,at=Rt/2*ve.B,sr=16*Fe*ve.R,da=8*Fe*ve.B,Qe=ve.sa,pt=ve.ta-Be+sr,et=ve.qa,Re=ve.ra-at+da,qt=ve.Ha,Qt=ve.Ia-at+da,Na=(Zt=Pt.M)==0,$t=Zt>=ve.Va-1,ve.Aa==2&&vf(ve,Pt),Pt.uc)for(Pa=(Gr=ve).D.M,t(Gr.D.uc),Pt=Gr.yb;Pt<Gr.Hb;++Pt){qr=Pt,ha=Pa;var un=(yn=(Nr=Gr).D).Nb;ar=Nr.R;var yn=yn.wa[yn.Y+qr],Yn=Nr.sa,Ja=Nr.ta+16*un*ar+16*qr,Qi=yn.dd,fn=yn.tc;if(fn!=0)if(t(3<=fn),Nr.L==1)0<qr&&uo(Yn,Ja,ar,fn+4),yn.La&&Ga(Yn,Ja,ar,fn),0<ha&&bl(Yn,Ja,ar,fn+4),yn.La&&kf(Yn,Ja,ar,fn);else{var Ts=Nr.B,_l=Nr.qa,Rc=Nr.ra+8*un*Ts+8*qr,po=Nr.Ha,Nr=Nr.Ia+8*un*Ts+8*qr;un=yn.ld,0<qr&&(ad(Yn,Ja,ar,fn+4,Qi,un),xl(_l,Rc,po,Nr,Ts,fn+4,Qi,un)),yn.La&&(co(Yn,Ja,ar,fn,Qi,un),Dc(_l,Rc,po,Nr,Ts,fn,Qi,un)),0<ha&&(Oc(Yn,Ja,ar,fn+4,Qi,un),Sf(_l,Rc,po,Nr,Ts,fn+4,Qi,un)),yn.La&&(yl(Yn,Ja,ar,fn,Qi,un),wl(_l,Rc,po,Nr,Ts,fn,Qi,un))}}if(ve.ia&&alert("todo:DitherRow"),ye.put!=null){if(Pt=16*Zt,Zt=16*(Zt+1),Na?(ye.y=ve.sa,ye.O=ve.ta+sr,ye.f=ve.qa,ye.N=ve.ra+da,ye.ea=ve.Ha,ye.W=ve.Ia+da):(Pt-=Rt,ye.y=Qe,ye.O=pt,ye.f=et,ye.N=Re,ye.ea=qt,ye.W=Qt),$t||(Zt-=Rt),Zt>ye.o&&(Zt=ye.o),ye.F=null,ye.J=null,ve.Fa!=null&&0<ve.Fa.length&&Pt<Zt&&(ye.J=mf(ve,ye,Pt,Zt-Pt),ye.F=ve.mb,ye.F==null&&ye.F.length==0)){Ie=Ir(ve,3,"Could not decode alpha data.");break e}Pt<ye.j&&(Rt=ye.j-Pt,Pt=ye.j,t(!(1&Rt)),ye.O+=ve.R*Rt,ye.N+=ve.B*(Rt>>1),ye.W+=ve.B*(Rt>>1),ye.F!=null&&(ye.J+=ye.width*Rt)),Pt<Zt&&(ye.O+=ye.v,ye.N+=ye.v>>1,ye.W+=ye.v>>1,ye.F!=null&&(ye.J+=ye.v),ye.ka=Pt-ye.j,ye.U=ye.va-ye.v,ye.T=Zt-Pt,Ie=ye.put(ye))}Fe+1!=ve.Ic||$t||(n(ve.sa,ve.ta-Be,Qe,pt+16*ve.R,Be),n(ve.qa,ve.ra-at,et,Re+8*ve.B,at),n(ve.Ha,ve.Ia-at,qt,Qt+8*ve.B,at))}if(!Ie)return Ir(be,6,"Output aborted.")}return 1}(d,v)),v.bc!=null&&v.bc(v),k&=1}return k?(d.cb=0,k):0}function gi(d,v,k,C,M){M=d[v+k+32*C]+(M>>3),d[v+k+32*C]=-256&M?0>M?0:255:M}function xc(d,v,k,C,M,V){gi(d,v,0,k,C+M),gi(d,v,1,k,C+V),gi(d,v,2,k,C-V),gi(d,v,3,k,C-M)}function ca(d){return(20091*d>>16)+d}function nf(d,v,k,C){var M,V=0,H=i(16);for(M=0;4>M;++M){var G=d[v+0]+d[v+8],Y=d[v+0]-d[v+8],re=(35468*d[v+4]>>16)-ca(d[v+12]),ge=ca(d[v+4])+(35468*d[v+12]>>16);H[V+0]=G+ge,H[V+1]=Y+re,H[V+2]=Y-re,H[V+3]=G-ge,V+=4,v++}for(M=V=0;4>M;++M)G=(d=H[V+0]+4)+H[V+8],Y=d-H[V+8],re=(35468*H[V+4]>>16)-ca(H[V+12]),gi(k,C,0,0,G+(ge=ca(H[V+4])+(35468*H[V+12]>>16))),gi(k,C,1,0,Y+re),gi(k,C,2,0,Y-re),gi(k,C,3,0,G-ge),V++,C+=32}function Vh(d,v,k,C){var M=d[v+0]+4,V=35468*d[v+4]>>16,H=ca(d[v+4]),G=35468*d[v+1]>>16;xc(k,C,0,M+H,d=ca(d[v+1]),G),xc(k,C,1,M+V,d,G),xc(k,C,2,M-V,d,G),xc(k,C,3,M-H,d,G)}function Rm(d,v,k,C,M){nf(d,v,k,C),M&&nf(d,v+16,k,C+4)}function $h(d,v,k,C){ks(d,v+0,k,C,1),ks(d,v+32,k,C+128,1)}function jm(d,v,k,C){var M;for(d=d[v+0]+4,M=0;4>M;++M)for(v=0;4>v;++v)gi(k,C,v,M,d)}function zh(d,v,k,C){d[v+0]&&Xn(d,v+0,k,C),d[v+16]&&Xn(d,v+16,k,C+4),d[v+32]&&Xn(d,v+32,k,C+128),d[v+48]&&Xn(d,v+48,k,C+128+4)}function Mm(d,v,k,C){var M,V=i(16);for(M=0;4>M;++M){var H=d[v+0+M]+d[v+12+M],G=d[v+4+M]+d[v+8+M],Y=d[v+4+M]-d[v+8+M],re=d[v+0+M]-d[v+12+M];V[0+M]=H+G,V[8+M]=H-G,V[4+M]=re+Y,V[12+M]=re-Y}for(M=0;4>M;++M)H=(d=V[0+4*M]+3)+V[3+4*M],G=V[1+4*M]+V[2+4*M],Y=V[1+4*M]-V[2+4*M],re=d-V[3+4*M],k[C+0]=H+G>>3,k[C+16]=re+Y>>3,k[C+32]=H-G>>3,k[C+48]=re-Y>>3,C+=64}function af(d,v,k){var C,M=v-32,V=Ca,H=255-d[M-1];for(C=0;C<k;++C){var G,Y=V,re=H+d[v-1];for(G=0;G<k;++G)d[v+G]=Y[re+d[M+G]];v+=32}}function Bm(d,v){af(d,v,4)}function Um(d,v){af(d,v,8)}function Vm(d,v){af(d,v,16)}function ws(d,v){var k;for(k=0;16>k;++k)n(d,v+32*k,d,v-32,16)}function yc(d,v){var k;for(k=16;0<k;--k)a(d,v,d[v-1],16),v+=32}function wc(d,v,k){var C;for(C=0;16>C;++C)a(v,k+32*C,d,16)}function Hh(d,v){var k,C=16;for(k=0;16>k;++k)C+=d[v-1+32*k]+d[v+k-32];wc(C>>5,d,v)}function Tn(d,v){var k,C=8;for(k=0;16>k;++k)C+=d[v-1+32*k];wc(C>>4,d,v)}function $m(d,v){var k,C=8;for(k=0;16>k;++k)C+=d[v+k-32];wc(C>>4,d,v)}function Wh(d,v){wc(128,d,v)}function St(d,v,k){return d+2*v+k+2>>2}function zm(d,v){var k,C=v-32;for(C=new Uint8Array([St(d[C-1],d[C+0],d[C+1]),St(d[C+0],d[C+1],d[C+2]),St(d[C+1],d[C+2],d[C+3]),St(d[C+2],d[C+3],d[C+4])]),k=0;4>k;++k)n(d,v+32*k,C,0,C.length)}function Hm(d,v){var k=d[v-1],C=d[v-1+32],M=d[v-1+64],V=d[v-1+96];we(d,v+0,16843009*St(d[v-1-32],k,C)),we(d,v+32,16843009*St(k,C,M)),we(d,v+64,16843009*St(C,M,V)),we(d,v+96,16843009*St(M,V,V))}function Xi(d,v){var k,C=4;for(k=0;4>k;++k)C+=d[v+k-32]+d[v-1+32*k];for(C>>=3,k=0;4>k;++k)a(d,v+32*k,C,4)}function qh(d,v){var k=d[v-1+0],C=d[v-1+32],M=d[v-1+64],V=d[v-1-32],H=d[v+0-32],G=d[v+1-32],Y=d[v+2-32],re=d[v+3-32];d[v+0+96]=St(C,M,d[v-1+96]),d[v+1+96]=d[v+0+64]=St(k,C,M),d[v+2+96]=d[v+1+64]=d[v+0+32]=St(V,k,C),d[v+3+96]=d[v+2+64]=d[v+1+32]=d[v+0+0]=St(H,V,k),d[v+3+64]=d[v+2+32]=d[v+1+0]=St(G,H,V),d[v+3+32]=d[v+2+0]=St(Y,G,H),d[v+3+0]=St(re,Y,G)}function Gh(d,v){var k=d[v+1-32],C=d[v+2-32],M=d[v+3-32],V=d[v+4-32],H=d[v+5-32],G=d[v+6-32],Y=d[v+7-32];d[v+0+0]=St(d[v+0-32],k,C),d[v+1+0]=d[v+0+32]=St(k,C,M),d[v+2+0]=d[v+1+32]=d[v+0+64]=St(C,M,V),d[v+3+0]=d[v+2+32]=d[v+1+64]=d[v+0+96]=St(M,V,H),d[v+3+32]=d[v+2+64]=d[v+1+96]=St(V,H,G),d[v+3+64]=d[v+2+96]=St(H,G,Y),d[v+3+96]=St(G,Y,Y)}function bc(d,v){var k=d[v-1+0],C=d[v-1+32],M=d[v-1+64],V=d[v-1-32],H=d[v+0-32],G=d[v+1-32],Y=d[v+2-32],re=d[v+3-32];d[v+0+0]=d[v+1+64]=V+H+1>>1,d[v+1+0]=d[v+2+64]=H+G+1>>1,d[v+2+0]=d[v+3+64]=G+Y+1>>1,d[v+3+0]=Y+re+1>>1,d[v+0+96]=St(M,C,k),d[v+0+64]=St(C,k,V),d[v+0+32]=d[v+1+96]=St(k,V,H),d[v+1+32]=d[v+2+96]=St(V,H,G),d[v+2+32]=d[v+3+96]=St(H,G,Y),d[v+3+32]=St(G,Y,re)}function sf(d,v){var k=d[v+0-32],C=d[v+1-32],M=d[v+2-32],V=d[v+3-32],H=d[v+4-32],G=d[v+5-32],Y=d[v+6-32],re=d[v+7-32];d[v+0+0]=k+C+1>>1,d[v+1+0]=d[v+0+64]=C+M+1>>1,d[v+2+0]=d[v+1+64]=M+V+1>>1,d[v+3+0]=d[v+2+64]=V+H+1>>1,d[v+0+32]=St(k,C,M),d[v+1+32]=d[v+0+96]=St(C,M,V),d[v+2+32]=d[v+1+96]=St(M,V,H),d[v+3+32]=d[v+2+96]=St(V,H,G),d[v+3+64]=St(H,G,Y),d[v+3+96]=St(G,Y,re)}function Wm(d,v){var k=d[v-1+0],C=d[v-1+32],M=d[v-1+64],V=d[v-1+96];d[v+0+0]=k+C+1>>1,d[v+2+0]=d[v+0+32]=C+M+1>>1,d[v+2+32]=d[v+0+64]=M+V+1>>1,d[v+1+0]=St(k,C,M),d[v+3+0]=d[v+1+32]=St(C,M,V),d[v+3+32]=d[v+1+64]=St(M,V,V),d[v+3+64]=d[v+2+64]=d[v+0+96]=d[v+1+96]=d[v+2+96]=d[v+3+96]=V}function qm(d,v){var k=d[v-1+0],C=d[v-1+32],M=d[v-1+64],V=d[v-1+96],H=d[v-1-32],G=d[v+0-32],Y=d[v+1-32],re=d[v+2-32];d[v+0+0]=d[v+2+32]=k+H+1>>1,d[v+0+32]=d[v+2+64]=C+k+1>>1,d[v+0+64]=d[v+2+96]=M+C+1>>1,d[v+0+96]=V+M+1>>1,d[v+3+0]=St(G,Y,re),d[v+2+0]=St(H,G,Y),d[v+1+0]=d[v+3+32]=St(k,H,G),d[v+1+32]=d[v+3+64]=St(C,k,H),d[v+1+64]=d[v+3+96]=St(M,C,k),d[v+1+96]=St(V,M,C)}function Gm(d,v){var k;for(k=0;8>k;++k)n(d,v+32*k,d,v-32,8)}function of(d,v){var k;for(k=0;8>k;++k)a(d,v,d[v-1],8),v+=32}function dl(d,v,k){var C;for(C=0;8>C;++C)a(v,k+32*C,d,8)}function ao(d,v){var k,C=8;for(k=0;8>k;++k)C+=d[v+k-32]+d[v-1+32*k];dl(C>>4,d,v)}function Km(d,v){var k,C=4;for(k=0;8>k;++k)C+=d[v+k-32];dl(C>>3,d,v)}function pl(d,v){var k,C=4;for(k=0;8>k;++k)C+=d[v-1+32*k];dl(C>>3,d,v)}function lf(d,v){dl(128,d,v)}function _c(d,v,k){var C=d[v-k],M=d[v+0],V=3*(M-C)+eg[1020+d[v-2*k]-d[v+k]],H=sd[112+(V+4>>3)];d[v-k]=Ca[255+C+sd[112+(V+3>>3)]],d[v+0]=Ca[255+M-H]}function Kh(d,v,k,C){var M=d[v+0],V=d[v+k];return Xa[255+d[v-2*k]-d[v-k]]>C||Xa[255+V-M]>C}function Xh(d,v,k,C){return 4*Xa[255+d[v-k]-d[v+0]]+Xa[255+d[v-2*k]-d[v+k]]<=C}function Yh(d,v,k,C,M){var V=d[v-3*k],H=d[v-2*k],G=d[v-k],Y=d[v+0],re=d[v+k],ge=d[v+2*k],Ee=d[v+3*k];return 4*Xa[255+G-Y]+Xa[255+H-re]>C?0:Xa[255+d[v-4*k]-V]<=M&&Xa[255+V-H]<=M&&Xa[255+H-G]<=M&&Xa[255+Ee-ge]<=M&&Xa[255+ge-re]<=M&&Xa[255+re-Y]<=M}function Jh(d,v,k,C){var M=2*C+1;for(C=0;16>C;++C)Xh(d,v+C,k,M)&&_c(d,v+C,k)}function Yi(d,v,k,C){var M=2*C+1;for(C=0;16>C;++C)Xh(d,v+C*k,1,M)&&_c(d,v+C*k,1)}function bs(d,v,k,C){var M;for(M=3;0<M;--M)Jh(d,v+=4*k,k,C)}function Xm(d,v,k,C){var M;for(M=3;0<M;--M)Yi(d,v+=4,k,C)}function io(d,v,k,C,M,V,H,G){for(V=2*V+1;0<M--;){if(Yh(d,v,k,V,H))if(Kh(d,v,k,G))_c(d,v,k);else{var Y=d,re=v,ge=k,Ee=Y[re-2*ge],Ae=Y[re-ge],be=Y[re+0],je=Y[re+ge],Fe=Y[re+2*ge],ve=27*(Ie=eg[1020+3*(be-Ae)+eg[1020+Ee-je]])+63>>7,ye=18*Ie+63>>7,Ie=9*Ie+63>>7;Y[re-3*ge]=Ca[255+Y[re-3*ge]+Ie],Y[re-2*ge]=Ca[255+Ee+ye],Y[re-ge]=Ca[255+Ae+ve],Y[re+0]=Ca[255+be-ve],Y[re+ge]=Ca[255+je-ye],Y[re+2*ge]=Ca[255+Fe-Ie]}v+=C}}function vi(d,v,k,C,M,V,H,G){for(V=2*V+1;0<M--;){if(Yh(d,v,k,V,H))if(Kh(d,v,k,G))_c(d,v,k);else{var Y=d,re=v,ge=k,Ee=Y[re-ge],Ae=Y[re+0],be=Y[re+ge],je=sd[112+((Fe=3*(Ae-Ee))+4>>3)],Fe=sd[112+(Fe+3>>3)],ve=je+1>>1;Y[re-2*ge]=Ca[255+Y[re-2*ge]+ve],Y[re-ge]=Ca[255+Ee+Fe],Y[re+0]=Ca[255+Ae-je],Y[re+ge]=Ca[255+be-ve]}v+=C}}function cf(d,v,k,C,M,V){io(d,v,k,1,16,C,M,V)}function ml(d,v,k,C,M,V){io(d,v,1,k,16,C,M,V)}function Ym(d,v,k,C,M,V){var H;for(H=3;0<H;--H)vi(d,v+=4*k,k,1,16,C,M,V)}function Sc(d,v,k,C,M,V){var H;for(H=3;0<H;--H)vi(d,v+=4,1,k,16,C,M,V)}function Jm(d,v,k,C,M,V,H,G){io(d,v,M,1,8,V,H,G),io(k,C,M,1,8,V,H,G)}function uf(d,v,k,C,M,V,H,G){io(d,v,1,M,8,V,H,G),io(k,C,1,M,8,V,H,G)}function ff(d,v,k,C,M,V,H,G){vi(d,v+4*M,M,1,8,V,H,G),vi(k,C+4*M,M,1,8,V,H,G)}function Qh(d,v,k,C,M,V,H,G){vi(d,v+4,1,M,8,V,H,G),vi(k,C+4,1,M,8,V,H,G)}function kc(){this.ba=new ka,this.ec=[],this.cc=[],this.Mc=[],this.Dc=this.Nc=this.dc=this.fc=0,this.Oa=new ir,this.memory=0,this.Ib="OutputFunc",this.Jb="OutputAlphaFunc",this.Nd="OutputRowFunc"}function hf(){this.data=[],this.offset=this.kd=this.ha=this.w=0,this.na=[],this.xa=this.gb=this.Ja=this.Sa=this.P=0}function df(){this.nc=this.Ea=this.b=this.hc=0,this.K=[],this.w=0}function Zh(){this.ua=0,this.Wa=new ae,this.vb=new ae,this.md=this.xc=this.wc=0,this.vc=[],this.Wb=0,this.Ya=new W,this.yc=new P}function Qm(){this.xb=this.a=0,this.l=new Ki,this.ca=new ka,this.V=[],this.Ba=0,this.Ta=[],this.Ua=0,this.m=new E,this.Pb=0,this.wd=new E,this.Ma=this.$=this.C=this.i=this.c=this.xd=0,this.s=new Zh,this.ab=0,this.gc=s(4,df),this.Oc=0}function Ec(){this.Lc=this.Z=this.$a=this.i=this.c=0,this.l=new Ki,this.ic=0,this.ca=[],this.tb=0,this.qd=null,this.rd=0}function gl(d,v,k,C,M,V,H){for(d=d==null?0:d[v+0],v=0;v<H;++v)M[V+v]=d+k[C+v]&255,d=M[V+v]}function pf(d,v,k,C,M,V,H){var G;if(d==null)gl(null,null,k,C,M,V,H);else for(G=0;G<H;++G)M[V+G]=d[v+G]+k[C+G]&255}function so(d,v,k,C,M,V,H){if(d==null)gl(null,null,k,C,M,V,H);else{var G,Y=d[v+0],re=Y,ge=Y;for(G=0;G<H;++G)re=ge+(Y=d[v+G])-re,ge=k[C+G]+(-256&re?0>re?0:255:re)&255,re=Y,M[V+G]=ge}}function mf(d,v,k,C){var M=v.width,V=v.o;if(t(d!=null&&v!=null),0>k||0>=C||k+C>V)return null;if(!d.Cc){if(d.ga==null){var H;if(d.ga=new Ec,(H=d.ga==null)||(H=v.width*v.o,t(d.Gb.length==0),d.Gb=i(H),d.Uc=0,d.Gb==null?H=0:(d.mb=d.Gb,d.nb=d.Uc,d.rc=null,H=1),H=!H),!H){H=d.ga;var G=d.Fa,Y=d.P,re=d.qc,ge=d.mb,Ee=d.nb,Ae=Y+1,be=re-1,je=H.l;if(t(G!=null&&ge!=null&&v!=null),ho[0]=null,ho[1]=gl,ho[2]=pf,ho[3]=so,H.ca=ge,H.tb=Ee,H.c=v.width,H.i=v.height,t(0<H.c&&0<H.i),1>=re)v=0;else if(H.$a=G[Y+0]>>0&3,H.Z=G[Y+0]>>2&3,H.Lc=G[Y+0]>>4&3,Y=G[Y+0]>>6&3,0>H.$a||1<H.$a||4<=H.Z||1<H.Lc||Y)v=0;else if(je.put=za,je.ac=en,je.bc=Ha,je.ma=H,je.width=v.width,je.height=v.height,je.Da=v.Da,je.v=v.v,je.va=v.va,je.j=v.j,je.o=v.o,H.$a)e:{t(H.$a==1),v=Le();t:for(;;){if(v==null){v=0;break e}if(t(H!=null),H.mc=v,v.c=H.c,v.i=H.i,v.l=H.l,v.l.ma=H,v.l.width=H.c,v.l.height=H.i,v.a=0,Q(v.m,G,Ae,be),!Se(H.c,H.i,1,v,null)||(v.ab==1&&v.gc[0].hc==3&&ee(v.s)?(H.ic=1,G=v.c*v.i,v.Ta=null,v.Ua=0,v.V=i(G),v.Ba=0,v.V==null?(v.a=1,v=0):v=1):(H.ic=0,v=Te(v,H.c)),!v))break t;v=1;break e}H.mc=null,v=0}else v=be>=H.c*H.i;H=!v}if(H)return null;d.ga.Lc!=1?d.Ga=0:C=V-k}t(d.ga!=null),t(k+C<=V);e:{if(v=(G=d.ga).c,V=G.l.o,G.$a==0){if(Ae=d.rc,be=d.Vc,je=d.Fa,Y=d.P+1+k*v,re=d.mb,ge=d.nb+k*v,t(Y<=d.P+d.qc),G.Z!=0)for(t(ho[G.Z]!=null),H=0;H<C;++H)ho[G.Z](Ae,be,je,Y,re,ge,v),Ae=re,be=ge,ge+=v,Y+=v;else for(H=0;H<C;++H)n(re,ge,je,Y,v),Ae=re,be=ge,ge+=v,Y+=v;d.rc=Ae,d.Vc=be}else{if(t(G.mc!=null),v=k+C,t((H=G.mc)!=null),t(v<=H.i),H.C>=v)v=1;else if(G.ic||_e(),G.ic){G=H.V,Ae=H.Ba,be=H.c;var Fe=H.i,ve=(je=1,Y=H.$/be,re=H.$%be,ge=H.m,Ee=H.s,H.$),ye=be*Fe,Ie=be*v,Be=Ee.wc,Re=ve<Ie?Tr(Ee,re,Y):null;t(ve<=ye),t(v<=Fe),t(ee(Ee));t:for(;;){for(;!ge.h&&ve<Ie;){if(re&Be||(Re=Tr(Ee,re,Y)),t(Re!=null),K(ge),256>(Fe=An(Re.G[0],Re.H[0],ge)))G[Ae+ve]=Fe,++ve,++re>=be&&(re=0,++Y<=v&&!(Y%16)&&oe(H,Y));else{if(!(280>Fe)){je=0;break t}Fe=Ea(Fe-256,ge);var at,Qe=An(Re.G[4],Re.H[4],ge);if(K(ge),!(ve>=(Qe=la(be,Qe=Ea(Qe,ge)))&&ye-ve>=Fe)){je=0;break t}for(at=0;at<Fe;++at)G[Ae+ve+at]=G[Ae+ve+at-Qe];for(ve+=Fe,re+=Fe;re>=be;)re-=be,++Y<=v&&!(Y%16)&&oe(H,Y);ve<Ie&&re&Be&&(Re=Tr(Ee,re,Y))}t(ge.h==O(ge))}oe(H,Y>v?v:Y);break t}!je||ge.h&&ve<ye?(je=0,H.a=ge.h?5:3):H.$=ve,v=je}else v=ce(H,H.V,H.Ba,H.c,H.i,v,Ne);if(!v){C=0;break e}}k+C>=V&&(d.Cc=1),C=1}if(!C)return null;if(d.Cc&&((C=d.ga)!=null&&(C.mc=null),d.ga=null,0<d.Ga))return alert("todo:WebPDequantizeLevels"),null}return d.nb+k*M}function S(d,v,k,C,M,V){for(;0<M--;){var H,G=d,Y=v+(k?1:0),re=d,ge=v+(k?0:3);for(H=0;H<C;++H){var Ee=re[ge+4*H];Ee!=255&&(Ee*=32897,G[Y+4*H+0]=G[Y+4*H+0]*Ee>>23,G[Y+4*H+1]=G[Y+4*H+1]*Ee>>23,G[Y+4*H+2]=G[Y+4*H+2]*Ee>>23)}v+=V}}function B(d,v,k,C,M){for(;0<C--;){var V;for(V=0;V<k;++V){var H=d[v+2*V+0],G=15&(re=d[v+2*V+1]),Y=4369*G,re=(240&re|re>>4)*Y>>16;d[v+2*V+0]=(240&H|H>>4)*Y>>16&240|(15&H|H<<4)*Y>>16>>4&15,d[v+2*V+1]=240&re|G}v+=M}}function ue(d,v,k,C,M,V,H,G){var Y,re,ge=255;for(re=0;re<M;++re){for(Y=0;Y<C;++Y){var Ee=d[v+Y];V[H+4*Y]=Ee,ge&=Ee}v+=k,H+=G}return ge!=255}function me(d,v,k,C,M){var V;for(V=0;V<M;++V)k[C+V]=d[v+V]>>8}function _e(){Ka=S,cr=B,ur=ue,jr=me}function Oe(d,v,k){F[d]=function(C,M,V,H,G,Y,re,ge,Ee,Ae,be,je,Fe,ve,ye,Ie,Be){var Re,at=Be-1>>1,Qe=G[Y+0]|re[ge+0]<<16,pt=Ee[Ae+0]|be[je+0]<<16;t(C!=null);var et=3*Qe+pt+131074>>2;for(v(C[M+0],255&et,et>>16,Fe,ve),V!=null&&(et=3*pt+Qe+131074>>2,v(V[H+0],255&et,et>>16,ye,Ie)),Re=1;Re<=at;++Re){var qt=G[Y+Re]|re[ge+Re]<<16,Qt=Ee[Ae+Re]|be[je+Re]<<16,$t=Qe+qt+pt+Qt+524296,Rt=$t+2*(qt+pt)>>3;et=Rt+Qe>>1,Qe=($t=$t+2*(Qe+Qt)>>3)+qt>>1,v(C[M+2*Re-1],255&et,et>>16,Fe,ve+(2*Re-1)*k),v(C[M+2*Re-0],255&Qe,Qe>>16,Fe,ve+(2*Re-0)*k),V!=null&&(et=$t+pt>>1,Qe=Rt+Qt>>1,v(V[H+2*Re-1],255&et,et>>16,ye,Ie+(2*Re-1)*k),v(V[H+2*Re+0],255&Qe,Qe>>16,ye,Ie+(2*Re+0)*k)),Qe=qt,pt=Qt}1&Be||(et=3*Qe+pt+131074>>2,v(C[M+Be-1],255&et,et>>16,Fe,ve+(Be-1)*k),V!=null&&(et=3*pt+Qe+131074>>2,v(V[H+Be-1],255&et,et>>16,ye,Ie+(Be-1)*k)))}}function Ue(){Ya[od]=fN,Ya[ld]=$5,Ya[j5]=hN,Ya[cd]=z5,Ya[ud]=H5,Ya[tg]=W5,Ya[M5]=dN,Ya[rg]=$5,Ya[ng]=z5,Ya[fd]=H5,Ya[ag]=W5}function nt(d){return d&~pN?0>d?0:255:d>>q5}function ut(d,v){return nt((19077*d>>8)+(26149*v>>8)-14234)}function Nt(d,v,k){return nt((19077*d>>8)-(6419*v>>8)-(13320*k>>8)+8708)}function Et(d,v){return nt((19077*d>>8)+(33050*v>>8)-17685)}function Mt(d,v,k,C,M){C[M+0]=ut(d,k),C[M+1]=Nt(d,v,k),C[M+2]=Et(d,v)}function _r(d,v,k,C,M){C[M+0]=Et(d,v),C[M+1]=Nt(d,v,k),C[M+2]=ut(d,k)}function Cr(d,v,k,C,M){var V=Nt(d,v,k);v=V<<3&224|Et(d,v)>>3,C[M+0]=248&ut(d,k)|V>>5,C[M+1]=v}function Wr(d,v,k,C,M){var V=240&Et(d,v)|15;C[M+0]=240&ut(d,k)|Nt(d,v,k)>>4,C[M+1]=V}function Cn(d,v,k,C,M){C[M+0]=255,Mt(d,v,k,C,M+1)}function cn(d,v,k,C,M){_r(d,v,k,C,M),C[M+3]=255}function xi(d,v,k,C,M){Mt(d,v,k,C,M),C[M+3]=255}function Ta(d,v){return 0>d?0:d>v?v:d}function Ji(d,v,k){F[d]=function(C,M,V,H,G,Y,re,ge,Ee){for(var Ae=ge+(-2&Ee)*k;ge!=Ae;)v(C[M+0],V[H+0],G[Y+0],re,ge),v(C[M+1],V[H+0],G[Y+0],re,ge+k),M+=2,++H,++Y,ge+=2*k;1&Ee&&v(C[M+0],V[H+0],G[Y+0],re,ge)}}function ed(d,v,k){return k==0?d==0?v==0?6:5:v==0?4:0:k}function gf(d,v,k,C,M){switch(d>>>30){case 3:ks(v,k,C,M,0);break;case 2:Rr(v,k,C,M);break;case 1:Xn(v,k,C,M)}}function vf(d,v){var k,C,M=v.M,V=v.Nb,H=d.oc,G=d.pc+40,Y=d.oc,re=d.pc+584,ge=d.oc,Ee=d.pc+600;for(k=0;16>k;++k)H[G+32*k-1]=129;for(k=0;8>k;++k)Y[re+32*k-1]=129,ge[Ee+32*k-1]=129;for(0<M?H[G-1-32]=Y[re-1-32]=ge[Ee-1-32]=129:(a(H,G-32-1,127,21),a(Y,re-32-1,127,9),a(ge,Ee-32-1,127,9)),C=0;C<d.za;++C){var Ae=v.ya[v.aa+C];if(0<C){for(k=-1;16>k;++k)n(H,G+32*k-4,H,G+32*k+12,4);for(k=-1;8>k;++k)n(Y,re+32*k-4,Y,re+32*k+4,4),n(ge,Ee+32*k-4,ge,Ee+32*k+4,4)}var be=d.Gd,je=d.Hd+C,Fe=Ae.ad,ve=Ae.Hc;if(0<M&&(n(H,G-32,be[je].y,0,16),n(Y,re-32,be[je].f,0,8),n(ge,Ee-32,be[je].ea,0,8)),Ae.Za){var ye=H,Ie=G-32+16;for(0<M&&(C>=d.za-1?a(ye,Ie,be[je].y[15],4):n(ye,Ie,be[je+1].y,0,4)),k=0;4>k;k++)ye[Ie+128+k]=ye[Ie+256+k]=ye[Ie+384+k]=ye[Ie+0+k];for(k=0;16>k;++k,ve<<=2)ye=H,Ie=G+K5[k],yi[Ae.Ob[k]](ye,Ie),gf(ve,Fe,16*+k,ye,Ie)}else if(ye=ed(C,M,Ae.Ob[0]),fo[ye](H,G),ve!=0)for(k=0;16>k;++k,ve<<=2)gf(ve,Fe,16*+k,H,G+K5[k]);for(k=Ae.Gc,ye=ed(C,M,Ae.Dd),As[ye](Y,re),As[ye](ge,Ee),ve=Fe,ye=Y,Ie=re,255&(Ae=k>>0)&&(170&Ae?_f(ve,256,ye,Ie):qa(ve,256,ye,Ie)),Ae=ge,ve=Ee,255&(k>>=8)&&(170&k?_f(Fe,320,Ae,ve):qa(Fe,320,Ae,ve)),M<d.Ub-1&&(n(be[je].y,0,H,G+480,16),n(be[je].f,0,Y,re+224,8),n(be[je].ea,0,ge,Ee+224,8)),k=8*V*d.B,be=d.sa,je=d.ta+16*C+16*V*d.R,Fe=d.qa,Ae=d.ra+8*C+k,ve=d.Ha,ye=d.Ia+8*C+k,k=0;16>k;++k)n(be,je+k*d.R,H,G+32*k,16);for(k=0;8>k;++k)n(Fe,Ae+k*d.B,Y,re+32*k,8),n(ve,ye+k*d.B,ge,Ee+32*k,8)}}function Ac(d,v,k,C,M,V,H,G,Y){var re=[0],ge=[0],Ee=0,Ae=Y!=null?Y.kd:0,be=Y??new hf;if(d==null||12>k)return 7;be.data=d,be.w=v,be.ha=k,v=[v],k=[k],be.gb=[be.gb];e:{var je=v,Fe=k,ve=be.gb;if(t(d!=null),t(Fe!=null),t(ve!=null),ve[0]=0,12<=Fe[0]&&!r(d,je[0],"RIFF")){if(r(d,je[0]+8,"WEBP")){ve=3;break e}var ye=Ve(d,je[0]+4);if(12>ye||4294967286<ye){ve=3;break e}if(Ae&&ye>Fe[0]-8){ve=7;break e}ve[0]=ye,je[0]+=12,Fe[0]-=12}ve=0}if(ve!=0)return ve;for(ye=0<be.gb[0],k=k[0];;){e:{var Ie=d;Fe=v,ve=k;var Be=re,Re=ge,at=je=[0];if((et=Ee=[Ee])[0]=0,8>ve[0])ve=7;else{if(!r(Ie,Fe[0],"VP8X")){if(Ve(Ie,Fe[0]+4)!=10){ve=3;break e}if(18>ve[0]){ve=7;break e}var Qe=Ve(Ie,Fe[0]+8),pt=1+Z(Ie,Fe[0]+12);if(2147483648<=pt*(Ie=1+Z(Ie,Fe[0]+15))){ve=3;break e}at!=null&&(at[0]=Qe),Be!=null&&(Be[0]=pt),Re!=null&&(Re[0]=Ie),Fe[0]+=18,ve[0]-=18,et[0]=1}ve=0}}if(Ee=Ee[0],je=je[0],ve!=0)return ve;if(Fe=!!(2&je),!ye&&Ee)return 3;if(V!=null&&(V[0]=!!(16&je)),H!=null&&(H[0]=Fe),G!=null&&(G[0]=0),H=re[0],je=ge[0],Ee&&Fe&&Y==null){ve=0;break}if(4>k){ve=7;break}if(ye&&Ee||!ye&&!Ee&&!r(d,v[0],"ALPH")){k=[k],be.na=[be.na],be.P=[be.P],be.Sa=[be.Sa];e:{Qe=d,ve=v,ye=k;var et=be.gb;Be=be.na,Re=be.P,at=be.Sa,pt=22,t(Qe!=null),t(ye!=null),Ie=ve[0];var qt=ye[0];for(t(Be!=null),t(at!=null),Be[0]=null,Re[0]=null,at[0]=0;;){if(ve[0]=Ie,ye[0]=qt,8>qt){ve=7;break e}var Qt=Ve(Qe,Ie+4);if(4294967286<Qt){ve=3;break e}var $t=8+Qt+1&-2;if(pt+=$t,0<et&&pt>et){ve=3;break e}if(!r(Qe,Ie,"VP8 ")||!r(Qe,Ie,"VP8L")){ve=0;break e}if(qt[0]<$t){ve=7;break e}r(Qe,Ie,"ALPH")||(Be[0]=Qe,Re[0]=Ie+8,at[0]=Qt),Ie+=$t,qt-=$t}}if(k=k[0],be.na=be.na[0],be.P=be.P[0],be.Sa=be.Sa[0],ve!=0)break}k=[k],be.Ja=[be.Ja],be.xa=[be.xa];e:if(et=d,ve=v,ye=k,Be=be.gb[0],Re=be.Ja,at=be.xa,Qe=ve[0],Ie=!r(et,Qe,"VP8 "),pt=!r(et,Qe,"VP8L"),t(et!=null),t(ye!=null),t(Re!=null),t(at!=null),8>ye[0])ve=7;else{if(Ie||pt){if(et=Ve(et,Qe+4),12<=Be&&et>Be-12){ve=3;break e}if(Ae&&et>ye[0]-8){ve=7;break e}Re[0]=et,ve[0]+=8,ye[0]-=8,at[0]=pt}else at[0]=5<=ye[0]&&et[Qe+0]==47&&!(et[Qe+4]>>5),Re[0]=ye[0];ve=0}if(k=k[0],be.Ja=be.Ja[0],be.xa=be.xa[0],v=v[0],ve!=0)break;if(4294967286<be.Ja)return 3;if(G==null||Fe||(G[0]=be.xa?2:1),H=[H],je=[je],be.xa){if(5>k){ve=7;break}G=H,Ae=je,Fe=V,d==null||5>k?d=0:5<=k&&d[v+0]==47&&!(d[v+4]>>5)?(ye=[0],et=[0],Be=[0],Q(Re=new E,d,v,k),dt(Re,ye,et,Be)?(G!=null&&(G[0]=ye[0]),Ae!=null&&(Ae[0]=et[0]),Fe!=null&&(Fe[0]=Be[0]),d=1):d=0):d=0}else{if(10>k){ve=7;break}G=je,d==null||10>k||!Mh(d,v+3,k-3)?d=0:(Ae=d[v+0]|d[v+1]<<8|d[v+2]<<16,Fe=16383&(d[v+7]<<8|d[v+6]),d=16383&(d[v+9]<<8|d[v+8]),1&Ae||3<(Ae>>1&7)||!(Ae>>4&1)||Ae>>5>=be.Ja||!Fe||!d?d=0:(H&&(H[0]=Fe),G&&(G[0]=d),d=1))}if(!d||(H=H[0],je=je[0],Ee&&(re[0]!=H||ge[0]!=je)))return 3;Y!=null&&(Y[0]=be,Y.offset=v-Y.w,t(4294967286>v-Y.w),t(Y.offset==Y.ha-k));break}return ve==0||ve==7&&Ee&&Y==null?(V!=null&&(V[0]|=be.na!=null&&0<be.na.length),C!=null&&(C[0]=H),M!=null&&(M[0]=je),0):ve}function xf(d,v,k){var C=v.width,M=v.height,V=0,H=0,G=C,Y=M;if(v.Da=d!=null&&0<d.Da,v.Da&&(G=d.cd,Y=d.bd,V=d.v,H=d.j,11>k||(V&=-2,H&=-2),0>V||0>H||0>=G||0>=Y||V+G>C||H+Y>M))return 0;if(v.v=V,v.j=H,v.va=V+G,v.o=H+Y,v.U=G,v.T=Y,v.da=d!=null&&0<d.da,v.da){if(!De(G,Y,k=[d.ib],V=[d.hb]))return 0;v.ib=k[0],v.hb=V[0]}return v.ob=d!=null&&d.ob,v.Kb=d==null||!d.Sd,v.da&&(v.ob=v.ib<3*C/4&&v.hb<3*M/4,v.Kb=0),1}function yf(d){if(d==null)return 2;if(11>d.S){var v=d.f.RGBA;v.fb+=(d.height-1)*v.A,v.A=-v.A}else v=d.f.kb,d=d.height,v.O+=(d-1)*v.fa,v.fa=-v.fa,v.N+=(d-1>>1)*v.Ab,v.Ab=-v.Ab,v.W+=(d-1>>1)*v.Db,v.Db=-v.Db,v.F!=null&&(v.J+=(d-1)*v.lb,v.lb=-v.lb);return 0}function Tc(d,v,k,C){if(C==null||0>=d||0>=v)return 2;if(k!=null){if(k.Da){var M=k.cd,V=k.bd,H=-2&k.v,G=-2&k.j;if(0>H||0>G||0>=M||0>=V||H+M>d||G+V>v)return 2;d=M,v=V}if(k.da){if(!De(d,v,M=[k.ib],V=[k.hb]))return 2;d=M[0],v=V[0]}}C.width=d,C.height=v;e:{var Y=C.width,re=C.height;if(d=C.S,0>=Y||0>=re||!(d>=od&&13>d))d=2;else{if(0>=C.Rd&&C.sd==null){H=V=M=v=0;var ge=(G=Y*X5[d])*re;if(11>d||(V=(re+1)/2*(v=(Y+1)/2),d==12&&(H=(M=Y)*re)),(re=i(ge+2*V+H))==null){d=1;break e}C.sd=re,11>d?((Y=C.f.RGBA).eb=re,Y.fb=0,Y.A=G,Y.size=ge):((Y=C.f.kb).y=re,Y.O=0,Y.fa=G,Y.Fd=ge,Y.f=re,Y.N=0+ge,Y.Ab=v,Y.Cd=V,Y.ea=re,Y.W=0+ge+V,Y.Db=v,Y.Ed=V,d==12&&(Y.F=re,Y.J=0+ge+2*V),Y.Tc=H,Y.lb=M)}if(v=1,M=C.S,V=C.width,H=C.height,M>=od&&13>M)if(11>M)d=C.f.RGBA,v&=(G=Math.abs(d.A))*(H-1)+V<=d.size,v&=G>=V*X5[M],v&=d.eb!=null;else{d=C.f.kb,G=(V+1)/2,ge=(H+1)/2,Y=Math.abs(d.fa),re=Math.abs(d.Ab);var Ee=Math.abs(d.Db),Ae=Math.abs(d.lb),be=Ae*(H-1)+V;v&=Y*(H-1)+V<=d.Fd,v&=re*(ge-1)+G<=d.Cd,v=(v&=Ee*(ge-1)+G<=d.Ed)&Y>=V&re>=G&Ee>=G,v&=d.y!=null,v&=d.f!=null,v&=d.ea!=null,M==12&&(v&=Ae>=V,v&=be<=d.Tc,v&=d.F!=null)}else v=0;d=v?0:2}}return d!=0||k!=null&&k.fd&&(d=yf(C)),d}var xn=64,Cc=[0,1,3,7,15,31,63,127,255,511,1023,2047,4095,8191,16383,32767,65535,131071,262143,524287,1048575,2097151,4194303,8388607,16777215],Nc=24,Pc=32,wf=8,ua=[0,0,1,1,2,2,2,2,3,3,3,3,3,3,3,3,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7];qe("Predictor0","PredictorAdd0"),F.Predictor0=function(){return 4278190080},F.Predictor1=function(d){return d},F.Predictor2=function(d,v,k){return v[k+0]},F.Predictor3=function(d,v,k){return v[k+1]},F.Predictor4=function(d,v,k){return v[k-1]},F.Predictor5=function(d,v,k){return Je(Je(d,v[k+1]),v[k+0])},F.Predictor6=function(d,v,k){return Je(d,v[k-1])},F.Predictor7=function(d,v,k){return Je(d,v[k+0])},F.Predictor8=function(d,v,k){return Je(v[k-1],v[k+0])},F.Predictor9=function(d,v,k){return Je(v[k+0],v[k+1])},F.Predictor10=function(d,v,k){return Je(Je(d,v[k-1]),Je(v[k+0],v[k+1]))},F.Predictor11=function(d,v,k){var C=v[k+0];return 0>=mt(C>>24&255,d>>24&255,(v=v[k-1])>>24&255)+mt(C>>16&255,d>>16&255,v>>16&255)+mt(C>>8&255,d>>8&255,v>>8&255)+mt(255&C,255&d,255&v)?C:d},F.Predictor12=function(d,v,k){var C=v[k+0];return(st((d>>24&255)+(C>>24&255)-((v=v[k-1])>>24&255))<<24|st((d>>16&255)+(C>>16&255)-(v>>16&255))<<16|st((d>>8&255)+(C>>8&255)-(v>>8&255))<<8|st((255&d)+(255&C)-(255&v)))>>>0},F.Predictor13=function(d,v,k){var C=v[k-1];return(lt((d=Je(d,v[k+0]))>>24&255,C>>24&255)<<24|lt(d>>16&255,C>>16&255)<<16|lt(d>>8&255,C>>8&255)<<8|lt(d>>0&255,C>>0&255))>>>0};var Zm=F.PredictorAdd0;F.PredictorAdd1=wt,qe("Predictor2","PredictorAdd2"),qe("Predictor3","PredictorAdd3"),qe("Predictor4","PredictorAdd4"),qe("Predictor5","PredictorAdd5"),qe("Predictor6","PredictorAdd6"),qe("Predictor7","PredictorAdd7"),qe("Predictor8","PredictorAdd8"),qe("Predictor9","PredictorAdd9"),qe("Predictor10","PredictorAdd10"),qe("Predictor11","PredictorAdd11"),qe("Predictor12","PredictorAdd12"),qe("Predictor13","PredictorAdd13");var bf=F.PredictorAdd2;Ze("ColorIndexInverseTransform","MapARGB","32b",function(d){return d>>8&255},function(d){return d}),Ze("VP8LColorIndexInverseTransformAlpha","MapAlpha","8b",function(d){return d},function(d){return d>>8&255});var td,Wa=F.ColorIndexInverseTransform,Lc=F.MapARGB,rd=F.VP8LColorIndexInverseTransformAlpha,nd=F.MapAlpha,oo=F.VP8LPredictorsAdd=[];oo.length=16,(F.VP8LPredictors=[]).length=16,(F.VP8LPredictorsAdd_C=[]).length=16,(F.VP8LPredictors_C=[]).length=16;var vl,fa,Kn,lo,_s,Ss,Fc,ks,Rr,_f,Xn,qa,Oc,ad,Sf,xl,yl,co,wl,Dc,bl,uo,kf,Ga,Ka,cr,ur,jr,tn=i(511),Es=i(2041),Ef=i(225),Ic=i(767),id=0,eg=Es,sd=Ef,Ca=Ic,Xa=tn,od=0,ld=1,j5=2,cd=3,ud=4,tg=5,M5=6,rg=7,ng=8,fd=9,ag=10,JC=[2,3,7],QC=[3,3,11],B5=[280,256,256,256,40],ZC=[0,1,1,1,0],eN=[17,18,0,1,2,3,4,5,16,6,7,8,9,10,11,12,13,14,15],tN=[24,7,23,25,40,6,39,41,22,26,38,42,56,5,55,57,21,27,54,58,37,43,72,4,71,73,20,28,53,59,70,74,36,44,88,69,75,52,60,3,87,89,19,29,86,90,35,45,68,76,85,91,51,61,104,2,103,105,18,30,102,106,34,46,84,92,67,77,101,107,50,62,120,1,119,121,83,93,17,31,100,108,66,78,118,122,33,47,117,123,49,63,99,109,82,94,0,116,124,65,79,16,32,98,110,48,115,125,81,95,64,114,126,97,111,80,113,127,96,112],rN=[2954,2956,2958,2962,2970,2986,3018,3082,3212,3468,3980,5004],nN=8,ig=[4,5,6,7,8,9,10,10,11,12,13,14,15,16,17,17,18,19,20,20,21,21,22,22,23,23,24,25,25,26,27,28,29,30,31,32,33,34,35,36,37,37,38,39,40,41,42,43,44,45,46,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,76,77,78,79,80,81,82,83,84,85,86,87,88,89,91,93,95,96,98,100,101,102,104,106,108,110,112,114,116,118,122,124,126,128,130,132,134,136,138,140,143,145,148,151,154,157],sg=[4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,60,62,64,66,68,70,72,74,76,78,80,82,84,86,88,90,92,94,96,98,100,102,104,106,108,110,112,114,116,119,122,125,128,131,134,137,140,143,146,149,152,155,158,161,164,167,170,173,177,181,185,189,193,197,201,205,209,213,217,221,225,229,234,239,245,249,254,259,264,269,274,279,284],Af=null,aN=[[173,148,140,0],[176,155,140,135,0],[180,157,141,134,130,0],[254,254,243,230,196,177,153,140,133,130,129,0]],iN=[0,1,4,8,5,2,3,6,9,12,13,10,7,11,14,15],U5=[-0,1,-1,2,-2,3,4,6,-3,5,-4,-5,-6,7,-7,8,-8,-9],sN=[[[[128,128,128,128,128,128,128,128,128,128,128],[128,128,128,128,128,128,128,128,128,128,128],[128,128,128,128,128,128,128,128,128,128,128]],[[253,136,254,255,228,219,128,128,128,128,128],[189,129,242,255,227,213,255,219,128,128,128],[106,126,227,252,214,209,255,255,128,128,128]],[[1,98,248,255,236,226,255,255,128,128,128],[181,133,238,254,221,234,255,154,128,128,128],[78,134,202,247,198,180,255,219,128,128,128]],[[1,185,249,255,243,255,128,128,128,128,128],[184,150,247,255,236,224,128,128,128,128,128],[77,110,216,255,236,230,128,128,128,128,128]],[[1,101,251,255,241,255,128,128,128,128,128],[170,139,241,252,236,209,255,255,128,128,128],[37,116,196,243,228,255,255,255,128,128,128]],[[1,204,254,255,245,255,128,128,128,128,128],[207,160,250,255,238,128,128,128,128,128,128],[102,103,231,255,211,171,128,128,128,128,128]],[[1,152,252,255,240,255,128,128,128,128,128],[177,135,243,255,234,225,128,128,128,128,128],[80,129,211,255,194,224,128,128,128,128,128]],[[1,1,255,128,128,128,128,128,128,128,128],[246,1,255,128,128,128,128,128,128,128,128],[255,128,128,128,128,128,128,128,128,128,128]]],[[[198,35,237,223,193,187,162,160,145,155,62],[131,45,198,221,172,176,220,157,252,221,1],[68,47,146,208,149,167,221,162,255,223,128]],[[1,149,241,255,221,224,255,255,128,128,128],[184,141,234,253,222,220,255,199,128,128,128],[81,99,181,242,176,190,249,202,255,255,128]],[[1,129,232,253,214,197,242,196,255,255,128],[99,121,210,250,201,198,255,202,128,128,128],[23,91,163,242,170,187,247,210,255,255,128]],[[1,200,246,255,234,255,128,128,128,128,128],[109,178,241,255,231,245,255,255,128,128,128],[44,130,201,253,205,192,255,255,128,128,128]],[[1,132,239,251,219,209,255,165,128,128,128],[94,136,225,251,218,190,255,255,128,128,128],[22,100,174,245,186,161,255,199,128,128,128]],[[1,182,249,255,232,235,128,128,128,128,128],[124,143,241,255,227,234,128,128,128,128,128],[35,77,181,251,193,211,255,205,128,128,128]],[[1,157,247,255,236,231,255,255,128,128,128],[121,141,235,255,225,227,255,255,128,128,128],[45,99,188,251,195,217,255,224,128,128,128]],[[1,1,251,255,213,255,128,128,128,128,128],[203,1,248,255,255,128,128,128,128,128,128],[137,1,177,255,224,255,128,128,128,128,128]]],[[[253,9,248,251,207,208,255,192,128,128,128],[175,13,224,243,193,185,249,198,255,255,128],[73,17,171,221,161,179,236,167,255,234,128]],[[1,95,247,253,212,183,255,255,128,128,128],[239,90,244,250,211,209,255,255,128,128,128],[155,77,195,248,188,195,255,255,128,128,128]],[[1,24,239,251,218,219,255,205,128,128,128],[201,51,219,255,196,186,128,128,128,128,128],[69,46,190,239,201,218,255,228,128,128,128]],[[1,191,251,255,255,128,128,128,128,128,128],[223,165,249,255,213,255,128,128,128,128,128],[141,124,248,255,255,128,128,128,128,128,128]],[[1,16,248,255,255,128,128,128,128,128,128],[190,36,230,255,236,255,128,128,128,128,128],[149,1,255,128,128,128,128,128,128,128,128]],[[1,226,255,128,128,128,128,128,128,128,128],[247,192,255,128,128,128,128,128,128,128,128],[240,128,255,128,128,128,128,128,128,128,128]],[[1,134,252,255,255,128,128,128,128,128,128],[213,62,250,255,255,128,128,128,128,128,128],[55,93,255,128,128,128,128,128,128,128,128]],[[128,128,128,128,128,128,128,128,128,128,128],[128,128,128,128,128,128,128,128,128,128,128],[128,128,128,128,128,128,128,128,128,128,128]]],[[[202,24,213,235,186,191,220,160,240,175,255],[126,38,182,232,169,184,228,174,255,187,128],[61,46,138,219,151,178,240,170,255,216,128]],[[1,112,230,250,199,191,247,159,255,255,128],[166,109,228,252,211,215,255,174,128,128,128],[39,77,162,232,172,180,245,178,255,255,128]],[[1,52,220,246,198,199,249,220,255,255,128],[124,74,191,243,183,193,250,221,255,255,128],[24,71,130,219,154,170,243,182,255,255,128]],[[1,182,225,249,219,240,255,224,128,128,128],[149,150,226,252,216,205,255,171,128,128,128],[28,108,170,242,183,194,254,223,255,255,128]],[[1,81,230,252,204,203,255,192,128,128,128],[123,102,209,247,188,196,255,233,128,128,128],[20,95,153,243,164,173,255,203,128,128,128]],[[1,222,248,255,216,213,128,128,128,128,128],[168,175,246,252,235,205,255,255,128,128,128],[47,116,215,255,211,212,255,255,128,128,128]],[[1,121,236,253,212,214,255,255,128,128,128],[141,84,213,252,201,202,255,219,128,128,128],[42,80,160,240,162,185,255,205,128,128,128]],[[1,1,255,128,128,128,128,128,128,128,128],[244,1,255,128,128,128,128,128,128,128,128],[238,1,255,128,128,128,128,128,128,128,128]]]],oN=[[[231,120,48,89,115,113,120,152,112],[152,179,64,126,170,118,46,70,95],[175,69,143,80,85,82,72,155,103],[56,58,10,171,218,189,17,13,152],[114,26,17,163,44,195,21,10,173],[121,24,80,195,26,62,44,64,85],[144,71,10,38,171,213,144,34,26],[170,46,55,19,136,160,33,206,71],[63,20,8,114,114,208,12,9,226],[81,40,11,96,182,84,29,16,36]],[[134,183,89,137,98,101,106,165,148],[72,187,100,130,157,111,32,75,80],[66,102,167,99,74,62,40,234,128],[41,53,9,178,241,141,26,8,107],[74,43,26,146,73,166,49,23,157],[65,38,105,160,51,52,31,115,128],[104,79,12,27,217,255,87,17,7],[87,68,71,44,114,51,15,186,23],[47,41,14,110,182,183,21,17,194],[66,45,25,102,197,189,23,18,22]],[[88,88,147,150,42,46,45,196,205],[43,97,183,117,85,38,35,179,61],[39,53,200,87,26,21,43,232,171],[56,34,51,104,114,102,29,93,77],[39,28,85,171,58,165,90,98,64],[34,22,116,206,23,34,43,166,73],[107,54,32,26,51,1,81,43,31],[68,25,106,22,64,171,36,225,114],[34,19,21,102,132,188,16,76,124],[62,18,78,95,85,57,50,48,51]],[[193,101,35,159,215,111,89,46,111],[60,148,31,172,219,228,21,18,111],[112,113,77,85,179,255,38,120,114],[40,42,1,196,245,209,10,25,109],[88,43,29,140,166,213,37,43,154],[61,63,30,155,67,45,68,1,209],[100,80,8,43,154,1,51,26,71],[142,78,78,16,255,128,34,197,171],[41,40,5,102,211,183,4,1,221],[51,50,17,168,209,192,23,25,82]],[[138,31,36,171,27,166,38,44,229],[67,87,58,169,82,115,26,59,179],[63,59,90,180,59,166,93,73,154],[40,40,21,116,143,209,34,39,175],[47,15,16,183,34,223,49,45,183],[46,17,33,183,6,98,15,32,183],[57,46,22,24,128,1,54,17,37],[65,32,73,115,28,128,23,128,205],[40,3,9,115,51,192,18,6,223],[87,37,9,115,59,77,64,21,47]],[[104,55,44,218,9,54,53,130,226],[64,90,70,205,40,41,23,26,57],[54,57,112,184,5,41,38,166,213],[30,34,26,133,152,116,10,32,134],[39,19,53,221,26,114,32,73,255],[31,9,65,234,2,15,1,118,73],[75,32,12,51,192,255,160,43,51],[88,31,35,67,102,85,55,186,85],[56,21,23,111,59,205,45,37,192],[55,38,70,124,73,102,1,34,98]],[[125,98,42,88,104,85,117,175,82],[95,84,53,89,128,100,113,101,45],[75,79,123,47,51,128,81,171,1],[57,17,5,71,102,57,53,41,49],[38,33,13,121,57,73,26,1,85],[41,10,67,138,77,110,90,47,114],[115,21,2,10,102,255,166,23,6],[101,29,16,10,85,128,101,196,26],[57,18,10,102,102,213,34,20,43],[117,20,15,36,163,128,68,1,26]],[[102,61,71,37,34,53,31,243,192],[69,60,71,38,73,119,28,222,37],[68,45,128,34,1,47,11,245,171],[62,17,19,70,146,85,55,62,70],[37,43,37,154,100,163,85,160,1],[63,9,92,136,28,64,32,201,85],[75,15,9,9,64,255,184,119,16],[86,6,28,5,64,255,25,248,1],[56,8,17,132,137,255,55,116,128],[58,15,20,82,135,57,26,121,40]],[[164,50,31,137,154,133,25,35,218],[51,103,44,131,131,123,31,6,158],[86,40,64,135,148,224,45,183,128],[22,26,17,131,240,154,14,1,209],[45,16,21,91,64,222,7,1,197],[56,21,39,155,60,138,23,102,213],[83,12,13,54,192,255,68,47,28],[85,26,85,85,128,128,32,146,171],[18,11,7,63,144,171,4,4,246],[35,27,10,146,174,171,12,26,128]],[[190,80,35,99,180,80,126,54,45],[85,126,47,87,176,51,41,20,32],[101,75,128,139,118,146,116,128,85],[56,41,15,176,236,85,37,9,62],[71,30,17,119,118,255,17,18,138],[101,38,60,138,55,70,43,26,142],[146,36,19,30,171,255,97,27,20],[138,45,61,62,219,1,81,188,64],[32,41,20,117,151,142,20,21,163],[112,19,12,61,195,128,48,4,24]]],lN=[[[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[176,246,255,255,255,255,255,255,255,255,255],[223,241,252,255,255,255,255,255,255,255,255],[249,253,253,255,255,255,255,255,255,255,255]],[[255,244,252,255,255,255,255,255,255,255,255],[234,254,254,255,255,255,255,255,255,255,255],[253,255,255,255,255,255,255,255,255,255,255]],[[255,246,254,255,255,255,255,255,255,255,255],[239,253,254,255,255,255,255,255,255,255,255],[254,255,254,255,255,255,255,255,255,255,255]],[[255,248,254,255,255,255,255,255,255,255,255],[251,255,254,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,253,254,255,255,255,255,255,255,255,255],[251,254,254,255,255,255,255,255,255,255,255],[254,255,254,255,255,255,255,255,255,255,255]],[[255,254,253,255,254,255,255,255,255,255,255],[250,255,254,255,254,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]]],[[[217,255,255,255,255,255,255,255,255,255,255],[225,252,241,253,255,255,254,255,255,255,255],[234,250,241,250,253,255,253,254,255,255,255]],[[255,254,255,255,255,255,255,255,255,255,255],[223,254,254,255,255,255,255,255,255,255,255],[238,253,254,254,255,255,255,255,255,255,255]],[[255,248,254,255,255,255,255,255,255,255,255],[249,254,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,253,255,255,255,255,255,255,255,255,255],[247,254,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,253,254,255,255,255,255,255,255,255,255],[252,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,254,254,255,255,255,255,255,255,255,255],[253,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,254,253,255,255,255,255,255,255,255,255],[250,255,255,255,255,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]]],[[[186,251,250,255,255,255,255,255,255,255,255],[234,251,244,254,255,255,255,255,255,255,255],[251,251,243,253,254,255,254,255,255,255,255]],[[255,253,254,255,255,255,255,255,255,255,255],[236,253,254,255,255,255,255,255,255,255,255],[251,253,253,254,254,255,255,255,255,255,255]],[[255,254,254,255,255,255,255,255,255,255,255],[254,254,254,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,254,255,255,255,255,255,255,255,255,255],[254,254,255,255,255,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]]],[[[248,255,255,255,255,255,255,255,255,255,255],[250,254,252,254,255,255,255,255,255,255,255],[248,254,249,253,255,255,255,255,255,255,255]],[[255,253,253,255,255,255,255,255,255,255,255],[246,253,253,255,255,255,255,255,255,255,255],[252,254,251,254,254,255,255,255,255,255,255]],[[255,254,252,255,255,255,255,255,255,255,255],[248,254,253,255,255,255,255,255,255,255,255],[253,255,254,254,255,255,255,255,255,255,255]],[[255,251,254,255,255,255,255,255,255,255,255],[245,251,254,255,255,255,255,255,255,255,255],[253,253,254,255,255,255,255,255,255,255,255]],[[255,251,253,255,255,255,255,255,255,255,255],[252,253,254,255,255,255,255,255,255,255,255],[255,254,255,255,255,255,255,255,255,255,255]],[[255,252,255,255,255,255,255,255,255,255,255],[249,255,254,255,255,255,255,255,255,255,255],[255,255,254,255,255,255,255,255,255,255,255]],[[255,255,253,255,255,255,255,255,255,255,255],[250,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]]]],cN=[0,1,2,3,6,4,5,6,6,6,6,6,6,6,6,7,0],fo=[],yi=[],As=[],uN=1,V5=2,ho=[],Ya=[];Oe("UpsampleRgbLinePair",Mt,3),Oe("UpsampleBgrLinePair",_r,3),Oe("UpsampleRgbaLinePair",xi,4),Oe("UpsampleBgraLinePair",cn,4),Oe("UpsampleArgbLinePair",Cn,4),Oe("UpsampleRgba4444LinePair",Wr,2),Oe("UpsampleRgb565LinePair",Cr,2);var fN=F.UpsampleRgbLinePair,hN=F.UpsampleBgrLinePair,$5=F.UpsampleRgbaLinePair,z5=F.UpsampleBgraLinePair,H5=F.UpsampleArgbLinePair,W5=F.UpsampleRgba4444LinePair,dN=F.UpsampleRgb565LinePair,hd=16,dd=1<<hd-1,Tf=-227,og=482,q5=6,pN=(256<<q5)-1,G5=0,mN=i(256),gN=i(256),vN=i(256),xN=i(256),yN=i(og-Tf),wN=i(og-Tf);Ji("YuvToRgbRow",Mt,3),Ji("YuvToBgrRow",_r,3),Ji("YuvToRgbaRow",xi,4),Ji("YuvToBgraRow",cn,4),Ji("YuvToArgbRow",Cn,4),Ji("YuvToRgba4444Row",Wr,2),Ji("YuvToRgb565Row",Cr,2);var K5=[0,4,8,12,128,132,136,140,256,260,264,268,384,388,392,396],pd=[0,2,8],bN=[8,7,6,4,4,2,2,2,1,1,1,1],_N=1;this.WebPDecodeRGBA=function(d,v,k,C,M){var V=ld,H=new kc,G=new ka;H.ba=G,G.S=V,G.width=[G.width],G.height=[G.height];var Y=G.width,re=G.height,ge=new di;if(ge==null||d==null)var Ee=2;else t(ge!=null),Ee=Ac(d,v,k,ge.width,ge.height,ge.Pd,ge.Qd,ge.format,null);if(Ee!=0?Y=0:(Y!=null&&(Y[0]=ge.width[0]),re!=null&&(re[0]=ge.height[0]),Y=1),Y){G.width=G.width[0],G.height=G.height[0],C!=null&&(C[0]=G.width),M!=null&&(M[0]=G.height);e:{if(C=new Ki,(M=new hf).data=d,M.w=v,M.ha=k,M.kd=1,v=[0],t(M!=null),((d=Ac(M.data,M.w,M.ha,null,null,null,v,null,M))==0||d==7)&&v[0]&&(d=4),(v=d)==0){if(t(H!=null),C.data=M.data,C.w=M.w+M.offset,C.ha=M.ha-M.offset,C.put=za,C.ac=en,C.bc=Ha,C.ma=H,M.xa){if((d=Le())==null){H=1;break e}if(function(Ae,be){var je=[0],Fe=[0],ve=[0];t:for(;;){if(Ae==null)return 0;if(be==null)return Ae.a=2,0;if(Ae.l=be,Ae.a=0,Q(Ae.m,be.data,be.w,be.ha),!dt(Ae.m,je,Fe,ve)){Ae.a=3;break t}if(Ae.xb=V5,be.width=je[0],be.height=Fe[0],!Se(je[0],Fe[0],1,Ae,null))break t;return 1}return t(Ae.a!=0),0}(d,C)){if(C=(v=Tc(C.width,C.height,H.Oa,H.ba))==0){t:{C=d;r:for(;;){if(C==null){C=0;break t}if(t(C.s.yc!=null),t(C.s.Ya!=null),t(0<C.s.Wb),t((k=C.l)!=null),t((M=k.ma)!=null),C.xb!=0){if(C.ca=M.ba,C.tb=M.tb,t(C.ca!=null),!xf(M.Oa,k,cd)){C.a=2;break r}if(!Te(C,k.width)||k.da)break r;if((k.da||Vt(C.ca.S))&&_e(),11>C.ca.S||(alert("todo:WebPInitConvertARGBToYUV"),C.ca.f.kb.F!=null&&_e()),C.Pb&&0<C.s.ua&&C.s.vb.X==null&&!Ke(C.s.vb,C.s.Wa.Xa)){C.a=1;break r}C.xb=0}if(!ce(C,C.V,C.Ba,C.c,C.i,k.o,le))break r;M.Dc=C.Ma,C=1;break t}t(C.a!=0),C=0}C=!C}C&&(v=d.a)}else v=d.a}else{if((d=new Aa)==null){H=1;break e}if(d.Fa=M.na,d.P=M.P,d.qc=M.Sa,Bh(d,C)){if((v=Tc(C.width,C.height,H.Oa,H.ba))==0){if(d.Aa=0,k=H.Oa,t((M=d)!=null),k!=null){if(0<(Y=0>(Y=k.Md)?0:100<Y?255:255*Y/100)){for(re=ge=0;4>re;++re)12>(Ee=M.pb[re]).lc&&(Ee.ia=Y*bN[0>Ee.lc?0:Ee.lc]>>3),ge|=Ee.ia;ge&&(alert("todo:VP8InitRandom"),M.ia=1)}M.Ga=k.Id,100<M.Ga?M.Ga=100:0>M.Ga&&(M.Ga=0)}Im(d,C)||(v=d.a)}}else v=d.a}v==0&&H.Oa!=null&&H.Oa.fd&&(v=yf(H.ba))}H=v}V=H!=0?null:11>V?G.f.RGBA.eb:G.f.kb.y}else V=null;return V};var X5=[3,4,3,4,4,2,2,4,4,4,2,1,1]};function c(F,R){for(var X="",N=0;N<4;N++)X+=String.fromCharCode(F[R++]);return X}function u(F,R){return(F[R+0]<<0|F[R+1]<<8|F[R+2]<<16)>>>0}function f(F,R){return(F[R+0]<<0|F[R+1]<<8|F[R+2]<<16|F[R+3]<<24)>>>0}new l;var p=[0],h=[0],g=[],m=new l,b=e,x=function(F,R){var X={},N=0,P=!1,J=0,W=0;if(X.frames=[],!function(I,O,j,K){for(var ne=0;ne<K;ne++)if(I[O+ne]!=j.charCodeAt(ne))return!0;return!1}(F,R,"RIFF",4)){for(f(F,R+=4),R+=8;R<F.length;){var se=c(F,R),fe=f(F,R+=4);R+=4;var U=fe+(1&fe);switch(se){case"VP8 ":case"VP8L":X.frames[N]===void 0&&(X.frames[N]={}),(he=X.frames[N]).src_off=P?W:R-8,he.src_size=J+fe+8,N++,P&&(P=!1,J=0,W=0);break;case"VP8X":(he=X.header={}).feature_flags=F[R];var Q=R+4;he.canvas_width=1+u(F,Q),Q+=3,he.canvas_height=1+u(F,Q),Q+=3;break;case"ALPH":P=!0,J=U+8,W=R-8;break;case"ANIM":(he=X.header).bgcolor=f(F,R),Q=R+4,he.loop_count=(xe=F)[(E=Q)+0]<<0|xe[E+1]<<8,Q+=2;break;case"ANMF":var q,he;(he=X.frames[N]={}).offset_x=2*u(F,R),R+=3,he.offset_y=2*u(F,R),R+=3,he.width=1+u(F,R),R+=3,he.height=1+u(F,R),R+=3,he.duration=u(F,R),R+=3,q=F[R++],he.dispose=1&q,he.blend=q>>1&1}se!="ANMF"&&(R+=U)}var xe,E;return X}}(b,0);x.response=b,x.rgbaoutput=!0,x.dataurl=!1;var w=x.header?x.header:null,y=x.frames?x.frames:null;if(w){w.loop_counter=w.loop_count,p=[w.canvas_height],h=[w.canvas_width];for(var A=0;A<y.length&&y[A].blend!=0;A++);}var L=y[0],D=m.WebPDecodeRGBA(b,L.src_off,L.src_size,h,p);L.rgba=D,L.imgwidth=h[0],L.imgheight=p[0];for(var T=0;T<h[0]*p[0]*4;T++)g[T]=D[T];return this.width=h,this.height=p,this.data=g,this}(function(e){var t=function(){return typeof yx=="function"},r=function(p,h,g,m){var b=4,x=s;switch(m){case e.image_compression.FAST:b=1,x=i;break;case e.image_compression.MEDIUM:b=6,x=o;break;case e.image_compression.SLOW:b=9,x=l}p=n(p,h,g,x);var w=yx(p,{level:b});return e.__addimage__.arrayBufferToBinaryString(w)},n=function(p,h,g,m){for(var b,x,w,y=p.length/h,A=new Uint8Array(p.length+y),L=u(),D=0;D<y;D+=1){if(w=D*h,b=p.subarray(w,w+h),m)A.set(m(b,g,x),w+D);else{for(var T,F=L.length,R=[];T<F;T+=1)R[T]=L[T](b,g,x);var X=f(R.concat());A.set(R[X],w+D)}x=b}return A},a=function(p){var h=Array.apply([],p);return h.unshift(0),h},i=function(p,h){var g,m=[],b=p.length;m[0]=1;for(var x=0;x<b;x+=1)g=p[x-h]||0,m[x+1]=p[x]-g+256&255;return m},s=function(p,h,g){var m,b=[],x=p.length;b[0]=2;for(var w=0;w<x;w+=1)m=g&&g[w]||0,b[w+1]=p[w]-m+256&255;return b},o=function(p,h,g){var m,b,x=[],w=p.length;x[0]=3;for(var y=0;y<w;y+=1)m=p[y-h]||0,b=g&&g[y]||0,x[y+1]=p[y]+256-(m+b>>>1)&255;return x},l=function(p,h,g){var m,b,x,w,y=[],A=p.length;y[0]=4;for(var L=0;L<A;L+=1)m=p[L-h]||0,b=g&&g[L]||0,x=g&&g[L-h]||0,w=c(m,b,x),y[L+1]=p[L]-w+256&255;return y},c=function(p,h,g){if(p===h&&h===g)return p;var m=Math.abs(h-g),b=Math.abs(p-g),x=Math.abs(p+h-g-g);return m<=b&&m<=x?p:b<=x?h:g},u=function(){return[a,i,s,o,l]},f=function(p){var h=p.map(function(g){return g.reduce(function(m,b){return m+Math.abs(b)},0)});return h.indexOf(Math.min.apply(null,h))};e.processPNG=function(p,h,g,m){var b,x,w,y,A,L,D,T,F,R,X,N,P,J,W,se=this.decode.FLATE_DECODE,fe="";if(this.__addimage__.isArrayBuffer(p)&&(p=new Uint8Array(p)),this.__addimage__.isArrayBufferView(p)){if(p=(w=new OX(p)).imgData,x=w.bits,b=w.colorSpace,A=w.colors,[4,6].indexOf(w.colorType)!==-1){if(w.bits===8){F=(T=w.pixelBitlength==32?new Uint32Array(w.decodePixels().buffer):w.pixelBitlength==16?new Uint16Array(w.decodePixels().buffer):new Uint8Array(w.decodePixels().buffer)).length,X=new Uint8Array(F*w.colors),R=new Uint8Array(F);var U,Q=w.pixelBitlength-w.bits;for(J=0,W=0;J<F;J++){for(P=T[J],U=0;U<Q;)X[W++]=P>>>U&255,U+=w.bits;R[J]=P>>>U&255}}if(w.bits===16){F=(T=new Uint32Array(w.decodePixels().buffer)).length,X=new Uint8Array(F*(32/w.pixelBitlength)*w.colors),R=new Uint8Array(F*(32/w.pixelBitlength)),N=w.colors>1,J=0,W=0;for(var q=0;J<F;)P=T[J++],X[W++]=P>>>0&255,N&&(X[W++]=P>>>16&255,P=T[J++],X[W++]=P>>>0&255),R[q++]=P>>>16&255;x=8}m!==e.image_compression.NONE&&t()?(p=r(X,w.width*w.colors,w.colors,m),D=r(R,w.width,1,m)):(p=X,D=R,se=void 0)}if(w.colorType===3&&(b=this.color_spaces.INDEXED,L=w.palette,w.transparency.indexed)){var he=w.transparency.indexed,xe=0;for(J=0,F=he.length;J<F;++J)xe+=he[J];if((xe/=255)===F-1&&he.indexOf(0)!==-1)y=[he.indexOf(0)];else if(xe!==F){for(T=w.decodePixels(),R=new Uint8Array(T.length),J=0,F=T.length;J<F;J++)R[J]=he[T[J]];D=r(R,w.width,1)}}var E=function(I){var O;switch(I){case e.image_compression.FAST:O=11;break;case e.image_compression.MEDIUM:O=13;break;case e.image_compression.SLOW:O=14;break;default:O=12}return O}(m);return se===this.decode.FLATE_DECODE&&(fe="/Predictor "+E+" "),fe+="/Colors "+A+" /BitsPerComponent "+x+" /Columns "+w.width,(this.__addimage__.isArrayBuffer(p)||this.__addimage__.isArrayBufferView(p))&&(p=this.__addimage__.arrayBufferToBinaryString(p)),(D&&this.__addimage__.isArrayBuffer(D)||this.__addimage__.isArrayBufferView(D))&&(D=this.__addimage__.arrayBufferToBinaryString(D)),{alias:g,data:p,index:h,filter:se,decodeParameters:fe,transparency:y,palette:L,sMask:D,predictor:E,width:w.width,height:w.height,bitsPerComponent:x,colorSpace:b}}}})(vt.API),function(e){e.processGIF89A=function(t,r,n,a){var i=new DX(t),s=i.width,o=i.height,l=[];i.decodeAndBlitFrameRGBA(0,l);var c={data:l,width:s,height:o},u=new P2(100).encode(c,100);return e.processJPEG.call(this,u,r,n,a)},e.processGIF87A=e.processGIF89A}(vt.API),Ei.prototype.parseHeader=function(){if(this.fileSize=this.datav.getUint32(this.pos,!0),this.pos+=4,this.reserved=this.datav.getUint32(this.pos,!0),this.pos+=4,this.offset=this.datav.getUint32(this.pos,!0),this.pos+=4,this.headerSize=this.datav.getUint32(this.pos,!0),this.pos+=4,this.width=this.datav.getUint32(this.pos,!0),this.pos+=4,this.height=this.datav.getInt32(this.pos,!0),this.pos+=4,this.planes=this.datav.getUint16(this.pos,!0),this.pos+=2,this.bitPP=this.datav.getUint16(this.pos,!0),this.pos+=2,this.compress=this.datav.getUint32(this.pos,!0),this.pos+=4,this.rawSize=this.datav.getUint32(this.pos,!0),this.pos+=4,this.hr=this.datav.getUint32(this.pos,!0),this.pos+=4,this.vr=this.datav.getUint32(this.pos,!0),this.pos+=4,this.colors=this.datav.getUint32(this.pos,!0),this.pos+=4,this.importantColors=this.datav.getUint32(this.pos,!0),this.pos+=4,this.bitPP===16&&this.is_with_alpha&&(this.bitPP=15),this.bitPP<15){var e=this.colors===0?1<<this.bitPP:this.colors;this.palette=new Array(e);for(var t=0;t<e;t++){var r=this.datav.getUint8(this.pos++,!0),n=this.datav.getUint8(this.pos++,!0),a=this.datav.getUint8(this.pos++,!0),i=this.datav.getUint8(this.pos++,!0);this.palette[t]={red:a,green:n,blue:r,quad:i}}}this.height<0&&(this.height*=-1,this.bottom_up=!1)},Ei.prototype.parseBGR=function(){this.pos=this.offset;try{var e="bit"+this.bitPP,t=this.width*this.height*4;this.data=new Uint8Array(t),this[e]()}catch(r){or.log("bit decode error:"+r)}},Ei.prototype.bit1=function(){var e,t=Math.ceil(this.width/8),r=t%4;for(e=this.height-1;e>=0;e--){for(var n=this.bottom_up?e:this.height-1-e,a=0;a<t;a++)for(var i=this.datav.getUint8(this.pos++,!0),s=n*this.width*4+8*a*4,o=0;o<8&&8*a+o<this.width;o++){var l=this.palette[i>>7-o&1];this.data[s+4*o]=l.blue,this.data[s+4*o+1]=l.green,this.data[s+4*o+2]=l.red,this.data[s+4*o+3]=255}r!==0&&(this.pos+=4-r)}},Ei.prototype.bit4=function(){for(var e=Math.ceil(this.width/2),t=e%4,r=this.height-1;r>=0;r--){for(var n=this.bottom_up?r:this.height-1-r,a=0;a<e;a++){var i=this.datav.getUint8(this.pos++,!0),s=n*this.width*4+2*a*4,o=i>>4,l=15&i,c=this.palette[o];if(this.data[s]=c.blue,this.data[s+1]=c.green,this.data[s+2]=c.red,this.data[s+3]=255,2*a+1>=this.width)break;c=this.palette[l],this.data[s+4]=c.blue,this.data[s+4+1]=c.green,this.data[s+4+2]=c.red,this.data[s+4+3]=255}t!==0&&(this.pos+=4-t)}},Ei.prototype.bit8=function(){for(var e=this.width%4,t=this.height-1;t>=0;t--){for(var r=this.bottom_up?t:this.height-1-t,n=0;n<this.width;n++){var a=this.datav.getUint8(this.pos++,!0),i=r*this.width*4+4*n;if(a<this.palette.length){var s=this.palette[a];this.data[i]=s.red,this.data[i+1]=s.green,this.data[i+2]=s.blue,this.data[i+3]=255}else this.data[i]=255,this.data[i+1]=255,this.data[i+2]=255,this.data[i+3]=255}e!==0&&(this.pos+=4-e)}},Ei.prototype.bit15=function(){for(var e=this.width%3,t=parseInt("11111",2),r=this.height-1;r>=0;r--){for(var n=this.bottom_up?r:this.height-1-r,a=0;a<this.width;a++){var i=this.datav.getUint16(this.pos,!0);this.pos+=2;var s=(i&t)/t*255|0,o=(i>>5&t)/t*255|0,l=(i>>10&t)/t*255|0,c=i>>15?255:0,u=n*this.width*4+4*a;this.data[u]=l,this.data[u+1]=o,this.data[u+2]=s,this.data[u+3]=c}this.pos+=e}},Ei.prototype.bit16=function(){for(var e=this.width%3,t=parseInt("11111",2),r=parseInt("111111",2),n=this.height-1;n>=0;n--){for(var a=this.bottom_up?n:this.height-1-n,i=0;i<this.width;i++){var s=this.datav.getUint16(this.pos,!0);this.pos+=2;var o=(s&t)/t*255|0,l=(s>>5&r)/r*255|0,c=(s>>11)/t*255|0,u=a*this.width*4+4*i;this.data[u]=c,this.data[u+1]=l,this.data[u+2]=o,this.data[u+3]=255}this.pos+=e}},Ei.prototype.bit24=function(){for(var e=this.height-1;e>=0;e--){for(var t=this.bottom_up?e:this.height-1-e,r=0;r<this.width;r++){var n=this.datav.getUint8(this.pos++,!0),a=this.datav.getUint8(this.pos++,!0),i=this.datav.getUint8(this.pos++,!0),s=t*this.width*4+4*r;this.data[s]=i,this.data[s+1]=a,this.data[s+2]=n,this.data[s+3]=255}this.pos+=this.width%4}},Ei.prototype.bit32=function(){for(var e=this.height-1;e>=0;e--)for(var t=this.bottom_up?e:this.height-1-e,r=0;r<this.width;r++){var n=this.datav.getUint8(this.pos++,!0),a=this.datav.getUint8(this.pos++,!0),i=this.datav.getUint8(this.pos++,!0),s=this.datav.getUint8(this.pos++,!0),o=t*this.width*4+4*r;this.data[o]=i,this.data[o+1]=a,this.data[o+2]=n,this.data[o+3]=s}},Ei.prototype.getData=function(){return this.data},function(e){e.processBMP=function(t,r,n,a){var i=new Ei(t,!1),s=i.width,o=i.height,l={data:i.getData(),width:s,height:o},c=new P2(100).encode(l,100);return e.processJPEG.call(this,c,r,n,a)}}(vt.API),C_.prototype.getData=function(){return this.data},function(e){e.processWEBP=function(t,r,n,a){var i=new C_(t),s=i.width,o=i.height,l={data:i.getData(),width:s,height:o},c=new P2(100).encode(l,100);return e.processJPEG.call(this,c,r,n,a)}}(vt.API),vt.API.processRGBA=function(e,t,r){for(var n=e.data,a=n.length,i=new Uint8Array(a/4*3),s=new Uint8Array(a/4),o=0,l=0,c=0;c<a;c+=4){var u=n[c],f=n[c+1],p=n[c+2],h=n[c+3];i[o++]=u,i[o++]=f,i[o++]=p,s[l++]=h}var g=this.__addimage__.arrayBufferToBinaryString(i);return{alpha:this.__addimage__.arrayBufferToBinaryString(s),data:g,index:t,alias:r,colorSpace:"DeviceRGB",bitsPerComponent:8,width:e.width,height:e.height}},vt.API.setLanguage=function(e){return this.internal.languageSettings===void 0&&(this.internal.languageSettings={},this.internal.languageSettings.isSubscribed=!1),{af:"Afrikaans",sq:"Albanian",ar:"Arabic (Standard)","ar-DZ":"Arabic (Algeria)","ar-BH":"Arabic (Bahrain)","ar-EG":"Arabic (Egypt)","ar-IQ":"Arabic (Iraq)","ar-JO":"Arabic (Jordan)","ar-KW":"Arabic (Kuwait)","ar-LB":"Arabic (Lebanon)","ar-LY":"Arabic (Libya)","ar-MA":"Arabic (Morocco)","ar-OM":"Arabic (Oman)","ar-QA":"Arabic (Qatar)","ar-SA":"Arabic (Saudi Arabia)","ar-SY":"Arabic (Syria)","ar-TN":"Arabic (Tunisia)","ar-AE":"Arabic (U.A.E.)","ar-YE":"Arabic (Yemen)",an:"Aragonese",hy:"Armenian",as:"Assamese",ast:"Asturian",az:"Azerbaijani",eu:"Basque",be:"Belarusian",bn:"Bengali",bs:"Bosnian",br:"Breton",bg:"Bulgarian",my:"Burmese",ca:"Catalan",ch:"Chamorro",ce:"Chechen",zh:"Chinese","zh-HK":"Chinese (Hong Kong)","zh-CN":"Chinese (PRC)","zh-SG":"Chinese (Singapore)","zh-TW":"Chinese (Taiwan)",cv:"Chuvash",co:"Corsican",cr:"Cree",hr:"Croatian",cs:"Czech",da:"Danish",nl:"Dutch (Standard)","nl-BE":"Dutch (Belgian)",en:"English","en-AU":"English (Australia)","en-BZ":"English (Belize)","en-CA":"English (Canada)","en-IE":"English (Ireland)","en-JM":"English (Jamaica)","en-NZ":"English (New Zealand)","en-PH":"English (Philippines)","en-ZA":"English (South Africa)","en-TT":"English (Trinidad & Tobago)","en-GB":"English (United Kingdom)","en-US":"English (United States)","en-ZW":"English (Zimbabwe)",eo:"Esperanto",et:"Estonian",fo:"Faeroese",fj:"Fijian",fi:"Finnish",fr:"French (Standard)","fr-BE":"French (Belgium)","fr-CA":"French (Canada)","fr-FR":"French (France)","fr-LU":"French (Luxembourg)","fr-MC":"French (Monaco)","fr-CH":"French (Switzerland)",fy:"Frisian",fur:"Friulian",gd:"Gaelic (Scots)","gd-IE":"Gaelic (Irish)",gl:"Galacian",ka:"Georgian",de:"German (Standard)","de-AT":"German (Austria)","de-DE":"German (Germany)","de-LI":"German (Liechtenstein)","de-LU":"German (Luxembourg)","de-CH":"German (Switzerland)",el:"Greek",gu:"Gujurati",ht:"Haitian",he:"Hebrew",hi:"Hindi",hu:"Hungarian",is:"Icelandic",id:"Indonesian",iu:"Inuktitut",ga:"Irish",it:"Italian (Standard)","it-CH":"Italian (Switzerland)",ja:"Japanese",kn:"Kannada",ks:"Kashmiri",kk:"Kazakh",km:"Khmer",ky:"Kirghiz",tlh:"Klingon",ko:"Korean","ko-KP":"Korean (North Korea)","ko-KR":"Korean (South Korea)",la:"Latin",lv:"Latvian",lt:"Lithuanian",lb:"Luxembourgish",mk:"North Macedonia",ms:"Malay",ml:"Malayalam",mt:"Maltese",mi:"Maori",mr:"Marathi",mo:"Moldavian",nv:"Navajo",ng:"Ndonga",ne:"Nepali",no:"Norwegian",nb:"Norwegian (Bokmal)",nn:"Norwegian (Nynorsk)",oc:"Occitan",or:"Oriya",om:"Oromo",fa:"Persian","fa-IR":"Persian/Iran",pl:"Polish",pt:"Portuguese","pt-BR":"Portuguese (Brazil)",pa:"Punjabi","pa-IN":"Punjabi (India)","pa-PK":"Punjabi (Pakistan)",qu:"Quechua",rm:"Rhaeto-Romanic",ro:"Romanian","ro-MO":"Romanian (Moldavia)",ru:"Russian","ru-MO":"Russian (Moldavia)",sz:"Sami (Lappish)",sg:"Sango",sa:"Sanskrit",sc:"Sardinian",sd:"Sindhi",si:"Singhalese",sr:"Serbian",sk:"Slovak",sl:"Slovenian",so:"Somani",sb:"Sorbian",es:"Spanish","es-AR":"Spanish (Argentina)","es-BO":"Spanish (Bolivia)","es-CL":"Spanish (Chile)","es-CO":"Spanish (Colombia)","es-CR":"Spanish (Costa Rica)","es-DO":"Spanish (Dominican Republic)","es-EC":"Spanish (Ecuador)","es-SV":"Spanish (El Salvador)","es-GT":"Spanish (Guatemala)","es-HN":"Spanish (Honduras)","es-MX":"Spanish (Mexico)","es-NI":"Spanish (Nicaragua)","es-PA":"Spanish (Panama)","es-PY":"Spanish (Paraguay)","es-PE":"Spanish (Peru)","es-PR":"Spanish (Puerto Rico)","es-ES":"Spanish (Spain)","es-UY":"Spanish (Uruguay)","es-VE":"Spanish (Venezuela)",sx:"Sutu",sw:"Swahili",sv:"Swedish","sv-FI":"Swedish (Finland)","sv-SV":"Swedish (Sweden)",ta:"Tamil",tt:"Tatar",te:"Teluga",th:"Thai",tig:"Tigre",ts:"Tsonga",tn:"Tswana",tr:"Turkish",tk:"Turkmen",uk:"Ukrainian",hsb:"Upper Sorbian",ur:"Urdu",ve:"Venda",vi:"Vietnamese",vo:"Volapuk",wa:"Walloon",cy:"Welsh",xh:"Xhosa",ji:"Yiddish",zu:"Zulu"}[e]!==void 0&&(this.internal.languageSettings.languageCode=e,this.internal.languageSettings.isSubscribed===!1&&(this.internal.events.subscribe("putCatalog",function(){this.internal.write("/Lang ("+this.internal.languageSettings.languageCode+")")}),this.internal.languageSettings.isSubscribed=!0)),this},Gc=vt.API,pp=Gc.getCharWidthsArray=function(e,t){var r,n,a=(t=t||{}).font||this.internal.getFont(),i=t.fontSize||this.internal.getFontSize(),s=t.charSpace||this.internal.getCharSpace(),o=t.widths?t.widths:a.metadata.Unicode.widths,l=o.fof?o.fof:1,c=t.kerning?t.kerning:a.metadata.Unicode.kerning,u=c.fof?c.fof:1,f=t.doKerning!==!1,p=0,h=e.length,g=0,m=o[0]||l,b=[];for(r=0;r<h;r++)n=e.charCodeAt(r),typeof a.metadata.widthOfString=="function"?b.push((a.metadata.widthOfGlyph(a.metadata.characterToGlyph(n))+s*(1e3/i)||0)/1e3):(p=f&&tr(c[n])==="object"&&!isNaN(parseInt(c[n][g],10))?c[n][g]/u:0,b.push((o[n]||m)/l+p)),g=n;return b},k_=Gc.getStringUnitWidth=function(e,t){var r=(t=t||{}).fontSize||this.internal.getFontSize(),n=t.font||this.internal.getFont(),a=t.charSpace||this.internal.getCharSpace();return Gc.processArabic&&(e=Gc.processArabic(e)),typeof n.metadata.widthOfString=="function"?n.metadata.widthOfString(e,r,a)/r:pp.apply(this,arguments).reduce(function(i,s){return i+s},0)},E_=function(e,t,r,n){for(var a=[],i=0,s=e.length,o=0;i!==s&&o+t[i]<r;)o+=t[i],i++;a.push(e.slice(0,i));var l=i;for(o=0;i!==s;)o+t[i]>n&&(a.push(e.slice(l,i)),o=0,l=i),o+=t[i],i++;return l!==i&&a.push(e.slice(l,i)),a},A_=function(e,t,r){r||(r={});var n,a,i,s,o,l,c,u=[],f=[u],p=r.textIndent||0,h=0,g=0,m=e.split(" "),b=pp.apply(this,[" ",r])[0];if(l=r.lineIndent===-1?m[0].length+2:r.lineIndent||0){var x=Array(l).join(" "),w=[];m.map(function(A){(A=A.split(/\s*\n/)).length>1?w=w.concat(A.map(function(L,D){return(D&&L.length?`
`:"")+L})):w.push(A[0])}),m=w,l=k_.apply(this,[x,r])}for(i=0,s=m.length;i<s;i++){var y=0;if(n=m[i],l&&n[0]==`
`&&(n=n.substr(1),y=1),p+h+(g=(a=pp.apply(this,[n,r])).reduce(function(A,L){return A+L},0))>t||y){if(g>t){for(o=E_.apply(this,[n,a,t-(p+h),t]),u.push(o.shift()),u=[o.pop()];o.length;)f.push([o.shift()]);g=a.slice(n.length-(u[0]?u[0].length:0)).reduce(function(A,L){return A+L},0)}else u=[n];f.push(u),p=g+l,h=b}else u.push(n),p+=h+g,h=b}return c=l?function(A,L){return(L?x:"")+A.join(" ")}:function(A){return A.join(" ")},f.map(c)},Gc.splitTextToSize=function(e,t,r){var n,a=(r=r||{}).fontSize||this.internal.getFontSize(),i=(function(u){if(u.widths&&u.kerning)return{widths:u.widths,kerning:u.kerning};var f=this.internal.getFont(u.fontName,u.fontStyle);return f.metadata.Unicode?{widths:f.metadata.Unicode.widths||{0:1},kerning:f.metadata.Unicode.kerning||{}}:{font:f.metadata,fontSize:this.internal.getFontSize(),charSpace:this.internal.getCharSpace()}}).call(this,r);n=Array.isArray(e)?e:String(e).split(/\r?\n/);var s=1*this.internal.scaleFactor*t/a;i.textIndent=r.textIndent?1*r.textIndent*this.internal.scaleFactor/a:0,i.lineIndent=r.lineIndent;var o,l,c=[];for(o=0,l=n.length;o<l;o++)c=c.concat(A_.apply(this,[n[o],s,i]));return c},function(e){e.__fontmetrics__=e.__fontmetrics__||{};for(var t="klmnopqrstuvwxyz",r={},n={},a=0;a<t.length;a++)r[t[a]]="0123456789abcdef"[a],n["0123456789abcdef"[a]]=t[a];var i=function(f){return"0x"+parseInt(f,10).toString(16)},s=e.__fontmetrics__.compress=function(f){var p,h,g,m,b=["{"];for(var x in f){if(p=f[x],isNaN(parseInt(x,10))?h="'"+x+"'":(x=parseInt(x,10),h=(h=i(x).slice(2)).slice(0,-1)+n[h.slice(-1)]),typeof p=="number")p<0?(g=i(p).slice(3),m="-"):(g=i(p).slice(2),m=""),g=m+g.slice(0,-1)+n[g.slice(-1)];else{if(tr(p)!=="object")throw new Error("Don't know what to do with value type "+tr(p)+".");g=s(p)}b.push(h+g)}return b.push("}"),b.join("")},o=e.__fontmetrics__.uncompress=function(f){if(typeof f!="string")throw new Error("Invalid argument passed to uncompress.");for(var p,h,g,m,b={},x=1,w=b,y=[],A="",L="",D=f.length-1,T=1;T<D;T+=1)(m=f[T])=="'"?p?(g=p.join(""),p=void 0):p=[]:p?p.push(m):m=="{"?(y.push([w,g]),w={},g=void 0):m=="}"?((h=y.pop())[0][h[1]]=w,g=void 0,w=h[0]):m=="-"?x=-1:g===void 0?r.hasOwnProperty(m)?(A+=r[m],g=parseInt(A,16)*x,x=1,A=""):A+=m:r.hasOwnProperty(m)?(L+=r[m],w[g]=parseInt(L,16)*x,x=1,g=void 0,L=""):L+=m;return b},l={codePages:["WinAnsiEncoding"],WinAnsiEncoding:o("{19m8n201n9q201o9r201s9l201t9m201u8m201w9n201x9o201y8o202k8q202l8r202m9p202q8p20aw8k203k8t203t8v203u9v2cq8s212m9t15m8w15n9w2dw9s16k8u16l9u17s9z17x8y17y9y}")},c={Unicode:{Courier:l,"Courier-Bold":l,"Courier-BoldOblique":l,"Courier-Oblique":l,Helvetica:l,"Helvetica-Bold":l,"Helvetica-BoldOblique":l,"Helvetica-Oblique":l,"Times-Roman":l,"Times-Bold":l,"Times-BoldItalic":l,"Times-Italic":l}},u={Unicode:{"Courier-Oblique":o("{'widths'{k3w'fof'6o}'kerning'{'fof'-6o}}"),"Times-BoldItalic":o("{'widths'{k3o2q4ycx2r201n3m201o6o201s2l201t2l201u2l201w3m201x3m201y3m2k1t2l2r202m2n2n3m2o3m2p5n202q6o2r1w2s2l2t2l2u3m2v3t2w1t2x2l2y1t2z1w3k3m3l3m3m3m3n3m3o3m3p3m3q3m3r3m3s3m203t2l203u2l3v2l3w3t3x3t3y3t3z3m4k5n4l4m4m4m4n4m4o4s4p4m4q4m4r4s4s4y4t2r4u3m4v4m4w3x4x5t4y4s4z4s5k3x5l4s5m4m5n3r5o3x5p4s5q4m5r5t5s4m5t3x5u3x5v2l5w1w5x2l5y3t5z3m6k2l6l3m6m3m6n2w6o3m6p2w6q2l6r3m6s3r6t1w6u1w6v3m6w1w6x4y6y3r6z3m7k3m7l3m7m2r7n2r7o1w7p3r7q2w7r4m7s3m7t2w7u2r7v2n7w1q7x2n7y3t202l3mcl4mal2ram3man3mao3map3mar3mas2lat4uau1uav3maw3way4uaz2lbk2sbl3t'fof'6obo2lbp3tbq3mbr1tbs2lbu1ybv3mbz3mck4m202k3mcm4mcn4mco4mcp4mcq5ycr4mcs4mct4mcu4mcv4mcw2r2m3rcy2rcz2rdl4sdm4sdn4sdo4sdp4sdq4sds4sdt4sdu4sdv4sdw4sdz3mek3mel3mem3men3meo3mep3meq4ser2wes2wet2weu2wev2wew1wex1wey1wez1wfl3rfm3mfn3mfo3mfp3mfq3mfr3tfs3mft3rfu3rfv3rfw3rfz2w203k6o212m6o2dw2l2cq2l3t3m3u2l17s3x19m3m}'kerning'{cl{4qu5kt5qt5rs17ss5ts}201s{201ss}201t{cks4lscmscnscoscpscls2wu2yu201ts}201x{2wu2yu}2k{201ts}2w{4qx5kx5ou5qx5rs17su5tu}2x{17su5tu5ou}2y{4qx5kx5ou5qx5rs17ss5ts}'fof'-6ofn{17sw5tw5ou5qw5rs}7t{cksclscmscnscoscps4ls}3u{17su5tu5os5qs}3v{17su5tu5os5qs}7p{17su5tu}ck{4qu5kt5qt5rs17ss5ts}4l{4qu5kt5qt5rs17ss5ts}cm{4qu5kt5qt5rs17ss5ts}cn{4qu5kt5qt5rs17ss5ts}co{4qu5kt5qt5rs17ss5ts}cp{4qu5kt5qt5rs17ss5ts}6l{4qu5ou5qw5rt17su5tu}5q{ckuclucmucnucoucpu4lu}5r{ckuclucmucnucoucpu4lu}7q{cksclscmscnscoscps4ls}6p{4qu5ou5qw5rt17sw5tw}ek{4qu5ou5qw5rt17su5tu}el{4qu5ou5qw5rt17su5tu}em{4qu5ou5qw5rt17su5tu}en{4qu5ou5qw5rt17su5tu}eo{4qu5ou5qw5rt17su5tu}ep{4qu5ou5qw5rt17su5tu}es{17ss5ts5qs4qu}et{4qu5ou5qw5rt17sw5tw}eu{4qu5ou5qw5rt17ss5ts}ev{17ss5ts5qs4qu}6z{17sw5tw5ou5qw5rs}fm{17sw5tw5ou5qw5rs}7n{201ts}fo{17sw5tw5ou5qw5rs}fp{17sw5tw5ou5qw5rs}fq{17sw5tw5ou5qw5rs}7r{cksclscmscnscoscps4ls}fs{17sw5tw5ou5qw5rs}ft{17su5tu}fu{17su5tu}fv{17su5tu}fw{17su5tu}fz{cksclscmscnscoscps4ls}}}"),"Helvetica-Bold":o("{'widths'{k3s2q4scx1w201n3r201o6o201s1w201t1w201u1w201w3m201x3m201y3m2k1w2l2l202m2n2n3r2o3r2p5t202q6o2r1s2s2l2t2l2u2r2v3u2w1w2x2l2y1w2z1w3k3r3l3r3m3r3n3r3o3r3p3r3q3r3r3r3s3r203t2l203u2l3v2l3w3u3x3u3y3u3z3x4k6l4l4s4m4s4n4s4o4s4p4m4q3x4r4y4s4s4t1w4u3r4v4s4w3x4x5n4y4s4z4y5k4m5l4y5m4s5n4m5o3x5p4s5q4m5r5y5s4m5t4m5u3x5v2l5w1w5x2l5y3u5z3r6k2l6l3r6m3x6n3r6o3x6p3r6q2l6r3x6s3x6t1w6u1w6v3r6w1w6x5t6y3x6z3x7k3x7l3x7m2r7n3r7o2l7p3x7q3r7r4y7s3r7t3r7u3m7v2r7w1w7x2r7y3u202l3rcl4sal2lam3ran3rao3rap3rar3ras2lat4tau2pav3raw3uay4taz2lbk2sbl3u'fof'6obo2lbp3xbq3rbr1wbs2lbu2obv3rbz3xck4s202k3rcm4scn4sco4scp4scq6ocr4scs4mct4mcu4mcv4mcw1w2m2zcy1wcz1wdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3xek3rel3rem3ren3reo3rep3req5ter3res3ret3reu3rev3rew1wex1wey1wez1wfl3xfm3xfn3xfo3xfp3xfq3xfr3ufs3xft3xfu3xfv3xfw3xfz3r203k6o212m6o2dw2l2cq2l3t3r3u2l17s4m19m3r}'kerning'{cl{4qs5ku5ot5qs17sv5tv}201t{2ww4wy2yw}201w{2ks}201x{2ww4wy2yw}2k{201ts201xs}2w{7qs4qu5kw5os5qw5rs17su5tu7tsfzs}2x{5ow5qs}2y{7qs4qu5kw5os5qw5rs17su5tu7tsfzs}'fof'-6o7p{17su5tu5ot}ck{4qs5ku5ot5qs17sv5tv}4l{4qs5ku5ot5qs17sv5tv}cm{4qs5ku5ot5qs17sv5tv}cn{4qs5ku5ot5qs17sv5tv}co{4qs5ku5ot5qs17sv5tv}cp{4qs5ku5ot5qs17sv5tv}6l{17st5tt5os}17s{2kwclvcmvcnvcovcpv4lv4wwckv}5o{2kucltcmtcntcotcpt4lt4wtckt}5q{2ksclscmscnscoscps4ls4wvcks}5r{2ks4ws}5t{2kwclvcmvcnvcovcpv4lv4wwckv}eo{17st5tt5os}fu{17su5tu5ot}6p{17ss5ts}ek{17st5tt5os}el{17st5tt5os}em{17st5tt5os}en{17st5tt5os}6o{201ts}ep{17st5tt5os}es{17ss5ts}et{17ss5ts}eu{17ss5ts}ev{17ss5ts}6z{17su5tu5os5qt}fm{17su5tu5os5qt}fn{17su5tu5os5qt}fo{17su5tu5os5qt}fp{17su5tu5os5qt}fq{17su5tu5os5qt}fs{17su5tu5os5qt}ft{17su5tu5ot}7m{5os}fv{17su5tu5ot}fw{17su5tu5ot}}}"),Courier:o("{'widths'{k3w'fof'6o}'kerning'{'fof'-6o}}"),"Courier-BoldOblique":o("{'widths'{k3w'fof'6o}'kerning'{'fof'-6o}}"),"Times-Bold":o("{'widths'{k3q2q5ncx2r201n3m201o6o201s2l201t2l201u2l201w3m201x3m201y3m2k1t2l2l202m2n2n3m2o3m2p6o202q6o2r1w2s2l2t2l2u3m2v3t2w1t2x2l2y1t2z1w3k3m3l3m3m3m3n3m3o3m3p3m3q3m3r3m3s3m203t2l203u2l3v2l3w3t3x3t3y3t3z3m4k5x4l4s4m4m4n4s4o4s4p4m4q3x4r4y4s4y4t2r4u3m4v4y4w4m4x5y4y4s4z4y5k3x5l4y5m4s5n3r5o4m5p4s5q4s5r6o5s4s5t4s5u4m5v2l5w1w5x2l5y3u5z3m6k2l6l3m6m3r6n2w6o3r6p2w6q2l6r3m6s3r6t1w6u2l6v3r6w1w6x5n6y3r6z3m7k3r7l3r7m2w7n2r7o2l7p3r7q3m7r4s7s3m7t3m7u2w7v2r7w1q7x2r7y3o202l3mcl4sal2lam3man3mao3map3mar3mas2lat4uau1yav3maw3tay4uaz2lbk2sbl3t'fof'6obo2lbp3rbr1tbs2lbu2lbv3mbz3mck4s202k3mcm4scn4sco4scp4scq6ocr4scs4mct4mcu4mcv4mcw2r2m3rcy2rcz2rdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3rek3mel3mem3men3meo3mep3meq4ser2wes2wet2weu2wev2wew1wex1wey1wez1wfl3rfm3mfn3mfo3mfp3mfq3mfr3tfs3mft3rfu3rfv3rfw3rfz3m203k6o212m6o2dw2l2cq2l3t3m3u2l17s4s19m3m}'kerning'{cl{4qt5ks5ot5qy5rw17sv5tv}201t{cks4lscmscnscoscpscls4wv}2k{201ts}2w{4qu5ku7mu5os5qx5ru17su5tu}2x{17su5tu5ou5qs}2y{4qv5kv7mu5ot5qz5ru17su5tu}'fof'-6o7t{cksclscmscnscoscps4ls}3u{17su5tu5os5qu}3v{17su5tu5os5qu}fu{17su5tu5ou5qu}7p{17su5tu5ou5qu}ck{4qt5ks5ot5qy5rw17sv5tv}4l{4qt5ks5ot5qy5rw17sv5tv}cm{4qt5ks5ot5qy5rw17sv5tv}cn{4qt5ks5ot5qy5rw17sv5tv}co{4qt5ks5ot5qy5rw17sv5tv}cp{4qt5ks5ot5qy5rw17sv5tv}6l{17st5tt5ou5qu}17s{ckuclucmucnucoucpu4lu4wu}5o{ckuclucmucnucoucpu4lu4wu}5q{ckzclzcmzcnzcozcpz4lz4wu}5r{ckxclxcmxcnxcoxcpx4lx4wu}5t{ckuclucmucnucoucpu4lu4wu}7q{ckuclucmucnucoucpu4lu}6p{17sw5tw5ou5qu}ek{17st5tt5qu}el{17st5tt5ou5qu}em{17st5tt5qu}en{17st5tt5qu}eo{17st5tt5qu}ep{17st5tt5ou5qu}es{17ss5ts5qu}et{17sw5tw5ou5qu}eu{17sw5tw5ou5qu}ev{17ss5ts5qu}6z{17sw5tw5ou5qu5rs}fm{17sw5tw5ou5qu5rs}fn{17sw5tw5ou5qu5rs}fo{17sw5tw5ou5qu5rs}fp{17sw5tw5ou5qu5rs}fq{17sw5tw5ou5qu5rs}7r{cktcltcmtcntcotcpt4lt5os}fs{17sw5tw5ou5qu5rs}ft{17su5tu5ou5qu}7m{5os}fv{17su5tu5ou5qu}fw{17su5tu5ou5qu}fz{cksclscmscnscoscps4ls}}}"),Symbol:o("{'widths'{k3uaw4r19m3m2k1t2l2l202m2y2n3m2p5n202q6o3k3m2s2l2t2l2v3r2w1t3m3m2y1t2z1wbk2sbl3r'fof'6o3n3m3o3m3p3m3q3m3r3m3s3m3t3m3u1w3v1w3w3r3x3r3y3r3z2wbp3t3l3m5v2l5x2l5z3m2q4yfr3r7v3k7w1o7x3k}'kerning'{'fof'-6o}}"),Helvetica:o("{'widths'{k3p2q4mcx1w201n3r201o6o201s1q201t1q201u1q201w2l201x2l201y2l2k1w2l1w202m2n2n3r2o3r2p5t202q6o2r1n2s2l2t2l2u2r2v3u2w1w2x2l2y1w2z1w3k3r3l3r3m3r3n3r3o3r3p3r3q3r3r3r3s3r203t2l203u2l3v1w3w3u3x3u3y3u3z3r4k6p4l4m4m4m4n4s4o4s4p4m4q3x4r4y4s4s4t1w4u3m4v4m4w3r4x5n4y4s4z4y5k4m5l4y5m4s5n4m5o3x5p4s5q4m5r5y5s4m5t4m5u3x5v1w5w1w5x1w5y2z5z3r6k2l6l3r6m3r6n3m6o3r6p3r6q1w6r3r6s3r6t1q6u1q6v3m6w1q6x5n6y3r6z3r7k3r7l3r7m2l7n3m7o1w7p3r7q3m7r4s7s3m7t3m7u3m7v2l7w1u7x2l7y3u202l3rcl4mal2lam3ran3rao3rap3rar3ras2lat4tau2pav3raw3uay4taz2lbk2sbl3u'fof'6obo2lbp3rbr1wbs2lbu2obv3rbz3xck4m202k3rcm4mcn4mco4mcp4mcq6ocr4scs4mct4mcu4mcv4mcw1w2m2ncy1wcz1wdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3xek3rel3rem3ren3reo3rep3req5ter3mes3ret3reu3rev3rew1wex1wey1wez1wfl3rfm3rfn3rfo3rfp3rfq3rfr3ufs3xft3rfu3rfv3rfw3rfz3m203k6o212m6o2dw2l2cq2l3t3r3u1w17s4m19m3r}'kerning'{5q{4wv}cl{4qs5kw5ow5qs17sv5tv}201t{2wu4w1k2yu}201x{2wu4wy2yu}17s{2ktclucmucnu4otcpu4lu4wycoucku}2w{7qs4qz5k1m17sy5ow5qx5rsfsu5ty7tufzu}2x{17sy5ty5oy5qs}2y{7qs4qz5k1m17sy5ow5qx5rsfsu5ty7tufzu}'fof'-6o7p{17sv5tv5ow}ck{4qs5kw5ow5qs17sv5tv}4l{4qs5kw5ow5qs17sv5tv}cm{4qs5kw5ow5qs17sv5tv}cn{4qs5kw5ow5qs17sv5tv}co{4qs5kw5ow5qs17sv5tv}cp{4qs5kw5ow5qs17sv5tv}6l{17sy5ty5ow}do{17st5tt}4z{17st5tt}7s{fst}dm{17st5tt}dn{17st5tt}5o{ckwclwcmwcnwcowcpw4lw4wv}dp{17st5tt}dq{17st5tt}7t{5ow}ds{17st5tt}5t{2ktclucmucnu4otcpu4lu4wycoucku}fu{17sv5tv5ow}6p{17sy5ty5ow5qs}ek{17sy5ty5ow}el{17sy5ty5ow}em{17sy5ty5ow}en{5ty}eo{17sy5ty5ow}ep{17sy5ty5ow}es{17sy5ty5qs}et{17sy5ty5ow5qs}eu{17sy5ty5ow5qs}ev{17sy5ty5ow5qs}6z{17sy5ty5ow5qs}fm{17sy5ty5ow5qs}fn{17sy5ty5ow5qs}fo{17sy5ty5ow5qs}fp{17sy5ty5qs}fq{17sy5ty5ow5qs}7r{5ow}fs{17sy5ty5ow5qs}ft{17sv5tv5ow}7m{5ow}fv{17sv5tv5ow}fw{17sv5tv5ow}}}"),"Helvetica-BoldOblique":o("{'widths'{k3s2q4scx1w201n3r201o6o201s1w201t1w201u1w201w3m201x3m201y3m2k1w2l2l202m2n2n3r2o3r2p5t202q6o2r1s2s2l2t2l2u2r2v3u2w1w2x2l2y1w2z1w3k3r3l3r3m3r3n3r3o3r3p3r3q3r3r3r3s3r203t2l203u2l3v2l3w3u3x3u3y3u3z3x4k6l4l4s4m4s4n4s4o4s4p4m4q3x4r4y4s4s4t1w4u3r4v4s4w3x4x5n4y4s4z4y5k4m5l4y5m4s5n4m5o3x5p4s5q4m5r5y5s4m5t4m5u3x5v2l5w1w5x2l5y3u5z3r6k2l6l3r6m3x6n3r6o3x6p3r6q2l6r3x6s3x6t1w6u1w6v3r6w1w6x5t6y3x6z3x7k3x7l3x7m2r7n3r7o2l7p3x7q3r7r4y7s3r7t3r7u3m7v2r7w1w7x2r7y3u202l3rcl4sal2lam3ran3rao3rap3rar3ras2lat4tau2pav3raw3uay4taz2lbk2sbl3u'fof'6obo2lbp3xbq3rbr1wbs2lbu2obv3rbz3xck4s202k3rcm4scn4sco4scp4scq6ocr4scs4mct4mcu4mcv4mcw1w2m2zcy1wcz1wdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3xek3rel3rem3ren3reo3rep3req5ter3res3ret3reu3rev3rew1wex1wey1wez1wfl3xfm3xfn3xfo3xfp3xfq3xfr3ufs3xft3xfu3xfv3xfw3xfz3r203k6o212m6o2dw2l2cq2l3t3r3u2l17s4m19m3r}'kerning'{cl{4qs5ku5ot5qs17sv5tv}201t{2ww4wy2yw}201w{2ks}201x{2ww4wy2yw}2k{201ts201xs}2w{7qs4qu5kw5os5qw5rs17su5tu7tsfzs}2x{5ow5qs}2y{7qs4qu5kw5os5qw5rs17su5tu7tsfzs}'fof'-6o7p{17su5tu5ot}ck{4qs5ku5ot5qs17sv5tv}4l{4qs5ku5ot5qs17sv5tv}cm{4qs5ku5ot5qs17sv5tv}cn{4qs5ku5ot5qs17sv5tv}co{4qs5ku5ot5qs17sv5tv}cp{4qs5ku5ot5qs17sv5tv}6l{17st5tt5os}17s{2kwclvcmvcnvcovcpv4lv4wwckv}5o{2kucltcmtcntcotcpt4lt4wtckt}5q{2ksclscmscnscoscps4ls4wvcks}5r{2ks4ws}5t{2kwclvcmvcnvcovcpv4lv4wwckv}eo{17st5tt5os}fu{17su5tu5ot}6p{17ss5ts}ek{17st5tt5os}el{17st5tt5os}em{17st5tt5os}en{17st5tt5os}6o{201ts}ep{17st5tt5os}es{17ss5ts}et{17ss5ts}eu{17ss5ts}ev{17ss5ts}6z{17su5tu5os5qt}fm{17su5tu5os5qt}fn{17su5tu5os5qt}fo{17su5tu5os5qt}fp{17su5tu5os5qt}fq{17su5tu5os5qt}fs{17su5tu5os5qt}ft{17su5tu5ot}7m{5os}fv{17su5tu5ot}fw{17su5tu5ot}}}"),ZapfDingbats:o("{'widths'{k4u2k1w'fof'6o}'kerning'{'fof'-6o}}"),"Courier-Bold":o("{'widths'{k3w'fof'6o}'kerning'{'fof'-6o}}"),"Times-Italic":o("{'widths'{k3n2q4ycx2l201n3m201o5t201s2l201t2l201u2l201w3r201x3r201y3r2k1t2l2l202m2n2n3m2o3m2p5n202q5t2r1p2s2l2t2l2u3m2v4n2w1t2x2l2y1t2z1w3k3m3l3m3m3m3n3m3o3m3p3m3q3m3r3m3s3m203t2l203u2l3v2l3w4n3x4n3y4n3z3m4k5w4l3x4m3x4n4m4o4s4p3x4q3x4r4s4s4s4t2l4u2w4v4m4w3r4x5n4y4m4z4s5k3x5l4s5m3x5n3m5o3r5p4s5q3x5r5n5s3x5t3r5u3r5v2r5w1w5x2r5y2u5z3m6k2l6l3m6m3m6n2w6o3m6p2w6q1w6r3m6s3m6t1w6u1w6v2w6w1w6x4s6y3m6z3m7k3m7l3m7m2r7n2r7o1w7p3m7q2w7r4m7s2w7t2w7u2r7v2s7w1v7x2s7y3q202l3mcl3xal2ram3man3mao3map3mar3mas2lat4wau1vav3maw4nay4waz2lbk2sbl4n'fof'6obo2lbp3mbq3obr1tbs2lbu1zbv3mbz3mck3x202k3mcm3xcn3xco3xcp3xcq5tcr4mcs3xct3xcu3xcv3xcw2l2m2ucy2lcz2ldl4mdm4sdn4sdo4sdp4sdq4sds4sdt4sdu4sdv4sdw4sdz3mek3mel3mem3men3meo3mep3meq4mer2wes2wet2weu2wev2wew1wex1wey1wez1wfl3mfm3mfn3mfo3mfp3mfq3mfr4nfs3mft3mfu3mfv3mfw3mfz2w203k6o212m6m2dw2l2cq2l3t3m3u2l17s3r19m3m}'kerning'{cl{5kt4qw}201s{201sw}201t{201tw2wy2yy6q-t}201x{2wy2yy}2k{201tw}2w{7qs4qy7rs5ky7mw5os5qx5ru17su5tu}2x{17ss5ts5os}2y{7qs4qy7rs5ky7mw5os5qx5ru17su5tu}'fof'-6o6t{17ss5ts5qs}7t{5os}3v{5qs}7p{17su5tu5qs}ck{5kt4qw}4l{5kt4qw}cm{5kt4qw}cn{5kt4qw}co{5kt4qw}cp{5kt4qw}6l{4qs5ks5ou5qw5ru17su5tu}17s{2ks}5q{ckvclvcmvcnvcovcpv4lv}5r{ckuclucmucnucoucpu4lu}5t{2ks}6p{4qs5ks5ou5qw5ru17su5tu}ek{4qs5ks5ou5qw5ru17su5tu}el{4qs5ks5ou5qw5ru17su5tu}em{4qs5ks5ou5qw5ru17su5tu}en{4qs5ks5ou5qw5ru17su5tu}eo{4qs5ks5ou5qw5ru17su5tu}ep{4qs5ks5ou5qw5ru17su5tu}es{5ks5qs4qs}et{4qs5ks5ou5qw5ru17su5tu}eu{4qs5ks5qw5ru17su5tu}ev{5ks5qs4qs}ex{17ss5ts5qs}6z{4qv5ks5ou5qw5ru17su5tu}fm{4qv5ks5ou5qw5ru17su5tu}fn{4qv5ks5ou5qw5ru17su5tu}fo{4qv5ks5ou5qw5ru17su5tu}fp{4qv5ks5ou5qw5ru17su5tu}fq{4qv5ks5ou5qw5ru17su5tu}7r{5os}fs{4qv5ks5ou5qw5ru17su5tu}ft{17su5tu5qs}fu{17su5tu5qs}fv{17su5tu5qs}fw{17su5tu5qs}}}"),"Times-Roman":o("{'widths'{k3n2q4ycx2l201n3m201o6o201s2l201t2l201u2l201w2w201x2w201y2w2k1t2l2l202m2n2n3m2o3m2p5n202q6o2r1m2s2l2t2l2u3m2v3s2w1t2x2l2y1t2z1w3k3m3l3m3m3m3n3m3o3m3p3m3q3m3r3m3s3m203t2l203u2l3v1w3w3s3x3s3y3s3z2w4k5w4l4s4m4m4n4m4o4s4p3x4q3r4r4s4s4s4t2l4u2r4v4s4w3x4x5t4y4s4z4s5k3r5l4s5m4m5n3r5o3x5p4s5q4s5r5y5s4s5t4s5u3x5v2l5w1w5x2l5y2z5z3m6k2l6l2w6m3m6n2w6o3m6p2w6q2l6r3m6s3m6t1w6u1w6v3m6w1w6x4y6y3m6z3m7k3m7l3m7m2l7n2r7o1w7p3m7q3m7r4s7s3m7t3m7u2w7v3k7w1o7x3k7y3q202l3mcl4sal2lam3man3mao3map3mar3mas2lat4wau1vav3maw3say4waz2lbk2sbl3s'fof'6obo2lbp3mbq2xbr1tbs2lbu1zbv3mbz2wck4s202k3mcm4scn4sco4scp4scq5tcr4mcs3xct3xcu3xcv3xcw2l2m2tcy2lcz2ldl4sdm4sdn4sdo4sdp4sdq4sds4sdt4sdu4sdv4sdw4sdz3mek2wel2wem2wen2weo2wep2weq4mer2wes2wet2weu2wev2wew1wex1wey1wez1wfl3mfm3mfn3mfo3mfp3mfq3mfr3sfs3mft3mfu3mfv3mfw3mfz3m203k6o212m6m2dw2l2cq2l3t3m3u1w17s4s19m3m}'kerning'{cl{4qs5ku17sw5ou5qy5rw201ss5tw201ws}201s{201ss}201t{ckw4lwcmwcnwcowcpwclw4wu201ts}2k{201ts}2w{4qs5kw5os5qx5ru17sx5tx}2x{17sw5tw5ou5qu}2y{4qs5kw5os5qx5ru17sx5tx}'fof'-6o7t{ckuclucmucnucoucpu4lu5os5rs}3u{17su5tu5qs}3v{17su5tu5qs}7p{17sw5tw5qs}ck{4qs5ku17sw5ou5qy5rw201ss5tw201ws}4l{4qs5ku17sw5ou5qy5rw201ss5tw201ws}cm{4qs5ku17sw5ou5qy5rw201ss5tw201ws}cn{4qs5ku17sw5ou5qy5rw201ss5tw201ws}co{4qs5ku17sw5ou5qy5rw201ss5tw201ws}cp{4qs5ku17sw5ou5qy5rw201ss5tw201ws}6l{17su5tu5os5qw5rs}17s{2ktclvcmvcnvcovcpv4lv4wuckv}5o{ckwclwcmwcnwcowcpw4lw4wu}5q{ckyclycmycnycoycpy4ly4wu5ms}5r{cktcltcmtcntcotcpt4lt4ws}5t{2ktclvcmvcnvcovcpv4lv4wuckv}7q{cksclscmscnscoscps4ls}6p{17su5tu5qw5rs}ek{5qs5rs}el{17su5tu5os5qw5rs}em{17su5tu5os5qs5rs}en{17su5qs5rs}eo{5qs5rs}ep{17su5tu5os5qw5rs}es{5qs}et{17su5tu5qw5rs}eu{17su5tu5qs5rs}ev{5qs}6z{17sv5tv5os5qx5rs}fm{5os5qt5rs}fn{17sv5tv5os5qx5rs}fo{17sv5tv5os5qx5rs}fp{5os5qt5rs}fq{5os5qt5rs}7r{ckuclucmucnucoucpu4lu5os}fs{17sv5tv5os5qx5rs}ft{17ss5ts5qs}fu{17sw5tw5qs}fv{17sw5tw5qs}fw{17ss5ts5qs}fz{ckuclucmucnucoucpu4lu5os5rs}}}"),"Helvetica-Oblique":o("{'widths'{k3p2q4mcx1w201n3r201o6o201s1q201t1q201u1q201w2l201x2l201y2l2k1w2l1w202m2n2n3r2o3r2p5t202q6o2r1n2s2l2t2l2u2r2v3u2w1w2x2l2y1w2z1w3k3r3l3r3m3r3n3r3o3r3p3r3q3r3r3r3s3r203t2l203u2l3v1w3w3u3x3u3y3u3z3r4k6p4l4m4m4m4n4s4o4s4p4m4q3x4r4y4s4s4t1w4u3m4v4m4w3r4x5n4y4s4z4y5k4m5l4y5m4s5n4m5o3x5p4s5q4m5r5y5s4m5t4m5u3x5v1w5w1w5x1w5y2z5z3r6k2l6l3r6m3r6n3m6o3r6p3r6q1w6r3r6s3r6t1q6u1q6v3m6w1q6x5n6y3r6z3r7k3r7l3r7m2l7n3m7o1w7p3r7q3m7r4s7s3m7t3m7u3m7v2l7w1u7x2l7y3u202l3rcl4mal2lam3ran3rao3rap3rar3ras2lat4tau2pav3raw3uay4taz2lbk2sbl3u'fof'6obo2lbp3rbr1wbs2lbu2obv3rbz3xck4m202k3rcm4mcn4mco4mcp4mcq6ocr4scs4mct4mcu4mcv4mcw1w2m2ncy1wcz1wdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3xek3rel3rem3ren3reo3rep3req5ter3mes3ret3reu3rev3rew1wex1wey1wez1wfl3rfm3rfn3rfo3rfp3rfq3rfr3ufs3xft3rfu3rfv3rfw3rfz3m203k6o212m6o2dw2l2cq2l3t3r3u1w17s4m19m3r}'kerning'{5q{4wv}cl{4qs5kw5ow5qs17sv5tv}201t{2wu4w1k2yu}201x{2wu4wy2yu}17s{2ktclucmucnu4otcpu4lu4wycoucku}2w{7qs4qz5k1m17sy5ow5qx5rsfsu5ty7tufzu}2x{17sy5ty5oy5qs}2y{7qs4qz5k1m17sy5ow5qx5rsfsu5ty7tufzu}'fof'-6o7p{17sv5tv5ow}ck{4qs5kw5ow5qs17sv5tv}4l{4qs5kw5ow5qs17sv5tv}cm{4qs5kw5ow5qs17sv5tv}cn{4qs5kw5ow5qs17sv5tv}co{4qs5kw5ow5qs17sv5tv}cp{4qs5kw5ow5qs17sv5tv}6l{17sy5ty5ow}do{17st5tt}4z{17st5tt}7s{fst}dm{17st5tt}dn{17st5tt}5o{ckwclwcmwcnwcowcpw4lw4wv}dp{17st5tt}dq{17st5tt}7t{5ow}ds{17st5tt}5t{2ktclucmucnu4otcpu4lu4wycoucku}fu{17sv5tv5ow}6p{17sy5ty5ow5qs}ek{17sy5ty5ow}el{17sy5ty5ow}em{17sy5ty5ow}en{5ty}eo{17sy5ty5ow}ep{17sy5ty5ow}es{17sy5ty5qs}et{17sy5ty5ow5qs}eu{17sy5ty5ow5qs}ev{17sy5ty5ow5qs}6z{17sy5ty5ow5qs}fm{17sy5ty5ow5qs}fn{17sy5ty5ow5qs}fo{17sy5ty5ow5qs}fp{17sy5ty5qs}fq{17sy5ty5ow5qs}7r{5ow}fs{17sy5ty5ow5qs}ft{17sv5tv5ow}7m{5ow}fv{17sv5tv5ow}fw{17sv5tv5ow}}}")}};e.events.push(["addFont",function(f){var p=f.font,h=u.Unicode[p.postScriptName];h&&(p.metadata.Unicode={},p.metadata.Unicode.widths=h.widths,p.metadata.Unicode.kerning=h.kerning);var g=c.Unicode[p.postScriptName];g&&(p.metadata.Unicode.encoding=g,p.encoding=g.codePages[0])}])}(vt.API),function(e){var t=function(r){for(var n=r.length,a=new Uint8Array(n),i=0;i<n;i++)a[i]=r.charCodeAt(i);return a};e.API.events.push(["addFont",function(r){var n=void 0,a=r.font,i=r.instance;if(!a.isStandardFont){if(i===void 0)throw new Error("Font does not exist in vFS, import fonts or remove declaration doc.addFont('"+a.postScriptName+"').");if(typeof(n=i.existsFileInVFS(a.postScriptName)===!1?i.loadFile(a.postScriptName):i.getFileFromVFS(a.postScriptName))!="string")throw new Error("Font is not stored as string-data in vFS, import fonts or remove declaration doc.addFont('"+a.postScriptName+"').");(function(s,o){o=/^\x00\x01\x00\x00/.test(o)?t(o):t(L0(o)),s.metadata=e.API.TTFFont.open(o),s.metadata.Unicode=s.metadata.Unicode||{encoding:{},kerning:{},widths:[]},s.metadata.glyIdsUsed=[0]})(a,n)}}])}(vt),function(e){function t(){return(xt.canvg?Promise.resolve(xt.canvg):Zo(()=>import("./index.es-CBbEYO9-.js"),[])).catch(function(r){return Promise.reject(new Error("Could not load canvg: "+r))}).then(function(r){return r.default?r.default:r})}vt.API.addSvgAsImage=function(r,n,a,i,s,o,l,c){if(isNaN(n)||isNaN(a))throw or.error("jsPDF.addSvgAsImage: Invalid coordinates",arguments),new Error("Invalid coordinates passed to jsPDF.addSvgAsImage");if(isNaN(i)||isNaN(s))throw or.error("jsPDF.addSvgAsImage: Invalid measurements",arguments),new Error("Invalid measurements (width and/or height) passed to jsPDF.addSvgAsImage");var u=document.createElement("canvas");u.width=i,u.height=s;var f=u.getContext("2d");f.fillStyle="#fff",f.fillRect(0,0,u.width,u.height);var p={ignoreMouse:!0,ignoreAnimation:!0,ignoreDimensions:!0},h=this;return t().then(function(g){return g.fromString(f,r,p)},function(){return Promise.reject(new Error("Could not load canvg."))}).then(function(g){return g.render(p)}).then(function(){h.addImage(u.toDataURL("image/jpeg",1),n,a,i,s,l,c)})}}(),vt.API.putTotalPages=function(e){var t,r=0;parseInt(this.internal.getFont().id.substr(1),10)<15?(t=new RegExp(e,"g"),r=this.internal.getNumberOfPages()):(t=new RegExp(this.pdfEscape16(e,this.internal.getFont()),"g"),r=this.pdfEscape16(this.internal.getNumberOfPages()+"",this.internal.getFont()));for(var n=1;n<=this.internal.getNumberOfPages();n++)for(var a=0;a<this.internal.pages[n].length;a++)this.internal.pages[n][a]=this.internal.pages[n][a].replace(t,r);return this},vt.API.viewerPreferences=function(e,t){var r;e=e||{},t=t||!1;var n,a,i,s={HideToolbar:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},HideMenubar:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},HideWindowUI:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},FitWindow:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},CenterWindow:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},DisplayDocTitle:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.4},NonFullScreenPageMode:{defaultValue:"UseNone",value:"UseNone",type:"name",explicitSet:!1,valueSet:["UseNone","UseOutlines","UseThumbs","UseOC"],pdfVersion:1.3},Direction:{defaultValue:"L2R",value:"L2R",type:"name",explicitSet:!1,valueSet:["L2R","R2L"],pdfVersion:1.3},ViewArea:{defaultValue:"CropBox",value:"CropBox",type:"name",explicitSet:!1,valueSet:["MediaBox","CropBox","TrimBox","BleedBox","ArtBox"],pdfVersion:1.4},ViewClip:{defaultValue:"CropBox",value:"CropBox",type:"name",explicitSet:!1,valueSet:["MediaBox","CropBox","TrimBox","BleedBox","ArtBox"],pdfVersion:1.4},PrintArea:{defaultValue:"CropBox",value:"CropBox",type:"name",explicitSet:!1,valueSet:["MediaBox","CropBox","TrimBox","BleedBox","ArtBox"],pdfVersion:1.4},PrintClip:{defaultValue:"CropBox",value:"CropBox",type:"name",explicitSet:!1,valueSet:["MediaBox","CropBox","TrimBox","BleedBox","ArtBox"],pdfVersion:1.4},PrintScaling:{defaultValue:"AppDefault",value:"AppDefault",type:"name",explicitSet:!1,valueSet:["AppDefault","None"],pdfVersion:1.6},Duplex:{defaultValue:"",value:"none",type:"name",explicitSet:!1,valueSet:["Simplex","DuplexFlipShortEdge","DuplexFlipLongEdge","none"],pdfVersion:1.7},PickTrayByPDFSize:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.7},PrintPageRange:{defaultValue:"",value:"",type:"array",explicitSet:!1,valueSet:null,pdfVersion:1.7},NumCopies:{defaultValue:1,value:1,type:"integer",explicitSet:!1,valueSet:null,pdfVersion:1.7}},o=Object.keys(s),l=[],c=0,u=0,f=0;function p(g,m){var b,x=!1;for(b=0;b<g.length;b+=1)g[b]===m&&(x=!0);return x}if(this.internal.viewerpreferences===void 0&&(this.internal.viewerpreferences={},this.internal.viewerpreferences.configuration=JSON.parse(JSON.stringify(s)),this.internal.viewerpreferences.isSubscribed=!1),r=this.internal.viewerpreferences.configuration,e==="reset"||t===!0){var h=o.length;for(f=0;f<h;f+=1)r[o[f]].value=r[o[f]].defaultValue,r[o[f]].explicitSet=!1}if(tr(e)==="object"){for(a in e)if(i=e[a],p(o,a)&&i!==void 0){if(r[a].type==="boolean"&&typeof i=="boolean")r[a].value=i;else if(r[a].type==="name"&&p(r[a].valueSet,i))r[a].value=i;else if(r[a].type==="integer"&&Number.isInteger(i))r[a].value=i;else if(r[a].type==="array"){for(c=0;c<i.length;c+=1)if(n=!0,i[c].length===1&&typeof i[c][0]=="number")l.push(String(i[c]-1));else if(i[c].length>1){for(u=0;u<i[c].length;u+=1)typeof i[c][u]!="number"&&(n=!1);n===!0&&l.push([i[c][0]-1,i[c][1]-1].join(" "))}r[a].value="["+l.join(" ")+"]"}else r[a].value=r[a].defaultValue;r[a].explicitSet=!0}}return this.internal.viewerpreferences.isSubscribed===!1&&(this.internal.events.subscribe("putCatalog",function(){var g,m=[];for(g in r)r[g].explicitSet===!0&&(r[g].type==="name"?m.push("/"+g+" /"+r[g].value):m.push("/"+g+" "+r[g].value));m.length!==0&&this.internal.write(`/ViewerPreferences
<<
`+m.join(`
`)+`
>>`)}),this.internal.viewerpreferences.isSubscribed=!0),this.internal.viewerpreferences.configuration=r,this},function(e){var t=function(){var n='<rdf:RDF xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#"><rdf:Description rdf:about="" xmlns:jspdf="'+this.internal.__metadata__.namespaceuri+'"><jspdf:metadata>',a=unescape(encodeURIComponent('<x:xmpmeta xmlns:x="adobe:ns:meta/">')),i=unescape(encodeURIComponent(n)),s=unescape(encodeURIComponent(this.internal.__metadata__.metadata)),o=unescape(encodeURIComponent("</jspdf:metadata></rdf:Description></rdf:RDF>")),l=unescape(encodeURIComponent("</x:xmpmeta>")),c=i.length+s.length+o.length+a.length+l.length;this.internal.__metadata__.metadata_object_number=this.internal.newObject(),this.internal.write("<< /Type /Metadata /Subtype /XML /Length "+c+" >>"),this.internal.write("stream"),this.internal.write(a+i+s+o+l),this.internal.write("endstream"),this.internal.write("endobj")},r=function(){this.internal.__metadata__.metadata_object_number&&this.internal.write("/Metadata "+this.internal.__metadata__.metadata_object_number+" 0 R")};e.addMetadata=function(n,a){return this.internal.__metadata__===void 0&&(this.internal.__metadata__={metadata:n,namespaceuri:a||"http://jspdf.default.namespaceuri/"},this.internal.events.subscribe("putCatalog",r),this.internal.events.subscribe("postPutResources",t)),this}}(vt.API),function(e){var t=e.API,r=t.pdfEscape16=function(i,s){for(var o,l=s.metadata.Unicode.widths,c=["","0","00","000","0000"],u=[""],f=0,p=i.length;f<p;++f){if(o=s.metadata.characterToGlyph(i.charCodeAt(f)),s.metadata.glyIdsUsed.push(o),s.metadata.toUnicode[o]=i.charCodeAt(f),l.indexOf(o)==-1&&(l.push(o),l.push([parseInt(s.metadata.widthOfGlyph(o),10)])),o=="0")return u.join("");o=o.toString(16),u.push(c[4-o.length],o)}return u.join("")},n=function(i){var s,o,l,c,u,f,p;for(u=`/CIDInit /ProcSet findresource begin
12 dict begin
begincmap
/CIDSystemInfo <<
  /Registry (Adobe)
  /Ordering (UCS)
  /Supplement 0
>> def
/CMapName /Adobe-Identity-UCS def
/CMapType 2 def
1 begincodespacerange
<0000><ffff>
endcodespacerange`,l=[],f=0,p=(o=Object.keys(i).sort(function(h,g){return h-g})).length;f<p;f++)s=o[f],l.length>=100&&(u+=`
`+l.length+` beginbfchar
`+l.join(`
`)+`
endbfchar`,l=[]),i[s]!==void 0&&i[s]!==null&&typeof i[s].toString=="function"&&(c=("0000"+i[s].toString(16)).slice(-4),s=("0000"+(+s).toString(16)).slice(-4),l.push("<"+s+"><"+c+">"));return l.length&&(u+=`
`+l.length+` beginbfchar
`+l.join(`
`)+`
endbfchar
`),u+=`endcmap
CMapName currentdict /CMap defineresource pop
end
end`};t.events.push(["putFont",function(i){(function(s){var o=s.font,l=s.out,c=s.newObject,u=s.putStream;if(o.metadata instanceof e.API.TTFFont&&o.encoding==="Identity-H"){for(var f=o.metadata.Unicode.widths,p=o.metadata.subset.encode(o.metadata.glyIdsUsed,1),h="",g=0;g<p.length;g++)h+=String.fromCharCode(p[g]);var m=c();u({data:h,addLength1:!0,objectId:m}),l("endobj");var b=c();u({data:n(o.metadata.toUnicode),addLength1:!0,objectId:b}),l("endobj");var x=c();l("<<"),l("/Type /FontDescriptor"),l("/FontName /"+Jc(o.fontName)),l("/FontFile2 "+m+" 0 R"),l("/FontBBox "+e.API.PDFObject.convert(o.metadata.bbox)),l("/Flags "+o.metadata.flags),l("/StemV "+o.metadata.stemV),l("/ItalicAngle "+o.metadata.italicAngle),l("/Ascent "+o.metadata.ascender),l("/Descent "+o.metadata.decender),l("/CapHeight "+o.metadata.capHeight),l(">>"),l("endobj");var w=c();l("<<"),l("/Type /Font"),l("/BaseFont /"+Jc(o.fontName)),l("/FontDescriptor "+x+" 0 R"),l("/W "+e.API.PDFObject.convert(f)),l("/CIDToGIDMap /Identity"),l("/DW 1000"),l("/Subtype /CIDFontType2"),l("/CIDSystemInfo"),l("<<"),l("/Supplement 0"),l("/Registry (Adobe)"),l("/Ordering ("+o.encoding+")"),l(">>"),l(">>"),l("endobj"),o.objectNumber=c(),l("<<"),l("/Type /Font"),l("/Subtype /Type0"),l("/ToUnicode "+b+" 0 R"),l("/BaseFont /"+Jc(o.fontName)),l("/Encoding /"+o.encoding),l("/DescendantFonts ["+w+" 0 R]"),l(">>"),l("endobj"),o.isAlreadyPutted=!0}})(i)}]),t.events.push(["putFont",function(i){(function(s){var o=s.font,l=s.out,c=s.newObject,u=s.putStream;if(o.metadata instanceof e.API.TTFFont&&o.encoding==="WinAnsiEncoding"){for(var f=o.metadata.rawData,p="",h=0;h<f.length;h++)p+=String.fromCharCode(f[h]);var g=c();u({data:p,addLength1:!0,objectId:g}),l("endobj");var m=c();u({data:n(o.metadata.toUnicode),addLength1:!0,objectId:m}),l("endobj");var b=c();l("<<"),l("/Descent "+o.metadata.decender),l("/CapHeight "+o.metadata.capHeight),l("/StemV "+o.metadata.stemV),l("/Type /FontDescriptor"),l("/FontFile2 "+g+" 0 R"),l("/Flags 96"),l("/FontBBox "+e.API.PDFObject.convert(o.metadata.bbox)),l("/FontName /"+Jc(o.fontName)),l("/ItalicAngle "+o.metadata.italicAngle),l("/Ascent "+o.metadata.ascender),l(">>"),l("endobj"),o.objectNumber=c();for(var x=0;x<o.metadata.hmtx.widths.length;x++)o.metadata.hmtx.widths[x]=parseInt(o.metadata.hmtx.widths[x]*(1e3/o.metadata.head.unitsPerEm));l("<</Subtype/TrueType/Type/Font/ToUnicode "+m+" 0 R/BaseFont/"+Jc(o.fontName)+"/FontDescriptor "+b+" 0 R/Encoding/"+o.encoding+" /FirstChar 29 /LastChar 255 /Widths "+e.API.PDFObject.convert(o.metadata.hmtx.widths)+">>"),l("endobj"),o.isAlreadyPutted=!0}})(i)}]);var a=function(i){var s,o=i.text||"",l=i.x,c=i.y,u=i.options||{},f=i.mutex||{},p=f.pdfEscape,h=f.activeFontKey,g=f.fonts,m=h,b="",x=0,w="",y=g[m].encoding;if(g[m].encoding!=="Identity-H")return{text:o,x:l,y:c,options:u,mutex:f};for(w=o,m=h,Array.isArray(o)&&(w=o[0]),x=0;x<w.length;x+=1)g[m].metadata.hasOwnProperty("cmap")&&(s=g[m].metadata.cmap.unicode.codeMap[w[x].charCodeAt(0)]),s||w[x].charCodeAt(0)<256&&g[m].metadata.hasOwnProperty("Unicode")?b+=w[x]:b+="";var A="";return parseInt(m.slice(1))<14||y==="WinAnsiEncoding"?A=p(b,m).split("").map(function(L){return L.charCodeAt(0).toString(16)}).join(""):y==="Identity-H"&&(A=r(b,g[m])),f.isHex=!0,{text:A,x:l,y:c,options:u,mutex:f}};t.events.push(["postProcessText",function(i){var s=i.text||"",o=[],l={text:s,x:i.x,y:i.y,options:i.options,mutex:i.mutex};if(Array.isArray(s)){var c=0;for(c=0;c<s.length;c+=1)Array.isArray(s[c])&&s[c].length===3?o.push([a(Object.assign({},l,{text:s[c][0]})).text,s[c][1],s[c][2]]):o.push(a(Object.assign({},l,{text:s[c]})).text);i.text=o}else i.text=a(Object.assign({},l,{text:s})).text}])}(vt),function(e){var t=function(){return this.internal.vFS===void 0&&(this.internal.vFS={}),!0};e.existsFileInVFS=function(r){return t.call(this),this.internal.vFS[r]!==void 0},e.addFileToVFS=function(r,n){return t.call(this),this.internal.vFS[r]=n,this},e.getFileFromVFS=function(r){return t.call(this),this.internal.vFS[r]!==void 0?this.internal.vFS[r]:null}}(vt.API),function(e){e.__bidiEngine__=e.prototype.__bidiEngine__=function(n){var a,i,s,o,l,c,u,f=t,p=[[0,3,0,1,0,0,0],[0,3,0,1,2,2,0],[0,3,0,17,2,0,1],[0,3,5,5,4,1,0],[0,3,21,21,4,0,1],[0,3,5,5,4,2,0]],h=[[2,0,1,1,0,1,0],[2,0,1,1,0,2,0],[2,0,2,1,3,2,0],[2,0,2,33,3,1,1]],g={L:0,R:1,EN:2,AN:3,N:4,B:5,S:6},m={0:0,5:1,6:2,7:3,32:4,251:5,254:6,255:7},b=["(",")","(","<",">","<","[","]","[","{","}","{","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","",""],x=new RegExp(/^([1-4|9]|1[0-9]|2[0-9]|3[0168]|4[04589]|5[012]|7[78]|159|16[0-9]|17[0-2]|21[569]|22[03489]|250)$/),w=!1,y=0;this.__bidiEngine__={};var A=function(N){var P=N.charCodeAt(),J=P>>8,W=m[J];return W!==void 0?f[256*W+(255&P)]:J===252||J===253?"AL":x.test(J)?"L":J===8?"R":"N"},L=function(N){for(var P,J=0;J<N.length;J++){if((P=A(N.charAt(J)))==="L")return!1;if(P==="R")return!0}return!1},D=function(N,P,J,W){var se,fe,U,Q,q=P[W];switch(q){case"L":case"R":w=!1;break;case"N":case"AN":break;case"EN":w&&(q="AN");break;case"AL":w=!0,q="R";break;case"WS":q="N";break;case"CS":W<1||W+1>=P.length||(se=J[W-1])!=="EN"&&se!=="AN"||(fe=P[W+1])!=="EN"&&fe!=="AN"?q="N":w&&(fe="AN"),q=fe===se?fe:"N";break;case"ES":q=(se=W>0?J[W-1]:"B")==="EN"&&W+1<P.length&&P[W+1]==="EN"?"EN":"N";break;case"ET":if(W>0&&J[W-1]==="EN"){q="EN";break}if(w){q="N";break}for(U=W+1,Q=P.length;U<Q&&P[U]==="ET";)U++;q=U<Q&&P[U]==="EN"?"EN":"N";break;case"NSM":if(s&&!o){for(Q=P.length,U=W+1;U<Q&&P[U]==="NSM";)U++;if(U<Q){var he=N[W],xe=he>=1425&&he<=2303||he===64286;if(se=P[U],xe&&(se==="R"||se==="AL")){q="R";break}}}q=W<1||(se=P[W-1])==="B"?"N":J[W-1];break;case"B":w=!1,a=!0,q=y;break;case"S":i=!0,q="N";break;case"LRE":case"RLE":case"LRO":case"RLO":case"PDF":w=!1;break;case"BN":q="N"}return q},T=function(N,P,J){var W=N.split("");return J&&F(W,J,{hiLevel:y}),W.reverse(),P&&P.reverse(),W.join("")},F=function(N,P,J){var W,se,fe,U,Q,q=-1,he=N.length,xe=0,E=[],I=y?h:p,O=[];for(w=!1,a=!1,i=!1,se=0;se<he;se++)O[se]=A(N[se]);for(fe=0;fe<he;fe++){if(Q=xe,E[fe]=D(N,O,E,fe),W=240&(xe=I[Q][g[E[fe]]]),xe&=15,P[fe]=U=I[xe][5],W>0)if(W===16){for(se=q;se<fe;se++)P[se]=1;q=-1}else q=-1;if(I[xe][6])q===-1&&(q=fe);else if(q>-1){for(se=q;se<fe;se++)P[se]=U;q=-1}O[fe]==="B"&&(P[fe]=0),J.hiLevel|=U}i&&function(j,K,ne){for(var pe=0;pe<ne;pe++)if(j[pe]==="S"){K[pe]=y;for(var de=pe-1;de>=0&&j[de]==="WS";de--)K[de]=y}}(O,P,he)},R=function(N,P,J,W,se){if(!(se.hiLevel<N)){if(N===1&&y===1&&!a)return P.reverse(),void(J&&J.reverse());for(var fe,U,Q,q,he=P.length,xe=0;xe<he;){if(W[xe]>=N){for(Q=xe+1;Q<he&&W[Q]>=N;)Q++;for(q=xe,U=Q-1;q<U;q++,U--)fe=P[q],P[q]=P[U],P[U]=fe,J&&(fe=J[q],J[q]=J[U],J[U]=fe);xe=Q}xe++}}},X=function(N,P,J){var W=N.split(""),se={hiLevel:y};return J||(J=[]),F(W,J,se),function(fe,U,Q){if(Q.hiLevel!==0&&u)for(var q,he=0;he<fe.length;he++)U[he]===1&&(q=b.indexOf(fe[he]))>=0&&(fe[he]=b[q+1])}(W,J,se),R(2,W,P,J,se),R(1,W,P,J,se),W.join("")};return this.__bidiEngine__.doBidiReorder=function(N,P,J){if(function(se,fe){if(fe)for(var U=0;U<se.length;U++)fe[U]=U;o===void 0&&(o=L(se)),c===void 0&&(c=L(se))}(N,P),s||!l||c)if(s&&l&&o^c)y=o?1:0,N=T(N,P,J);else if(!s&&l&&c)y=o?1:0,N=X(N,P,J),N=T(N,P);else if(!s||o||l||c){if(s&&!l&&o^c)N=T(N,P),o?(y=0,N=X(N,P,J)):(y=1,N=X(N,P,J),N=T(N,P));else if(s&&o&&!l&&c)y=1,N=X(N,P,J),N=T(N,P);else if(!s&&!l&&o^c){var W=u;o?(y=1,N=X(N,P,J),y=0,u=!1,N=X(N,P,J),u=W):(y=0,N=X(N,P,J),N=T(N,P),y=1,u=!1,N=X(N,P,J),u=W,N=T(N,P))}}else y=0,N=X(N,P,J);else y=o?1:0,N=X(N,P,J);return N},this.__bidiEngine__.setOptions=function(N){N&&(s=N.isInputVisual,l=N.isOutputVisual,o=N.isInputRtl,c=N.isOutputRtl,u=N.isSymmetricSwapping)},this.__bidiEngine__.setOptions(n),this.__bidiEngine__};var t=["BN","BN","BN","BN","BN","BN","BN","BN","BN","S","B","S","WS","B","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","B","B","B","S","WS","N","N","ET","ET","ET","N","N","N","N","N","ES","CS","ES","CS","CS","EN","EN","EN","EN","EN","EN","EN","EN","EN","EN","CS","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","N","BN","BN","BN","BN","BN","BN","B","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","CS","N","ET","ET","ET","ET","N","N","N","N","L","N","N","BN","N","N","ET","ET","EN","EN","N","L","N","N","N","EN","L","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","L","L","L","L","L","L","L","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","L","N","N","N","N","N","ET","N","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","R","NSM","R","NSM","NSM","R","NSM","NSM","R","NSM","N","N","N","N","N","N","N","N","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","N","N","N","N","N","R","R","R","R","R","N","N","N","N","N","N","N","N","N","N","N","AN","AN","AN","AN","AN","AN","N","N","AL","ET","ET","AL","CS","AL","N","N","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","AL","AL","N","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","AN","AN","AN","AN","AN","AN","AN","AN","AN","AN","ET","AN","AN","AL","AL","AL","NSM","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","AN","N","NSM","NSM","NSM","NSM","NSM","NSM","AL","AL","NSM","NSM","N","NSM","NSM","NSM","NSM","AL","AL","EN","EN","EN","EN","EN","EN","EN","EN","EN","EN","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","N","AL","AL","NSM","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","N","N","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","AL","N","N","N","N","N","N","N","N","N","N","N","N","N","N","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","R","R","N","N","N","N","R","N","N","N","N","N","WS","WS","WS","WS","WS","WS","WS","WS","WS","WS","WS","BN","BN","BN","L","R","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","WS","B","LRE","RLE","PDF","LRO","RLO","CS","ET","ET","ET","ET","ET","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","CS","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","WS","BN","BN","BN","BN","BN","N","LRI","RLI","FSI","PDI","BN","BN","BN","BN","BN","BN","EN","L","N","N","EN","EN","EN","EN","EN","EN","ES","ES","N","N","N","L","EN","EN","EN","EN","EN","EN","EN","EN","EN","EN","ES","ES","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","L","L","L","L","L","L","L","N","N","N","N","N","N","N","N","N","N","N","N","L","L","L","L","L","N","N","N","N","N","R","NSM","R","R","R","R","R","R","R","R","R","R","ES","R","R","R","R","R","R","R","R","R","R","R","R","R","N","R","R","R","R","R","N","R","N","R","R","N","R","R","N","R","R","R","R","R","R","R","R","R","R","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","CS","N","CS","N","N","CS","N","N","N","N","N","N","N","N","N","ET","N","N","ES","ES","N","N","N","N","N","ET","ET","N","N","N","N","N","AL","AL","AL","AL","AL","N","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","N","N","BN","N","N","N","ET","ET","ET","N","N","N","N","N","ES","CS","ES","CS","CS","EN","EN","EN","EN","EN","EN","EN","EN","EN","EN","CS","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","N","N","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","L","L","L","L","L","L","N","N","L","L","L","L","L","L","N","N","L","L","L","L","L","L","N","N","L","L","L","N","N","N","ET","ET","N","N","N","ET","ET","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N"],r=new e.__bidiEngine__({isInputVisual:!0});e.API.events.push(["postProcessText",function(n){var a=n.text;n.x,n.y;var i=n.options||{};n.mutex,i.lang;var s=[];if(i.isInputVisual=typeof i.isInputVisual!="boolean"||i.isInputVisual,r.setOptions(i),Object.prototype.toString.call(a)==="[object Array]"){var o=0;for(s=[],o=0;o<a.length;o+=1)Object.prototype.toString.call(a[o])==="[object Array]"?s.push([r.doBidiReorder(a[o][0]),a[o][1],a[o][2]]):s.push([r.doBidiReorder(a[o])]);n.text=s}else n.text=r.doBidiReorder(a);r.setOptions({isInputVisual:!0})}])}(vt),vt.API.TTFFont=function(){function e(t){var r;if(this.rawData=t,r=this.contents=new il(t),this.contents.pos=4,r.readString(4)==="ttcf")throw new Error("TTCF not supported.");r.pos=0,this.parse(),this.subset=new XX(this),this.registerTTF()}return e.open=function(t){return new e(t)},e.prototype.parse=function(){return this.directory=new IX(this.contents),this.head=new jX(this),this.name=new $X(this),this.cmap=new DC(this),this.toUnicode={},this.hhea=new MX(this),this.maxp=new zX(this),this.hmtx=new HX(this),this.post=new UX(this),this.os2=new BX(this),this.loca=new KX(this),this.glyf=new WX(this),this.ascender=this.os2.exists&&this.os2.ascender||this.hhea.ascender,this.decender=this.os2.exists&&this.os2.decender||this.hhea.decender,this.lineGap=this.os2.exists&&this.os2.lineGap||this.hhea.lineGap,this.bbox=[this.head.xMin,this.head.yMin,this.head.xMax,this.head.yMax]},e.prototype.registerTTF=function(){var t,r,n,a,i;if(this.scaleFactor=1e3/this.head.unitsPerEm,this.bbox=(function(){var s,o,l,c;for(c=[],s=0,o=(l=this.bbox).length;s<o;s++)t=l[s],c.push(Math.round(t*this.scaleFactor));return c}).call(this),this.stemV=0,this.post.exists?(n=255&(a=this.post.italic_angle),32768&(r=a>>16)&&(r=-(1+(65535^r))),this.italicAngle=+(r+"."+n)):this.italicAngle=0,this.ascender=Math.round(this.ascender*this.scaleFactor),this.decender=Math.round(this.decender*this.scaleFactor),this.lineGap=Math.round(this.lineGap*this.scaleFactor),this.capHeight=this.os2.exists&&this.os2.capHeight||this.ascender,this.xHeight=this.os2.exists&&this.os2.xHeight||0,this.familyClass=(this.os2.exists&&this.os2.familyClass||0)>>8,this.isSerif=(i=this.familyClass)===1||i===2||i===3||i===4||i===5||i===7,this.isScript=this.familyClass===10,this.flags=0,this.post.isFixedPitch&&(this.flags|=1),this.isSerif&&(this.flags|=2),this.isScript&&(this.flags|=8),this.italicAngle!==0&&(this.flags|=64),this.flags|=32,!this.cmap.unicode)throw new Error("No unicode cmap for font")},e.prototype.characterToGlyph=function(t){var r;return((r=this.cmap.unicode)!=null?r.codeMap[t]:void 0)||0},e.prototype.widthOfGlyph=function(t){var r;return r=1e3/this.head.unitsPerEm,this.hmtx.forGlyph(t).advance*r},e.prototype.widthOfString=function(t,r,n){var a,i,s,o;for(s=0,i=0,o=(t=""+t).length;0<=o?i<o:i>o;i=0<=o?++i:--i)a=t.charCodeAt(i),s+=this.widthOfGlyph(this.characterToGlyph(a))+n*(1e3/r)||0;return s*(r/1e3)},e.prototype.lineHeight=function(t,r){var n;return r==null&&(r=!1),n=r?this.lineGap:0,(this.ascender+n-this.decender)/1e3*t},e}();var Wi,il=function(){function e(t){this.data=t??[],this.pos=0,this.length=this.data.length}return e.prototype.readByte=function(){return this.data[this.pos++]},e.prototype.writeByte=function(t){return this.data[this.pos++]=t},e.prototype.readUInt32=function(){return 16777216*this.readByte()+(this.readByte()<<16)+(this.readByte()<<8)+this.readByte()},e.prototype.writeUInt32=function(t){return this.writeByte(t>>>24&255),this.writeByte(t>>16&255),this.writeByte(t>>8&255),this.writeByte(255&t)},e.prototype.readInt32=function(){var t;return(t=this.readUInt32())>=2147483648?t-4294967296:t},e.prototype.writeInt32=function(t){return t<0&&(t+=4294967296),this.writeUInt32(t)},e.prototype.readUInt16=function(){return this.readByte()<<8|this.readByte()},e.prototype.writeUInt16=function(t){return this.writeByte(t>>8&255),this.writeByte(255&t)},e.prototype.readInt16=function(){var t;return(t=this.readUInt16())>=32768?t-65536:t},e.prototype.writeInt16=function(t){return t<0&&(t+=65536),this.writeUInt16(t)},e.prototype.readString=function(t){var r,n;for(n=[],r=0;0<=t?r<t:r>t;r=0<=t?++r:--r)n[r]=String.fromCharCode(this.readByte());return n.join("")},e.prototype.writeString=function(t){var r,n,a;for(a=[],r=0,n=t.length;0<=n?r<n:r>n;r=0<=n?++r:--r)a.push(this.writeByte(t.charCodeAt(r)));return a},e.prototype.readShort=function(){return this.readInt16()},e.prototype.writeShort=function(t){return this.writeInt16(t)},e.prototype.readLongLong=function(){var t,r,n,a,i,s,o,l;return t=this.readByte(),r=this.readByte(),n=this.readByte(),a=this.readByte(),i=this.readByte(),s=this.readByte(),o=this.readByte(),l=this.readByte(),128&t?-1*(72057594037927940*(255^t)+281474976710656*(255^r)+1099511627776*(255^n)+4294967296*(255^a)+16777216*(255^i)+65536*(255^s)+256*(255^o)+(255^l)+1):72057594037927940*t+281474976710656*r+1099511627776*n+4294967296*a+16777216*i+65536*s+256*o+l},e.prototype.writeLongLong=function(t){var r,n;return r=Math.floor(t/4294967296),n=4294967295&t,this.writeByte(r>>24&255),this.writeByte(r>>16&255),this.writeByte(r>>8&255),this.writeByte(255&r),this.writeByte(n>>24&255),this.writeByte(n>>16&255),this.writeByte(n>>8&255),this.writeByte(255&n)},e.prototype.readInt=function(){return this.readInt32()},e.prototype.writeInt=function(t){return this.writeInt32(t)},e.prototype.read=function(t){var r,n;for(r=[],n=0;0<=t?n<t:n>t;n=0<=t?++n:--n)r.push(this.readByte());return r},e.prototype.write=function(t){var r,n,a,i;for(i=[],n=0,a=t.length;n<a;n++)r=t[n],i.push(this.writeByte(r));return i},e}(),IX=function(){var e;function t(r){var n,a,i;for(this.scalarType=r.readInt(),this.tableCount=r.readShort(),this.searchRange=r.readShort(),this.entrySelector=r.readShort(),this.rangeShift=r.readShort(),this.tables={},a=0,i=this.tableCount;0<=i?a<i:a>i;a=0<=i?++a:--a)n={tag:r.readString(4),checksum:r.readInt(),offset:r.readInt(),length:r.readInt()},this.tables[n.tag]=n}return t.prototype.encode=function(r){var n,a,i,s,o,l,c,u,f,p,h,g,m;for(m in h=Object.keys(r).length,l=Math.log(2),f=16*Math.floor(Math.log(h)/l),s=Math.floor(f/l),u=16*h-f,(a=new il).writeInt(this.scalarType),a.writeShort(h),a.writeShort(f),a.writeShort(s),a.writeShort(u),i=16*h,c=a.pos+i,o=null,g=[],r)for(p=r[m],a.writeString(m),a.writeInt(e(p)),a.writeInt(c),a.writeInt(p.length),g=g.concat(p),m==="head"&&(o=c),c+=p.length;c%4;)g.push(0),c++;return a.write(g),n=2981146554-e(a.data),a.pos=o+8,a.writeUInt32(n),a.data},e=function(r){var n,a,i,s;for(r=IC.call(r);r.length%4;)r.push(0);for(i=new il(r),a=0,n=0,s=r.length;n<s;n=n+=4)a+=i.readUInt32();return 4294967295&a},t}(),RX={}.hasOwnProperty,vs=function(e,t){for(var r in t)RX.call(t,r)&&(e[r]=t[r]);function n(){this.constructor=e}return n.prototype=t.prototype,e.prototype=new n,e.__super__=t.prototype,e};Wi=function(){function e(t){var r;this.file=t,r=this.file.directory.tables[this.tag],this.exists=!!r,r&&(this.offset=r.offset,this.length=r.length,this.parse(this.file.contents))}return e.prototype.parse=function(){},e.prototype.encode=function(){},e.prototype.raw=function(){return this.exists?(this.file.contents.pos=this.offset,this.file.contents.read(this.length)):null},e}();var jX=function(e){function t(){return t.__super__.constructor.apply(this,arguments)}return vs(t,Wi),t.prototype.tag="head",t.prototype.parse=function(r){return r.pos=this.offset,this.version=r.readInt(),this.revision=r.readInt(),this.checkSumAdjustment=r.readInt(),this.magicNumber=r.readInt(),this.flags=r.readShort(),this.unitsPerEm=r.readShort(),this.created=r.readLongLong(),this.modified=r.readLongLong(),this.xMin=r.readShort(),this.yMin=r.readShort(),this.xMax=r.readShort(),this.yMax=r.readShort(),this.macStyle=r.readShort(),this.lowestRecPPEM=r.readShort(),this.fontDirectionHint=r.readShort(),this.indexToLocFormat=r.readShort(),this.glyphDataFormat=r.readShort()},t.prototype.encode=function(r){var n;return(n=new il).writeInt(this.version),n.writeInt(this.revision),n.writeInt(this.checkSumAdjustment),n.writeInt(this.magicNumber),n.writeShort(this.flags),n.writeShort(this.unitsPerEm),n.writeLongLong(this.created),n.writeLongLong(this.modified),n.writeShort(this.xMin),n.writeShort(this.yMin),n.writeShort(this.xMax),n.writeShort(this.yMax),n.writeShort(this.macStyle),n.writeShort(this.lowestRecPPEM),n.writeShort(this.fontDirectionHint),n.writeShort(r),n.writeShort(this.glyphDataFormat),n.data},t}(),N_=function(){function e(t,r){var n,a,i,s,o,l,c,u,f,p,h,g,m,b,x,w,y;switch(this.platformID=t.readUInt16(),this.encodingID=t.readShort(),this.offset=r+t.readInt(),f=t.pos,t.pos=this.offset,this.format=t.readUInt16(),this.length=t.readUInt16(),this.language=t.readUInt16(),this.isUnicode=this.platformID===3&&this.encodingID===1&&this.format===4||this.platformID===0&&this.format===4,this.codeMap={},this.format){case 0:for(l=0;l<256;++l)this.codeMap[l]=t.readByte();break;case 4:for(h=t.readUInt16(),p=h/2,t.pos+=6,i=function(){var A,L;for(L=[],l=A=0;0<=p?A<p:A>p;l=0<=p?++A:--A)L.push(t.readUInt16());return L}(),t.pos+=2,m=function(){var A,L;for(L=[],l=A=0;0<=p?A<p:A>p;l=0<=p?++A:--A)L.push(t.readUInt16());return L}(),c=function(){var A,L;for(L=[],l=A=0;0<=p?A<p:A>p;l=0<=p?++A:--A)L.push(t.readUInt16());return L}(),u=function(){var A,L;for(L=[],l=A=0;0<=p?A<p:A>p;l=0<=p?++A:--A)L.push(t.readUInt16());return L}(),a=(this.length-t.pos+this.offset)/2,o=function(){var A,L;for(L=[],l=A=0;0<=a?A<a:A>a;l=0<=a?++A:--A)L.push(t.readUInt16());return L}(),l=x=0,y=i.length;x<y;l=++x)for(b=i[l],n=w=g=m[l];g<=b?w<=b:w>=b;n=g<=b?++w:--w)u[l]===0?s=n+c[l]:(s=o[u[l]/2+(n-g)-(p-l)]||0)!==0&&(s+=c[l]),this.codeMap[n]=65535&s}t.pos=f}return e.encode=function(t,r){var n,a,i,s,o,l,c,u,f,p,h,g,m,b,x,w,y,A,L,D,T,F,R,X,N,P,J,W,se,fe,U,Q,q,he,xe,E,I,O,j,K,ne,pe,de,we,Pe,Z;switch(W=new il,s=Object.keys(t).sort(function(Ve,Ke){return Ve-Ke}),r){case"macroman":for(m=0,b=function(){var Ve=[];for(g=0;g<256;++g)Ve.push(0);return Ve}(),w={0:0},i={},se=0,q=s.length;se<q;se++)w[de=t[a=s[se]]]==null&&(w[de]=++m),i[a]={old:t[a],new:w[t[a]]},b[a]=w[t[a]];return W.writeUInt16(1),W.writeUInt16(0),W.writeUInt32(12),W.writeUInt16(0),W.writeUInt16(262),W.writeUInt16(0),W.write(b),{charMap:i,subtable:W.data,maxGlyphID:m+1};case"unicode":for(P=[],f=[],y=0,w={},n={},x=c=null,fe=0,he=s.length;fe<he;fe++)w[L=t[a=s[fe]]]==null&&(w[L]=++y),n[a]={old:L,new:w[L]},o=w[L]-a,x!=null&&o===c||(x&&f.push(x),P.push(a),c=o),x=a;for(x&&f.push(x),f.push(65535),P.push(65535),X=2*(R=P.length),F=2*Math.pow(Math.log(R)/Math.LN2,2),p=Math.log(F/2)/Math.LN2,T=2*R-F,l=[],D=[],h=[],g=U=0,xe=P.length;U<xe;g=++U){if(N=P[g],u=f[g],N===65535){l.push(0),D.push(0);break}if(N-(J=n[N].new)>=32768)for(l.push(0),D.push(2*(h.length+R-g)),a=Q=N;N<=u?Q<=u:Q>=u;a=N<=u?++Q:--Q)h.push(n[a].new);else l.push(J-N),D.push(0)}for(W.writeUInt16(3),W.writeUInt16(1),W.writeUInt32(12),W.writeUInt16(4),W.writeUInt16(16+8*R+2*h.length),W.writeUInt16(0),W.writeUInt16(X),W.writeUInt16(F),W.writeUInt16(p),W.writeUInt16(T),ne=0,E=f.length;ne<E;ne++)a=f[ne],W.writeUInt16(a);for(W.writeUInt16(0),pe=0,I=P.length;pe<I;pe++)a=P[pe],W.writeUInt16(a);for(we=0,O=l.length;we<O;we++)o=l[we],W.writeUInt16(o);for(Pe=0,j=D.length;Pe<j;Pe++)A=D[Pe],W.writeUInt16(A);for(Z=0,K=h.length;Z<K;Z++)m=h[Z],W.writeUInt16(m);return{charMap:n,subtable:W.data,maxGlyphID:y+1}}},e}(),DC=function(e){function t(){return t.__super__.constructor.apply(this,arguments)}return vs(t,Wi),t.prototype.tag="cmap",t.prototype.parse=function(r){var n,a,i;for(r.pos=this.offset,this.version=r.readUInt16(),i=r.readUInt16(),this.tables=[],this.unicode=null,a=0;0<=i?a<i:a>i;a=0<=i?++a:--a)n=new N_(r,this.offset),this.tables.push(n),n.isUnicode&&this.unicode==null&&(this.unicode=n);return!0},t.encode=function(r,n){var a,i;return n==null&&(n="macroman"),a=N_.encode(r,n),(i=new il).writeUInt16(0),i.writeUInt16(1),a.table=i.data.concat(a.subtable),a},t}(),MX=function(e){function t(){return t.__super__.constructor.apply(this,arguments)}return vs(t,Wi),t.prototype.tag="hhea",t.prototype.parse=function(r){return r.pos=this.offset,this.version=r.readInt(),this.ascender=r.readShort(),this.decender=r.readShort(),this.lineGap=r.readShort(),this.advanceWidthMax=r.readShort(),this.minLeftSideBearing=r.readShort(),this.minRightSideBearing=r.readShort(),this.xMaxExtent=r.readShort(),this.caretSlopeRise=r.readShort(),this.caretSlopeRun=r.readShort(),this.caretOffset=r.readShort(),r.pos+=8,this.metricDataFormat=r.readShort(),this.numberOfMetrics=r.readUInt16()},t}(),BX=function(e){function t(){return t.__super__.constructor.apply(this,arguments)}return vs(t,Wi),t.prototype.tag="OS/2",t.prototype.parse=function(r){if(r.pos=this.offset,this.version=r.readUInt16(),this.averageCharWidth=r.readShort(),this.weightClass=r.readUInt16(),this.widthClass=r.readUInt16(),this.type=r.readShort(),this.ySubscriptXSize=r.readShort(),this.ySubscriptYSize=r.readShort(),this.ySubscriptXOffset=r.readShort(),this.ySubscriptYOffset=r.readShort(),this.ySuperscriptXSize=r.readShort(),this.ySuperscriptYSize=r.readShort(),this.ySuperscriptXOffset=r.readShort(),this.ySuperscriptYOffset=r.readShort(),this.yStrikeoutSize=r.readShort(),this.yStrikeoutPosition=r.readShort(),this.familyClass=r.readShort(),this.panose=function(){var n,a;for(a=[],n=0;n<10;++n)a.push(r.readByte());return a}(),this.charRange=function(){var n,a;for(a=[],n=0;n<4;++n)a.push(r.readInt());return a}(),this.vendorID=r.readString(4),this.selection=r.readShort(),this.firstCharIndex=r.readShort(),this.lastCharIndex=r.readShort(),this.version>0&&(this.ascent=r.readShort(),this.descent=r.readShort(),this.lineGap=r.readShort(),this.winAscent=r.readShort(),this.winDescent=r.readShort(),this.codePageRange=function(){var n,a;for(a=[],n=0;n<2;n=++n)a.push(r.readInt());return a}(),this.version>1))return this.xHeight=r.readShort(),this.capHeight=r.readShort(),this.defaultChar=r.readShort(),this.breakChar=r.readShort(),this.maxContext=r.readShort()},t}(),UX=function(e){function t(){return t.__super__.constructor.apply(this,arguments)}return vs(t,Wi),t.prototype.tag="post",t.prototype.parse=function(r){var n,a,i;switch(r.pos=this.offset,this.format=r.readInt(),this.italicAngle=r.readInt(),this.underlinePosition=r.readShort(),this.underlineThickness=r.readShort(),this.isFixedPitch=r.readInt(),this.minMemType42=r.readInt(),this.maxMemType42=r.readInt(),this.minMemType1=r.readInt(),this.maxMemType1=r.readInt(),this.format){case 65536:break;case 131072:var s;for(a=r.readUInt16(),this.glyphNameIndex=[],s=0;0<=a?s<a:s>a;s=0<=a?++s:--s)this.glyphNameIndex.push(r.readUInt16());for(this.names=[],i=[];r.pos<this.offset+this.length;)n=r.readByte(),i.push(this.names.push(r.readString(n)));return i;case 151552:return a=r.readUInt16(),this.offsets=r.read(a);case 196608:break;case 262144:return this.map=(function(){var o,l,c;for(c=[],s=o=0,l=this.file.maxp.numGlyphs;0<=l?o<l:o>l;s=0<=l?++o:--o)c.push(r.readUInt32());return c}).call(this)}},t}(),VX=function(e,t){this.raw=e,this.length=e.length,this.platformID=t.platformID,this.encodingID=t.encodingID,this.languageID=t.languageID},$X=function(e){function t(){return t.__super__.constructor.apply(this,arguments)}return vs(t,Wi),t.prototype.tag="name",t.prototype.parse=function(r){var n,a,i,s,o,l,c,u,f,p,h;for(r.pos=this.offset,r.readShort(),n=r.readShort(),l=r.readShort(),a=[],s=0;0<=n?s<n:s>n;s=0<=n?++s:--s)a.push({platformID:r.readShort(),encodingID:r.readShort(),languageID:r.readShort(),nameID:r.readShort(),length:r.readShort(),offset:this.offset+l+r.readShort()});for(c={},s=f=0,p=a.length;f<p;s=++f)i=a[s],r.pos=i.offset,u=r.readString(i.length),o=new VX(u,i),c[h=i.nameID]==null&&(c[h]=[]),c[i.nameID].push(o);this.strings=c,this.copyright=c[0],this.fontFamily=c[1],this.fontSubfamily=c[2],this.uniqueSubfamily=c[3],this.fontName=c[4],this.version=c[5];try{this.postscriptName=c[6][0].raw.replace(/[\x00-\x19\x80-\xff]/g,"")}catch{this.postscriptName=c[4][0].raw.replace(/[\x00-\x19\x80-\xff]/g,"")}return this.trademark=c[7],this.manufacturer=c[8],this.designer=c[9],this.description=c[10],this.vendorUrl=c[11],this.designerUrl=c[12],this.license=c[13],this.licenseUrl=c[14],this.preferredFamily=c[15],this.preferredSubfamily=c[17],this.compatibleFull=c[18],this.sampleText=c[19]},t}(),zX=function(e){function t(){return t.__super__.constructor.apply(this,arguments)}return vs(t,Wi),t.prototype.tag="maxp",t.prototype.parse=function(r){return r.pos=this.offset,this.version=r.readInt(),this.numGlyphs=r.readUInt16(),this.maxPoints=r.readUInt16(),this.maxContours=r.readUInt16(),this.maxCompositePoints=r.readUInt16(),this.maxComponentContours=r.readUInt16(),this.maxZones=r.readUInt16(),this.maxTwilightPoints=r.readUInt16(),this.maxStorage=r.readUInt16(),this.maxFunctionDefs=r.readUInt16(),this.maxInstructionDefs=r.readUInt16(),this.maxStackElements=r.readUInt16(),this.maxSizeOfInstructions=r.readUInt16(),this.maxComponentElements=r.readUInt16(),this.maxComponentDepth=r.readUInt16()},t}(),HX=function(e){function t(){return t.__super__.constructor.apply(this,arguments)}return vs(t,Wi),t.prototype.tag="hmtx",t.prototype.parse=function(r){var n,a,i,s,o,l,c;for(r.pos=this.offset,this.metrics=[],n=0,l=this.file.hhea.numberOfMetrics;0<=l?n<l:n>l;n=0<=l?++n:--n)this.metrics.push({advance:r.readUInt16(),lsb:r.readInt16()});for(i=this.file.maxp.numGlyphs-this.file.hhea.numberOfMetrics,this.leftSideBearings=function(){var u,f;for(f=[],n=u=0;0<=i?u<i:u>i;n=0<=i?++u:--u)f.push(r.readInt16());return f}(),this.widths=(function(){var u,f,p,h;for(h=[],u=0,f=(p=this.metrics).length;u<f;u++)s=p[u],h.push(s.advance);return h}).call(this),a=this.widths[this.widths.length-1],c=[],n=o=0;0<=i?o<i:o>i;n=0<=i?++o:--o)c.push(this.widths.push(a));return c},t.prototype.forGlyph=function(r){return r in this.metrics?this.metrics[r]:{advance:this.metrics[this.metrics.length-1].advance,lsb:this.leftSideBearings[r-this.metrics.length]}},t}(),IC=[].slice,WX=function(e){function t(){return t.__super__.constructor.apply(this,arguments)}return vs(t,Wi),t.prototype.tag="glyf",t.prototype.parse=function(){return this.cache={}},t.prototype.glyphFor=function(r){var n,a,i,s,o,l,c,u,f,p;return r in this.cache?this.cache[r]:(s=this.file.loca,n=this.file.contents,a=s.indexOf(r),(i=s.lengthOf(r))===0?this.cache[r]=null:(n.pos=this.offset+a,o=(l=new il(n.read(i))).readShort(),u=l.readShort(),p=l.readShort(),c=l.readShort(),f=l.readShort(),this.cache[r]=o===-1?new GX(l,u,p,c,f):new qX(l,o,u,p,c,f),this.cache[r]))},t.prototype.encode=function(r,n,a){var i,s,o,l,c;for(o=[],s=[],l=0,c=n.length;l<c;l++)i=r[n[l]],s.push(o.length),i&&(o=o.concat(i.encode(a)));return s.push(o.length),{table:o,offsets:s}},t}(),qX=function(){function e(t,r,n,a,i,s){this.raw=t,this.numberOfContours=r,this.xMin=n,this.yMin=a,this.xMax=i,this.yMax=s,this.compound=!1}return e.prototype.encode=function(){return this.raw.data},e}(),GX=function(){function e(t,r,n,a,i){var s,o;for(this.raw=t,this.xMin=r,this.yMin=n,this.xMax=a,this.yMax=i,this.compound=!0,this.glyphIDs=[],this.glyphOffsets=[],s=this.raw;o=s.readShort(),this.glyphOffsets.push(s.pos),this.glyphIDs.push(s.readUInt16()),32&o;)s.pos+=1&o?4:2,128&o?s.pos+=8:64&o?s.pos+=4:8&o&&(s.pos+=2)}return e.prototype.encode=function(){var t,r,n;for(r=new il(IC.call(this.raw.data)),t=0,n=this.glyphIDs.length;t<n;++t)r.pos=this.glyphOffsets[t];return r.data},e}(),KX=function(e){function t(){return t.__super__.constructor.apply(this,arguments)}return vs(t,Wi),t.prototype.tag="loca",t.prototype.parse=function(r){var n,a;return r.pos=this.offset,n=this.file.head.indexToLocFormat,this.offsets=n===0?(function(){var i,s;for(s=[],a=0,i=this.length;a<i;a+=2)s.push(2*r.readUInt16());return s}).call(this):(function(){var i,s;for(s=[],a=0,i=this.length;a<i;a+=4)s.push(r.readUInt32());return s}).call(this)},t.prototype.indexOf=function(r){return this.offsets[r]},t.prototype.lengthOf=function(r){return this.offsets[r+1]-this.offsets[r]},t.prototype.encode=function(r,n){for(var a=new Uint32Array(this.offsets.length),i=0,s=0,o=0;o<a.length;++o)if(a[o]=i,s<n.length&&n[s]==o){++s,a[o]=i;var l=this.offsets[o],c=this.offsets[o+1]-l;c>0&&(i+=c)}for(var u=new Array(4*a.length),f=0;f<a.length;++f)u[4*f+3]=255&a[f],u[4*f+2]=(65280&a[f])>>8,u[4*f+1]=(16711680&a[f])>>16,u[4*f]=(4278190080&a[f])>>24;return u},t}(),XX=function(){function e(t){this.font=t,this.subset={},this.unicodes={},this.next=33}return e.prototype.generateCmap=function(){var t,r,n,a,i;for(r in a=this.font.cmap.tables[0].codeMap,t={},i=this.subset)n=i[r],t[r]=a[n];return t},e.prototype.glyphsFor=function(t){var r,n,a,i,s,o,l;for(a={},s=0,o=t.length;s<o;s++)a[i=t[s]]=this.font.glyf.glyphFor(i);for(i in r=[],a)(n=a[i])!=null&&n.compound&&r.push.apply(r,n.glyphIDs);if(r.length>0)for(i in l=this.glyphsFor(r))n=l[i],a[i]=n;return a},e.prototype.encode=function(t,r){var n,a,i,s,o,l,c,u,f,p,h,g,m,b,x;for(a in n=DC.encode(this.generateCmap(),"unicode"),s=this.glyphsFor(t),h={0:0},x=n.charMap)h[(l=x[a]).old]=l.new;for(g in p=n.maxGlyphID,s)g in h||(h[g]=p++);return u=function(w){var y,A;for(y in A={},w)A[w[y]]=y;return A}(h),f=Object.keys(u).sort(function(w,y){return w-y}),m=function(){var w,y,A;for(A=[],w=0,y=f.length;w<y;w++)o=f[w],A.push(u[o]);return A}(),i=this.font.glyf.encode(s,m,h),c=this.font.loca.encode(i.offsets,m),b={cmap:this.font.cmap.raw(),glyf:i.table,loca:c,hmtx:this.font.hmtx.raw(),hhea:this.font.hhea.raw(),maxp:this.font.maxp.raw(),post:this.font.post.raw(),name:this.font.name.raw(),head:this.font.head.encode(r)},this.font.os2.exists&&(b["OS/2"]=this.font.os2.raw()),this.font.directory.encode(b)},e}();vt.API.PDFObject=function(){var e;function t(){}return e=function(r,n){return(Array(n+1).join("0")+r).slice(-n)},t.convert=function(r){var n,a,i,s;if(Array.isArray(r))return"["+function(){var o,l,c;for(c=[],o=0,l=r.length;o<l;o++)n=r[o],c.push(t.convert(n));return c}().join(" ")+"]";if(typeof r=="string")return"/"+r;if(r!=null&&r.isString)return"("+r+")";if(r instanceof Date)return"(D:"+e(r.getUTCFullYear(),4)+e(r.getUTCMonth(),2)+e(r.getUTCDate(),2)+e(r.getUTCHours(),2)+e(r.getUTCMinutes(),2)+e(r.getUTCSeconds(),2)+"Z)";if({}.toString.call(r)==="[object Object]"){for(a in i=["<<"],r)s=r[a],i.push("/"+a+" "+t.convert(s));return i.push(">>"),i.join(`
`)}return""+r},t}();function RC(e,t,r,n,a){n=n||{};var i=1.15,s=a.internal.scaleFactor,o=a.internal.getFontSize()/s,l=a.getLineHeightFactor?a.getLineHeightFactor():i,c=o*l,u=/\r\n|\r|\n/g,f="",p=1;if((n.valign==="middle"||n.valign==="bottom"||n.halign==="center"||n.halign==="right")&&(f=typeof e=="string"?e.split(u):e,p=f.length||1),r+=o*(2-i),n.valign==="middle"?r-=p/2*c:n.valign==="bottom"&&(r-=p*c),n.halign==="center"||n.halign==="right"){var h=o;if(n.halign==="center"&&(h*=.5),f&&p>=1){for(var g=0;g<f.length;g++)a.text(f[g],t-a.getStringUnitWidth(f[g])*h,r),r+=c;return a}t-=a.getStringUnitWidth(e)*h}return n.halign==="justify"?a.text(e,t,r,{maxWidth:n.maxWidth||100,align:"justify"}):a.text(e,t,r),a}var P_={},Pu=function(){function e(t){this.jsPDFDocument=t,this.userStyles={textColor:t.getTextColor?this.jsPDFDocument.getTextColor():0,fontSize:t.internal.getFontSize(),fontStyle:t.internal.getFont().fontStyle,font:t.internal.getFont().fontName,lineWidth:t.getLineWidth?this.jsPDFDocument.getLineWidth():0,lineColor:t.getDrawColor?this.jsPDFDocument.getDrawColor():0}}return e.setDefaults=function(t,r){r===void 0&&(r=null),r?r.__autoTableDocumentDefaults=t:P_=t},e.unifyColor=function(t){return Array.isArray(t)?t:typeof t=="number"?[t,t,t]:typeof t=="string"?[t]:null},e.prototype.applyStyles=function(t,r){var n,a,i;r===void 0&&(r=!1),t.fontStyle&&this.jsPDFDocument.setFontStyle&&this.jsPDFDocument.setFontStyle(t.fontStyle);var s=this.jsPDFDocument.internal.getFont(),o=s.fontStyle,l=s.fontName;if(t.font&&(l=t.font),t.fontStyle){o=t.fontStyle;var c=this.getFontList()[l];c&&c.indexOf(o)===-1&&this.jsPDFDocument.setFontStyle&&(this.jsPDFDocument.setFontStyle(c[0]),o=c[0])}if(this.jsPDFDocument.setFont(l,o),t.fontSize&&this.jsPDFDocument.setFontSize(t.fontSize),!r){var u=e.unifyColor(t.fillColor);u&&(n=this.jsPDFDocument).setFillColor.apply(n,u),u=e.unifyColor(t.textColor),u&&(a=this.jsPDFDocument).setTextColor.apply(a,u),u=e.unifyColor(t.lineColor),u&&(i=this.jsPDFDocument).setDrawColor.apply(i,u),typeof t.lineWidth=="number"&&this.jsPDFDocument.setLineWidth(t.lineWidth)}},e.prototype.splitTextToSize=function(t,r,n){return this.jsPDFDocument.splitTextToSize(t,r,n)},e.prototype.rect=function(t,r,n,a,i){return this.jsPDFDocument.rect(t,r,n,a,i)},e.prototype.getLastAutoTable=function(){return this.jsPDFDocument.lastAutoTable||null},e.prototype.getTextWidth=function(t){return this.jsPDFDocument.getTextWidth(t)},e.prototype.getDocument=function(){return this.jsPDFDocument},e.prototype.setPage=function(t){this.jsPDFDocument.setPage(t)},e.prototype.addPage=function(){return this.jsPDFDocument.addPage()},e.prototype.getFontList=function(){return this.jsPDFDocument.getFontList()},e.prototype.getGlobalOptions=function(){return P_||{}},e.prototype.getDocumentOptions=function(){return this.jsPDFDocument.__autoTableDocumentDefaults||{}},e.prototype.pageSize=function(){var t=this.jsPDFDocument.internal.pageSize;return t.width==null&&(t={width:t.getWidth(),height:t.getHeight()}),t},e.prototype.scaleFactor=function(){return this.jsPDFDocument.internal.scaleFactor},e.prototype.getLineHeightFactor=function(){var t=this.jsPDFDocument;return t.getLineHeightFactor?t.getLineHeightFactor():1.15},e.prototype.getLineHeight=function(t){return t/this.scaleFactor()*this.getLineHeightFactor()},e.prototype.pageNumber=function(){var t=this.jsPDFDocument.internal.getCurrentPageInfo();return t?t.pageNumber:this.jsPDFDocument.internal.getNumberOfPages()},e}(),Ax=function(e,t){return Ax=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,n){r.__proto__=n}||function(r,n){for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(r[a]=n[a])},Ax(e,t)};function jC(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");Ax(e,t);function r(){this.constructor=e}e.prototype=t===null?Object.create(t):(r.prototype=t.prototype,new r)}var MC=function(e){jC(t,e);function t(r){var n=e.call(this)||this;return n._element=r,n}return t}(Array);function YX(e){return{font:"helvetica",fontStyle:"normal",overflow:"linebreak",fillColor:!1,textColor:20,halign:"left",valign:"top",fontSize:10,cellPadding:5/e,lineColor:200,lineWidth:0,cellWidth:"auto",minCellHeight:0,minCellWidth:0}}function JX(e){var t={striped:{table:{fillColor:255,textColor:80,fontStyle:"normal"},head:{textColor:255,fillColor:[41,128,185],fontStyle:"bold"},body:{},foot:{textColor:255,fillColor:[41,128,185],fontStyle:"bold"},alternateRow:{fillColor:245}},grid:{table:{fillColor:255,textColor:80,fontStyle:"normal",lineWidth:.1},head:{textColor:255,fillColor:[26,188,156],fontStyle:"bold",lineWidth:0},body:{},foot:{textColor:255,fillColor:[26,188,156],fontStyle:"bold",lineWidth:0},alternateRow:{}},plain:{head:{fontStyle:"bold"},foot:{fontStyle:"bold"}}};return t[e]}function I1(e,t,r){r.applyStyles(t,!0);var n=Array.isArray(e)?e:[e],a=n.map(function(i){return r.getTextWidth(i)}).reduce(function(i,s){return Math.max(i,s)},0);return a}function BC(e,t,r,n){var a=t.settings.tableLineWidth,i=t.settings.tableLineColor;e.applyStyles({lineWidth:a,lineColor:i});var s=UC(a,!1);s&&e.rect(r.x,r.y,t.getWidth(e.pageSize().width),n.y-r.y,s)}function UC(e,t){var r=e>0,n=t||t===0;return r&&n?"DF":r?"S":n?"F":null}function Dm(e,t){var r,n,a,i;if(e=e||t,Array.isArray(e)){if(e.length>=4)return{top:e[0],right:e[1],bottom:e[2],left:e[3]};if(e.length===3)return{top:e[0],right:e[1],bottom:e[2],left:e[1]};if(e.length===2)return{top:e[0],right:e[1],bottom:e[0],left:e[1]};e.length===1?e=e[0]:e=t}return typeof e=="object"?(typeof e.vertical=="number"&&(e.top=e.vertical,e.bottom=e.vertical),typeof e.horizontal=="number"&&(e.right=e.horizontal,e.left=e.horizontal),{left:(r=e.left)!==null&&r!==void 0?r:t,top:(n=e.top)!==null&&n!==void 0?n:t,right:(a=e.right)!==null&&a!==void 0?a:t,bottom:(i=e.bottom)!==null&&i!==void 0?i:t}):(typeof e!="number"&&(e=t),{top:e,right:e,bottom:e,left:e})}function VC(e,t){var r=Dm(t.settings.margin,0);return e.pageSize().width-(r.left+r.right)}function QX(e,t,r,n,a){var i={},s=1.3333333333333333,o=L2(t,function(y){return a.getComputedStyle(y).backgroundColor});o!=null&&(i.fillColor=o);var l=L2(t,function(y){return a.getComputedStyle(y).color});l!=null&&(i.textColor=l);var c=eY(n,r);c&&(i.cellPadding=c);var u="borderTopColor",f=s*r,p=n.borderTopWidth;if(n.borderBottomWidth===p&&n.borderRightWidth===p&&n.borderLeftWidth===p){var h=(parseFloat(p)||0)/f;h&&(i.lineWidth=h)}else i.lineWidth={top:(parseFloat(n.borderTopWidth)||0)/f,right:(parseFloat(n.borderRightWidth)||0)/f,bottom:(parseFloat(n.borderBottomWidth)||0)/f,left:(parseFloat(n.borderLeftWidth)||0)/f},i.lineWidth.top||(i.lineWidth.right?u="borderRightColor":i.lineWidth.bottom?u="borderBottomColor":i.lineWidth.left&&(u="borderLeftColor"));var g=L2(t,function(y){return a.getComputedStyle(y)[u]});g!=null&&(i.lineColor=g);var m=["left","right","center","justify"];m.indexOf(n.textAlign)!==-1&&(i.halign=n.textAlign),m=["middle","bottom","top"],m.indexOf(n.verticalAlign)!==-1&&(i.valign=n.verticalAlign);var b=parseInt(n.fontSize||"");isNaN(b)||(i.fontSize=b/s);var x=ZX(n);x&&(i.fontStyle=x);var w=(n.fontFamily||"").toLowerCase();return e.indexOf(w)!==-1&&(i.font=w),i}function ZX(e){var t="";return(e.fontWeight==="bold"||e.fontWeight==="bolder"||parseInt(e.fontWeight)>=700)&&(t="bold"),(e.fontStyle==="italic"||e.fontStyle==="oblique")&&(t+="italic"),t}function L2(e,t){var r=$C(e,t);if(!r)return null;var n=r.match(/^rgba?\((\d+),\s*(\d+),\s*(\d+)(?:,\s*(\d*\.?\d*))?\)$/);if(!n||!Array.isArray(n))return null;var a=[parseInt(n[1]),parseInt(n[2]),parseInt(n[3])],i=parseInt(n[4]);return i===0||isNaN(a[0])||isNaN(a[1])||isNaN(a[2])?null:a}function $C(e,t){var r=t(e);return r==="rgba(0, 0, 0, 0)"||r==="transparent"||r==="initial"||r==="inherit"?e.parentElement==null?null:$C(e.parentElement,t):r}function eY(e,t){var r=[e.paddingTop,e.paddingRight,e.paddingBottom,e.paddingLeft],n=96/(72/t),a=(parseInt(e.lineHeight)-parseInt(e.fontSize))/t/2,i=r.map(function(o){return parseInt(o||"0")/n}),s=Dm(i,0);return a>s.top&&(s.top=a),a>s.bottom&&(s.bottom=a),s}function zC(e,t,r,n,a){var i,s;n===void 0&&(n=!1),a===void 0&&(a=!1);var o;typeof t=="string"?o=r.document.querySelector(t):o=t;var l=Object.keys(e.getFontList()),c=e.scaleFactor(),u=[],f=[],p=[];if(!o)return console.error("Html table could not be found with input: ",t),{head:u,body:f,foot:p};for(var h=0;h<o.rows.length;h++){var g=o.rows[h],m=(s=(i=g==null?void 0:g.parentElement)===null||i===void 0?void 0:i.tagName)===null||s===void 0?void 0:s.toLowerCase(),b=tY(l,c,r,g,n,a);b&&(m==="thead"?u.push(b):m==="tfoot"?p.push(b):f.push(b))}return{head:u,body:f,foot:p}}function tY(e,t,r,n,a,i){for(var s=new MC(n),o=0;o<n.cells.length;o++){var l=n.cells[o],c=r.getComputedStyle(l);if(a||c.display!=="none"){var u=void 0;i&&(u=QX(e,l,t,c,r)),s.push({rowSpan:l.rowSpan,colSpan:l.colSpan,styles:u,_element:l,content:rY(l)})}}var f=r.getComputedStyle(n);if(s.length>0&&(a||f.display!=="none"))return s}function rY(e){var t=e.cloneNode(!0);return t.innerHTML=t.innerHTML.replace(/\n/g,"").replace(/ +/g," "),t.innerHTML=t.innerHTML.split(/<br.*?>/).map(function(r){return r.trim()}).join(`
`),t.innerText||t.textContent||""}function nY(e,t,r){for(var n=0,a=[e,t,r];n<a.length;n++){var i=a[n];i&&typeof i!="object"&&console.error("The options parameter should be of type object, is: "+typeof i),i.startY&&typeof i.startY!="number"&&(console.error("Invalid value for startY option",i.startY),delete i.startY)}}function Bs(e,t,r,n,a){if(e==null)throw new TypeError("Cannot convert undefined or null to object");for(var i=Object(e),s=1;s<arguments.length;s++){var o=arguments[s];if(o!=null)for(var l in o)Object.prototype.hasOwnProperty.call(o,l)&&(i[l]=o[l])}return i}function HC(e,t){var r=new Pu(e),n=r.getDocumentOptions(),a=r.getGlobalOptions();nY(a,n,t);var i=Bs({},a,n,t),s;typeof window<"u"&&(s=window);var o=aY(a,n,t),l=iY(a,n,t),c=sY(r,i),u=lY(r,i,s);return{id:t.tableId,content:u,hooks:l,styles:o,settings:c}}function aY(e,t,r){for(var n={styles:{},headStyles:{},bodyStyles:{},footStyles:{},alternateRowStyles:{},columnStyles:{}},a=function(l){if(l==="columnStyles"){var c=e[l],u=t[l],f=r[l];n.columnStyles=Bs({},c,u,f)}else{var p=[e,t,r],h=p.map(function(g){return g[l]||{}});n[l]=Bs({},h[0],h[1],h[2])}},i=0,s=Object.keys(n);i<s.length;i++){var o=s[i];a(o)}return n}function iY(e,t,r){for(var n=[e,t,r],a={didParseCell:[],willDrawCell:[],didDrawCell:[],willDrawPage:[],didDrawPage:[]},i=0,s=n;i<s.length;i++){var o=s[i];o.didParseCell&&a.didParseCell.push(o.didParseCell),o.willDrawCell&&a.willDrawCell.push(o.willDrawCell),o.didDrawCell&&a.didDrawCell.push(o.didDrawCell),o.willDrawPage&&a.willDrawPage.push(o.willDrawPage),o.didDrawPage&&a.didDrawPage.push(o.didDrawPage)}return a}function sY(e,t){var r,n,a,i,s,o,l,c,u,f,p,h,g=Dm(t.margin,40/e.scaleFactor()),m=(r=oY(e,t.startY))!==null&&r!==void 0?r:g.top,b;t.showFoot===!0?b="everyPage":t.showFoot===!1?b="never":b=(n=t.showFoot)!==null&&n!==void 0?n:"everyPage";var x;t.showHead===!0?x="everyPage":t.showHead===!1?x="never":x=(a=t.showHead)!==null&&a!==void 0?a:"everyPage";var w=(i=t.useCss)!==null&&i!==void 0?i:!1,y=t.theme||(w?"plain":"striped"),A=!!t.horizontalPageBreak,L=(s=t.horizontalPageBreakRepeat)!==null&&s!==void 0?s:null;return{includeHiddenHtml:(o=t.includeHiddenHtml)!==null&&o!==void 0?o:!1,useCss:w,theme:y,startY:m,margin:g,pageBreak:(l=t.pageBreak)!==null&&l!==void 0?l:"auto",rowPageBreak:(c=t.rowPageBreak)!==null&&c!==void 0?c:"auto",tableWidth:(u=t.tableWidth)!==null&&u!==void 0?u:"auto",showHead:x,showFoot:b,tableLineWidth:(f=t.tableLineWidth)!==null&&f!==void 0?f:0,tableLineColor:(p=t.tableLineColor)!==null&&p!==void 0?p:200,horizontalPageBreak:A,horizontalPageBreakRepeat:L,horizontalPageBreakBehaviour:(h=t.horizontalPageBreakBehaviour)!==null&&h!==void 0?h:"afterAllRows"}}function oY(e,t){var r=e.getLastAutoTable(),n=e.scaleFactor(),a=e.pageNumber(),i=!1;if(r&&r.startPageNumber){var s=r.startPageNumber+r.pageNumber-1;i=s===a}return typeof t=="number"?t:(t==null||t===!1)&&i&&(r==null?void 0:r.finalY)!=null?r.finalY+20/n:null}function lY(e,t,r){var n=t.head||[],a=t.body||[],i=t.foot||[];if(t.html){var s=t.includeHiddenHtml;if(r){var o=zC(e,t.html,r,s,t.useCss)||{};n=o.head||n,a=o.body||n,i=o.foot||n}else console.error("Cannot parse html in non browser environment")}var l=t.columns||cY(n,a,i);return{columns:l,head:n,body:a,foot:i}}function cY(e,t,r){var n=e[0]||t[0]||r[0]||[],a=[];return Object.keys(n).filter(function(i){return i!=="_element"}).forEach(function(i){var s=1,o;Array.isArray(n)?o=n[parseInt(i)]:o=n[i],typeof o=="object"&&!Array.isArray(o)&&(s=(o==null?void 0:o.colSpan)||1);for(var l=0;l<s;l++){var c=void 0;Array.isArray(n)?c=a.length:c=i+(l>0?"_".concat(l):"");var u={dataKey:c};a.push(u)}}),a}var Tx=function(){function e(t,r,n){this.table=r,this.pageNumber=r.pageNumber,this.settings=r.settings,this.cursor=n,this.doc=t.getDocument()}return e}(),uY=function(e){jC(t,e);function t(r,n,a,i,s,o){var l=e.call(this,r,n,o)||this;return l.cell=a,l.row=i,l.column=s,l.section=i.section,l}return t}(Tx),fY=function(){function e(t,r){this.pageNumber=1,this.id=t.id,this.settings=t.settings,this.styles=t.styles,this.hooks=t.hooks,this.columns=r.columns,this.head=r.head,this.body=r.body,this.foot=r.foot}return e.prototype.getHeadHeight=function(t){return this.head.reduce(function(r,n){return r+n.getMaxCellHeight(t)},0)},e.prototype.getFootHeight=function(t){return this.foot.reduce(function(r,n){return r+n.getMaxCellHeight(t)},0)},e.prototype.allRows=function(){return this.head.concat(this.body).concat(this.foot)},e.prototype.callCellHooks=function(t,r,n,a,i,s){for(var o=0,l=r;o<l.length;o++){var c=l[o],u=new uY(t,this,n,a,i,s),f=c(u)===!1;if(n.text=Array.isArray(n.text)?n.text:[n.text],f)return!1}return!0},e.prototype.callEndPageHooks=function(t,r){t.applyStyles(t.userStyles);for(var n=0,a=this.hooks.didDrawPage;n<a.length;n++){var i=a[n];i(new Tx(t,this,r))}},e.prototype.callWillDrawPageHooks=function(t,r){for(var n=0,a=this.hooks.willDrawPage;n<a.length;n++){var i=a[n];i(new Tx(t,this,r))}},e.prototype.getWidth=function(t){if(typeof this.settings.tableWidth=="number")return this.settings.tableWidth;if(this.settings.tableWidth==="wrap"){var r=this.columns.reduce(function(a,i){return a+i.wrappedWidth},0);return r}else{var n=this.settings.margin;return t-n.left-n.right}},e}(),WC=function(){function e(t,r,n,a,i){i===void 0&&(i=!1),this.height=0,this.raw=t,t instanceof MC&&(this.raw=t._element,this.element=t._element),this.index=r,this.section=n,this.cells=a,this.spansMultiplePages=i}return e.prototype.getMaxCellHeight=function(t){var r=this;return t.reduce(function(n,a){var i;return Math.max(n,((i=r.cells[a.index])===null||i===void 0?void 0:i.height)||0)},0)},e.prototype.hasRowSpan=function(t){var r=this;return t.filter(function(n){var a=r.cells[n.index];return a?a.rowSpan>1:!1}).length>0},e.prototype.canEntireRowFit=function(t,r){return this.getMaxCellHeight(r)<=t},e.prototype.getMinimumRowHeight=function(t,r){var n=this;return t.reduce(function(a,i){var s=n.cells[i.index];if(!s)return 0;var o=r.getLineHeight(s.styles.fontSize),l=s.padding("vertical"),c=l+o;return c>a?c:a},0)},e}(),qC=function(){function e(t,r,n){var a;this.contentHeight=0,this.contentWidth=0,this.wrappedWidth=0,this.minReadableWidth=0,this.minWidth=0,this.width=0,this.height=0,this.x=0,this.y=0,this.styles=r,this.section=n,this.raw=t;var i=t;t!=null&&typeof t=="object"&&!Array.isArray(t)?(this.rowSpan=t.rowSpan||1,this.colSpan=t.colSpan||1,i=(a=t.content)!==null&&a!==void 0?a:t,t._element&&(this.raw=t._element)):(this.rowSpan=1,this.colSpan=1);var s=i!=null?""+i:"",o=/\r\n|\r|\n/g;this.text=s.split(o)}return e.prototype.getTextPos=function(){var t;if(this.styles.valign==="top")t=this.y+this.padding("top");else if(this.styles.valign==="bottom")t=this.y+this.height-this.padding("bottom");else{var r=this.height-this.padding("vertical");t=this.y+r/2+this.padding("top")}var n;if(this.styles.halign==="right")n=this.x+this.width-this.padding("right");else if(this.styles.halign==="center"){var a=this.width-this.padding("horizontal");n=this.x+a/2+this.padding("left")}else n=this.x+this.padding("left");return{x:n,y:t}},e.prototype.getContentHeight=function(t,r){r===void 0&&(r=1.15);var n=Array.isArray(this.text)?this.text.length:1,a=this.styles.fontSize/t*r,i=n*a+this.padding("vertical");return Math.max(i,this.styles.minCellHeight)},e.prototype.padding=function(t){var r=Dm(this.styles.cellPadding,0);return t==="vertical"?r.top+r.bottom:t==="horizontal"?r.left+r.right:r[t]},e}(),hY=function(){function e(t,r,n){this.wrappedWidth=0,this.minReadableWidth=0,this.minWidth=0,this.width=0,this.dataKey=t,this.raw=r,this.index=n}return e.prototype.getMaxCustomCellWidth=function(t){for(var r=0,n=0,a=t.allRows();n<a.length;n++){var i=a[n],s=i.cells[this.index];s&&typeof s.styles.cellWidth=="number"&&(r=Math.max(r,s.styles.cellWidth))}return r},e}();function dY(e,t){pY(e,t);var r=[],n=0;t.columns.forEach(function(i){var s=i.getMaxCustomCellWidth(t);s?i.width=s:(i.width=i.wrappedWidth,r.push(i)),n+=i.width});var a=t.getWidth(e.pageSize().width)-n;a&&(a=Cx(r,a,function(i){return Math.max(i.minReadableWidth,i.minWidth)})),a&&(a=Cx(r,a,function(i){return i.minWidth})),a=Math.abs(a),!t.settings.horizontalPageBreak&&a>.1/e.scaleFactor()&&(a=a<1?a:Math.round(a),console.warn("Of the table content, ".concat(a," units width could not fit page"))),gY(t),vY(t,e),mY(t)}function pY(e,t){var r=e.scaleFactor(),n=t.settings.horizontalPageBreak,a=VC(e,t);t.allRows().forEach(function(i){for(var s=0,o=t.columns;s<o.length;s++){var l=o[s],c=i.cells[l.index];if(c){var u=t.hooks.didParseCell;t.callCellHooks(e,u,c,i,l,null);var f=c.padding("horizontal");c.contentWidth=I1(c.text,c.styles,e)+f;var p=I1(c.text.join(" ").split(/[^\S\u00A0]+/),c.styles,e);if(c.minReadableWidth=p+c.padding("horizontal"),typeof c.styles.cellWidth=="number")c.minWidth=c.styles.cellWidth,c.wrappedWidth=c.styles.cellWidth;else if(c.styles.cellWidth==="wrap"||n===!0)c.contentWidth>a?(c.minWidth=a,c.wrappedWidth=a):(c.minWidth=c.contentWidth,c.wrappedWidth=c.contentWidth);else{var h=10/r;c.minWidth=c.styles.minCellWidth||h,c.wrappedWidth=c.contentWidth,c.minWidth>c.wrappedWidth&&(c.wrappedWidth=c.minWidth)}}}}),t.allRows().forEach(function(i){for(var s=0,o=t.columns;s<o.length;s++){var l=o[s],c=i.cells[l.index];if(c&&c.colSpan===1)l.wrappedWidth=Math.max(l.wrappedWidth,c.wrappedWidth),l.minWidth=Math.max(l.minWidth,c.minWidth),l.minReadableWidth=Math.max(l.minReadableWidth,c.minReadableWidth);else{var u=t.styles.columnStyles[l.dataKey]||t.styles.columnStyles[l.index]||{},f=u.cellWidth||u.minCellWidth;f&&typeof f=="number"&&(l.minWidth=f,l.wrappedWidth=f)}c&&(c.colSpan>1&&!l.minWidth&&(l.minWidth=c.minWidth),c.colSpan>1&&!l.wrappedWidth&&(l.wrappedWidth=c.minWidth))}})}function Cx(e,t,r){for(var n=t,a=e.reduce(function(h,g){return h+g.wrappedWidth},0),i=0;i<e.length;i++){var s=e[i],o=s.wrappedWidth/a,l=n*o,c=s.width+l,u=r(s),f=c<u?u:c;t-=f-s.width,s.width=f}if(t=Math.round(t*1e10)/1e10,t){var p=e.filter(function(h){return t<0?h.width>r(h):!0});p.length&&(t=Cx(p,t,r))}return t}function mY(e){for(var t={},r=1,n=e.allRows(),a=0;a<n.length;a++)for(var i=n[a],s=0,o=e.columns;s<o.length;s++){var l=o[s],c=t[l.index];if(r>1)r--,delete i.cells[l.index];else if(c)c.cell.height+=i.height,r=c.cell.colSpan,delete i.cells[l.index],c.left--,c.left<=1&&delete t[l.index];else{var u=i.cells[l.index];if(!u)continue;if(u.height=i.height,u.rowSpan>1){var f=n.length-a,p=u.rowSpan>f?f:u.rowSpan;t[l.index]={cell:u,left:p,row:i}}}}}function gY(e){for(var t=e.allRows(),r=0;r<t.length;r++)for(var n=t[r],a=null,i=0,s=0,o=0;o<e.columns.length;o++){var l=e.columns[o];if(s-=1,s>1&&e.columns[o+1])i+=l.width,delete n.cells[l.index];else if(a){var c=a;delete n.cells[l.index],a=null,c.width=l.width+i}else{var c=n.cells[l.index];if(!c)continue;if(s=c.colSpan,i=0,c.colSpan>1){a=c,i+=l.width;continue}c.width=l.width+i}}}function vY(e,t){for(var r={count:0,height:0},n=0,a=e.allRows();n<a.length;n++){for(var i=a[n],s=0,o=e.columns;s<o.length;s++){var l=o[s],c=i.cells[l.index];if(c){t.applyStyles(c.styles,!0);var u=c.width-c.padding("horizontal");if(c.styles.overflow==="linebreak")c.text=t.splitTextToSize(c.text,u+1/t.scaleFactor(),{fontSize:c.styles.fontSize});else if(c.styles.overflow==="ellipsize")c.text=L_(c.text,u,c.styles,t,"...");else if(c.styles.overflow==="hidden")c.text=L_(c.text,u,c.styles,t,"");else if(typeof c.styles.overflow=="function"){var f=c.styles.overflow(c.text,u);typeof f=="string"?c.text=[f]:c.text=f}c.contentHeight=c.getContentHeight(t.scaleFactor(),t.getLineHeightFactor());var p=c.contentHeight/c.rowSpan;c.rowSpan>1&&r.count*r.height<p*c.rowSpan?r={height:p,count:c.rowSpan}:r&&r.count>0&&r.height>p&&(p=r.height),p>i.height&&(i.height=p)}}r.count--}}function L_(e,t,r,n,a){return e.map(function(i){return xY(i,t,r,n,a)})}function xY(e,t,r,n,a){var i=1e4*n.scaleFactor();if(t=Math.ceil(t*i)/i,t>=I1(e,r,n))return e;for(;t<I1(e+a,r,n)&&!(e.length<=1);)e=e.substring(0,e.length-1);return e.trim()+a}function GC(e,t){var r=new Pu(e),n=yY(t,r.scaleFactor()),a=new fY(t,n);return dY(r,a),r.applyStyles(r.userStyles),a}function yY(e,t){var r=e.content,n=bY(r.columns);if(r.head.length===0){var a=F_(n,"head");a&&r.head.push(a)}if(r.foot.length===0){var a=F_(n,"foot");a&&r.foot.push(a)}var i=e.settings.theme,s=e.styles;return{columns:n,head:F2("head",r.head,n,s,i,t),body:F2("body",r.body,n,s,i,t),foot:F2("foot",r.foot,n,s,i,t)}}function F2(e,t,r,n,a,i){var s={},o=t.map(function(l,c){for(var u=0,f={},p=0,h=0,g=0,m=r;g<m.length;g++){var b=m[g];if(s[b.index]==null||s[b.index].left===0)if(h===0){var x=void 0;Array.isArray(l)?x=l[b.index-p-u]:x=l[b.dataKey];var w={};typeof x=="object"&&!Array.isArray(x)&&(w=(x==null?void 0:x.styles)||{});var y=_Y(e,b,c,a,n,i,w),A=new qC(x,y,e);f[b.dataKey]=A,f[b.index]=A,h=A.colSpan-1,s[b.index]={left:A.rowSpan-1,times:h}}else h--,p++;else s[b.index].left--,h=s[b.index].times,u++}return new WC(l,c,e,f)});return o}function F_(e,t){var r={};return e.forEach(function(n){if(n.raw!=null){var a=wY(t,n.raw);a!=null&&(r[n.dataKey]=a)}}),Object.keys(r).length>0?r:null}function wY(e,t){if(e==="head"){if(typeof t=="object")return t.header||null;if(typeof t=="string"||typeof t=="number")return t}else if(e==="foot"&&typeof t=="object")return t.footer;return null}function bY(e){return e.map(function(t,r){var n,a;return typeof t=="object"?a=(n=t.dataKey)!==null&&n!==void 0?n:r:a=r,new hY(a,t,r)})}function _Y(e,t,r,n,a,i,s){var o=JX(n),l;e==="head"?l=a.headStyles:e==="body"?l=a.bodyStyles:e==="foot"&&(l=a.footStyles);var c=Bs({},o.table,o[e],a.styles,l),u=a.columnStyles[t.dataKey]||a.columnStyles[t.index]||{},f=e==="body"?u:{},p=e==="body"&&r%2===0?Bs({},o.alternateRow,a.alternateRowStyles):{},h=YX(i),g=Bs({},h,c,p,f);return Bs(g,s)}function SY(e,t,r){var n;r===void 0&&(r={});var a=VC(e,t),i=new Map,s=[],o=[],l=[];Array.isArray(t.settings.horizontalPageBreakRepeat)?l=t.settings.horizontalPageBreakRepeat:(typeof t.settings.horizontalPageBreakRepeat=="string"||typeof t.settings.horizontalPageBreakRepeat=="number")&&(l=[t.settings.horizontalPageBreakRepeat]),l.forEach(function(p){var h=t.columns.find(function(g){return g.dataKey===p||g.index===p});h&&!i.has(h.index)&&(i.set(h.index,!0),s.push(h.index),o.push(t.columns[h.index]),a-=h.wrappedWidth)});for(var c=!0,u=(n=r==null?void 0:r.start)!==null&&n!==void 0?n:0;u<t.columns.length;){if(i.has(u)){u++;continue}var f=t.columns[u].wrappedWidth;if(c||a>=f)c=!1,s.push(u),o.push(t.columns[u]),a-=f;else break;u++}return{colIndexes:s,columns:o,lastIndex:u-1}}function kY(e,t){for(var r=[],n=0;n<t.columns.length;n++){var a=SY(e,t,{start:n});a.columns.length&&(r.push(a),n=a.lastIndex)}return r}function KC(e,t){var r=t.settings,n=r.startY,a=r.margin,i={x:a.left,y:n},s=t.getHeadHeight(t.columns)+t.getFootHeight(t.columns),o=n+a.bottom+s;if(r.pageBreak==="avoid"){var l=t.body,c=l.reduce(function(p,h){return p+h.height},0);o+=c}var u=new Pu(e);(r.pageBreak==="always"||r.startY!=null&&o>u.pageSize().height)&&(YC(u),i.y=a.top),t.callWillDrawPageHooks(u,i);var f=Bs({},i);t.startPageNumber=u.pageNumber(),r.horizontalPageBreak?EY(u,t,f,i):(u.applyStyles(u.userStyles),(r.showHead==="firstPage"||r.showHead==="everyPage")&&t.head.forEach(function(p){return eo(u,t,p,i,t.columns)}),u.applyStyles(u.userStyles),t.body.forEach(function(p,h){var g=h===t.body.length-1;R1(u,t,p,g,f,i,t.columns)}),u.applyStyles(u.userStyles),(r.showFoot==="lastPage"||r.showFoot==="everyPage")&&t.foot.forEach(function(p){return eo(u,t,p,i,t.columns)})),BC(u,t,f,i),t.callEndPageHooks(u,i),t.finalY=i.y,e.lastAutoTable=t,u.applyStyles(u.userStyles)}function EY(e,t,r,n){var a=kY(e,t),i=t.settings;if(i.horizontalPageBreakBehaviour==="afterAllRows")a.forEach(function(c,u){e.applyStyles(e.userStyles),u>0?F0(e,t,r,n,c.columns,!0):O_(e,t,n,c.columns),AY(e,t,r,n,c.columns),O2(e,t,n,c.columns)});else for(var s=-1,o=a[0],l=function(){var c=s;if(o){e.applyStyles(e.userStyles);var u=o.columns;s>=0?F0(e,t,r,n,u,!0):O_(e,t,n,u),c=D_(e,t,s+1,n,u),O2(e,t,n,u)}var f=c-s;a.slice(1).forEach(function(p){e.applyStyles(e.userStyles),F0(e,t,r,n,p.columns,!0),D_(e,t,s+1,n,p.columns,f),O2(e,t,n,p.columns)}),s=c};s<t.body.length-1;)l()}function O_(e,t,r,n){var a=t.settings;e.applyStyles(e.userStyles),(a.showHead==="firstPage"||a.showHead==="everyPage")&&t.head.forEach(function(i){return eo(e,t,i,r,n)})}function AY(e,t,r,n,a){e.applyStyles(e.userStyles),t.body.forEach(function(i,s){var o=s===t.body.length-1;R1(e,t,i,o,r,n,a)})}function D_(e,t,r,n,a,i){e.applyStyles(e.userStyles),i=i??t.body.length;var s=Math.min(r+i,t.body.length),o=-1;return t.body.slice(r,s).forEach(function(l,c){var u=r+c===t.body.length-1,f=XC(e,t,u,n);l.canEntireRowFit(f,a)&&(eo(e,t,l,n,a),o=r+c)}),o}function O2(e,t,r,n){var a=t.settings;e.applyStyles(e.userStyles),(a.showFoot==="lastPage"||a.showFoot==="everyPage")&&t.foot.forEach(function(i){return eo(e,t,i,r,n)})}function TY(e,t,r){var n=r.getLineHeight(e.styles.fontSize),a=e.padding("vertical"),i=Math.floor((t-a)/n);return Math.max(0,i)}function CY(e,t,r,n){var a={};e.spansMultiplePages=!0,e.height=0;for(var i=0,s=0,o=r.columns;s<o.length;s++){var l=o[s],c=e.cells[l.index];if(c){Array.isArray(c.text)||(c.text=[c.text]);var u=new qC(c.raw,c.styles,c.section);u=Bs(u,c),u.text=[];var f=TY(c,t,n);c.text.length>f&&(u.text=c.text.splice(f,c.text.length));var p=n.scaleFactor(),h=n.getLineHeightFactor();c.contentHeight=c.getContentHeight(p,h),c.contentHeight>=t&&(c.contentHeight=t,u.styles.minCellHeight-=t),c.contentHeight>e.height&&(e.height=c.contentHeight),u.contentHeight=u.getContentHeight(p,h),u.contentHeight>i&&(i=u.contentHeight),a[l.index]=u}}var g=new WC(e.raw,-1,e.section,a,!0);g.height=i;for(var m=0,b=r.columns;m<b.length;m++){var l=b[m],u=g.cells[l.index];u&&(u.height=g.height);var c=e.cells[l.index];c&&(c.height=e.height)}return g}function NY(e,t,r,n){var a=e.pageSize().height,i=n.settings.margin,s=i.top+i.bottom,o=a-s;t.section==="body"&&(o-=n.getHeadHeight(n.columns)+n.getFootHeight(n.columns));var l=t.getMinimumRowHeight(n.columns,e),c=l<r;if(l>o)return console.error("Will not be able to print row ".concat(t.index," correctly since it's minimum height is larger than page height")),!0;if(!c)return!1;var u=t.hasRowSpan(n.columns),f=t.getMaxCellHeight(n.columns)>o;return f?(u&&console.error("The content of row ".concat(t.index," will not be drawn correctly since drawing rows with a height larger than the page height and has cells with rowspans is not supported.")),!0):!(u||n.settings.rowPageBreak==="avoid")}function R1(e,t,r,n,a,i,s){var o=XC(e,t,n,i);if(r.canEntireRowFit(o,s))eo(e,t,r,i,s);else if(NY(e,r,o,t)){var l=CY(r,o,t,e);eo(e,t,r,i,s),F0(e,t,a,i,s),R1(e,t,l,n,a,i,s)}else F0(e,t,a,i,s),R1(e,t,r,n,a,i,s)}function eo(e,t,r,n,a){n.x=t.settings.margin.left;for(var i=0,s=a;i<s.length;i++){var o=s[i],l=r.cells[o.index];if(!l){n.x+=o.width;continue}e.applyStyles(l.styles),l.x=n.x,l.y=n.y;var c=t.callCellHooks(e,t.hooks.willDrawCell,l,r,o,n);if(c===!1){n.x+=o.width;continue}PY(e,l,n);var u=l.getTextPos();RC(l.text,u.x,u.y,{halign:l.styles.halign,valign:l.styles.valign,maxWidth:Math.ceil(l.width-l.padding("left")-l.padding("right"))},e.getDocument()),t.callCellHooks(e,t.hooks.didDrawCell,l,r,o,n),n.x+=o.width}n.y+=r.height}function PY(e,t,r){var n=t.styles;if(e.getDocument().setFillColor(e.getDocument().getFillColor()),typeof n.lineWidth=="number"){var a=UC(n.lineWidth,n.fillColor);a&&e.rect(t.x,r.y,t.width,t.height,a)}else typeof n.lineWidth=="object"&&(n.fillColor&&e.rect(t.x,r.y,t.width,t.height,"F"),LY(e,t,r,n.lineWidth))}function LY(e,t,r,n){var a,i,s,o;n.top&&(a=r.x,i=r.y,s=r.x+t.width,o=r.y,n.right&&(s+=.5*n.right),n.left&&(a-=.5*n.left),l(n.top,a,i,s,o)),n.bottom&&(a=r.x,i=r.y+t.height,s=r.x+t.width,o=r.y+t.height,n.right&&(s+=.5*n.right),n.left&&(a-=.5*n.left),l(n.bottom,a,i,s,o)),n.left&&(a=r.x,i=r.y,s=r.x,o=r.y+t.height,n.top&&(i-=.5*n.top),n.bottom&&(o+=.5*n.bottom),l(n.left,a,i,s,o)),n.right&&(a=r.x+t.width,i=r.y,s=r.x+t.width,o=r.y+t.height,n.top&&(i-=.5*n.top),n.bottom&&(o+=.5*n.bottom),l(n.right,a,i,s,o));function l(c,u,f,p,h){e.getDocument().setLineWidth(c),e.getDocument().line(u,f,p,h,"S")}}function XC(e,t,r,n){var a=t.settings.margin.bottom,i=t.settings.showFoot;return(i==="everyPage"||i==="lastPage"&&r)&&(a+=t.getFootHeight(t.columns)),e.pageSize().height-n.y-a}function F0(e,t,r,n,a,i){a===void 0&&(a=[]),i===void 0&&(i=!1),e.applyStyles(e.userStyles),t.settings.showFoot==="everyPage"&&!i&&t.foot.forEach(function(o){return eo(e,t,o,n,a)}),t.callEndPageHooks(e,n);var s=t.settings.margin;BC(e,t,r,n),YC(e),t.pageNumber++,n.x=s.left,n.y=s.top,r.y=s.top,t.callWillDrawPageHooks(e,n),t.settings.showHead==="everyPage"&&(t.head.forEach(function(o){return eo(e,t,o,n,a)}),e.applyStyles(e.userStyles))}function YC(e){var t=e.pageNumber();e.setPage(t+1);var r=e.pageNumber();return r===t?(e.addPage(),!0):!1}function FY(e){e.API.autoTable=function(){for(var t=[],r=0;r<arguments.length;r++)t[r]=arguments[r];var n=t[0],a=HC(this,n),i=GC(this,a);return KC(this,i),this},e.API.lastAutoTable=!1,e.API.autoTableText=function(t,r,n,a){RC(t,r,n,a,this)},e.API.autoTableSetDefaults=function(t){return Pu.setDefaults(t,this),this},e.autoTableSetDefaults=function(t,r){Pu.setDefaults(t,r)},e.API.autoTableHtmlToJson=function(t,r){var n;if(r===void 0&&(r=!1),typeof window>"u")return console.error("Cannot run autoTableHtmlToJson in non browser environment"),null;var a=new Pu(this),i=zC(a,t,window,r,!1),s=i.head,o=i.body,l=((n=s[0])===null||n===void 0?void 0:n.map(function(c){return c.content}))||[];return{columns:l,rows:o,data:o}}}var D2;function OY(e,t){var r=HC(e,t),n=GC(e,r);KC(e,n)}try{if(typeof window<"u"&&window){var I_=window,R_=I_.jsPDF||((D2=I_.jspdf)===null||D2===void 0?void 0:D2.jsPDF);R_&&FY(R_)}}catch(e){console.error("Could not apply autoTable plugin",e)}const j_=["Todos los meses","Enero","Febrero","Marzo","Abril","Mayo","Junio","Julio","Agosto","Septiembre","Octubre","Noviembre","Diciembre"],Nx=new Date().getFullYear(),DY=Array.from({length:Nx-2022},(e,t)=>2023+t),IY=()=>{const{articles:e,movements:t}=ds(),[r,n]=ie.useState(""),[a,i]=ie.useState(0),[s,o]=ie.useState(Nx),l=ie.useMemo(()=>e.map(h=>{const g=t.filter(y=>y.id_articulo===h.id),m=g.filter(y=>{if(y.tipo!=="Salida")return!1;const A=new Date(y.fecha);return s===0?!0:a===0?A.getFullYear()===s:A.getFullYear()===s&&A.getMonth()+1===a}).reduce((y,A)=>y+A.cantidad*h.costo,0),b=s===0?g.filter(y=>y.tipo==="Salida").reduce((y,A)=>y+A.cantidad*h.costo,0):g.filter(y=>y.tipo==="Salida"&&new Date(y.fecha).getFullYear()===s).reduce((y,A)=>y+A.cantidad*h.costo,0),x=g.filter(y=>{const A=new Date(y.fecha);return s===0?!0:a===0?A.getFullYear()<=s:A.getFullYear()<s||A.getFullYear()===s&&A.getMonth()+1<=a}).reduce((y,A)=>y+(A.tipo==="Entrada"?A.cantidad:-A.cantidad),0),w=x*h.costo;return{...h,consumo:m,consumoAnual:b,existencias:x,saldo:w}}).filter(h=>!r||h.nombre.toLowerCase().includes(r.toLowerCase())),[e,t,r,a,s]),c=()=>{const h=["Artculo","Consumo","Existencias","Costo","Saldo"],g=l.map(b=>[b.nombre,b.consumo.toLocaleString("es-ES",{minimumFractionDigits:2}),b.existencias.toString(),Gt(b.costo),Gt(b.saldo)]),m=bm(h,g);_m(m,"papeleria_nueva.csv")},u=()=>{const h=["Artculo","Consumo","Existencias","Costo","Saldo"],g=l.map(y=>[y.nombre,y.consumo.toLocaleString("es-ES",{minimumFractionDigits:2}),y.existencias.toString(),Gt(y.costo),Gt(y.saldo)]),m=new vt;m.text("Papelera Nueva",14,14),OY(m,{head:[h],body:g,startY:20,styles:{font:"helvetica",fontSize:10},headStyles:{fillColor:[240,240,240],textColor:0}}),m.save("papeleria_nueva.pdf");const b=`<table><thead><tr>${h.map(y=>`<th>${y}</th>`).join("")}</tr></thead><tbody>${g.map(y=>`<tr>${y.map(A=>`<td>${A}</td>`).join("")}</tr>`).join("")}</tbody></table>`,x=Nh("Papelera Nueva",b,{articleId:r||void 0,dateFrom:a&&s?`${j_[a]} ${s}`:void 0}),w=window.open("","_blank");w&&(w.document.write(x),w.document.close(),w.focus(),setTimeout(()=>w.print(),500))},f=()=>{u()},p=()=>{n(""),i(0),o(Nx)};return _.jsxs("div",{className:"p-8",children:[_.jsx("h1",{className:"text-2xl font-bold mb-6",children:"Papelera Nueva"}),_.jsxs("div",{className:"flex flex-wrap gap-4 mb-4 items-end",children:[_.jsxs("select",{className:"border rounded px-2 py-1",value:r,onChange:h=>n(h.target.value),children:[_.jsx("option",{value:"",children:"Todos los artculos"}),e.map(h=>_.jsx("option",{value:h.nombre,children:h.nombre},h.id))]}),_.jsx("select",{className:"border rounded px-2 py-1",value:a,onChange:h=>i(Number(h.target.value)),children:j_.map((h,g)=>_.jsx("option",{value:g,children:h},g))}),_.jsxs("select",{className:"border rounded px-2 py-1",value:s,onChange:h=>o(Number(h.target.value)),children:[_.jsx("option",{value:0,children:"Todos los aos"}),DY.map(h=>_.jsx("option",{value:h,children:h},h))]}),_.jsxs("div",{className:"flex gap-2 ml-auto",children:[_.jsx("button",{onClick:f,className:"bg-gray-200 px-3 py-1 rounded hover:bg-gray-300",children:"Imprimir"}),_.jsx("button",{onClick:u,className:"bg-gray-200 px-3 py-1 rounded hover:bg-gray-300",children:"Exportar PDF"}),_.jsx("button",{onClick:c,className:"bg-blue-600 text-white px-3 py-1 rounded hover:bg-blue-700",children:"Exportar CSV"}),_.jsx("button",{onClick:p,className:"bg-red-100 text-red-700 px-3 py-1 rounded hover:bg-red-200",children:"Limpiar filtros"})]})]}),_.jsx("div",{className:"overflow-x-auto",children:_.jsxs("table",{className:"min-w-full border",children:[_.jsx("thead",{children:_.jsxs("tr",{className:"bg-gray-100",children:[_.jsx("th",{className:"px-4 py-2 text-left",children:"Artculo"}),_.jsx("th",{className:"px-4 py-2 text-right",children:"Consumo"}),_.jsx("th",{className:"px-4 py-2 text-right",children:"Consumo anual"}),_.jsx("th",{className:"px-4 py-2 text-right",children:"Existencias"}),_.jsx("th",{className:"px-4 py-2 text-right",children:"Costo"}),_.jsx("th",{className:"px-4 py-2 text-right",children:"Saldo"})]})}),_.jsx("tbody",{children:l.map(h=>_.jsxs("tr",{className:"border-t",children:[_.jsx("td",{className:"px-4 py-2",children:h.nombre}),_.jsx("td",{className:"px-4 py-2 text-right",children:h.consumo.toLocaleString("es-ES",{minimumFractionDigits:2})}),_.jsx("td",{className:"px-4 py-2 text-right",children:h.consumoAnual.toLocaleString("es-ES",{minimumFractionDigits:2})}),_.jsx("td",{className:"px-4 py-2 text-right",children:h.existencias}),_.jsx("td",{className:"px-4 py-2 text-right",children:Gt(h.costo)}),_.jsx("td",{className:"px-4 py-2 text-right",children:Gt(h.saldo)})]},h.id))})]})})]})},RY=()=>{const[e,t]=ie.useState("dashboard"),r=()=>{const a={dashboard:NM,articles:IM,movements:jM,existencias:MM,"control-card":XB,"papeleria-nueva":IY,"import-export":QK}[e];return _.jsx(er.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},exit:{opacity:0,y:-20},transition:{duration:.3},className:"flex-1",children:_.jsx(a,{})},e)};return _.jsxs("div",{className:"min-h-screen bg-gray-50",children:[_.jsx(EM,{}),_.jsx(TM,{currentView:e,onViewChange:t}),_.jsx("main",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:r()})]})};function jY(){const{isAuthenticated:e,isLoading:t}=vm();return t?_.jsx("div",{className:"min-h-screen bg-gradient-to-br from-blue-50 via-white to-blue-100 flex items-center justify-center",children:_.jsxs("div",{className:"text-center",children:[_.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600 mx-auto mb-4"}),_.jsx("p",{className:"text-gray-600",children:"Cargando sistema..."})]})}):_.jsxs(_.Fragment,{children:[e?_.jsx(RY,{}):_.jsx(Wj,{},e?"dashboard":"login"),_.jsx(KL,{position:"top-right",toastOptions:{duration:4e3,style:{background:"#363636",color:"#fff"}}})]})}function MY(){return _.jsx(fO,{children:_.jsx(mO,{children:_.jsx(jY,{})})})}Zk(document.getElementById("root")).render(_.jsx(ie.StrictMode,{children:_.jsx(pM,{children:_.jsx(MY,{})})}));export{tr as _,li as c,M_ as g};
