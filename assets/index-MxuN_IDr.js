(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const a of document.querySelectorAll('link[rel="modulepreload"]'))n(a);new MutationObserver(a=>{for(const i of a)if(i.type==="childList")for(const s of i.addedNodes)s.tagName==="LINK"&&s.rel==="modulepreload"&&n(s)}).observe(document,{childList:!0,subtree:!0});function r(a){const i={};return a.integrity&&(i.integrity=a.integrity),a.referrerPolicy&&(i.referrerPolicy=a.referrerPolicy),a.crossOrigin==="use-credentials"?i.credentials="include":a.crossOrigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function n(a){if(a.ep)return;a.ep=!0;const i=r(a);fetch(a.href,i)}})();var li=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function e6(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}function t6(e){if(e.__esModule)return e;var t=e.default;if(typeof t=="function"){var r=function n(){return this instanceof n?Reflect.construct(t,arguments,this.constructor):t.apply(this,arguments)};r.prototype=t.prototype}else r={};return Object.defineProperty(r,"__esModule",{value:!0}),Object.keys(e).forEach(function(n){var a=Object.getOwnPropertyDescriptor(e,n);Object.defineProperty(r,n,a.get?a:{enumerable:!0,get:function(){return e[n]}})}),r}var r6={exports:{}},G1={},n6={exports:{}},jt={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Sh=Symbol.for("react.element"),nN=Symbol.for("react.portal"),aN=Symbol.for("react.fragment"),iN=Symbol.for("react.strict_mode"),sN=Symbol.for("react.profiler"),oN=Symbol.for("react.provider"),lN=Symbol.for("react.context"),cN=Symbol.for("react.forward_ref"),uN=Symbol.for("react.suspense"),fN=Symbol.for("react.memo"),hN=Symbol.for("react.lazy"),Sw=Symbol.iterator;function dN(e){return e===null||typeof e!="object"?null:(e=Sw&&e[Sw]||e["@@iterator"],typeof e=="function"?e:null)}var a6={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},i6=Object.assign,s6={};function Qu(e,t,r){this.props=e,this.context=t,this.refs=s6,this.updater=r||a6}Qu.prototype.isReactComponent={};Qu.prototype.setState=function(e,t){if(typeof e!="object"&&typeof e!="function"&&e!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,e,t,"setState")};Qu.prototype.forceUpdate=function(e){this.updater.enqueueForceUpdate(this,e,"forceUpdate")};function o6(){}o6.prototype=Qu.prototype;function Bv(e,t,r){this.props=e,this.context=t,this.refs=s6,this.updater=r||a6}var Uv=Bv.prototype=new o6;Uv.constructor=Bv;i6(Uv,Qu.prototype);Uv.isPureReactComponent=!0;var kw=Array.isArray,l6=Object.prototype.hasOwnProperty,$v={current:null},c6={key:!0,ref:!0,__self:!0,__source:!0};function u6(e,t,r){var n,a={},i=null,s=null;if(t!=null)for(n in t.ref!==void 0&&(s=t.ref),t.key!==void 0&&(i=""+t.key),t)l6.call(t,n)&&!c6.hasOwnProperty(n)&&(a[n]=t[n]);var o=arguments.length-2;if(o===1)a.children=r;else if(1<o){for(var l=Array(o),c=0;c<o;c++)l[c]=arguments[c+2];a.children=l}if(e&&e.defaultProps)for(n in o=e.defaultProps,o)a[n]===void 0&&(a[n]=o[n]);return{$$typeof:Sh,type:e,key:i,ref:s,props:a,_owner:$v.current}}function pN(e,t){return{$$typeof:Sh,type:e.type,key:t,ref:e.ref,props:e.props,_owner:e._owner}}function Vv(e){return typeof e=="object"&&e!==null&&e.$$typeof===Sh}function mN(e){var t={"=":"=0",":":"=2"};return"$"+e.replace(/[=:]/g,function(r){return t[r]})}var Ew=/\/+/g;function kg(e,t){return typeof e=="object"&&e!==null&&e.key!=null?mN(""+e.key):t.toString(36)}function kp(e,t,r,n,a){var i=typeof e;(i==="undefined"||i==="boolean")&&(e=null);var s=!1;if(e===null)s=!0;else switch(i){case"string":case"number":s=!0;break;case"object":switch(e.$$typeof){case Sh:case nN:s=!0}}if(s)return s=e,a=a(s),e=n===""?"."+kg(s,0):n,kw(a)?(r="",e!=null&&(r=e.replace(Ew,"$&/")+"/"),kp(a,t,r,"",function(c){return c})):a!=null&&(Vv(a)&&(a=pN(a,r+(!a.key||s&&s.key===a.key?"":(""+a.key).replace(Ew,"$&/")+"/")+e)),t.push(a)),1;if(s=0,n=n===""?".":n+":",kw(e))for(var o=0;o<e.length;o++){i=e[o];var l=n+kg(i,o);s+=kp(i,t,r,l,a)}else if(l=dN(e),typeof l=="function")for(e=l.call(e),o=0;!(i=e.next()).done;)i=i.value,l=n+kg(i,o++),s+=kp(i,t,r,l,a);else if(i==="object")throw t=String(e),Error("Objects are not valid as a React child (found: "+(t==="[object Object]"?"object with keys {"+Object.keys(e).join(", ")+"}":t)+"). If you meant to render a collection of children, use an array instead.");return s}function Id(e,t,r){if(e==null)return e;var n=[],a=0;return kp(e,n,"","",function(i){return t.call(r,i,a++)}),n}function gN(e){if(e._status===-1){var t=e._result;t=t(),t.then(function(r){(e._status===0||e._status===-1)&&(e._status=1,e._result=r)},function(r){(e._status===0||e._status===-1)&&(e._status=2,e._result=r)}),e._status===-1&&(e._status=0,e._result=t)}if(e._status===1)return e._result.default;throw e._result}var sa={current:null},Ep={transition:null},xN={ReactCurrentDispatcher:sa,ReactCurrentBatchConfig:Ep,ReactCurrentOwner:$v};function f6(){throw Error("act(...) is not supported in production builds of React.")}jt.Children={map:Id,forEach:function(e,t,r){Id(e,function(){t.apply(this,arguments)},r)},count:function(e){var t=0;return Id(e,function(){t++}),t},toArray:function(e){return Id(e,function(t){return t})||[]},only:function(e){if(!Vv(e))throw Error("React.Children.only expected to receive a single React element child.");return e}};jt.Component=Qu;jt.Fragment=aN;jt.Profiler=sN;jt.PureComponent=Bv;jt.StrictMode=iN;jt.Suspense=uN;jt.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=xN;jt.act=f6;jt.cloneElement=function(e,t,r){if(e==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+e+".");var n=i6({},e.props),a=e.key,i=e.ref,s=e._owner;if(t!=null){if(t.ref!==void 0&&(i=t.ref,s=$v.current),t.key!==void 0&&(a=""+t.key),e.type&&e.type.defaultProps)var o=e.type.defaultProps;for(l in t)l6.call(t,l)&&!c6.hasOwnProperty(l)&&(n[l]=t[l]===void 0&&o!==void 0?o[l]:t[l])}var l=arguments.length-2;if(l===1)n.children=r;else if(1<l){o=Array(l);for(var c=0;c<l;c++)o[c]=arguments[c+2];n.children=o}return{$$typeof:Sh,type:e.type,key:a,ref:i,props:n,_owner:s}};jt.createContext=function(e){return e={$$typeof:lN,_currentValue:e,_currentValue2:e,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},e.Provider={$$typeof:oN,_context:e},e.Consumer=e};jt.createElement=u6;jt.createFactory=function(e){var t=u6.bind(null,e);return t.type=e,t};jt.createRef=function(){return{current:null}};jt.forwardRef=function(e){return{$$typeof:cN,render:e}};jt.isValidElement=Vv;jt.lazy=function(e){return{$$typeof:hN,_payload:{_status:-1,_result:e},_init:gN}};jt.memo=function(e,t){return{$$typeof:fN,type:e,compare:t===void 0?null:t}};jt.startTransition=function(e){var t=Ep.transition;Ep.transition={};try{e()}finally{Ep.transition=t}};jt.unstable_act=f6;jt.useCallback=function(e,t){return sa.current.useCallback(e,t)};jt.useContext=function(e){return sa.current.useContext(e)};jt.useDebugValue=function(){};jt.useDeferredValue=function(e){return sa.current.useDeferredValue(e)};jt.useEffect=function(e,t){return sa.current.useEffect(e,t)};jt.useId=function(){return sa.current.useId()};jt.useImperativeHandle=function(e,t,r){return sa.current.useImperativeHandle(e,t,r)};jt.useInsertionEffect=function(e,t){return sa.current.useInsertionEffect(e,t)};jt.useLayoutEffect=function(e,t){return sa.current.useLayoutEffect(e,t)};jt.useMemo=function(e,t){return sa.current.useMemo(e,t)};jt.useReducer=function(e,t,r){return sa.current.useReducer(e,t,r)};jt.useRef=function(e){return sa.current.useRef(e)};jt.useState=function(e){return sa.current.useState(e)};jt.useSyncExternalStore=function(e,t,r){return sa.current.useSyncExternalStore(e,t,r)};jt.useTransition=function(){return sa.current.useTransition()};jt.version="18.3.1";n6.exports=jt;var ie=n6.exports;const Fi=e6(ie);/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var vN=ie,yN=Symbol.for("react.element"),wN=Symbol.for("react.fragment"),bN=Object.prototype.hasOwnProperty,_N=vN.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,SN={key:!0,ref:!0,__self:!0,__source:!0};function h6(e,t,r){var n,a={},i=null,s=null;r!==void 0&&(i=""+r),t.key!==void 0&&(i=""+t.key),t.ref!==void 0&&(s=t.ref);for(n in t)bN.call(t,n)&&!SN.hasOwnProperty(n)&&(a[n]=t[n]);if(e&&e.defaultProps)for(n in t=e.defaultProps,t)a[n]===void 0&&(a[n]=t[n]);return{$$typeof:yN,type:e,key:i,ref:s,props:a,_owner:_N.current}}G1.Fragment=wN;G1.jsx=h6;G1.jsxs=h6;r6.exports=G1;var v=r6.exports,d6={exports:{}},Ua={},p6={exports:{}},m6={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(e){function t(ee,R){var pe=ee.length;ee.push(R);e:for(;0<pe;){var me=pe-1>>>1,E=ee[me];if(0<a(E,R))ee[me]=R,ee[pe]=E,pe=me;else break e}}function r(ee){return ee.length===0?null:ee[0]}function n(ee){if(ee.length===0)return null;var R=ee[0],pe=ee.pop();if(pe!==R){ee[0]=pe;e:for(var me=0,E=ee.length,D=E>>>1;me<D;){var O=2*(me+1)-1,M=ee[O],K=O+1,Y=ee[K];if(0>a(M,pe))K<E&&0>a(Y,M)?(ee[me]=Y,ee[K]=pe,me=K):(ee[me]=M,ee[O]=pe,me=O);else if(K<E&&0>a(Y,pe))ee[me]=Y,ee[K]=pe,me=K;else break e}}return R}function a(ee,R){var pe=ee.sortIndex-R.sortIndex;return pe!==0?pe:ee.id-R.id}if(typeof performance=="object"&&typeof performance.now=="function"){var i=performance;e.unstable_now=function(){return i.now()}}else{var s=Date,o=s.now();e.unstable_now=function(){return s.now()-o}}var l=[],c=[],u=1,f=null,d=3,h=!1,g=!1,m=!1,_=typeof setTimeout=="function"?setTimeout:null,y=typeof clearTimeout=="function"?clearTimeout:null,b=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function w(ee){for(var R=r(c);R!==null;){if(R.callback===null)n(c);else if(R.startTime<=ee)n(c),R.sortIndex=R.expirationTime,t(l,R);else break;R=r(c)}}function T(ee){if(m=!1,w(ee),!g)if(r(l)!==null)g=!0,de(F);else{var R=r(c);R!==null&&X(T,R.startTime-ee)}}function F(ee,R){g=!1,m&&(m=!1,y(P),P=-1),h=!0;var pe=d;try{for(w(R),f=r(l);f!==null&&(!(f.expirationTime>R)||ee&&!N());){var me=f.callback;if(typeof me=="function"){f.callback=null,d=f.priorityLevel;var E=me(f.expirationTime<=R);R=e.unstable_now(),typeof E=="function"?f.callback=E:f===r(l)&&n(l),w(R)}else n(l);f=r(l)}if(f!==null)var D=!0;else{var O=r(c);O!==null&&X(T,O.startTime-R),D=!1}return D}finally{f=null,d=pe,h=!1}}var I=!1,A=null,P=-1,j=5,J=-1;function N(){return!(e.unstable_now()-J<j)}function L(){if(A!==null){var ee=e.unstable_now();J=ee;var R=!0;try{R=A(!0,ee)}finally{R?G():(I=!1,A=null)}}else I=!1}var G;if(typeof b=="function")G=function(){b(L)};else if(typeof MessageChannel<"u"){var W=new MessageChannel,le=W.port2;W.port1.onmessage=L,G=function(){le.postMessage(null)}}else G=function(){_(L,0)};function de(ee){A=ee,I||(I=!0,G())}function X(ee,R){P=_(function(){ee(e.unstable_now())},R)}e.unstable_IdlePriority=5,e.unstable_ImmediatePriority=1,e.unstable_LowPriority=4,e.unstable_NormalPriority=3,e.unstable_Profiling=null,e.unstable_UserBlockingPriority=2,e.unstable_cancelCallback=function(ee){ee.callback=null},e.unstable_continueExecution=function(){g||h||(g=!0,de(F))},e.unstable_forceFrameRate=function(ee){0>ee||125<ee?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):j=0<ee?Math.floor(1e3/ee):5},e.unstable_getCurrentPriorityLevel=function(){return d},e.unstable_getFirstCallbackNode=function(){return r(l)},e.unstable_next=function(ee){switch(d){case 1:case 2:case 3:var R=3;break;default:R=d}var pe=d;d=R;try{return ee()}finally{d=pe}},e.unstable_pauseExecution=function(){},e.unstable_requestPaint=function(){},e.unstable_runWithPriority=function(ee,R){switch(ee){case 1:case 2:case 3:case 4:case 5:break;default:ee=3}var pe=d;d=ee;try{return R()}finally{d=pe}},e.unstable_scheduleCallback=function(ee,R,pe){var me=e.unstable_now();switch(typeof pe=="object"&&pe!==null?(pe=pe.delay,pe=typeof pe=="number"&&0<pe?me+pe:me):pe=me,ee){case 1:var E=-1;break;case 2:E=250;break;case 5:E=1073741823;break;case 4:E=1e4;break;default:E=5e3}return E=pe+E,ee={id:u++,callback:R,priorityLevel:ee,startTime:pe,expirationTime:E,sortIndex:-1},pe>me?(ee.sortIndex=pe,t(c,ee),r(l)===null&&ee===r(c)&&(m?(y(P),P=-1):m=!0,X(T,pe-me))):(ee.sortIndex=E,t(l,ee),g||h||(g=!0,de(F))),ee},e.unstable_shouldYield=N,e.unstable_wrapCallback=function(ee){var R=d;return function(){var pe=d;d=R;try{return ee.apply(this,arguments)}finally{d=pe}}}})(m6);p6.exports=m6;var kN=p6.exports;/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var EN=ie,Ra=kN;function We(e){for(var t="https://reactjs.org/docs/error-decoder.html?invariant="+e,r=1;r<arguments.length;r++)t+="&args[]="+encodeURIComponent(arguments[r]);return"Minified React error #"+e+"; visit "+t+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var g6=new Set,Uf={};function oc(e,t){Ru(e,t),Ru(e+"Capture",t)}function Ru(e,t){for(Uf[e]=t,e=0;e<t.length;e++)g6.add(t[e])}var Gs=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),V2=Object.prototype.hasOwnProperty,AN=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,Aw={},Tw={};function TN(e){return V2.call(Tw,e)?!0:V2.call(Aw,e)?!1:AN.test(e)?Tw[e]=!0:(Aw[e]=!0,!1)}function CN(e,t,r,n){if(r!==null&&r.type===0)return!1;switch(typeof t){case"function":case"symbol":return!0;case"boolean":return n?!1:r!==null?!r.acceptsBooleans:(e=e.toLowerCase().slice(0,5),e!=="data-"&&e!=="aria-");default:return!1}}function NN(e,t,r,n){if(t===null||typeof t>"u"||CN(e,t,r,n))return!0;if(n)return!1;if(r!==null)switch(r.type){case 3:return!t;case 4:return t===!1;case 5:return isNaN(t);case 6:return isNaN(t)||1>t}return!1}function oa(e,t,r,n,a,i,s){this.acceptsBooleans=t===2||t===3||t===4,this.attributeName=n,this.attributeNamespace=a,this.mustUseProperty=r,this.propertyName=e,this.type=t,this.sanitizeURL=i,this.removeEmptyString=s}var En={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(e){En[e]=new oa(e,0,!1,e,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(e){var t=e[0];En[t]=new oa(t,1,!1,e[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(e){En[e]=new oa(e,2,!1,e.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(e){En[e]=new oa(e,2,!1,e,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(e){En[e]=new oa(e,3,!1,e.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(e){En[e]=new oa(e,3,!0,e,null,!1,!1)});["capture","download"].forEach(function(e){En[e]=new oa(e,4,!1,e,null,!1,!1)});["cols","rows","size","span"].forEach(function(e){En[e]=new oa(e,6,!1,e,null,!1,!1)});["rowSpan","start"].forEach(function(e){En[e]=new oa(e,5,!1,e.toLowerCase(),null,!1,!1)});var zv=/[\-:]([a-z])/g;function Hv(e){return e[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(e){var t=e.replace(zv,Hv);En[t]=new oa(t,1,!1,e,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(e){var t=e.replace(zv,Hv);En[t]=new oa(t,1,!1,e,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(e){var t=e.replace(zv,Hv);En[t]=new oa(t,1,!1,e,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(e){En[e]=new oa(e,1,!1,e.toLowerCase(),null,!1,!1)});En.xlinkHref=new oa("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(e){En[e]=new oa(e,1,!1,e.toLowerCase(),null,!0,!0)});function Wv(e,t,r,n){var a=En.hasOwnProperty(t)?En[t]:null;(a!==null?a.type!==0:n||!(2<t.length)||t[0]!=="o"&&t[0]!=="O"||t[1]!=="n"&&t[1]!=="N")&&(NN(t,r,a,n)&&(r=null),n||a===null?TN(t)&&(r===null?e.removeAttribute(t):e.setAttribute(t,""+r)):a.mustUseProperty?e[a.propertyName]=r===null?a.type===3?!1:"":r:(t=a.attributeName,n=a.attributeNamespace,r===null?e.removeAttribute(t):(a=a.type,r=a===3||a===4&&r===!0?"":""+r,n?e.setAttributeNS(n,t,r):e.setAttribute(t,r))))}var ro=EN.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,Dd=Symbol.for("react.element"),nu=Symbol.for("react.portal"),au=Symbol.for("react.fragment"),qv=Symbol.for("react.strict_mode"),z2=Symbol.for("react.profiler"),x6=Symbol.for("react.provider"),v6=Symbol.for("react.context"),Gv=Symbol.for("react.forward_ref"),H2=Symbol.for("react.suspense"),W2=Symbol.for("react.suspense_list"),Kv=Symbol.for("react.memo"),To=Symbol.for("react.lazy"),y6=Symbol.for("react.offscreen"),Cw=Symbol.iterator;function M0(e){return e===null||typeof e!="object"?null:(e=Cw&&e[Cw]||e["@@iterator"],typeof e=="function"?e:null)}var Ar=Object.assign,Eg;function Q0(e){if(Eg===void 0)try{throw Error()}catch(r){var t=r.stack.trim().match(/\n( *(at )?)/);Eg=t&&t[1]||""}return`
`+Eg+e}var Ag=!1;function Tg(e,t){if(!e||Ag)return"";Ag=!0;var r=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(t)if(t=function(){throw Error()},Object.defineProperty(t.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(t,[])}catch(c){var n=c}Reflect.construct(e,[],t)}else{try{t.call()}catch(c){n=c}e.call(t.prototype)}else{try{throw Error()}catch(c){n=c}e()}}catch(c){if(c&&n&&typeof c.stack=="string"){for(var a=c.stack.split(`
`),i=n.stack.split(`
`),s=a.length-1,o=i.length-1;1<=s&&0<=o&&a[s]!==i[o];)o--;for(;1<=s&&0<=o;s--,o--)if(a[s]!==i[o]){if(s!==1||o!==1)do if(s--,o--,0>o||a[s]!==i[o]){var l=`
`+a[s].replace(" at new "," at ");return e.displayName&&l.includes("<anonymous>")&&(l=l.replace("<anonymous>",e.displayName)),l}while(1<=s&&0<=o);break}}}finally{Ag=!1,Error.prepareStackTrace=r}return(e=e?e.displayName||e.name:"")?Q0(e):""}function PN(e){switch(e.tag){case 5:return Q0(e.type);case 16:return Q0("Lazy");case 13:return Q0("Suspense");case 19:return Q0("SuspenseList");case 0:case 2:case 15:return e=Tg(e.type,!1),e;case 11:return e=Tg(e.type.render,!1),e;case 1:return e=Tg(e.type,!0),e;default:return""}}function q2(e){if(e==null)return null;if(typeof e=="function")return e.displayName||e.name||null;if(typeof e=="string")return e;switch(e){case au:return"Fragment";case nu:return"Portal";case z2:return"Profiler";case qv:return"StrictMode";case H2:return"Suspense";case W2:return"SuspenseList"}if(typeof e=="object")switch(e.$$typeof){case v6:return(e.displayName||"Context")+".Consumer";case x6:return(e._context.displayName||"Context")+".Provider";case Gv:var t=e.render;return e=e.displayName,e||(e=t.displayName||t.name||"",e=e!==""?"ForwardRef("+e+")":"ForwardRef"),e;case Kv:return t=e.displayName||null,t!==null?t:q2(e.type)||"Memo";case To:t=e._payload,e=e._init;try{return q2(e(t))}catch{}}return null}function LN(e){var t=e.type;switch(e.tag){case 24:return"Cache";case 9:return(t.displayName||"Context")+".Consumer";case 10:return(t._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return e=t.render,e=e.displayName||e.name||"",t.displayName||(e!==""?"ForwardRef("+e+")":"ForwardRef");case 7:return"Fragment";case 5:return t;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return q2(t);case 8:return t===qv?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof t=="function")return t.displayName||t.name||null;if(typeof t=="string")return t}return null}function Zo(e){switch(typeof e){case"boolean":case"number":case"string":case"undefined":return e;case"object":return e;default:return""}}function w6(e){var t=e.type;return(e=e.nodeName)&&e.toLowerCase()==="input"&&(t==="checkbox"||t==="radio")}function FN(e){var t=w6(e)?"checked":"value",r=Object.getOwnPropertyDescriptor(e.constructor.prototype,t),n=""+e[t];if(!e.hasOwnProperty(t)&&typeof r<"u"&&typeof r.get=="function"&&typeof r.set=="function"){var a=r.get,i=r.set;return Object.defineProperty(e,t,{configurable:!0,get:function(){return a.call(this)},set:function(s){n=""+s,i.call(this,s)}}),Object.defineProperty(e,t,{enumerable:r.enumerable}),{getValue:function(){return n},setValue:function(s){n=""+s},stopTracking:function(){e._valueTracker=null,delete e[t]}}}}function jd(e){e._valueTracker||(e._valueTracker=FN(e))}function b6(e){if(!e)return!1;var t=e._valueTracker;if(!t)return!0;var r=t.getValue(),n="";return e&&(n=w6(e)?e.checked?"true":"false":e.value),e=n,e!==r?(t.setValue(e),!0):!1}function Wp(e){if(e=e||(typeof document<"u"?document:void 0),typeof e>"u")return null;try{return e.activeElement||e.body}catch{return e.body}}function G2(e,t){var r=t.checked;return Ar({},t,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:r??e._wrapperState.initialChecked})}function Nw(e,t){var r=t.defaultValue==null?"":t.defaultValue,n=t.checked!=null?t.checked:t.defaultChecked;r=Zo(t.value!=null?t.value:r),e._wrapperState={initialChecked:n,initialValue:r,controlled:t.type==="checkbox"||t.type==="radio"?t.checked!=null:t.value!=null}}function _6(e,t){t=t.checked,t!=null&&Wv(e,"checked",t,!1)}function K2(e,t){_6(e,t);var r=Zo(t.value),n=t.type;if(r!=null)n==="number"?(r===0&&e.value===""||e.value!=r)&&(e.value=""+r):e.value!==""+r&&(e.value=""+r);else if(n==="submit"||n==="reset"){e.removeAttribute("value");return}t.hasOwnProperty("value")?X2(e,t.type,r):t.hasOwnProperty("defaultValue")&&X2(e,t.type,Zo(t.defaultValue)),t.checked==null&&t.defaultChecked!=null&&(e.defaultChecked=!!t.defaultChecked)}function Pw(e,t,r){if(t.hasOwnProperty("value")||t.hasOwnProperty("defaultValue")){var n=t.type;if(!(n!=="submit"&&n!=="reset"||t.value!==void 0&&t.value!==null))return;t=""+e._wrapperState.initialValue,r||t===e.value||(e.value=t),e.defaultValue=t}r=e.name,r!==""&&(e.name=""),e.defaultChecked=!!e._wrapperState.initialChecked,r!==""&&(e.name=r)}function X2(e,t,r){(t!=="number"||Wp(e.ownerDocument)!==e)&&(r==null?e.defaultValue=""+e._wrapperState.initialValue:e.defaultValue!==""+r&&(e.defaultValue=""+r))}var Z0=Array.isArray;function _u(e,t,r,n){if(e=e.options,t){t={};for(var a=0;a<r.length;a++)t["$"+r[a]]=!0;for(r=0;r<e.length;r++)a=t.hasOwnProperty("$"+e[r].value),e[r].selected!==a&&(e[r].selected=a),a&&n&&(e[r].defaultSelected=!0)}else{for(r=""+Zo(r),t=null,a=0;a<e.length;a++){if(e[a].value===r){e[a].selected=!0,n&&(e[a].defaultSelected=!0);return}t!==null||e[a].disabled||(t=e[a])}t!==null&&(t.selected=!0)}}function Y2(e,t){if(t.dangerouslySetInnerHTML!=null)throw Error(We(91));return Ar({},t,{value:void 0,defaultValue:void 0,children:""+e._wrapperState.initialValue})}function Lw(e,t){var r=t.value;if(r==null){if(r=t.children,t=t.defaultValue,r!=null){if(t!=null)throw Error(We(92));if(Z0(r)){if(1<r.length)throw Error(We(93));r=r[0]}t=r}t==null&&(t=""),r=t}e._wrapperState={initialValue:Zo(r)}}function S6(e,t){var r=Zo(t.value),n=Zo(t.defaultValue);r!=null&&(r=""+r,r!==e.value&&(e.value=r),t.defaultValue==null&&e.defaultValue!==r&&(e.defaultValue=r)),n!=null&&(e.defaultValue=""+n)}function Fw(e){var t=e.textContent;t===e._wrapperState.initialValue&&t!==""&&t!==null&&(e.value=t)}function k6(e){switch(e){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function J2(e,t){return e==null||e==="http://www.w3.org/1999/xhtml"?k6(t):e==="http://www.w3.org/2000/svg"&&t==="foreignObject"?"http://www.w3.org/1999/xhtml":e}var Rd,E6=function(e){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(t,r,n,a){MSApp.execUnsafeLocalFunction(function(){return e(t,r,n,a)})}:e}(function(e,t){if(e.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in e)e.innerHTML=t;else{for(Rd=Rd||document.createElement("div"),Rd.innerHTML="<svg>"+t.valueOf().toString()+"</svg>",t=Rd.firstChild;e.firstChild;)e.removeChild(e.firstChild);for(;t.firstChild;)e.appendChild(t.firstChild)}});function $f(e,t){if(t){var r=e.firstChild;if(r&&r===e.lastChild&&r.nodeType===3){r.nodeValue=t;return}}e.textContent=t}var cf={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},ON=["Webkit","ms","Moz","O"];Object.keys(cf).forEach(function(e){ON.forEach(function(t){t=t+e.charAt(0).toUpperCase()+e.substring(1),cf[t]=cf[e]})});function A6(e,t,r){return t==null||typeof t=="boolean"||t===""?"":r||typeof t!="number"||t===0||cf.hasOwnProperty(e)&&cf[e]?(""+t).trim():t+"px"}function T6(e,t){e=e.style;for(var r in t)if(t.hasOwnProperty(r)){var n=r.indexOf("--")===0,a=A6(r,t[r],n);r==="float"&&(r="cssFloat"),n?e.setProperty(r,a):e[r]=a}}var IN=Ar({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function Q2(e,t){if(t){if(IN[e]&&(t.children!=null||t.dangerouslySetInnerHTML!=null))throw Error(We(137,e));if(t.dangerouslySetInnerHTML!=null){if(t.children!=null)throw Error(We(60));if(typeof t.dangerouslySetInnerHTML!="object"||!("__html"in t.dangerouslySetInnerHTML))throw Error(We(61))}if(t.style!=null&&typeof t.style!="object")throw Error(We(62))}}function Z2(e,t){if(e.indexOf("-")===-1)return typeof t.is=="string";switch(e){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var ex=null;function Xv(e){return e=e.target||e.srcElement||window,e.correspondingUseElement&&(e=e.correspondingUseElement),e.nodeType===3?e.parentNode:e}var tx=null,Su=null,ku=null;function Ow(e){if(e=Ah(e)){if(typeof tx!="function")throw Error(We(280));var t=e.stateNode;t&&(t=Q1(t),tx(e.stateNode,e.type,t))}}function C6(e){Su?ku?ku.push(e):ku=[e]:Su=e}function N6(){if(Su){var e=Su,t=ku;if(ku=Su=null,Ow(e),t)for(e=0;e<t.length;e++)Ow(t[e])}}function P6(e,t){return e(t)}function L6(){}var Cg=!1;function F6(e,t,r){if(Cg)return e(t,r);Cg=!0;try{return P6(e,t,r)}finally{Cg=!1,(Su!==null||ku!==null)&&(L6(),N6())}}function Vf(e,t){var r=e.stateNode;if(r===null)return null;var n=Q1(r);if(n===null)return null;r=n[t];e:switch(t){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(n=!n.disabled)||(e=e.type,n=!(e==="button"||e==="input"||e==="select"||e==="textarea")),e=!n;break e;default:e=!1}if(e)return null;if(r&&typeof r!="function")throw Error(We(231,t,typeof r));return r}var rx=!1;if(Gs)try{var B0={};Object.defineProperty(B0,"passive",{get:function(){rx=!0}}),window.addEventListener("test",B0,B0),window.removeEventListener("test",B0,B0)}catch{rx=!1}function DN(e,t,r,n,a,i,s,o,l){var c=Array.prototype.slice.call(arguments,3);try{t.apply(r,c)}catch(u){this.onError(u)}}var uf=!1,qp=null,Gp=!1,nx=null,jN={onError:function(e){uf=!0,qp=e}};function RN(e,t,r,n,a,i,s,o,l){uf=!1,qp=null,DN.apply(jN,arguments)}function MN(e,t,r,n,a,i,s,o,l){if(RN.apply(this,arguments),uf){if(uf){var c=qp;uf=!1,qp=null}else throw Error(We(198));Gp||(Gp=!0,nx=c)}}function lc(e){var t=e,r=e;if(e.alternate)for(;t.return;)t=t.return;else{e=t;do t=e,t.flags&4098&&(r=t.return),e=t.return;while(e)}return t.tag===3?r:null}function O6(e){if(e.tag===13){var t=e.memoizedState;if(t===null&&(e=e.alternate,e!==null&&(t=e.memoizedState)),t!==null)return t.dehydrated}return null}function Iw(e){if(lc(e)!==e)throw Error(We(188))}function BN(e){var t=e.alternate;if(!t){if(t=lc(e),t===null)throw Error(We(188));return t!==e?null:e}for(var r=e,n=t;;){var a=r.return;if(a===null)break;var i=a.alternate;if(i===null){if(n=a.return,n!==null){r=n;continue}break}if(a.child===i.child){for(i=a.child;i;){if(i===r)return Iw(a),e;if(i===n)return Iw(a),t;i=i.sibling}throw Error(We(188))}if(r.return!==n.return)r=a,n=i;else{for(var s=!1,o=a.child;o;){if(o===r){s=!0,r=a,n=i;break}if(o===n){s=!0,n=a,r=i;break}o=o.sibling}if(!s){for(o=i.child;o;){if(o===r){s=!0,r=i,n=a;break}if(o===n){s=!0,n=i,r=a;break}o=o.sibling}if(!s)throw Error(We(189))}}if(r.alternate!==n)throw Error(We(190))}if(r.tag!==3)throw Error(We(188));return r.stateNode.current===r?e:t}function I6(e){return e=BN(e),e!==null?D6(e):null}function D6(e){if(e.tag===5||e.tag===6)return e;for(e=e.child;e!==null;){var t=D6(e);if(t!==null)return t;e=e.sibling}return null}var j6=Ra.unstable_scheduleCallback,Dw=Ra.unstable_cancelCallback,UN=Ra.unstable_shouldYield,$N=Ra.unstable_requestPaint,Br=Ra.unstable_now,VN=Ra.unstable_getCurrentPriorityLevel,Yv=Ra.unstable_ImmediatePriority,R6=Ra.unstable_UserBlockingPriority,Kp=Ra.unstable_NormalPriority,zN=Ra.unstable_LowPriority,M6=Ra.unstable_IdlePriority,K1=null,ls=null;function HN(e){if(ls&&typeof ls.onCommitFiberRoot=="function")try{ls.onCommitFiberRoot(K1,e,void 0,(e.current.flags&128)===128)}catch{}}var Mi=Math.clz32?Math.clz32:GN,WN=Math.log,qN=Math.LN2;function GN(e){return e>>>=0,e===0?32:31-(WN(e)/qN|0)|0}var Md=64,Bd=4194304;function ef(e){switch(e&-e){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return e&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return e}}function Xp(e,t){var r=e.pendingLanes;if(r===0)return 0;var n=0,a=e.suspendedLanes,i=e.pingedLanes,s=r&268435455;if(s!==0){var o=s&~a;o!==0?n=ef(o):(i&=s,i!==0&&(n=ef(i)))}else s=r&~a,s!==0?n=ef(s):i!==0&&(n=ef(i));if(n===0)return 0;if(t!==0&&t!==n&&!(t&a)&&(a=n&-n,i=t&-t,a>=i||a===16&&(i&4194240)!==0))return t;if(n&4&&(n|=r&16),t=e.entangledLanes,t!==0)for(e=e.entanglements,t&=n;0<t;)r=31-Mi(t),a=1<<r,n|=e[r],t&=~a;return n}function KN(e,t){switch(e){case 1:case 2:case 4:return t+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function XN(e,t){for(var r=e.suspendedLanes,n=e.pingedLanes,a=e.expirationTimes,i=e.pendingLanes;0<i;){var s=31-Mi(i),o=1<<s,l=a[s];l===-1?(!(o&r)||o&n)&&(a[s]=KN(o,t)):l<=t&&(e.expiredLanes|=o),i&=~o}}function ax(e){return e=e.pendingLanes&-1073741825,e!==0?e:e&1073741824?1073741824:0}function B6(){var e=Md;return Md<<=1,!(Md&4194240)&&(Md=64),e}function Ng(e){for(var t=[],r=0;31>r;r++)t.push(e);return t}function kh(e,t,r){e.pendingLanes|=t,t!==536870912&&(e.suspendedLanes=0,e.pingedLanes=0),e=e.eventTimes,t=31-Mi(t),e[t]=r}function YN(e,t){var r=e.pendingLanes&~t;e.pendingLanes=t,e.suspendedLanes=0,e.pingedLanes=0,e.expiredLanes&=t,e.mutableReadLanes&=t,e.entangledLanes&=t,t=e.entanglements;var n=e.eventTimes;for(e=e.expirationTimes;0<r;){var a=31-Mi(r),i=1<<a;t[a]=0,n[a]=-1,e[a]=-1,r&=~i}}function Jv(e,t){var r=e.entangledLanes|=t;for(e=e.entanglements;r;){var n=31-Mi(r),a=1<<n;a&t|e[n]&t&&(e[n]|=t),r&=~a}}var rr=0;function U6(e){return e&=-e,1<e?4<e?e&268435455?16:536870912:4:1}var $6,Qv,V6,z6,H6,ix=!1,Ud=[],zo=null,Ho=null,Wo=null,zf=new Map,Hf=new Map,Lo=[],JN="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function jw(e,t){switch(e){case"focusin":case"focusout":zo=null;break;case"dragenter":case"dragleave":Ho=null;break;case"mouseover":case"mouseout":Wo=null;break;case"pointerover":case"pointerout":zf.delete(t.pointerId);break;case"gotpointercapture":case"lostpointercapture":Hf.delete(t.pointerId)}}function U0(e,t,r,n,a,i){return e===null||e.nativeEvent!==i?(e={blockedOn:t,domEventName:r,eventSystemFlags:n,nativeEvent:i,targetContainers:[a]},t!==null&&(t=Ah(t),t!==null&&Qv(t)),e):(e.eventSystemFlags|=n,t=e.targetContainers,a!==null&&t.indexOf(a)===-1&&t.push(a),e)}function QN(e,t,r,n,a){switch(t){case"focusin":return zo=U0(zo,e,t,r,n,a),!0;case"dragenter":return Ho=U0(Ho,e,t,r,n,a),!0;case"mouseover":return Wo=U0(Wo,e,t,r,n,a),!0;case"pointerover":var i=a.pointerId;return zf.set(i,U0(zf.get(i)||null,e,t,r,n,a)),!0;case"gotpointercapture":return i=a.pointerId,Hf.set(i,U0(Hf.get(i)||null,e,t,r,n,a)),!0}return!1}function W6(e){var t=Ml(e.target);if(t!==null){var r=lc(t);if(r!==null){if(t=r.tag,t===13){if(t=O6(r),t!==null){e.blockedOn=t,H6(e.priority,function(){V6(r)});return}}else if(t===3&&r.stateNode.current.memoizedState.isDehydrated){e.blockedOn=r.tag===3?r.stateNode.containerInfo:null;return}}}e.blockedOn=null}function Ap(e){if(e.blockedOn!==null)return!1;for(var t=e.targetContainers;0<t.length;){var r=sx(e.domEventName,e.eventSystemFlags,t[0],e.nativeEvent);if(r===null){r=e.nativeEvent;var n=new r.constructor(r.type,r);ex=n,r.target.dispatchEvent(n),ex=null}else return t=Ah(r),t!==null&&Qv(t),e.blockedOn=r,!1;t.shift()}return!0}function Rw(e,t,r){Ap(e)&&r.delete(t)}function ZN(){ix=!1,zo!==null&&Ap(zo)&&(zo=null),Ho!==null&&Ap(Ho)&&(Ho=null),Wo!==null&&Ap(Wo)&&(Wo=null),zf.forEach(Rw),Hf.forEach(Rw)}function $0(e,t){e.blockedOn===t&&(e.blockedOn=null,ix||(ix=!0,Ra.unstable_scheduleCallback(Ra.unstable_NormalPriority,ZN)))}function Wf(e){function t(a){return $0(a,e)}if(0<Ud.length){$0(Ud[0],e);for(var r=1;r<Ud.length;r++){var n=Ud[r];n.blockedOn===e&&(n.blockedOn=null)}}for(zo!==null&&$0(zo,e),Ho!==null&&$0(Ho,e),Wo!==null&&$0(Wo,e),zf.forEach(t),Hf.forEach(t),r=0;r<Lo.length;r++)n=Lo[r],n.blockedOn===e&&(n.blockedOn=null);for(;0<Lo.length&&(r=Lo[0],r.blockedOn===null);)W6(r),r.blockedOn===null&&Lo.shift()}var Eu=ro.ReactCurrentBatchConfig,Yp=!0;function e7(e,t,r,n){var a=rr,i=Eu.transition;Eu.transition=null;try{rr=1,Zv(e,t,r,n)}finally{rr=a,Eu.transition=i}}function t7(e,t,r,n){var a=rr,i=Eu.transition;Eu.transition=null;try{rr=4,Zv(e,t,r,n)}finally{rr=a,Eu.transition=i}}function Zv(e,t,r,n){if(Yp){var a=sx(e,t,r,n);if(a===null)Bg(e,t,n,Jp,r),jw(e,n);else if(QN(a,e,t,r,n))n.stopPropagation();else if(jw(e,n),t&4&&-1<JN.indexOf(e)){for(;a!==null;){var i=Ah(a);if(i!==null&&$6(i),i=sx(e,t,r,n),i===null&&Bg(e,t,n,Jp,r),i===a)break;a=i}a!==null&&n.stopPropagation()}else Bg(e,t,n,null,r)}}var Jp=null;function sx(e,t,r,n){if(Jp=null,e=Xv(n),e=Ml(e),e!==null)if(t=lc(e),t===null)e=null;else if(r=t.tag,r===13){if(e=O6(t),e!==null)return e;e=null}else if(r===3){if(t.stateNode.current.memoizedState.isDehydrated)return t.tag===3?t.stateNode.containerInfo:null;e=null}else t!==e&&(e=null);return Jp=e,null}function q6(e){switch(e){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(VN()){case Yv:return 1;case R6:return 4;case Kp:case zN:return 16;case M6:return 536870912;default:return 16}default:return 16}}var Ro=null,ey=null,Tp=null;function G6(){if(Tp)return Tp;var e,t=ey,r=t.length,n,a="value"in Ro?Ro.value:Ro.textContent,i=a.length;for(e=0;e<r&&t[e]===a[e];e++);var s=r-e;for(n=1;n<=s&&t[r-n]===a[i-n];n++);return Tp=a.slice(e,1<n?1-n:void 0)}function Cp(e){var t=e.keyCode;return"charCode"in e?(e=e.charCode,e===0&&t===13&&(e=13)):e=t,e===10&&(e=13),32<=e||e===13?e:0}function $d(){return!0}function Mw(){return!1}function $a(e){function t(r,n,a,i,s){this._reactName=r,this._targetInst=a,this.type=n,this.nativeEvent=i,this.target=s,this.currentTarget=null;for(var o in e)e.hasOwnProperty(o)&&(r=e[o],this[o]=r?r(i):i[o]);return this.isDefaultPrevented=(i.defaultPrevented!=null?i.defaultPrevented:i.returnValue===!1)?$d:Mw,this.isPropagationStopped=Mw,this}return Ar(t.prototype,{preventDefault:function(){this.defaultPrevented=!0;var r=this.nativeEvent;r&&(r.preventDefault?r.preventDefault():typeof r.returnValue!="unknown"&&(r.returnValue=!1),this.isDefaultPrevented=$d)},stopPropagation:function(){var r=this.nativeEvent;r&&(r.stopPropagation?r.stopPropagation():typeof r.cancelBubble!="unknown"&&(r.cancelBubble=!0),this.isPropagationStopped=$d)},persist:function(){},isPersistent:$d}),t}var Zu={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(e){return e.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},ty=$a(Zu),Eh=Ar({},Zu,{view:0,detail:0}),r7=$a(Eh),Pg,Lg,V0,X1=Ar({},Eh,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:ry,button:0,buttons:0,relatedTarget:function(e){return e.relatedTarget===void 0?e.fromElement===e.srcElement?e.toElement:e.fromElement:e.relatedTarget},movementX:function(e){return"movementX"in e?e.movementX:(e!==V0&&(V0&&e.type==="mousemove"?(Pg=e.screenX-V0.screenX,Lg=e.screenY-V0.screenY):Lg=Pg=0,V0=e),Pg)},movementY:function(e){return"movementY"in e?e.movementY:Lg}}),Bw=$a(X1),n7=Ar({},X1,{dataTransfer:0}),a7=$a(n7),i7=Ar({},Eh,{relatedTarget:0}),Fg=$a(i7),s7=Ar({},Zu,{animationName:0,elapsedTime:0,pseudoElement:0}),o7=$a(s7),l7=Ar({},Zu,{clipboardData:function(e){return"clipboardData"in e?e.clipboardData:window.clipboardData}}),c7=$a(l7),u7=Ar({},Zu,{data:0}),Uw=$a(u7),f7={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},h7={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},d7={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function p7(e){var t=this.nativeEvent;return t.getModifierState?t.getModifierState(e):(e=d7[e])?!!t[e]:!1}function ry(){return p7}var m7=Ar({},Eh,{key:function(e){if(e.key){var t=f7[e.key]||e.key;if(t!=="Unidentified")return t}return e.type==="keypress"?(e=Cp(e),e===13?"Enter":String.fromCharCode(e)):e.type==="keydown"||e.type==="keyup"?h7[e.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:ry,charCode:function(e){return e.type==="keypress"?Cp(e):0},keyCode:function(e){return e.type==="keydown"||e.type==="keyup"?e.keyCode:0},which:function(e){return e.type==="keypress"?Cp(e):e.type==="keydown"||e.type==="keyup"?e.keyCode:0}}),g7=$a(m7),x7=Ar({},X1,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),$w=$a(x7),v7=Ar({},Eh,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:ry}),y7=$a(v7),w7=Ar({},Zu,{propertyName:0,elapsedTime:0,pseudoElement:0}),b7=$a(w7),_7=Ar({},X1,{deltaX:function(e){return"deltaX"in e?e.deltaX:"wheelDeltaX"in e?-e.wheelDeltaX:0},deltaY:function(e){return"deltaY"in e?e.deltaY:"wheelDeltaY"in e?-e.wheelDeltaY:"wheelDelta"in e?-e.wheelDelta:0},deltaZ:0,deltaMode:0}),S7=$a(_7),k7=[9,13,27,32],ny=Gs&&"CompositionEvent"in window,ff=null;Gs&&"documentMode"in document&&(ff=document.documentMode);var E7=Gs&&"TextEvent"in window&&!ff,K6=Gs&&(!ny||ff&&8<ff&&11>=ff),Vw=" ",zw=!1;function X6(e,t){switch(e){case"keyup":return k7.indexOf(t.keyCode)!==-1;case"keydown":return t.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function Y6(e){return e=e.detail,typeof e=="object"&&"data"in e?e.data:null}var iu=!1;function A7(e,t){switch(e){case"compositionend":return Y6(t);case"keypress":return t.which!==32?null:(zw=!0,Vw);case"textInput":return e=t.data,e===Vw&&zw?null:e;default:return null}}function T7(e,t){if(iu)return e==="compositionend"||!ny&&X6(e,t)?(e=G6(),Tp=ey=Ro=null,iu=!1,e):null;switch(e){case"paste":return null;case"keypress":if(!(t.ctrlKey||t.altKey||t.metaKey)||t.ctrlKey&&t.altKey){if(t.char&&1<t.char.length)return t.char;if(t.which)return String.fromCharCode(t.which)}return null;case"compositionend":return K6&&t.locale!=="ko"?null:t.data;default:return null}}var C7={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function Hw(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t==="input"?!!C7[e.type]:t==="textarea"}function J6(e,t,r,n){C6(n),t=Qp(t,"onChange"),0<t.length&&(r=new ty("onChange","change",null,r,n),e.push({event:r,listeners:t}))}var hf=null,qf=null;function N7(e){lS(e,0)}function Y1(e){var t=lu(e);if(b6(t))return e}function P7(e,t){if(e==="change")return t}var Q6=!1;if(Gs){var Og;if(Gs){var Ig="oninput"in document;if(!Ig){var Ww=document.createElement("div");Ww.setAttribute("oninput","return;"),Ig=typeof Ww.oninput=="function"}Og=Ig}else Og=!1;Q6=Og&&(!document.documentMode||9<document.documentMode)}function qw(){hf&&(hf.detachEvent("onpropertychange",Z6),qf=hf=null)}function Z6(e){if(e.propertyName==="value"&&Y1(qf)){var t=[];J6(t,qf,e,Xv(e)),F6(N7,t)}}function L7(e,t,r){e==="focusin"?(qw(),hf=t,qf=r,hf.attachEvent("onpropertychange",Z6)):e==="focusout"&&qw()}function F7(e){if(e==="selectionchange"||e==="keyup"||e==="keydown")return Y1(qf)}function O7(e,t){if(e==="click")return Y1(t)}function I7(e,t){if(e==="input"||e==="change")return Y1(t)}function D7(e,t){return e===t&&(e!==0||1/e===1/t)||e!==e&&t!==t}var Vi=typeof Object.is=="function"?Object.is:D7;function Gf(e,t){if(Vi(e,t))return!0;if(typeof e!="object"||e===null||typeof t!="object"||t===null)return!1;var r=Object.keys(e),n=Object.keys(t);if(r.length!==n.length)return!1;for(n=0;n<r.length;n++){var a=r[n];if(!V2.call(t,a)||!Vi(e[a],t[a]))return!1}return!0}function Gw(e){for(;e&&e.firstChild;)e=e.firstChild;return e}function Kw(e,t){var r=Gw(e);e=0;for(var n;r;){if(r.nodeType===3){if(n=e+r.textContent.length,e<=t&&n>=t)return{node:r,offset:t-e};e=n}e:{for(;r;){if(r.nextSibling){r=r.nextSibling;break e}r=r.parentNode}r=void 0}r=Gw(r)}}function eS(e,t){return e&&t?e===t?!0:e&&e.nodeType===3?!1:t&&t.nodeType===3?eS(e,t.parentNode):"contains"in e?e.contains(t):e.compareDocumentPosition?!!(e.compareDocumentPosition(t)&16):!1:!1}function tS(){for(var e=window,t=Wp();t instanceof e.HTMLIFrameElement;){try{var r=typeof t.contentWindow.location.href=="string"}catch{r=!1}if(r)e=t.contentWindow;else break;t=Wp(e.document)}return t}function ay(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t&&(t==="input"&&(e.type==="text"||e.type==="search"||e.type==="tel"||e.type==="url"||e.type==="password")||t==="textarea"||e.contentEditable==="true")}function j7(e){var t=tS(),r=e.focusedElem,n=e.selectionRange;if(t!==r&&r&&r.ownerDocument&&eS(r.ownerDocument.documentElement,r)){if(n!==null&&ay(r)){if(t=n.start,e=n.end,e===void 0&&(e=t),"selectionStart"in r)r.selectionStart=t,r.selectionEnd=Math.min(e,r.value.length);else if(e=(t=r.ownerDocument||document)&&t.defaultView||window,e.getSelection){e=e.getSelection();var a=r.textContent.length,i=Math.min(n.start,a);n=n.end===void 0?i:Math.min(n.end,a),!e.extend&&i>n&&(a=n,n=i,i=a),a=Kw(r,i);var s=Kw(r,n);a&&s&&(e.rangeCount!==1||e.anchorNode!==a.node||e.anchorOffset!==a.offset||e.focusNode!==s.node||e.focusOffset!==s.offset)&&(t=t.createRange(),t.setStart(a.node,a.offset),e.removeAllRanges(),i>n?(e.addRange(t),e.extend(s.node,s.offset)):(t.setEnd(s.node,s.offset),e.addRange(t)))}}for(t=[],e=r;e=e.parentNode;)e.nodeType===1&&t.push({element:e,left:e.scrollLeft,top:e.scrollTop});for(typeof r.focus=="function"&&r.focus(),r=0;r<t.length;r++)e=t[r],e.element.scrollLeft=e.left,e.element.scrollTop=e.top}}var R7=Gs&&"documentMode"in document&&11>=document.documentMode,su=null,ox=null,df=null,lx=!1;function Xw(e,t,r){var n=r.window===r?r.document:r.nodeType===9?r:r.ownerDocument;lx||su==null||su!==Wp(n)||(n=su,"selectionStart"in n&&ay(n)?n={start:n.selectionStart,end:n.selectionEnd}:(n=(n.ownerDocument&&n.ownerDocument.defaultView||window).getSelection(),n={anchorNode:n.anchorNode,anchorOffset:n.anchorOffset,focusNode:n.focusNode,focusOffset:n.focusOffset}),df&&Gf(df,n)||(df=n,n=Qp(ox,"onSelect"),0<n.length&&(t=new ty("onSelect","select",null,t,r),e.push({event:t,listeners:n}),t.target=su)))}function Vd(e,t){var r={};return r[e.toLowerCase()]=t.toLowerCase(),r["Webkit"+e]="webkit"+t,r["Moz"+e]="moz"+t,r}var ou={animationend:Vd("Animation","AnimationEnd"),animationiteration:Vd("Animation","AnimationIteration"),animationstart:Vd("Animation","AnimationStart"),transitionend:Vd("Transition","TransitionEnd")},Dg={},rS={};Gs&&(rS=document.createElement("div").style,"AnimationEvent"in window||(delete ou.animationend.animation,delete ou.animationiteration.animation,delete ou.animationstart.animation),"TransitionEvent"in window||delete ou.transitionend.transition);function J1(e){if(Dg[e])return Dg[e];if(!ou[e])return e;var t=ou[e],r;for(r in t)if(t.hasOwnProperty(r)&&r in rS)return Dg[e]=t[r];return e}var nS=J1("animationend"),aS=J1("animationiteration"),iS=J1("animationstart"),sS=J1("transitionend"),oS=new Map,Yw="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function ll(e,t){oS.set(e,t),oc(t,[e])}for(var jg=0;jg<Yw.length;jg++){var Rg=Yw[jg],M7=Rg.toLowerCase(),B7=Rg[0].toUpperCase()+Rg.slice(1);ll(M7,"on"+B7)}ll(nS,"onAnimationEnd");ll(aS,"onAnimationIteration");ll(iS,"onAnimationStart");ll("dblclick","onDoubleClick");ll("focusin","onFocus");ll("focusout","onBlur");ll(sS,"onTransitionEnd");Ru("onMouseEnter",["mouseout","mouseover"]);Ru("onMouseLeave",["mouseout","mouseover"]);Ru("onPointerEnter",["pointerout","pointerover"]);Ru("onPointerLeave",["pointerout","pointerover"]);oc("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));oc("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));oc("onBeforeInput",["compositionend","keypress","textInput","paste"]);oc("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));oc("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));oc("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var tf="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),U7=new Set("cancel close invalid load scroll toggle".split(" ").concat(tf));function Jw(e,t,r){var n=e.type||"unknown-event";e.currentTarget=r,MN(n,t,void 0,e),e.currentTarget=null}function lS(e,t){t=(t&4)!==0;for(var r=0;r<e.length;r++){var n=e[r],a=n.event;n=n.listeners;e:{var i=void 0;if(t)for(var s=n.length-1;0<=s;s--){var o=n[s],l=o.instance,c=o.currentTarget;if(o=o.listener,l!==i&&a.isPropagationStopped())break e;Jw(a,o,c),i=l}else for(s=0;s<n.length;s++){if(o=n[s],l=o.instance,c=o.currentTarget,o=o.listener,l!==i&&a.isPropagationStopped())break e;Jw(a,o,c),i=l}}}if(Gp)throw e=nx,Gp=!1,nx=null,e}function xr(e,t){var r=t[dx];r===void 0&&(r=t[dx]=new Set);var n=e+"__bubble";r.has(n)||(cS(t,e,2,!1),r.add(n))}function Mg(e,t,r){var n=0;t&&(n|=4),cS(r,e,n,t)}var zd="_reactListening"+Math.random().toString(36).slice(2);function Kf(e){if(!e[zd]){e[zd]=!0,g6.forEach(function(r){r!=="selectionchange"&&(U7.has(r)||Mg(r,!1,e),Mg(r,!0,e))});var t=e.nodeType===9?e:e.ownerDocument;t===null||t[zd]||(t[zd]=!0,Mg("selectionchange",!1,t))}}function cS(e,t,r,n){switch(q6(t)){case 1:var a=e7;break;case 4:a=t7;break;default:a=Zv}r=a.bind(null,t,r,e),a=void 0,!rx||t!=="touchstart"&&t!=="touchmove"&&t!=="wheel"||(a=!0),n?a!==void 0?e.addEventListener(t,r,{capture:!0,passive:a}):e.addEventListener(t,r,!0):a!==void 0?e.addEventListener(t,r,{passive:a}):e.addEventListener(t,r,!1)}function Bg(e,t,r,n,a){var i=n;if(!(t&1)&&!(t&2)&&n!==null)e:for(;;){if(n===null)return;var s=n.tag;if(s===3||s===4){var o=n.stateNode.containerInfo;if(o===a||o.nodeType===8&&o.parentNode===a)break;if(s===4)for(s=n.return;s!==null;){var l=s.tag;if((l===3||l===4)&&(l=s.stateNode.containerInfo,l===a||l.nodeType===8&&l.parentNode===a))return;s=s.return}for(;o!==null;){if(s=Ml(o),s===null)return;if(l=s.tag,l===5||l===6){n=i=s;continue e}o=o.parentNode}}n=n.return}F6(function(){var c=i,u=Xv(r),f=[];e:{var d=oS.get(e);if(d!==void 0){var h=ty,g=e;switch(e){case"keypress":if(Cp(r)===0)break e;case"keydown":case"keyup":h=g7;break;case"focusin":g="focus",h=Fg;break;case"focusout":g="blur",h=Fg;break;case"beforeblur":case"afterblur":h=Fg;break;case"click":if(r.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":h=Bw;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":h=a7;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":h=y7;break;case nS:case aS:case iS:h=o7;break;case sS:h=b7;break;case"scroll":h=r7;break;case"wheel":h=S7;break;case"copy":case"cut":case"paste":h=c7;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":h=$w}var m=(t&4)!==0,_=!m&&e==="scroll",y=m?d!==null?d+"Capture":null:d;m=[];for(var b=c,w;b!==null;){w=b;var T=w.stateNode;if(w.tag===5&&T!==null&&(w=T,y!==null&&(T=Vf(b,y),T!=null&&m.push(Xf(b,T,w)))),_)break;b=b.return}0<m.length&&(d=new h(d,g,null,r,u),f.push({event:d,listeners:m}))}}if(!(t&7)){e:{if(d=e==="mouseover"||e==="pointerover",h=e==="mouseout"||e==="pointerout",d&&r!==ex&&(g=r.relatedTarget||r.fromElement)&&(Ml(g)||g[Ks]))break e;if((h||d)&&(d=u.window===u?u:(d=u.ownerDocument)?d.defaultView||d.parentWindow:window,h?(g=r.relatedTarget||r.toElement,h=c,g=g?Ml(g):null,g!==null&&(_=lc(g),g!==_||g.tag!==5&&g.tag!==6)&&(g=null)):(h=null,g=c),h!==g)){if(m=Bw,T="onMouseLeave",y="onMouseEnter",b="mouse",(e==="pointerout"||e==="pointerover")&&(m=$w,T="onPointerLeave",y="onPointerEnter",b="pointer"),_=h==null?d:lu(h),w=g==null?d:lu(g),d=new m(T,b+"leave",h,r,u),d.target=_,d.relatedTarget=w,T=null,Ml(u)===c&&(m=new m(y,b+"enter",g,r,u),m.target=w,m.relatedTarget=_,T=m),_=T,h&&g)t:{for(m=h,y=g,b=0,w=m;w;w=zc(w))b++;for(w=0,T=y;T;T=zc(T))w++;for(;0<b-w;)m=zc(m),b--;for(;0<w-b;)y=zc(y),w--;for(;b--;){if(m===y||y!==null&&m===y.alternate)break t;m=zc(m),y=zc(y)}m=null}else m=null;h!==null&&Qw(f,d,h,m,!1),g!==null&&_!==null&&Qw(f,_,g,m,!0)}}e:{if(d=c?lu(c):window,h=d.nodeName&&d.nodeName.toLowerCase(),h==="select"||h==="input"&&d.type==="file")var F=P7;else if(Hw(d))if(Q6)F=I7;else{F=F7;var I=L7}else(h=d.nodeName)&&h.toLowerCase()==="input"&&(d.type==="checkbox"||d.type==="radio")&&(F=O7);if(F&&(F=F(e,c))){J6(f,F,r,u);break e}I&&I(e,d,c),e==="focusout"&&(I=d._wrapperState)&&I.controlled&&d.type==="number"&&X2(d,"number",d.value)}switch(I=c?lu(c):window,e){case"focusin":(Hw(I)||I.contentEditable==="true")&&(su=I,ox=c,df=null);break;case"focusout":df=ox=su=null;break;case"mousedown":lx=!0;break;case"contextmenu":case"mouseup":case"dragend":lx=!1,Xw(f,r,u);break;case"selectionchange":if(R7)break;case"keydown":case"keyup":Xw(f,r,u)}var A;if(ny)e:{switch(e){case"compositionstart":var P="onCompositionStart";break e;case"compositionend":P="onCompositionEnd";break e;case"compositionupdate":P="onCompositionUpdate";break e}P=void 0}else iu?X6(e,r)&&(P="onCompositionEnd"):e==="keydown"&&r.keyCode===229&&(P="onCompositionStart");P&&(K6&&r.locale!=="ko"&&(iu||P!=="onCompositionStart"?P==="onCompositionEnd"&&iu&&(A=G6()):(Ro=u,ey="value"in Ro?Ro.value:Ro.textContent,iu=!0)),I=Qp(c,P),0<I.length&&(P=new Uw(P,e,null,r,u),f.push({event:P,listeners:I}),A?P.data=A:(A=Y6(r),A!==null&&(P.data=A)))),(A=E7?A7(e,r):T7(e,r))&&(c=Qp(c,"onBeforeInput"),0<c.length&&(u=new Uw("onBeforeInput","beforeinput",null,r,u),f.push({event:u,listeners:c}),u.data=A))}lS(f,t)})}function Xf(e,t,r){return{instance:e,listener:t,currentTarget:r}}function Qp(e,t){for(var r=t+"Capture",n=[];e!==null;){var a=e,i=a.stateNode;a.tag===5&&i!==null&&(a=i,i=Vf(e,r),i!=null&&n.unshift(Xf(e,i,a)),i=Vf(e,t),i!=null&&n.push(Xf(e,i,a))),e=e.return}return n}function zc(e){if(e===null)return null;do e=e.return;while(e&&e.tag!==5);return e||null}function Qw(e,t,r,n,a){for(var i=t._reactName,s=[];r!==null&&r!==n;){var o=r,l=o.alternate,c=o.stateNode;if(l!==null&&l===n)break;o.tag===5&&c!==null&&(o=c,a?(l=Vf(r,i),l!=null&&s.unshift(Xf(r,l,o))):a||(l=Vf(r,i),l!=null&&s.push(Xf(r,l,o)))),r=r.return}s.length!==0&&e.push({event:t,listeners:s})}var $7=/\r\n?/g,V7=/\u0000|\uFFFD/g;function Zw(e){return(typeof e=="string"?e:""+e).replace($7,`
`).replace(V7,"")}function Hd(e,t,r){if(t=Zw(t),Zw(e)!==t&&r)throw Error(We(425))}function Zp(){}var cx=null,ux=null;function fx(e,t){return e==="textarea"||e==="noscript"||typeof t.children=="string"||typeof t.children=="number"||typeof t.dangerouslySetInnerHTML=="object"&&t.dangerouslySetInnerHTML!==null&&t.dangerouslySetInnerHTML.__html!=null}var hx=typeof setTimeout=="function"?setTimeout:void 0,z7=typeof clearTimeout=="function"?clearTimeout:void 0,eb=typeof Promise=="function"?Promise:void 0,H7=typeof queueMicrotask=="function"?queueMicrotask:typeof eb<"u"?function(e){return eb.resolve(null).then(e).catch(W7)}:hx;function W7(e){setTimeout(function(){throw e})}function Ug(e,t){var r=t,n=0;do{var a=r.nextSibling;if(e.removeChild(r),a&&a.nodeType===8)if(r=a.data,r==="/$"){if(n===0){e.removeChild(a),Wf(t);return}n--}else r!=="$"&&r!=="$?"&&r!=="$!"||n++;r=a}while(r);Wf(t)}function qo(e){for(;e!=null;e=e.nextSibling){var t=e.nodeType;if(t===1||t===3)break;if(t===8){if(t=e.data,t==="$"||t==="$!"||t==="$?")break;if(t==="/$")return null}}return e}function tb(e){e=e.previousSibling;for(var t=0;e;){if(e.nodeType===8){var r=e.data;if(r==="$"||r==="$!"||r==="$?"){if(t===0)return e;t--}else r==="/$"&&t++}e=e.previousSibling}return null}var e0=Math.random().toString(36).slice(2),is="__reactFiber$"+e0,Yf="__reactProps$"+e0,Ks="__reactContainer$"+e0,dx="__reactEvents$"+e0,q7="__reactListeners$"+e0,G7="__reactHandles$"+e0;function Ml(e){var t=e[is];if(t)return t;for(var r=e.parentNode;r;){if(t=r[Ks]||r[is]){if(r=t.alternate,t.child!==null||r!==null&&r.child!==null)for(e=tb(e);e!==null;){if(r=e[is])return r;e=tb(e)}return t}e=r,r=e.parentNode}return null}function Ah(e){return e=e[is]||e[Ks],!e||e.tag!==5&&e.tag!==6&&e.tag!==13&&e.tag!==3?null:e}function lu(e){if(e.tag===5||e.tag===6)return e.stateNode;throw Error(We(33))}function Q1(e){return e[Yf]||null}var px=[],cu=-1;function cl(e){return{current:e}}function yr(e){0>cu||(e.current=px[cu],px[cu]=null,cu--)}function dr(e,t){cu++,px[cu]=e.current,e.current=t}var el={},Wn=cl(el),ya=cl(!1),Ql=el;function Mu(e,t){var r=e.type.contextTypes;if(!r)return el;var n=e.stateNode;if(n&&n.__reactInternalMemoizedUnmaskedChildContext===t)return n.__reactInternalMemoizedMaskedChildContext;var a={},i;for(i in r)a[i]=t[i];return n&&(e=e.stateNode,e.__reactInternalMemoizedUnmaskedChildContext=t,e.__reactInternalMemoizedMaskedChildContext=a),a}function wa(e){return e=e.childContextTypes,e!=null}function e1(){yr(ya),yr(Wn)}function rb(e,t,r){if(Wn.current!==el)throw Error(We(168));dr(Wn,t),dr(ya,r)}function uS(e,t,r){var n=e.stateNode;if(t=t.childContextTypes,typeof n.getChildContext!="function")return r;n=n.getChildContext();for(var a in n)if(!(a in t))throw Error(We(108,LN(e)||"Unknown",a));return Ar({},r,n)}function t1(e){return e=(e=e.stateNode)&&e.__reactInternalMemoizedMergedChildContext||el,Ql=Wn.current,dr(Wn,e),dr(ya,ya.current),!0}function nb(e,t,r){var n=e.stateNode;if(!n)throw Error(We(169));r?(e=uS(e,t,Ql),n.__reactInternalMemoizedMergedChildContext=e,yr(ya),yr(Wn),dr(Wn,e)):yr(ya),dr(ya,r)}var Ds=null,Z1=!1,$g=!1;function fS(e){Ds===null?Ds=[e]:Ds.push(e)}function K7(e){Z1=!0,fS(e)}function ul(){if(!$g&&Ds!==null){$g=!0;var e=0,t=rr;try{var r=Ds;for(rr=1;e<r.length;e++){var n=r[e];do n=n(!0);while(n!==null)}Ds=null,Z1=!1}catch(a){throw Ds!==null&&(Ds=Ds.slice(e+1)),j6(Yv,ul),a}finally{rr=t,$g=!1}}return null}var uu=[],fu=0,r1=null,n1=0,ai=[],ii=0,Zl=null,js=1,Rs="";function Tl(e,t){uu[fu++]=n1,uu[fu++]=r1,r1=e,n1=t}function hS(e,t,r){ai[ii++]=js,ai[ii++]=Rs,ai[ii++]=Zl,Zl=e;var n=js;e=Rs;var a=32-Mi(n)-1;n&=~(1<<a),r+=1;var i=32-Mi(t)+a;if(30<i){var s=a-a%5;i=(n&(1<<s)-1).toString(32),n>>=s,a-=s,js=1<<32-Mi(t)+a|r<<a|n,Rs=i+e}else js=1<<i|r<<a|n,Rs=e}function iy(e){e.return!==null&&(Tl(e,1),hS(e,1,0))}function sy(e){for(;e===r1;)r1=uu[--fu],uu[fu]=null,n1=uu[--fu],uu[fu]=null;for(;e===Zl;)Zl=ai[--ii],ai[ii]=null,Rs=ai[--ii],ai[ii]=null,js=ai[--ii],ai[ii]=null}var ja=null,Ia=null,br=!1,Oi=null;function dS(e,t){var r=si(5,null,null,0);r.elementType="DELETED",r.stateNode=t,r.return=e,t=e.deletions,t===null?(e.deletions=[r],e.flags|=16):t.push(r)}function ab(e,t){switch(e.tag){case 5:var r=e.type;return t=t.nodeType!==1||r.toLowerCase()!==t.nodeName.toLowerCase()?null:t,t!==null?(e.stateNode=t,ja=e,Ia=qo(t.firstChild),!0):!1;case 6:return t=e.pendingProps===""||t.nodeType!==3?null:t,t!==null?(e.stateNode=t,ja=e,Ia=null,!0):!1;case 13:return t=t.nodeType!==8?null:t,t!==null?(r=Zl!==null?{id:js,overflow:Rs}:null,e.memoizedState={dehydrated:t,treeContext:r,retryLane:1073741824},r=si(18,null,null,0),r.stateNode=t,r.return=e,e.child=r,ja=e,Ia=null,!0):!1;default:return!1}}function mx(e){return(e.mode&1)!==0&&(e.flags&128)===0}function gx(e){if(br){var t=Ia;if(t){var r=t;if(!ab(e,t)){if(mx(e))throw Error(We(418));t=qo(r.nextSibling);var n=ja;t&&ab(e,t)?dS(n,r):(e.flags=e.flags&-4097|2,br=!1,ja=e)}}else{if(mx(e))throw Error(We(418));e.flags=e.flags&-4097|2,br=!1,ja=e}}}function ib(e){for(e=e.return;e!==null&&e.tag!==5&&e.tag!==3&&e.tag!==13;)e=e.return;ja=e}function Wd(e){if(e!==ja)return!1;if(!br)return ib(e),br=!0,!1;var t;if((t=e.tag!==3)&&!(t=e.tag!==5)&&(t=e.type,t=t!=="head"&&t!=="body"&&!fx(e.type,e.memoizedProps)),t&&(t=Ia)){if(mx(e))throw pS(),Error(We(418));for(;t;)dS(e,t),t=qo(t.nextSibling)}if(ib(e),e.tag===13){if(e=e.memoizedState,e=e!==null?e.dehydrated:null,!e)throw Error(We(317));e:{for(e=e.nextSibling,t=0;e;){if(e.nodeType===8){var r=e.data;if(r==="/$"){if(t===0){Ia=qo(e.nextSibling);break e}t--}else r!=="$"&&r!=="$!"&&r!=="$?"||t++}e=e.nextSibling}Ia=null}}else Ia=ja?qo(e.stateNode.nextSibling):null;return!0}function pS(){for(var e=Ia;e;)e=qo(e.nextSibling)}function Bu(){Ia=ja=null,br=!1}function oy(e){Oi===null?Oi=[e]:Oi.push(e)}var X7=ro.ReactCurrentBatchConfig;function z0(e,t,r){if(e=r.ref,e!==null&&typeof e!="function"&&typeof e!="object"){if(r._owner){if(r=r._owner,r){if(r.tag!==1)throw Error(We(309));var n=r.stateNode}if(!n)throw Error(We(147,e));var a=n,i=""+e;return t!==null&&t.ref!==null&&typeof t.ref=="function"&&t.ref._stringRef===i?t.ref:(t=function(s){var o=a.refs;s===null?delete o[i]:o[i]=s},t._stringRef=i,t)}if(typeof e!="string")throw Error(We(284));if(!r._owner)throw Error(We(290,e))}return e}function qd(e,t){throw e=Object.prototype.toString.call(t),Error(We(31,e==="[object Object]"?"object with keys {"+Object.keys(t).join(", ")+"}":e))}function sb(e){var t=e._init;return t(e._payload)}function mS(e){function t(y,b){if(e){var w=y.deletions;w===null?(y.deletions=[b],y.flags|=16):w.push(b)}}function r(y,b){if(!e)return null;for(;b!==null;)t(y,b),b=b.sibling;return null}function n(y,b){for(y=new Map;b!==null;)b.key!==null?y.set(b.key,b):y.set(b.index,b),b=b.sibling;return y}function a(y,b){return y=Yo(y,b),y.index=0,y.sibling=null,y}function i(y,b,w){return y.index=w,e?(w=y.alternate,w!==null?(w=w.index,w<b?(y.flags|=2,b):w):(y.flags|=2,b)):(y.flags|=1048576,b)}function s(y){return e&&y.alternate===null&&(y.flags|=2),y}function o(y,b,w,T){return b===null||b.tag!==6?(b=Kg(w,y.mode,T),b.return=y,b):(b=a(b,w),b.return=y,b)}function l(y,b,w,T){var F=w.type;return F===au?u(y,b,w.props.children,T,w.key):b!==null&&(b.elementType===F||typeof F=="object"&&F!==null&&F.$$typeof===To&&sb(F)===b.type)?(T=a(b,w.props),T.ref=z0(y,b,w),T.return=y,T):(T=Dp(w.type,w.key,w.props,null,y.mode,T),T.ref=z0(y,b,w),T.return=y,T)}function c(y,b,w,T){return b===null||b.tag!==4||b.stateNode.containerInfo!==w.containerInfo||b.stateNode.implementation!==w.implementation?(b=Xg(w,y.mode,T),b.return=y,b):(b=a(b,w.children||[]),b.return=y,b)}function u(y,b,w,T,F){return b===null||b.tag!==7?(b=Wl(w,y.mode,T,F),b.return=y,b):(b=a(b,w),b.return=y,b)}function f(y,b,w){if(typeof b=="string"&&b!==""||typeof b=="number")return b=Kg(""+b,y.mode,w),b.return=y,b;if(typeof b=="object"&&b!==null){switch(b.$$typeof){case Dd:return w=Dp(b.type,b.key,b.props,null,y.mode,w),w.ref=z0(y,null,b),w.return=y,w;case nu:return b=Xg(b,y.mode,w),b.return=y,b;case To:var T=b._init;return f(y,T(b._payload),w)}if(Z0(b)||M0(b))return b=Wl(b,y.mode,w,null),b.return=y,b;qd(y,b)}return null}function d(y,b,w,T){var F=b!==null?b.key:null;if(typeof w=="string"&&w!==""||typeof w=="number")return F!==null?null:o(y,b,""+w,T);if(typeof w=="object"&&w!==null){switch(w.$$typeof){case Dd:return w.key===F?l(y,b,w,T):null;case nu:return w.key===F?c(y,b,w,T):null;case To:return F=w._init,d(y,b,F(w._payload),T)}if(Z0(w)||M0(w))return F!==null?null:u(y,b,w,T,null);qd(y,w)}return null}function h(y,b,w,T,F){if(typeof T=="string"&&T!==""||typeof T=="number")return y=y.get(w)||null,o(b,y,""+T,F);if(typeof T=="object"&&T!==null){switch(T.$$typeof){case Dd:return y=y.get(T.key===null?w:T.key)||null,l(b,y,T,F);case nu:return y=y.get(T.key===null?w:T.key)||null,c(b,y,T,F);case To:var I=T._init;return h(y,b,w,I(T._payload),F)}if(Z0(T)||M0(T))return y=y.get(w)||null,u(b,y,T,F,null);qd(b,T)}return null}function g(y,b,w,T){for(var F=null,I=null,A=b,P=b=0,j=null;A!==null&&P<w.length;P++){A.index>P?(j=A,A=null):j=A.sibling;var J=d(y,A,w[P],T);if(J===null){A===null&&(A=j);break}e&&A&&J.alternate===null&&t(y,A),b=i(J,b,P),I===null?F=J:I.sibling=J,I=J,A=j}if(P===w.length)return r(y,A),br&&Tl(y,P),F;if(A===null){for(;P<w.length;P++)A=f(y,w[P],T),A!==null&&(b=i(A,b,P),I===null?F=A:I.sibling=A,I=A);return br&&Tl(y,P),F}for(A=n(y,A);P<w.length;P++)j=h(A,y,P,w[P],T),j!==null&&(e&&j.alternate!==null&&A.delete(j.key===null?P:j.key),b=i(j,b,P),I===null?F=j:I.sibling=j,I=j);return e&&A.forEach(function(N){return t(y,N)}),br&&Tl(y,P),F}function m(y,b,w,T){var F=M0(w);if(typeof F!="function")throw Error(We(150));if(w=F.call(w),w==null)throw Error(We(151));for(var I=F=null,A=b,P=b=0,j=null,J=w.next();A!==null&&!J.done;P++,J=w.next()){A.index>P?(j=A,A=null):j=A.sibling;var N=d(y,A,J.value,T);if(N===null){A===null&&(A=j);break}e&&A&&N.alternate===null&&t(y,A),b=i(N,b,P),I===null?F=N:I.sibling=N,I=N,A=j}if(J.done)return r(y,A),br&&Tl(y,P),F;if(A===null){for(;!J.done;P++,J=w.next())J=f(y,J.value,T),J!==null&&(b=i(J,b,P),I===null?F=J:I.sibling=J,I=J);return br&&Tl(y,P),F}for(A=n(y,A);!J.done;P++,J=w.next())J=h(A,y,P,J.value,T),J!==null&&(e&&J.alternate!==null&&A.delete(J.key===null?P:J.key),b=i(J,b,P),I===null?F=J:I.sibling=J,I=J);return e&&A.forEach(function(L){return t(y,L)}),br&&Tl(y,P),F}function _(y,b,w,T){if(typeof w=="object"&&w!==null&&w.type===au&&w.key===null&&(w=w.props.children),typeof w=="object"&&w!==null){switch(w.$$typeof){case Dd:e:{for(var F=w.key,I=b;I!==null;){if(I.key===F){if(F=w.type,F===au){if(I.tag===7){r(y,I.sibling),b=a(I,w.props.children),b.return=y,y=b;break e}}else if(I.elementType===F||typeof F=="object"&&F!==null&&F.$$typeof===To&&sb(F)===I.type){r(y,I.sibling),b=a(I,w.props),b.ref=z0(y,I,w),b.return=y,y=b;break e}r(y,I);break}else t(y,I);I=I.sibling}w.type===au?(b=Wl(w.props.children,y.mode,T,w.key),b.return=y,y=b):(T=Dp(w.type,w.key,w.props,null,y.mode,T),T.ref=z0(y,b,w),T.return=y,y=T)}return s(y);case nu:e:{for(I=w.key;b!==null;){if(b.key===I)if(b.tag===4&&b.stateNode.containerInfo===w.containerInfo&&b.stateNode.implementation===w.implementation){r(y,b.sibling),b=a(b,w.children||[]),b.return=y,y=b;break e}else{r(y,b);break}else t(y,b);b=b.sibling}b=Xg(w,y.mode,T),b.return=y,y=b}return s(y);case To:return I=w._init,_(y,b,I(w._payload),T)}if(Z0(w))return g(y,b,w,T);if(M0(w))return m(y,b,w,T);qd(y,w)}return typeof w=="string"&&w!==""||typeof w=="number"?(w=""+w,b!==null&&b.tag===6?(r(y,b.sibling),b=a(b,w),b.return=y,y=b):(r(y,b),b=Kg(w,y.mode,T),b.return=y,y=b),s(y)):r(y,b)}return _}var Uu=mS(!0),gS=mS(!1),a1=cl(null),i1=null,hu=null,ly=null;function cy(){ly=hu=i1=null}function uy(e){var t=a1.current;yr(a1),e._currentValue=t}function xx(e,t,r){for(;e!==null;){var n=e.alternate;if((e.childLanes&t)!==t?(e.childLanes|=t,n!==null&&(n.childLanes|=t)):n!==null&&(n.childLanes&t)!==t&&(n.childLanes|=t),e===r)break;e=e.return}}function Au(e,t){i1=e,ly=hu=null,e=e.dependencies,e!==null&&e.firstContext!==null&&(e.lanes&t&&(va=!0),e.firstContext=null)}function ci(e){var t=e._currentValue;if(ly!==e)if(e={context:e,memoizedValue:t,next:null},hu===null){if(i1===null)throw Error(We(308));hu=e,i1.dependencies={lanes:0,firstContext:e}}else hu=hu.next=e;return t}var Bl=null;function fy(e){Bl===null?Bl=[e]:Bl.push(e)}function xS(e,t,r,n){var a=t.interleaved;return a===null?(r.next=r,fy(t)):(r.next=a.next,a.next=r),t.interleaved=r,Xs(e,n)}function Xs(e,t){e.lanes|=t;var r=e.alternate;for(r!==null&&(r.lanes|=t),r=e,e=e.return;e!==null;)e.childLanes|=t,r=e.alternate,r!==null&&(r.childLanes|=t),r=e,e=e.return;return r.tag===3?r.stateNode:null}var Co=!1;function hy(e){e.updateQueue={baseState:e.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function vS(e,t){e=e.updateQueue,t.updateQueue===e&&(t.updateQueue={baseState:e.baseState,firstBaseUpdate:e.firstBaseUpdate,lastBaseUpdate:e.lastBaseUpdate,shared:e.shared,effects:e.effects})}function $s(e,t){return{eventTime:e,lane:t,tag:0,payload:null,callback:null,next:null}}function Go(e,t,r){var n=e.updateQueue;if(n===null)return null;if(n=n.shared,Ht&2){var a=n.pending;return a===null?t.next=t:(t.next=a.next,a.next=t),n.pending=t,Xs(e,r)}return a=n.interleaved,a===null?(t.next=t,fy(n)):(t.next=a.next,a.next=t),n.interleaved=t,Xs(e,r)}function Np(e,t,r){if(t=t.updateQueue,t!==null&&(t=t.shared,(r&4194240)!==0)){var n=t.lanes;n&=e.pendingLanes,r|=n,t.lanes=r,Jv(e,r)}}function ob(e,t){var r=e.updateQueue,n=e.alternate;if(n!==null&&(n=n.updateQueue,r===n)){var a=null,i=null;if(r=r.firstBaseUpdate,r!==null){do{var s={eventTime:r.eventTime,lane:r.lane,tag:r.tag,payload:r.payload,callback:r.callback,next:null};i===null?a=i=s:i=i.next=s,r=r.next}while(r!==null);i===null?a=i=t:i=i.next=t}else a=i=t;r={baseState:n.baseState,firstBaseUpdate:a,lastBaseUpdate:i,shared:n.shared,effects:n.effects},e.updateQueue=r;return}e=r.lastBaseUpdate,e===null?r.firstBaseUpdate=t:e.next=t,r.lastBaseUpdate=t}function s1(e,t,r,n){var a=e.updateQueue;Co=!1;var i=a.firstBaseUpdate,s=a.lastBaseUpdate,o=a.shared.pending;if(o!==null){a.shared.pending=null;var l=o,c=l.next;l.next=null,s===null?i=c:s.next=c,s=l;var u=e.alternate;u!==null&&(u=u.updateQueue,o=u.lastBaseUpdate,o!==s&&(o===null?u.firstBaseUpdate=c:o.next=c,u.lastBaseUpdate=l))}if(i!==null){var f=a.baseState;s=0,u=c=l=null,o=i;do{var d=o.lane,h=o.eventTime;if((n&d)===d){u!==null&&(u=u.next={eventTime:h,lane:0,tag:o.tag,payload:o.payload,callback:o.callback,next:null});e:{var g=e,m=o;switch(d=t,h=r,m.tag){case 1:if(g=m.payload,typeof g=="function"){f=g.call(h,f,d);break e}f=g;break e;case 3:g.flags=g.flags&-65537|128;case 0:if(g=m.payload,d=typeof g=="function"?g.call(h,f,d):g,d==null)break e;f=Ar({},f,d);break e;case 2:Co=!0}}o.callback!==null&&o.lane!==0&&(e.flags|=64,d=a.effects,d===null?a.effects=[o]:d.push(o))}else h={eventTime:h,lane:d,tag:o.tag,payload:o.payload,callback:o.callback,next:null},u===null?(c=u=h,l=f):u=u.next=h,s|=d;if(o=o.next,o===null){if(o=a.shared.pending,o===null)break;d=o,o=d.next,d.next=null,a.lastBaseUpdate=d,a.shared.pending=null}}while(!0);if(u===null&&(l=f),a.baseState=l,a.firstBaseUpdate=c,a.lastBaseUpdate=u,t=a.shared.interleaved,t!==null){a=t;do s|=a.lane,a=a.next;while(a!==t)}else i===null&&(a.shared.lanes=0);tc|=s,e.lanes=s,e.memoizedState=f}}function lb(e,t,r){if(e=t.effects,t.effects=null,e!==null)for(t=0;t<e.length;t++){var n=e[t],a=n.callback;if(a!==null){if(n.callback=null,n=r,typeof a!="function")throw Error(We(191,a));a.call(n)}}}var Th={},cs=cl(Th),Jf=cl(Th),Qf=cl(Th);function Ul(e){if(e===Th)throw Error(We(174));return e}function dy(e,t){switch(dr(Qf,t),dr(Jf,e),dr(cs,Th),e=t.nodeType,e){case 9:case 11:t=(t=t.documentElement)?t.namespaceURI:J2(null,"");break;default:e=e===8?t.parentNode:t,t=e.namespaceURI||null,e=e.tagName,t=J2(t,e)}yr(cs),dr(cs,t)}function $u(){yr(cs),yr(Jf),yr(Qf)}function yS(e){Ul(Qf.current);var t=Ul(cs.current),r=J2(t,e.type);t!==r&&(dr(Jf,e),dr(cs,r))}function py(e){Jf.current===e&&(yr(cs),yr(Jf))}var Sr=cl(0);function o1(e){for(var t=e;t!==null;){if(t.tag===13){var r=t.memoizedState;if(r!==null&&(r=r.dehydrated,r===null||r.data==="$?"||r.data==="$!"))return t}else if(t.tag===19&&t.memoizedProps.revealOrder!==void 0){if(t.flags&128)return t}else if(t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break;for(;t.sibling===null;){if(t.return===null||t.return===e)return null;t=t.return}t.sibling.return=t.return,t=t.sibling}return null}var Vg=[];function my(){for(var e=0;e<Vg.length;e++)Vg[e]._workInProgressVersionPrimary=null;Vg.length=0}var Pp=ro.ReactCurrentDispatcher,zg=ro.ReactCurrentBatchConfig,ec=0,Er=null,nn=null,pn=null,l1=!1,pf=!1,Zf=0,Y7=0;function Nn(){throw Error(We(321))}function gy(e,t){if(t===null)return!1;for(var r=0;r<t.length&&r<e.length;r++)if(!Vi(e[r],t[r]))return!1;return!0}function xy(e,t,r,n,a,i){if(ec=i,Er=t,t.memoizedState=null,t.updateQueue=null,t.lanes=0,Pp.current=e===null||e.memoizedState===null?eP:tP,e=r(n,a),pf){i=0;do{if(pf=!1,Zf=0,25<=i)throw Error(We(301));i+=1,pn=nn=null,t.updateQueue=null,Pp.current=rP,e=r(n,a)}while(pf)}if(Pp.current=c1,t=nn!==null&&nn.next!==null,ec=0,pn=nn=Er=null,l1=!1,t)throw Error(We(300));return e}function vy(){var e=Zf!==0;return Zf=0,e}function as(){var e={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return pn===null?Er.memoizedState=pn=e:pn=pn.next=e,pn}function ui(){if(nn===null){var e=Er.alternate;e=e!==null?e.memoizedState:null}else e=nn.next;var t=pn===null?Er.memoizedState:pn.next;if(t!==null)pn=t,nn=e;else{if(e===null)throw Error(We(310));nn=e,e={memoizedState:nn.memoizedState,baseState:nn.baseState,baseQueue:nn.baseQueue,queue:nn.queue,next:null},pn===null?Er.memoizedState=pn=e:pn=pn.next=e}return pn}function eh(e,t){return typeof t=="function"?t(e):t}function Hg(e){var t=ui(),r=t.queue;if(r===null)throw Error(We(311));r.lastRenderedReducer=e;var n=nn,a=n.baseQueue,i=r.pending;if(i!==null){if(a!==null){var s=a.next;a.next=i.next,i.next=s}n.baseQueue=a=i,r.pending=null}if(a!==null){i=a.next,n=n.baseState;var o=s=null,l=null,c=i;do{var u=c.lane;if((ec&u)===u)l!==null&&(l=l.next={lane:0,action:c.action,hasEagerState:c.hasEagerState,eagerState:c.eagerState,next:null}),n=c.hasEagerState?c.eagerState:e(n,c.action);else{var f={lane:u,action:c.action,hasEagerState:c.hasEagerState,eagerState:c.eagerState,next:null};l===null?(o=l=f,s=n):l=l.next=f,Er.lanes|=u,tc|=u}c=c.next}while(c!==null&&c!==i);l===null?s=n:l.next=o,Vi(n,t.memoizedState)||(va=!0),t.memoizedState=n,t.baseState=s,t.baseQueue=l,r.lastRenderedState=n}if(e=r.interleaved,e!==null){a=e;do i=a.lane,Er.lanes|=i,tc|=i,a=a.next;while(a!==e)}else a===null&&(r.lanes=0);return[t.memoizedState,r.dispatch]}function Wg(e){var t=ui(),r=t.queue;if(r===null)throw Error(We(311));r.lastRenderedReducer=e;var n=r.dispatch,a=r.pending,i=t.memoizedState;if(a!==null){r.pending=null;var s=a=a.next;do i=e(i,s.action),s=s.next;while(s!==a);Vi(i,t.memoizedState)||(va=!0),t.memoizedState=i,t.baseQueue===null&&(t.baseState=i),r.lastRenderedState=i}return[i,n]}function wS(){}function bS(e,t){var r=Er,n=ui(),a=t(),i=!Vi(n.memoizedState,a);if(i&&(n.memoizedState=a,va=!0),n=n.queue,yy(kS.bind(null,r,n,e),[e]),n.getSnapshot!==t||i||pn!==null&&pn.memoizedState.tag&1){if(r.flags|=2048,th(9,SS.bind(null,r,n,a,t),void 0,null),gn===null)throw Error(We(349));ec&30||_S(r,t,a)}return a}function _S(e,t,r){e.flags|=16384,e={getSnapshot:t,value:r},t=Er.updateQueue,t===null?(t={lastEffect:null,stores:null},Er.updateQueue=t,t.stores=[e]):(r=t.stores,r===null?t.stores=[e]:r.push(e))}function SS(e,t,r,n){t.value=r,t.getSnapshot=n,ES(t)&&AS(e)}function kS(e,t,r){return r(function(){ES(t)&&AS(e)})}function ES(e){var t=e.getSnapshot;e=e.value;try{var r=t();return!Vi(e,r)}catch{return!0}}function AS(e){var t=Xs(e,1);t!==null&&Bi(t,e,1,-1)}function cb(e){var t=as();return typeof e=="function"&&(e=e()),t.memoizedState=t.baseState=e,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:eh,lastRenderedState:e},t.queue=e,e=e.dispatch=Z7.bind(null,Er,e),[t.memoizedState,e]}function th(e,t,r,n){return e={tag:e,create:t,destroy:r,deps:n,next:null},t=Er.updateQueue,t===null?(t={lastEffect:null,stores:null},Er.updateQueue=t,t.lastEffect=e.next=e):(r=t.lastEffect,r===null?t.lastEffect=e.next=e:(n=r.next,r.next=e,e.next=n,t.lastEffect=e)),e}function TS(){return ui().memoizedState}function Lp(e,t,r,n){var a=as();Er.flags|=e,a.memoizedState=th(1|t,r,void 0,n===void 0?null:n)}function em(e,t,r,n){var a=ui();n=n===void 0?null:n;var i=void 0;if(nn!==null){var s=nn.memoizedState;if(i=s.destroy,n!==null&&gy(n,s.deps)){a.memoizedState=th(t,r,i,n);return}}Er.flags|=e,a.memoizedState=th(1|t,r,i,n)}function ub(e,t){return Lp(8390656,8,e,t)}function yy(e,t){return em(2048,8,e,t)}function CS(e,t){return em(4,2,e,t)}function NS(e,t){return em(4,4,e,t)}function PS(e,t){if(typeof t=="function")return e=e(),t(e),function(){t(null)};if(t!=null)return e=e(),t.current=e,function(){t.current=null}}function LS(e,t,r){return r=r!=null?r.concat([e]):null,em(4,4,PS.bind(null,t,e),r)}function wy(){}function FS(e,t){var r=ui();t=t===void 0?null:t;var n=r.memoizedState;return n!==null&&t!==null&&gy(t,n[1])?n[0]:(r.memoizedState=[e,t],e)}function OS(e,t){var r=ui();t=t===void 0?null:t;var n=r.memoizedState;return n!==null&&t!==null&&gy(t,n[1])?n[0]:(e=e(),r.memoizedState=[e,t],e)}function IS(e,t,r){return ec&21?(Vi(r,t)||(r=B6(),Er.lanes|=r,tc|=r,e.baseState=!0),t):(e.baseState&&(e.baseState=!1,va=!0),e.memoizedState=r)}function J7(e,t){var r=rr;rr=r!==0&&4>r?r:4,e(!0);var n=zg.transition;zg.transition={};try{e(!1),t()}finally{rr=r,zg.transition=n}}function DS(){return ui().memoizedState}function Q7(e,t,r){var n=Xo(e);if(r={lane:n,action:r,hasEagerState:!1,eagerState:null,next:null},jS(e))RS(t,r);else if(r=xS(e,t,r,n),r!==null){var a=na();Bi(r,e,n,a),MS(r,t,n)}}function Z7(e,t,r){var n=Xo(e),a={lane:n,action:r,hasEagerState:!1,eagerState:null,next:null};if(jS(e))RS(t,a);else{var i=e.alternate;if(e.lanes===0&&(i===null||i.lanes===0)&&(i=t.lastRenderedReducer,i!==null))try{var s=t.lastRenderedState,o=i(s,r);if(a.hasEagerState=!0,a.eagerState=o,Vi(o,s)){var l=t.interleaved;l===null?(a.next=a,fy(t)):(a.next=l.next,l.next=a),t.interleaved=a;return}}catch{}finally{}r=xS(e,t,a,n),r!==null&&(a=na(),Bi(r,e,n,a),MS(r,t,n))}}function jS(e){var t=e.alternate;return e===Er||t!==null&&t===Er}function RS(e,t){pf=l1=!0;var r=e.pending;r===null?t.next=t:(t.next=r.next,r.next=t),e.pending=t}function MS(e,t,r){if(r&4194240){var n=t.lanes;n&=e.pendingLanes,r|=n,t.lanes=r,Jv(e,r)}}var c1={readContext:ci,useCallback:Nn,useContext:Nn,useEffect:Nn,useImperativeHandle:Nn,useInsertionEffect:Nn,useLayoutEffect:Nn,useMemo:Nn,useReducer:Nn,useRef:Nn,useState:Nn,useDebugValue:Nn,useDeferredValue:Nn,useTransition:Nn,useMutableSource:Nn,useSyncExternalStore:Nn,useId:Nn,unstable_isNewReconciler:!1},eP={readContext:ci,useCallback:function(e,t){return as().memoizedState=[e,t===void 0?null:t],e},useContext:ci,useEffect:ub,useImperativeHandle:function(e,t,r){return r=r!=null?r.concat([e]):null,Lp(4194308,4,PS.bind(null,t,e),r)},useLayoutEffect:function(e,t){return Lp(4194308,4,e,t)},useInsertionEffect:function(e,t){return Lp(4,2,e,t)},useMemo:function(e,t){var r=as();return t=t===void 0?null:t,e=e(),r.memoizedState=[e,t],e},useReducer:function(e,t,r){var n=as();return t=r!==void 0?r(t):t,n.memoizedState=n.baseState=t,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:e,lastRenderedState:t},n.queue=e,e=e.dispatch=Q7.bind(null,Er,e),[n.memoizedState,e]},useRef:function(e){var t=as();return e={current:e},t.memoizedState=e},useState:cb,useDebugValue:wy,useDeferredValue:function(e){return as().memoizedState=e},useTransition:function(){var e=cb(!1),t=e[0];return e=J7.bind(null,e[1]),as().memoizedState=e,[t,e]},useMutableSource:function(){},useSyncExternalStore:function(e,t,r){var n=Er,a=as();if(br){if(r===void 0)throw Error(We(407));r=r()}else{if(r=t(),gn===null)throw Error(We(349));ec&30||_S(n,t,r)}a.memoizedState=r;var i={value:r,getSnapshot:t};return a.queue=i,ub(kS.bind(null,n,i,e),[e]),n.flags|=2048,th(9,SS.bind(null,n,i,r,t),void 0,null),r},useId:function(){var e=as(),t=gn.identifierPrefix;if(br){var r=Rs,n=js;r=(n&~(1<<32-Mi(n)-1)).toString(32)+r,t=":"+t+"R"+r,r=Zf++,0<r&&(t+="H"+r.toString(32)),t+=":"}else r=Y7++,t=":"+t+"r"+r.toString(32)+":";return e.memoizedState=t},unstable_isNewReconciler:!1},tP={readContext:ci,useCallback:FS,useContext:ci,useEffect:yy,useImperativeHandle:LS,useInsertionEffect:CS,useLayoutEffect:NS,useMemo:OS,useReducer:Hg,useRef:TS,useState:function(){return Hg(eh)},useDebugValue:wy,useDeferredValue:function(e){var t=ui();return IS(t,nn.memoizedState,e)},useTransition:function(){var e=Hg(eh)[0],t=ui().memoizedState;return[e,t]},useMutableSource:wS,useSyncExternalStore:bS,useId:DS,unstable_isNewReconciler:!1},rP={readContext:ci,useCallback:FS,useContext:ci,useEffect:yy,useImperativeHandle:LS,useInsertionEffect:CS,useLayoutEffect:NS,useMemo:OS,useReducer:Wg,useRef:TS,useState:function(){return Wg(eh)},useDebugValue:wy,useDeferredValue:function(e){var t=ui();return nn===null?t.memoizedState=e:IS(t,nn.memoizedState,e)},useTransition:function(){var e=Wg(eh)[0],t=ui().memoizedState;return[e,t]},useMutableSource:wS,useSyncExternalStore:bS,useId:DS,unstable_isNewReconciler:!1};function Ti(e,t){if(e&&e.defaultProps){t=Ar({},t),e=e.defaultProps;for(var r in e)t[r]===void 0&&(t[r]=e[r]);return t}return t}function vx(e,t,r,n){t=e.memoizedState,r=r(n,t),r=r==null?t:Ar({},t,r),e.memoizedState=r,e.lanes===0&&(e.updateQueue.baseState=r)}var tm={isMounted:function(e){return(e=e._reactInternals)?lc(e)===e:!1},enqueueSetState:function(e,t,r){e=e._reactInternals;var n=na(),a=Xo(e),i=$s(n,a);i.payload=t,r!=null&&(i.callback=r),t=Go(e,i,a),t!==null&&(Bi(t,e,a,n),Np(t,e,a))},enqueueReplaceState:function(e,t,r){e=e._reactInternals;var n=na(),a=Xo(e),i=$s(n,a);i.tag=1,i.payload=t,r!=null&&(i.callback=r),t=Go(e,i,a),t!==null&&(Bi(t,e,a,n),Np(t,e,a))},enqueueForceUpdate:function(e,t){e=e._reactInternals;var r=na(),n=Xo(e),a=$s(r,n);a.tag=2,t!=null&&(a.callback=t),t=Go(e,a,n),t!==null&&(Bi(t,e,n,r),Np(t,e,n))}};function fb(e,t,r,n,a,i,s){return e=e.stateNode,typeof e.shouldComponentUpdate=="function"?e.shouldComponentUpdate(n,i,s):t.prototype&&t.prototype.isPureReactComponent?!Gf(r,n)||!Gf(a,i):!0}function BS(e,t,r){var n=!1,a=el,i=t.contextType;return typeof i=="object"&&i!==null?i=ci(i):(a=wa(t)?Ql:Wn.current,n=t.contextTypes,i=(n=n!=null)?Mu(e,a):el),t=new t(r,i),e.memoizedState=t.state!==null&&t.state!==void 0?t.state:null,t.updater=tm,e.stateNode=t,t._reactInternals=e,n&&(e=e.stateNode,e.__reactInternalMemoizedUnmaskedChildContext=a,e.__reactInternalMemoizedMaskedChildContext=i),t}function hb(e,t,r,n){e=t.state,typeof t.componentWillReceiveProps=="function"&&t.componentWillReceiveProps(r,n),typeof t.UNSAFE_componentWillReceiveProps=="function"&&t.UNSAFE_componentWillReceiveProps(r,n),t.state!==e&&tm.enqueueReplaceState(t,t.state,null)}function yx(e,t,r,n){var a=e.stateNode;a.props=r,a.state=e.memoizedState,a.refs={},hy(e);var i=t.contextType;typeof i=="object"&&i!==null?a.context=ci(i):(i=wa(t)?Ql:Wn.current,a.context=Mu(e,i)),a.state=e.memoizedState,i=t.getDerivedStateFromProps,typeof i=="function"&&(vx(e,t,i,r),a.state=e.memoizedState),typeof t.getDerivedStateFromProps=="function"||typeof a.getSnapshotBeforeUpdate=="function"||typeof a.UNSAFE_componentWillMount!="function"&&typeof a.componentWillMount!="function"||(t=a.state,typeof a.componentWillMount=="function"&&a.componentWillMount(),typeof a.UNSAFE_componentWillMount=="function"&&a.UNSAFE_componentWillMount(),t!==a.state&&tm.enqueueReplaceState(a,a.state,null),s1(e,r,a,n),a.state=e.memoizedState),typeof a.componentDidMount=="function"&&(e.flags|=4194308)}function Vu(e,t){try{var r="",n=t;do r+=PN(n),n=n.return;while(n);var a=r}catch(i){a=`
Error generating stack: `+i.message+`
`+i.stack}return{value:e,source:t,stack:a,digest:null}}function qg(e,t,r){return{value:e,source:null,stack:r??null,digest:t??null}}function wx(e,t){try{console.error(t.value)}catch(r){setTimeout(function(){throw r})}}var nP=typeof WeakMap=="function"?WeakMap:Map;function US(e,t,r){r=$s(-1,r),r.tag=3,r.payload={element:null};var n=t.value;return r.callback=function(){f1||(f1=!0,Px=n),wx(e,t)},r}function $S(e,t,r){r=$s(-1,r),r.tag=3;var n=e.type.getDerivedStateFromError;if(typeof n=="function"){var a=t.value;r.payload=function(){return n(a)},r.callback=function(){wx(e,t)}}var i=e.stateNode;return i!==null&&typeof i.componentDidCatch=="function"&&(r.callback=function(){wx(e,t),typeof n!="function"&&(Ko===null?Ko=new Set([this]):Ko.add(this));var s=t.stack;this.componentDidCatch(t.value,{componentStack:s!==null?s:""})}),r}function db(e,t,r){var n=e.pingCache;if(n===null){n=e.pingCache=new nP;var a=new Set;n.set(t,a)}else a=n.get(t),a===void 0&&(a=new Set,n.set(t,a));a.has(r)||(a.add(r),e=xP.bind(null,e,t,r),t.then(e,e))}function pb(e){do{var t;if((t=e.tag===13)&&(t=e.memoizedState,t=t!==null?t.dehydrated!==null:!0),t)return e;e=e.return}while(e!==null);return null}function mb(e,t,r,n,a){return e.mode&1?(e.flags|=65536,e.lanes=a,e):(e===t?e.flags|=65536:(e.flags|=128,r.flags|=131072,r.flags&=-52805,r.tag===1&&(r.alternate===null?r.tag=17:(t=$s(-1,1),t.tag=2,Go(r,t,1))),r.lanes|=1),e)}var aP=ro.ReactCurrentOwner,va=!1;function Qn(e,t,r,n){t.child=e===null?gS(t,null,r,n):Uu(t,e.child,r,n)}function gb(e,t,r,n,a){r=r.render;var i=t.ref;return Au(t,a),n=xy(e,t,r,n,i,a),r=vy(),e!==null&&!va?(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~a,Ys(e,t,a)):(br&&r&&iy(t),t.flags|=1,Qn(e,t,n,a),t.child)}function xb(e,t,r,n,a){if(e===null){var i=r.type;return typeof i=="function"&&!Cy(i)&&i.defaultProps===void 0&&r.compare===null&&r.defaultProps===void 0?(t.tag=15,t.type=i,VS(e,t,i,n,a)):(e=Dp(r.type,null,n,t,t.mode,a),e.ref=t.ref,e.return=t,t.child=e)}if(i=e.child,!(e.lanes&a)){var s=i.memoizedProps;if(r=r.compare,r=r!==null?r:Gf,r(s,n)&&e.ref===t.ref)return Ys(e,t,a)}return t.flags|=1,e=Yo(i,n),e.ref=t.ref,e.return=t,t.child=e}function VS(e,t,r,n,a){if(e!==null){var i=e.memoizedProps;if(Gf(i,n)&&e.ref===t.ref)if(va=!1,t.pendingProps=n=i,(e.lanes&a)!==0)e.flags&131072&&(va=!0);else return t.lanes=e.lanes,Ys(e,t,a)}return bx(e,t,r,n,a)}function zS(e,t,r){var n=t.pendingProps,a=n.children,i=e!==null?e.memoizedState:null;if(n.mode==="hidden")if(!(t.mode&1))t.memoizedState={baseLanes:0,cachePool:null,transitions:null},dr(pu,La),La|=r;else{if(!(r&1073741824))return e=i!==null?i.baseLanes|r:r,t.lanes=t.childLanes=1073741824,t.memoizedState={baseLanes:e,cachePool:null,transitions:null},t.updateQueue=null,dr(pu,La),La|=e,null;t.memoizedState={baseLanes:0,cachePool:null,transitions:null},n=i!==null?i.baseLanes:r,dr(pu,La),La|=n}else i!==null?(n=i.baseLanes|r,t.memoizedState=null):n=r,dr(pu,La),La|=n;return Qn(e,t,a,r),t.child}function HS(e,t){var r=t.ref;(e===null&&r!==null||e!==null&&e.ref!==r)&&(t.flags|=512,t.flags|=2097152)}function bx(e,t,r,n,a){var i=wa(r)?Ql:Wn.current;return i=Mu(t,i),Au(t,a),r=xy(e,t,r,n,i,a),n=vy(),e!==null&&!va?(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~a,Ys(e,t,a)):(br&&n&&iy(t),t.flags|=1,Qn(e,t,r,a),t.child)}function vb(e,t,r,n,a){if(wa(r)){var i=!0;t1(t)}else i=!1;if(Au(t,a),t.stateNode===null)Fp(e,t),BS(t,r,n),yx(t,r,n,a),n=!0;else if(e===null){var s=t.stateNode,o=t.memoizedProps;s.props=o;var l=s.context,c=r.contextType;typeof c=="object"&&c!==null?c=ci(c):(c=wa(r)?Ql:Wn.current,c=Mu(t,c));var u=r.getDerivedStateFromProps,f=typeof u=="function"||typeof s.getSnapshotBeforeUpdate=="function";f||typeof s.UNSAFE_componentWillReceiveProps!="function"&&typeof s.componentWillReceiveProps!="function"||(o!==n||l!==c)&&hb(t,s,n,c),Co=!1;var d=t.memoizedState;s.state=d,s1(t,n,s,a),l=t.memoizedState,o!==n||d!==l||ya.current||Co?(typeof u=="function"&&(vx(t,r,u,n),l=t.memoizedState),(o=Co||fb(t,r,o,n,d,l,c))?(f||typeof s.UNSAFE_componentWillMount!="function"&&typeof s.componentWillMount!="function"||(typeof s.componentWillMount=="function"&&s.componentWillMount(),typeof s.UNSAFE_componentWillMount=="function"&&s.UNSAFE_componentWillMount()),typeof s.componentDidMount=="function"&&(t.flags|=4194308)):(typeof s.componentDidMount=="function"&&(t.flags|=4194308),t.memoizedProps=n,t.memoizedState=l),s.props=n,s.state=l,s.context=c,n=o):(typeof s.componentDidMount=="function"&&(t.flags|=4194308),n=!1)}else{s=t.stateNode,vS(e,t),o=t.memoizedProps,c=t.type===t.elementType?o:Ti(t.type,o),s.props=c,f=t.pendingProps,d=s.context,l=r.contextType,typeof l=="object"&&l!==null?l=ci(l):(l=wa(r)?Ql:Wn.current,l=Mu(t,l));var h=r.getDerivedStateFromProps;(u=typeof h=="function"||typeof s.getSnapshotBeforeUpdate=="function")||typeof s.UNSAFE_componentWillReceiveProps!="function"&&typeof s.componentWillReceiveProps!="function"||(o!==f||d!==l)&&hb(t,s,n,l),Co=!1,d=t.memoizedState,s.state=d,s1(t,n,s,a);var g=t.memoizedState;o!==f||d!==g||ya.current||Co?(typeof h=="function"&&(vx(t,r,h,n),g=t.memoizedState),(c=Co||fb(t,r,c,n,d,g,l)||!1)?(u||typeof s.UNSAFE_componentWillUpdate!="function"&&typeof s.componentWillUpdate!="function"||(typeof s.componentWillUpdate=="function"&&s.componentWillUpdate(n,g,l),typeof s.UNSAFE_componentWillUpdate=="function"&&s.UNSAFE_componentWillUpdate(n,g,l)),typeof s.componentDidUpdate=="function"&&(t.flags|=4),typeof s.getSnapshotBeforeUpdate=="function"&&(t.flags|=1024)):(typeof s.componentDidUpdate!="function"||o===e.memoizedProps&&d===e.memoizedState||(t.flags|=4),typeof s.getSnapshotBeforeUpdate!="function"||o===e.memoizedProps&&d===e.memoizedState||(t.flags|=1024),t.memoizedProps=n,t.memoizedState=g),s.props=n,s.state=g,s.context=l,n=c):(typeof s.componentDidUpdate!="function"||o===e.memoizedProps&&d===e.memoizedState||(t.flags|=4),typeof s.getSnapshotBeforeUpdate!="function"||o===e.memoizedProps&&d===e.memoizedState||(t.flags|=1024),n=!1)}return _x(e,t,r,n,i,a)}function _x(e,t,r,n,a,i){HS(e,t);var s=(t.flags&128)!==0;if(!n&&!s)return a&&nb(t,r,!1),Ys(e,t,i);n=t.stateNode,aP.current=t;var o=s&&typeof r.getDerivedStateFromError!="function"?null:n.render();return t.flags|=1,e!==null&&s?(t.child=Uu(t,e.child,null,i),t.child=Uu(t,null,o,i)):Qn(e,t,o,i),t.memoizedState=n.state,a&&nb(t,r,!0),t.child}function WS(e){var t=e.stateNode;t.pendingContext?rb(e,t.pendingContext,t.pendingContext!==t.context):t.context&&rb(e,t.context,!1),dy(e,t.containerInfo)}function yb(e,t,r,n,a){return Bu(),oy(a),t.flags|=256,Qn(e,t,r,n),t.child}var Sx={dehydrated:null,treeContext:null,retryLane:0};function kx(e){return{baseLanes:e,cachePool:null,transitions:null}}function qS(e,t,r){var n=t.pendingProps,a=Sr.current,i=!1,s=(t.flags&128)!==0,o;if((o=s)||(o=e!==null&&e.memoizedState===null?!1:(a&2)!==0),o?(i=!0,t.flags&=-129):(e===null||e.memoizedState!==null)&&(a|=1),dr(Sr,a&1),e===null)return gx(t),e=t.memoizedState,e!==null&&(e=e.dehydrated,e!==null)?(t.mode&1?e.data==="$!"?t.lanes=8:t.lanes=1073741824:t.lanes=1,null):(s=n.children,e=n.fallback,i?(n=t.mode,i=t.child,s={mode:"hidden",children:s},!(n&1)&&i!==null?(i.childLanes=0,i.pendingProps=s):i=am(s,n,0,null),e=Wl(e,n,r,null),i.return=t,e.return=t,i.sibling=e,t.child=i,t.child.memoizedState=kx(r),t.memoizedState=Sx,e):by(t,s));if(a=e.memoizedState,a!==null&&(o=a.dehydrated,o!==null))return iP(e,t,s,n,o,a,r);if(i){i=n.fallback,s=t.mode,a=e.child,o=a.sibling;var l={mode:"hidden",children:n.children};return!(s&1)&&t.child!==a?(n=t.child,n.childLanes=0,n.pendingProps=l,t.deletions=null):(n=Yo(a,l),n.subtreeFlags=a.subtreeFlags&14680064),o!==null?i=Yo(o,i):(i=Wl(i,s,r,null),i.flags|=2),i.return=t,n.return=t,n.sibling=i,t.child=n,n=i,i=t.child,s=e.child.memoizedState,s=s===null?kx(r):{baseLanes:s.baseLanes|r,cachePool:null,transitions:s.transitions},i.memoizedState=s,i.childLanes=e.childLanes&~r,t.memoizedState=Sx,n}return i=e.child,e=i.sibling,n=Yo(i,{mode:"visible",children:n.children}),!(t.mode&1)&&(n.lanes=r),n.return=t,n.sibling=null,e!==null&&(r=t.deletions,r===null?(t.deletions=[e],t.flags|=16):r.push(e)),t.child=n,t.memoizedState=null,n}function by(e,t){return t=am({mode:"visible",children:t},e.mode,0,null),t.return=e,e.child=t}function Gd(e,t,r,n){return n!==null&&oy(n),Uu(t,e.child,null,r),e=by(t,t.pendingProps.children),e.flags|=2,t.memoizedState=null,e}function iP(e,t,r,n,a,i,s){if(r)return t.flags&256?(t.flags&=-257,n=qg(Error(We(422))),Gd(e,t,s,n)):t.memoizedState!==null?(t.child=e.child,t.flags|=128,null):(i=n.fallback,a=t.mode,n=am({mode:"visible",children:n.children},a,0,null),i=Wl(i,a,s,null),i.flags|=2,n.return=t,i.return=t,n.sibling=i,t.child=n,t.mode&1&&Uu(t,e.child,null,s),t.child.memoizedState=kx(s),t.memoizedState=Sx,i);if(!(t.mode&1))return Gd(e,t,s,null);if(a.data==="$!"){if(n=a.nextSibling&&a.nextSibling.dataset,n)var o=n.dgst;return n=o,i=Error(We(419)),n=qg(i,n,void 0),Gd(e,t,s,n)}if(o=(s&e.childLanes)!==0,va||o){if(n=gn,n!==null){switch(s&-s){case 4:a=2;break;case 16:a=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:a=32;break;case 536870912:a=268435456;break;default:a=0}a=a&(n.suspendedLanes|s)?0:a,a!==0&&a!==i.retryLane&&(i.retryLane=a,Xs(e,a),Bi(n,e,a,-1))}return Ty(),n=qg(Error(We(421))),Gd(e,t,s,n)}return a.data==="$?"?(t.flags|=128,t.child=e.child,t=vP.bind(null,e),a._reactRetry=t,null):(e=i.treeContext,Ia=qo(a.nextSibling),ja=t,br=!0,Oi=null,e!==null&&(ai[ii++]=js,ai[ii++]=Rs,ai[ii++]=Zl,js=e.id,Rs=e.overflow,Zl=t),t=by(t,n.children),t.flags|=4096,t)}function wb(e,t,r){e.lanes|=t;var n=e.alternate;n!==null&&(n.lanes|=t),xx(e.return,t,r)}function Gg(e,t,r,n,a){var i=e.memoizedState;i===null?e.memoizedState={isBackwards:t,rendering:null,renderingStartTime:0,last:n,tail:r,tailMode:a}:(i.isBackwards=t,i.rendering=null,i.renderingStartTime=0,i.last=n,i.tail=r,i.tailMode=a)}function GS(e,t,r){var n=t.pendingProps,a=n.revealOrder,i=n.tail;if(Qn(e,t,n.children,r),n=Sr.current,n&2)n=n&1|2,t.flags|=128;else{if(e!==null&&e.flags&128)e:for(e=t.child;e!==null;){if(e.tag===13)e.memoizedState!==null&&wb(e,r,t);else if(e.tag===19)wb(e,r,t);else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===t)break e;for(;e.sibling===null;){if(e.return===null||e.return===t)break e;e=e.return}e.sibling.return=e.return,e=e.sibling}n&=1}if(dr(Sr,n),!(t.mode&1))t.memoizedState=null;else switch(a){case"forwards":for(r=t.child,a=null;r!==null;)e=r.alternate,e!==null&&o1(e)===null&&(a=r),r=r.sibling;r=a,r===null?(a=t.child,t.child=null):(a=r.sibling,r.sibling=null),Gg(t,!1,a,r,i);break;case"backwards":for(r=null,a=t.child,t.child=null;a!==null;){if(e=a.alternate,e!==null&&o1(e)===null){t.child=a;break}e=a.sibling,a.sibling=r,r=a,a=e}Gg(t,!0,r,null,i);break;case"together":Gg(t,!1,null,null,void 0);break;default:t.memoizedState=null}return t.child}function Fp(e,t){!(t.mode&1)&&e!==null&&(e.alternate=null,t.alternate=null,t.flags|=2)}function Ys(e,t,r){if(e!==null&&(t.dependencies=e.dependencies),tc|=t.lanes,!(r&t.childLanes))return null;if(e!==null&&t.child!==e.child)throw Error(We(153));if(t.child!==null){for(e=t.child,r=Yo(e,e.pendingProps),t.child=r,r.return=t;e.sibling!==null;)e=e.sibling,r=r.sibling=Yo(e,e.pendingProps),r.return=t;r.sibling=null}return t.child}function sP(e,t,r){switch(t.tag){case 3:WS(t),Bu();break;case 5:yS(t);break;case 1:wa(t.type)&&t1(t);break;case 4:dy(t,t.stateNode.containerInfo);break;case 10:var n=t.type._context,a=t.memoizedProps.value;dr(a1,n._currentValue),n._currentValue=a;break;case 13:if(n=t.memoizedState,n!==null)return n.dehydrated!==null?(dr(Sr,Sr.current&1),t.flags|=128,null):r&t.child.childLanes?qS(e,t,r):(dr(Sr,Sr.current&1),e=Ys(e,t,r),e!==null?e.sibling:null);dr(Sr,Sr.current&1);break;case 19:if(n=(r&t.childLanes)!==0,e.flags&128){if(n)return GS(e,t,r);t.flags|=128}if(a=t.memoizedState,a!==null&&(a.rendering=null,a.tail=null,a.lastEffect=null),dr(Sr,Sr.current),n)break;return null;case 22:case 23:return t.lanes=0,zS(e,t,r)}return Ys(e,t,r)}var KS,Ex,XS,YS;KS=function(e,t){for(var r=t.child;r!==null;){if(r.tag===5||r.tag===6)e.appendChild(r.stateNode);else if(r.tag!==4&&r.child!==null){r.child.return=r,r=r.child;continue}if(r===t)break;for(;r.sibling===null;){if(r.return===null||r.return===t)return;r=r.return}r.sibling.return=r.return,r=r.sibling}};Ex=function(){};XS=function(e,t,r,n){var a=e.memoizedProps;if(a!==n){e=t.stateNode,Ul(cs.current);var i=null;switch(r){case"input":a=G2(e,a),n=G2(e,n),i=[];break;case"select":a=Ar({},a,{value:void 0}),n=Ar({},n,{value:void 0}),i=[];break;case"textarea":a=Y2(e,a),n=Y2(e,n),i=[];break;default:typeof a.onClick!="function"&&typeof n.onClick=="function"&&(e.onclick=Zp)}Q2(r,n);var s;r=null;for(c in a)if(!n.hasOwnProperty(c)&&a.hasOwnProperty(c)&&a[c]!=null)if(c==="style"){var o=a[c];for(s in o)o.hasOwnProperty(s)&&(r||(r={}),r[s]="")}else c!=="dangerouslySetInnerHTML"&&c!=="children"&&c!=="suppressContentEditableWarning"&&c!=="suppressHydrationWarning"&&c!=="autoFocus"&&(Uf.hasOwnProperty(c)?i||(i=[]):(i=i||[]).push(c,null));for(c in n){var l=n[c];if(o=a!=null?a[c]:void 0,n.hasOwnProperty(c)&&l!==o&&(l!=null||o!=null))if(c==="style")if(o){for(s in o)!o.hasOwnProperty(s)||l&&l.hasOwnProperty(s)||(r||(r={}),r[s]="");for(s in l)l.hasOwnProperty(s)&&o[s]!==l[s]&&(r||(r={}),r[s]=l[s])}else r||(i||(i=[]),i.push(c,r)),r=l;else c==="dangerouslySetInnerHTML"?(l=l?l.__html:void 0,o=o?o.__html:void 0,l!=null&&o!==l&&(i=i||[]).push(c,l)):c==="children"?typeof l!="string"&&typeof l!="number"||(i=i||[]).push(c,""+l):c!=="suppressContentEditableWarning"&&c!=="suppressHydrationWarning"&&(Uf.hasOwnProperty(c)?(l!=null&&c==="onScroll"&&xr("scroll",e),i||o===l||(i=[])):(i=i||[]).push(c,l))}r&&(i=i||[]).push("style",r);var c=i;(t.updateQueue=c)&&(t.flags|=4)}};YS=function(e,t,r,n){r!==n&&(t.flags|=4)};function H0(e,t){if(!br)switch(e.tailMode){case"hidden":t=e.tail;for(var r=null;t!==null;)t.alternate!==null&&(r=t),t=t.sibling;r===null?e.tail=null:r.sibling=null;break;case"collapsed":r=e.tail;for(var n=null;r!==null;)r.alternate!==null&&(n=r),r=r.sibling;n===null?t||e.tail===null?e.tail=null:e.tail.sibling=null:n.sibling=null}}function Pn(e){var t=e.alternate!==null&&e.alternate.child===e.child,r=0,n=0;if(t)for(var a=e.child;a!==null;)r|=a.lanes|a.childLanes,n|=a.subtreeFlags&14680064,n|=a.flags&14680064,a.return=e,a=a.sibling;else for(a=e.child;a!==null;)r|=a.lanes|a.childLanes,n|=a.subtreeFlags,n|=a.flags,a.return=e,a=a.sibling;return e.subtreeFlags|=n,e.childLanes=r,t}function oP(e,t,r){var n=t.pendingProps;switch(sy(t),t.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Pn(t),null;case 1:return wa(t.type)&&e1(),Pn(t),null;case 3:return n=t.stateNode,$u(),yr(ya),yr(Wn),my(),n.pendingContext&&(n.context=n.pendingContext,n.pendingContext=null),(e===null||e.child===null)&&(Wd(t)?t.flags|=4:e===null||e.memoizedState.isDehydrated&&!(t.flags&256)||(t.flags|=1024,Oi!==null&&(Ox(Oi),Oi=null))),Ex(e,t),Pn(t),null;case 5:py(t);var a=Ul(Qf.current);if(r=t.type,e!==null&&t.stateNode!=null)XS(e,t,r,n,a),e.ref!==t.ref&&(t.flags|=512,t.flags|=2097152);else{if(!n){if(t.stateNode===null)throw Error(We(166));return Pn(t),null}if(e=Ul(cs.current),Wd(t)){n=t.stateNode,r=t.type;var i=t.memoizedProps;switch(n[is]=t,n[Yf]=i,e=(t.mode&1)!==0,r){case"dialog":xr("cancel",n),xr("close",n);break;case"iframe":case"object":case"embed":xr("load",n);break;case"video":case"audio":for(a=0;a<tf.length;a++)xr(tf[a],n);break;case"source":xr("error",n);break;case"img":case"image":case"link":xr("error",n),xr("load",n);break;case"details":xr("toggle",n);break;case"input":Nw(n,i),xr("invalid",n);break;case"select":n._wrapperState={wasMultiple:!!i.multiple},xr("invalid",n);break;case"textarea":Lw(n,i),xr("invalid",n)}Q2(r,i),a=null;for(var s in i)if(i.hasOwnProperty(s)){var o=i[s];s==="children"?typeof o=="string"?n.textContent!==o&&(i.suppressHydrationWarning!==!0&&Hd(n.textContent,o,e),a=["children",o]):typeof o=="number"&&n.textContent!==""+o&&(i.suppressHydrationWarning!==!0&&Hd(n.textContent,o,e),a=["children",""+o]):Uf.hasOwnProperty(s)&&o!=null&&s==="onScroll"&&xr("scroll",n)}switch(r){case"input":jd(n),Pw(n,i,!0);break;case"textarea":jd(n),Fw(n);break;case"select":case"option":break;default:typeof i.onClick=="function"&&(n.onclick=Zp)}n=a,t.updateQueue=n,n!==null&&(t.flags|=4)}else{s=a.nodeType===9?a:a.ownerDocument,e==="http://www.w3.org/1999/xhtml"&&(e=k6(r)),e==="http://www.w3.org/1999/xhtml"?r==="script"?(e=s.createElement("div"),e.innerHTML="<script><\/script>",e=e.removeChild(e.firstChild)):typeof n.is=="string"?e=s.createElement(r,{is:n.is}):(e=s.createElement(r),r==="select"&&(s=e,n.multiple?s.multiple=!0:n.size&&(s.size=n.size))):e=s.createElementNS(e,r),e[is]=t,e[Yf]=n,KS(e,t,!1,!1),t.stateNode=e;e:{switch(s=Z2(r,n),r){case"dialog":xr("cancel",e),xr("close",e),a=n;break;case"iframe":case"object":case"embed":xr("load",e),a=n;break;case"video":case"audio":for(a=0;a<tf.length;a++)xr(tf[a],e);a=n;break;case"source":xr("error",e),a=n;break;case"img":case"image":case"link":xr("error",e),xr("load",e),a=n;break;case"details":xr("toggle",e),a=n;break;case"input":Nw(e,n),a=G2(e,n),xr("invalid",e);break;case"option":a=n;break;case"select":e._wrapperState={wasMultiple:!!n.multiple},a=Ar({},n,{value:void 0}),xr("invalid",e);break;case"textarea":Lw(e,n),a=Y2(e,n),xr("invalid",e);break;default:a=n}Q2(r,a),o=a;for(i in o)if(o.hasOwnProperty(i)){var l=o[i];i==="style"?T6(e,l):i==="dangerouslySetInnerHTML"?(l=l?l.__html:void 0,l!=null&&E6(e,l)):i==="children"?typeof l=="string"?(r!=="textarea"||l!=="")&&$f(e,l):typeof l=="number"&&$f(e,""+l):i!=="suppressContentEditableWarning"&&i!=="suppressHydrationWarning"&&i!=="autoFocus"&&(Uf.hasOwnProperty(i)?l!=null&&i==="onScroll"&&xr("scroll",e):l!=null&&Wv(e,i,l,s))}switch(r){case"input":jd(e),Pw(e,n,!1);break;case"textarea":jd(e),Fw(e);break;case"option":n.value!=null&&e.setAttribute("value",""+Zo(n.value));break;case"select":e.multiple=!!n.multiple,i=n.value,i!=null?_u(e,!!n.multiple,i,!1):n.defaultValue!=null&&_u(e,!!n.multiple,n.defaultValue,!0);break;default:typeof a.onClick=="function"&&(e.onclick=Zp)}switch(r){case"button":case"input":case"select":case"textarea":n=!!n.autoFocus;break e;case"img":n=!0;break e;default:n=!1}}n&&(t.flags|=4)}t.ref!==null&&(t.flags|=512,t.flags|=2097152)}return Pn(t),null;case 6:if(e&&t.stateNode!=null)YS(e,t,e.memoizedProps,n);else{if(typeof n!="string"&&t.stateNode===null)throw Error(We(166));if(r=Ul(Qf.current),Ul(cs.current),Wd(t)){if(n=t.stateNode,r=t.memoizedProps,n[is]=t,(i=n.nodeValue!==r)&&(e=ja,e!==null))switch(e.tag){case 3:Hd(n.nodeValue,r,(e.mode&1)!==0);break;case 5:e.memoizedProps.suppressHydrationWarning!==!0&&Hd(n.nodeValue,r,(e.mode&1)!==0)}i&&(t.flags|=4)}else n=(r.nodeType===9?r:r.ownerDocument).createTextNode(n),n[is]=t,t.stateNode=n}return Pn(t),null;case 13:if(yr(Sr),n=t.memoizedState,e===null||e.memoizedState!==null&&e.memoizedState.dehydrated!==null){if(br&&Ia!==null&&t.mode&1&&!(t.flags&128))pS(),Bu(),t.flags|=98560,i=!1;else if(i=Wd(t),n!==null&&n.dehydrated!==null){if(e===null){if(!i)throw Error(We(318));if(i=t.memoizedState,i=i!==null?i.dehydrated:null,!i)throw Error(We(317));i[is]=t}else Bu(),!(t.flags&128)&&(t.memoizedState=null),t.flags|=4;Pn(t),i=!1}else Oi!==null&&(Ox(Oi),Oi=null),i=!0;if(!i)return t.flags&65536?t:null}return t.flags&128?(t.lanes=r,t):(n=n!==null,n!==(e!==null&&e.memoizedState!==null)&&n&&(t.child.flags|=8192,t.mode&1&&(e===null||Sr.current&1?an===0&&(an=3):Ty())),t.updateQueue!==null&&(t.flags|=4),Pn(t),null);case 4:return $u(),Ex(e,t),e===null&&Kf(t.stateNode.containerInfo),Pn(t),null;case 10:return uy(t.type._context),Pn(t),null;case 17:return wa(t.type)&&e1(),Pn(t),null;case 19:if(yr(Sr),i=t.memoizedState,i===null)return Pn(t),null;if(n=(t.flags&128)!==0,s=i.rendering,s===null)if(n)H0(i,!1);else{if(an!==0||e!==null&&e.flags&128)for(e=t.child;e!==null;){if(s=o1(e),s!==null){for(t.flags|=128,H0(i,!1),n=s.updateQueue,n!==null&&(t.updateQueue=n,t.flags|=4),t.subtreeFlags=0,n=r,r=t.child;r!==null;)i=r,e=n,i.flags&=14680066,s=i.alternate,s===null?(i.childLanes=0,i.lanes=e,i.child=null,i.subtreeFlags=0,i.memoizedProps=null,i.memoizedState=null,i.updateQueue=null,i.dependencies=null,i.stateNode=null):(i.childLanes=s.childLanes,i.lanes=s.lanes,i.child=s.child,i.subtreeFlags=0,i.deletions=null,i.memoizedProps=s.memoizedProps,i.memoizedState=s.memoizedState,i.updateQueue=s.updateQueue,i.type=s.type,e=s.dependencies,i.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext}),r=r.sibling;return dr(Sr,Sr.current&1|2),t.child}e=e.sibling}i.tail!==null&&Br()>zu&&(t.flags|=128,n=!0,H0(i,!1),t.lanes=4194304)}else{if(!n)if(e=o1(s),e!==null){if(t.flags|=128,n=!0,r=e.updateQueue,r!==null&&(t.updateQueue=r,t.flags|=4),H0(i,!0),i.tail===null&&i.tailMode==="hidden"&&!s.alternate&&!br)return Pn(t),null}else 2*Br()-i.renderingStartTime>zu&&r!==1073741824&&(t.flags|=128,n=!0,H0(i,!1),t.lanes=4194304);i.isBackwards?(s.sibling=t.child,t.child=s):(r=i.last,r!==null?r.sibling=s:t.child=s,i.last=s)}return i.tail!==null?(t=i.tail,i.rendering=t,i.tail=t.sibling,i.renderingStartTime=Br(),t.sibling=null,r=Sr.current,dr(Sr,n?r&1|2:r&1),t):(Pn(t),null);case 22:case 23:return Ay(),n=t.memoizedState!==null,e!==null&&e.memoizedState!==null!==n&&(t.flags|=8192),n&&t.mode&1?La&1073741824&&(Pn(t),t.subtreeFlags&6&&(t.flags|=8192)):Pn(t),null;case 24:return null;case 25:return null}throw Error(We(156,t.tag))}function lP(e,t){switch(sy(t),t.tag){case 1:return wa(t.type)&&e1(),e=t.flags,e&65536?(t.flags=e&-65537|128,t):null;case 3:return $u(),yr(ya),yr(Wn),my(),e=t.flags,e&65536&&!(e&128)?(t.flags=e&-65537|128,t):null;case 5:return py(t),null;case 13:if(yr(Sr),e=t.memoizedState,e!==null&&e.dehydrated!==null){if(t.alternate===null)throw Error(We(340));Bu()}return e=t.flags,e&65536?(t.flags=e&-65537|128,t):null;case 19:return yr(Sr),null;case 4:return $u(),null;case 10:return uy(t.type._context),null;case 22:case 23:return Ay(),null;case 24:return null;default:return null}}var Kd=!1,Un=!1,cP=typeof WeakSet=="function"?WeakSet:Set,it=null;function du(e,t){var r=e.ref;if(r!==null)if(typeof r=="function")try{r(null)}catch(n){Lr(e,t,n)}else r.current=null}function Ax(e,t,r){try{r()}catch(n){Lr(e,t,n)}}var bb=!1;function uP(e,t){if(cx=Yp,e=tS(),ay(e)){if("selectionStart"in e)var r={start:e.selectionStart,end:e.selectionEnd};else e:{r=(r=e.ownerDocument)&&r.defaultView||window;var n=r.getSelection&&r.getSelection();if(n&&n.rangeCount!==0){r=n.anchorNode;var a=n.anchorOffset,i=n.focusNode;n=n.focusOffset;try{r.nodeType,i.nodeType}catch{r=null;break e}var s=0,o=-1,l=-1,c=0,u=0,f=e,d=null;t:for(;;){for(var h;f!==r||a!==0&&f.nodeType!==3||(o=s+a),f!==i||n!==0&&f.nodeType!==3||(l=s+n),f.nodeType===3&&(s+=f.nodeValue.length),(h=f.firstChild)!==null;)d=f,f=h;for(;;){if(f===e)break t;if(d===r&&++c===a&&(o=s),d===i&&++u===n&&(l=s),(h=f.nextSibling)!==null)break;f=d,d=f.parentNode}f=h}r=o===-1||l===-1?null:{start:o,end:l}}else r=null}r=r||{start:0,end:0}}else r=null;for(ux={focusedElem:e,selectionRange:r},Yp=!1,it=t;it!==null;)if(t=it,e=t.child,(t.subtreeFlags&1028)!==0&&e!==null)e.return=t,it=e;else for(;it!==null;){t=it;try{var g=t.alternate;if(t.flags&1024)switch(t.tag){case 0:case 11:case 15:break;case 1:if(g!==null){var m=g.memoizedProps,_=g.memoizedState,y=t.stateNode,b=y.getSnapshotBeforeUpdate(t.elementType===t.type?m:Ti(t.type,m),_);y.__reactInternalSnapshotBeforeUpdate=b}break;case 3:var w=t.stateNode.containerInfo;w.nodeType===1?w.textContent="":w.nodeType===9&&w.documentElement&&w.removeChild(w.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(We(163))}}catch(T){Lr(t,t.return,T)}if(e=t.sibling,e!==null){e.return=t.return,it=e;break}it=t.return}return g=bb,bb=!1,g}function mf(e,t,r){var n=t.updateQueue;if(n=n!==null?n.lastEffect:null,n!==null){var a=n=n.next;do{if((a.tag&e)===e){var i=a.destroy;a.destroy=void 0,i!==void 0&&Ax(t,r,i)}a=a.next}while(a!==n)}}function rm(e,t){if(t=t.updateQueue,t=t!==null?t.lastEffect:null,t!==null){var r=t=t.next;do{if((r.tag&e)===e){var n=r.create;r.destroy=n()}r=r.next}while(r!==t)}}function Tx(e){var t=e.ref;if(t!==null){var r=e.stateNode;switch(e.tag){case 5:e=r;break;default:e=r}typeof t=="function"?t(e):t.current=e}}function JS(e){var t=e.alternate;t!==null&&(e.alternate=null,JS(t)),e.child=null,e.deletions=null,e.sibling=null,e.tag===5&&(t=e.stateNode,t!==null&&(delete t[is],delete t[Yf],delete t[dx],delete t[q7],delete t[G7])),e.stateNode=null,e.return=null,e.dependencies=null,e.memoizedProps=null,e.memoizedState=null,e.pendingProps=null,e.stateNode=null,e.updateQueue=null}function QS(e){return e.tag===5||e.tag===3||e.tag===4}function _b(e){e:for(;;){for(;e.sibling===null;){if(e.return===null||QS(e.return))return null;e=e.return}for(e.sibling.return=e.return,e=e.sibling;e.tag!==5&&e.tag!==6&&e.tag!==18;){if(e.flags&2||e.child===null||e.tag===4)continue e;e.child.return=e,e=e.child}if(!(e.flags&2))return e.stateNode}}function Cx(e,t,r){var n=e.tag;if(n===5||n===6)e=e.stateNode,t?r.nodeType===8?r.parentNode.insertBefore(e,t):r.insertBefore(e,t):(r.nodeType===8?(t=r.parentNode,t.insertBefore(e,r)):(t=r,t.appendChild(e)),r=r._reactRootContainer,r!=null||t.onclick!==null||(t.onclick=Zp));else if(n!==4&&(e=e.child,e!==null))for(Cx(e,t,r),e=e.sibling;e!==null;)Cx(e,t,r),e=e.sibling}function Nx(e,t,r){var n=e.tag;if(n===5||n===6)e=e.stateNode,t?r.insertBefore(e,t):r.appendChild(e);else if(n!==4&&(e=e.child,e!==null))for(Nx(e,t,r),e=e.sibling;e!==null;)Nx(e,t,r),e=e.sibling}var wn=null,Pi=!1;function wo(e,t,r){for(r=r.child;r!==null;)ZS(e,t,r),r=r.sibling}function ZS(e,t,r){if(ls&&typeof ls.onCommitFiberUnmount=="function")try{ls.onCommitFiberUnmount(K1,r)}catch{}switch(r.tag){case 5:Un||du(r,t);case 6:var n=wn,a=Pi;wn=null,wo(e,t,r),wn=n,Pi=a,wn!==null&&(Pi?(e=wn,r=r.stateNode,e.nodeType===8?e.parentNode.removeChild(r):e.removeChild(r)):wn.removeChild(r.stateNode));break;case 18:wn!==null&&(Pi?(e=wn,r=r.stateNode,e.nodeType===8?Ug(e.parentNode,r):e.nodeType===1&&Ug(e,r),Wf(e)):Ug(wn,r.stateNode));break;case 4:n=wn,a=Pi,wn=r.stateNode.containerInfo,Pi=!0,wo(e,t,r),wn=n,Pi=a;break;case 0:case 11:case 14:case 15:if(!Un&&(n=r.updateQueue,n!==null&&(n=n.lastEffect,n!==null))){a=n=n.next;do{var i=a,s=i.destroy;i=i.tag,s!==void 0&&(i&2||i&4)&&Ax(r,t,s),a=a.next}while(a!==n)}wo(e,t,r);break;case 1:if(!Un&&(du(r,t),n=r.stateNode,typeof n.componentWillUnmount=="function"))try{n.props=r.memoizedProps,n.state=r.memoizedState,n.componentWillUnmount()}catch(o){Lr(r,t,o)}wo(e,t,r);break;case 21:wo(e,t,r);break;case 22:r.mode&1?(Un=(n=Un)||r.memoizedState!==null,wo(e,t,r),Un=n):wo(e,t,r);break;default:wo(e,t,r)}}function Sb(e){var t=e.updateQueue;if(t!==null){e.updateQueue=null;var r=e.stateNode;r===null&&(r=e.stateNode=new cP),t.forEach(function(n){var a=yP.bind(null,e,n);r.has(n)||(r.add(n),n.then(a,a))})}}function bi(e,t){var r=t.deletions;if(r!==null)for(var n=0;n<r.length;n++){var a=r[n];try{var i=e,s=t,o=s;e:for(;o!==null;){switch(o.tag){case 5:wn=o.stateNode,Pi=!1;break e;case 3:wn=o.stateNode.containerInfo,Pi=!0;break e;case 4:wn=o.stateNode.containerInfo,Pi=!0;break e}o=o.return}if(wn===null)throw Error(We(160));ZS(i,s,a),wn=null,Pi=!1;var l=a.alternate;l!==null&&(l.return=null),a.return=null}catch(c){Lr(a,t,c)}}if(t.subtreeFlags&12854)for(t=t.child;t!==null;)ek(t,e),t=t.sibling}function ek(e,t){var r=e.alternate,n=e.flags;switch(e.tag){case 0:case 11:case 14:case 15:if(bi(t,e),es(e),n&4){try{mf(3,e,e.return),rm(3,e)}catch(m){Lr(e,e.return,m)}try{mf(5,e,e.return)}catch(m){Lr(e,e.return,m)}}break;case 1:bi(t,e),es(e),n&512&&r!==null&&du(r,r.return);break;case 5:if(bi(t,e),es(e),n&512&&r!==null&&du(r,r.return),e.flags&32){var a=e.stateNode;try{$f(a,"")}catch(m){Lr(e,e.return,m)}}if(n&4&&(a=e.stateNode,a!=null)){var i=e.memoizedProps,s=r!==null?r.memoizedProps:i,o=e.type,l=e.updateQueue;if(e.updateQueue=null,l!==null)try{o==="input"&&i.type==="radio"&&i.name!=null&&_6(a,i),Z2(o,s);var c=Z2(o,i);for(s=0;s<l.length;s+=2){var u=l[s],f=l[s+1];u==="style"?T6(a,f):u==="dangerouslySetInnerHTML"?E6(a,f):u==="children"?$f(a,f):Wv(a,u,f,c)}switch(o){case"input":K2(a,i);break;case"textarea":S6(a,i);break;case"select":var d=a._wrapperState.wasMultiple;a._wrapperState.wasMultiple=!!i.multiple;var h=i.value;h!=null?_u(a,!!i.multiple,h,!1):d!==!!i.multiple&&(i.defaultValue!=null?_u(a,!!i.multiple,i.defaultValue,!0):_u(a,!!i.multiple,i.multiple?[]:"",!1))}a[Yf]=i}catch(m){Lr(e,e.return,m)}}break;case 6:if(bi(t,e),es(e),n&4){if(e.stateNode===null)throw Error(We(162));a=e.stateNode,i=e.memoizedProps;try{a.nodeValue=i}catch(m){Lr(e,e.return,m)}}break;case 3:if(bi(t,e),es(e),n&4&&r!==null&&r.memoizedState.isDehydrated)try{Wf(t.containerInfo)}catch(m){Lr(e,e.return,m)}break;case 4:bi(t,e),es(e);break;case 13:bi(t,e),es(e),a=e.child,a.flags&8192&&(i=a.memoizedState!==null,a.stateNode.isHidden=i,!i||a.alternate!==null&&a.alternate.memoizedState!==null||(ky=Br())),n&4&&Sb(e);break;case 22:if(u=r!==null&&r.memoizedState!==null,e.mode&1?(Un=(c=Un)||u,bi(t,e),Un=c):bi(t,e),es(e),n&8192){if(c=e.memoizedState!==null,(e.stateNode.isHidden=c)&&!u&&e.mode&1)for(it=e,u=e.child;u!==null;){for(f=it=u;it!==null;){switch(d=it,h=d.child,d.tag){case 0:case 11:case 14:case 15:mf(4,d,d.return);break;case 1:du(d,d.return);var g=d.stateNode;if(typeof g.componentWillUnmount=="function"){n=d,r=d.return;try{t=n,g.props=t.memoizedProps,g.state=t.memoizedState,g.componentWillUnmount()}catch(m){Lr(n,r,m)}}break;case 5:du(d,d.return);break;case 22:if(d.memoizedState!==null){Eb(f);continue}}h!==null?(h.return=d,it=h):Eb(f)}u=u.sibling}e:for(u=null,f=e;;){if(f.tag===5){if(u===null){u=f;try{a=f.stateNode,c?(i=a.style,typeof i.setProperty=="function"?i.setProperty("display","none","important"):i.display="none"):(o=f.stateNode,l=f.memoizedProps.style,s=l!=null&&l.hasOwnProperty("display")?l.display:null,o.style.display=A6("display",s))}catch(m){Lr(e,e.return,m)}}}else if(f.tag===6){if(u===null)try{f.stateNode.nodeValue=c?"":f.memoizedProps}catch(m){Lr(e,e.return,m)}}else if((f.tag!==22&&f.tag!==23||f.memoizedState===null||f===e)&&f.child!==null){f.child.return=f,f=f.child;continue}if(f===e)break e;for(;f.sibling===null;){if(f.return===null||f.return===e)break e;u===f&&(u=null),f=f.return}u===f&&(u=null),f.sibling.return=f.return,f=f.sibling}}break;case 19:bi(t,e),es(e),n&4&&Sb(e);break;case 21:break;default:bi(t,e),es(e)}}function es(e){var t=e.flags;if(t&2){try{e:{for(var r=e.return;r!==null;){if(QS(r)){var n=r;break e}r=r.return}throw Error(We(160))}switch(n.tag){case 5:var a=n.stateNode;n.flags&32&&($f(a,""),n.flags&=-33);var i=_b(e);Nx(e,i,a);break;case 3:case 4:var s=n.stateNode.containerInfo,o=_b(e);Cx(e,o,s);break;default:throw Error(We(161))}}catch(l){Lr(e,e.return,l)}e.flags&=-3}t&4096&&(e.flags&=-4097)}function fP(e,t,r){it=e,tk(e)}function tk(e,t,r){for(var n=(e.mode&1)!==0;it!==null;){var a=it,i=a.child;if(a.tag===22&&n){var s=a.memoizedState!==null||Kd;if(!s){var o=a.alternate,l=o!==null&&o.memoizedState!==null||Un;o=Kd;var c=Un;if(Kd=s,(Un=l)&&!c)for(it=a;it!==null;)s=it,l=s.child,s.tag===22&&s.memoizedState!==null?Ab(a):l!==null?(l.return=s,it=l):Ab(a);for(;i!==null;)it=i,tk(i),i=i.sibling;it=a,Kd=o,Un=c}kb(e)}else a.subtreeFlags&8772&&i!==null?(i.return=a,it=i):kb(e)}}function kb(e){for(;it!==null;){var t=it;if(t.flags&8772){var r=t.alternate;try{if(t.flags&8772)switch(t.tag){case 0:case 11:case 15:Un||rm(5,t);break;case 1:var n=t.stateNode;if(t.flags&4&&!Un)if(r===null)n.componentDidMount();else{var a=t.elementType===t.type?r.memoizedProps:Ti(t.type,r.memoizedProps);n.componentDidUpdate(a,r.memoizedState,n.__reactInternalSnapshotBeforeUpdate)}var i=t.updateQueue;i!==null&&lb(t,i,n);break;case 3:var s=t.updateQueue;if(s!==null){if(r=null,t.child!==null)switch(t.child.tag){case 5:r=t.child.stateNode;break;case 1:r=t.child.stateNode}lb(t,s,r)}break;case 5:var o=t.stateNode;if(r===null&&t.flags&4){r=o;var l=t.memoizedProps;switch(t.type){case"button":case"input":case"select":case"textarea":l.autoFocus&&r.focus();break;case"img":l.src&&(r.src=l.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(t.memoizedState===null){var c=t.alternate;if(c!==null){var u=c.memoizedState;if(u!==null){var f=u.dehydrated;f!==null&&Wf(f)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(We(163))}Un||t.flags&512&&Tx(t)}catch(d){Lr(t,t.return,d)}}if(t===e){it=null;break}if(r=t.sibling,r!==null){r.return=t.return,it=r;break}it=t.return}}function Eb(e){for(;it!==null;){var t=it;if(t===e){it=null;break}var r=t.sibling;if(r!==null){r.return=t.return,it=r;break}it=t.return}}function Ab(e){for(;it!==null;){var t=it;try{switch(t.tag){case 0:case 11:case 15:var r=t.return;try{rm(4,t)}catch(l){Lr(t,r,l)}break;case 1:var n=t.stateNode;if(typeof n.componentDidMount=="function"){var a=t.return;try{n.componentDidMount()}catch(l){Lr(t,a,l)}}var i=t.return;try{Tx(t)}catch(l){Lr(t,i,l)}break;case 5:var s=t.return;try{Tx(t)}catch(l){Lr(t,s,l)}}}catch(l){Lr(t,t.return,l)}if(t===e){it=null;break}var o=t.sibling;if(o!==null){o.return=t.return,it=o;break}it=t.return}}var hP=Math.ceil,u1=ro.ReactCurrentDispatcher,_y=ro.ReactCurrentOwner,oi=ro.ReactCurrentBatchConfig,Ht=0,gn=null,Qr=null,_n=0,La=0,pu=cl(0),an=0,rh=null,tc=0,nm=0,Sy=0,gf=null,ga=null,ky=0,zu=1/0,Os=null,f1=!1,Px=null,Ko=null,Xd=!1,Mo=null,h1=0,xf=0,Lx=null,Op=-1,Ip=0;function na(){return Ht&6?Br():Op!==-1?Op:Op=Br()}function Xo(e){return e.mode&1?Ht&2&&_n!==0?_n&-_n:X7.transition!==null?(Ip===0&&(Ip=B6()),Ip):(e=rr,e!==0||(e=window.event,e=e===void 0?16:q6(e.type)),e):1}function Bi(e,t,r,n){if(50<xf)throw xf=0,Lx=null,Error(We(185));kh(e,r,n),(!(Ht&2)||e!==gn)&&(e===gn&&(!(Ht&2)&&(nm|=r),an===4&&Fo(e,_n)),ba(e,n),r===1&&Ht===0&&!(t.mode&1)&&(zu=Br()+500,Z1&&ul()))}function ba(e,t){var r=e.callbackNode;XN(e,t);var n=Xp(e,e===gn?_n:0);if(n===0)r!==null&&Dw(r),e.callbackNode=null,e.callbackPriority=0;else if(t=n&-n,e.callbackPriority!==t){if(r!=null&&Dw(r),t===1)e.tag===0?K7(Tb.bind(null,e)):fS(Tb.bind(null,e)),H7(function(){!(Ht&6)&&ul()}),r=null;else{switch(U6(n)){case 1:r=Yv;break;case 4:r=R6;break;case 16:r=Kp;break;case 536870912:r=M6;break;default:r=Kp}r=ck(r,rk.bind(null,e))}e.callbackPriority=t,e.callbackNode=r}}function rk(e,t){if(Op=-1,Ip=0,Ht&6)throw Error(We(327));var r=e.callbackNode;if(Tu()&&e.callbackNode!==r)return null;var n=Xp(e,e===gn?_n:0);if(n===0)return null;if(n&30||n&e.expiredLanes||t)t=d1(e,n);else{t=n;var a=Ht;Ht|=2;var i=ak();(gn!==e||_n!==t)&&(Os=null,zu=Br()+500,Hl(e,t));do try{mP();break}catch(o){nk(e,o)}while(!0);cy(),u1.current=i,Ht=a,Qr!==null?t=0:(gn=null,_n=0,t=an)}if(t!==0){if(t===2&&(a=ax(e),a!==0&&(n=a,t=Fx(e,a))),t===1)throw r=rh,Hl(e,0),Fo(e,n),ba(e,Br()),r;if(t===6)Fo(e,n);else{if(a=e.current.alternate,!(n&30)&&!dP(a)&&(t=d1(e,n),t===2&&(i=ax(e),i!==0&&(n=i,t=Fx(e,i))),t===1))throw r=rh,Hl(e,0),Fo(e,n),ba(e,Br()),r;switch(e.finishedWork=a,e.finishedLanes=n,t){case 0:case 1:throw Error(We(345));case 2:Cl(e,ga,Os);break;case 3:if(Fo(e,n),(n&130023424)===n&&(t=ky+500-Br(),10<t)){if(Xp(e,0)!==0)break;if(a=e.suspendedLanes,(a&n)!==n){na(),e.pingedLanes|=e.suspendedLanes&a;break}e.timeoutHandle=hx(Cl.bind(null,e,ga,Os),t);break}Cl(e,ga,Os);break;case 4:if(Fo(e,n),(n&4194240)===n)break;for(t=e.eventTimes,a=-1;0<n;){var s=31-Mi(n);i=1<<s,s=t[s],s>a&&(a=s),n&=~i}if(n=a,n=Br()-n,n=(120>n?120:480>n?480:1080>n?1080:1920>n?1920:3e3>n?3e3:4320>n?4320:1960*hP(n/1960))-n,10<n){e.timeoutHandle=hx(Cl.bind(null,e,ga,Os),n);break}Cl(e,ga,Os);break;case 5:Cl(e,ga,Os);break;default:throw Error(We(329))}}}return ba(e,Br()),e.callbackNode===r?rk.bind(null,e):null}function Fx(e,t){var r=gf;return e.current.memoizedState.isDehydrated&&(Hl(e,t).flags|=256),e=d1(e,t),e!==2&&(t=ga,ga=r,t!==null&&Ox(t)),e}function Ox(e){ga===null?ga=e:ga.push.apply(ga,e)}function dP(e){for(var t=e;;){if(t.flags&16384){var r=t.updateQueue;if(r!==null&&(r=r.stores,r!==null))for(var n=0;n<r.length;n++){var a=r[n],i=a.getSnapshot;a=a.value;try{if(!Vi(i(),a))return!1}catch{return!1}}}if(r=t.child,t.subtreeFlags&16384&&r!==null)r.return=t,t=r;else{if(t===e)break;for(;t.sibling===null;){if(t.return===null||t.return===e)return!0;t=t.return}t.sibling.return=t.return,t=t.sibling}}return!0}function Fo(e,t){for(t&=~Sy,t&=~nm,e.suspendedLanes|=t,e.pingedLanes&=~t,e=e.expirationTimes;0<t;){var r=31-Mi(t),n=1<<r;e[r]=-1,t&=~n}}function Tb(e){if(Ht&6)throw Error(We(327));Tu();var t=Xp(e,0);if(!(t&1))return ba(e,Br()),null;var r=d1(e,t);if(e.tag!==0&&r===2){var n=ax(e);n!==0&&(t=n,r=Fx(e,n))}if(r===1)throw r=rh,Hl(e,0),Fo(e,t),ba(e,Br()),r;if(r===6)throw Error(We(345));return e.finishedWork=e.current.alternate,e.finishedLanes=t,Cl(e,ga,Os),ba(e,Br()),null}function Ey(e,t){var r=Ht;Ht|=1;try{return e(t)}finally{Ht=r,Ht===0&&(zu=Br()+500,Z1&&ul())}}function rc(e){Mo!==null&&Mo.tag===0&&!(Ht&6)&&Tu();var t=Ht;Ht|=1;var r=oi.transition,n=rr;try{if(oi.transition=null,rr=1,e)return e()}finally{rr=n,oi.transition=r,Ht=t,!(Ht&6)&&ul()}}function Ay(){La=pu.current,yr(pu)}function Hl(e,t){e.finishedWork=null,e.finishedLanes=0;var r=e.timeoutHandle;if(r!==-1&&(e.timeoutHandle=-1,z7(r)),Qr!==null)for(r=Qr.return;r!==null;){var n=r;switch(sy(n),n.tag){case 1:n=n.type.childContextTypes,n!=null&&e1();break;case 3:$u(),yr(ya),yr(Wn),my();break;case 5:py(n);break;case 4:$u();break;case 13:yr(Sr);break;case 19:yr(Sr);break;case 10:uy(n.type._context);break;case 22:case 23:Ay()}r=r.return}if(gn=e,Qr=e=Yo(e.current,null),_n=La=t,an=0,rh=null,Sy=nm=tc=0,ga=gf=null,Bl!==null){for(t=0;t<Bl.length;t++)if(r=Bl[t],n=r.interleaved,n!==null){r.interleaved=null;var a=n.next,i=r.pending;if(i!==null){var s=i.next;i.next=a,n.next=s}r.pending=n}Bl=null}return e}function nk(e,t){do{var r=Qr;try{if(cy(),Pp.current=c1,l1){for(var n=Er.memoizedState;n!==null;){var a=n.queue;a!==null&&(a.pending=null),n=n.next}l1=!1}if(ec=0,pn=nn=Er=null,pf=!1,Zf=0,_y.current=null,r===null||r.return===null){an=1,rh=t,Qr=null;break}e:{var i=e,s=r.return,o=r,l=t;if(t=_n,o.flags|=32768,l!==null&&typeof l=="object"&&typeof l.then=="function"){var c=l,u=o,f=u.tag;if(!(u.mode&1)&&(f===0||f===11||f===15)){var d=u.alternate;d?(u.updateQueue=d.updateQueue,u.memoizedState=d.memoizedState,u.lanes=d.lanes):(u.updateQueue=null,u.memoizedState=null)}var h=pb(s);if(h!==null){h.flags&=-257,mb(h,s,o,i,t),h.mode&1&&db(i,c,t),t=h,l=c;var g=t.updateQueue;if(g===null){var m=new Set;m.add(l),t.updateQueue=m}else g.add(l);break e}else{if(!(t&1)){db(i,c,t),Ty();break e}l=Error(We(426))}}else if(br&&o.mode&1){var _=pb(s);if(_!==null){!(_.flags&65536)&&(_.flags|=256),mb(_,s,o,i,t),oy(Vu(l,o));break e}}i=l=Vu(l,o),an!==4&&(an=2),gf===null?gf=[i]:gf.push(i),i=s;do{switch(i.tag){case 3:i.flags|=65536,t&=-t,i.lanes|=t;var y=US(i,l,t);ob(i,y);break e;case 1:o=l;var b=i.type,w=i.stateNode;if(!(i.flags&128)&&(typeof b.getDerivedStateFromError=="function"||w!==null&&typeof w.componentDidCatch=="function"&&(Ko===null||!Ko.has(w)))){i.flags|=65536,t&=-t,i.lanes|=t;var T=$S(i,o,t);ob(i,T);break e}}i=i.return}while(i!==null)}sk(r)}catch(F){t=F,Qr===r&&r!==null&&(Qr=r=r.return);continue}break}while(!0)}function ak(){var e=u1.current;return u1.current=c1,e===null?c1:e}function Ty(){(an===0||an===3||an===2)&&(an=4),gn===null||!(tc&268435455)&&!(nm&268435455)||Fo(gn,_n)}function d1(e,t){var r=Ht;Ht|=2;var n=ak();(gn!==e||_n!==t)&&(Os=null,Hl(e,t));do try{pP();break}catch(a){nk(e,a)}while(!0);if(cy(),Ht=r,u1.current=n,Qr!==null)throw Error(We(261));return gn=null,_n=0,an}function pP(){for(;Qr!==null;)ik(Qr)}function mP(){for(;Qr!==null&&!UN();)ik(Qr)}function ik(e){var t=lk(e.alternate,e,La);e.memoizedProps=e.pendingProps,t===null?sk(e):Qr=t,_y.current=null}function sk(e){var t=e;do{var r=t.alternate;if(e=t.return,t.flags&32768){if(r=lP(r,t),r!==null){r.flags&=32767,Qr=r;return}if(e!==null)e.flags|=32768,e.subtreeFlags=0,e.deletions=null;else{an=6,Qr=null;return}}else if(r=oP(r,t,La),r!==null){Qr=r;return}if(t=t.sibling,t!==null){Qr=t;return}Qr=t=e}while(t!==null);an===0&&(an=5)}function Cl(e,t,r){var n=rr,a=oi.transition;try{oi.transition=null,rr=1,gP(e,t,r,n)}finally{oi.transition=a,rr=n}return null}function gP(e,t,r,n){do Tu();while(Mo!==null);if(Ht&6)throw Error(We(327));r=e.finishedWork;var a=e.finishedLanes;if(r===null)return null;if(e.finishedWork=null,e.finishedLanes=0,r===e.current)throw Error(We(177));e.callbackNode=null,e.callbackPriority=0;var i=r.lanes|r.childLanes;if(YN(e,i),e===gn&&(Qr=gn=null,_n=0),!(r.subtreeFlags&2064)&&!(r.flags&2064)||Xd||(Xd=!0,ck(Kp,function(){return Tu(),null})),i=(r.flags&15990)!==0,r.subtreeFlags&15990||i){i=oi.transition,oi.transition=null;var s=rr;rr=1;var o=Ht;Ht|=4,_y.current=null,uP(e,r),ek(r,e),j7(ux),Yp=!!cx,ux=cx=null,e.current=r,fP(r),$N(),Ht=o,rr=s,oi.transition=i}else e.current=r;if(Xd&&(Xd=!1,Mo=e,h1=a),i=e.pendingLanes,i===0&&(Ko=null),HN(r.stateNode),ba(e,Br()),t!==null)for(n=e.onRecoverableError,r=0;r<t.length;r++)a=t[r],n(a.value,{componentStack:a.stack,digest:a.digest});if(f1)throw f1=!1,e=Px,Px=null,e;return h1&1&&e.tag!==0&&Tu(),i=e.pendingLanes,i&1?e===Lx?xf++:(xf=0,Lx=e):xf=0,ul(),null}function Tu(){if(Mo!==null){var e=U6(h1),t=oi.transition,r=rr;try{if(oi.transition=null,rr=16>e?16:e,Mo===null)var n=!1;else{if(e=Mo,Mo=null,h1=0,Ht&6)throw Error(We(331));var a=Ht;for(Ht|=4,it=e.current;it!==null;){var i=it,s=i.child;if(it.flags&16){var o=i.deletions;if(o!==null){for(var l=0;l<o.length;l++){var c=o[l];for(it=c;it!==null;){var u=it;switch(u.tag){case 0:case 11:case 15:mf(8,u,i)}var f=u.child;if(f!==null)f.return=u,it=f;else for(;it!==null;){u=it;var d=u.sibling,h=u.return;if(JS(u),u===c){it=null;break}if(d!==null){d.return=h,it=d;break}it=h}}}var g=i.alternate;if(g!==null){var m=g.child;if(m!==null){g.child=null;do{var _=m.sibling;m.sibling=null,m=_}while(m!==null)}}it=i}}if(i.subtreeFlags&2064&&s!==null)s.return=i,it=s;else e:for(;it!==null;){if(i=it,i.flags&2048)switch(i.tag){case 0:case 11:case 15:mf(9,i,i.return)}var y=i.sibling;if(y!==null){y.return=i.return,it=y;break e}it=i.return}}var b=e.current;for(it=b;it!==null;){s=it;var w=s.child;if(s.subtreeFlags&2064&&w!==null)w.return=s,it=w;else e:for(s=b;it!==null;){if(o=it,o.flags&2048)try{switch(o.tag){case 0:case 11:case 15:rm(9,o)}}catch(F){Lr(o,o.return,F)}if(o===s){it=null;break e}var T=o.sibling;if(T!==null){T.return=o.return,it=T;break e}it=o.return}}if(Ht=a,ul(),ls&&typeof ls.onPostCommitFiberRoot=="function")try{ls.onPostCommitFiberRoot(K1,e)}catch{}n=!0}return n}finally{rr=r,oi.transition=t}}return!1}function Cb(e,t,r){t=Vu(r,t),t=US(e,t,1),e=Go(e,t,1),t=na(),e!==null&&(kh(e,1,t),ba(e,t))}function Lr(e,t,r){if(e.tag===3)Cb(e,e,r);else for(;t!==null;){if(t.tag===3){Cb(t,e,r);break}else if(t.tag===1){var n=t.stateNode;if(typeof t.type.getDerivedStateFromError=="function"||typeof n.componentDidCatch=="function"&&(Ko===null||!Ko.has(n))){e=Vu(r,e),e=$S(t,e,1),t=Go(t,e,1),e=na(),t!==null&&(kh(t,1,e),ba(t,e));break}}t=t.return}}function xP(e,t,r){var n=e.pingCache;n!==null&&n.delete(t),t=na(),e.pingedLanes|=e.suspendedLanes&r,gn===e&&(_n&r)===r&&(an===4||an===3&&(_n&130023424)===_n&&500>Br()-ky?Hl(e,0):Sy|=r),ba(e,t)}function ok(e,t){t===0&&(e.mode&1?(t=Bd,Bd<<=1,!(Bd&130023424)&&(Bd=4194304)):t=1);var r=na();e=Xs(e,t),e!==null&&(kh(e,t,r),ba(e,r))}function vP(e){var t=e.memoizedState,r=0;t!==null&&(r=t.retryLane),ok(e,r)}function yP(e,t){var r=0;switch(e.tag){case 13:var n=e.stateNode,a=e.memoizedState;a!==null&&(r=a.retryLane);break;case 19:n=e.stateNode;break;default:throw Error(We(314))}n!==null&&n.delete(t),ok(e,r)}var lk;lk=function(e,t,r){if(e!==null)if(e.memoizedProps!==t.pendingProps||ya.current)va=!0;else{if(!(e.lanes&r)&&!(t.flags&128))return va=!1,sP(e,t,r);va=!!(e.flags&131072)}else va=!1,br&&t.flags&1048576&&hS(t,n1,t.index);switch(t.lanes=0,t.tag){case 2:var n=t.type;Fp(e,t),e=t.pendingProps;var a=Mu(t,Wn.current);Au(t,r),a=xy(null,t,n,e,a,r);var i=vy();return t.flags|=1,typeof a=="object"&&a!==null&&typeof a.render=="function"&&a.$$typeof===void 0?(t.tag=1,t.memoizedState=null,t.updateQueue=null,wa(n)?(i=!0,t1(t)):i=!1,t.memoizedState=a.state!==null&&a.state!==void 0?a.state:null,hy(t),a.updater=tm,t.stateNode=a,a._reactInternals=t,yx(t,n,e,r),t=_x(null,t,n,!0,i,r)):(t.tag=0,br&&i&&iy(t),Qn(null,t,a,r),t=t.child),t;case 16:n=t.elementType;e:{switch(Fp(e,t),e=t.pendingProps,a=n._init,n=a(n._payload),t.type=n,a=t.tag=bP(n),e=Ti(n,e),a){case 0:t=bx(null,t,n,e,r);break e;case 1:t=vb(null,t,n,e,r);break e;case 11:t=gb(null,t,n,e,r);break e;case 14:t=xb(null,t,n,Ti(n.type,e),r);break e}throw Error(We(306,n,""))}return t;case 0:return n=t.type,a=t.pendingProps,a=t.elementType===n?a:Ti(n,a),bx(e,t,n,a,r);case 1:return n=t.type,a=t.pendingProps,a=t.elementType===n?a:Ti(n,a),vb(e,t,n,a,r);case 3:e:{if(WS(t),e===null)throw Error(We(387));n=t.pendingProps,i=t.memoizedState,a=i.element,vS(e,t),s1(t,n,null,r);var s=t.memoizedState;if(n=s.element,i.isDehydrated)if(i={element:n,isDehydrated:!1,cache:s.cache,pendingSuspenseBoundaries:s.pendingSuspenseBoundaries,transitions:s.transitions},t.updateQueue.baseState=i,t.memoizedState=i,t.flags&256){a=Vu(Error(We(423)),t),t=yb(e,t,n,r,a);break e}else if(n!==a){a=Vu(Error(We(424)),t),t=yb(e,t,n,r,a);break e}else for(Ia=qo(t.stateNode.containerInfo.firstChild),ja=t,br=!0,Oi=null,r=gS(t,null,n,r),t.child=r;r;)r.flags=r.flags&-3|4096,r=r.sibling;else{if(Bu(),n===a){t=Ys(e,t,r);break e}Qn(e,t,n,r)}t=t.child}return t;case 5:return yS(t),e===null&&gx(t),n=t.type,a=t.pendingProps,i=e!==null?e.memoizedProps:null,s=a.children,fx(n,a)?s=null:i!==null&&fx(n,i)&&(t.flags|=32),HS(e,t),Qn(e,t,s,r),t.child;case 6:return e===null&&gx(t),null;case 13:return qS(e,t,r);case 4:return dy(t,t.stateNode.containerInfo),n=t.pendingProps,e===null?t.child=Uu(t,null,n,r):Qn(e,t,n,r),t.child;case 11:return n=t.type,a=t.pendingProps,a=t.elementType===n?a:Ti(n,a),gb(e,t,n,a,r);case 7:return Qn(e,t,t.pendingProps,r),t.child;case 8:return Qn(e,t,t.pendingProps.children,r),t.child;case 12:return Qn(e,t,t.pendingProps.children,r),t.child;case 10:e:{if(n=t.type._context,a=t.pendingProps,i=t.memoizedProps,s=a.value,dr(a1,n._currentValue),n._currentValue=s,i!==null)if(Vi(i.value,s)){if(i.children===a.children&&!ya.current){t=Ys(e,t,r);break e}}else for(i=t.child,i!==null&&(i.return=t);i!==null;){var o=i.dependencies;if(o!==null){s=i.child;for(var l=o.firstContext;l!==null;){if(l.context===n){if(i.tag===1){l=$s(-1,r&-r),l.tag=2;var c=i.updateQueue;if(c!==null){c=c.shared;var u=c.pending;u===null?l.next=l:(l.next=u.next,u.next=l),c.pending=l}}i.lanes|=r,l=i.alternate,l!==null&&(l.lanes|=r),xx(i.return,r,t),o.lanes|=r;break}l=l.next}}else if(i.tag===10)s=i.type===t.type?null:i.child;else if(i.tag===18){if(s=i.return,s===null)throw Error(We(341));s.lanes|=r,o=s.alternate,o!==null&&(o.lanes|=r),xx(s,r,t),s=i.sibling}else s=i.child;if(s!==null)s.return=i;else for(s=i;s!==null;){if(s===t){s=null;break}if(i=s.sibling,i!==null){i.return=s.return,s=i;break}s=s.return}i=s}Qn(e,t,a.children,r),t=t.child}return t;case 9:return a=t.type,n=t.pendingProps.children,Au(t,r),a=ci(a),n=n(a),t.flags|=1,Qn(e,t,n,r),t.child;case 14:return n=t.type,a=Ti(n,t.pendingProps),a=Ti(n.type,a),xb(e,t,n,a,r);case 15:return VS(e,t,t.type,t.pendingProps,r);case 17:return n=t.type,a=t.pendingProps,a=t.elementType===n?a:Ti(n,a),Fp(e,t),t.tag=1,wa(n)?(e=!0,t1(t)):e=!1,Au(t,r),BS(t,n,a),yx(t,n,a,r),_x(null,t,n,!0,e,r);case 19:return GS(e,t,r);case 22:return zS(e,t,r)}throw Error(We(156,t.tag))};function ck(e,t){return j6(e,t)}function wP(e,t,r,n){this.tag=e,this.key=r,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=t,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=n,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function si(e,t,r,n){return new wP(e,t,r,n)}function Cy(e){return e=e.prototype,!(!e||!e.isReactComponent)}function bP(e){if(typeof e=="function")return Cy(e)?1:0;if(e!=null){if(e=e.$$typeof,e===Gv)return 11;if(e===Kv)return 14}return 2}function Yo(e,t){var r=e.alternate;return r===null?(r=si(e.tag,t,e.key,e.mode),r.elementType=e.elementType,r.type=e.type,r.stateNode=e.stateNode,r.alternate=e,e.alternate=r):(r.pendingProps=t,r.type=e.type,r.flags=0,r.subtreeFlags=0,r.deletions=null),r.flags=e.flags&14680064,r.childLanes=e.childLanes,r.lanes=e.lanes,r.child=e.child,r.memoizedProps=e.memoizedProps,r.memoizedState=e.memoizedState,r.updateQueue=e.updateQueue,t=e.dependencies,r.dependencies=t===null?null:{lanes:t.lanes,firstContext:t.firstContext},r.sibling=e.sibling,r.index=e.index,r.ref=e.ref,r}function Dp(e,t,r,n,a,i){var s=2;if(n=e,typeof e=="function")Cy(e)&&(s=1);else if(typeof e=="string")s=5;else e:switch(e){case au:return Wl(r.children,a,i,t);case qv:s=8,a|=8;break;case z2:return e=si(12,r,t,a|2),e.elementType=z2,e.lanes=i,e;case H2:return e=si(13,r,t,a),e.elementType=H2,e.lanes=i,e;case W2:return e=si(19,r,t,a),e.elementType=W2,e.lanes=i,e;case y6:return am(r,a,i,t);default:if(typeof e=="object"&&e!==null)switch(e.$$typeof){case x6:s=10;break e;case v6:s=9;break e;case Gv:s=11;break e;case Kv:s=14;break e;case To:s=16,n=null;break e}throw Error(We(130,e==null?e:typeof e,""))}return t=si(s,r,t,a),t.elementType=e,t.type=n,t.lanes=i,t}function Wl(e,t,r,n){return e=si(7,e,n,t),e.lanes=r,e}function am(e,t,r,n){return e=si(22,e,n,t),e.elementType=y6,e.lanes=r,e.stateNode={isHidden:!1},e}function Kg(e,t,r){return e=si(6,e,null,t),e.lanes=r,e}function Xg(e,t,r){return t=si(4,e.children!==null?e.children:[],e.key,t),t.lanes=r,t.stateNode={containerInfo:e.containerInfo,pendingChildren:null,implementation:e.implementation},t}function _P(e,t,r,n,a){this.tag=t,this.containerInfo=e,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=Ng(0),this.expirationTimes=Ng(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=Ng(0),this.identifierPrefix=n,this.onRecoverableError=a,this.mutableSourceEagerHydrationData=null}function Ny(e,t,r,n,a,i,s,o,l){return e=new _P(e,t,r,o,l),t===1?(t=1,i===!0&&(t|=8)):t=0,i=si(3,null,null,t),e.current=i,i.stateNode=e,i.memoizedState={element:n,isDehydrated:r,cache:null,transitions:null,pendingSuspenseBoundaries:null},hy(i),e}function SP(e,t,r){var n=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:nu,key:n==null?null:""+n,children:e,containerInfo:t,implementation:r}}function uk(e){if(!e)return el;e=e._reactInternals;e:{if(lc(e)!==e||e.tag!==1)throw Error(We(170));var t=e;do{switch(t.tag){case 3:t=t.stateNode.context;break e;case 1:if(wa(t.type)){t=t.stateNode.__reactInternalMemoizedMergedChildContext;break e}}t=t.return}while(t!==null);throw Error(We(171))}if(e.tag===1){var r=e.type;if(wa(r))return uS(e,r,t)}return t}function fk(e,t,r,n,a,i,s,o,l){return e=Ny(r,n,!0,e,a,i,s,o,l),e.context=uk(null),r=e.current,n=na(),a=Xo(r),i=$s(n,a),i.callback=t??null,Go(r,i,a),e.current.lanes=a,kh(e,a,n),ba(e,n),e}function im(e,t,r,n){var a=t.current,i=na(),s=Xo(a);return r=uk(r),t.context===null?t.context=r:t.pendingContext=r,t=$s(i,s),t.payload={element:e},n=n===void 0?null:n,n!==null&&(t.callback=n),e=Go(a,t,s),e!==null&&(Bi(e,a,s,i),Np(e,a,s)),s}function p1(e){if(e=e.current,!e.child)return null;switch(e.child.tag){case 5:return e.child.stateNode;default:return e.child.stateNode}}function Nb(e,t){if(e=e.memoizedState,e!==null&&e.dehydrated!==null){var r=e.retryLane;e.retryLane=r!==0&&r<t?r:t}}function Py(e,t){Nb(e,t),(e=e.alternate)&&Nb(e,t)}function kP(){return null}var hk=typeof reportError=="function"?reportError:function(e){console.error(e)};function Ly(e){this._internalRoot=e}sm.prototype.render=Ly.prototype.render=function(e){var t=this._internalRoot;if(t===null)throw Error(We(409));im(e,t,null,null)};sm.prototype.unmount=Ly.prototype.unmount=function(){var e=this._internalRoot;if(e!==null){this._internalRoot=null;var t=e.containerInfo;rc(function(){im(null,e,null,null)}),t[Ks]=null}};function sm(e){this._internalRoot=e}sm.prototype.unstable_scheduleHydration=function(e){if(e){var t=z6();e={blockedOn:null,target:e,priority:t};for(var r=0;r<Lo.length&&t!==0&&t<Lo[r].priority;r++);Lo.splice(r,0,e),r===0&&W6(e)}};function Fy(e){return!(!e||e.nodeType!==1&&e.nodeType!==9&&e.nodeType!==11)}function om(e){return!(!e||e.nodeType!==1&&e.nodeType!==9&&e.nodeType!==11&&(e.nodeType!==8||e.nodeValue!==" react-mount-point-unstable "))}function Pb(){}function EP(e,t,r,n,a){if(a){if(typeof n=="function"){var i=n;n=function(){var c=p1(s);i.call(c)}}var s=fk(t,n,e,0,null,!1,!1,"",Pb);return e._reactRootContainer=s,e[Ks]=s.current,Kf(e.nodeType===8?e.parentNode:e),rc(),s}for(;a=e.lastChild;)e.removeChild(a);if(typeof n=="function"){var o=n;n=function(){var c=p1(l);o.call(c)}}var l=Ny(e,0,!1,null,null,!1,!1,"",Pb);return e._reactRootContainer=l,e[Ks]=l.current,Kf(e.nodeType===8?e.parentNode:e),rc(function(){im(t,l,r,n)}),l}function lm(e,t,r,n,a){var i=r._reactRootContainer;if(i){var s=i;if(typeof a=="function"){var o=a;a=function(){var l=p1(s);o.call(l)}}im(t,s,e,a)}else s=EP(r,t,e,a,n);return p1(s)}$6=function(e){switch(e.tag){case 3:var t=e.stateNode;if(t.current.memoizedState.isDehydrated){var r=ef(t.pendingLanes);r!==0&&(Jv(t,r|1),ba(t,Br()),!(Ht&6)&&(zu=Br()+500,ul()))}break;case 13:rc(function(){var n=Xs(e,1);if(n!==null){var a=na();Bi(n,e,1,a)}}),Py(e,1)}};Qv=function(e){if(e.tag===13){var t=Xs(e,134217728);if(t!==null){var r=na();Bi(t,e,134217728,r)}Py(e,134217728)}};V6=function(e){if(e.tag===13){var t=Xo(e),r=Xs(e,t);if(r!==null){var n=na();Bi(r,e,t,n)}Py(e,t)}};z6=function(){return rr};H6=function(e,t){var r=rr;try{return rr=e,t()}finally{rr=r}};tx=function(e,t,r){switch(t){case"input":if(K2(e,r),t=r.name,r.type==="radio"&&t!=null){for(r=e;r.parentNode;)r=r.parentNode;for(r=r.querySelectorAll("input[name="+JSON.stringify(""+t)+'][type="radio"]'),t=0;t<r.length;t++){var n=r[t];if(n!==e&&n.form===e.form){var a=Q1(n);if(!a)throw Error(We(90));b6(n),K2(n,a)}}}break;case"textarea":S6(e,r);break;case"select":t=r.value,t!=null&&_u(e,!!r.multiple,t,!1)}};P6=Ey;L6=rc;var AP={usingClientEntryPoint:!1,Events:[Ah,lu,Q1,C6,N6,Ey]},W0={findFiberByHostInstance:Ml,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},TP={bundleType:W0.bundleType,version:W0.version,rendererPackageName:W0.rendererPackageName,rendererConfig:W0.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:ro.ReactCurrentDispatcher,findHostInstanceByFiber:function(e){return e=I6(e),e===null?null:e.stateNode},findFiberByHostInstance:W0.findFiberByHostInstance||kP,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var Yd=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!Yd.isDisabled&&Yd.supportsFiber)try{K1=Yd.inject(TP),ls=Yd}catch{}}Ua.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=AP;Ua.createPortal=function(e,t){var r=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!Fy(t))throw Error(We(200));return SP(e,t,null,r)};Ua.createRoot=function(e,t){if(!Fy(e))throw Error(We(299));var r=!1,n="",a=hk;return t!=null&&(t.unstable_strictMode===!0&&(r=!0),t.identifierPrefix!==void 0&&(n=t.identifierPrefix),t.onRecoverableError!==void 0&&(a=t.onRecoverableError)),t=Ny(e,1,!1,null,null,r,!1,n,a),e[Ks]=t.current,Kf(e.nodeType===8?e.parentNode:e),new Ly(t)};Ua.findDOMNode=function(e){if(e==null)return null;if(e.nodeType===1)return e;var t=e._reactInternals;if(t===void 0)throw typeof e.render=="function"?Error(We(188)):(e=Object.keys(e).join(","),Error(We(268,e)));return e=I6(t),e=e===null?null:e.stateNode,e};Ua.flushSync=function(e){return rc(e)};Ua.hydrate=function(e,t,r){if(!om(t))throw Error(We(200));return lm(null,e,t,!0,r)};Ua.hydrateRoot=function(e,t,r){if(!Fy(e))throw Error(We(405));var n=r!=null&&r.hydratedSources||null,a=!1,i="",s=hk;if(r!=null&&(r.unstable_strictMode===!0&&(a=!0),r.identifierPrefix!==void 0&&(i=r.identifierPrefix),r.onRecoverableError!==void 0&&(s=r.onRecoverableError)),t=fk(t,null,e,1,r??null,a,!1,i,s),e[Ks]=t.current,Kf(e),n)for(e=0;e<n.length;e++)r=n[e],a=r._getVersion,a=a(r._source),t.mutableSourceEagerHydrationData==null?t.mutableSourceEagerHydrationData=[r,a]:t.mutableSourceEagerHydrationData.push(r,a);return new sm(t)};Ua.render=function(e,t,r){if(!om(t))throw Error(We(200));return lm(null,e,t,!1,r)};Ua.unmountComponentAtNode=function(e){if(!om(e))throw Error(We(40));return e._reactRootContainer?(rc(function(){lm(null,null,e,!1,function(){e._reactRootContainer=null,e[Ks]=null})}),!0):!1};Ua.unstable_batchedUpdates=Ey;Ua.unstable_renderSubtreeIntoContainer=function(e,t,r,n){if(!om(r))throw Error(We(200));if(e==null||e._reactInternals===void 0)throw Error(We(38));return lm(e,t,r,!1,n)};Ua.version="18.3.1-next-f1338f8080-20240426";function dk(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(dk)}catch(e){console.error(e)}}dk(),d6.exports=Ua;var pk=d6.exports,mk,Lb=pk;mk=Lb.createRoot,Lb.hydrateRoot;let CP={data:""},NP=e=>typeof window=="object"?((e?e.querySelector("#_goober"):window._goober)||Object.assign((e||document.head).appendChild(document.createElement("style")),{innerHTML:" ",id:"_goober"})).firstChild:e||CP,PP=/(?:([\u0080-\uFFFF\w-%@]+) *:? *([^{;]+?);|([^;}{]*?) *{)|(}\s*)/g,LP=/\/\*[^]*?\*\/|  +/g,Fb=/\n+/g,Oo=(e,t)=>{let r="",n="",a="";for(let i in e){let s=e[i];i[0]=="@"?i[1]=="i"?r=i+" "+s+";":n+=i[1]=="f"?Oo(s,i):i+"{"+Oo(s,i[1]=="k"?"":t)+"}":typeof s=="object"?n+=Oo(s,t?t.replace(/([^,])+/g,o=>i.replace(/([^,]*:\S+\([^)]*\))|([^,])+/g,l=>/&/.test(l)?l.replace(/&/g,o):o?o+" "+l:l)):i):s!=null&&(i=/^--/.test(i)?i:i.replace(/[A-Z]/g,"-$&").toLowerCase(),a+=Oo.p?Oo.p(i,s):i+":"+s+";")}return r+(t&&a?t+"{"+a+"}":a)+n},Ps={},gk=e=>{if(typeof e=="object"){let t="";for(let r in e)t+=r+gk(e[r]);return t}return e},FP=(e,t,r,n,a)=>{let i=gk(e),s=Ps[i]||(Ps[i]=(l=>{let c=0,u=11;for(;c<l.length;)u=101*u+l.charCodeAt(c++)>>>0;return"go"+u})(i));if(!Ps[s]){let l=i!==e?e:(c=>{let u,f,d=[{}];for(;u=PP.exec(c.replace(LP,""));)u[4]?d.shift():u[3]?(f=u[3].replace(Fb," ").trim(),d.unshift(d[0][f]=d[0][f]||{})):d[0][u[1]]=u[2].replace(Fb," ").trim();return d[0]})(e);Ps[s]=Oo(a?{["@keyframes "+s]:l}:l,r?"":"."+s)}let o=r&&Ps.g?Ps.g:null;return r&&(Ps.g=Ps[s]),((l,c,u,f)=>{f?c.data=c.data.replace(f,l):c.data.indexOf(l)===-1&&(c.data=u?l+c.data:c.data+l)})(Ps[s],t,n,o),s},OP=(e,t,r)=>e.reduce((n,a,i)=>{let s=t[i];if(s&&s.call){let o=s(r),l=o&&o.props&&o.props.className||/^go/.test(o)&&o;s=l?"."+l:o&&typeof o=="object"?o.props?"":Oo(o,""):o===!1?"":o}return n+a+(s??"")},"");function cm(e){let t=this||{},r=e.call?e(t.p):e;return FP(r.unshift?r.raw?OP(r,[].slice.call(arguments,1),t.p):r.reduce((n,a)=>Object.assign(n,a&&a.call?a(t.p):a),{}):r,NP(t.target),t.g,t.o,t.k)}let xk,Ix,Dx;cm.bind({g:1});let Js=cm.bind({k:1});function IP(e,t,r,n){Oo.p=t,xk=e,Ix=r,Dx=n}function fl(e,t){let r=this||{};return function(){let n=arguments;function a(i,s){let o=Object.assign({},i),l=o.className||a.className;r.p=Object.assign({theme:Ix&&Ix()},o),r.o=/ *go\d+/.test(l),o.className=cm.apply(r,n)+(l?" "+l:"");let c=e;return e[0]&&(c=o.as||e,delete o.as),Dx&&c[0]&&Dx(o),xk(c,o)}return a}}var DP=e=>typeof e=="function",m1=(e,t)=>DP(e)?e(t):e,jP=(()=>{let e=0;return()=>(++e).toString()})(),vk=(()=>{let e;return()=>{if(e===void 0&&typeof window<"u"){let t=matchMedia("(prefers-reduced-motion: reduce)");e=!t||t.matches}return e}})(),RP=20,yk=(e,t)=>{switch(t.type){case 0:return{...e,toasts:[t.toast,...e.toasts].slice(0,RP)};case 1:return{...e,toasts:e.toasts.map(i=>i.id===t.toast.id?{...i,...t.toast}:i)};case 2:let{toast:r}=t;return yk(e,{type:e.toasts.find(i=>i.id===r.id)?1:0,toast:r});case 3:let{toastId:n}=t;return{...e,toasts:e.toasts.map(i=>i.id===n||n===void 0?{...i,dismissed:!0,visible:!1}:i)};case 4:return t.toastId===void 0?{...e,toasts:[]}:{...e,toasts:e.toasts.filter(i=>i.id!==t.toastId)};case 5:return{...e,pausedAt:t.time};case 6:let a=t.time-(e.pausedAt||0);return{...e,pausedAt:void 0,toasts:e.toasts.map(i=>({...i,pauseDuration:i.pauseDuration+a}))}}},jp=[],$l={toasts:[],pausedAt:void 0},cc=e=>{$l=yk($l,e),jp.forEach(t=>{t($l)})},MP={blank:4e3,error:4e3,success:2e3,loading:1/0,custom:4e3},BP=(e={})=>{let[t,r]=ie.useState($l),n=ie.useRef($l);ie.useEffect(()=>(n.current!==$l&&r($l),jp.push(r),()=>{let i=jp.indexOf(r);i>-1&&jp.splice(i,1)}),[]);let a=t.toasts.map(i=>{var s,o,l;return{...e,...e[i.type],...i,removeDelay:i.removeDelay||((s=e[i.type])==null?void 0:s.removeDelay)||(e==null?void 0:e.removeDelay),duration:i.duration||((o=e[i.type])==null?void 0:o.duration)||(e==null?void 0:e.duration)||MP[i.type],style:{...e.style,...(l=e[i.type])==null?void 0:l.style,...i.style}}});return{...t,toasts:a}},UP=(e,t="blank",r)=>({createdAt:Date.now(),visible:!0,dismissed:!1,type:t,ariaProps:{role:"status","aria-live":"polite"},message:e,pauseDuration:0,...r,id:(r==null?void 0:r.id)||jP()}),Ch=e=>(t,r)=>{let n=UP(t,e,r);return cc({type:2,toast:n}),n.id},ea=(e,t)=>Ch("blank")(e,t);ea.error=Ch("error");ea.success=Ch("success");ea.loading=Ch("loading");ea.custom=Ch("custom");ea.dismiss=e=>{cc({type:3,toastId:e})};ea.remove=e=>cc({type:4,toastId:e});ea.promise=(e,t,r)=>{let n=ea.loading(t.loading,{...r,...r==null?void 0:r.loading});return typeof e=="function"&&(e=e()),e.then(a=>{let i=t.success?m1(t.success,a):void 0;return i?ea.success(i,{id:n,...r,...r==null?void 0:r.success}):ea.dismiss(n),a}).catch(a=>{let i=t.error?m1(t.error,a):void 0;i?ea.error(i,{id:n,...r,...r==null?void 0:r.error}):ea.dismiss(n)}),e};var $P=(e,t)=>{cc({type:1,toast:{id:e,height:t}})},VP=()=>{cc({type:5,time:Date.now()})},vf=new Map,zP=1e3,HP=(e,t=zP)=>{if(vf.has(e))return;let r=setTimeout(()=>{vf.delete(e),cc({type:4,toastId:e})},t);vf.set(e,r)},WP=e=>{let{toasts:t,pausedAt:r}=BP(e);ie.useEffect(()=>{if(r)return;let i=Date.now(),s=t.map(o=>{if(o.duration===1/0)return;let l=(o.duration||0)+o.pauseDuration-(i-o.createdAt);if(l<0){o.visible&&ea.dismiss(o.id);return}return setTimeout(()=>ea.dismiss(o.id),l)});return()=>{s.forEach(o=>o&&clearTimeout(o))}},[t,r]);let n=ie.useCallback(()=>{r&&cc({type:6,time:Date.now()})},[r]),a=ie.useCallback((i,s)=>{let{reverseOrder:o=!1,gutter:l=8,defaultPosition:c}=s||{},u=t.filter(h=>(h.position||c)===(i.position||c)&&h.height),f=u.findIndex(h=>h.id===i.id),d=u.filter((h,g)=>g<f&&h.visible).length;return u.filter(h=>h.visible).slice(...o?[d+1]:[0,d]).reduce((h,g)=>h+(g.height||0)+l,0)},[t]);return ie.useEffect(()=>{t.forEach(i=>{if(i.dismissed)HP(i.id,i.removeDelay);else{let s=vf.get(i.id);s&&(clearTimeout(s),vf.delete(i.id))}})},[t]),{toasts:t,handlers:{updateHeight:$P,startPause:VP,endPause:n,calculateOffset:a}}},qP=Js`
from {
  transform: scale(0) rotate(45deg);
	opacity: 0;
}
to {
 transform: scale(1) rotate(45deg);
  opacity: 1;
}`,GP=Js`
from {
  transform: scale(0);
  opacity: 0;
}
to {
  transform: scale(1);
  opacity: 1;
}`,KP=Js`
from {
  transform: scale(0) rotate(90deg);
	opacity: 0;
}
to {
  transform: scale(1) rotate(90deg);
	opacity: 1;
}`,XP=fl("div")`
  width: 20px;
  opacity: 0;
  height: 20px;
  border-radius: 10px;
  background: ${e=>e.primary||"#ff4b4b"};
  position: relative;
  transform: rotate(45deg);

  animation: ${qP} 0.3s cubic-bezier(0.175, 0.885, 0.32, 1.275)
    forwards;
  animation-delay: 100ms;

  &:after,
  &:before {
    content: '';
    animation: ${GP} 0.15s ease-out forwards;
    animation-delay: 150ms;
    position: absolute;
    border-radius: 3px;
    opacity: 0;
    background: ${e=>e.secondary||"#fff"};
    bottom: 9px;
    left: 4px;
    height: 2px;
    width: 12px;
  }

  &:before {
    animation: ${KP} 0.15s ease-out forwards;
    animation-delay: 180ms;
    transform: rotate(90deg);
  }
`,YP=Js`
  from {
    transform: rotate(0deg);
  }
  to {
    transform: rotate(360deg);
  }
`,JP=fl("div")`
  width: 12px;
  height: 12px;
  box-sizing: border-box;
  border: 2px solid;
  border-radius: 100%;
  border-color: ${e=>e.secondary||"#e0e0e0"};
  border-right-color: ${e=>e.primary||"#616161"};
  animation: ${YP} 1s linear infinite;
`,QP=Js`
from {
  transform: scale(0) rotate(45deg);
	opacity: 0;
}
to {
  transform: scale(1) rotate(45deg);
	opacity: 1;
}`,ZP=Js`
0% {
	height: 0;
	width: 0;
	opacity: 0;
}
40% {
  height: 0;
	width: 6px;
	opacity: 1;
}
100% {
  opacity: 1;
  height: 10px;
}`,eL=fl("div")`
  width: 20px;
  opacity: 0;
  height: 20px;
  border-radius: 10px;
  background: ${e=>e.primary||"#61d345"};
  position: relative;
  transform: rotate(45deg);

  animation: ${QP} 0.3s cubic-bezier(0.175, 0.885, 0.32, 1.275)
    forwards;
  animation-delay: 100ms;
  &:after {
    content: '';
    box-sizing: border-box;
    animation: ${ZP} 0.2s ease-out forwards;
    opacity: 0;
    animation-delay: 200ms;
    position: absolute;
    border-right: 2px solid;
    border-bottom: 2px solid;
    border-color: ${e=>e.secondary||"#fff"};
    bottom: 6px;
    left: 6px;
    height: 10px;
    width: 6px;
  }
`,tL=fl("div")`
  position: absolute;
`,rL=fl("div")`
  position: relative;
  display: flex;
  justify-content: center;
  align-items: center;
  min-width: 20px;
  min-height: 20px;
`,nL=Js`
from {
  transform: scale(0.6);
  opacity: 0.4;
}
to {
  transform: scale(1);
  opacity: 1;
}`,aL=fl("div")`
  position: relative;
  transform: scale(0.6);
  opacity: 0.4;
  min-width: 20px;
  animation: ${nL} 0.3s 0.12s cubic-bezier(0.175, 0.885, 0.32, 1.275)
    forwards;
`,iL=({toast:e})=>{let{icon:t,type:r,iconTheme:n}=e;return t!==void 0?typeof t=="string"?ie.createElement(aL,null,t):t:r==="blank"?null:ie.createElement(rL,null,ie.createElement(JP,{...n}),r!=="loading"&&ie.createElement(tL,null,r==="error"?ie.createElement(XP,{...n}):ie.createElement(eL,{...n})))},sL=e=>`
0% {transform: translate3d(0,${e*-200}%,0) scale(.6); opacity:.5;}
100% {transform: translate3d(0,0,0) scale(1); opacity:1;}
`,oL=e=>`
0% {transform: translate3d(0,0,-1px) scale(1); opacity:1;}
100% {transform: translate3d(0,${e*-150}%,-1px) scale(.6); opacity:0;}
`,lL="0%{opacity:0;} 100%{opacity:1;}",cL="0%{opacity:1;} 100%{opacity:0;}",uL=fl("div")`
  display: flex;
  align-items: center;
  background: #fff;
  color: #363636;
  line-height: 1.3;
  will-change: transform;
  box-shadow: 0 3px 10px rgba(0, 0, 0, 0.1), 0 3px 3px rgba(0, 0, 0, 0.05);
  max-width: 350px;
  pointer-events: auto;
  padding: 8px 10px;
  border-radius: 8px;
`,fL=fl("div")`
  display: flex;
  justify-content: center;
  margin: 4px 10px;
  color: inherit;
  flex: 1 1 auto;
  white-space: pre-line;
`,hL=(e,t)=>{let r=e.includes("top")?1:-1,[n,a]=vk()?[lL,cL]:[sL(r),oL(r)];return{animation:t?`${Js(n)} 0.35s cubic-bezier(.21,1.02,.73,1) forwards`:`${Js(a)} 0.4s forwards cubic-bezier(.06,.71,.55,1)`}},dL=ie.memo(({toast:e,position:t,style:r,children:n})=>{let a=e.height?hL(e.position||t||"top-center",e.visible):{opacity:0},i=ie.createElement(iL,{toast:e}),s=ie.createElement(fL,{...e.ariaProps},m1(e.message,e));return ie.createElement(uL,{className:e.className,style:{...a,...r,...e.style}},typeof n=="function"?n({icon:i,message:s}):ie.createElement(ie.Fragment,null,i,s))});IP(ie.createElement);var pL=({id:e,className:t,style:r,onHeightUpdate:n,children:a})=>{let i=ie.useCallback(s=>{if(s){let o=()=>{let l=s.getBoundingClientRect().height;n(e,l)};o(),new MutationObserver(o).observe(s,{subtree:!0,childList:!0,characterData:!0})}},[e,n]);return ie.createElement("div",{ref:i,className:t,style:r},a)},mL=(e,t)=>{let r=e.includes("top"),n=r?{top:0}:{bottom:0},a=e.includes("center")?{justifyContent:"center"}:e.includes("right")?{justifyContent:"flex-end"}:{};return{left:0,right:0,display:"flex",position:"absolute",transition:vk()?void 0:"all 230ms cubic-bezier(.21,1.02,.73,1)",transform:`translateY(${t*(r?1:-1)}px)`,...n,...a}},gL=cm`
  z-index: 9999;
  > * {
    pointer-events: auto;
  }
`,Jd=16,xL=({reverseOrder:e,position:t="top-center",toastOptions:r,gutter:n,children:a,containerStyle:i,containerClassName:s})=>{let{toasts:o,handlers:l}=WP(r);return ie.createElement("div",{id:"_rht_toaster",style:{position:"fixed",zIndex:9999,top:Jd,left:Jd,right:Jd,bottom:Jd,pointerEvents:"none",...i},className:s,onMouseEnter:l.startPause,onMouseLeave:l.endPause},o.map(c=>{let u=c.position||t,f=l.calculateOffset(c,{reverseOrder:e,gutter:n,defaultPosition:t}),d=mL(u,f);return ie.createElement(pL,{id:c.id,key:c.id,onHeightUpdate:l.updateHeight,className:c.visible?gL:"",style:d},c.type==="custom"?m1(c.message,c):a?a(c):ie.createElement(dL,{toast:c,position:u}))}))},st=ea;const vL="modulepreload",yL=function(e){return"/papeleria/"+e},Ob={},tl=function(t,r,n){let a=Promise.resolve();if(r&&r.length>0){document.getElementsByTagName("link");const s=document.querySelector("meta[property=csp-nonce]"),o=(s==null?void 0:s.nonce)||(s==null?void 0:s.getAttribute("nonce"));a=Promise.allSettled(r.map(l=>{if(l=yL(l),l in Ob)return;Ob[l]=!0;const c=l.endsWith(".css"),u=c?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${l}"]${u}`))return;const f=document.createElement("link");if(f.rel=c?"stylesheet":vL,c||(f.as="script"),f.crossOrigin="",f.href=l,o&&f.setAttribute("nonce",o),document.head.appendChild(f),c)return new Promise((d,h)=>{f.addEventListener("load",d),f.addEventListener("error",()=>h(new Error(`Unable to preload CSS for ${l}`)))})}))}function i(s){const o=new Event("vite:preloadError",{cancelable:!0});if(o.payload=s,window.dispatchEvent(o),!o.defaultPrevented)throw s}return a.then(s=>{for(const o of s||[])o.status==="rejected"&&i(o.reason);return t().catch(i)})},wL=e=>{let t;return e?t=e:typeof fetch>"u"?t=(...r)=>tl(async()=>{const{default:n}=await Promise.resolve().then(()=>t0);return{default:n}},void 0).then(({default:n})=>n(...r)):t=fetch,(...r)=>t(...r)};class Oy extends Error{constructor(t,r="FunctionsError",n){super(t),this.name=r,this.context=n}}class bL extends Oy{constructor(t){super("Failed to send a request to the Edge Function","FunctionsFetchError",t)}}class Ib extends Oy{constructor(t){super("Relay Error invoking the Edge Function","FunctionsRelayError",t)}}class Db extends Oy{constructor(t){super("Edge Function returned a non-2xx status code","FunctionsHttpError",t)}}var jx;(function(e){e.Any="any",e.ApNortheast1="ap-northeast-1",e.ApNortheast2="ap-northeast-2",e.ApSouth1="ap-south-1",e.ApSoutheast1="ap-southeast-1",e.ApSoutheast2="ap-southeast-2",e.CaCentral1="ca-central-1",e.EuCentral1="eu-central-1",e.EuWest1="eu-west-1",e.EuWest2="eu-west-2",e.EuWest3="eu-west-3",e.SaEast1="sa-east-1",e.UsEast1="us-east-1",e.UsWest1="us-west-1",e.UsWest2="us-west-2"})(jx||(jx={}));var _L=function(e,t,r,n){function a(i){return i instanceof r?i:new r(function(s){s(i)})}return new(r||(r=Promise))(function(i,s){function o(u){try{c(n.next(u))}catch(f){s(f)}}function l(u){try{c(n.throw(u))}catch(f){s(f)}}function c(u){u.done?i(u.value):a(u.value).then(o,l)}c((n=n.apply(e,t||[])).next())})};class SL{constructor(t,{headers:r={},customFetch:n,region:a=jx.Any}={}){this.url=t,this.headers=r,this.region=a,this.fetch=wL(n)}setAuth(t){this.headers.Authorization=`Bearer ${t}`}invoke(t,r={}){var n;return _L(this,void 0,void 0,function*(){try{const{headers:a,method:i,body:s}=r;let o={},{region:l}=r;l||(l=this.region);const c=new URL(`${this.url}/${t}`);l&&l!=="any"&&(o["x-region"]=l,c.searchParams.set("forceFunctionRegion",l));let u;s&&(a&&!Object.prototype.hasOwnProperty.call(a,"Content-Type")||!a)&&(typeof Blob<"u"&&s instanceof Blob||s instanceof ArrayBuffer?(o["Content-Type"]="application/octet-stream",u=s):typeof s=="string"?(o["Content-Type"]="text/plain",u=s):typeof FormData<"u"&&s instanceof FormData?u=s:(o["Content-Type"]="application/json",u=JSON.stringify(s)));const f=yield this.fetch(c.toString(),{method:i||"POST",headers:Object.assign(Object.assign(Object.assign({},o),this.headers),a),body:u}).catch(m=>{throw new bL(m)}),d=f.headers.get("x-relay-error");if(d&&d==="true")throw new Ib(f);if(!f.ok)throw new Db(f);let h=((n=f.headers.get("Content-Type"))!==null&&n!==void 0?n:"text/plain").split(";")[0].trim(),g;return h==="application/json"?g=yield f.json():h==="application/octet-stream"?g=yield f.blob():h==="text/event-stream"?g=f:h==="multipart/form-data"?g=yield f.formData():g=yield f.text(),{data:g,error:null,response:f}}catch(a){return{data:null,error:a,response:a instanceof Db||a instanceof Ib?a.context:void 0}}})}}var xa={},Iy={},um={},Nh={},fm={},hm={},kL=function(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("unable to locate global object")},Hu=kL();const EL=Hu.fetch,wk=Hu.fetch.bind(Hu),bk=Hu.Headers,AL=Hu.Request,TL=Hu.Response,t0=Object.freeze(Object.defineProperty({__proto__:null,Headers:bk,Request:AL,Response:TL,default:wk,fetch:EL},Symbol.toStringTag,{value:"Module"})),CL=t6(t0);var dm={};Object.defineProperty(dm,"__esModule",{value:!0});let NL=class extends Error{constructor(t){super(t.message),this.name="PostgrestError",this.details=t.details,this.hint=t.hint,this.code=t.code}};dm.default=NL;var _k=li&&li.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(hm,"__esModule",{value:!0});const PL=_k(CL),LL=_k(dm);let FL=class{constructor(t){this.shouldThrowOnError=!1,this.method=t.method,this.url=t.url,this.headers=t.headers,this.schema=t.schema,this.body=t.body,this.shouldThrowOnError=t.shouldThrowOnError,this.signal=t.signal,this.isMaybeSingle=t.isMaybeSingle,t.fetch?this.fetch=t.fetch:typeof fetch>"u"?this.fetch=PL.default:this.fetch=fetch}throwOnError(){return this.shouldThrowOnError=!0,this}setHeader(t,r){return this.headers=Object.assign({},this.headers),this.headers[t]=r,this}then(t,r){this.schema===void 0||(["GET","HEAD"].includes(this.method)?this.headers["Accept-Profile"]=this.schema:this.headers["Content-Profile"]=this.schema),this.method!=="GET"&&this.method!=="HEAD"&&(this.headers["Content-Type"]="application/json");const n=this.fetch;let a=n(this.url.toString(),{method:this.method,headers:this.headers,body:JSON.stringify(this.body),signal:this.signal}).then(async i=>{var s,o,l;let c=null,u=null,f=null,d=i.status,h=i.statusText;if(i.ok){if(this.method!=="HEAD"){const y=await i.text();y===""||(this.headers.Accept==="text/csv"||this.headers.Accept&&this.headers.Accept.includes("application/vnd.pgrst.plan+text")?u=y:u=JSON.parse(y))}const m=(s=this.headers.Prefer)===null||s===void 0?void 0:s.match(/count=(exact|planned|estimated)/),_=(o=i.headers.get("content-range"))===null||o===void 0?void 0:o.split("/");m&&_&&_.length>1&&(f=parseInt(_[1])),this.isMaybeSingle&&this.method==="GET"&&Array.isArray(u)&&(u.length>1?(c={code:"PGRST116",details:`Results contain ${u.length} rows, application/vnd.pgrst.object+json requires 1 row`,hint:null,message:"JSON object requested, multiple (or no) rows returned"},u=null,f=null,d=406,h="Not Acceptable"):u.length===1?u=u[0]:u=null)}else{const m=await i.text();try{c=JSON.parse(m),Array.isArray(c)&&i.status===404&&(u=[],c=null,d=200,h="OK")}catch{i.status===404&&m===""?(d=204,h="No Content"):c={message:m}}if(c&&this.isMaybeSingle&&(!((l=c==null?void 0:c.details)===null||l===void 0)&&l.includes("0 rows"))&&(c=null,d=200,h="OK"),c&&this.shouldThrowOnError)throw new LL.default(c)}return{error:c,data:u,count:f,status:d,statusText:h}});return this.shouldThrowOnError||(a=a.catch(i=>{var s,o,l;return{error:{message:`${(s=i==null?void 0:i.name)!==null&&s!==void 0?s:"FetchError"}: ${i==null?void 0:i.message}`,details:`${(o=i==null?void 0:i.stack)!==null&&o!==void 0?o:""}`,hint:"",code:`${(l=i==null?void 0:i.code)!==null&&l!==void 0?l:""}`},data:null,count:null,status:0,statusText:""}})),a.then(t,r)}returns(){return this}overrideTypes(){return this}};hm.default=FL;var OL=li&&li.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(fm,"__esModule",{value:!0});const IL=OL(hm);let DL=class extends IL.default{select(t){let r=!1;const n=(t??"*").split("").map(a=>/\s/.test(a)&&!r?"":(a==='"'&&(r=!r),a)).join("");return this.url.searchParams.set("select",n),this.headers.Prefer&&(this.headers.Prefer+=","),this.headers.Prefer+="return=representation",this}order(t,{ascending:r=!0,nullsFirst:n,foreignTable:a,referencedTable:i=a}={}){const s=i?`${i}.order`:"order",o=this.url.searchParams.get(s);return this.url.searchParams.set(s,`${o?`${o},`:""}${t}.${r?"asc":"desc"}${n===void 0?"":n?".nullsfirst":".nullslast"}`),this}limit(t,{foreignTable:r,referencedTable:n=r}={}){const a=typeof n>"u"?"limit":`${n}.limit`;return this.url.searchParams.set(a,`${t}`),this}range(t,r,{foreignTable:n,referencedTable:a=n}={}){const i=typeof a>"u"?"offset":`${a}.offset`,s=typeof a>"u"?"limit":`${a}.limit`;return this.url.searchParams.set(i,`${t}`),this.url.searchParams.set(s,`${r-t+1}`),this}abortSignal(t){return this.signal=t,this}single(){return this.headers.Accept="application/vnd.pgrst.object+json",this}maybeSingle(){return this.method==="GET"?this.headers.Accept="application/json":this.headers.Accept="application/vnd.pgrst.object+json",this.isMaybeSingle=!0,this}csv(){return this.headers.Accept="text/csv",this}geojson(){return this.headers.Accept="application/geo+json",this}explain({analyze:t=!1,verbose:r=!1,settings:n=!1,buffers:a=!1,wal:i=!1,format:s="text"}={}){var o;const l=[t?"analyze":null,r?"verbose":null,n?"settings":null,a?"buffers":null,i?"wal":null].filter(Boolean).join("|"),c=(o=this.headers.Accept)!==null&&o!==void 0?o:"application/json";return this.headers.Accept=`application/vnd.pgrst.plan+${s}; for="${c}"; options=${l};`,s==="json"?this:this}rollback(){var t;return((t=this.headers.Prefer)!==null&&t!==void 0?t:"").trim().length>0?this.headers.Prefer+=",tx=rollback":this.headers.Prefer="tx=rollback",this}returns(){return this}};fm.default=DL;var jL=li&&li.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(Nh,"__esModule",{value:!0});const RL=jL(fm);let ML=class extends RL.default{eq(t,r){return this.url.searchParams.append(t,`eq.${r}`),this}neq(t,r){return this.url.searchParams.append(t,`neq.${r}`),this}gt(t,r){return this.url.searchParams.append(t,`gt.${r}`),this}gte(t,r){return this.url.searchParams.append(t,`gte.${r}`),this}lt(t,r){return this.url.searchParams.append(t,`lt.${r}`),this}lte(t,r){return this.url.searchParams.append(t,`lte.${r}`),this}like(t,r){return this.url.searchParams.append(t,`like.${r}`),this}likeAllOf(t,r){return this.url.searchParams.append(t,`like(all).{${r.join(",")}}`),this}likeAnyOf(t,r){return this.url.searchParams.append(t,`like(any).{${r.join(",")}}`),this}ilike(t,r){return this.url.searchParams.append(t,`ilike.${r}`),this}ilikeAllOf(t,r){return this.url.searchParams.append(t,`ilike(all).{${r.join(",")}}`),this}ilikeAnyOf(t,r){return this.url.searchParams.append(t,`ilike(any).{${r.join(",")}}`),this}is(t,r){return this.url.searchParams.append(t,`is.${r}`),this}in(t,r){const n=Array.from(new Set(r)).map(a=>typeof a=="string"&&new RegExp("[,()]").test(a)?`"${a}"`:`${a}`).join(",");return this.url.searchParams.append(t,`in.(${n})`),this}contains(t,r){return typeof r=="string"?this.url.searchParams.append(t,`cs.${r}`):Array.isArray(r)?this.url.searchParams.append(t,`cs.{${r.join(",")}}`):this.url.searchParams.append(t,`cs.${JSON.stringify(r)}`),this}containedBy(t,r){return typeof r=="string"?this.url.searchParams.append(t,`cd.${r}`):Array.isArray(r)?this.url.searchParams.append(t,`cd.{${r.join(",")}}`):this.url.searchParams.append(t,`cd.${JSON.stringify(r)}`),this}rangeGt(t,r){return this.url.searchParams.append(t,`sr.${r}`),this}rangeGte(t,r){return this.url.searchParams.append(t,`nxl.${r}`),this}rangeLt(t,r){return this.url.searchParams.append(t,`sl.${r}`),this}rangeLte(t,r){return this.url.searchParams.append(t,`nxr.${r}`),this}rangeAdjacent(t,r){return this.url.searchParams.append(t,`adj.${r}`),this}overlaps(t,r){return typeof r=="string"?this.url.searchParams.append(t,`ov.${r}`):this.url.searchParams.append(t,`ov.{${r.join(",")}}`),this}textSearch(t,r,{config:n,type:a}={}){let i="";a==="plain"?i="pl":a==="phrase"?i="ph":a==="websearch"&&(i="w");const s=n===void 0?"":`(${n})`;return this.url.searchParams.append(t,`${i}fts${s}.${r}`),this}match(t){return Object.entries(t).forEach(([r,n])=>{this.url.searchParams.append(r,`eq.${n}`)}),this}not(t,r,n){return this.url.searchParams.append(t,`not.${r}.${n}`),this}or(t,{foreignTable:r,referencedTable:n=r}={}){const a=n?`${n}.or`:"or";return this.url.searchParams.append(a,`(${t})`),this}filter(t,r,n){return this.url.searchParams.append(t,`${r}.${n}`),this}};Nh.default=ML;var BL=li&&li.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(um,"__esModule",{value:!0});const q0=BL(Nh);let UL=class{constructor(t,{headers:r={},schema:n,fetch:a}){this.url=t,this.headers=r,this.schema=n,this.fetch=a}select(t,{head:r=!1,count:n}={}){const a=r?"HEAD":"GET";let i=!1;const s=(t??"*").split("").map(o=>/\s/.test(o)&&!i?"":(o==='"'&&(i=!i),o)).join("");return this.url.searchParams.set("select",s),n&&(this.headers.Prefer=`count=${n}`),new q0.default({method:a,url:this.url,headers:this.headers,schema:this.schema,fetch:this.fetch,allowEmpty:!1})}insert(t,{count:r,defaultToNull:n=!0}={}){const a="POST",i=[];if(this.headers.Prefer&&i.push(this.headers.Prefer),r&&i.push(`count=${r}`),n||i.push("missing=default"),this.headers.Prefer=i.join(","),Array.isArray(t)){const s=t.reduce((o,l)=>o.concat(Object.keys(l)),[]);if(s.length>0){const o=[...new Set(s)].map(l=>`"${l}"`);this.url.searchParams.set("columns",o.join(","))}}return new q0.default({method:a,url:this.url,headers:this.headers,schema:this.schema,body:t,fetch:this.fetch,allowEmpty:!1})}upsert(t,{onConflict:r,ignoreDuplicates:n=!1,count:a,defaultToNull:i=!0}={}){const s="POST",o=[`resolution=${n?"ignore":"merge"}-duplicates`];if(r!==void 0&&this.url.searchParams.set("on_conflict",r),this.headers.Prefer&&o.push(this.headers.Prefer),a&&o.push(`count=${a}`),i||o.push("missing=default"),this.headers.Prefer=o.join(","),Array.isArray(t)){const l=t.reduce((c,u)=>c.concat(Object.keys(u)),[]);if(l.length>0){const c=[...new Set(l)].map(u=>`"${u}"`);this.url.searchParams.set("columns",c.join(","))}}return new q0.default({method:s,url:this.url,headers:this.headers,schema:this.schema,body:t,fetch:this.fetch,allowEmpty:!1})}update(t,{count:r}={}){const n="PATCH",a=[];return this.headers.Prefer&&a.push(this.headers.Prefer),r&&a.push(`count=${r}`),this.headers.Prefer=a.join(","),new q0.default({method:n,url:this.url,headers:this.headers,schema:this.schema,body:t,fetch:this.fetch,allowEmpty:!1})}delete({count:t}={}){const r="DELETE",n=[];return t&&n.push(`count=${t}`),this.headers.Prefer&&n.unshift(this.headers.Prefer),this.headers.Prefer=n.join(","),new q0.default({method:r,url:this.url,headers:this.headers,schema:this.schema,fetch:this.fetch,allowEmpty:!1})}};um.default=UL;var pm={},mm={};Object.defineProperty(mm,"__esModule",{value:!0});mm.version=void 0;mm.version="0.0.0-automated";Object.defineProperty(pm,"__esModule",{value:!0});pm.DEFAULT_HEADERS=void 0;const $L=mm;pm.DEFAULT_HEADERS={"X-Client-Info":`postgrest-js/${$L.version}`};var Sk=li&&li.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(Iy,"__esModule",{value:!0});const VL=Sk(um),zL=Sk(Nh),HL=pm;let WL=class kk{constructor(t,{headers:r={},schema:n,fetch:a}={}){this.url=t,this.headers=Object.assign(Object.assign({},HL.DEFAULT_HEADERS),r),this.schemaName=n,this.fetch=a}from(t){const r=new URL(`${this.url}/${t}`);return new VL.default(r,{headers:Object.assign({},this.headers),schema:this.schemaName,fetch:this.fetch})}schema(t){return new kk(this.url,{headers:this.headers,schema:t,fetch:this.fetch})}rpc(t,r={},{head:n=!1,get:a=!1,count:i}={}){let s;const o=new URL(`${this.url}/rpc/${t}`);let l;n||a?(s=n?"HEAD":"GET",Object.entries(r).filter(([u,f])=>f!==void 0).map(([u,f])=>[u,Array.isArray(f)?`{${f.join(",")}}`:`${f}`]).forEach(([u,f])=>{o.searchParams.append(u,f)})):(s="POST",l=r);const c=Object.assign({},this.headers);return i&&(c.Prefer=`count=${i}`),new zL.default({method:s,url:o,headers:c,schema:this.schemaName,body:l,fetch:this.fetch,allowEmpty:!1})}};Iy.default=WL;var r0=li&&li.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(xa,"__esModule",{value:!0});xa.PostgrestError=xa.PostgrestBuilder=xa.PostgrestTransformBuilder=xa.PostgrestFilterBuilder=xa.PostgrestQueryBuilder=xa.PostgrestClient=void 0;const Ek=r0(Iy);xa.PostgrestClient=Ek.default;const Ak=r0(um);xa.PostgrestQueryBuilder=Ak.default;const Tk=r0(Nh);xa.PostgrestFilterBuilder=Tk.default;const Ck=r0(fm);xa.PostgrestTransformBuilder=Ck.default;const Nk=r0(hm);xa.PostgrestBuilder=Nk.default;const Pk=r0(dm);xa.PostgrestError=Pk.default;var qL=xa.default={PostgrestClient:Ek.default,PostgrestQueryBuilder:Ak.default,PostgrestFilterBuilder:Tk.default,PostgrestTransformBuilder:Ck.default,PostgrestBuilder:Nk.default,PostgrestError:Pk.default};const{PostgrestClient:GL,PostgrestQueryBuilder:OJ,PostgrestFilterBuilder:IJ,PostgrestTransformBuilder:DJ,PostgrestBuilder:jJ,PostgrestError:RJ}=qL;function KL(){if(typeof WebSocket<"u")return WebSocket;if(typeof global.WebSocket<"u")return global.WebSocket;if(typeof window.WebSocket<"u")return window.WebSocket;if(typeof self.WebSocket<"u")return self.WebSocket;throw new Error("`WebSocket` is not supported in this environment")}const XL=KL(),YL="2.11.15",JL=`realtime-js/${YL}`,QL="1.0.0",Lk=1e4,ZL=1e3;var yf;(function(e){e[e.connecting=0]="connecting",e[e.open=1]="open",e[e.closing=2]="closing",e[e.closed=3]="closed"})(yf||(yf={}));var jn;(function(e){e.closed="closed",e.errored="errored",e.joined="joined",e.joining="joining",e.leaving="leaving"})(jn||(jn={}));var Li;(function(e){e.close="phx_close",e.error="phx_error",e.join="phx_join",e.reply="phx_reply",e.leave="phx_leave",e.access_token="access_token"})(Li||(Li={}));var Rx;(function(e){e.websocket="websocket"})(Rx||(Rx={}));var Dl;(function(e){e.Connecting="connecting",e.Open="open",e.Closing="closing",e.Closed="closed"})(Dl||(Dl={}));class eF{constructor(){this.HEADER_LENGTH=1}decode(t,r){return t.constructor===ArrayBuffer?r(this._binaryDecode(t)):r(typeof t=="string"?JSON.parse(t):{})}_binaryDecode(t){const r=new DataView(t),n=new TextDecoder;return this._decodeBroadcast(t,r,n)}_decodeBroadcast(t,r,n){const a=r.getUint8(1),i=r.getUint8(2);let s=this.HEADER_LENGTH+2;const o=n.decode(t.slice(s,s+a));s=s+a;const l=n.decode(t.slice(s,s+i));s=s+i;const c=JSON.parse(n.decode(t.slice(s,t.byteLength)));return{ref:null,topic:o,event:l,payload:c}}}class Fk{constructor(t,r){this.callback=t,this.timerCalc=r,this.timer=void 0,this.tries=0,this.callback=t,this.timerCalc=r}reset(){this.tries=0,clearTimeout(this.timer)}scheduleTimeout(){clearTimeout(this.timer),this.timer=setTimeout(()=>{this.tries=this.tries+1,this.callback()},this.timerCalc(this.tries+1))}}var hr;(function(e){e.abstime="abstime",e.bool="bool",e.date="date",e.daterange="daterange",e.float4="float4",e.float8="float8",e.int2="int2",e.int4="int4",e.int4range="int4range",e.int8="int8",e.int8range="int8range",e.json="json",e.jsonb="jsonb",e.money="money",e.numeric="numeric",e.oid="oid",e.reltime="reltime",e.text="text",e.time="time",e.timestamp="timestamp",e.timestamptz="timestamptz",e.timetz="timetz",e.tsrange="tsrange",e.tstzrange="tstzrange"})(hr||(hr={}));const jb=(e,t,r={})=>{var n;const a=(n=r.skipTypes)!==null&&n!==void 0?n:[];return Object.keys(t).reduce((i,s)=>(i[s]=tF(s,e,t,a),i),{})},tF=(e,t,r,n)=>{const a=t.find(o=>o.name===e),i=a==null?void 0:a.type,s=r[e];return i&&!n.includes(i)?Ok(i,s):Mx(s)},Ok=(e,t)=>{if(e.charAt(0)==="_"){const r=e.slice(1,e.length);return iF(t,r)}switch(e){case hr.bool:return rF(t);case hr.float4:case hr.float8:case hr.int2:case hr.int4:case hr.int8:case hr.numeric:case hr.oid:return nF(t);case hr.json:case hr.jsonb:return aF(t);case hr.timestamp:return sF(t);case hr.abstime:case hr.date:case hr.daterange:case hr.int4range:case hr.int8range:case hr.money:case hr.reltime:case hr.text:case hr.time:case hr.timestamptz:case hr.timetz:case hr.tsrange:case hr.tstzrange:return Mx(t);default:return Mx(t)}},Mx=e=>e,rF=e=>{switch(e){case"t":return!0;case"f":return!1;default:return e}},nF=e=>{if(typeof e=="string"){const t=parseFloat(e);if(!Number.isNaN(t))return t}return e},aF=e=>{if(typeof e=="string")try{return JSON.parse(e)}catch(t){return console.log(`JSON parse error: ${t}`),e}return e},iF=(e,t)=>{if(typeof e!="string")return e;const r=e.length-1,n=e[r];if(e[0]==="{"&&n==="}"){let i;const s=e.slice(1,r);try{i=JSON.parse("["+s+"]")}catch{i=s?s.split(","):[]}return i.map(o=>Ok(t,o))}return e},sF=e=>typeof e=="string"?e.replace(" ","T"):e,Ik=e=>{let t=e;return t=t.replace(/^ws/i,"http"),t=t.replace(/(\/socket\/websocket|\/socket|\/websocket)\/?$/i,""),t.replace(/\/+$/,"")};class Yg{constructor(t,r,n={},a=Lk){this.channel=t,this.event=r,this.payload=n,this.timeout=a,this.sent=!1,this.timeoutTimer=void 0,this.ref="",this.receivedResp=null,this.recHooks=[],this.refEvent=null}resend(t){this.timeout=t,this._cancelRefEvent(),this.ref="",this.refEvent=null,this.receivedResp=null,this.sent=!1,this.send()}send(){this._hasReceived("timeout")||(this.startTimeout(),this.sent=!0,this.channel.socket.push({topic:this.channel.topic,event:this.event,payload:this.payload,ref:this.ref,join_ref:this.channel._joinRef()}))}updatePayload(t){this.payload=Object.assign(Object.assign({},this.payload),t)}receive(t,r){var n;return this._hasReceived(t)&&r((n=this.receivedResp)===null||n===void 0?void 0:n.response),this.recHooks.push({status:t,callback:r}),this}startTimeout(){if(this.timeoutTimer)return;this.ref=this.channel.socket._makeRef(),this.refEvent=this.channel._replyEventName(this.ref);const t=r=>{this._cancelRefEvent(),this._cancelTimeout(),this.receivedResp=r,this._matchReceive(r)};this.channel._on(this.refEvent,{},t),this.timeoutTimer=setTimeout(()=>{this.trigger("timeout",{})},this.timeout)}trigger(t,r){this.refEvent&&this.channel._trigger(this.refEvent,{status:t,response:r})}destroy(){this._cancelRefEvent(),this._cancelTimeout()}_cancelRefEvent(){this.refEvent&&this.channel._off(this.refEvent,{})}_cancelTimeout(){clearTimeout(this.timeoutTimer),this.timeoutTimer=void 0}_matchReceive({status:t,response:r}){this.recHooks.filter(n=>n.status===t).forEach(n=>n.callback(r))}_hasReceived(t){return this.receivedResp&&this.receivedResp.status===t}}var Rb;(function(e){e.SYNC="sync",e.JOIN="join",e.LEAVE="leave"})(Rb||(Rb={}));class wf{constructor(t,r){this.channel=t,this.state={},this.pendingDiffs=[],this.joinRef=null,this.caller={onJoin:()=>{},onLeave:()=>{},onSync:()=>{}};const n=(r==null?void 0:r.events)||{state:"presence_state",diff:"presence_diff"};this.channel._on(n.state,{},a=>{const{onJoin:i,onLeave:s,onSync:o}=this.caller;this.joinRef=this.channel._joinRef(),this.state=wf.syncState(this.state,a,i,s),this.pendingDiffs.forEach(l=>{this.state=wf.syncDiff(this.state,l,i,s)}),this.pendingDiffs=[],o()}),this.channel._on(n.diff,{},a=>{const{onJoin:i,onLeave:s,onSync:o}=this.caller;this.inPendingSyncState()?this.pendingDiffs.push(a):(this.state=wf.syncDiff(this.state,a,i,s),o())}),this.onJoin((a,i,s)=>{this.channel._trigger("presence",{event:"join",key:a,currentPresences:i,newPresences:s})}),this.onLeave((a,i,s)=>{this.channel._trigger("presence",{event:"leave",key:a,currentPresences:i,leftPresences:s})}),this.onSync(()=>{this.channel._trigger("presence",{event:"sync"})})}static syncState(t,r,n,a){const i=this.cloneDeep(t),s=this.transformState(r),o={},l={};return this.map(i,(c,u)=>{s[c]||(l[c]=u)}),this.map(s,(c,u)=>{const f=i[c];if(f){const d=u.map(_=>_.presence_ref),h=f.map(_=>_.presence_ref),g=u.filter(_=>h.indexOf(_.presence_ref)<0),m=f.filter(_=>d.indexOf(_.presence_ref)<0);g.length>0&&(o[c]=g),m.length>0&&(l[c]=m)}else o[c]=u}),this.syncDiff(i,{joins:o,leaves:l},n,a)}static syncDiff(t,r,n,a){const{joins:i,leaves:s}={joins:this.transformState(r.joins),leaves:this.transformState(r.leaves)};return n||(n=()=>{}),a||(a=()=>{}),this.map(i,(o,l)=>{var c;const u=(c=t[o])!==null&&c!==void 0?c:[];if(t[o]=this.cloneDeep(l),u.length>0){const f=t[o].map(h=>h.presence_ref),d=u.filter(h=>f.indexOf(h.presence_ref)<0);t[o].unshift(...d)}n(o,u,l)}),this.map(s,(o,l)=>{let c=t[o];if(!c)return;const u=l.map(f=>f.presence_ref);c=c.filter(f=>u.indexOf(f.presence_ref)<0),t[o]=c,a(o,c,l),c.length===0&&delete t[o]}),t}static map(t,r){return Object.getOwnPropertyNames(t).map(n=>r(n,t[n]))}static transformState(t){return t=this.cloneDeep(t),Object.getOwnPropertyNames(t).reduce((r,n)=>{const a=t[n];return"metas"in a?r[n]=a.metas.map(i=>(i.presence_ref=i.phx_ref,delete i.phx_ref,delete i.phx_ref_prev,i)):r[n]=a,r},{})}static cloneDeep(t){return JSON.parse(JSON.stringify(t))}onJoin(t){this.caller.onJoin=t}onLeave(t){this.caller.onLeave=t}onSync(t){this.caller.onSync=t}inPendingSyncState(){return!this.joinRef||this.joinRef!==this.channel._joinRef()}}var Mb;(function(e){e.ALL="*",e.INSERT="INSERT",e.UPDATE="UPDATE",e.DELETE="DELETE"})(Mb||(Mb={}));var Bb;(function(e){e.BROADCAST="broadcast",e.PRESENCE="presence",e.POSTGRES_CHANGES="postgres_changes",e.SYSTEM="system"})(Bb||(Bb={}));var Is;(function(e){e.SUBSCRIBED="SUBSCRIBED",e.TIMED_OUT="TIMED_OUT",e.CLOSED="CLOSED",e.CHANNEL_ERROR="CHANNEL_ERROR"})(Is||(Is={}));class Dy{constructor(t,r={config:{}},n){this.topic=t,this.params=r,this.socket=n,this.bindings={},this.state=jn.closed,this.joinedOnce=!1,this.pushBuffer=[],this.subTopic=t.replace(/^realtime:/i,""),this.params.config=Object.assign({broadcast:{ack:!1,self:!1},presence:{key:""},private:!1},r.config),this.timeout=this.socket.timeout,this.joinPush=new Yg(this,Li.join,this.params,this.timeout),this.rejoinTimer=new Fk(()=>this._rejoinUntilConnected(),this.socket.reconnectAfterMs),this.joinPush.receive("ok",()=>{this.state=jn.joined,this.rejoinTimer.reset(),this.pushBuffer.forEach(a=>a.send()),this.pushBuffer=[]}),this._onClose(()=>{this.rejoinTimer.reset(),this.socket.log("channel",`close ${this.topic} ${this._joinRef()}`),this.state=jn.closed,this.socket._remove(this)}),this._onError(a=>{this._isLeaving()||this._isClosed()||(this.socket.log("channel",`error ${this.topic}`,a),this.state=jn.errored,this.rejoinTimer.scheduleTimeout())}),this.joinPush.receive("timeout",()=>{this._isJoining()&&(this.socket.log("channel",`timeout ${this.topic}`,this.joinPush.timeout),this.state=jn.errored,this.rejoinTimer.scheduleTimeout())}),this._on(Li.reply,{},(a,i)=>{this._trigger(this._replyEventName(i),a)}),this.presence=new wf(this),this.broadcastEndpointURL=Ik(this.socket.endPoint)+"/api/broadcast",this.private=this.params.config.private||!1}subscribe(t,r=this.timeout){var n,a;if(this.socket.isConnected()||this.socket.connect(),this.state==jn.closed){const{config:{broadcast:i,presence:s,private:o}}=this.params;this._onError(u=>t==null?void 0:t(Is.CHANNEL_ERROR,u)),this._onClose(()=>t==null?void 0:t(Is.CLOSED));const l={},c={broadcast:i,presence:s,postgres_changes:(a=(n=this.bindings.postgres_changes)===null||n===void 0?void 0:n.map(u=>u.filter))!==null&&a!==void 0?a:[],private:o};this.socket.accessTokenValue&&(l.access_token=this.socket.accessTokenValue),this.updateJoinPayload(Object.assign({config:c},l)),this.joinedOnce=!0,this._rejoin(r),this.joinPush.receive("ok",async({postgres_changes:u})=>{var f;if(this.socket.setAuth(),u===void 0){t==null||t(Is.SUBSCRIBED);return}else{const d=this.bindings.postgres_changes,h=(f=d==null?void 0:d.length)!==null&&f!==void 0?f:0,g=[];for(let m=0;m<h;m++){const _=d[m],{filter:{event:y,schema:b,table:w,filter:T}}=_,F=u&&u[m];if(F&&F.event===y&&F.schema===b&&F.table===w&&F.filter===T)g.push(Object.assign(Object.assign({},_),{id:F.id}));else{this.unsubscribe(),this.state=jn.errored,t==null||t(Is.CHANNEL_ERROR,new Error("mismatch between server and client bindings for postgres changes"));return}}this.bindings.postgres_changes=g,t&&t(Is.SUBSCRIBED);return}}).receive("error",u=>{this.state=jn.errored,t==null||t(Is.CHANNEL_ERROR,new Error(JSON.stringify(Object.values(u).join(", ")||"error")))}).receive("timeout",()=>{t==null||t(Is.TIMED_OUT)})}return this}presenceState(){return this.presence.state}async track(t,r={}){return await this.send({type:"presence",event:"track",payload:t},r.timeout||this.timeout)}async untrack(t={}){return await this.send({type:"presence",event:"untrack"},t)}on(t,r,n){return this._on(t,r,n)}async send(t,r={}){var n,a;if(!this._canPush()&&t.type==="broadcast"){const{event:i,payload:s}=t,l={method:"POST",headers:{Authorization:this.socket.accessTokenValue?`Bearer ${this.socket.accessTokenValue}`:"",apikey:this.socket.apiKey?this.socket.apiKey:"","Content-Type":"application/json"},body:JSON.stringify({messages:[{topic:this.subTopic,event:i,payload:s,private:this.private}]})};try{const c=await this._fetchWithTimeout(this.broadcastEndpointURL,l,(n=r.timeout)!==null&&n!==void 0?n:this.timeout);return await((a=c.body)===null||a===void 0?void 0:a.cancel()),c.ok?"ok":"error"}catch(c){return c.name==="AbortError"?"timed out":"error"}}else return new Promise(i=>{var s,o,l;const c=this._push(t.type,t,r.timeout||this.timeout);t.type==="broadcast"&&!(!((l=(o=(s=this.params)===null||s===void 0?void 0:s.config)===null||o===void 0?void 0:o.broadcast)===null||l===void 0)&&l.ack)&&i("ok"),c.receive("ok",()=>i("ok")),c.receive("error",()=>i("error")),c.receive("timeout",()=>i("timed out"))})}updateJoinPayload(t){this.joinPush.updatePayload(t)}unsubscribe(t=this.timeout){this.state=jn.leaving;const r=()=>{this.socket.log("channel",`leave ${this.topic}`),this._trigger(Li.close,"leave",this._joinRef())};this.joinPush.destroy();let n=null;return new Promise(a=>{n=new Yg(this,Li.leave,{},t),n.receive("ok",()=>{r(),a("ok")}).receive("timeout",()=>{r(),a("timed out")}).receive("error",()=>{a("error")}),n.send(),this._canPush()||n.trigger("ok",{})}).finally(()=>{n==null||n.destroy()})}teardown(){this.pushBuffer.forEach(t=>t.destroy()),this.rejoinTimer&&clearTimeout(this.rejoinTimer.timer),this.joinPush.destroy()}async _fetchWithTimeout(t,r,n){const a=new AbortController,i=setTimeout(()=>a.abort(),n),s=await this.socket.fetch(t,Object.assign(Object.assign({},r),{signal:a.signal}));return clearTimeout(i),s}_push(t,r,n=this.timeout){if(!this.joinedOnce)throw`tried to push '${t}' to '${this.topic}' before joining. Use channel.subscribe() before pushing events`;let a=new Yg(this,t,r,n);return this._canPush()?a.send():(a.startTimeout(),this.pushBuffer.push(a)),a}_onMessage(t,r,n){return r}_isMember(t){return this.topic===t}_joinRef(){return this.joinPush.ref}_trigger(t,r,n){var a,i;const s=t.toLocaleLowerCase(),{close:o,error:l,leave:c,join:u}=Li;if(n&&[o,l,c,u].indexOf(s)>=0&&n!==this._joinRef())return;let d=this._onMessage(s,r,n);if(r&&!d)throw"channel onMessage callbacks must return the payload, modified or unmodified";["insert","update","delete"].includes(s)?(a=this.bindings.postgres_changes)===null||a===void 0||a.filter(h=>{var g,m,_;return((g=h.filter)===null||g===void 0?void 0:g.event)==="*"||((_=(m=h.filter)===null||m===void 0?void 0:m.event)===null||_===void 0?void 0:_.toLocaleLowerCase())===s}).map(h=>h.callback(d,n)):(i=this.bindings[s])===null||i===void 0||i.filter(h=>{var g,m,_,y,b,w;if(["broadcast","presence","postgres_changes"].includes(s))if("id"in h){const T=h.id,F=(g=h.filter)===null||g===void 0?void 0:g.event;return T&&((m=r.ids)===null||m===void 0?void 0:m.includes(T))&&(F==="*"||(F==null?void 0:F.toLocaleLowerCase())===((_=r.data)===null||_===void 0?void 0:_.type.toLocaleLowerCase()))}else{const T=(b=(y=h==null?void 0:h.filter)===null||y===void 0?void 0:y.event)===null||b===void 0?void 0:b.toLocaleLowerCase();return T==="*"||T===((w=r==null?void 0:r.event)===null||w===void 0?void 0:w.toLocaleLowerCase())}else return h.type.toLocaleLowerCase()===s}).map(h=>{if(typeof d=="object"&&"ids"in d){const g=d.data,{schema:m,table:_,commit_timestamp:y,type:b,errors:w}=g;d=Object.assign(Object.assign({},{schema:m,table:_,commit_timestamp:y,eventType:b,new:{},old:{},errors:w}),this._getPayloadRecords(g))}h.callback(d,n)})}_isClosed(){return this.state===jn.closed}_isJoined(){return this.state===jn.joined}_isJoining(){return this.state===jn.joining}_isLeaving(){return this.state===jn.leaving}_replyEventName(t){return`chan_reply_${t}`}_on(t,r,n){const a=t.toLocaleLowerCase(),i={type:a,filter:r,callback:n};return this.bindings[a]?this.bindings[a].push(i):this.bindings[a]=[i],this}_off(t,r){const n=t.toLocaleLowerCase();return this.bindings[n]=this.bindings[n].filter(a=>{var i;return!(((i=a.type)===null||i===void 0?void 0:i.toLocaleLowerCase())===n&&Dy.isEqual(a.filter,r))}),this}static isEqual(t,r){if(Object.keys(t).length!==Object.keys(r).length)return!1;for(const n in t)if(t[n]!==r[n])return!1;return!0}_rejoinUntilConnected(){this.rejoinTimer.scheduleTimeout(),this.socket.isConnected()&&this._rejoin()}_onClose(t){this._on(Li.close,{},t)}_onError(t){this._on(Li.error,{},r=>t(r))}_canPush(){return this.socket.isConnected()&&this._isJoined()}_rejoin(t=this.timeout){this._isLeaving()||(this.socket._leaveOpenTopic(this.topic),this.state=jn.joining,this.joinPush.resend(t))}_getPayloadRecords(t){const r={new:{},old:{}};return(t.type==="INSERT"||t.type==="UPDATE")&&(r.new=jb(t.columns,t.record)),(t.type==="UPDATE"||t.type==="DELETE")&&(r.old=jb(t.columns,t.old_record)),r}}const Ub=()=>{},oF=`
  addEventListener("message", (e) => {
    if (e.data.event === "start") {
      setInterval(() => postMessage({ event: "keepAlive" }), e.data.interval);
    }
  });`;class lF{constructor(t,r){var n;this.accessTokenValue=null,this.apiKey=null,this.channels=new Array,this.endPoint="",this.httpEndpoint="",this.headers={},this.params={},this.timeout=Lk,this.heartbeatIntervalMs=25e3,this.heartbeatTimer=void 0,this.pendingHeartbeatRef=null,this.heartbeatCallback=Ub,this.ref=0,this.logger=Ub,this.conn=null,this.sendBuffer=[],this.serializer=new eF,this.stateChangeCallbacks={open:[],close:[],error:[],message:[]},this.accessToken=null,this._resolveFetch=i=>{let s;return i?s=i:typeof fetch>"u"?s=(...o)=>tl(async()=>{const{default:l}=await Promise.resolve().then(()=>t0);return{default:l}},void 0).then(({default:l})=>l(...o)):s=fetch,(...o)=>s(...o)},this.endPoint=`${t}/${Rx.websocket}`,this.httpEndpoint=Ik(t),r!=null&&r.transport?this.transport=r.transport:this.transport=null,r!=null&&r.params&&(this.params=r.params),r!=null&&r.timeout&&(this.timeout=r.timeout),r!=null&&r.logger&&(this.logger=r.logger),(r!=null&&r.logLevel||r!=null&&r.log_level)&&(this.logLevel=r.logLevel||r.log_level,this.params=Object.assign(Object.assign({},this.params),{log_level:this.logLevel})),r!=null&&r.heartbeatIntervalMs&&(this.heartbeatIntervalMs=r.heartbeatIntervalMs);const a=(n=r==null?void 0:r.params)===null||n===void 0?void 0:n.apikey;if(a&&(this.accessTokenValue=a,this.apiKey=a),this.reconnectAfterMs=r!=null&&r.reconnectAfterMs?r.reconnectAfterMs:i=>[1e3,2e3,5e3,1e4][i-1]||1e4,this.encode=r!=null&&r.encode?r.encode:(i,s)=>s(JSON.stringify(i)),this.decode=r!=null&&r.decode?r.decode:this.serializer.decode.bind(this.serializer),this.reconnectTimer=new Fk(async()=>{this.disconnect(),this.connect()},this.reconnectAfterMs),this.fetch=this._resolveFetch(r==null?void 0:r.fetch),r!=null&&r.worker){if(typeof window<"u"&&!window.Worker)throw new Error("Web Worker is not supported");this.worker=(r==null?void 0:r.worker)||!1,this.workerUrl=r==null?void 0:r.workerUrl}this.accessToken=(r==null?void 0:r.accessToken)||null}connect(){if(!this.conn){if(this.transport||(this.transport=XL),!this.transport)throw new Error("No transport provided");this.conn=new this.transport(this.endpointURL()),this.setupConnection()}}endpointURL(){return this._appendParams(this.endPoint,Object.assign({},this.params,{vsn:QL}))}disconnect(t,r){this.conn&&(this.conn.onclose=function(){},t?this.conn.close(t,r??""):this.conn.close(),this.conn=null,this.heartbeatTimer&&clearInterval(this.heartbeatTimer),this.reconnectTimer.reset(),this.channels.forEach(n=>n.teardown()))}getChannels(){return this.channels}async removeChannel(t){const r=await t.unsubscribe();return this.channels.length===0&&this.disconnect(),r}async removeAllChannels(){const t=await Promise.all(this.channels.map(r=>r.unsubscribe()));return this.channels=[],this.disconnect(),t}log(t,r,n){this.logger(t,r,n)}connectionState(){switch(this.conn&&this.conn.readyState){case yf.connecting:return Dl.Connecting;case yf.open:return Dl.Open;case yf.closing:return Dl.Closing;default:return Dl.Closed}}isConnected(){return this.connectionState()===Dl.Open}channel(t,r={config:{}}){const n=`realtime:${t}`,a=this.getChannels().find(i=>i.topic===n);if(a)return a;{const i=new Dy(`realtime:${t}`,r,this);return this.channels.push(i),i}}push(t){const{topic:r,event:n,payload:a,ref:i}=t,s=()=>{this.encode(t,o=>{var l;(l=this.conn)===null||l===void 0||l.send(o)})};this.log("push",`${r} ${n} (${i})`,a),this.isConnected()?s():this.sendBuffer.push(s)}async setAuth(t=null){let r=t||this.accessToken&&await this.accessToken()||this.accessTokenValue;this.accessTokenValue!=r&&(this.accessTokenValue=r,this.channels.forEach(n=>{const a={access_token:r,version:JL};r&&n.updateJoinPayload(a),n.joinedOnce&&n._isJoined()&&n._push(Li.access_token,{access_token:r})}))}async sendHeartbeat(){var t;if(!this.isConnected()){this.heartbeatCallback("disconnected");return}if(this.pendingHeartbeatRef){this.pendingHeartbeatRef=null,this.log("transport","heartbeat timeout. Attempting to re-establish connection"),this.heartbeatCallback("timeout"),(t=this.conn)===null||t===void 0||t.close(ZL,"hearbeat timeout");return}this.pendingHeartbeatRef=this._makeRef(),this.push({topic:"phoenix",event:"heartbeat",payload:{},ref:this.pendingHeartbeatRef}),this.heartbeatCallback("sent"),await this.setAuth()}onHeartbeat(t){this.heartbeatCallback=t}flushSendBuffer(){this.isConnected()&&this.sendBuffer.length>0&&(this.sendBuffer.forEach(t=>t()),this.sendBuffer=[])}_makeRef(){let t=this.ref+1;return t===this.ref?this.ref=0:this.ref=t,this.ref.toString()}_leaveOpenTopic(t){let r=this.channels.find(n=>n.topic===t&&(n._isJoined()||n._isJoining()));r&&(this.log("transport",`leaving duplicate topic "${t}"`),r.unsubscribe())}_remove(t){this.channels=this.channels.filter(r=>r.topic!==t.topic)}setupConnection(){this.conn&&(this.conn.binaryType="arraybuffer",this.conn.onopen=()=>this._onConnOpen(),this.conn.onerror=t=>this._onConnError(t),this.conn.onmessage=t=>this._onConnMessage(t),this.conn.onclose=t=>this._onConnClose(t))}_onConnMessage(t){this.decode(t.data,r=>{let{topic:n,event:a,payload:i,ref:s}=r;n==="phoenix"&&a==="phx_reply"&&this.heartbeatCallback(r.payload.status=="ok"?"ok":"error"),s&&s===this.pendingHeartbeatRef&&(this.pendingHeartbeatRef=null),this.log("receive",`${i.status||""} ${n} ${a} ${s&&"("+s+")"||""}`,i),Array.from(this.channels).filter(o=>o._isMember(n)).forEach(o=>o._trigger(a,i,s)),this.stateChangeCallbacks.message.forEach(o=>o(r))})}_onConnOpen(){this.log("transport",`connected to ${this.endpointURL()}`),this.flushSendBuffer(),this.reconnectTimer.reset(),this.worker?this.workerRef||this._startWorkerHeartbeat():this._startHeartbeat(),this.stateChangeCallbacks.open.forEach(t=>t())}_startHeartbeat(){this.heartbeatTimer&&clearInterval(this.heartbeatTimer),this.heartbeatTimer=setInterval(()=>this.sendHeartbeat(),this.heartbeatIntervalMs)}_startWorkerHeartbeat(){this.workerUrl?this.log("worker",`starting worker for from ${this.workerUrl}`):this.log("worker","starting default worker");const t=this._workerObjectUrl(this.workerUrl);this.workerRef=new Worker(t),this.workerRef.onerror=r=>{this.log("worker","worker error",r.message),this.workerRef.terminate()},this.workerRef.onmessage=r=>{r.data.event==="keepAlive"&&this.sendHeartbeat()},this.workerRef.postMessage({event:"start",interval:this.heartbeatIntervalMs})}_onConnClose(t){this.log("transport","close",t),this._triggerChanError(),this.heartbeatTimer&&clearInterval(this.heartbeatTimer),this.reconnectTimer.scheduleTimeout(),this.stateChangeCallbacks.close.forEach(r=>r(t))}_onConnError(t){this.log("transport",`${t}`),this._triggerChanError(),this.stateChangeCallbacks.error.forEach(r=>r(t))}_triggerChanError(){this.channels.forEach(t=>t._trigger(Li.error))}_appendParams(t,r){if(Object.keys(r).length===0)return t;const n=t.match(/\?/)?"&":"?",a=new URLSearchParams(r);return`${t}${n}${a}`}_workerObjectUrl(t){let r;if(t)r=t;else{const n=new Blob([oF],{type:"application/javascript"});r=URL.createObjectURL(n)}return r}}class jy extends Error{constructor(t){super(t),this.__isStorageError=!0,this.name="StorageError"}}function hn(e){return typeof e=="object"&&e!==null&&"__isStorageError"in e}class cF extends jy{constructor(t,r){super(t),this.name="StorageApiError",this.status=r}toJSON(){return{name:this.name,message:this.message,status:this.status}}}class Bx extends jy{constructor(t,r){super(t),this.name="StorageUnknownError",this.originalError=r}}var uF=function(e,t,r,n){function a(i){return i instanceof r?i:new r(function(s){s(i)})}return new(r||(r=Promise))(function(i,s){function o(u){try{c(n.next(u))}catch(f){s(f)}}function l(u){try{c(n.throw(u))}catch(f){s(f)}}function c(u){u.done?i(u.value):a(u.value).then(o,l)}c((n=n.apply(e,t||[])).next())})};const Dk=e=>{let t;return e?t=e:typeof fetch>"u"?t=(...r)=>tl(async()=>{const{default:n}=await Promise.resolve().then(()=>t0);return{default:n}},void 0).then(({default:n})=>n(...r)):t=fetch,(...r)=>t(...r)},fF=()=>uF(void 0,void 0,void 0,function*(){return typeof Response>"u"?(yield tl(()=>Promise.resolve().then(()=>t0),void 0)).Response:Response}),Ux=e=>{if(Array.isArray(e))return e.map(r=>Ux(r));if(typeof e=="function"||e!==Object(e))return e;const t={};return Object.entries(e).forEach(([r,n])=>{const a=r.replace(/([-_][a-z])/gi,i=>i.toUpperCase().replace(/[-_]/g,""));t[a]=Ux(n)}),t};var uc=function(e,t,r,n){function a(i){return i instanceof r?i:new r(function(s){s(i)})}return new(r||(r=Promise))(function(i,s){function o(u){try{c(n.next(u))}catch(f){s(f)}}function l(u){try{c(n.throw(u))}catch(f){s(f)}}function c(u){u.done?i(u.value):a(u.value).then(o,l)}c((n=n.apply(e,t||[])).next())})};const Jg=e=>e.msg||e.message||e.error_description||e.error||JSON.stringify(e),hF=(e,t,r)=>uc(void 0,void 0,void 0,function*(){const n=yield fF();e instanceof n&&!(r!=null&&r.noResolveJson)?e.json().then(a=>{t(new cF(Jg(a),e.status||500))}).catch(a=>{t(new Bx(Jg(a),a))}):t(new Bx(Jg(e),e))}),dF=(e,t,r,n)=>{const a={method:e,headers:(t==null?void 0:t.headers)||{}};return e==="GET"?a:(a.headers=Object.assign({"Content-Type":"application/json"},t==null?void 0:t.headers),n&&(a.body=JSON.stringify(n)),Object.assign(Object.assign({},a),r))};function Ph(e,t,r,n,a,i){return uc(this,void 0,void 0,function*(){return new Promise((s,o)=>{e(r,dF(t,n,a,i)).then(l=>{if(!l.ok)throw l;return n!=null&&n.noResolveJson?l:l.json()}).then(l=>s(l)).catch(l=>hF(l,o,n))})})}function g1(e,t,r,n){return uc(this,void 0,void 0,function*(){return Ph(e,"GET",t,r,n)})}function No(e,t,r,n,a){return uc(this,void 0,void 0,function*(){return Ph(e,"POST",t,n,a,r)})}function pF(e,t,r,n,a){return uc(this,void 0,void 0,function*(){return Ph(e,"PUT",t,n,a,r)})}function mF(e,t,r,n){return uc(this,void 0,void 0,function*(){return Ph(e,"HEAD",t,Object.assign(Object.assign({},r),{noResolveJson:!0}),n)})}function jk(e,t,r,n,a){return uc(this,void 0,void 0,function*(){return Ph(e,"DELETE",t,n,a,r)})}var pa=function(e,t,r,n){function a(i){return i instanceof r?i:new r(function(s){s(i)})}return new(r||(r=Promise))(function(i,s){function o(u){try{c(n.next(u))}catch(f){s(f)}}function l(u){try{c(n.throw(u))}catch(f){s(f)}}function c(u){u.done?i(u.value):a(u.value).then(o,l)}c((n=n.apply(e,t||[])).next())})};const gF={limit:100,offset:0,sortBy:{column:"name",order:"asc"}},$b={cacheControl:"3600",contentType:"text/plain;charset=UTF-8",upsert:!1};class xF{constructor(t,r={},n,a){this.url=t,this.headers=r,this.bucketId=n,this.fetch=Dk(a)}uploadOrUpdate(t,r,n,a){return pa(this,void 0,void 0,function*(){try{let i;const s=Object.assign(Object.assign({},$b),a);let o=Object.assign(Object.assign({},this.headers),t==="POST"&&{"x-upsert":String(s.upsert)});const l=s.metadata;typeof Blob<"u"&&n instanceof Blob?(i=new FormData,i.append("cacheControl",s.cacheControl),l&&i.append("metadata",this.encodeMetadata(l)),i.append("",n)):typeof FormData<"u"&&n instanceof FormData?(i=n,i.append("cacheControl",s.cacheControl),l&&i.append("metadata",this.encodeMetadata(l))):(i=n,o["cache-control"]=`max-age=${s.cacheControl}`,o["content-type"]=s.contentType,l&&(o["x-metadata"]=this.toBase64(this.encodeMetadata(l)))),a!=null&&a.headers&&(o=Object.assign(Object.assign({},o),a.headers));const c=this._removeEmptyFolders(r),u=this._getFinalPath(c),f=yield this.fetch(`${this.url}/object/${u}`,Object.assign({method:t,body:i,headers:o},s!=null&&s.duplex?{duplex:s.duplex}:{})),d=yield f.json();return f.ok?{data:{path:c,id:d.Id,fullPath:d.Key},error:null}:{data:null,error:d}}catch(i){if(hn(i))return{data:null,error:i};throw i}})}upload(t,r,n){return pa(this,void 0,void 0,function*(){return this.uploadOrUpdate("POST",t,r,n)})}uploadToSignedUrl(t,r,n,a){return pa(this,void 0,void 0,function*(){const i=this._removeEmptyFolders(t),s=this._getFinalPath(i),o=new URL(this.url+`/object/upload/sign/${s}`);o.searchParams.set("token",r);try{let l;const c=Object.assign({upsert:$b.upsert},a),u=Object.assign(Object.assign({},this.headers),{"x-upsert":String(c.upsert)});typeof Blob<"u"&&n instanceof Blob?(l=new FormData,l.append("cacheControl",c.cacheControl),l.append("",n)):typeof FormData<"u"&&n instanceof FormData?(l=n,l.append("cacheControl",c.cacheControl)):(l=n,u["cache-control"]=`max-age=${c.cacheControl}`,u["content-type"]=c.contentType);const f=yield this.fetch(o.toString(),{method:"PUT",body:l,headers:u}),d=yield f.json();return f.ok?{data:{path:i,fullPath:d.Key},error:null}:{data:null,error:d}}catch(l){if(hn(l))return{data:null,error:l};throw l}})}createSignedUploadUrl(t,r){return pa(this,void 0,void 0,function*(){try{let n=this._getFinalPath(t);const a=Object.assign({},this.headers);r!=null&&r.upsert&&(a["x-upsert"]="true");const i=yield No(this.fetch,`${this.url}/object/upload/sign/${n}`,{},{headers:a}),s=new URL(this.url+i.url),o=s.searchParams.get("token");if(!o)throw new jy("No token returned by API");return{data:{signedUrl:s.toString(),path:t,token:o},error:null}}catch(n){if(hn(n))return{data:null,error:n};throw n}})}update(t,r,n){return pa(this,void 0,void 0,function*(){return this.uploadOrUpdate("PUT",t,r,n)})}move(t,r,n){return pa(this,void 0,void 0,function*(){try{return{data:yield No(this.fetch,`${this.url}/object/move`,{bucketId:this.bucketId,sourceKey:t,destinationKey:r,destinationBucket:n==null?void 0:n.destinationBucket},{headers:this.headers}),error:null}}catch(a){if(hn(a))return{data:null,error:a};throw a}})}copy(t,r,n){return pa(this,void 0,void 0,function*(){try{return{data:{path:(yield No(this.fetch,`${this.url}/object/copy`,{bucketId:this.bucketId,sourceKey:t,destinationKey:r,destinationBucket:n==null?void 0:n.destinationBucket},{headers:this.headers})).Key},error:null}}catch(a){if(hn(a))return{data:null,error:a};throw a}})}createSignedUrl(t,r,n){return pa(this,void 0,void 0,function*(){try{let a=this._getFinalPath(t),i=yield No(this.fetch,`${this.url}/object/sign/${a}`,Object.assign({expiresIn:r},n!=null&&n.transform?{transform:n.transform}:{}),{headers:this.headers});const s=n!=null&&n.download?`&download=${n.download===!0?"":n.download}`:"";return i={signedUrl:encodeURI(`${this.url}${i.signedURL}${s}`)},{data:i,error:null}}catch(a){if(hn(a))return{data:null,error:a};throw a}})}createSignedUrls(t,r,n){return pa(this,void 0,void 0,function*(){try{const a=yield No(this.fetch,`${this.url}/object/sign/${this.bucketId}`,{expiresIn:r,paths:t},{headers:this.headers}),i=n!=null&&n.download?`&download=${n.download===!0?"":n.download}`:"";return{data:a.map(s=>Object.assign(Object.assign({},s),{signedUrl:s.signedURL?encodeURI(`${this.url}${s.signedURL}${i}`):null})),error:null}}catch(a){if(hn(a))return{data:null,error:a};throw a}})}download(t,r){return pa(this,void 0,void 0,function*(){const a=typeof(r==null?void 0:r.transform)<"u"?"render/image/authenticated":"object",i=this.transformOptsToQueryString((r==null?void 0:r.transform)||{}),s=i?`?${i}`:"";try{const o=this._getFinalPath(t);return{data:yield(yield g1(this.fetch,`${this.url}/${a}/${o}${s}`,{headers:this.headers,noResolveJson:!0})).blob(),error:null}}catch(o){if(hn(o))return{data:null,error:o};throw o}})}info(t){return pa(this,void 0,void 0,function*(){const r=this._getFinalPath(t);try{const n=yield g1(this.fetch,`${this.url}/object/info/${r}`,{headers:this.headers});return{data:Ux(n),error:null}}catch(n){if(hn(n))return{data:null,error:n};throw n}})}exists(t){return pa(this,void 0,void 0,function*(){const r=this._getFinalPath(t);try{return yield mF(this.fetch,`${this.url}/object/${r}`,{headers:this.headers}),{data:!0,error:null}}catch(n){if(hn(n)&&n instanceof Bx){const a=n.originalError;if([400,404].includes(a==null?void 0:a.status))return{data:!1,error:n}}throw n}})}getPublicUrl(t,r){const n=this._getFinalPath(t),a=[],i=r!=null&&r.download?`download=${r.download===!0?"":r.download}`:"";i!==""&&a.push(i);const o=typeof(r==null?void 0:r.transform)<"u"?"render/image":"object",l=this.transformOptsToQueryString((r==null?void 0:r.transform)||{});l!==""&&a.push(l);let c=a.join("&");return c!==""&&(c=`?${c}`),{data:{publicUrl:encodeURI(`${this.url}/${o}/public/${n}${c}`)}}}remove(t){return pa(this,void 0,void 0,function*(){try{return{data:yield jk(this.fetch,`${this.url}/object/${this.bucketId}`,{prefixes:t},{headers:this.headers}),error:null}}catch(r){if(hn(r))return{data:null,error:r};throw r}})}list(t,r,n){return pa(this,void 0,void 0,function*(){try{const a=Object.assign(Object.assign(Object.assign({},gF),r),{prefix:t||""});return{data:yield No(this.fetch,`${this.url}/object/list/${this.bucketId}`,a,{headers:this.headers},n),error:null}}catch(a){if(hn(a))return{data:null,error:a};throw a}})}encodeMetadata(t){return JSON.stringify(t)}toBase64(t){return typeof Buffer<"u"?Buffer.from(t).toString("base64"):btoa(t)}_getFinalPath(t){return`${this.bucketId}/${t}`}_removeEmptyFolders(t){return t.replace(/^\/|\/$/g,"").replace(/\/+/g,"/")}transformOptsToQueryString(t){const r=[];return t.width&&r.push(`width=${t.width}`),t.height&&r.push(`height=${t.height}`),t.resize&&r.push(`resize=${t.resize}`),t.format&&r.push(`format=${t.format}`),t.quality&&r.push(`quality=${t.quality}`),r.join("&")}}const vF="2.7.1",yF={"X-Client-Info":`storage-js/${vF}`};var Hc=function(e,t,r,n){function a(i){return i instanceof r?i:new r(function(s){s(i)})}return new(r||(r=Promise))(function(i,s){function o(u){try{c(n.next(u))}catch(f){s(f)}}function l(u){try{c(n.throw(u))}catch(f){s(f)}}function c(u){u.done?i(u.value):a(u.value).then(o,l)}c((n=n.apply(e,t||[])).next())})};class wF{constructor(t,r={},n){this.url=t,this.headers=Object.assign(Object.assign({},yF),r),this.fetch=Dk(n)}listBuckets(){return Hc(this,void 0,void 0,function*(){try{return{data:yield g1(this.fetch,`${this.url}/bucket`,{headers:this.headers}),error:null}}catch(t){if(hn(t))return{data:null,error:t};throw t}})}getBucket(t){return Hc(this,void 0,void 0,function*(){try{return{data:yield g1(this.fetch,`${this.url}/bucket/${t}`,{headers:this.headers}),error:null}}catch(r){if(hn(r))return{data:null,error:r};throw r}})}createBucket(t,r={public:!1}){return Hc(this,void 0,void 0,function*(){try{return{data:yield No(this.fetch,`${this.url}/bucket`,{id:t,name:t,public:r.public,file_size_limit:r.fileSizeLimit,allowed_mime_types:r.allowedMimeTypes},{headers:this.headers}),error:null}}catch(n){if(hn(n))return{data:null,error:n};throw n}})}updateBucket(t,r){return Hc(this,void 0,void 0,function*(){try{return{data:yield pF(this.fetch,`${this.url}/bucket/${t}`,{id:t,name:t,public:r.public,file_size_limit:r.fileSizeLimit,allowed_mime_types:r.allowedMimeTypes},{headers:this.headers}),error:null}}catch(n){if(hn(n))return{data:null,error:n};throw n}})}emptyBucket(t){return Hc(this,void 0,void 0,function*(){try{return{data:yield No(this.fetch,`${this.url}/bucket/${t}/empty`,{},{headers:this.headers}),error:null}}catch(r){if(hn(r))return{data:null,error:r};throw r}})}deleteBucket(t){return Hc(this,void 0,void 0,function*(){try{return{data:yield jk(this.fetch,`${this.url}/bucket/${t}`,{},{headers:this.headers}),error:null}}catch(r){if(hn(r))return{data:null,error:r};throw r}})}}class bF extends wF{constructor(t,r={},n){super(t,r,n)}from(t){return new xF(this.url,this.headers,t,this.fetch)}}const _F="2.50.3";let rf="";typeof Deno<"u"?rf="deno":typeof document<"u"?rf="web":typeof navigator<"u"&&navigator.product==="ReactNative"?rf="react-native":rf="node";const SF={"X-Client-Info":`supabase-js-${rf}/${_F}`},kF={headers:SF},EF={schema:"public"},AF={autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,flowType:"implicit"},TF={};var CF=function(e,t,r,n){function a(i){return i instanceof r?i:new r(function(s){s(i)})}return new(r||(r=Promise))(function(i,s){function o(u){try{c(n.next(u))}catch(f){s(f)}}function l(u){try{c(n.throw(u))}catch(f){s(f)}}function c(u){u.done?i(u.value):a(u.value).then(o,l)}c((n=n.apply(e,t||[])).next())})};const NF=e=>{let t;return e?t=e:typeof fetch>"u"?t=wk:t=fetch,(...r)=>t(...r)},PF=()=>typeof Headers>"u"?bk:Headers,LF=(e,t,r)=>{const n=NF(r),a=PF();return(i,s)=>CF(void 0,void 0,void 0,function*(){var o;const l=(o=yield t())!==null&&o!==void 0?o:e;let c=new a(s==null?void 0:s.headers);return c.has("apikey")||c.set("apikey",e),c.has("Authorization")||c.set("Authorization",`Bearer ${l}`),n(i,Object.assign(Object.assign({},s),{headers:c}))})};var FF=function(e,t,r,n){function a(i){return i instanceof r?i:new r(function(s){s(i)})}return new(r||(r=Promise))(function(i,s){function o(u){try{c(n.next(u))}catch(f){s(f)}}function l(u){try{c(n.throw(u))}catch(f){s(f)}}function c(u){u.done?i(u.value):a(u.value).then(o,l)}c((n=n.apply(e,t||[])).next())})};function OF(e){return e.endsWith("/")?e:e+"/"}function IF(e,t){var r,n;const{db:a,auth:i,realtime:s,global:o}=e,{db:l,auth:c,realtime:u,global:f}=t,d={db:Object.assign(Object.assign({},l),a),auth:Object.assign(Object.assign({},c),i),realtime:Object.assign(Object.assign({},u),s),global:Object.assign(Object.assign(Object.assign({},f),o),{headers:Object.assign(Object.assign({},(r=f==null?void 0:f.headers)!==null&&r!==void 0?r:{}),(n=o==null?void 0:o.headers)!==null&&n!==void 0?n:{})}),accessToken:()=>FF(this,void 0,void 0,function*(){return""})};return e.accessToken?d.accessToken=e.accessToken:delete d.accessToken,d}const Rk="2.70.0",Qc=30*1e3,$x=3,Qg=$x*Qc,DF="http://localhost:9999",jF="supabase.auth.token",RF={"X-Client-Info":`gotrue-js/${Rk}`},Vx="X-Supabase-Api-Version",Mk={"2024-01-01":{timestamp:Date.parse("2024-01-01T00:00:00.0Z"),name:"2024-01-01"}},MF=/^([a-z0-9_-]{4})*($|[a-z0-9_-]{3}$|[a-z0-9_-]{2}$)$/i,BF=6e5;class Ry extends Error{constructor(t,r,n){super(t),this.__isAuthError=!0,this.name="AuthError",this.status=r,this.code=n}}function Ft(e){return typeof e=="object"&&e!==null&&"__isAuthError"in e}class UF extends Ry{constructor(t,r,n){super(t,r,n),this.name="AuthApiError",this.status=r,this.code=n}}function $F(e){return Ft(e)&&e.name==="AuthApiError"}class Bk extends Ry{constructor(t,r){super(t),this.name="AuthUnknownError",this.originalError=r}}class hl extends Ry{constructor(t,r,n,a){super(t,n,a),this.name=r,this.status=n}}class Eo extends hl{constructor(){super("Auth session missing!","AuthSessionMissingError",400,void 0)}}function VF(e){return Ft(e)&&e.name==="AuthSessionMissingError"}class Qd extends hl{constructor(){super("Auth session or user missing","AuthInvalidTokenResponseError",500,void 0)}}class Zd extends hl{constructor(t){super(t,"AuthInvalidCredentialsError",400,void 0)}}class ep extends hl{constructor(t,r=null){super(t,"AuthImplicitGrantRedirectError",500,void 0),this.details=null,this.details=r}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}function zF(e){return Ft(e)&&e.name==="AuthImplicitGrantRedirectError"}class Vb extends hl{constructor(t,r=null){super(t,"AuthPKCEGrantCodeExchangeError",500,void 0),this.details=null,this.details=r}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}class zx extends hl{constructor(t,r){super(t,"AuthRetryableFetchError",r,void 0)}}function Zg(e){return Ft(e)&&e.name==="AuthRetryableFetchError"}class zb extends hl{constructor(t,r,n){super(t,"AuthWeakPasswordError",r,"weak_password"),this.reasons=n}}class bf extends hl{constructor(t){super(t,"AuthInvalidJwtError",400,"invalid_jwt")}}const x1="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_".split(""),Hb=` 	
\r=`.split(""),HF=(()=>{const e=new Array(128);for(let t=0;t<e.length;t+=1)e[t]=-1;for(let t=0;t<Hb.length;t+=1)e[Hb[t].charCodeAt(0)]=-2;for(let t=0;t<x1.length;t+=1)e[x1[t].charCodeAt(0)]=t;return e})();function Wb(e,t,r){if(e!==null)for(t.queue=t.queue<<8|e,t.queuedBits+=8;t.queuedBits>=6;){const n=t.queue>>t.queuedBits-6&63;r(x1[n]),t.queuedBits-=6}else if(t.queuedBits>0)for(t.queue=t.queue<<6-t.queuedBits,t.queuedBits=6;t.queuedBits>=6;){const n=t.queue>>t.queuedBits-6&63;r(x1[n]),t.queuedBits-=6}}function Uk(e,t,r){const n=HF[e];if(n>-1)for(t.queue=t.queue<<6|n,t.queuedBits+=6;t.queuedBits>=8;)r(t.queue>>t.queuedBits-8&255),t.queuedBits-=8;else{if(n===-2)return;throw new Error(`Invalid Base64-URL character "${String.fromCharCode(e)}"`)}}function qb(e){const t=[],r=s=>{t.push(String.fromCodePoint(s))},n={utf8seq:0,codepoint:0},a={queue:0,queuedBits:0},i=s=>{GF(s,n,r)};for(let s=0;s<e.length;s+=1)Uk(e.charCodeAt(s),a,i);return t.join("")}function WF(e,t){if(e<=127){t(e);return}else if(e<=2047){t(192|e>>6),t(128|e&63);return}else if(e<=65535){t(224|e>>12),t(128|e>>6&63),t(128|e&63);return}else if(e<=1114111){t(240|e>>18),t(128|e>>12&63),t(128|e>>6&63),t(128|e&63);return}throw new Error(`Unrecognized Unicode codepoint: ${e.toString(16)}`)}function qF(e,t){for(let r=0;r<e.length;r+=1){let n=e.charCodeAt(r);if(n>55295&&n<=56319){const a=(n-55296)*1024&65535;n=(e.charCodeAt(r+1)-56320&65535|a)+65536,r+=1}WF(n,t)}}function GF(e,t,r){if(t.utf8seq===0){if(e<=127){r(e);return}for(let n=1;n<6;n+=1)if(!(e>>7-n&1)){t.utf8seq=n;break}if(t.utf8seq===2)t.codepoint=e&31;else if(t.utf8seq===3)t.codepoint=e&15;else if(t.utf8seq===4)t.codepoint=e&7;else throw new Error("Invalid UTF-8 sequence");t.utf8seq-=1}else if(t.utf8seq>0){if(e<=127)throw new Error("Invalid UTF-8 sequence");t.codepoint=t.codepoint<<6|e&63,t.utf8seq-=1,t.utf8seq===0&&r(t.codepoint)}}function KF(e){const t=[],r={queue:0,queuedBits:0},n=a=>{t.push(a)};for(let a=0;a<e.length;a+=1)Uk(e.charCodeAt(a),r,n);return new Uint8Array(t)}function XF(e){const t=[];return qF(e,r=>t.push(r)),new Uint8Array(t)}function YF(e){const t=[],r={queue:0,queuedBits:0},n=a=>{t.push(a)};return e.forEach(a=>Wb(a,r,n)),Wb(null,r,n),t.join("")}function JF(e){return Math.round(Date.now()/1e3)+e}function QF(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(e){const t=Math.random()*16|0;return(e=="x"?t:t&3|8).toString(16)})}const Ai=()=>typeof window<"u"&&typeof document<"u",El={tested:!1,writable:!1},_f=()=>{if(!Ai())return!1;try{if(typeof globalThis.localStorage!="object")return!1}catch{return!1}if(El.tested)return El.writable;const e=`lswt-${Math.random()}${Math.random()}`;try{globalThis.localStorage.setItem(e,e),globalThis.localStorage.removeItem(e),El.tested=!0,El.writable=!0}catch{El.tested=!0,El.writable=!1}return El.writable};function ZF(e){const t={},r=new URL(e);if(r.hash&&r.hash[0]==="#")try{new URLSearchParams(r.hash.substring(1)).forEach((a,i)=>{t[i]=a})}catch{}return r.searchParams.forEach((n,a)=>{t[a]=n}),t}const $k=e=>{let t;return e?t=e:typeof fetch>"u"?t=(...r)=>tl(async()=>{const{default:n}=await Promise.resolve().then(()=>t0);return{default:n}},void 0).then(({default:n})=>n(...r)):t=fetch,(...r)=>t(...r)},e9=e=>typeof e=="object"&&e!==null&&"status"in e&&"ok"in e&&"json"in e&&typeof e.json=="function",Vk=async(e,t,r)=>{await e.setItem(t,JSON.stringify(r))},tp=async(e,t)=>{const r=await e.getItem(t);if(!r)return null;try{return JSON.parse(r)}catch{return r}},rp=async(e,t)=>{await e.removeItem(t)};class gm{constructor(){this.promise=new gm.promiseConstructor((t,r)=>{this.resolve=t,this.reject=r})}}gm.promiseConstructor=Promise;function e2(e){const t=e.split(".");if(t.length!==3)throw new bf("Invalid JWT structure");for(let n=0;n<t.length;n++)if(!MF.test(t[n]))throw new bf("JWT not in base64url format");return{header:JSON.parse(qb(t[0])),payload:JSON.parse(qb(t[1])),signature:KF(t[2]),raw:{header:t[0],payload:t[1]}}}async function t9(e){return await new Promise(t=>{setTimeout(()=>t(null),e)})}function r9(e,t){return new Promise((n,a)=>{(async()=>{for(let i=0;i<1/0;i++)try{const s=await e(i);if(!t(i,null,s)){n(s);return}}catch(s){if(!t(i,s)){a(s);return}}})()})}function n9(e){return("0"+e.toString(16)).substr(-2)}function a9(){const t=new Uint32Array(56);if(typeof crypto>"u"){const r="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-._~",n=r.length;let a="";for(let i=0;i<56;i++)a+=r.charAt(Math.floor(Math.random()*n));return a}return crypto.getRandomValues(t),Array.from(t,n9).join("")}async function i9(e){const r=new TextEncoder().encode(e),n=await crypto.subtle.digest("SHA-256",r),a=new Uint8Array(n);return Array.from(a).map(i=>String.fromCharCode(i)).join("")}async function s9(e){if(!(typeof crypto<"u"&&typeof crypto.subtle<"u"&&typeof TextEncoder<"u"))return console.warn("WebCrypto API is not supported. Code challenge method will default to use plain instead of sha256."),e;const r=await i9(e);return btoa(r).replace(/\+/g,"-").replace(/\//g,"_").replace(/=+$/,"")}async function Wc(e,t,r=!1){const n=a9();let a=n;r&&(a+="/PASSWORD_RECOVERY"),await Vk(e,`${t}-code-verifier`,a);const i=await s9(n);return[i,n===i?"plain":"s256"]}const o9=/^2[0-9]{3}-(0[1-9]|1[0-2])-(0[1-9]|1[0-9]|2[0-9]|3[0-1])$/i;function l9(e){const t=e.headers.get(Vx);if(!t||!t.match(o9))return null;try{return new Date(`${t}T00:00:00.0Z`)}catch{return null}}function c9(e){if(!e)throw new Error("Missing exp claim");const t=Math.floor(Date.now()/1e3);if(e<=t)throw new Error("JWT has expired")}function u9(e){switch(e){case"RS256":return{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-256"}};case"ES256":return{name:"ECDSA",namedCurve:"P-256",hash:{name:"SHA-256"}};default:throw new Error("Invalid alg claim")}}const f9=/^[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}$/;function qc(e){if(!f9.test(e))throw new Error("@supabase/auth-js: Expected parameter to be UUID but is not")}var h9=function(e,t){var r={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(r[n]=e[n]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var a=0,n=Object.getOwnPropertySymbols(e);a<n.length;a++)t.indexOf(n[a])<0&&Object.prototype.propertyIsEnumerable.call(e,n[a])&&(r[n[a]]=e[n[a]]);return r};const Nl=e=>e.msg||e.message||e.error_description||e.error||JSON.stringify(e),d9=[502,503,504];async function Gb(e){var t;if(!e9(e))throw new zx(Nl(e),0);if(d9.includes(e.status))throw new zx(Nl(e),e.status);let r;try{r=await e.json()}catch(i){throw new Bk(Nl(i),i)}let n;const a=l9(e);if(a&&a.getTime()>=Mk["2024-01-01"].timestamp&&typeof r=="object"&&r&&typeof r.code=="string"?n=r.code:typeof r=="object"&&r&&typeof r.error_code=="string"&&(n=r.error_code),n){if(n==="weak_password")throw new zb(Nl(r),e.status,((t=r.weak_password)===null||t===void 0?void 0:t.reasons)||[]);if(n==="session_not_found")throw new Eo}else if(typeof r=="object"&&r&&typeof r.weak_password=="object"&&r.weak_password&&Array.isArray(r.weak_password.reasons)&&r.weak_password.reasons.length&&r.weak_password.reasons.reduce((i,s)=>i&&typeof s=="string",!0))throw new zb(Nl(r),e.status,r.weak_password.reasons);throw new UF(Nl(r),e.status||500,n)}const p9=(e,t,r,n)=>{const a={method:e,headers:(t==null?void 0:t.headers)||{}};return e==="GET"?a:(a.headers=Object.assign({"Content-Type":"application/json;charset=UTF-8"},t==null?void 0:t.headers),a.body=JSON.stringify(n),Object.assign(Object.assign({},a),r))};async function Dt(e,t,r,n){var a;const i=Object.assign({},n==null?void 0:n.headers);i[Vx]||(i[Vx]=Mk["2024-01-01"].name),n!=null&&n.jwt&&(i.Authorization=`Bearer ${n.jwt}`);const s=(a=n==null?void 0:n.query)!==null&&a!==void 0?a:{};n!=null&&n.redirectTo&&(s.redirect_to=n.redirectTo);const o=Object.keys(s).length?"?"+new URLSearchParams(s).toString():"",l=await m9(e,t,r+o,{headers:i,noResolveJson:n==null?void 0:n.noResolveJson},{},n==null?void 0:n.body);return n!=null&&n.xform?n==null?void 0:n.xform(l):{data:Object.assign({},l),error:null}}async function m9(e,t,r,n,a,i){const s=p9(t,n,a,i);let o;try{o=await e(r,Object.assign({},s))}catch(l){throw console.error(l),new zx(Nl(l),0)}if(o.ok||await Gb(o),n!=null&&n.noResolveJson)return o;try{return await o.json()}catch(l){await Gb(l)}}function Fs(e){var t;let r=null;y9(e)&&(r=Object.assign({},e),e.expires_at||(r.expires_at=JF(e.expires_in)));const n=(t=e.user)!==null&&t!==void 0?t:e;return{data:{session:r,user:n},error:null}}function Kb(e){const t=Fs(e);return!t.error&&e.weak_password&&typeof e.weak_password=="object"&&Array.isArray(e.weak_password.reasons)&&e.weak_password.reasons.length&&e.weak_password.message&&typeof e.weak_password.message=="string"&&e.weak_password.reasons.reduce((r,n)=>r&&typeof n=="string",!0)&&(t.data.weak_password=e.weak_password),t}function Io(e){var t;return{data:{user:(t=e.user)!==null&&t!==void 0?t:e},error:null}}function g9(e){return{data:e,error:null}}function x9(e){const{action_link:t,email_otp:r,hashed_token:n,redirect_to:a,verification_type:i}=e,s=h9(e,["action_link","email_otp","hashed_token","redirect_to","verification_type"]),o={action_link:t,email_otp:r,hashed_token:n,redirect_to:a,verification_type:i},l=Object.assign({},s);return{data:{properties:o,user:l},error:null}}function v9(e){return e}function y9(e){return e.access_token&&e.refresh_token&&e.expires_in}const t2=["global","local","others"];var w9=function(e,t){var r={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(r[n]=e[n]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var a=0,n=Object.getOwnPropertySymbols(e);a<n.length;a++)t.indexOf(n[a])<0&&Object.prototype.propertyIsEnumerable.call(e,n[a])&&(r[n[a]]=e[n[a]]);return r};class b9{constructor({url:t="",headers:r={},fetch:n}){this.url=t,this.headers=r,this.fetch=$k(n),this.mfa={listFactors:this._listFactors.bind(this),deleteFactor:this._deleteFactor.bind(this)}}async signOut(t,r=t2[0]){if(t2.indexOf(r)<0)throw new Error(`@supabase/auth-js: Parameter scope must be one of ${t2.join(", ")}`);try{return await Dt(this.fetch,"POST",`${this.url}/logout?scope=${r}`,{headers:this.headers,jwt:t,noResolveJson:!0}),{data:null,error:null}}catch(n){if(Ft(n))return{data:null,error:n};throw n}}async inviteUserByEmail(t,r={}){try{return await Dt(this.fetch,"POST",`${this.url}/invite`,{body:{email:t,data:r.data},headers:this.headers,redirectTo:r.redirectTo,xform:Io})}catch(n){if(Ft(n))return{data:{user:null},error:n};throw n}}async generateLink(t){try{const{options:r}=t,n=w9(t,["options"]),a=Object.assign(Object.assign({},n),r);return"newEmail"in n&&(a.new_email=n==null?void 0:n.newEmail,delete a.newEmail),await Dt(this.fetch,"POST",`${this.url}/admin/generate_link`,{body:a,headers:this.headers,xform:x9,redirectTo:r==null?void 0:r.redirectTo})}catch(r){if(Ft(r))return{data:{properties:null,user:null},error:r};throw r}}async createUser(t){try{return await Dt(this.fetch,"POST",`${this.url}/admin/users`,{body:t,headers:this.headers,xform:Io})}catch(r){if(Ft(r))return{data:{user:null},error:r};throw r}}async listUsers(t){var r,n,a,i,s,o,l;try{const c={nextPage:null,lastPage:0,total:0},u=await Dt(this.fetch,"GET",`${this.url}/admin/users`,{headers:this.headers,noResolveJson:!0,query:{page:(n=(r=t==null?void 0:t.page)===null||r===void 0?void 0:r.toString())!==null&&n!==void 0?n:"",per_page:(i=(a=t==null?void 0:t.perPage)===null||a===void 0?void 0:a.toString())!==null&&i!==void 0?i:""},xform:v9});if(u.error)throw u.error;const f=await u.json(),d=(s=u.headers.get("x-total-count"))!==null&&s!==void 0?s:0,h=(l=(o=u.headers.get("link"))===null||o===void 0?void 0:o.split(","))!==null&&l!==void 0?l:[];return h.length>0&&(h.forEach(g=>{const m=parseInt(g.split(";")[0].split("=")[1].substring(0,1)),_=JSON.parse(g.split(";")[1].split("=")[1]);c[`${_}Page`]=m}),c.total=parseInt(d)),{data:Object.assign(Object.assign({},f),c),error:null}}catch(c){if(Ft(c))return{data:{users:[]},error:c};throw c}}async getUserById(t){qc(t);try{return await Dt(this.fetch,"GET",`${this.url}/admin/users/${t}`,{headers:this.headers,xform:Io})}catch(r){if(Ft(r))return{data:{user:null},error:r};throw r}}async updateUserById(t,r){qc(t);try{return await Dt(this.fetch,"PUT",`${this.url}/admin/users/${t}`,{body:r,headers:this.headers,xform:Io})}catch(n){if(Ft(n))return{data:{user:null},error:n};throw n}}async deleteUser(t,r=!1){qc(t);try{return await Dt(this.fetch,"DELETE",`${this.url}/admin/users/${t}`,{headers:this.headers,body:{should_soft_delete:r},xform:Io})}catch(n){if(Ft(n))return{data:{user:null},error:n};throw n}}async _listFactors(t){qc(t.userId);try{const{data:r,error:n}=await Dt(this.fetch,"GET",`${this.url}/admin/users/${t.userId}/factors`,{headers:this.headers,xform:a=>({data:{factors:a},error:null})});return{data:r,error:n}}catch(r){if(Ft(r))return{data:null,error:r};throw r}}async _deleteFactor(t){qc(t.userId),qc(t.id);try{return{data:await Dt(this.fetch,"DELETE",`${this.url}/admin/users/${t.userId}/factors/${t.id}`,{headers:this.headers}),error:null}}catch(r){if(Ft(r))return{data:null,error:r};throw r}}}const _9={getItem:e=>_f()?globalThis.localStorage.getItem(e):null,setItem:(e,t)=>{_f()&&globalThis.localStorage.setItem(e,t)},removeItem:e=>{_f()&&globalThis.localStorage.removeItem(e)}};function Xb(e={}){return{getItem:t=>e[t]||null,setItem:(t,r)=>{e[t]=r},removeItem:t=>{delete e[t]}}}function S9(){if(typeof globalThis!="object")try{Object.defineProperty(Object.prototype,"__magic__",{get:function(){return this},configurable:!0}),__magic__.globalThis=__magic__,delete Object.prototype.__magic__}catch{typeof self<"u"&&(self.globalThis=self)}}const Gc={debug:!!(globalThis&&_f()&&globalThis.localStorage&&globalThis.localStorage.getItem("supabase.gotrue-js.locks.debug")==="true")};class zk extends Error{constructor(t){super(t),this.isAcquireTimeout=!0}}class k9 extends zk{}async function E9(e,t,r){Gc.debug&&console.log("@supabase/gotrue-js: navigatorLock: acquire lock",e,t);const n=new globalThis.AbortController;return t>0&&setTimeout(()=>{n.abort(),Gc.debug&&console.log("@supabase/gotrue-js: navigatorLock acquire timed out",e)},t),await Promise.resolve().then(()=>globalThis.navigator.locks.request(e,t===0?{mode:"exclusive",ifAvailable:!0}:{mode:"exclusive",signal:n.signal},async a=>{if(a){Gc.debug&&console.log("@supabase/gotrue-js: navigatorLock: acquired",e,a.name);try{return await r()}finally{Gc.debug&&console.log("@supabase/gotrue-js: navigatorLock: released",e,a.name)}}else{if(t===0)throw Gc.debug&&console.log("@supabase/gotrue-js: navigatorLock: not immediately available",e),new k9(`Acquiring an exclusive Navigator LockManager lock "${e}" immediately failed`);if(Gc.debug)try{const i=await globalThis.navigator.locks.query();console.log("@supabase/gotrue-js: Navigator LockManager state",JSON.stringify(i,null,"  "))}catch(i){console.warn("@supabase/gotrue-js: Error when querying Navigator LockManager state",i)}return console.warn("@supabase/gotrue-js: Navigator LockManager returned a null lock when using #request without ifAvailable set to true, it appears this browser is not following the LockManager spec https://developer.mozilla.org/en-US/docs/Web/API/LockManager/request"),await r()}}))}S9();const A9={url:DF,storageKey:jF,autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,headers:RF,flowType:"implicit",debug:!1,hasCustomAuthorizationHeader:!1};async function Yb(e,t,r){return await r()}class nh{constructor(t){var r,n;this.memoryStorage=null,this.stateChangeEmitters=new Map,this.autoRefreshTicker=null,this.visibilityChangedCallback=null,this.refreshingDeferred=null,this.initializePromise=null,this.detectSessionInUrl=!0,this.hasCustomAuthorizationHeader=!1,this.suppressGetSessionWarning=!1,this.lockAcquired=!1,this.pendingInLock=[],this.broadcastChannel=null,this.logger=console.log,this.instanceID=nh.nextInstanceID,nh.nextInstanceID+=1,this.instanceID>0&&Ai()&&console.warn("Multiple GoTrueClient instances detected in the same browser context. It is not an error, but this should be avoided as it may produce undefined behavior when used concurrently under the same storage key.");const a=Object.assign(Object.assign({},A9),t);if(this.logDebugMessages=!!a.debug,typeof a.debug=="function"&&(this.logger=a.debug),this.persistSession=a.persistSession,this.storageKey=a.storageKey,this.autoRefreshToken=a.autoRefreshToken,this.admin=new b9({url:a.url,headers:a.headers,fetch:a.fetch}),this.url=a.url,this.headers=a.headers,this.fetch=$k(a.fetch),this.lock=a.lock||Yb,this.detectSessionInUrl=a.detectSessionInUrl,this.flowType=a.flowType,this.hasCustomAuthorizationHeader=a.hasCustomAuthorizationHeader,a.lock?this.lock=a.lock:Ai()&&(!((r=globalThis==null?void 0:globalThis.navigator)===null||r===void 0)&&r.locks)?this.lock=E9:this.lock=Yb,this.jwks={keys:[]},this.jwks_cached_at=Number.MIN_SAFE_INTEGER,this.mfa={verify:this._verify.bind(this),enroll:this._enroll.bind(this),unenroll:this._unenroll.bind(this),challenge:this._challenge.bind(this),listFactors:this._listFactors.bind(this),challengeAndVerify:this._challengeAndVerify.bind(this),getAuthenticatorAssuranceLevel:this._getAuthenticatorAssuranceLevel.bind(this)},this.persistSession?a.storage?this.storage=a.storage:_f()?this.storage=_9:(this.memoryStorage={},this.storage=Xb(this.memoryStorage)):(this.memoryStorage={},this.storage=Xb(this.memoryStorage)),Ai()&&globalThis.BroadcastChannel&&this.persistSession&&this.storageKey){try{this.broadcastChannel=new globalThis.BroadcastChannel(this.storageKey)}catch(i){console.error("Failed to create a new BroadcastChannel, multi-tab state changes will not be available",i)}(n=this.broadcastChannel)===null||n===void 0||n.addEventListener("message",async i=>{this._debug("received broadcast notification from other tab or client",i),await this._notifyAllSubscribers(i.data.event,i.data.session,!1)})}this.initialize()}_debug(...t){return this.logDebugMessages&&this.logger(`GoTrueClient@${this.instanceID} (${Rk}) ${new Date().toISOString()}`,...t),this}async initialize(){return this.initializePromise?await this.initializePromise:(this.initializePromise=(async()=>await this._acquireLock(-1,async()=>await this._initialize()))(),await this.initializePromise)}async _initialize(){var t;try{const r=ZF(window.location.href);let n="none";if(this._isImplicitGrantCallback(r)?n="implicit":await this._isPKCECallback(r)&&(n="pkce"),Ai()&&this.detectSessionInUrl&&n!=="none"){const{data:a,error:i}=await this._getSessionFromURL(r,n);if(i){if(this._debug("#_initialize()","error detecting session from URL",i),zF(i)){const l=(t=i.details)===null||t===void 0?void 0:t.code;if(l==="identity_already_exists"||l==="identity_not_found"||l==="single_identity_not_deletable")return{error:i}}return await this._removeSession(),{error:i}}const{session:s,redirectType:o}=a;return this._debug("#_initialize()","detected session in URL",s,"redirect type",o),await this._saveSession(s),setTimeout(async()=>{o==="recovery"?await this._notifyAllSubscribers("PASSWORD_RECOVERY",s):await this._notifyAllSubscribers("SIGNED_IN",s)},0),{error:null}}return await this._recoverAndRefresh(),{error:null}}catch(r){return Ft(r)?{error:r}:{error:new Bk("Unexpected error during initialization",r)}}finally{await this._handleVisibilityChange(),this._debug("#_initialize()","end")}}async signInAnonymously(t){var r,n,a;try{const i=await Dt(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{data:(n=(r=t==null?void 0:t.options)===null||r===void 0?void 0:r.data)!==null&&n!==void 0?n:{},gotrue_meta_security:{captcha_token:(a=t==null?void 0:t.options)===null||a===void 0?void 0:a.captchaToken}},xform:Fs}),{data:s,error:o}=i;if(o||!s)return{data:{user:null,session:null},error:o};const l=s.session,c=s.user;return s.session&&(await this._saveSession(s.session),await this._notifyAllSubscribers("SIGNED_IN",l)),{data:{user:c,session:l},error:null}}catch(i){if(Ft(i))return{data:{user:null,session:null},error:i};throw i}}async signUp(t){var r,n,a;try{let i;if("email"in t){const{email:u,password:f,options:d}=t;let h=null,g=null;this.flowType==="pkce"&&([h,g]=await Wc(this.storage,this.storageKey)),i=await Dt(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,redirectTo:d==null?void 0:d.emailRedirectTo,body:{email:u,password:f,data:(r=d==null?void 0:d.data)!==null&&r!==void 0?r:{},gotrue_meta_security:{captcha_token:d==null?void 0:d.captchaToken},code_challenge:h,code_challenge_method:g},xform:Fs})}else if("phone"in t){const{phone:u,password:f,options:d}=t;i=await Dt(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{phone:u,password:f,data:(n=d==null?void 0:d.data)!==null&&n!==void 0?n:{},channel:(a=d==null?void 0:d.channel)!==null&&a!==void 0?a:"sms",gotrue_meta_security:{captcha_token:d==null?void 0:d.captchaToken}},xform:Fs})}else throw new Zd("You must provide either an email or phone number and a password");const{data:s,error:o}=i;if(o||!s)return{data:{user:null,session:null},error:o};const l=s.session,c=s.user;return s.session&&(await this._saveSession(s.session),await this._notifyAllSubscribers("SIGNED_IN",l)),{data:{user:c,session:l},error:null}}catch(i){if(Ft(i))return{data:{user:null,session:null},error:i};throw i}}async signInWithPassword(t){try{let r;if("email"in t){const{email:i,password:s,options:o}=t;r=await Dt(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{email:i,password:s,gotrue_meta_security:{captcha_token:o==null?void 0:o.captchaToken}},xform:Kb})}else if("phone"in t){const{phone:i,password:s,options:o}=t;r=await Dt(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{phone:i,password:s,gotrue_meta_security:{captcha_token:o==null?void 0:o.captchaToken}},xform:Kb})}else throw new Zd("You must provide either an email or phone number and a password");const{data:n,error:a}=r;return a?{data:{user:null,session:null},error:a}:!n||!n.session||!n.user?{data:{user:null,session:null},error:new Qd}:(n.session&&(await this._saveSession(n.session),await this._notifyAllSubscribers("SIGNED_IN",n.session)),{data:Object.assign({user:n.user,session:n.session},n.weak_password?{weakPassword:n.weak_password}:null),error:a})}catch(r){if(Ft(r))return{data:{user:null,session:null},error:r};throw r}}async signInWithOAuth(t){var r,n,a,i;return await this._handleProviderSignIn(t.provider,{redirectTo:(r=t.options)===null||r===void 0?void 0:r.redirectTo,scopes:(n=t.options)===null||n===void 0?void 0:n.scopes,queryParams:(a=t.options)===null||a===void 0?void 0:a.queryParams,skipBrowserRedirect:(i=t.options)===null||i===void 0?void 0:i.skipBrowserRedirect})}async exchangeCodeForSession(t){return await this.initializePromise,this._acquireLock(-1,async()=>this._exchangeCodeForSession(t))}async signInWithWeb3(t){const{chain:r}=t;if(r==="solana")return await this.signInWithSolana(t);throw new Error(`@supabase/auth-js: Unsupported chain "${r}"`)}async signInWithSolana(t){var r,n,a,i,s,o,l,c,u,f,d,h;let g,m;if("message"in t)g=t.message,m=t.signature;else{const{chain:_,wallet:y,statement:b,options:w}=t;let T;if(Ai())if(typeof y=="object")T=y;else{const I=window;if("solana"in I&&typeof I.solana=="object"&&("signIn"in I.solana&&typeof I.solana.signIn=="function"||"signMessage"in I.solana&&typeof I.solana.signMessage=="function"))T=I.solana;else throw new Error("@supabase/auth-js: No compatible Solana wallet interface on the window object (window.solana) detected. Make sure the user already has a wallet installed and connected for this app. Prefer passing the wallet interface object directly to signInWithWeb3({ chain: 'solana', wallet: resolvedUserWallet }) instead.")}else{if(typeof y!="object"||!(w!=null&&w.url))throw new Error("@supabase/auth-js: Both wallet and url must be specified in non-browser environments.");T=y}const F=new URL((r=w==null?void 0:w.url)!==null&&r!==void 0?r:window.location.href);if("signIn"in T&&T.signIn){const I=await T.signIn(Object.assign(Object.assign(Object.assign({issuedAt:new Date().toISOString()},w==null?void 0:w.signInWithSolana),{version:"1",domain:F.host,uri:F.href}),b?{statement:b}:null));let A;if(Array.isArray(I)&&I[0]&&typeof I[0]=="object")A=I[0];else if(I&&typeof I=="object"&&"signedMessage"in I&&"signature"in I)A=I;else throw new Error("@supabase/auth-js: Wallet method signIn() returned unrecognized value");if("signedMessage"in A&&"signature"in A&&(typeof A.signedMessage=="string"||A.signedMessage instanceof Uint8Array)&&A.signature instanceof Uint8Array)g=typeof A.signedMessage=="string"?A.signedMessage:new TextDecoder().decode(A.signedMessage),m=A.signature;else throw new Error("@supabase/auth-js: Wallet method signIn() API returned object without signedMessage and signature fields")}else{if(!("signMessage"in T)||typeof T.signMessage!="function"||!("publicKey"in T)||typeof T!="object"||!T.publicKey||!("toBase58"in T.publicKey)||typeof T.publicKey.toBase58!="function")throw new Error("@supabase/auth-js: Wallet does not have a compatible signMessage() and publicKey.toBase58() API");g=[`${F.host} wants you to sign in with your Solana account:`,T.publicKey.toBase58(),...b?["",b,""]:[""],"Version: 1",`URI: ${F.href}`,`Issued At: ${(a=(n=w==null?void 0:w.signInWithSolana)===null||n===void 0?void 0:n.issuedAt)!==null&&a!==void 0?a:new Date().toISOString()}`,...!((i=w==null?void 0:w.signInWithSolana)===null||i===void 0)&&i.notBefore?[`Not Before: ${w.signInWithSolana.notBefore}`]:[],...!((s=w==null?void 0:w.signInWithSolana)===null||s===void 0)&&s.expirationTime?[`Expiration Time: ${w.signInWithSolana.expirationTime}`]:[],...!((o=w==null?void 0:w.signInWithSolana)===null||o===void 0)&&o.chainId?[`Chain ID: ${w.signInWithSolana.chainId}`]:[],...!((l=w==null?void 0:w.signInWithSolana)===null||l===void 0)&&l.nonce?[`Nonce: ${w.signInWithSolana.nonce}`]:[],...!((c=w==null?void 0:w.signInWithSolana)===null||c===void 0)&&c.requestId?[`Request ID: ${w.signInWithSolana.requestId}`]:[],...!((f=(u=w==null?void 0:w.signInWithSolana)===null||u===void 0?void 0:u.resources)===null||f===void 0)&&f.length?["Resources",...w.signInWithSolana.resources.map(A=>`- ${A}`)]:[]].join(`
`);const I=await T.signMessage(new TextEncoder().encode(g),"utf8");if(!I||!(I instanceof Uint8Array))throw new Error("@supabase/auth-js: Wallet signMessage() API returned an recognized value");m=I}}try{const{data:_,error:y}=await Dt(this.fetch,"POST",`${this.url}/token?grant_type=web3`,{headers:this.headers,body:Object.assign({chain:"solana",message:g,signature:YF(m)},!((d=t.options)===null||d===void 0)&&d.captchaToken?{gotrue_meta_security:{captcha_token:(h=t.options)===null||h===void 0?void 0:h.captchaToken}}:null),xform:Fs});if(y)throw y;return!_||!_.session||!_.user?{data:{user:null,session:null},error:new Qd}:(_.session&&(await this._saveSession(_.session),await this._notifyAllSubscribers("SIGNED_IN",_.session)),{data:Object.assign({},_),error:y})}catch(_){if(Ft(_))return{data:{user:null,session:null},error:_};throw _}}async _exchangeCodeForSession(t){const r=await tp(this.storage,`${this.storageKey}-code-verifier`),[n,a]=(r??"").split("/");try{const{data:i,error:s}=await Dt(this.fetch,"POST",`${this.url}/token?grant_type=pkce`,{headers:this.headers,body:{auth_code:t,code_verifier:n},xform:Fs});if(await rp(this.storage,`${this.storageKey}-code-verifier`),s)throw s;return!i||!i.session||!i.user?{data:{user:null,session:null,redirectType:null},error:new Qd}:(i.session&&(await this._saveSession(i.session),await this._notifyAllSubscribers("SIGNED_IN",i.session)),{data:Object.assign(Object.assign({},i),{redirectType:a??null}),error:s})}catch(i){if(Ft(i))return{data:{user:null,session:null,redirectType:null},error:i};throw i}}async signInWithIdToken(t){try{const{options:r,provider:n,token:a,access_token:i,nonce:s}=t,o=await Dt(this.fetch,"POST",`${this.url}/token?grant_type=id_token`,{headers:this.headers,body:{provider:n,id_token:a,access_token:i,nonce:s,gotrue_meta_security:{captcha_token:r==null?void 0:r.captchaToken}},xform:Fs}),{data:l,error:c}=o;return c?{data:{user:null,session:null},error:c}:!l||!l.session||!l.user?{data:{user:null,session:null},error:new Qd}:(l.session&&(await this._saveSession(l.session),await this._notifyAllSubscribers("SIGNED_IN",l.session)),{data:l,error:c})}catch(r){if(Ft(r))return{data:{user:null,session:null},error:r};throw r}}async signInWithOtp(t){var r,n,a,i,s;try{if("email"in t){const{email:o,options:l}=t;let c=null,u=null;this.flowType==="pkce"&&([c,u]=await Wc(this.storage,this.storageKey));const{error:f}=await Dt(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{email:o,data:(r=l==null?void 0:l.data)!==null&&r!==void 0?r:{},create_user:(n=l==null?void 0:l.shouldCreateUser)!==null&&n!==void 0?n:!0,gotrue_meta_security:{captcha_token:l==null?void 0:l.captchaToken},code_challenge:c,code_challenge_method:u},redirectTo:l==null?void 0:l.emailRedirectTo});return{data:{user:null,session:null},error:f}}if("phone"in t){const{phone:o,options:l}=t,{data:c,error:u}=await Dt(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{phone:o,data:(a=l==null?void 0:l.data)!==null&&a!==void 0?a:{},create_user:(i=l==null?void 0:l.shouldCreateUser)!==null&&i!==void 0?i:!0,gotrue_meta_security:{captcha_token:l==null?void 0:l.captchaToken},channel:(s=l==null?void 0:l.channel)!==null&&s!==void 0?s:"sms"}});return{data:{user:null,session:null,messageId:c==null?void 0:c.message_id},error:u}}throw new Zd("You must provide either an email or phone number.")}catch(o){if(Ft(o))return{data:{user:null,session:null},error:o};throw o}}async verifyOtp(t){var r,n;try{let a,i;"options"in t&&(a=(r=t.options)===null||r===void 0?void 0:r.redirectTo,i=(n=t.options)===null||n===void 0?void 0:n.captchaToken);const{data:s,error:o}=await Dt(this.fetch,"POST",`${this.url}/verify`,{headers:this.headers,body:Object.assign(Object.assign({},t),{gotrue_meta_security:{captcha_token:i}}),redirectTo:a,xform:Fs});if(o)throw o;if(!s)throw new Error("An error occurred on token verification.");const l=s.session,c=s.user;return l!=null&&l.access_token&&(await this._saveSession(l),await this._notifyAllSubscribers(t.type=="recovery"?"PASSWORD_RECOVERY":"SIGNED_IN",l)),{data:{user:c,session:l},error:null}}catch(a){if(Ft(a))return{data:{user:null,session:null},error:a};throw a}}async signInWithSSO(t){var r,n,a;try{let i=null,s=null;return this.flowType==="pkce"&&([i,s]=await Wc(this.storage,this.storageKey)),await Dt(this.fetch,"POST",`${this.url}/sso`,{body:Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},"providerId"in t?{provider_id:t.providerId}:null),"domain"in t?{domain:t.domain}:null),{redirect_to:(n=(r=t.options)===null||r===void 0?void 0:r.redirectTo)!==null&&n!==void 0?n:void 0}),!((a=t==null?void 0:t.options)===null||a===void 0)&&a.captchaToken?{gotrue_meta_security:{captcha_token:t.options.captchaToken}}:null),{skip_http_redirect:!0,code_challenge:i,code_challenge_method:s}),headers:this.headers,xform:g9})}catch(i){if(Ft(i))return{data:null,error:i};throw i}}async reauthenticate(){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._reauthenticate())}async _reauthenticate(){try{return await this._useSession(async t=>{const{data:{session:r},error:n}=t;if(n)throw n;if(!r)throw new Eo;const{error:a}=await Dt(this.fetch,"GET",`${this.url}/reauthenticate`,{headers:this.headers,jwt:r.access_token});return{data:{user:null,session:null},error:a}})}catch(t){if(Ft(t))return{data:{user:null,session:null},error:t};throw t}}async resend(t){try{const r=`${this.url}/resend`;if("email"in t){const{email:n,type:a,options:i}=t,{error:s}=await Dt(this.fetch,"POST",r,{headers:this.headers,body:{email:n,type:a,gotrue_meta_security:{captcha_token:i==null?void 0:i.captchaToken}},redirectTo:i==null?void 0:i.emailRedirectTo});return{data:{user:null,session:null},error:s}}else if("phone"in t){const{phone:n,type:a,options:i}=t,{data:s,error:o}=await Dt(this.fetch,"POST",r,{headers:this.headers,body:{phone:n,type:a,gotrue_meta_security:{captcha_token:i==null?void 0:i.captchaToken}}});return{data:{user:null,session:null,messageId:s==null?void 0:s.message_id},error:o}}throw new Zd("You must provide either an email or phone number and a type")}catch(r){if(Ft(r))return{data:{user:null,session:null},error:r};throw r}}async getSession(){return await this.initializePromise,await this._acquireLock(-1,async()=>this._useSession(async r=>r))}async _acquireLock(t,r){this._debug("#_acquireLock","begin",t);try{if(this.lockAcquired){const n=this.pendingInLock.length?this.pendingInLock[this.pendingInLock.length-1]:Promise.resolve(),a=(async()=>(await n,await r()))();return this.pendingInLock.push((async()=>{try{await a}catch{}})()),a}return await this.lock(`lock:${this.storageKey}`,t,async()=>{this._debug("#_acquireLock","lock acquired for storage key",this.storageKey);try{this.lockAcquired=!0;const n=r();for(this.pendingInLock.push((async()=>{try{await n}catch{}})()),await n;this.pendingInLock.length;){const a=[...this.pendingInLock];await Promise.all(a),this.pendingInLock.splice(0,a.length)}return await n}finally{this._debug("#_acquireLock","lock released for storage key",this.storageKey),this.lockAcquired=!1}})}finally{this._debug("#_acquireLock","end")}}async _useSession(t){this._debug("#_useSession","begin");try{const r=await this.__loadSession();return await t(r)}finally{this._debug("#_useSession","end")}}async __loadSession(){this._debug("#__loadSession()","begin"),this.lockAcquired||this._debug("#__loadSession()","used outside of an acquired lock!",new Error().stack);try{let t=null;const r=await tp(this.storage,this.storageKey);if(this._debug("#getSession()","session from storage",r),r!==null&&(this._isValidSession(r)?t=r:(this._debug("#getSession()","session from storage is not valid"),await this._removeSession())),!t)return{data:{session:null},error:null};const n=t.expires_at?t.expires_at*1e3-Date.now()<Qg:!1;if(this._debug("#__loadSession()",`session has${n?"":" not"} expired`,"expires_at",t.expires_at),!n){if(this.storage.isServer){let s=this.suppressGetSessionWarning;t=new Proxy(t,{get:(l,c,u)=>(!s&&c==="user"&&(console.warn("Using the user object as returned from supabase.auth.getSession() or from some supabase.auth.onAuthStateChange() events could be insecure! This value comes directly from the storage medium (usually cookies on the server) and may not be authentic. Use supabase.auth.getUser() instead which authenticates the data by contacting the Supabase Auth server."),s=!0,this.suppressGetSessionWarning=!0),Reflect.get(l,c,u))})}return{data:{session:t},error:null}}const{session:a,error:i}=await this._callRefreshToken(t.refresh_token);return i?{data:{session:null},error:i}:{data:{session:a},error:null}}finally{this._debug("#__loadSession()","end")}}async getUser(t){return t?await this._getUser(t):(await this.initializePromise,await this._acquireLock(-1,async()=>await this._getUser()))}async _getUser(t){try{return t?await Dt(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:t,xform:Io}):await this._useSession(async r=>{var n,a,i;const{data:s,error:o}=r;if(o)throw o;return!(!((n=s.session)===null||n===void 0)&&n.access_token)&&!this.hasCustomAuthorizationHeader?{data:{user:null},error:new Eo}:await Dt(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:(i=(a=s.session)===null||a===void 0?void 0:a.access_token)!==null&&i!==void 0?i:void 0,xform:Io})})}catch(r){if(Ft(r))return VF(r)&&(await this._removeSession(),await rp(this.storage,`${this.storageKey}-code-verifier`)),{data:{user:null},error:r};throw r}}async updateUser(t,r={}){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._updateUser(t,r))}async _updateUser(t,r={}){try{return await this._useSession(async n=>{const{data:a,error:i}=n;if(i)throw i;if(!a.session)throw new Eo;const s=a.session;let o=null,l=null;this.flowType==="pkce"&&t.email!=null&&([o,l]=await Wc(this.storage,this.storageKey));const{data:c,error:u}=await Dt(this.fetch,"PUT",`${this.url}/user`,{headers:this.headers,redirectTo:r==null?void 0:r.emailRedirectTo,body:Object.assign(Object.assign({},t),{code_challenge:o,code_challenge_method:l}),jwt:s.access_token,xform:Io});if(u)throw u;return s.user=c.user,await this._saveSession(s),await this._notifyAllSubscribers("USER_UPDATED",s),{data:{user:s.user},error:null}})}catch(n){if(Ft(n))return{data:{user:null},error:n};throw n}}async setSession(t){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._setSession(t))}async _setSession(t){try{if(!t.access_token||!t.refresh_token)throw new Eo;const r=Date.now()/1e3;let n=r,a=!0,i=null;const{payload:s}=e2(t.access_token);if(s.exp&&(n=s.exp,a=n<=r),a){const{session:o,error:l}=await this._callRefreshToken(t.refresh_token);if(l)return{data:{user:null,session:null},error:l};if(!o)return{data:{user:null,session:null},error:null};i=o}else{const{data:o,error:l}=await this._getUser(t.access_token);if(l)throw l;i={access_token:t.access_token,refresh_token:t.refresh_token,user:o.user,token_type:"bearer",expires_in:n-r,expires_at:n},await this._saveSession(i),await this._notifyAllSubscribers("SIGNED_IN",i)}return{data:{user:i.user,session:i},error:null}}catch(r){if(Ft(r))return{data:{session:null,user:null},error:r};throw r}}async refreshSession(t){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._refreshSession(t))}async _refreshSession(t){try{return await this._useSession(async r=>{var n;if(!t){const{data:s,error:o}=r;if(o)throw o;t=(n=s.session)!==null&&n!==void 0?n:void 0}if(!(t!=null&&t.refresh_token))throw new Eo;const{session:a,error:i}=await this._callRefreshToken(t.refresh_token);return i?{data:{user:null,session:null},error:i}:a?{data:{user:a.user,session:a},error:null}:{data:{user:null,session:null},error:null}})}catch(r){if(Ft(r))return{data:{user:null,session:null},error:r};throw r}}async _getSessionFromURL(t,r){try{if(!Ai())throw new ep("No browser detected.");if(t.error||t.error_description||t.error_code)throw new ep(t.error_description||"Error in URL with unspecified error_description",{error:t.error||"unspecified_error",code:t.error_code||"unspecified_code"});switch(r){case"implicit":if(this.flowType==="pkce")throw new Vb("Not a valid PKCE flow url.");break;case"pkce":if(this.flowType==="implicit")throw new ep("Not a valid implicit grant flow url.");break;default:}if(r==="pkce"){if(this._debug("#_initialize()","begin","is PKCE flow",!0),!t.code)throw new Vb("No code detected.");const{data:b,error:w}=await this._exchangeCodeForSession(t.code);if(w)throw w;const T=new URL(window.location.href);return T.searchParams.delete("code"),window.history.replaceState(window.history.state,"",T.toString()),{data:{session:b.session,redirectType:null},error:null}}const{provider_token:n,provider_refresh_token:a,access_token:i,refresh_token:s,expires_in:o,expires_at:l,token_type:c}=t;if(!i||!o||!s||!c)throw new ep("No session defined in URL");const u=Math.round(Date.now()/1e3),f=parseInt(o);let d=u+f;l&&(d=parseInt(l));const h=d-u;h*1e3<=Qc&&console.warn(`@supabase/gotrue-js: Session as retrieved from URL expires in ${h}s, should have been closer to ${f}s`);const g=d-f;u-g>=120?console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued over 120s ago, URL could be stale",g,d,u):u-g<0&&console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued in the future? Check the device clock for skew",g,d,u);const{data:m,error:_}=await this._getUser(i);if(_)throw _;const y={provider_token:n,provider_refresh_token:a,access_token:i,expires_in:f,expires_at:d,refresh_token:s,token_type:c,user:m.user};return window.location.hash="",this._debug("#_getSessionFromURL()","clearing window.location.hash"),{data:{session:y,redirectType:t.type},error:null}}catch(n){if(Ft(n))return{data:{session:null,redirectType:null},error:n};throw n}}_isImplicitGrantCallback(t){return!!(t.access_token||t.error_description)}async _isPKCECallback(t){const r=await tp(this.storage,`${this.storageKey}-code-verifier`);return!!(t.code&&r)}async signOut(t={scope:"global"}){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._signOut(t))}async _signOut({scope:t}={scope:"global"}){return await this._useSession(async r=>{var n;const{data:a,error:i}=r;if(i)return{error:i};const s=(n=a.session)===null||n===void 0?void 0:n.access_token;if(s){const{error:o}=await this.admin.signOut(s,t);if(o&&!($F(o)&&(o.status===404||o.status===401||o.status===403)))return{error:o}}return t!=="others"&&(await this._removeSession(),await rp(this.storage,`${this.storageKey}-code-verifier`)),{error:null}})}onAuthStateChange(t){const r=QF(),n={id:r,callback:t,unsubscribe:()=>{this._debug("#unsubscribe()","state change callback with id removed",r),this.stateChangeEmitters.delete(r)}};return this._debug("#onAuthStateChange()","registered callback with id",r),this.stateChangeEmitters.set(r,n),(async()=>(await this.initializePromise,await this._acquireLock(-1,async()=>{this._emitInitialSession(r)})))(),{data:{subscription:n}}}async _emitInitialSession(t){return await this._useSession(async r=>{var n,a;try{const{data:{session:i},error:s}=r;if(s)throw s;await((n=this.stateChangeEmitters.get(t))===null||n===void 0?void 0:n.callback("INITIAL_SESSION",i)),this._debug("INITIAL_SESSION","callback id",t,"session",i)}catch(i){await((a=this.stateChangeEmitters.get(t))===null||a===void 0?void 0:a.callback("INITIAL_SESSION",null)),this._debug("INITIAL_SESSION","callback id",t,"error",i),console.error(i)}})}async resetPasswordForEmail(t,r={}){let n=null,a=null;this.flowType==="pkce"&&([n,a]=await Wc(this.storage,this.storageKey,!0));try{return await Dt(this.fetch,"POST",`${this.url}/recover`,{body:{email:t,code_challenge:n,code_challenge_method:a,gotrue_meta_security:{captcha_token:r.captchaToken}},headers:this.headers,redirectTo:r.redirectTo})}catch(i){if(Ft(i))return{data:null,error:i};throw i}}async getUserIdentities(){var t;try{const{data:r,error:n}=await this.getUser();if(n)throw n;return{data:{identities:(t=r.user.identities)!==null&&t!==void 0?t:[]},error:null}}catch(r){if(Ft(r))return{data:null,error:r};throw r}}async linkIdentity(t){var r;try{const{data:n,error:a}=await this._useSession(async i=>{var s,o,l,c,u;const{data:f,error:d}=i;if(d)throw d;const h=await this._getUrlForProvider(`${this.url}/user/identities/authorize`,t.provider,{redirectTo:(s=t.options)===null||s===void 0?void 0:s.redirectTo,scopes:(o=t.options)===null||o===void 0?void 0:o.scopes,queryParams:(l=t.options)===null||l===void 0?void 0:l.queryParams,skipBrowserRedirect:!0});return await Dt(this.fetch,"GET",h,{headers:this.headers,jwt:(u=(c=f.session)===null||c===void 0?void 0:c.access_token)!==null&&u!==void 0?u:void 0})});if(a)throw a;return Ai()&&!(!((r=t.options)===null||r===void 0)&&r.skipBrowserRedirect)&&window.location.assign(n==null?void 0:n.url),{data:{provider:t.provider,url:n==null?void 0:n.url},error:null}}catch(n){if(Ft(n))return{data:{provider:t.provider,url:null},error:n};throw n}}async unlinkIdentity(t){try{return await this._useSession(async r=>{var n,a;const{data:i,error:s}=r;if(s)throw s;return await Dt(this.fetch,"DELETE",`${this.url}/user/identities/${t.identity_id}`,{headers:this.headers,jwt:(a=(n=i.session)===null||n===void 0?void 0:n.access_token)!==null&&a!==void 0?a:void 0})})}catch(r){if(Ft(r))return{data:null,error:r};throw r}}async _refreshAccessToken(t){const r=`#_refreshAccessToken(${t.substring(0,5)}...)`;this._debug(r,"begin");try{const n=Date.now();return await r9(async a=>(a>0&&await t9(200*Math.pow(2,a-1)),this._debug(r,"refreshing attempt",a),await Dt(this.fetch,"POST",`${this.url}/token?grant_type=refresh_token`,{body:{refresh_token:t},headers:this.headers,xform:Fs})),(a,i)=>{const s=200*Math.pow(2,a);return i&&Zg(i)&&Date.now()+s-n<Qc})}catch(n){if(this._debug(r,"error",n),Ft(n))return{data:{session:null,user:null},error:n};throw n}finally{this._debug(r,"end")}}_isValidSession(t){return typeof t=="object"&&t!==null&&"access_token"in t&&"refresh_token"in t&&"expires_at"in t}async _handleProviderSignIn(t,r){const n=await this._getUrlForProvider(`${this.url}/authorize`,t,{redirectTo:r.redirectTo,scopes:r.scopes,queryParams:r.queryParams});return this._debug("#_handleProviderSignIn()","provider",t,"options",r,"url",n),Ai()&&!r.skipBrowserRedirect&&window.location.assign(n),{data:{provider:t,url:n},error:null}}async _recoverAndRefresh(){var t;const r="#_recoverAndRefresh()";this._debug(r,"begin");try{const n=await tp(this.storage,this.storageKey);if(this._debug(r,"session from storage",n),!this._isValidSession(n)){this._debug(r,"session is not valid"),n!==null&&await this._removeSession();return}const a=((t=n.expires_at)!==null&&t!==void 0?t:1/0)*1e3-Date.now()<Qg;if(this._debug(r,`session has${a?"":" not"} expired with margin of ${Qg}s`),a){if(this.autoRefreshToken&&n.refresh_token){const{error:i}=await this._callRefreshToken(n.refresh_token);i&&(console.error(i),Zg(i)||(this._debug(r,"refresh failed with a non-retryable error, removing the session",i),await this._removeSession()))}}else await this._notifyAllSubscribers("SIGNED_IN",n)}catch(n){this._debug(r,"error",n),console.error(n);return}finally{this._debug(r,"end")}}async _callRefreshToken(t){var r,n;if(!t)throw new Eo;if(this.refreshingDeferred)return this.refreshingDeferred.promise;const a=`#_callRefreshToken(${t.substring(0,5)}...)`;this._debug(a,"begin");try{this.refreshingDeferred=new gm;const{data:i,error:s}=await this._refreshAccessToken(t);if(s)throw s;if(!i.session)throw new Eo;await this._saveSession(i.session),await this._notifyAllSubscribers("TOKEN_REFRESHED",i.session);const o={session:i.session,error:null};return this.refreshingDeferred.resolve(o),o}catch(i){if(this._debug(a,"error",i),Ft(i)){const s={session:null,error:i};return Zg(i)||await this._removeSession(),(r=this.refreshingDeferred)===null||r===void 0||r.resolve(s),s}throw(n=this.refreshingDeferred)===null||n===void 0||n.reject(i),i}finally{this.refreshingDeferred=null,this._debug(a,"end")}}async _notifyAllSubscribers(t,r,n=!0){const a=`#_notifyAllSubscribers(${t})`;this._debug(a,"begin",r,`broadcast = ${n}`);try{this.broadcastChannel&&n&&this.broadcastChannel.postMessage({event:t,session:r});const i=[],s=Array.from(this.stateChangeEmitters.values()).map(async o=>{try{await o.callback(t,r)}catch(l){i.push(l)}});if(await Promise.all(s),i.length>0){for(let o=0;o<i.length;o+=1)console.error(i[o]);throw i[0]}}finally{this._debug(a,"end")}}async _saveSession(t){this._debug("#_saveSession()",t),this.suppressGetSessionWarning=!0,await Vk(this.storage,this.storageKey,t)}async _removeSession(){this._debug("#_removeSession()"),await rp(this.storage,this.storageKey),await this._notifyAllSubscribers("SIGNED_OUT",null)}_removeVisibilityChangedCallback(){this._debug("#_removeVisibilityChangedCallback()");const t=this.visibilityChangedCallback;this.visibilityChangedCallback=null;try{t&&Ai()&&(window!=null&&window.removeEventListener)&&window.removeEventListener("visibilitychange",t)}catch(r){console.error("removing visibilitychange callback failed",r)}}async _startAutoRefresh(){await this._stopAutoRefresh(),this._debug("#_startAutoRefresh()");const t=setInterval(()=>this._autoRefreshTokenTick(),Qc);this.autoRefreshTicker=t,t&&typeof t=="object"&&typeof t.unref=="function"?t.unref():typeof Deno<"u"&&typeof Deno.unrefTimer=="function"&&Deno.unrefTimer(t),setTimeout(async()=>{await this.initializePromise,await this._autoRefreshTokenTick()},0)}async _stopAutoRefresh(){this._debug("#_stopAutoRefresh()");const t=this.autoRefreshTicker;this.autoRefreshTicker=null,t&&clearInterval(t)}async startAutoRefresh(){this._removeVisibilityChangedCallback(),await this._startAutoRefresh()}async stopAutoRefresh(){this._removeVisibilityChangedCallback(),await this._stopAutoRefresh()}async _autoRefreshTokenTick(){this._debug("#_autoRefreshTokenTick()","begin");try{await this._acquireLock(0,async()=>{try{const t=Date.now();try{return await this._useSession(async r=>{const{data:{session:n}}=r;if(!n||!n.refresh_token||!n.expires_at){this._debug("#_autoRefreshTokenTick()","no session");return}const a=Math.floor((n.expires_at*1e3-t)/Qc);this._debug("#_autoRefreshTokenTick()",`access token expires in ${a} ticks, a tick lasts ${Qc}ms, refresh threshold is ${$x} ticks`),a<=$x&&await this._callRefreshToken(n.refresh_token)})}catch(r){console.error("Auto refresh tick failed with error. This is likely a transient error.",r)}}finally{this._debug("#_autoRefreshTokenTick()","end")}})}catch(t){if(t.isAcquireTimeout||t instanceof zk)this._debug("auto refresh token tick lock not available");else throw t}}async _handleVisibilityChange(){if(this._debug("#_handleVisibilityChange()"),!Ai()||!(window!=null&&window.addEventListener))return this.autoRefreshToken&&this.startAutoRefresh(),!1;try{this.visibilityChangedCallback=async()=>await this._onVisibilityChanged(!1),window==null||window.addEventListener("visibilitychange",this.visibilityChangedCallback),await this._onVisibilityChanged(!0)}catch(t){console.error("_handleVisibilityChange",t)}}async _onVisibilityChanged(t){const r=`#_onVisibilityChanged(${t})`;this._debug(r,"visibilityState",document.visibilityState),document.visibilityState==="visible"?(this.autoRefreshToken&&this._startAutoRefresh(),t||(await this.initializePromise,await this._acquireLock(-1,async()=>{if(document.visibilityState!=="visible"){this._debug(r,"acquired the lock to recover the session, but the browser visibilityState is no longer visible, aborting");return}await this._recoverAndRefresh()}))):document.visibilityState==="hidden"&&this.autoRefreshToken&&this._stopAutoRefresh()}async _getUrlForProvider(t,r,n){const a=[`provider=${encodeURIComponent(r)}`];if(n!=null&&n.redirectTo&&a.push(`redirect_to=${encodeURIComponent(n.redirectTo)}`),n!=null&&n.scopes&&a.push(`scopes=${encodeURIComponent(n.scopes)}`),this.flowType==="pkce"){const[i,s]=await Wc(this.storage,this.storageKey),o=new URLSearchParams({code_challenge:`${encodeURIComponent(i)}`,code_challenge_method:`${encodeURIComponent(s)}`});a.push(o.toString())}if(n!=null&&n.queryParams){const i=new URLSearchParams(n.queryParams);a.push(i.toString())}return n!=null&&n.skipBrowserRedirect&&a.push(`skip_http_redirect=${n.skipBrowserRedirect}`),`${t}?${a.join("&")}`}async _unenroll(t){try{return await this._useSession(async r=>{var n;const{data:a,error:i}=r;return i?{data:null,error:i}:await Dt(this.fetch,"DELETE",`${this.url}/factors/${t.factorId}`,{headers:this.headers,jwt:(n=a==null?void 0:a.session)===null||n===void 0?void 0:n.access_token})})}catch(r){if(Ft(r))return{data:null,error:r};throw r}}async _enroll(t){try{return await this._useSession(async r=>{var n,a;const{data:i,error:s}=r;if(s)return{data:null,error:s};const o=Object.assign({friendly_name:t.friendlyName,factor_type:t.factorType},t.factorType==="phone"?{phone:t.phone}:{issuer:t.issuer}),{data:l,error:c}=await Dt(this.fetch,"POST",`${this.url}/factors`,{body:o,headers:this.headers,jwt:(n=i==null?void 0:i.session)===null||n===void 0?void 0:n.access_token});return c?{data:null,error:c}:(t.factorType==="totp"&&(!((a=l==null?void 0:l.totp)===null||a===void 0)&&a.qr_code)&&(l.totp.qr_code=`data:image/svg+xml;utf-8,${l.totp.qr_code}`),{data:l,error:null})})}catch(r){if(Ft(r))return{data:null,error:r};throw r}}async _verify(t){return this._acquireLock(-1,async()=>{try{return await this._useSession(async r=>{var n;const{data:a,error:i}=r;if(i)return{data:null,error:i};const{data:s,error:o}=await Dt(this.fetch,"POST",`${this.url}/factors/${t.factorId}/verify`,{body:{code:t.code,challenge_id:t.challengeId},headers:this.headers,jwt:(n=a==null?void 0:a.session)===null||n===void 0?void 0:n.access_token});return o?{data:null,error:o}:(await this._saveSession(Object.assign({expires_at:Math.round(Date.now()/1e3)+s.expires_in},s)),await this._notifyAllSubscribers("MFA_CHALLENGE_VERIFIED",s),{data:s,error:o})})}catch(r){if(Ft(r))return{data:null,error:r};throw r}})}async _challenge(t){return this._acquireLock(-1,async()=>{try{return await this._useSession(async r=>{var n;const{data:a,error:i}=r;return i?{data:null,error:i}:await Dt(this.fetch,"POST",`${this.url}/factors/${t.factorId}/challenge`,{body:{channel:t.channel},headers:this.headers,jwt:(n=a==null?void 0:a.session)===null||n===void 0?void 0:n.access_token})})}catch(r){if(Ft(r))return{data:null,error:r};throw r}})}async _challengeAndVerify(t){const{data:r,error:n}=await this._challenge({factorId:t.factorId});return n?{data:null,error:n}:await this._verify({factorId:t.factorId,challengeId:r.id,code:t.code})}async _listFactors(){const{data:{user:t},error:r}=await this.getUser();if(r)return{data:null,error:r};const n=(t==null?void 0:t.factors)||[],a=n.filter(s=>s.factor_type==="totp"&&s.status==="verified"),i=n.filter(s=>s.factor_type==="phone"&&s.status==="verified");return{data:{all:n,totp:a,phone:i},error:null}}async _getAuthenticatorAssuranceLevel(){return this._acquireLock(-1,async()=>await this._useSession(async t=>{var r,n;const{data:{session:a},error:i}=t;if(i)return{data:null,error:i};if(!a)return{data:{currentLevel:null,nextLevel:null,currentAuthenticationMethods:[]},error:null};const{payload:s}=e2(a.access_token);let o=null;s.aal&&(o=s.aal);let l=o;((n=(r=a.user.factors)===null||r===void 0?void 0:r.filter(f=>f.status==="verified"))!==null&&n!==void 0?n:[]).length>0&&(l="aal2");const u=s.amr||[];return{data:{currentLevel:o,nextLevel:l,currentAuthenticationMethods:u},error:null}}))}async fetchJwk(t,r={keys:[]}){let n=r.keys.find(s=>s.kid===t);if(n||(n=this.jwks.keys.find(s=>s.kid===t),n&&this.jwks_cached_at+BF>Date.now()))return n;const{data:a,error:i}=await Dt(this.fetch,"GET",`${this.url}/.well-known/jwks.json`,{headers:this.headers});if(i)throw i;if(!a.keys||a.keys.length===0)throw new bf("JWKS is empty");if(this.jwks=a,this.jwks_cached_at=Date.now(),n=a.keys.find(s=>s.kid===t),!n)throw new bf("No matching signing key found in JWKS");return n}async getClaims(t,r={keys:[]}){try{let n=t;if(!n){const{data:h,error:g}=await this.getSession();if(g||!h.session)return{data:null,error:g};n=h.session.access_token}const{header:a,payload:i,signature:s,raw:{header:o,payload:l}}=e2(n);if(c9(i.exp),!a.kid||a.alg==="HS256"||!("crypto"in globalThis&&"subtle"in globalThis.crypto)){const{error:h}=await this.getUser(n);if(h)throw h;return{data:{claims:i,header:a,signature:s},error:null}}const c=u9(a.alg),u=await this.fetchJwk(a.kid,r),f=await crypto.subtle.importKey("jwk",u,c,!0,["verify"]);if(!await crypto.subtle.verify(c,f,s,XF(`${o}.${l}`)))throw new bf("Invalid JWT signature");return{data:{claims:i,header:a,signature:s},error:null}}catch(n){if(Ft(n))return{data:null,error:n};throw n}}}nh.nextInstanceID=0;const T9=nh;class C9 extends T9{constructor(t){super(t)}}var N9=function(e,t,r,n){function a(i){return i instanceof r?i:new r(function(s){s(i)})}return new(r||(r=Promise))(function(i,s){function o(u){try{c(n.next(u))}catch(f){s(f)}}function l(u){try{c(n.throw(u))}catch(f){s(f)}}function c(u){u.done?i(u.value):a(u.value).then(o,l)}c((n=n.apply(e,t||[])).next())})};class P9{constructor(t,r,n){var a,i,s;if(this.supabaseUrl=t,this.supabaseKey=r,!t)throw new Error("supabaseUrl is required.");if(!r)throw new Error("supabaseKey is required.");const o=OF(t),l=new URL(o);this.realtimeUrl=new URL("realtime/v1",l),this.realtimeUrl.protocol=this.realtimeUrl.protocol.replace("http","ws"),this.authUrl=new URL("auth/v1",l),this.storageUrl=new URL("storage/v1",l),this.functionsUrl=new URL("functions/v1",l);const c=`sb-${l.hostname.split(".")[0]}-auth-token`,u={db:EF,realtime:TF,auth:Object.assign(Object.assign({},AF),{storageKey:c}),global:kF},f=IF(n??{},u);this.storageKey=(a=f.auth.storageKey)!==null&&a!==void 0?a:"",this.headers=(i=f.global.headers)!==null&&i!==void 0?i:{},f.accessToken?(this.accessToken=f.accessToken,this.auth=new Proxy({},{get:(d,h)=>{throw new Error(`@supabase/supabase-js: Supabase Client is configured with the accessToken option, accessing supabase.auth.${String(h)} is not possible`)}})):this.auth=this._initSupabaseAuthClient((s=f.auth)!==null&&s!==void 0?s:{},this.headers,f.global.fetch),this.fetch=LF(r,this._getAccessToken.bind(this),f.global.fetch),this.realtime=this._initRealtimeClient(Object.assign({headers:this.headers,accessToken:this._getAccessToken.bind(this)},f.realtime)),this.rest=new GL(new URL("rest/v1",l).href,{headers:this.headers,schema:f.db.schema,fetch:this.fetch}),f.accessToken||this._listenForAuthEvents()}get functions(){return new SL(this.functionsUrl.href,{headers:this.headers,customFetch:this.fetch})}get storage(){return new bF(this.storageUrl.href,this.headers,this.fetch)}from(t){return this.rest.from(t)}schema(t){return this.rest.schema(t)}rpc(t,r={},n={}){return this.rest.rpc(t,r,n)}channel(t,r={config:{}}){return this.realtime.channel(t,r)}getChannels(){return this.realtime.getChannels()}removeChannel(t){return this.realtime.removeChannel(t)}removeAllChannels(){return this.realtime.removeAllChannels()}_getAccessToken(){var t,r;return N9(this,void 0,void 0,function*(){if(this.accessToken)return yield this.accessToken();const{data:n}=yield this.auth.getSession();return(r=(t=n.session)===null||t===void 0?void 0:t.access_token)!==null&&r!==void 0?r:null})}_initSupabaseAuthClient({autoRefreshToken:t,persistSession:r,detectSessionInUrl:n,storage:a,storageKey:i,flowType:s,lock:o,debug:l},c,u){const f={Authorization:`Bearer ${this.supabaseKey}`,apikey:`${this.supabaseKey}`};return new C9({url:this.authUrl.href,headers:Object.assign(Object.assign({},f),c),storageKey:i,autoRefreshToken:t,persistSession:r,detectSessionInUrl:n,storage:a,flowType:s,lock:o,debug:l,fetch:u,hasCustomAuthorizationHeader:"Authorization"in this.headers})}_initRealtimeClient(t){return new lF(this.realtimeUrl.href,Object.assign(Object.assign({},t),{params:Object.assign({apikey:this.supabaseKey},t==null?void 0:t.params)}))}_listenForAuthEvents(){return this.auth.onAuthStateChange((r,n)=>{this._handleTokenChanged(r,"CLIENT",n==null?void 0:n.access_token)})}_handleTokenChanged(t,r,n){(t==="TOKEN_REFRESHED"||t==="SIGNED_IN")&&this.changedAccessToken!==n?this.changedAccessToken=n:t==="SIGNED_OUT"&&(this.realtime.setAuth(),r=="STORAGE"&&this.auth.signOut(),this.changedAccessToken=void 0)}}const L9=(e,t,r)=>new P9(e,t,r),F9="https://sstfgrbvltvxcmutgsmb.supabase.co",O9="eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InNzdGZncmJ2bHR2eGNtdXRnc21iIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTE1NzkzNDYsImV4cCI6MjA2NzE1NTM0Nn0.dYYclh7BHivtmhss8ioGYE4n2kdAEH_Isq4sNXlY670",ir=L9(F9,O9),I9={};var Hx=null;function D9(e){try{return crypto.getRandomValues(new Uint8Array(e))}catch{}try{return I9.randomBytes(e)}catch{}if(!Hx)throw Error("Neither WebCryptoAPI nor a crypto module is available. Use bcrypt.setRandomFallback to set an alternative");return Hx(e)}function j9(e){Hx=e}function My(e,t){if(e=e||By,typeof e!="number")throw Error("Illegal arguments: "+typeof e+", "+typeof t);e<4?e=4:e>31&&(e=31);var r=[];return r.push("$2b$"),e<10&&r.push("0"),r.push(e.toString()),r.push("$"),r.push(v1(D9(ah),ah)),r.join("")}function Hk(e,t,r){if(typeof t=="function"&&(r=t,t=void 0),typeof e=="function"&&(r=e,e=void 0),typeof e>"u")e=By;else if(typeof e!="number")throw Error("illegal arguments: "+typeof e);function n(a){Di(function(){try{a(null,My(e))}catch(i){a(i)}})}if(r){if(typeof r!="function")throw Error("Illegal callback: "+typeof r);n(r)}else return new Promise(function(a,i){n(function(s,o){if(s){i(s);return}a(o)})})}function Wk(e,t){if(typeof t>"u"&&(t=By),typeof t=="number"&&(t=My(t)),typeof e!="string"||typeof t!="string")throw Error("Illegal arguments: "+typeof e+", "+typeof t);return Wx(e,t)}function qk(e,t,r,n){function a(i){typeof e=="string"&&typeof t=="number"?Hk(t,function(s,o){Wx(e,o,i,n)}):typeof e=="string"&&typeof t=="string"?Wx(e,t,i,n):Di(i.bind(this,Error("Illegal arguments: "+typeof e+", "+typeof t)))}if(r){if(typeof r!="function")throw Error("Illegal callback: "+typeof r);a(r)}else return new Promise(function(i,s){a(function(o,l){if(o){s(o);return}i(l)})})}function Gk(e,t){for(var r=e.length^t.length,n=0;n<e.length;++n)r|=e.charCodeAt(n)^t.charCodeAt(n);return r===0}function R9(e,t){if(typeof e!="string"||typeof t!="string")throw Error("Illegal arguments: "+typeof e+", "+typeof t);return t.length!==60?!1:Gk(Wk(e,t.substring(0,t.length-31)),t)}function M9(e,t,r,n){function a(i){if(typeof e!="string"||typeof t!="string"){Di(i.bind(this,Error("Illegal arguments: "+typeof e+", "+typeof t)));return}if(t.length!==60){Di(i.bind(this,null,!1));return}qk(e,t.substring(0,29),function(s,o){s?i(s):i(null,Gk(o,t))},n)}if(r){if(typeof r!="function")throw Error("Illegal callback: "+typeof r);a(r)}else return new Promise(function(i,s){a(function(o,l){if(o){s(o);return}i(l)})})}function B9(e){if(typeof e!="string")throw Error("Illegal arguments: "+typeof e);return parseInt(e.split("$")[2],10)}function U9(e){if(typeof e!="string")throw Error("Illegal arguments: "+typeof e);if(e.length!==60)throw Error("Illegal hash length: "+e.length+" != 60");return e.substring(0,29)}function $9(e){if(typeof e!="string")throw Error("Illegal arguments: "+typeof e);return Kk(e)>72}var Di=typeof process<"u"&&process&&typeof process.nextTick=="function"?typeof setImmediate=="function"?setImmediate:process.nextTick:setTimeout;function Kk(e){for(var t=0,r=0,n=0;n<e.length;++n)r=e.charCodeAt(n),r<128?t+=1:r<2048?t+=2:(r&64512)===55296&&(e.charCodeAt(n+1)&64512)===56320?(++n,t+=4):t+=3;return t}function V9(e){for(var t=0,r,n,a=new Array(Kk(e)),i=0,s=e.length;i<s;++i)r=e.charCodeAt(i),r<128?a[t++]=r:r<2048?(a[t++]=r>>6|192,a[t++]=r&63|128):(r&64512)===55296&&((n=e.charCodeAt(i+1))&64512)===56320?(r=65536+((r&1023)<<10)+(n&1023),++i,a[t++]=r>>18|240,a[t++]=r>>12&63|128,a[t++]=r>>6&63|128,a[t++]=r&63|128):(a[t++]=r>>12|224,a[t++]=r>>6&63|128,a[t++]=r&63|128);return a}var Kc="./ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789".split(""),bo=[-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,0,1,54,55,56,57,58,59,60,61,62,63,-1,-1,-1,-1,-1,-1,-1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,-1,-1,-1,-1,-1,-1,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,-1,-1,-1,-1,-1];function v1(e,t){var r=0,n=[],a,i;if(t<=0||t>e.length)throw Error("Illegal len: "+t);for(;r<t;){if(a=e[r++]&255,n.push(Kc[a>>2&63]),a=(a&3)<<4,r>=t){n.push(Kc[a&63]);break}if(i=e[r++]&255,a|=i>>4&15,n.push(Kc[a&63]),a=(i&15)<<2,r>=t){n.push(Kc[a&63]);break}i=e[r++]&255,a|=i>>6&3,n.push(Kc[a&63]),n.push(Kc[i&63])}return n.join("")}function Xk(e,t){var r=0,n=e.length,a=0,i=[],s,o,l,c,u,f;if(t<=0)throw Error("Illegal len: "+t);for(;r<n-1&&a<t&&(f=e.charCodeAt(r++),s=f<bo.length?bo[f]:-1,f=e.charCodeAt(r++),o=f<bo.length?bo[f]:-1,!(s==-1||o==-1||(u=s<<2>>>0,u|=(o&48)>>4,i.push(String.fromCharCode(u)),++a>=t||r>=n)||(f=e.charCodeAt(r++),l=f<bo.length?bo[f]:-1,l==-1)||(u=(o&15)<<4>>>0,u|=(l&60)>>2,i.push(String.fromCharCode(u)),++a>=t||r>=n)));)f=e.charCodeAt(r++),c=f<bo.length?bo[f]:-1,u=(l&3)<<6>>>0,u|=c,i.push(String.fromCharCode(u)),++a;var d=[];for(r=0;r<a;r++)d.push(i[r].charCodeAt(0));return d}var ah=16,By=10,z9=16,H9=100,Jb=[608135816,2242054355,320440878,57701188,2752067618,698298832,137296536,3964562569,1160258022,953160567,3193202383,887688300,3232508343,3380367581,1065670069,3041331479,2450970073,2306472731],Qb=[3509652390,2564797868,805139163,3491422135,3101798381,1780907670,3128725573,4046225305,614570311,3012652279,134345442,2240740374,1667834072,1901547113,2757295779,4103290238,227898511,1921955416,1904987480,2182433518,2069144605,3260701109,2620446009,720527379,3318853667,677414384,3393288472,3101374703,2390351024,1614419982,1822297739,2954791486,3608508353,3174124327,2024746970,1432378464,3864339955,2857741204,1464375394,1676153920,1439316330,715854006,3033291828,289532110,2706671279,2087905683,3018724369,1668267050,732546397,1947742710,3462151702,2609353502,2950085171,1814351708,2050118529,680887927,999245976,1800124847,3300911131,1713906067,1641548236,4213287313,1216130144,1575780402,4018429277,3917837745,3693486850,3949271944,596196993,3549867205,258830323,2213823033,772490370,2760122372,1774776394,2652871518,566650946,4142492826,1728879713,2882767088,1783734482,3629395816,2517608232,2874225571,1861159788,326777828,3124490320,2130389656,2716951837,967770486,1724537150,2185432712,2364442137,1164943284,2105845187,998989502,3765401048,2244026483,1075463327,1455516326,1322494562,910128902,469688178,1117454909,936433444,3490320968,3675253459,1240580251,122909385,2157517691,634681816,4142456567,3825094682,3061402683,2540495037,79693498,3249098678,1084186820,1583128258,426386531,1761308591,1047286709,322548459,995290223,1845252383,2603652396,3431023940,2942221577,3202600964,3727903485,1712269319,422464435,3234572375,1170764815,3523960633,3117677531,1434042557,442511882,3600875718,1076654713,1738483198,4213154764,2393238008,3677496056,1014306527,4251020053,793779912,2902807211,842905082,4246964064,1395751752,1040244610,2656851899,3396308128,445077038,3742853595,3577915638,679411651,2892444358,2354009459,1767581616,3150600392,3791627101,3102740896,284835224,4246832056,1258075500,768725851,2589189241,3069724005,3532540348,1274779536,3789419226,2764799539,1660621633,3471099624,4011903706,913787905,3497959166,737222580,2514213453,2928710040,3937242737,1804850592,3499020752,2949064160,2386320175,2390070455,2415321851,4061277028,2290661394,2416832540,1336762016,1754252060,3520065937,3014181293,791618072,3188594551,3933548030,2332172193,3852520463,3043980520,413987798,3465142937,3030929376,4245938359,2093235073,3534596313,375366246,2157278981,2479649556,555357303,3870105701,2008414854,3344188149,4221384143,3956125452,2067696032,3594591187,2921233993,2428461,544322398,577241275,1471733935,610547355,4027169054,1432588573,1507829418,2025931657,3646575487,545086370,48609733,2200306550,1653985193,298326376,1316178497,3007786442,2064951626,458293330,2589141269,3591329599,3164325604,727753846,2179363840,146436021,1461446943,4069977195,705550613,3059967265,3887724982,4281599278,3313849956,1404054877,2845806497,146425753,1854211946,1266315497,3048417604,3681880366,3289982499,290971e4,1235738493,2632868024,2414719590,3970600049,1771706367,1449415276,3266420449,422970021,1963543593,2690192192,3826793022,1062508698,1531092325,1804592342,2583117782,2714934279,4024971509,1294809318,4028980673,1289560198,2221992742,1669523910,35572830,157838143,1052438473,1016535060,1802137761,1753167236,1386275462,3080475397,2857371447,1040679964,2145300060,2390574316,1461121720,2956646967,4031777805,4028374788,33600511,2920084762,1018524850,629373528,3691585981,3515945977,2091462646,2486323059,586499841,988145025,935516892,3367335476,2599673255,2839830854,265290510,3972581182,2759138881,3795373465,1005194799,847297441,406762289,1314163512,1332590856,1866599683,4127851711,750260880,613907577,1450815602,3165620655,3734664991,3650291728,3012275730,3704569646,1427272223,778793252,1343938022,2676280711,2052605720,1946737175,3164576444,3914038668,3967478842,3682934266,1661551462,3294938066,4011595847,840292616,3712170807,616741398,312560963,711312465,1351876610,322626781,1910503582,271666773,2175563734,1594956187,70604529,3617834859,1007753275,1495573769,4069517037,2549218298,2663038764,504708206,2263041392,3941167025,2249088522,1514023603,1998579484,1312622330,694541497,2582060303,2151582166,1382467621,776784248,2618340202,3323268794,2497899128,2784771155,503983604,4076293799,907881277,423175695,432175456,1378068232,4145222326,3954048622,3938656102,3820766613,2793130115,2977904593,26017576,3274890735,3194772133,1700274565,1756076034,4006520079,3677328699,720338349,1533947780,354530856,688349552,3973924725,1637815568,332179504,3949051286,53804574,2852348879,3044236432,1282449977,3583942155,3416972820,4006381244,1617046695,2628476075,3002303598,1686838959,431878346,2686675385,1700445008,1080580658,1009431731,832498133,3223435511,2605976345,2271191193,2516031870,1648197032,4164389018,2548247927,300782431,375919233,238389289,3353747414,2531188641,2019080857,1475708069,455242339,2609103871,448939670,3451063019,1395535956,2413381860,1841049896,1491858159,885456874,4264095073,4001119347,1565136089,3898914787,1108368660,540939232,1173283510,2745871338,3681308437,4207628240,3343053890,4016749493,1699691293,1103962373,3625875870,2256883143,3830138730,1031889488,3479347698,1535977030,4236805024,3251091107,2132092099,1774941330,1199868427,1452454533,157007616,2904115357,342012276,595725824,1480756522,206960106,497939518,591360097,863170706,2375253569,3596610801,1814182875,2094937945,3421402208,1082520231,3463918190,2785509508,435703966,3908032597,1641649973,2842273706,3305899714,1510255612,2148256476,2655287854,3276092548,4258621189,236887753,3681803219,274041037,1734335097,3815195456,3317970021,1899903192,1026095262,4050517792,356393447,2410691914,3873677099,3682840055,3913112168,2491498743,4132185628,2489919796,1091903735,1979897079,3170134830,3567386728,3557303409,857797738,1136121015,1342202287,507115054,2535736646,337727348,3213592640,1301675037,2528481711,1895095763,1721773893,3216771564,62756741,2142006736,835421444,2531993523,1442658625,3659876326,2882144922,676362277,1392781812,170690266,3921047035,1759253602,3611846912,1745797284,664899054,1329594018,3901205900,3045908486,2062866102,2865634940,3543621612,3464012697,1080764994,553557557,3656615353,3996768171,991055499,499776247,1265440854,648242737,3940784050,980351604,3713745714,1749149687,3396870395,4211799374,3640570775,1161844396,3125318951,1431517754,545492359,4268468663,3499529547,1437099964,2702547544,3433638243,2581715763,2787789398,1060185593,1593081372,2418618748,4260947970,69676912,2159744348,86519011,2512459080,3838209314,1220612927,3339683548,133810670,1090789135,1078426020,1569222167,845107691,3583754449,4072456591,1091646820,628848692,1613405280,3757631651,526609435,236106946,48312990,2942717905,3402727701,1797494240,859738849,992217954,4005476642,2243076622,3870952857,3732016268,765654824,3490871365,2511836413,1685915746,3888969200,1414112111,2273134842,3281911079,4080962846,172450625,2569994100,980381355,4109958455,2819808352,2716589560,2568741196,3681446669,3329971472,1835478071,660984891,3704678404,4045999559,3422617507,3040415634,1762651403,1719377915,3470491036,2693910283,3642056355,3138596744,1364962596,2073328063,1983633131,926494387,3423689081,2150032023,4096667949,1749200295,3328846651,309677260,2016342300,1779581495,3079819751,111262694,1274766160,443224088,298511866,1025883608,3806446537,1145181785,168956806,3641502830,3584813610,1689216846,3666258015,3200248200,1692713982,2646376535,4042768518,1618508792,1610833997,3523052358,4130873264,2001055236,3610705100,2202168115,4028541809,2961195399,1006657119,2006996926,3186142756,1430667929,3210227297,1314452623,4074634658,4101304120,2273951170,1399257539,3367210612,3027628629,1190975929,2062231137,2333990788,2221543033,2438960610,1181637006,548689776,2362791313,3372408396,3104550113,3145860560,296247880,1970579870,3078560182,3769228297,1714227617,3291629107,3898220290,166772364,1251581989,493813264,448347421,195405023,2709975567,677966185,3703036547,1463355134,2715995803,1338867538,1343315457,2802222074,2684532164,233230375,2599980071,2000651841,3277868038,1638401717,4028070440,3237316320,6314154,819756386,300326615,590932579,1405279636,3267499572,3150704214,2428286686,3959192993,3461946742,1862657033,1266418056,963775037,2089974820,2263052895,1917689273,448879540,3550394620,3981727096,150775221,3627908307,1303187396,508620638,2975983352,2726630617,1817252668,1876281319,1457606340,908771278,3720792119,3617206836,2455994898,1729034894,1080033504,976866871,3556439503,2881648439,1522871579,1555064734,1336096578,3548522304,2579274686,3574697629,3205460757,3593280638,3338716283,3079412587,564236357,2993598910,1781952180,1464380207,3163844217,3332601554,1699332808,1393555694,1183702653,3581086237,1288719814,691649499,2847557200,2895455976,3193889540,2717570544,1781354906,1676643554,2592534050,3230253752,1126444790,2770207658,2633158820,2210423226,2615765581,2414155088,3127139286,673620729,2805611233,1269405062,4015350505,3341807571,4149409754,1057255273,2012875353,2162469141,2276492801,2601117357,993977747,3918593370,2654263191,753973209,36408145,2530585658,25011837,3520020182,2088578344,530523599,2918365339,1524020338,1518925132,3760827505,3759777254,1202760957,3985898139,3906192525,674977740,4174734889,2031300136,2019492241,3983892565,4153806404,3822280332,352677332,2297720250,60907813,90501309,3286998549,1016092578,2535922412,2839152426,457141659,509813237,4120667899,652014361,1966332200,2975202805,55981186,2327461051,676427537,3255491064,2882294119,3433927263,1307055953,942726286,933058658,2468411793,3933900994,4215176142,1361170020,2001714738,2830558078,3274259782,1222529897,1679025792,2729314320,3714953764,1770335741,151462246,3013232138,1682292957,1483529935,471910574,1539241949,458788160,3436315007,1807016891,3718408830,978976581,1043663428,3165965781,1927990952,4200891579,2372276910,3208408903,3533431907,1412390302,2931980059,4132332400,1947078029,3881505623,4168226417,2941484381,1077988104,1320477388,886195818,18198404,3786409e3,2509781533,112762804,3463356488,1866414978,891333506,18488651,661792760,1628790961,3885187036,3141171499,876946877,2693282273,1372485963,791857591,2686433993,3759982718,3167212022,3472953795,2716379847,445679433,3561995674,3504004811,3574258232,54117162,3331405415,2381918588,3769707343,4154350007,1140177722,4074052095,668550556,3214352940,367459370,261225585,2610173221,4209349473,3468074219,3265815641,314222801,3066103646,3808782860,282218597,3406013506,3773591054,379116347,1285071038,846784868,2669647154,3771962079,3550491691,2305946142,453669953,1268987020,3317592352,3279303384,3744833421,2610507566,3859509063,266596637,3847019092,517658769,3462560207,3443424879,370717030,4247526661,2224018117,4143653529,4112773975,2788324899,2477274417,1456262402,2901442914,1517677493,1846949527,2295493580,3734397586,2176403920,1280348187,1908823572,3871786941,846861322,1172426758,3287448474,3383383037,1655181056,3139813346,901632758,1897031941,2986607138,3066810236,3447102507,1393639104,373351379,950779232,625454576,3124240540,4148612726,2007998917,544563296,2244738638,2330496472,2058025392,1291430526,424198748,50039436,29584100,3605783033,2429876329,2791104160,1057563949,3255363231,3075367218,3463963227,1469046755,985887462],Yk=[1332899944,1700884034,1701343084,1684370003,1668446532,1869963892];function ih(e,t,r,n){var a,i=e[t],s=e[t+1];return i^=r[0],a=n[i>>>24],a+=n[256|i>>16&255],a^=n[512|i>>8&255],a+=n[768|i&255],s^=a^r[1],a=n[s>>>24],a+=n[256|s>>16&255],a^=n[512|s>>8&255],a+=n[768|s&255],i^=a^r[2],a=n[i>>>24],a+=n[256|i>>16&255],a^=n[512|i>>8&255],a+=n[768|i&255],s^=a^r[3],a=n[s>>>24],a+=n[256|s>>16&255],a^=n[512|s>>8&255],a+=n[768|s&255],i^=a^r[4],a=n[i>>>24],a+=n[256|i>>16&255],a^=n[512|i>>8&255],a+=n[768|i&255],s^=a^r[5],a=n[s>>>24],a+=n[256|s>>16&255],a^=n[512|s>>8&255],a+=n[768|s&255],i^=a^r[6],a=n[i>>>24],a+=n[256|i>>16&255],a^=n[512|i>>8&255],a+=n[768|i&255],s^=a^r[7],a=n[s>>>24],a+=n[256|s>>16&255],a^=n[512|s>>8&255],a+=n[768|s&255],i^=a^r[8],a=n[i>>>24],a+=n[256|i>>16&255],a^=n[512|i>>8&255],a+=n[768|i&255],s^=a^r[9],a=n[s>>>24],a+=n[256|s>>16&255],a^=n[512|s>>8&255],a+=n[768|s&255],i^=a^r[10],a=n[i>>>24],a+=n[256|i>>16&255],a^=n[512|i>>8&255],a+=n[768|i&255],s^=a^r[11],a=n[s>>>24],a+=n[256|s>>16&255],a^=n[512|s>>8&255],a+=n[768|s&255],i^=a^r[12],a=n[i>>>24],a+=n[256|i>>16&255],a^=n[512|i>>8&255],a+=n[768|i&255],s^=a^r[13],a=n[s>>>24],a+=n[256|s>>16&255],a^=n[512|s>>8&255],a+=n[768|s&255],i^=a^r[14],a=n[i>>>24],a+=n[256|i>>16&255],a^=n[512|i>>8&255],a+=n[768|i&255],s^=a^r[15],a=n[s>>>24],a+=n[256|s>>16&255],a^=n[512|s>>8&255],a+=n[768|s&255],i^=a^r[16],e[t]=s^r[z9+1],e[t+1]=i,e}function Zc(e,t){for(var r=0,n=0;r<4;++r)n=n<<8|e[t]&255,t=(t+1)%e.length;return{key:n,offp:t}}function Zb(e,t,r){for(var n=0,a=[0,0],i=t.length,s=r.length,o,l=0;l<i;l++)o=Zc(e,n),n=o.offp,t[l]=t[l]^o.key;for(l=0;l<i;l+=2)a=ih(a,0,t,r),t[l]=a[0],t[l+1]=a[1];for(l=0;l<s;l+=2)a=ih(a,0,t,r),r[l]=a[0],r[l+1]=a[1]}function W9(e,t,r,n){for(var a=0,i=[0,0],s=r.length,o=n.length,l,c=0;c<s;c++)l=Zc(t,a),a=l.offp,r[c]=r[c]^l.key;for(a=0,c=0;c<s;c+=2)l=Zc(e,a),a=l.offp,i[0]^=l.key,l=Zc(e,a),a=l.offp,i[1]^=l.key,i=ih(i,0,r,n),r[c]=i[0],r[c+1]=i[1];for(c=0;c<o;c+=2)l=Zc(e,a),a=l.offp,i[0]^=l.key,l=Zc(e,a),a=l.offp,i[1]^=l.key,i=ih(i,0,r,n),n[c]=i[0],n[c+1]=i[1]}function e4(e,t,r,n,a){var i=Yk.slice(),s=i.length,o;if(r<4||r>31)if(o=Error("Illegal number of rounds (4-31): "+r),n){Di(n.bind(this,o));return}else throw o;if(t.length!==ah)if(o=Error("Illegal salt length: "+t.length+" != "+ah),n){Di(n.bind(this,o));return}else throw o;r=1<<r>>>0;var l,c,u=0,f;typeof Int32Array=="function"?(l=new Int32Array(Jb),c=new Int32Array(Qb)):(l=Jb.slice(),c=Qb.slice()),W9(t,e,l,c);function d(){if(a&&a(u/r),u<r)for(var g=Date.now();u<r&&(u=u+1,Zb(e,l,c),Zb(t,l,c),!(Date.now()-g>H9)););else{for(u=0;u<64;u++)for(f=0;f<s>>1;f++)ih(i,f<<1,l,c);var m=[];for(u=0;u<s;u++)m.push((i[u]>>24&255)>>>0),m.push((i[u]>>16&255)>>>0),m.push((i[u]>>8&255)>>>0),m.push((i[u]&255)>>>0);if(n){n(null,m);return}else return m}n&&Di(d)}if(typeof n<"u")d();else for(var h;;)if(typeof(h=d())<"u")return h||[]}function Wx(e,t,r,n){var a;if(typeof e!="string"||typeof t!="string")if(a=Error("Invalid string / salt: Not a string"),r){Di(r.bind(this,a));return}else throw a;var i,s;if(t.charAt(0)!=="$"||t.charAt(1)!=="2")if(a=Error("Invalid salt version: "+t.substring(0,2)),r){Di(r.bind(this,a));return}else throw a;if(t.charAt(2)==="$")i="\0",s=3;else{if(i=t.charAt(2),i!=="a"&&i!=="b"&&i!=="y"||t.charAt(3)!=="$")if(a=Error("Invalid salt revision: "+t.substring(2,4)),r){Di(r.bind(this,a));return}else throw a;s=4}if(t.charAt(s+2)>"$")if(a=Error("Missing salt rounds"),r){Di(r.bind(this,a));return}else throw a;var o=parseInt(t.substring(s,s+1),10)*10,l=parseInt(t.substring(s+1,s+2),10),c=o+l,u=t.substring(s+3,s+25);e+=i>="a"?"\0":"";var f=V9(e),d=Xk(u,ah);function h(g){var m=[];return m.push("$2"),i>="a"&&m.push(i),m.push("$"),c<10&&m.push("0"),m.push(c.toString()),m.push("$"),m.push(v1(d,d.length)),m.push(v1(g,Yk.length*4-1)),m.join("")}if(typeof r>"u")return h(e4(f,d,c));e4(f,d,c,function(g,m){g?r(g,null):r(null,h(m))},n)}function q9(e,t){return v1(e,t)}function G9(e,t){return Xk(e,t)}const qx={setRandomFallback:j9,genSaltSync:My,genSalt:Hk,hashSync:Wk,hash:qk,compareSync:R9,compare:M9,getRounds:B9,getSalt:U9,truncates:$9,encodeBase64:q9,decodeBase64:G9},Uy=ie.createContext(void 0);function K9({children:e}){const[t,r]=ie.useState(null),[n,a]=ie.useState(!0);ie.useEffect(()=>{const o=localStorage.getItem("currentUser");if(localStorage.getItem("isLoggedIn")==="true"&&o){const c=JSON.parse(o);r(c)}a(!1)},[]);const i=async(o,l)=>{try{a(!0);const{data:c,error:u}=await ir.from("usuarios").select("id, username, role, full_name, email, active, password_hash").eq("username",o).eq("active",!0).single();if(u||!c)return console.error("Usuario no encontrado:",u),st.error("Usuario o contrasea incorrectos"),!1;if(!await qx.compare(l,c.password_hash))return st.error("Usuario o contrasea incorrectos"),!1;await ir.from("usuarios").update({last_login:new Date().toISOString()}).eq("id",c.id);const d={id:c.id,username:c.username,role:c.role,full_name:c.full_name,email:c.email};return r(d),localStorage.setItem("isLoggedIn","true"),localStorage.setItem("currentUser",JSON.stringify(d)),st.success(`Bienvenido, ${c.full_name||c.username}`),!0}catch(c){return console.error("Error durante el login:",c),st.error("Error durante el inicio de sesin"),!1}finally{a(!1)}},s=()=>{r(null),localStorage.removeItem("isLoggedIn"),localStorage.removeItem("currentUser"),st.success("Sesin cerrada correctamente")};return v.jsx(Uy.Provider,{value:{user:t,isAuthenticated:!!t,isLoading:n,login:i,logout:s},children:e})}const X9=()=>{const e=ie.useContext(Uy);if(e===void 0)throw new Error("useAuth must be used within an AuthProvider");return e},Jk=async()=>{const e=[];let t=!1,r=!1;try{console.log(" Verificando conexin a Supabase...");const{data:n,error:a}=await ir.from("usuarios").select("count",{count:"exact",head:!0});if(a)return console.error(" Error de conexin:",a.message),e.push(`Connection error: ${a.message}`),{connected:t,tablesExist:r,errors:e};t=!0,console.log(" Conexin a Supabase exitosa");const i=[{name:"usuarios",columns:["id","username","password_hash","role","active"]},{name:"articulos",columns:["id","nombre","costo","activo"]},{name:"movimientos",columns:["id","id_articulo","tipo","cantidad","fecha","descripcion","costo_unitario"]}];let s=!0;for(const o of i)try{const{data:l,error:c}=await ir.from(o.name).select(o.columns.join(", ")).limit(1);c?(console.error(` Error en tabla ${o.name}:`,c.message),e.push(`${o.name} table error: ${c.message}`),s=!1):console.log(` Tabla ${o.name} verificada correctamente`)}catch(l){console.error(` Error verificando tabla ${o.name}:`,l),e.push(`${o.name} verification error: ${l instanceof Error?l.message:"Unknown error"}`),s=!1}r=s,console.log(r?" Todas las tablas verificadas correctamente":" Algunas tablas no existen o tienen errores")}catch(n){console.error(" Error inesperado:",n),e.push(`Unexpected error: ${n instanceof Error?n.message:"Unknown error"}`)}return{connected:t,tablesExist:r,errors:e}},Y9=async()=>{try{console.log(" Obteniendo estadsticas de la base de datos...");const[e,t,r]=await Promise.all([ir.from("usuarios").select("*",{count:"exact",head:!0}),ir.from("articulos").select("*",{count:"exact",head:!0}),ir.from("movimientos").select("*",{count:"exact",head:!0})]),n={usuarios:e.count||0,articulos:t.count||0,movimientos:r.count||0};return console.log(" Estadsticas obtenidas:",n),n}catch(e){return console.error("Error getting database stats:",e),{usuarios:0,articulos:0,movimientos:0}}},J9=async()=>{const e=[];try{console.log(" Validando integridad de datos...");const{data:t,error:r}=await ir.from("movimientos").select(`
        id,
        id_articulo,
        articulos!inner(id, nombre)
      `);r&&e.push(`Error checking orphaned movements: ${r.message}`);const{data:n}=await ir.from("articulos").select("id, nombre").eq("activo",!0);if(n)for(const s of n){const{data:o}=await ir.from("movimientos").select("tipo, cantidad").eq("id_articulo",s.id);if(o){let l=0;o.forEach(c=>{c.tipo==="Entrada"?l+=c.cantidad:l-=c.cantidad}),l<0&&e.push(`Article "${s.nombre}" has negative stock: ${l}`)}}const{data:a,error:i}=await ir.from("usuarios").select("id, username, role").eq("active",!0);if(i)e.push(`Error checking users: ${i.message}`);else if(a){const s=["admin","user","viewer"],o=a.filter(l=>!s.includes(l.role));o.length>0&&e.push(`Found ${o.length} users with invalid roles`)}console.log(e.length===0?" Integridad de datos validada correctamente":` Encontrados ${e.length} problemas de integridad`)}catch(t){e.push(`Validation error: ${t instanceof Error?t.message:"Unknown error"}`)}return{valid:e.length===0,issues:e}},Qk=ie.createContext(void 0);function Q9({children:e}){const[t,r]=ie.useState([]),[n,a]=ie.useState([]),[i,s]=ie.useState(!0),[o,l]=ie.useState(!1),{user:c}=X9(),u=async()=>{try{const{data:F,error:I}=await ir.from("articulos").select("id, nombre, costo, descripcion, categoria, activo").eq("activo",!0).order("nombre",{ascending:!0});if(I)throw I;const A=(F||[]).map(P=>({id:P.id,nombre:P.nombre,costo:parseFloat(P.costo||"0")}));r(A),console.log(" Artculos cargados desde Supabase:",A.length)}catch(F){throw console.error("Error loading articles:",F),st.error("Error al cargar artculos desde la base de datos"),F}},f=async()=>{try{const{data:F,error:I}=await ir.from("movimientos").select(`
          id, 
          id_articulo, 
          tipo, 
          cantidad, 
          fecha, 
          descripcion, 
          costo_unitario,
          created_at
        `).order("fecha",{ascending:!1}).order("created_at",{ascending:!1});if(I)throw I;const A=(F||[]).map(P=>({id:P.id,id_articulo:P.id_articulo,tipo:P.tipo,cantidad:P.cantidad,fecha:P.fecha,descripcion:P.descripcion||"",costo:parseFloat(P.costo_unitario||"0")}));a(A),console.log(" Movimientos cargados desde Supabase:",A.length)}catch(F){throw console.error("Error loading movements:",F),st.error("Error al cargar movimientos desde la base de datos"),F}},d=async()=>{s(!0);try{const F=await Jk();if(!F.connected){console.error("Database not connected:",F.errors),st.error("No se pudo conectar a la base de datos"),s(!1);return}if(!F.tablesExist){console.warn("Database tables do not exist:",F.errors),st.error("Las tablas de la base de datos no existen. Por favor, ejecuta las migraciones SQL."),s(!1);return}l(!0),await Promise.all([u(),f()])}catch(F){console.error("Error refreshing data:",F),st.error("Error al actualizar datos")}finally{s(!1)}};ie.useEffect(()=>{d()},[]);const h=async F=>{try{if(!o)throw new Error("Base de datos no disponible");const{data:I,error:A}=await ir.from("articulos").insert({nombre:F.nombre.toUpperCase(),costo:F.costo,categoria:"GENERAL",unidad_medida:"UNIDAD",activo:!0}).select().single();if(A)throw A;const P={id:I.id,nombre:I.nombre,costo:parseFloat(I.costo)};r(j=>[...j,P]),st.success("Artculo agregado correctamente")}catch(I){throw console.error("Error adding article:",I),st.error("Error al agregar artculo"),I}},g=async(F,I)=>{try{if(!o)throw new Error("Base de datos no disponible");const A={};I.nombre&&(A.nombre=I.nombre.toUpperCase()),I.costo!==void 0&&(A.costo=I.costo);const{data:P,error:j}=await ir.from("articulos").update(A).eq("id",F).select().single();if(j)throw j;const J={id:P.id,nombre:P.nombre,costo:parseFloat(P.costo)};r(N=>N.map(L=>L.id===F?J:L)),st.success("Artculo actualizado correctamente")}catch(A){throw console.error("Error updating article:",A),st.error("Error al actualizar artculo"),A}},m=async F=>{try{if(!o)throw new Error("Base de datos no disponible");const{data:I,error:A}=await ir.from("movimientos").select("id").eq("id_articulo",F).limit(1);if(A)throw A;if(I&&I.length>0){st.error("No se puede eliminar un artculo que tiene movimientos registrados");return}const{error:P}=await ir.from("articulos").delete().eq("id",F);if(P)throw P;r(j=>j.filter(J=>J.id!==F)),st.success("Artculo eliminado correctamente")}catch(I){throw console.error("Error deleting article:",I),st.error("Error al eliminar artculo"),I}},_=async F=>{try{if(!o)throw new Error("Base de datos no disponible");const{data:I,error:A}=await ir.from("movimientos").insert({id_articulo:F.id_articulo,id_usuario:(c==null?void 0:c.id)||null,tipo:F.tipo,cantidad:F.cantidad,fecha:F.fecha,descripcion:F.descripcion.toUpperCase(),costo_unitario:F.costo}).select().single();if(A)throw A;const P={id:I.id,id_articulo:I.id_articulo,tipo:I.tipo,cantidad:I.cantidad,fecha:I.fecha,descripcion:I.descripcion,costo:parseFloat(I.costo_unitario)};a(j=>[P,...j]),st.success("Movimiento registrado correctamente")}catch(I){throw console.error("Error adding movement:",I),I instanceof Error&&I.message.includes("Stock insuficiente")?st.error(I.message):st.error("Error al registrar movimiento"),I}},y=async(F,I)=>{try{if(!o)throw new Error("Base de datos no disponible");const A={};I.cantidad!==void 0&&(A.cantidad=I.cantidad),I.fecha&&(A.fecha=I.fecha),I.descripcion&&(A.descripcion=I.descripcion.toUpperCase()),I.costo!==void 0&&(A.costo_unitario=I.costo);const{data:P,error:j}=await ir.from("movimientos").update(A).eq("id",F).select().single();if(j)throw j;const J={id:P.id,id_articulo:P.id_articulo,tipo:P.tipo,cantidad:P.cantidad,fecha:P.fecha,descripcion:P.descripcion,costo:parseFloat(P.costo_unitario)};a(N=>N.map(L=>L.id===F?J:L)),st.success("Movimiento actualizado correctamente")}catch(A){throw console.error("Error updating movement:",A),st.error("Error al actualizar movimiento"),A}},b=async F=>{try{if(!o)throw new Error("Base de datos no disponible");const{error:I}=await ir.from("movimientos").delete().eq("id",F);if(I)throw I;a(A=>A.filter(P=>P.id!==F)),st.success("Movimiento eliminado correctamente")}catch(I){throw console.error("Error deleting movement:",I),st.error("Error al eliminar movimiento"),I}},w=F=>n.filter(A=>A.id_articulo===F).reduce((A,P)=>P.tipo==="Entrada"?A+P.cantidad:A-P.cantidad,0),T=async()=>{const F=n.filter(I=>I.costo===0);for(const I of F){const A=t.find(P=>P.id===I.id_articulo);A&&A.costo>0&&await y(I.id,{costo:A.costo})}st.success("Movimientos actualizados con el costo unitario del artculo"),await d()};return v.jsx(Qk.Provider,{value:{articles:t,movements:n,loading:i,refreshData:d,addArticle:h,updateArticle:g,deleteArticle:m,addMovement:_,updateMovement:y,deleteMovement:b,getStock:w,actualizarCostosMovimientos:T},children:e})}const ps=()=>{const e=ie.useContext(Qk);if(e===void 0)throw new Error("useData must be used within a DataProvider");return e},Zk=ie.createContext({transformPagePoint:e=>e,isStatic:!1,reducedMotion:"never"}),xm=ie.createContext({}),vm=ie.createContext(null),ym=typeof document<"u",$y=ym?ie.useLayoutEffect:ie.useEffect,e8=ie.createContext({strict:!1}),Vy=e=>e.replace(/([a-z])([A-Z])/g,"$1-$2").toLowerCase(),Z9="framerAppearId",t8="data-"+Vy(Z9);function eO(e,t,r,n){const{visualElement:a}=ie.useContext(xm),i=ie.useContext(e8),s=ie.useContext(vm),o=ie.useContext(Zk).reducedMotion,l=ie.useRef();n=n||i.renderer,!l.current&&n&&(l.current=n(e,{visualState:t,parent:a,props:r,presenceContext:s,blockInitialAnimation:s?s.initial===!1:!1,reducedMotionConfig:o}));const c=l.current;ie.useInsertionEffect(()=>{c&&c.update(r,s)});const u=ie.useRef(!!(r[t8]&&!window.HandoffComplete));return $y(()=>{c&&(c.render(),u.current&&c.animationState&&c.animationState.animateChanges())}),ie.useEffect(()=>{c&&(c.updateFeatures(),!u.current&&c.animationState&&c.animationState.animateChanges(),u.current&&(u.current=!1,window.HandoffComplete=!0))}),c}function mu(e){return e&&typeof e=="object"&&Object.prototype.hasOwnProperty.call(e,"current")}function tO(e,t,r){return ie.useCallback(n=>{n&&e.mount&&e.mount(n),t&&(n?t.mount(n):t.unmount()),r&&(typeof r=="function"?r(n):mu(r)&&(r.current=n))},[t])}function sh(e){return typeof e=="string"||Array.isArray(e)}function wm(e){return e!==null&&typeof e=="object"&&typeof e.start=="function"}const zy=["animate","whileInView","whileFocus","whileHover","whileTap","whileDrag","exit"],Hy=["initial",...zy];function bm(e){return wm(e.animate)||Hy.some(t=>sh(e[t]))}function r8(e){return!!(bm(e)||e.variants)}function rO(e,t){if(bm(e)){const{initial:r,animate:n}=e;return{initial:r===!1||sh(r)?r:void 0,animate:sh(n)?n:void 0}}return e.inherit!==!1?t:{}}function nO(e){const{initial:t,animate:r}=rO(e,ie.useContext(xm));return ie.useMemo(()=>({initial:t,animate:r}),[t4(t),t4(r)])}function t4(e){return Array.isArray(e)?e.join(" "):e}const r4={animation:["animate","variants","whileHover","whileTap","exit","whileInView","whileFocus","whileDrag"],exit:["exit"],drag:["drag","dragControls"],focus:["whileFocus"],hover:["whileHover","onHoverStart","onHoverEnd"],tap:["whileTap","onTap","onTapStart","onTapCancel"],pan:["onPan","onPanStart","onPanSessionStart","onPanEnd"],inView:["whileInView","onViewportEnter","onViewportLeave"],layout:["layout","layoutId"]},oh={};for(const e in r4)oh[e]={isEnabled:t=>r4[e].some(r=>!!t[r])};function aO(e){for(const t in e)oh[t]={...oh[t],...e[t]}}const Wy=ie.createContext({}),n8=ie.createContext({}),iO=Symbol.for("motionComponentSymbol");function sO({preloadedFeatures:e,createVisualElement:t,useRender:r,useVisualState:n,Component:a}){e&&aO(e);function i(o,l){let c;const u={...ie.useContext(Zk),...o,layoutId:oO(o)},{isStatic:f}=u,d=nO(o),h=n(o,f);if(!f&&ym){d.visualElement=eO(a,h,u,t);const g=ie.useContext(n8),m=ie.useContext(e8).strict;d.visualElement&&(c=d.visualElement.loadFeatures(u,m,e,g))}return ie.createElement(xm.Provider,{value:d},c&&d.visualElement?ie.createElement(c,{visualElement:d.visualElement,...u}):null,r(a,o,tO(h,d.visualElement,l),h,f,d.visualElement))}const s=ie.forwardRef(i);return s[iO]=a,s}function oO({layoutId:e}){const t=ie.useContext(Wy).id;return t&&e!==void 0?t+"-"+e:e}function lO(e){function t(n,a={}){return sO(e(n,a))}if(typeof Proxy>"u")return t;const r=new Map;return new Proxy(t,{get:(n,a)=>(r.has(a)||r.set(a,t(a)),r.get(a))})}const cO=["animate","circle","defs","desc","ellipse","g","image","line","filter","marker","mask","metadata","path","pattern","polygon","polyline","rect","stop","switch","symbol","svg","text","tspan","use","view"];function qy(e){return typeof e!="string"||e.includes("-")?!1:!!(cO.indexOf(e)>-1||/[A-Z]/.test(e))}const y1={};function uO(e){Object.assign(y1,e)}const Lh=["transformPerspective","x","y","z","translateX","translateY","translateZ","scale","scaleX","scaleY","rotate","rotateX","rotateY","rotateZ","skew","skewX","skewY"],fc=new Set(Lh);function a8(e,{layout:t,layoutId:r}){return fc.has(e)||e.startsWith("origin")||(t||r!==void 0)&&(!!y1[e]||e==="opacity")}const _a=e=>!!(e&&e.getVelocity),fO={x:"translateX",y:"translateY",z:"translateZ",transformPerspective:"perspective"},hO=Lh.length;function dO(e,{enableHardwareAcceleration:t=!0,allowTransformNone:r=!0},n,a){let i="";for(let s=0;s<hO;s++){const o=Lh[s];if(e[o]!==void 0){const l=fO[o]||o;i+=`${l}(${e[o]}) `}}return t&&!e.z&&(i+="translateZ(0)"),i=i.trim(),a?i=a(e,n?"":i):r&&n&&(i="none"),i}const i8=e=>t=>typeof t=="string"&&t.startsWith(e),s8=i8("--"),Gx=i8("var(--"),pO=/var\s*\(\s*--[\w-]+(\s*,\s*(?:(?:[^)(]|\((?:[^)(]+|\([^)(]*\))*\))*)+)?\s*\)/g,mO=(e,t)=>t&&typeof e=="number"?t.transform(e):e,rl=(e,t,r)=>Math.min(Math.max(r,e),t),hc={test:e=>typeof e=="number",parse:parseFloat,transform:e=>e},Sf={...hc,transform:e=>rl(0,1,e)},np={...hc,default:1},kf=e=>Math.round(e*1e5)/1e5,_m=/(-)?([\d]*\.?[\d])+/g,o8=/(#[0-9a-f]{3,8}|(rgb|hsl)a?\((-?[\d\.]+%?[,\s]+){2}(-?[\d\.]+%?)\s*[\,\/]?\s*[\d\.]*%?\))/gi,gO=/^(#[0-9a-f]{3,8}|(rgb|hsl)a?\((-?[\d\.]+%?[,\s]+){2}(-?[\d\.]+%?)\s*[\,\/]?\s*[\d\.]*%?\))$/i;function Fh(e){return typeof e=="string"}const Oh=e=>({test:t=>Fh(t)&&t.endsWith(e)&&t.split(" ").length===1,parse:parseFloat,transform:t=>`${t}${e}`}),Ao=Oh("deg"),us=Oh("%"),xt=Oh("px"),xO=Oh("vh"),vO=Oh("vw"),n4={...us,parse:e=>us.parse(e)/100,transform:e=>us.transform(e*100)},a4={...hc,transform:Math.round},l8={borderWidth:xt,borderTopWidth:xt,borderRightWidth:xt,borderBottomWidth:xt,borderLeftWidth:xt,borderRadius:xt,radius:xt,borderTopLeftRadius:xt,borderTopRightRadius:xt,borderBottomRightRadius:xt,borderBottomLeftRadius:xt,width:xt,maxWidth:xt,height:xt,maxHeight:xt,size:xt,top:xt,right:xt,bottom:xt,left:xt,padding:xt,paddingTop:xt,paddingRight:xt,paddingBottom:xt,paddingLeft:xt,margin:xt,marginTop:xt,marginRight:xt,marginBottom:xt,marginLeft:xt,rotate:Ao,rotateX:Ao,rotateY:Ao,rotateZ:Ao,scale:np,scaleX:np,scaleY:np,scaleZ:np,skew:Ao,skewX:Ao,skewY:Ao,distance:xt,translateX:xt,translateY:xt,translateZ:xt,x:xt,y:xt,z:xt,perspective:xt,transformPerspective:xt,opacity:Sf,originX:n4,originY:n4,originZ:xt,zIndex:a4,fillOpacity:Sf,strokeOpacity:Sf,numOctaves:a4};function Gy(e,t,r,n){const{style:a,vars:i,transform:s,transformOrigin:o}=e;let l=!1,c=!1,u=!0;for(const f in t){const d=t[f];if(s8(f)){i[f]=d;continue}const h=l8[f],g=mO(d,h);if(fc.has(f)){if(l=!0,s[f]=g,!u)continue;d!==(h.default||0)&&(u=!1)}else f.startsWith("origin")?(c=!0,o[f]=g):a[f]=g}if(t.transform||(l||n?a.transform=dO(e.transform,r,u,n):a.transform&&(a.transform="none")),c){const{originX:f="50%",originY:d="50%",originZ:h=0}=o;a.transformOrigin=`${f} ${d} ${h}`}}const Ky=()=>({style:{},transform:{},transformOrigin:{},vars:{}});function c8(e,t,r){for(const n in t)!_a(t[n])&&!a8(n,r)&&(e[n]=t[n])}function yO({transformTemplate:e},t,r){return ie.useMemo(()=>{const n=Ky();return Gy(n,t,{enableHardwareAcceleration:!r},e),Object.assign({},n.vars,n.style)},[t])}function wO(e,t,r){const n=e.style||{},a={};return c8(a,n,e),Object.assign(a,yO(e,t,r)),e.transformValues?e.transformValues(a):a}function bO(e,t,r){const n={},a=wO(e,t,r);return e.drag&&e.dragListener!==!1&&(n.draggable=!1,a.userSelect=a.WebkitUserSelect=a.WebkitTouchCallout="none",a.touchAction=e.drag===!0?"none":`pan-${e.drag==="x"?"y":"x"}`),e.tabIndex===void 0&&(e.onTap||e.onTapStart||e.whileTap)&&(n.tabIndex=0),n.style=a,n}const _O=new Set(["animate","exit","variants","initial","style","values","variants","transition","transformTemplate","transformValues","custom","inherit","onBeforeLayoutMeasure","onAnimationStart","onAnimationComplete","onUpdate","onDragStart","onDrag","onDragEnd","onMeasureDragConstraints","onDirectionLock","onDragTransitionEnd","_dragX","_dragY","onHoverStart","onHoverEnd","onViewportEnter","onViewportLeave","globalTapTarget","ignoreStrict","viewport"]);function w1(e){return e.startsWith("while")||e.startsWith("drag")&&e!=="draggable"||e.startsWith("layout")||e.startsWith("onTap")||e.startsWith("onPan")||e.startsWith("onLayout")||_O.has(e)}let u8=e=>!w1(e);function SO(e){e&&(u8=t=>t.startsWith("on")?!w1(t):e(t))}try{SO(require("@emotion/is-prop-valid").default)}catch{}function kO(e,t,r){const n={};for(const a in e)a==="values"&&typeof e.values=="object"||(u8(a)||r===!0&&w1(a)||!t&&!w1(a)||e.draggable&&a.startsWith("onDrag"))&&(n[a]=e[a]);return n}function i4(e,t,r){return typeof e=="string"?e:xt.transform(t+r*e)}function EO(e,t,r){const n=i4(t,e.x,e.width),a=i4(r,e.y,e.height);return`${n} ${a}`}const AO={offset:"stroke-dashoffset",array:"stroke-dasharray"},TO={offset:"strokeDashoffset",array:"strokeDasharray"};function CO(e,t,r=1,n=0,a=!0){e.pathLength=1;const i=a?AO:TO;e[i.offset]=xt.transform(-n);const s=xt.transform(t),o=xt.transform(r);e[i.array]=`${s} ${o}`}function Xy(e,{attrX:t,attrY:r,attrScale:n,originX:a,originY:i,pathLength:s,pathSpacing:o=1,pathOffset:l=0,...c},u,f,d){if(Gy(e,c,u,d),f){e.style.viewBox&&(e.attrs.viewBox=e.style.viewBox);return}e.attrs=e.style,e.style={};const{attrs:h,style:g,dimensions:m}=e;h.transform&&(m&&(g.transform=h.transform),delete h.transform),m&&(a!==void 0||i!==void 0||g.transform)&&(g.transformOrigin=EO(m,a!==void 0?a:.5,i!==void 0?i:.5)),t!==void 0&&(h.x=t),r!==void 0&&(h.y=r),n!==void 0&&(h.scale=n),s!==void 0&&CO(h,s,o,l,!1)}const f8=()=>({...Ky(),attrs:{}}),Yy=e=>typeof e=="string"&&e.toLowerCase()==="svg";function NO(e,t,r,n){const a=ie.useMemo(()=>{const i=f8();return Xy(i,t,{enableHardwareAcceleration:!1},Yy(n),e.transformTemplate),{...i.attrs,style:{...i.style}}},[t]);if(e.style){const i={};c8(i,e.style,e),a.style={...i,...a.style}}return a}function PO(e=!1){return(r,n,a,{latestValues:i},s)=>{const l=(qy(r)?NO:bO)(n,i,s,r),u={...kO(n,typeof r=="string",e),...l,ref:a},{children:f}=n,d=ie.useMemo(()=>_a(f)?f.get():f,[f]);return ie.createElement(r,{...u,children:d})}}function h8(e,{style:t,vars:r},n,a){Object.assign(e.style,t,a&&a.getProjectionStyles(n));for(const i in r)e.style.setProperty(i,r[i])}const d8=new Set(["baseFrequency","diffuseConstant","kernelMatrix","kernelUnitLength","keySplines","keyTimes","limitingConeAngle","markerHeight","markerWidth","numOctaves","targetX","targetY","surfaceScale","specularConstant","specularExponent","stdDeviation","tableValues","viewBox","gradientTransform","pathLength","startOffset","textLength","lengthAdjust"]);function p8(e,t,r,n){h8(e,t,void 0,n);for(const a in t.attrs)e.setAttribute(d8.has(a)?a:Vy(a),t.attrs[a])}function Jy(e,t){const{style:r}=e,n={};for(const a in r)(_a(r[a])||t.style&&_a(t.style[a])||a8(a,e))&&(n[a]=r[a]);return n}function m8(e,t){const r=Jy(e,t);for(const n in e)if(_a(e[n])||_a(t[n])){const a=Lh.indexOf(n)!==-1?"attr"+n.charAt(0).toUpperCase()+n.substring(1):n;r[a]=e[n]}return r}function Qy(e,t,r,n={},a={}){return typeof t=="function"&&(t=t(r!==void 0?r:e.custom,n,a)),typeof t=="string"&&(t=e.variants&&e.variants[t]),typeof t=="function"&&(t=t(r!==void 0?r:e.custom,n,a)),t}function g8(e){const t=ie.useRef(null);return t.current===null&&(t.current=e()),t.current}const b1=e=>Array.isArray(e),LO=e=>!!(e&&typeof e=="object"&&e.mix&&e.toValue),FO=e=>b1(e)?e[e.length-1]||0:e;function Rp(e){const t=_a(e)?e.get():e;return LO(t)?t.toValue():t}function OO({scrapeMotionValuesFromProps:e,createRenderState:t,onMount:r},n,a,i){const s={latestValues:IO(n,a,i,e),renderState:t()};return r&&(s.mount=o=>r(n,o,s)),s}const x8=e=>(t,r)=>{const n=ie.useContext(xm),a=ie.useContext(vm),i=()=>OO(e,t,n,a);return r?i():g8(i)};function IO(e,t,r,n){const a={},i=n(e,{});for(const d in i)a[d]=Rp(i[d]);let{initial:s,animate:o}=e;const l=bm(e),c=r8(e);t&&c&&!l&&e.inherit!==!1&&(s===void 0&&(s=t.initial),o===void 0&&(o=t.animate));let u=r?r.initial===!1:!1;u=u||s===!1;const f=u?o:s;return f&&typeof f!="boolean"&&!wm(f)&&(Array.isArray(f)?f:[f]).forEach(h=>{const g=Qy(e,h);if(!g)return;const{transitionEnd:m,transition:_,...y}=g;for(const b in y){let w=y[b];if(Array.isArray(w)){const T=u?w.length-1:0;w=w[T]}w!==null&&(a[b]=w)}for(const b in m)a[b]=m[b]}),a}const zr=e=>e;class s4{constructor(){this.order=[],this.scheduled=new Set}add(t){if(!this.scheduled.has(t))return this.scheduled.add(t),this.order.push(t),!0}remove(t){const r=this.order.indexOf(t);r!==-1&&(this.order.splice(r,1),this.scheduled.delete(t))}clear(){this.order.length=0,this.scheduled.clear()}}function DO(e){let t=new s4,r=new s4,n=0,a=!1,i=!1;const s=new WeakSet,o={schedule:(l,c=!1,u=!1)=>{const f=u&&a,d=f?t:r;return c&&s.add(l),d.add(l)&&f&&a&&(n=t.order.length),l},cancel:l=>{r.remove(l),s.delete(l)},process:l=>{if(a){i=!0;return}if(a=!0,[t,r]=[r,t],r.clear(),n=t.order.length,n)for(let c=0;c<n;c++){const u=t.order[c];u(l),s.has(u)&&(o.schedule(u),e())}a=!1,i&&(i=!1,o.process(l))}};return o}const ap=["prepare","read","update","preRender","render","postRender"],jO=40;function RO(e,t){let r=!1,n=!0;const a={delta:0,timestamp:0,isProcessing:!1},i=ap.reduce((f,d)=>(f[d]=DO(()=>r=!0),f),{}),s=f=>i[f].process(a),o=()=>{const f=performance.now();r=!1,a.delta=n?1e3/60:Math.max(Math.min(f-a.timestamp,jO),1),a.timestamp=f,a.isProcessing=!0,ap.forEach(s),a.isProcessing=!1,r&&t&&(n=!1,e(o))},l=()=>{r=!0,n=!0,a.isProcessing||e(o)};return{schedule:ap.reduce((f,d)=>{const h=i[d];return f[d]=(g,m=!1,_=!1)=>(r||l(),h.schedule(g,m,_)),f},{}),cancel:f=>ap.forEach(d=>i[d].cancel(f)),state:a,steps:i}}const{schedule:pr,cancel:Qs,state:Mn,steps:r2}=RO(typeof requestAnimationFrame<"u"?requestAnimationFrame:zr,!0),MO={useVisualState:x8({scrapeMotionValuesFromProps:m8,createRenderState:f8,onMount:(e,t,{renderState:r,latestValues:n})=>{pr.read(()=>{try{r.dimensions=typeof t.getBBox=="function"?t.getBBox():t.getBoundingClientRect()}catch{r.dimensions={x:0,y:0,width:0,height:0}}}),pr.render(()=>{Xy(r,n,{enableHardwareAcceleration:!1},Yy(t.tagName),e.transformTemplate),p8(t,r)})}})},BO={useVisualState:x8({scrapeMotionValuesFromProps:Jy,createRenderState:Ky})};function UO(e,{forwardMotionProps:t=!1},r,n){return{...qy(e)?MO:BO,preloadedFeatures:r,useRender:PO(t),createVisualElement:n,Component:e}}function Ms(e,t,r,n={passive:!0}){return e.addEventListener(t,r,n),()=>e.removeEventListener(t,r)}const v8=e=>e.pointerType==="mouse"?typeof e.button!="number"||e.button<=0:e.isPrimary!==!1;function Sm(e,t="page"){return{point:{x:e[t+"X"],y:e[t+"Y"]}}}const $O=e=>t=>v8(t)&&e(t,Sm(t));function Vs(e,t,r,n){return Ms(e,t,$O(r),n)}const VO=(e,t)=>r=>t(e(r)),Jo=(...e)=>e.reduce(VO);function y8(e){let t=null;return()=>{const r=()=>{t=null};return t===null?(t=e,r):!1}}const o4=y8("dragHorizontal"),l4=y8("dragVertical");function w8(e){let t=!1;if(e==="y")t=l4();else if(e==="x")t=o4();else{const r=o4(),n=l4();r&&n?t=()=>{r(),n()}:(r&&r(),n&&n())}return t}function b8(){const e=w8(!0);return e?(e(),!1):!0}class dl{constructor(t){this.isMounted=!1,this.node=t}update(){}}function c4(e,t){const r="pointer"+(t?"enter":"leave"),n="onHover"+(t?"Start":"End"),a=(i,s)=>{if(i.pointerType==="touch"||b8())return;const o=e.getProps();e.animationState&&o.whileHover&&e.animationState.setActive("whileHover",t),o[n]&&pr.update(()=>o[n](i,s))};return Vs(e.current,r,a,{passive:!e.getProps()[n]})}class zO extends dl{mount(){this.unmount=Jo(c4(this.node,!0),c4(this.node,!1))}unmount(){}}class HO extends dl{constructor(){super(...arguments),this.isActive=!1}onFocus(){let t=!1;try{t=this.node.current.matches(":focus-visible")}catch{t=!0}!t||!this.node.animationState||(this.node.animationState.setActive("whileFocus",!0),this.isActive=!0)}onBlur(){!this.isActive||!this.node.animationState||(this.node.animationState.setActive("whileFocus",!1),this.isActive=!1)}mount(){this.unmount=Jo(Ms(this.node.current,"focus",()=>this.onFocus()),Ms(this.node.current,"blur",()=>this.onBlur()))}unmount(){}}const _8=(e,t)=>t?e===t?!0:_8(e,t.parentElement):!1;function n2(e,t){if(!t)return;const r=new PointerEvent("pointer"+e);t(r,Sm(r))}class WO extends dl{constructor(){super(...arguments),this.removeStartListeners=zr,this.removeEndListeners=zr,this.removeAccessibleListeners=zr,this.startPointerPress=(t,r)=>{if(this.isPressing)return;this.removeEndListeners();const n=this.node.getProps(),i=Vs(window,"pointerup",(o,l)=>{if(!this.checkPressEnd())return;const{onTap:c,onTapCancel:u,globalTapTarget:f}=this.node.getProps();pr.update(()=>{!f&&!_8(this.node.current,o.target)?u&&u(o,l):c&&c(o,l)})},{passive:!(n.onTap||n.onPointerUp)}),s=Vs(window,"pointercancel",(o,l)=>this.cancelPress(o,l),{passive:!(n.onTapCancel||n.onPointerCancel)});this.removeEndListeners=Jo(i,s),this.startPress(t,r)},this.startAccessiblePress=()=>{const t=i=>{if(i.key!=="Enter"||this.isPressing)return;const s=o=>{o.key!=="Enter"||!this.checkPressEnd()||n2("up",(l,c)=>{const{onTap:u}=this.node.getProps();u&&pr.update(()=>u(l,c))})};this.removeEndListeners(),this.removeEndListeners=Ms(this.node.current,"keyup",s),n2("down",(o,l)=>{this.startPress(o,l)})},r=Ms(this.node.current,"keydown",t),n=()=>{this.isPressing&&n2("cancel",(i,s)=>this.cancelPress(i,s))},a=Ms(this.node.current,"blur",n);this.removeAccessibleListeners=Jo(r,a)}}startPress(t,r){this.isPressing=!0;const{onTapStart:n,whileTap:a}=this.node.getProps();a&&this.node.animationState&&this.node.animationState.setActive("whileTap",!0),n&&pr.update(()=>n(t,r))}checkPressEnd(){return this.removeEndListeners(),this.isPressing=!1,this.node.getProps().whileTap&&this.node.animationState&&this.node.animationState.setActive("whileTap",!1),!b8()}cancelPress(t,r){if(!this.checkPressEnd())return;const{onTapCancel:n}=this.node.getProps();n&&pr.update(()=>n(t,r))}mount(){const t=this.node.getProps(),r=Vs(t.globalTapTarget?window:this.node.current,"pointerdown",this.startPointerPress,{passive:!(t.onTapStart||t.onPointerStart)}),n=Ms(this.node.current,"focus",this.startAccessiblePress);this.removeStartListeners=Jo(r,n)}unmount(){this.removeStartListeners(),this.removeEndListeners(),this.removeAccessibleListeners()}}const Kx=new WeakMap,a2=new WeakMap,qO=e=>{const t=Kx.get(e.target);t&&t(e)},GO=e=>{e.forEach(qO)};function KO({root:e,...t}){const r=e||document;a2.has(r)||a2.set(r,{});const n=a2.get(r),a=JSON.stringify(t);return n[a]||(n[a]=new IntersectionObserver(GO,{root:e,...t})),n[a]}function XO(e,t,r){const n=KO(t);return Kx.set(e,r),n.observe(e),()=>{Kx.delete(e),n.unobserve(e)}}const YO={some:0,all:1};class JO extends dl{constructor(){super(...arguments),this.hasEnteredView=!1,this.isInView=!1}startObserver(){this.unmount();const{viewport:t={}}=this.node.getProps(),{root:r,margin:n,amount:a="some",once:i}=t,s={root:r?r.current:void 0,rootMargin:n,threshold:typeof a=="number"?a:YO[a]},o=l=>{const{isIntersecting:c}=l;if(this.isInView===c||(this.isInView=c,i&&!c&&this.hasEnteredView))return;c&&(this.hasEnteredView=!0),this.node.animationState&&this.node.animationState.setActive("whileInView",c);const{onViewportEnter:u,onViewportLeave:f}=this.node.getProps(),d=c?u:f;d&&d(l)};return XO(this.node.current,s,o)}mount(){this.startObserver()}update(){if(typeof IntersectionObserver>"u")return;const{props:t,prevProps:r}=this.node;["amount","margin","root"].some(QO(t,r))&&this.startObserver()}unmount(){}}function QO({viewport:e={}},{viewport:t={}}={}){return r=>e[r]!==t[r]}const ZO={inView:{Feature:JO},tap:{Feature:WO},focus:{Feature:HO},hover:{Feature:zO}};function S8(e,t){if(!Array.isArray(t))return!1;const r=t.length;if(r!==e.length)return!1;for(let n=0;n<r;n++)if(t[n]!==e[n])return!1;return!0}function eI(e){const t={};return e.values.forEach((r,n)=>t[n]=r.get()),t}function tI(e){const t={};return e.values.forEach((r,n)=>t[n]=r.getVelocity()),t}function km(e,t,r){const n=e.getProps();return Qy(n,t,r!==void 0?r:n.custom,eI(e),tI(e))}let _1=zr;const ql=e=>e*1e3,zs=e=>e/1e3,rI={current:!1},k8=e=>Array.isArray(e)&&typeof e[0]=="number";function E8(e){return!!(!e||typeof e=="string"&&A8[e]||k8(e)||Array.isArray(e)&&e.every(E8))}const nf=([e,t,r,n])=>`cubic-bezier(${e}, ${t}, ${r}, ${n})`,A8={linear:"linear",ease:"ease",easeIn:"ease-in",easeOut:"ease-out",easeInOut:"ease-in-out",circIn:nf([0,.65,.55,1]),circOut:nf([.55,0,1,.45]),backIn:nf([.31,.01,.66,-.59]),backOut:nf([.33,1.53,.69,.99])};function T8(e){if(e)return k8(e)?nf(e):Array.isArray(e)?e.map(T8):A8[e]}function nI(e,t,r,{delay:n=0,duration:a,repeat:i=0,repeatType:s="loop",ease:o,times:l}={}){const c={[t]:r};l&&(c.offset=l);const u=T8(o);return Array.isArray(u)&&(c.easing=u),e.animate(c,{delay:n,duration:a,easing:Array.isArray(u)?"linear":u,fill:"both",iterations:i+1,direction:s==="reverse"?"alternate":"normal"})}function aI(e,{repeat:t,repeatType:r="loop"}){const n=t&&r!=="loop"&&t%2===1?0:e.length-1;return e[n]}const C8=(e,t,r)=>(((1-3*r+3*t)*e+(3*r-6*t))*e+3*t)*e,iI=1e-7,sI=12;function oI(e,t,r,n,a){let i,s,o=0;do s=t+(r-t)/2,i=C8(s,n,a)-e,i>0?r=s:t=s;while(Math.abs(i)>iI&&++o<sI);return s}function Ih(e,t,r,n){if(e===t&&r===n)return zr;const a=i=>oI(i,0,1,e,r);return i=>i===0||i===1?i:C8(a(i),t,n)}const lI=Ih(.42,0,1,1),cI=Ih(0,0,.58,1),N8=Ih(.42,0,.58,1),uI=e=>Array.isArray(e)&&typeof e[0]!="number",P8=e=>t=>t<=.5?e(2*t)/2:(2-e(2*(1-t)))/2,L8=e=>t=>1-e(1-t),Zy=e=>1-Math.sin(Math.acos(e)),F8=L8(Zy),fI=P8(Zy),O8=Ih(.33,1.53,.69,.99),e5=L8(O8),hI=P8(e5),dI=e=>(e*=2)<1?.5*e5(e):.5*(2-Math.pow(2,-10*(e-1))),u4={linear:zr,easeIn:lI,easeInOut:N8,easeOut:cI,circIn:Zy,circInOut:fI,circOut:F8,backIn:e5,backInOut:hI,backOut:O8,anticipate:dI},f4=e=>{if(Array.isArray(e)){_1(e.length===4);const[t,r,n,a]=e;return Ih(t,r,n,a)}else if(typeof e=="string")return _1(u4[e]!==void 0),u4[e];return e},t5=(e,t)=>r=>!!(Fh(r)&&gO.test(r)&&r.startsWith(e)||t&&Object.prototype.hasOwnProperty.call(r,t)),I8=(e,t,r)=>n=>{if(!Fh(n))return n;const[a,i,s,o]=n.match(_m);return{[e]:parseFloat(a),[t]:parseFloat(i),[r]:parseFloat(s),alpha:o!==void 0?parseFloat(o):1}},pI=e=>rl(0,255,e),i2={...hc,transform:e=>Math.round(pI(e))},Vl={test:t5("rgb","red"),parse:I8("red","green","blue"),transform:({red:e,green:t,blue:r,alpha:n=1})=>"rgba("+i2.transform(e)+", "+i2.transform(t)+", "+i2.transform(r)+", "+kf(Sf.transform(n))+")"};function mI(e){let t="",r="",n="",a="";return e.length>5?(t=e.substring(1,3),r=e.substring(3,5),n=e.substring(5,7),a=e.substring(7,9)):(t=e.substring(1,2),r=e.substring(2,3),n=e.substring(3,4),a=e.substring(4,5),t+=t,r+=r,n+=n,a+=a),{red:parseInt(t,16),green:parseInt(r,16),blue:parseInt(n,16),alpha:a?parseInt(a,16)/255:1}}const Xx={test:t5("#"),parse:mI,transform:Vl.transform},gu={test:t5("hsl","hue"),parse:I8("hue","saturation","lightness"),transform:({hue:e,saturation:t,lightness:r,alpha:n=1})=>"hsla("+Math.round(e)+", "+us.transform(kf(t))+", "+us.transform(kf(r))+", "+kf(Sf.transform(n))+")"},Jn={test:e=>Vl.test(e)||Xx.test(e)||gu.test(e),parse:e=>Vl.test(e)?Vl.parse(e):gu.test(e)?gu.parse(e):Xx.parse(e),transform:e=>Fh(e)?e:e.hasOwnProperty("red")?Vl.transform(e):gu.transform(e)},kr=(e,t,r)=>-r*e+r*t+e;function s2(e,t,r){return r<0&&(r+=1),r>1&&(r-=1),r<1/6?e+(t-e)*6*r:r<1/2?t:r<2/3?e+(t-e)*(2/3-r)*6:e}function gI({hue:e,saturation:t,lightness:r,alpha:n}){e/=360,t/=100,r/=100;let a=0,i=0,s=0;if(!t)a=i=s=r;else{const o=r<.5?r*(1+t):r+t-r*t,l=2*r-o;a=s2(l,o,e+1/3),i=s2(l,o,e),s=s2(l,o,e-1/3)}return{red:Math.round(a*255),green:Math.round(i*255),blue:Math.round(s*255),alpha:n}}const o2=(e,t,r)=>{const n=e*e;return Math.sqrt(Math.max(0,r*(t*t-n)+n))},xI=[Xx,Vl,gu],vI=e=>xI.find(t=>t.test(e));function h4(e){const t=vI(e);let r=t.parse(e);return t===gu&&(r=gI(r)),r}const D8=(e,t)=>{const r=h4(e),n=h4(t),a={...r};return i=>(a.red=o2(r.red,n.red,i),a.green=o2(r.green,n.green,i),a.blue=o2(r.blue,n.blue,i),a.alpha=kr(r.alpha,n.alpha,i),Vl.transform(a))};function yI(e){var t,r;return isNaN(e)&&Fh(e)&&(((t=e.match(_m))===null||t===void 0?void 0:t.length)||0)+(((r=e.match(o8))===null||r===void 0?void 0:r.length)||0)>0}const j8={regex:pO,countKey:"Vars",token:"${v}",parse:zr},R8={regex:o8,countKey:"Colors",token:"${c}",parse:Jn.parse},M8={regex:_m,countKey:"Numbers",token:"${n}",parse:hc.parse};function l2(e,{regex:t,countKey:r,token:n,parse:a}){const i=e.tokenised.match(t);i&&(e["num"+r]=i.length,e.tokenised=e.tokenised.replace(t,n),e.values.push(...i.map(a)))}function S1(e){const t=e.toString(),r={value:t,tokenised:t,values:[],numVars:0,numColors:0,numNumbers:0};return r.value.includes("var(--")&&l2(r,j8),l2(r,R8),l2(r,M8),r}function B8(e){return S1(e).values}function U8(e){const{values:t,numColors:r,numVars:n,tokenised:a}=S1(e),i=t.length;return s=>{let o=a;for(let l=0;l<i;l++)l<n?o=o.replace(j8.token,s[l]):l<n+r?o=o.replace(R8.token,Jn.transform(s[l])):o=o.replace(M8.token,kf(s[l]));return o}}const wI=e=>typeof e=="number"?0:e;function bI(e){const t=B8(e);return U8(e)(t.map(wI))}const nl={test:yI,parse:B8,createTransformer:U8,getAnimatableNone:bI},$8=(e,t)=>r=>`${r>0?t:e}`;function V8(e,t){return typeof e=="number"?r=>kr(e,t,r):Jn.test(e)?D8(e,t):e.startsWith("var(")?$8(e,t):H8(e,t)}const z8=(e,t)=>{const r=[...e],n=r.length,a=e.map((i,s)=>V8(i,t[s]));return i=>{for(let s=0;s<n;s++)r[s]=a[s](i);return r}},_I=(e,t)=>{const r={...e,...t},n={};for(const a in r)e[a]!==void 0&&t[a]!==void 0&&(n[a]=V8(e[a],t[a]));return a=>{for(const i in n)r[i]=n[i](a);return r}},H8=(e,t)=>{const r=nl.createTransformer(t),n=S1(e),a=S1(t);return n.numVars===a.numVars&&n.numColors===a.numColors&&n.numNumbers>=a.numNumbers?Jo(z8(n.values,a.values),r):$8(e,t)},lh=(e,t,r)=>{const n=t-e;return n===0?1:(r-e)/n},d4=(e,t)=>r=>kr(e,t,r);function SI(e){return typeof e=="number"?d4:typeof e=="string"?Jn.test(e)?D8:H8:Array.isArray(e)?z8:typeof e=="object"?_I:d4}function kI(e,t,r){const n=[],a=r||SI(e[0]),i=e.length-1;for(let s=0;s<i;s++){let o=a(e[s],e[s+1]);if(t){const l=Array.isArray(t)?t[s]||zr:t;o=Jo(l,o)}n.push(o)}return n}function W8(e,t,{clamp:r=!0,ease:n,mixer:a}={}){const i=e.length;if(_1(i===t.length),i===1)return()=>t[0];e[0]>e[i-1]&&(e=[...e].reverse(),t=[...t].reverse());const s=kI(t,n,a),o=s.length,l=c=>{let u=0;if(o>1)for(;u<e.length-2&&!(c<e[u+1]);u++);const f=lh(e[u],e[u+1],c);return s[u](f)};return r?c=>l(rl(e[0],e[i-1],c)):l}function EI(e,t){const r=e[e.length-1];for(let n=1;n<=t;n++){const a=lh(0,t,n);e.push(kr(r,1,a))}}function AI(e){const t=[0];return EI(t,e.length-1),t}function TI(e,t){return e.map(r=>r*t)}function CI(e,t){return e.map(()=>t||N8).splice(0,e.length-1)}function k1({duration:e=300,keyframes:t,times:r,ease:n="easeInOut"}){const a=uI(n)?n.map(f4):f4(n),i={done:!1,value:t[0]},s=TI(r&&r.length===t.length?r:AI(t),e),o=W8(s,t,{ease:Array.isArray(a)?a:CI(t,a)});return{calculatedDuration:e,next:l=>(i.value=o(l),i.done=l>=e,i)}}function q8(e,t){return t?e*(1e3/t):0}const NI=5;function G8(e,t,r){const n=Math.max(t-NI,0);return q8(r-e(n),t-n)}const c2=.001,PI=.01,LI=10,FI=.05,OI=1;function II({duration:e=800,bounce:t=.25,velocity:r=0,mass:n=1}){let a,i,s=1-t;s=rl(FI,OI,s),e=rl(PI,LI,zs(e)),s<1?(a=c=>{const u=c*s,f=u*e,d=u-r,h=Yx(c,s),g=Math.exp(-f);return c2-d/h*g},i=c=>{const f=c*s*e,d=f*r+r,h=Math.pow(s,2)*Math.pow(c,2)*e,g=Math.exp(-f),m=Yx(Math.pow(c,2),s);return(-a(c)+c2>0?-1:1)*((d-h)*g)/m}):(a=c=>{const u=Math.exp(-c*e),f=(c-r)*e+1;return-c2+u*f},i=c=>{const u=Math.exp(-c*e),f=(r-c)*(e*e);return u*f});const o=5/e,l=jI(a,i,o);if(e=ql(e),isNaN(l))return{stiffness:100,damping:10,duration:e};{const c=Math.pow(l,2)*n;return{stiffness:c,damping:s*2*Math.sqrt(n*c),duration:e}}}const DI=12;function jI(e,t,r){let n=r;for(let a=1;a<DI;a++)n=n-e(n)/t(n);return n}function Yx(e,t){return e*Math.sqrt(1-t*t)}const RI=["duration","bounce"],MI=["stiffness","damping","mass"];function p4(e,t){return t.some(r=>e[r]!==void 0)}function BI(e){let t={velocity:0,stiffness:100,damping:10,mass:1,isResolvedFromDuration:!1,...e};if(!p4(e,MI)&&p4(e,RI)){const r=II(e);t={...t,...r,mass:1},t.isResolvedFromDuration=!0}return t}function K8({keyframes:e,restDelta:t,restSpeed:r,...n}){const a=e[0],i=e[e.length-1],s={done:!1,value:a},{stiffness:o,damping:l,mass:c,duration:u,velocity:f,isResolvedFromDuration:d}=BI({...n,velocity:-zs(n.velocity||0)}),h=f||0,g=l/(2*Math.sqrt(o*c)),m=i-a,_=zs(Math.sqrt(o/c)),y=Math.abs(m)<5;r||(r=y?.01:2),t||(t=y?.005:.5);let b;if(g<1){const w=Yx(_,g);b=T=>{const F=Math.exp(-g*_*T);return i-F*((h+g*_*m)/w*Math.sin(w*T)+m*Math.cos(w*T))}}else if(g===1)b=w=>i-Math.exp(-_*w)*(m+(h+_*m)*w);else{const w=_*Math.sqrt(g*g-1);b=T=>{const F=Math.exp(-g*_*T),I=Math.min(w*T,300);return i-F*((h+g*_*m)*Math.sinh(I)+w*m*Math.cosh(I))/w}}return{calculatedDuration:d&&u||null,next:w=>{const T=b(w);if(d)s.done=w>=u;else{let F=h;w!==0&&(g<1?F=G8(b,w,T):F=0);const I=Math.abs(F)<=r,A=Math.abs(i-T)<=t;s.done=I&&A}return s.value=s.done?i:T,s}}}function m4({keyframes:e,velocity:t=0,power:r=.8,timeConstant:n=325,bounceDamping:a=10,bounceStiffness:i=500,modifyTarget:s,min:o,max:l,restDelta:c=.5,restSpeed:u}){const f=e[0],d={done:!1,value:f},h=P=>o!==void 0&&P<o||l!==void 0&&P>l,g=P=>o===void 0?l:l===void 0||Math.abs(o-P)<Math.abs(l-P)?o:l;let m=r*t;const _=f+m,y=s===void 0?_:s(_);y!==_&&(m=y-f);const b=P=>-m*Math.exp(-P/n),w=P=>y+b(P),T=P=>{const j=b(P),J=w(P);d.done=Math.abs(j)<=c,d.value=d.done?y:J};let F,I;const A=P=>{h(d.value)&&(F=P,I=K8({keyframes:[d.value,g(d.value)],velocity:G8(w,P,d.value),damping:a,stiffness:i,restDelta:c,restSpeed:u}))};return A(0),{calculatedDuration:null,next:P=>{let j=!1;return!I&&F===void 0&&(j=!0,T(P),A(P)),F!==void 0&&P>F?I.next(P-F):(!j&&T(P),d)}}}const UI=e=>{const t=({timestamp:r})=>e(r);return{start:()=>pr.update(t,!0),stop:()=>Qs(t),now:()=>Mn.isProcessing?Mn.timestamp:performance.now()}},g4=2e4;function x4(e){let t=0;const r=50;let n=e.next(t);for(;!n.done&&t<g4;)t+=r,n=e.next(t);return t>=g4?1/0:t}const $I={decay:m4,inertia:m4,tween:k1,keyframes:k1,spring:K8};function E1({autoplay:e=!0,delay:t=0,driver:r=UI,keyframes:n,type:a="keyframes",repeat:i=0,repeatDelay:s=0,repeatType:o="loop",onPlay:l,onStop:c,onComplete:u,onUpdate:f,...d}){let h=1,g=!1,m,_;const y=()=>{_=new Promise(me=>{m=me})};y();let b;const w=$I[a]||k1;let T;w!==k1&&typeof n[0]!="number"&&(T=W8([0,100],n,{clamp:!1}),n=[0,100]);const F=w({...d,keyframes:n});let I;o==="mirror"&&(I=w({...d,keyframes:[...n].reverse(),velocity:-(d.velocity||0)}));let A="idle",P=null,j=null,J=null;F.calculatedDuration===null&&i&&(F.calculatedDuration=x4(F));const{calculatedDuration:N}=F;let L=1/0,G=1/0;N!==null&&(L=N+s,G=L*(i+1)-s);let W=0;const le=me=>{if(j===null)return;h>0&&(j=Math.min(j,me)),h<0&&(j=Math.min(me-G/h,j)),P!==null?W=P:W=Math.round(me-j)*h;const E=W-t*(h>=0?1:-1),D=h>=0?E<0:E>G;W=Math.max(E,0),A==="finished"&&P===null&&(W=G);let O=W,M=F;if(i){const se=Math.min(W,G)/L;let xe=Math.floor(se),Ce=se%1;!Ce&&se>=1&&(Ce=1),Ce===1&&xe--,xe=Math.min(xe,i+1),!!(xe%2)&&(o==="reverse"?(Ce=1-Ce,s&&(Ce-=s/L)):o==="mirror"&&(M=I)),O=rl(0,1,Ce)*L}const K=D?{done:!1,value:n[0]}:M.next(O);T&&(K.value=T(K.value));let{done:Y}=K;!D&&N!==null&&(Y=h>=0?W>=G:W<=0);const re=P===null&&(A==="finished"||A==="running"&&Y);return f&&f(K.value),re&&ee(),K},de=()=>{b&&b.stop(),b=void 0},X=()=>{A="idle",de(),m(),y(),j=J=null},ee=()=>{A="finished",u&&u(),de(),m()},R=()=>{if(g)return;b||(b=r(le));const me=b.now();l&&l(),P!==null?j=me-P:(!j||A==="finished")&&(j=me),A==="finished"&&y(),J=j,P=null,A="running",b.start()};e&&R();const pe={then(me,E){return _.then(me,E)},get time(){return zs(W)},set time(me){me=ql(me),W=me,P!==null||!b||h===0?P=me:j=b.now()-me/h},get duration(){const me=F.calculatedDuration===null?x4(F):F.calculatedDuration;return zs(me)},get speed(){return h},set speed(me){me===h||!b||(h=me,pe.time=zs(W))},get state(){return A},play:R,pause:()=>{A="paused",P=W},stop:()=>{g=!0,A!=="idle"&&(A="idle",c&&c(),X())},cancel:()=>{J!==null&&le(J),X()},complete:()=>{A="finished"},sample:me=>(j=0,le(me))};return pe}function VI(e){let t;return()=>(t===void 0&&(t=e()),t)}const zI=VI(()=>Object.hasOwnProperty.call(Element.prototype,"animate")),HI=new Set(["opacity","clipPath","filter","transform","backgroundColor"]),ip=10,WI=2e4,qI=(e,t)=>t.type==="spring"||e==="backgroundColor"||!E8(t.ease);function GI(e,t,{onUpdate:r,onComplete:n,...a}){if(!(zI()&&HI.has(t)&&!a.repeatDelay&&a.repeatType!=="mirror"&&a.damping!==0&&a.type!=="inertia"))return!1;let s=!1,o,l,c=!1;const u=()=>{l=new Promise(w=>{o=w})};u();let{keyframes:f,duration:d=300,ease:h,times:g}=a;if(qI(t,a)){const w=E1({...a,repeat:0,delay:0});let T={done:!1,value:f[0]};const F=[];let I=0;for(;!T.done&&I<WI;)T=w.sample(I),F.push(T.value),I+=ip;g=void 0,f=F,d=I-ip,h="linear"}const m=nI(e.owner.current,t,f,{...a,duration:d,ease:h,times:g}),_=()=>{c=!1,m.cancel()},y=()=>{c=!0,pr.update(_),o(),u()};return m.onfinish=()=>{c||(e.set(aI(f,a)),n&&n(),y())},{then(w,T){return l.then(w,T)},attachTimeline(w){return m.timeline=w,m.onfinish=null,zr},get time(){return zs(m.currentTime||0)},set time(w){m.currentTime=ql(w)},get speed(){return m.playbackRate},set speed(w){m.playbackRate=w},get duration(){return zs(d)},play:()=>{s||(m.play(),Qs(_))},pause:()=>m.pause(),stop:()=>{if(s=!0,m.playState==="idle")return;const{currentTime:w}=m;if(w){const T=E1({...a,autoplay:!1});e.setWithVelocity(T.sample(w-ip).value,T.sample(w).value,ip)}y()},complete:()=>{c||m.finish()},cancel:y}}function KI({keyframes:e,delay:t,onUpdate:r,onComplete:n}){const a=()=>(r&&r(e[e.length-1]),n&&n(),{time:0,speed:1,duration:0,play:zr,pause:zr,stop:zr,then:i=>(i(),Promise.resolve()),cancel:zr,complete:zr});return t?E1({keyframes:[0,1],duration:0,delay:t,onComplete:a}):a()}const XI={type:"spring",stiffness:500,damping:25,restSpeed:10},YI=e=>({type:"spring",stiffness:550,damping:e===0?2*Math.sqrt(550):30,restSpeed:10}),JI={type:"keyframes",duration:.8},QI={type:"keyframes",ease:[.25,.1,.35,1],duration:.3},ZI=(e,{keyframes:t})=>t.length>2?JI:fc.has(e)?e.startsWith("scale")?YI(t[1]):XI:QI,Jx=(e,t)=>e==="zIndex"?!1:!!(typeof t=="number"||Array.isArray(t)||typeof t=="string"&&(nl.test(t)||t==="0")&&!t.startsWith("url(")),eD=new Set(["brightness","contrast","saturate","opacity"]);function tD(e){const[t,r]=e.slice(0,-1).split("(");if(t==="drop-shadow")return e;const[n]=r.match(_m)||[];if(!n)return e;const a=r.replace(n,"");let i=eD.has(t)?1:0;return n!==r&&(i*=100),t+"("+i+a+")"}const rD=/([a-z-]*)\(.*?\)/g,Qx={...nl,getAnimatableNone:e=>{const t=e.match(rD);return t?t.map(tD).join(" "):e}},nD={...l8,color:Jn,backgroundColor:Jn,outlineColor:Jn,fill:Jn,stroke:Jn,borderColor:Jn,borderTopColor:Jn,borderRightColor:Jn,borderBottomColor:Jn,borderLeftColor:Jn,filter:Qx,WebkitFilter:Qx},r5=e=>nD[e];function X8(e,t){let r=r5(e);return r!==Qx&&(r=nl),r.getAnimatableNone?r.getAnimatableNone(t):void 0}const Y8=e=>/^0[^.\s]+$/.test(e);function aD(e){if(typeof e=="number")return e===0;if(e!==null)return e==="none"||e==="0"||Y8(e)}function iD(e,t,r,n){const a=Jx(t,r);let i;Array.isArray(r)?i=[...r]:i=[null,r];const s=n.from!==void 0?n.from:e.get();let o;const l=[];for(let c=0;c<i.length;c++)i[c]===null&&(i[c]=c===0?s:i[c-1]),aD(i[c])&&l.push(c),typeof i[c]=="string"&&i[c]!=="none"&&i[c]!=="0"&&(o=i[c]);if(a&&l.length&&o)for(let c=0;c<l.length;c++){const u=l[c];i[u]=X8(t,o)}return i}function sD({when:e,delay:t,delayChildren:r,staggerChildren:n,staggerDirection:a,repeat:i,repeatType:s,repeatDelay:o,from:l,elapsed:c,...u}){return!!Object.keys(u).length}function n5(e,t){return e[t]||e.default||e}const oD={skipAnimations:!1},a5=(e,t,r,n={})=>a=>{const i=n5(n,e)||{},s=i.delay||n.delay||0;let{elapsed:o=0}=n;o=o-ql(s);const l=iD(t,e,r,i),c=l[0],u=l[l.length-1],f=Jx(e,c),d=Jx(e,u);let h={keyframes:l,velocity:t.getVelocity(),ease:"easeOut",...i,delay:-o,onUpdate:g=>{t.set(g),i.onUpdate&&i.onUpdate(g)},onComplete:()=>{a(),i.onComplete&&i.onComplete()}};if(sD(i)||(h={...h,...ZI(e,h)}),h.duration&&(h.duration=ql(h.duration)),h.repeatDelay&&(h.repeatDelay=ql(h.repeatDelay)),!f||!d||rI.current||i.type===!1||oD.skipAnimations)return KI(h);if(!n.isHandoff&&t.owner&&t.owner.current instanceof HTMLElement&&!t.owner.getProps().onUpdate){const g=GI(t,e,h);if(g)return g}return E1(h)};function A1(e){return!!(_a(e)&&e.add)}const J8=e=>/^\-?\d*\.?\d+$/.test(e);function i5(e,t){e.indexOf(t)===-1&&e.push(t)}function s5(e,t){const r=e.indexOf(t);r>-1&&e.splice(r,1)}class o5{constructor(){this.subscriptions=[]}add(t){return i5(this.subscriptions,t),()=>s5(this.subscriptions,t)}notify(t,r,n){const a=this.subscriptions.length;if(a)if(a===1)this.subscriptions[0](t,r,n);else for(let i=0;i<a;i++){const s=this.subscriptions[i];s&&s(t,r,n)}}getSize(){return this.subscriptions.length}clear(){this.subscriptions.length=0}}const lD=e=>!isNaN(parseFloat(e));class cD{constructor(t,r={}){this.version="10.18.0",this.timeDelta=0,this.lastUpdated=0,this.canTrackVelocity=!1,this.events={},this.updateAndNotify=(n,a=!0)=>{this.prev=this.current,this.current=n;const{delta:i,timestamp:s}=Mn;this.lastUpdated!==s&&(this.timeDelta=i,this.lastUpdated=s,pr.postRender(this.scheduleVelocityCheck)),this.prev!==this.current&&this.events.change&&this.events.change.notify(this.current),this.events.velocityChange&&this.events.velocityChange.notify(this.getVelocity()),a&&this.events.renderRequest&&this.events.renderRequest.notify(this.current)},this.scheduleVelocityCheck=()=>pr.postRender(this.velocityCheck),this.velocityCheck=({timestamp:n})=>{n!==this.lastUpdated&&(this.prev=this.current,this.events.velocityChange&&this.events.velocityChange.notify(this.getVelocity()))},this.hasAnimated=!1,this.prev=this.current=t,this.canTrackVelocity=lD(this.current),this.owner=r.owner}onChange(t){return this.on("change",t)}on(t,r){this.events[t]||(this.events[t]=new o5);const n=this.events[t].add(r);return t==="change"?()=>{n(),pr.read(()=>{this.events.change.getSize()||this.stop()})}:n}clearListeners(){for(const t in this.events)this.events[t].clear()}attach(t,r){this.passiveEffect=t,this.stopPassiveEffect=r}set(t,r=!0){!r||!this.passiveEffect?this.updateAndNotify(t,r):this.passiveEffect(t,this.updateAndNotify)}setWithVelocity(t,r,n){this.set(r),this.prev=t,this.timeDelta=n}jump(t){this.updateAndNotify(t),this.prev=t,this.stop(),this.stopPassiveEffect&&this.stopPassiveEffect()}get(){return this.current}getPrevious(){return this.prev}getVelocity(){return this.canTrackVelocity?q8(parseFloat(this.current)-parseFloat(this.prev),this.timeDelta):0}start(t){return this.stop(),new Promise(r=>{this.hasAnimated=!0,this.animation=t(r),this.events.animationStart&&this.events.animationStart.notify()}).then(()=>{this.events.animationComplete&&this.events.animationComplete.notify(),this.clearAnimation()})}stop(){this.animation&&(this.animation.stop(),this.events.animationCancel&&this.events.animationCancel.notify()),this.clearAnimation()}isAnimating(){return!!this.animation}clearAnimation(){delete this.animation}destroy(){this.clearListeners(),this.stop(),this.stopPassiveEffect&&this.stopPassiveEffect()}}function Wu(e,t){return new cD(e,t)}const Q8=e=>t=>t.test(e),uD={test:e=>e==="auto",parse:e=>e},Z8=[hc,xt,us,Ao,vO,xO,uD],G0=e=>Z8.find(Q8(e)),fD=[...Z8,Jn,nl],hD=e=>fD.find(Q8(e));function dD(e,t,r){e.hasValue(t)?e.getValue(t).set(r):e.addValue(t,Wu(r))}function pD(e,t){const r=km(e,t);let{transitionEnd:n={},transition:a={},...i}=r?e.makeTargetAnimatable(r,!1):{};i={...i,...n};for(const s in i){const o=FO(i[s]);dD(e,s,o)}}function mD(e,t,r){var n,a;const i=Object.keys(t).filter(o=>!e.hasValue(o)),s=i.length;if(s)for(let o=0;o<s;o++){const l=i[o],c=t[l];let u=null;Array.isArray(c)&&(u=c[0]),u===null&&(u=(a=(n=r[l])!==null&&n!==void 0?n:e.readValue(l))!==null&&a!==void 0?a:t[l]),u!=null&&(typeof u=="string"&&(J8(u)||Y8(u))?u=parseFloat(u):!hD(u)&&nl.test(c)&&(u=X8(l,c)),e.addValue(l,Wu(u,{owner:e})),r[l]===void 0&&(r[l]=u),u!==null&&e.setBaseTarget(l,u))}}function gD(e,t){return t?(t[e]||t.default||t).from:void 0}function xD(e,t,r){const n={};for(const a in e){const i=gD(a,t);if(i!==void 0)n[a]=i;else{const s=r.getValue(a);s&&(n[a]=s.get())}}return n}function vD({protectedKeys:e,needsAnimating:t},r){const n=e.hasOwnProperty(r)&&t[r]!==!0;return t[r]=!1,n}function yD(e,t){const r=e.get();if(Array.isArray(t)){for(let n=0;n<t.length;n++)if(t[n]!==r)return!0}else return r!==t}function eE(e,t,{delay:r=0,transitionOverride:n,type:a}={}){let{transition:i=e.getDefaultTransition(),transitionEnd:s,...o}=e.makeTargetAnimatable(t);const l=e.getValue("willChange");n&&(i=n);const c=[],u=a&&e.animationState&&e.animationState.getState()[a];for(const f in o){const d=e.getValue(f),h=o[f];if(!d||h===void 0||u&&vD(u,f))continue;const g={delay:r,elapsed:0,...n5(i||{},f)};if(window.HandoffAppearAnimations){const y=e.getProps()[t8];if(y){const b=window.HandoffAppearAnimations(y,f,d,pr);b!==null&&(g.elapsed=b,g.isHandoff=!0)}}let m=!g.isHandoff&&!yD(d,h);if(g.type==="spring"&&(d.getVelocity()||g.velocity)&&(m=!1),d.animation&&(m=!1),m)continue;d.start(a5(f,d,h,e.shouldReduceMotion&&fc.has(f)?{type:!1}:g));const _=d.animation;A1(l)&&(l.add(f),_.then(()=>l.remove(f))),c.push(_)}return s&&Promise.all(c).then(()=>{s&&pD(e,s)}),c}function Zx(e,t,r={}){const n=km(e,t,r.custom);let{transition:a=e.getDefaultTransition()||{}}=n||{};r.transitionOverride&&(a=r.transitionOverride);const i=n?()=>Promise.all(eE(e,n,r)):()=>Promise.resolve(),s=e.variantChildren&&e.variantChildren.size?(l=0)=>{const{delayChildren:c=0,staggerChildren:u,staggerDirection:f}=a;return wD(e,t,c+l,u,f,r)}:()=>Promise.resolve(),{when:o}=a;if(o){const[l,c]=o==="beforeChildren"?[i,s]:[s,i];return l().then(()=>c())}else return Promise.all([i(),s(r.delay)])}function wD(e,t,r=0,n=0,a=1,i){const s=[],o=(e.variantChildren.size-1)*n,l=a===1?(c=0)=>c*n:(c=0)=>o-c*n;return Array.from(e.variantChildren).sort(bD).forEach((c,u)=>{c.notify("AnimationStart",t),s.push(Zx(c,t,{...i,delay:r+l(u)}).then(()=>c.notify("AnimationComplete",t)))}),Promise.all(s)}function bD(e,t){return e.sortNodePosition(t)}function _D(e,t,r={}){e.notify("AnimationStart",t);let n;if(Array.isArray(t)){const a=t.map(i=>Zx(e,i,r));n=Promise.all(a)}else if(typeof t=="string")n=Zx(e,t,r);else{const a=typeof t=="function"?km(e,t,r.custom):t;n=Promise.all(eE(e,a,r))}return n.then(()=>e.notify("AnimationComplete",t))}const SD=[...zy].reverse(),kD=zy.length;function ED(e){return t=>Promise.all(t.map(({animation:r,options:n})=>_D(e,r,n)))}function AD(e){let t=ED(e);const r=CD();let n=!0;const a=(l,c)=>{const u=km(e,c);if(u){const{transition:f,transitionEnd:d,...h}=u;l={...l,...h,...d}}return l};function i(l){t=l(e)}function s(l,c){const u=e.getProps(),f=e.getVariantContext(!0)||{},d=[],h=new Set;let g={},m=1/0;for(let y=0;y<kD;y++){const b=SD[y],w=r[b],T=u[b]!==void 0?u[b]:f[b],F=sh(T),I=b===c?w.isActive:null;I===!1&&(m=y);let A=T===f[b]&&T!==u[b]&&F;if(A&&n&&e.manuallyAnimateOnMount&&(A=!1),w.protectedKeys={...g},!w.isActive&&I===null||!T&&!w.prevProp||wm(T)||typeof T=="boolean")continue;let j=TD(w.prevProp,T)||b===c&&w.isActive&&!A&&F||y>m&&F,J=!1;const N=Array.isArray(T)?T:[T];let L=N.reduce(a,{});I===!1&&(L={});const{prevResolvedValues:G={}}=w,W={...G,...L},le=de=>{j=!0,h.has(de)&&(J=!0,h.delete(de)),w.needsAnimating[de]=!0};for(const de in W){const X=L[de],ee=G[de];if(g.hasOwnProperty(de))continue;let R=!1;b1(X)&&b1(ee)?R=!S8(X,ee):R=X!==ee,R?X!==void 0?le(de):h.add(de):X!==void 0&&h.has(de)?le(de):w.protectedKeys[de]=!0}w.prevProp=T,w.prevResolvedValues=L,w.isActive&&(g={...g,...L}),n&&e.blockInitialAnimation&&(j=!1),j&&(!A||J)&&d.push(...N.map(de=>({animation:de,options:{type:b,...l}})))}if(h.size){const y={};h.forEach(b=>{const w=e.getBaseTarget(b);w!==void 0&&(y[b]=w)}),d.push({animation:y})}let _=!!d.length;return n&&(u.initial===!1||u.initial===u.animate)&&!e.manuallyAnimateOnMount&&(_=!1),n=!1,_?t(d):Promise.resolve()}function o(l,c,u){var f;if(r[l].isActive===c)return Promise.resolve();(f=e.variantChildren)===null||f===void 0||f.forEach(h=>{var g;return(g=h.animationState)===null||g===void 0?void 0:g.setActive(l,c)}),r[l].isActive=c;const d=s(u,l);for(const h in r)r[h].protectedKeys={};return d}return{animateChanges:s,setActive:o,setAnimateFunction:i,getState:()=>r}}function TD(e,t){return typeof t=="string"?t!==e:Array.isArray(t)?!S8(t,e):!1}function Al(e=!1){return{isActive:e,protectedKeys:{},needsAnimating:{},prevResolvedValues:{}}}function CD(){return{animate:Al(!0),whileInView:Al(),whileHover:Al(),whileTap:Al(),whileDrag:Al(),whileFocus:Al(),exit:Al()}}class ND extends dl{constructor(t){super(t),t.animationState||(t.animationState=AD(t))}updateAnimationControlsSubscription(){const{animate:t}=this.node.getProps();this.unmount(),wm(t)&&(this.unmount=t.subscribe(this.node))}mount(){this.updateAnimationControlsSubscription()}update(){const{animate:t}=this.node.getProps(),{animate:r}=this.node.prevProps||{};t!==r&&this.updateAnimationControlsSubscription()}unmount(){}}let PD=0;class LD extends dl{constructor(){super(...arguments),this.id=PD++}update(){if(!this.node.presenceContext)return;const{isPresent:t,onExitComplete:r,custom:n}=this.node.presenceContext,{isPresent:a}=this.node.prevPresenceContext||{};if(!this.node.animationState||t===a)return;const i=this.node.animationState.setActive("exit",!t,{custom:n??this.node.getProps().custom});r&&!t&&i.then(()=>r(this.id))}mount(){const{register:t}=this.node.presenceContext||{};t&&(this.unmount=t(this.id))}unmount(){}}const FD={animation:{Feature:ND},exit:{Feature:LD}},v4=(e,t)=>Math.abs(e-t);function OD(e,t){const r=v4(e.x,t.x),n=v4(e.y,t.y);return Math.sqrt(r**2+n**2)}class tE{constructor(t,r,{transformPagePoint:n,contextWindow:a,dragSnapToOrigin:i=!1}={}){if(this.startEvent=null,this.lastMoveEvent=null,this.lastMoveEventInfo=null,this.handlers={},this.contextWindow=window,this.updatePoint=()=>{if(!(this.lastMoveEvent&&this.lastMoveEventInfo))return;const f=f2(this.lastMoveEventInfo,this.history),d=this.startEvent!==null,h=OD(f.offset,{x:0,y:0})>=3;if(!d&&!h)return;const{point:g}=f,{timestamp:m}=Mn;this.history.push({...g,timestamp:m});const{onStart:_,onMove:y}=this.handlers;d||(_&&_(this.lastMoveEvent,f),this.startEvent=this.lastMoveEvent),y&&y(this.lastMoveEvent,f)},this.handlePointerMove=(f,d)=>{this.lastMoveEvent=f,this.lastMoveEventInfo=u2(d,this.transformPagePoint),pr.update(this.updatePoint,!0)},this.handlePointerUp=(f,d)=>{this.end();const{onEnd:h,onSessionEnd:g,resumeAnimation:m}=this.handlers;if(this.dragSnapToOrigin&&m&&m(),!(this.lastMoveEvent&&this.lastMoveEventInfo))return;const _=f2(f.type==="pointercancel"?this.lastMoveEventInfo:u2(d,this.transformPagePoint),this.history);this.startEvent&&h&&h(f,_),g&&g(f,_)},!v8(t))return;this.dragSnapToOrigin=i,this.handlers=r,this.transformPagePoint=n,this.contextWindow=a||window;const s=Sm(t),o=u2(s,this.transformPagePoint),{point:l}=o,{timestamp:c}=Mn;this.history=[{...l,timestamp:c}];const{onSessionStart:u}=r;u&&u(t,f2(o,this.history)),this.removeListeners=Jo(Vs(this.contextWindow,"pointermove",this.handlePointerMove),Vs(this.contextWindow,"pointerup",this.handlePointerUp),Vs(this.contextWindow,"pointercancel",this.handlePointerUp))}updateHandlers(t){this.handlers=t}end(){this.removeListeners&&this.removeListeners(),Qs(this.updatePoint)}}function u2(e,t){return t?{point:t(e.point)}:e}function y4(e,t){return{x:e.x-t.x,y:e.y-t.y}}function f2({point:e},t){return{point:e,delta:y4(e,rE(t)),offset:y4(e,ID(t)),velocity:DD(t,.1)}}function ID(e){return e[0]}function rE(e){return e[e.length-1]}function DD(e,t){if(e.length<2)return{x:0,y:0};let r=e.length-1,n=null;const a=rE(e);for(;r>=0&&(n=e[r],!(a.timestamp-n.timestamp>ql(t)));)r--;if(!n)return{x:0,y:0};const i=zs(a.timestamp-n.timestamp);if(i===0)return{x:0,y:0};const s={x:(a.x-n.x)/i,y:(a.y-n.y)/i};return s.x===1/0&&(s.x=0),s.y===1/0&&(s.y=0),s}function Ma(e){return e.max-e.min}function ev(e,t=0,r=.01){return Math.abs(e-t)<=r}function w4(e,t,r,n=.5){e.origin=n,e.originPoint=kr(t.min,t.max,e.origin),e.scale=Ma(r)/Ma(t),(ev(e.scale,1,1e-4)||isNaN(e.scale))&&(e.scale=1),e.translate=kr(r.min,r.max,e.origin)-e.originPoint,(ev(e.translate)||isNaN(e.translate))&&(e.translate=0)}function Ef(e,t,r,n){w4(e.x,t.x,r.x,n?n.originX:void 0),w4(e.y,t.y,r.y,n?n.originY:void 0)}function b4(e,t,r){e.min=r.min+t.min,e.max=e.min+Ma(t)}function jD(e,t,r){b4(e.x,t.x,r.x),b4(e.y,t.y,r.y)}function _4(e,t,r){e.min=t.min-r.min,e.max=e.min+Ma(t)}function Af(e,t,r){_4(e.x,t.x,r.x),_4(e.y,t.y,r.y)}function RD(e,{min:t,max:r},n){return t!==void 0&&e<t?e=n?kr(t,e,n.min):Math.max(e,t):r!==void 0&&e>r&&(e=n?kr(r,e,n.max):Math.min(e,r)),e}function S4(e,t,r){return{min:t!==void 0?e.min+t:void 0,max:r!==void 0?e.max+r-(e.max-e.min):void 0}}function MD(e,{top:t,left:r,bottom:n,right:a}){return{x:S4(e.x,r,a),y:S4(e.y,t,n)}}function k4(e,t){let r=t.min-e.min,n=t.max-e.max;return t.max-t.min<e.max-e.min&&([r,n]=[n,r]),{min:r,max:n}}function BD(e,t){return{x:k4(e.x,t.x),y:k4(e.y,t.y)}}function UD(e,t){let r=.5;const n=Ma(e),a=Ma(t);return a>n?r=lh(t.min,t.max-n,e.min):n>a&&(r=lh(e.min,e.max-a,t.min)),rl(0,1,r)}function $D(e,t){const r={};return t.min!==void 0&&(r.min=t.min-e.min),t.max!==void 0&&(r.max=t.max-e.min),r}const tv=.35;function VD(e=tv){return e===!1?e=0:e===!0&&(e=tv),{x:E4(e,"left","right"),y:E4(e,"top","bottom")}}function E4(e,t,r){return{min:A4(e,t),max:A4(e,r)}}function A4(e,t){return typeof e=="number"?e:e[t]||0}const T4=()=>({translate:0,scale:1,origin:0,originPoint:0}),xu=()=>({x:T4(),y:T4()}),C4=()=>({min:0,max:0}),Xr=()=>({x:C4(),y:C4()});function ti(e){return[e("x"),e("y")]}function nE({top:e,left:t,right:r,bottom:n}){return{x:{min:t,max:r},y:{min:e,max:n}}}function zD({x:e,y:t}){return{top:t.min,right:e.max,bottom:t.max,left:e.min}}function HD(e,t){if(!t)return e;const r=t({x:e.left,y:e.top}),n=t({x:e.right,y:e.bottom});return{top:r.y,left:r.x,bottom:n.y,right:n.x}}function h2(e){return e===void 0||e===1}function rv({scale:e,scaleX:t,scaleY:r}){return!h2(e)||!h2(t)||!h2(r)}function Pl(e){return rv(e)||aE(e)||e.z||e.rotate||e.rotateX||e.rotateY}function aE(e){return N4(e.x)||N4(e.y)}function N4(e){return e&&e!=="0%"}function T1(e,t,r){const n=e-r,a=t*n;return r+a}function P4(e,t,r,n,a){return a!==void 0&&(e=T1(e,a,n)),T1(e,r,n)+t}function nv(e,t=0,r=1,n,a){e.min=P4(e.min,t,r,n,a),e.max=P4(e.max,t,r,n,a)}function iE(e,{x:t,y:r}){nv(e.x,t.translate,t.scale,t.originPoint),nv(e.y,r.translate,r.scale,r.originPoint)}function WD(e,t,r,n=!1){const a=r.length;if(!a)return;t.x=t.y=1;let i,s;for(let o=0;o<a;o++){i=r[o],s=i.projectionDelta;const l=i.instance;l&&l.style&&l.style.display==="contents"||(n&&i.options.layoutScroll&&i.scroll&&i!==i.root&&vu(e,{x:-i.scroll.offset.x,y:-i.scroll.offset.y}),s&&(t.x*=s.x.scale,t.y*=s.y.scale,iE(e,s)),n&&Pl(i.latestValues)&&vu(e,i.latestValues))}t.x=L4(t.x),t.y=L4(t.y)}function L4(e){return Number.isInteger(e)||e>1.0000000000001||e<.999999999999?e:1}function Po(e,t){e.min=e.min+t,e.max=e.max+t}function F4(e,t,[r,n,a]){const i=t[a]!==void 0?t[a]:.5,s=kr(e.min,e.max,i);nv(e,t[r],t[n],s,t.scale)}const qD=["x","scaleX","originX"],GD=["y","scaleY","originY"];function vu(e,t){F4(e.x,t,qD),F4(e.y,t,GD)}function sE(e,t){return nE(HD(e.getBoundingClientRect(),t))}function KD(e,t,r){const n=sE(e,r),{scroll:a}=t;return a&&(Po(n.x,a.offset.x),Po(n.y,a.offset.y)),n}const oE=({current:e})=>e?e.ownerDocument.defaultView:null,XD=new WeakMap;class YD{constructor(t){this.openGlobalLock=null,this.isDragging=!1,this.currentDirection=null,this.originPoint={x:0,y:0},this.constraints=!1,this.hasMutatedConstraints=!1,this.elastic=Xr(),this.visualElement=t}start(t,{snapToCursor:r=!1}={}){const{presenceContext:n}=this.visualElement;if(n&&n.isPresent===!1)return;const a=u=>{const{dragSnapToOrigin:f}=this.getProps();f?this.pauseAnimation():this.stopAnimation(),r&&this.snapToCursor(Sm(u,"page").point)},i=(u,f)=>{const{drag:d,dragPropagation:h,onDragStart:g}=this.getProps();if(d&&!h&&(this.openGlobalLock&&this.openGlobalLock(),this.openGlobalLock=w8(d),!this.openGlobalLock))return;this.isDragging=!0,this.currentDirection=null,this.resolveConstraints(),this.visualElement.projection&&(this.visualElement.projection.isAnimationBlocked=!0,this.visualElement.projection.target=void 0),ti(_=>{let y=this.getAxisMotionValue(_).get()||0;if(us.test(y)){const{projection:b}=this.visualElement;if(b&&b.layout){const w=b.layout.layoutBox[_];w&&(y=Ma(w)*(parseFloat(y)/100))}}this.originPoint[_]=y}),g&&pr.update(()=>g(u,f),!1,!0);const{animationState:m}=this.visualElement;m&&m.setActive("whileDrag",!0)},s=(u,f)=>{const{dragPropagation:d,dragDirectionLock:h,onDirectionLock:g,onDrag:m}=this.getProps();if(!d&&!this.openGlobalLock)return;const{offset:_}=f;if(h&&this.currentDirection===null){this.currentDirection=JD(_),this.currentDirection!==null&&g&&g(this.currentDirection);return}this.updateAxis("x",f.point,_),this.updateAxis("y",f.point,_),this.visualElement.render(),m&&m(u,f)},o=(u,f)=>this.stop(u,f),l=()=>ti(u=>{var f;return this.getAnimationState(u)==="paused"&&((f=this.getAxisMotionValue(u).animation)===null||f===void 0?void 0:f.play())}),{dragSnapToOrigin:c}=this.getProps();this.panSession=new tE(t,{onSessionStart:a,onStart:i,onMove:s,onSessionEnd:o,resumeAnimation:l},{transformPagePoint:this.visualElement.getTransformPagePoint(),dragSnapToOrigin:c,contextWindow:oE(this.visualElement)})}stop(t,r){const n=this.isDragging;if(this.cancel(),!n)return;const{velocity:a}=r;this.startAnimation(a);const{onDragEnd:i}=this.getProps();i&&pr.update(()=>i(t,r))}cancel(){this.isDragging=!1;const{projection:t,animationState:r}=this.visualElement;t&&(t.isAnimationBlocked=!1),this.panSession&&this.panSession.end(),this.panSession=void 0;const{dragPropagation:n}=this.getProps();!n&&this.openGlobalLock&&(this.openGlobalLock(),this.openGlobalLock=null),r&&r.setActive("whileDrag",!1)}updateAxis(t,r,n){const{drag:a}=this.getProps();if(!n||!sp(t,a,this.currentDirection))return;const i=this.getAxisMotionValue(t);let s=this.originPoint[t]+n[t];this.constraints&&this.constraints[t]&&(s=RD(s,this.constraints[t],this.elastic[t])),i.set(s)}resolveConstraints(){var t;const{dragConstraints:r,dragElastic:n}=this.getProps(),a=this.visualElement.projection&&!this.visualElement.projection.layout?this.visualElement.projection.measure(!1):(t=this.visualElement.projection)===null||t===void 0?void 0:t.layout,i=this.constraints;r&&mu(r)?this.constraints||(this.constraints=this.resolveRefConstraints()):r&&a?this.constraints=MD(a.layoutBox,r):this.constraints=!1,this.elastic=VD(n),i!==this.constraints&&a&&this.constraints&&!this.hasMutatedConstraints&&ti(s=>{this.getAxisMotionValue(s)&&(this.constraints[s]=$D(a.layoutBox[s],this.constraints[s]))})}resolveRefConstraints(){const{dragConstraints:t,onMeasureDragConstraints:r}=this.getProps();if(!t||!mu(t))return!1;const n=t.current,{projection:a}=this.visualElement;if(!a||!a.layout)return!1;const i=KD(n,a.root,this.visualElement.getTransformPagePoint());let s=BD(a.layout.layoutBox,i);if(r){const o=r(zD(s));this.hasMutatedConstraints=!!o,o&&(s=nE(o))}return s}startAnimation(t){const{drag:r,dragMomentum:n,dragElastic:a,dragTransition:i,dragSnapToOrigin:s,onDragTransitionEnd:o}=this.getProps(),l=this.constraints||{},c=ti(u=>{if(!sp(u,r,this.currentDirection))return;let f=l&&l[u]||{};s&&(f={min:0,max:0});const d=a?200:1e6,h=a?40:1e7,g={type:"inertia",velocity:n?t[u]:0,bounceStiffness:d,bounceDamping:h,timeConstant:750,restDelta:1,restSpeed:10,...i,...f};return this.startAxisValueAnimation(u,g)});return Promise.all(c).then(o)}startAxisValueAnimation(t,r){const n=this.getAxisMotionValue(t);return n.start(a5(t,n,0,r))}stopAnimation(){ti(t=>this.getAxisMotionValue(t).stop())}pauseAnimation(){ti(t=>{var r;return(r=this.getAxisMotionValue(t).animation)===null||r===void 0?void 0:r.pause()})}getAnimationState(t){var r;return(r=this.getAxisMotionValue(t).animation)===null||r===void 0?void 0:r.state}getAxisMotionValue(t){const r="_drag"+t.toUpperCase(),n=this.visualElement.getProps(),a=n[r];return a||this.visualElement.getValue(t,(n.initial?n.initial[t]:void 0)||0)}snapToCursor(t){ti(r=>{const{drag:n}=this.getProps();if(!sp(r,n,this.currentDirection))return;const{projection:a}=this.visualElement,i=this.getAxisMotionValue(r);if(a&&a.layout){const{min:s,max:o}=a.layout.layoutBox[r];i.set(t[r]-kr(s,o,.5))}})}scalePositionWithinConstraints(){if(!this.visualElement.current)return;const{drag:t,dragConstraints:r}=this.getProps(),{projection:n}=this.visualElement;if(!mu(r)||!n||!this.constraints)return;this.stopAnimation();const a={x:0,y:0};ti(s=>{const o=this.getAxisMotionValue(s);if(o){const l=o.get();a[s]=UD({min:l,max:l},this.constraints[s])}});const{transformTemplate:i}=this.visualElement.getProps();this.visualElement.current.style.transform=i?i({},""):"none",n.root&&n.root.updateScroll(),n.updateLayout(),this.resolveConstraints(),ti(s=>{if(!sp(s,t,null))return;const o=this.getAxisMotionValue(s),{min:l,max:c}=this.constraints[s];o.set(kr(l,c,a[s]))})}addListeners(){if(!this.visualElement.current)return;XD.set(this.visualElement,this);const t=this.visualElement.current,r=Vs(t,"pointerdown",l=>{const{drag:c,dragListener:u=!0}=this.getProps();c&&u&&this.start(l)}),n=()=>{const{dragConstraints:l}=this.getProps();mu(l)&&(this.constraints=this.resolveRefConstraints())},{projection:a}=this.visualElement,i=a.addEventListener("measure",n);a&&!a.layout&&(a.root&&a.root.updateScroll(),a.updateLayout()),n();const s=Ms(window,"resize",()=>this.scalePositionWithinConstraints()),o=a.addEventListener("didUpdate",({delta:l,hasLayoutChanged:c})=>{this.isDragging&&c&&(ti(u=>{const f=this.getAxisMotionValue(u);f&&(this.originPoint[u]+=l[u].translate,f.set(f.get()+l[u].translate))}),this.visualElement.render())});return()=>{s(),r(),i(),o&&o()}}getProps(){const t=this.visualElement.getProps(),{drag:r=!1,dragDirectionLock:n=!1,dragPropagation:a=!1,dragConstraints:i=!1,dragElastic:s=tv,dragMomentum:o=!0}=t;return{...t,drag:r,dragDirectionLock:n,dragPropagation:a,dragConstraints:i,dragElastic:s,dragMomentum:o}}}function sp(e,t,r){return(t===!0||t===e)&&(r===null||r===e)}function JD(e,t=10){let r=null;return Math.abs(e.y)>t?r="y":Math.abs(e.x)>t&&(r="x"),r}class QD extends dl{constructor(t){super(t),this.removeGroupControls=zr,this.removeListeners=zr,this.controls=new YD(t)}mount(){const{dragControls:t}=this.node.getProps();t&&(this.removeGroupControls=t.subscribe(this.controls)),this.removeListeners=this.controls.addListeners()||zr}unmount(){this.removeGroupControls(),this.removeListeners()}}const O4=e=>(t,r)=>{e&&pr.update(()=>e(t,r))};class ZD extends dl{constructor(){super(...arguments),this.removePointerDownListener=zr}onPointerDown(t){this.session=new tE(t,this.createPanHandlers(),{transformPagePoint:this.node.getTransformPagePoint(),contextWindow:oE(this.node)})}createPanHandlers(){const{onPanSessionStart:t,onPanStart:r,onPan:n,onPanEnd:a}=this.node.getProps();return{onSessionStart:O4(t),onStart:O4(r),onMove:n,onEnd:(i,s)=>{delete this.session,a&&pr.update(()=>a(i,s))}}}mount(){this.removePointerDownListener=Vs(this.node.current,"pointerdown",t=>this.onPointerDown(t))}update(){this.session&&this.session.updateHandlers(this.createPanHandlers())}unmount(){this.removePointerDownListener(),this.session&&this.session.end()}}function ej(){const e=ie.useContext(vm);if(e===null)return[!0,null];const{isPresent:t,onExitComplete:r,register:n}=e,a=ie.useId();return ie.useEffect(()=>n(a),[]),!t&&r?[!1,()=>r&&r(a)]:[!0]}const Mp={hasAnimatedSinceResize:!0,hasEverUpdated:!1};function I4(e,t){return t.max===t.min?0:e/(t.max-t.min)*100}const K0={correct:(e,t)=>{if(!t.target)return e;if(typeof e=="string")if(xt.test(e))e=parseFloat(e);else return e;const r=I4(e,t.target.x),n=I4(e,t.target.y);return`${r}% ${n}%`}},tj={correct:(e,{treeScale:t,projectionDelta:r})=>{const n=e,a=nl.parse(e);if(a.length>5)return n;const i=nl.createTransformer(e),s=typeof a[0]!="number"?1:0,o=r.x.scale*t.x,l=r.y.scale*t.y;a[0+s]/=o,a[1+s]/=l;const c=kr(o,l,.5);return typeof a[2+s]=="number"&&(a[2+s]/=c),typeof a[3+s]=="number"&&(a[3+s]/=c),i(a)}};class rj extends Fi.Component{componentDidMount(){const{visualElement:t,layoutGroup:r,switchLayoutGroup:n,layoutId:a}=this.props,{projection:i}=t;uO(nj),i&&(r.group&&r.group.add(i),n&&n.register&&a&&n.register(i),i.root.didUpdate(),i.addEventListener("animationComplete",()=>{this.safeToRemove()}),i.setOptions({...i.options,onExitComplete:()=>this.safeToRemove()})),Mp.hasEverUpdated=!0}getSnapshotBeforeUpdate(t){const{layoutDependency:r,visualElement:n,drag:a,isPresent:i}=this.props,s=n.projection;return s&&(s.isPresent=i,a||t.layoutDependency!==r||r===void 0?s.willUpdate():this.safeToRemove(),t.isPresent!==i&&(i?s.promote():s.relegate()||pr.postRender(()=>{const o=s.getStack();(!o||!o.members.length)&&this.safeToRemove()}))),null}componentDidUpdate(){const{projection:t}=this.props.visualElement;t&&(t.root.didUpdate(),queueMicrotask(()=>{!t.currentAnimation&&t.isLead()&&this.safeToRemove()}))}componentWillUnmount(){const{visualElement:t,layoutGroup:r,switchLayoutGroup:n}=this.props,{projection:a}=t;a&&(a.scheduleCheckAfterUnmount(),r&&r.group&&r.group.remove(a),n&&n.deregister&&n.deregister(a))}safeToRemove(){const{safeToRemove:t}=this.props;t&&t()}render(){return null}}function lE(e){const[t,r]=ej(),n=ie.useContext(Wy);return Fi.createElement(rj,{...e,layoutGroup:n,switchLayoutGroup:ie.useContext(n8),isPresent:t,safeToRemove:r})}const nj={borderRadius:{...K0,applyTo:["borderTopLeftRadius","borderTopRightRadius","borderBottomLeftRadius","borderBottomRightRadius"]},borderTopLeftRadius:K0,borderTopRightRadius:K0,borderBottomLeftRadius:K0,borderBottomRightRadius:K0,boxShadow:tj},cE=["TopLeft","TopRight","BottomLeft","BottomRight"],aj=cE.length,D4=e=>typeof e=="string"?parseFloat(e):e,j4=e=>typeof e=="number"||xt.test(e);function ij(e,t,r,n,a,i){a?(e.opacity=kr(0,r.opacity!==void 0?r.opacity:1,sj(n)),e.opacityExit=kr(t.opacity!==void 0?t.opacity:1,0,oj(n))):i&&(e.opacity=kr(t.opacity!==void 0?t.opacity:1,r.opacity!==void 0?r.opacity:1,n));for(let s=0;s<aj;s++){const o=`border${cE[s]}Radius`;let l=R4(t,o),c=R4(r,o);if(l===void 0&&c===void 0)continue;l||(l=0),c||(c=0),l===0||c===0||j4(l)===j4(c)?(e[o]=Math.max(kr(D4(l),D4(c),n),0),(us.test(c)||us.test(l))&&(e[o]+="%")):e[o]=c}(t.rotate||r.rotate)&&(e.rotate=kr(t.rotate||0,r.rotate||0,n))}function R4(e,t){return e[t]!==void 0?e[t]:e.borderRadius}const sj=uE(0,.5,F8),oj=uE(.5,.95,zr);function uE(e,t,r){return n=>n<e?0:n>t?1:r(lh(e,t,n))}function M4(e,t){e.min=t.min,e.max=t.max}function Qa(e,t){M4(e.x,t.x),M4(e.y,t.y)}function B4(e,t,r,n,a){return e-=t,e=T1(e,1/r,n),a!==void 0&&(e=T1(e,1/a,n)),e}function lj(e,t=0,r=1,n=.5,a,i=e,s=e){if(us.test(t)&&(t=parseFloat(t),t=kr(s.min,s.max,t/100)-s.min),typeof t!="number")return;let o=kr(i.min,i.max,n);e===i&&(o-=t),e.min=B4(e.min,t,r,o,a),e.max=B4(e.max,t,r,o,a)}function U4(e,t,[r,n,a],i,s){lj(e,t[r],t[n],t[a],t.scale,i,s)}const cj=["x","scaleX","originX"],uj=["y","scaleY","originY"];function $4(e,t,r,n){U4(e.x,t,cj,r?r.x:void 0,n?n.x:void 0),U4(e.y,t,uj,r?r.y:void 0,n?n.y:void 0)}function V4(e){return e.translate===0&&e.scale===1}function fE(e){return V4(e.x)&&V4(e.y)}function fj(e,t){return e.x.min===t.x.min&&e.x.max===t.x.max&&e.y.min===t.y.min&&e.y.max===t.y.max}function hE(e,t){return Math.round(e.x.min)===Math.round(t.x.min)&&Math.round(e.x.max)===Math.round(t.x.max)&&Math.round(e.y.min)===Math.round(t.y.min)&&Math.round(e.y.max)===Math.round(t.y.max)}function z4(e){return Ma(e.x)/Ma(e.y)}class hj{constructor(){this.members=[]}add(t){i5(this.members,t),t.scheduleRender()}remove(t){if(s5(this.members,t),t===this.prevLead&&(this.prevLead=void 0),t===this.lead){const r=this.members[this.members.length-1];r&&this.promote(r)}}relegate(t){const r=this.members.findIndex(a=>t===a);if(r===0)return!1;let n;for(let a=r;a>=0;a--){const i=this.members[a];if(i.isPresent!==!1){n=i;break}}return n?(this.promote(n),!0):!1}promote(t,r){const n=this.lead;if(t!==n&&(this.prevLead=n,this.lead=t,t.show(),n)){n.instance&&n.scheduleRender(),t.scheduleRender(),t.resumeFrom=n,r&&(t.resumeFrom.preserveOpacity=!0),n.snapshot&&(t.snapshot=n.snapshot,t.snapshot.latestValues=n.animationValues||n.latestValues),t.root&&t.root.isUpdating&&(t.isLayoutDirty=!0);const{crossfade:a}=t.options;a===!1&&n.hide()}}exitAnimationComplete(){this.members.forEach(t=>{const{options:r,resumingFrom:n}=t;r.onExitComplete&&r.onExitComplete(),n&&n.options.onExitComplete&&n.options.onExitComplete()})}scheduleRender(){this.members.forEach(t=>{t.instance&&t.scheduleRender(!1)})}removeLeadSnapshot(){this.lead&&this.lead.snapshot&&(this.lead.snapshot=void 0)}}function H4(e,t,r){let n="";const a=e.x.translate/t.x,i=e.y.translate/t.y;if((a||i)&&(n=`translate3d(${a}px, ${i}px, 0) `),(t.x!==1||t.y!==1)&&(n+=`scale(${1/t.x}, ${1/t.y}) `),r){const{rotate:l,rotateX:c,rotateY:u}=r;l&&(n+=`rotate(${l}deg) `),c&&(n+=`rotateX(${c}deg) `),u&&(n+=`rotateY(${u}deg) `)}const s=e.x.scale*t.x,o=e.y.scale*t.y;return(s!==1||o!==1)&&(n+=`scale(${s}, ${o})`),n||"none"}const dj=(e,t)=>e.depth-t.depth;class pj{constructor(){this.children=[],this.isDirty=!1}add(t){i5(this.children,t),this.isDirty=!0}remove(t){s5(this.children,t),this.isDirty=!0}forEach(t){this.isDirty&&this.children.sort(dj),this.isDirty=!1,this.children.forEach(t)}}function mj(e,t){const r=performance.now(),n=({timestamp:a})=>{const i=a-r;i>=t&&(Qs(n),e(i-t))};return pr.read(n,!0),()=>Qs(n)}function gj(e){window.MotionDebug&&window.MotionDebug.record(e)}function xj(e){return e instanceof SVGElement&&e.tagName!=="svg"}function vj(e,t,r){const n=_a(e)?e:Wu(e);return n.start(a5("",n,t,r)),n.animation}const W4=["","X","Y","Z"],yj={visibility:"hidden"},q4=1e3;let wj=0;const Ll={type:"projectionFrame",totalNodes:0,resolvedTargetDeltas:0,recalculatedProjection:0};function dE({attachResizeListener:e,defaultParent:t,measureScroll:r,checkIsScrollRoot:n,resetTransform:a}){return class{constructor(s={},o=t==null?void 0:t()){this.id=wj++,this.animationId=0,this.children=new Set,this.options={},this.isTreeAnimating=!1,this.isAnimationBlocked=!1,this.isLayoutDirty=!1,this.isProjectionDirty=!1,this.isSharedProjectionDirty=!1,this.isTransformDirty=!1,this.updateManuallyBlocked=!1,this.updateBlockedByResize=!1,this.isUpdating=!1,this.isSVG=!1,this.needsReset=!1,this.shouldResetTransform=!1,this.treeScale={x:1,y:1},this.eventHandlers=new Map,this.hasTreeAnimated=!1,this.updateScheduled=!1,this.projectionUpdateScheduled=!1,this.checkUpdateFailed=()=>{this.isUpdating&&(this.isUpdating=!1,this.clearAllSnapshots())},this.updateProjection=()=>{this.projectionUpdateScheduled=!1,Ll.totalNodes=Ll.resolvedTargetDeltas=Ll.recalculatedProjection=0,this.nodes.forEach(Sj),this.nodes.forEach(Cj),this.nodes.forEach(Nj),this.nodes.forEach(kj),gj(Ll)},this.hasProjected=!1,this.isVisible=!0,this.animationProgress=0,this.sharedNodes=new Map,this.latestValues=s,this.root=o?o.root||o:this,this.path=o?[...o.path,o]:[],this.parent=o,this.depth=o?o.depth+1:0;for(let l=0;l<this.path.length;l++)this.path[l].shouldResetTransform=!0;this.root===this&&(this.nodes=new pj)}addEventListener(s,o){return this.eventHandlers.has(s)||this.eventHandlers.set(s,new o5),this.eventHandlers.get(s).add(o)}notifyListeners(s,...o){const l=this.eventHandlers.get(s);l&&l.notify(...o)}hasListeners(s){return this.eventHandlers.has(s)}mount(s,o=this.root.hasTreeAnimated){if(this.instance)return;this.isSVG=xj(s),this.instance=s;const{layoutId:l,layout:c,visualElement:u}=this.options;if(u&&!u.current&&u.mount(s),this.root.nodes.add(this),this.parent&&this.parent.children.add(this),o&&(c||l)&&(this.isLayoutDirty=!0),e){let f;const d=()=>this.root.updateBlockedByResize=!1;e(s,()=>{this.root.updateBlockedByResize=!0,f&&f(),f=mj(d,250),Mp.hasAnimatedSinceResize&&(Mp.hasAnimatedSinceResize=!1,this.nodes.forEach(K4))})}l&&this.root.registerSharedNode(l,this),this.options.animate!==!1&&u&&(l||c)&&this.addEventListener("didUpdate",({delta:f,hasLayoutChanged:d,hasRelativeTargetChanged:h,layout:g})=>{if(this.isTreeAnimationBlocked()){this.target=void 0,this.relativeTarget=void 0;return}const m=this.options.transition||u.getDefaultTransition()||Ij,{onLayoutAnimationStart:_,onLayoutAnimationComplete:y}=u.getProps(),b=!this.targetLayout||!hE(this.targetLayout,g)||h,w=!d&&h;if(this.options.layoutRoot||this.resumeFrom&&this.resumeFrom.instance||w||d&&(b||!this.currentAnimation)){this.resumeFrom&&(this.resumingFrom=this.resumeFrom,this.resumingFrom.resumingFrom=void 0),this.setAnimationOrigin(f,w);const T={...n5(m,"layout"),onPlay:_,onComplete:y};(u.shouldReduceMotion||this.options.layoutRoot)&&(T.delay=0,T.type=!1),this.startAnimation(T)}else d||K4(this),this.isLead()&&this.options.onExitComplete&&this.options.onExitComplete();this.targetLayout=g})}unmount(){this.options.layoutId&&this.willUpdate(),this.root.nodes.remove(this);const s=this.getStack();s&&s.remove(this),this.parent&&this.parent.children.delete(this),this.instance=void 0,Qs(this.updateProjection)}blockUpdate(){this.updateManuallyBlocked=!0}unblockUpdate(){this.updateManuallyBlocked=!1}isUpdateBlocked(){return this.updateManuallyBlocked||this.updateBlockedByResize}isTreeAnimationBlocked(){return this.isAnimationBlocked||this.parent&&this.parent.isTreeAnimationBlocked()||!1}startUpdate(){this.isUpdateBlocked()||(this.isUpdating=!0,this.nodes&&this.nodes.forEach(Pj),this.animationId++)}getTransformTemplate(){const{visualElement:s}=this.options;return s&&s.getProps().transformTemplate}willUpdate(s=!0){if(this.root.hasTreeAnimated=!0,this.root.isUpdateBlocked()){this.options.onExitComplete&&this.options.onExitComplete();return}if(!this.root.isUpdating&&this.root.startUpdate(),this.isLayoutDirty)return;this.isLayoutDirty=!0;for(let u=0;u<this.path.length;u++){const f=this.path[u];f.shouldResetTransform=!0,f.updateScroll("snapshot"),f.options.layoutRoot&&f.willUpdate(!1)}const{layoutId:o,layout:l}=this.options;if(o===void 0&&!l)return;const c=this.getTransformTemplate();this.prevTransformTemplateValue=c?c(this.latestValues,""):void 0,this.updateSnapshot(),s&&this.notifyListeners("willUpdate")}update(){if(this.updateScheduled=!1,this.isUpdateBlocked()){this.unblockUpdate(),this.clearAllSnapshots(),this.nodes.forEach(G4);return}this.isUpdating||this.nodes.forEach(Aj),this.isUpdating=!1,this.nodes.forEach(Tj),this.nodes.forEach(bj),this.nodes.forEach(_j),this.clearAllSnapshots();const o=performance.now();Mn.delta=rl(0,1e3/60,o-Mn.timestamp),Mn.timestamp=o,Mn.isProcessing=!0,r2.update.process(Mn),r2.preRender.process(Mn),r2.render.process(Mn),Mn.isProcessing=!1}didUpdate(){this.updateScheduled||(this.updateScheduled=!0,queueMicrotask(()=>this.update()))}clearAllSnapshots(){this.nodes.forEach(Ej),this.sharedNodes.forEach(Lj)}scheduleUpdateProjection(){this.projectionUpdateScheduled||(this.projectionUpdateScheduled=!0,pr.preRender(this.updateProjection,!1,!0))}scheduleCheckAfterUnmount(){pr.postRender(()=>{this.isLayoutDirty?this.root.didUpdate():this.root.checkUpdateFailed()})}updateSnapshot(){this.snapshot||!this.instance||(this.snapshot=this.measure())}updateLayout(){if(!this.instance||(this.updateScroll(),!(this.options.alwaysMeasureLayout&&this.isLead())&&!this.isLayoutDirty))return;if(this.resumeFrom&&!this.resumeFrom.instance)for(let l=0;l<this.path.length;l++)this.path[l].updateScroll();const s=this.layout;this.layout=this.measure(!1),this.layoutCorrected=Xr(),this.isLayoutDirty=!1,this.projectionDelta=void 0,this.notifyListeners("measure",this.layout.layoutBox);const{visualElement:o}=this.options;o&&o.notify("LayoutMeasure",this.layout.layoutBox,s?s.layoutBox:void 0)}updateScroll(s="measure"){let o=!!(this.options.layoutScroll&&this.instance);this.scroll&&this.scroll.animationId===this.root.animationId&&this.scroll.phase===s&&(o=!1),o&&(this.scroll={animationId:this.root.animationId,phase:s,isRoot:n(this.instance),offset:r(this.instance)})}resetTransform(){if(!a)return;const s=this.isLayoutDirty||this.shouldResetTransform,o=this.projectionDelta&&!fE(this.projectionDelta),l=this.getTransformTemplate(),c=l?l(this.latestValues,""):void 0,u=c!==this.prevTransformTemplateValue;s&&(o||Pl(this.latestValues)||u)&&(a(this.instance,c),this.shouldResetTransform=!1,this.scheduleRender())}measure(s=!0){const o=this.measurePageBox();let l=this.removeElementScroll(o);return s&&(l=this.removeTransform(l)),Dj(l),{animationId:this.root.animationId,measuredBox:o,layoutBox:l,latestValues:{},source:this.id}}measurePageBox(){const{visualElement:s}=this.options;if(!s)return Xr();const o=s.measureViewportBox(),{scroll:l}=this.root;return l&&(Po(o.x,l.offset.x),Po(o.y,l.offset.y)),o}removeElementScroll(s){const o=Xr();Qa(o,s);for(let l=0;l<this.path.length;l++){const c=this.path[l],{scroll:u,options:f}=c;if(c!==this.root&&u&&f.layoutScroll){if(u.isRoot){Qa(o,s);const{scroll:d}=this.root;d&&(Po(o.x,-d.offset.x),Po(o.y,-d.offset.y))}Po(o.x,u.offset.x),Po(o.y,u.offset.y)}}return o}applyTransform(s,o=!1){const l=Xr();Qa(l,s);for(let c=0;c<this.path.length;c++){const u=this.path[c];!o&&u.options.layoutScroll&&u.scroll&&u!==u.root&&vu(l,{x:-u.scroll.offset.x,y:-u.scroll.offset.y}),Pl(u.latestValues)&&vu(l,u.latestValues)}return Pl(this.latestValues)&&vu(l,this.latestValues),l}removeTransform(s){const o=Xr();Qa(o,s);for(let l=0;l<this.path.length;l++){const c=this.path[l];if(!c.instance||!Pl(c.latestValues))continue;rv(c.latestValues)&&c.updateSnapshot();const u=Xr(),f=c.measurePageBox();Qa(u,f),$4(o,c.latestValues,c.snapshot?c.snapshot.layoutBox:void 0,u)}return Pl(this.latestValues)&&$4(o,this.latestValues),o}setTargetDelta(s){this.targetDelta=s,this.root.scheduleUpdateProjection(),this.isProjectionDirty=!0}setOptions(s){this.options={...this.options,...s,crossfade:s.crossfade!==void 0?s.crossfade:!0}}clearMeasurements(){this.scroll=void 0,this.layout=void 0,this.snapshot=void 0,this.prevTransformTemplateValue=void 0,this.targetDelta=void 0,this.target=void 0,this.isLayoutDirty=!1}forceRelativeParentToResolveTarget(){this.relativeParent&&this.relativeParent.resolvedRelativeTargetAt!==Mn.timestamp&&this.relativeParent.resolveTargetDelta(!0)}resolveTargetDelta(s=!1){var o;const l=this.getLead();this.isProjectionDirty||(this.isProjectionDirty=l.isProjectionDirty),this.isTransformDirty||(this.isTransformDirty=l.isTransformDirty),this.isSharedProjectionDirty||(this.isSharedProjectionDirty=l.isSharedProjectionDirty);const c=!!this.resumingFrom||this!==l;if(!(s||c&&this.isSharedProjectionDirty||this.isProjectionDirty||!((o=this.parent)===null||o===void 0)&&o.isProjectionDirty||this.attemptToResolveRelativeTarget))return;const{layout:f,layoutId:d}=this.options;if(!(!this.layout||!(f||d))){if(this.resolvedRelativeTargetAt=Mn.timestamp,!this.targetDelta&&!this.relativeTarget){const h=this.getClosestProjectingParent();h&&h.layout&&this.animationProgress!==1?(this.relativeParent=h,this.forceRelativeParentToResolveTarget(),this.relativeTarget=Xr(),this.relativeTargetOrigin=Xr(),Af(this.relativeTargetOrigin,this.layout.layoutBox,h.layout.layoutBox),Qa(this.relativeTarget,this.relativeTargetOrigin)):this.relativeParent=this.relativeTarget=void 0}if(!(!this.relativeTarget&&!this.targetDelta)){if(this.target||(this.target=Xr(),this.targetWithTransforms=Xr()),this.relativeTarget&&this.relativeTargetOrigin&&this.relativeParent&&this.relativeParent.target?(this.forceRelativeParentToResolveTarget(),jD(this.target,this.relativeTarget,this.relativeParent.target)):this.targetDelta?(this.resumingFrom?this.target=this.applyTransform(this.layout.layoutBox):Qa(this.target,this.layout.layoutBox),iE(this.target,this.targetDelta)):Qa(this.target,this.layout.layoutBox),this.attemptToResolveRelativeTarget){this.attemptToResolveRelativeTarget=!1;const h=this.getClosestProjectingParent();h&&!!h.resumingFrom==!!this.resumingFrom&&!h.options.layoutScroll&&h.target&&this.animationProgress!==1?(this.relativeParent=h,this.forceRelativeParentToResolveTarget(),this.relativeTarget=Xr(),this.relativeTargetOrigin=Xr(),Af(this.relativeTargetOrigin,this.target,h.target),Qa(this.relativeTarget,this.relativeTargetOrigin)):this.relativeParent=this.relativeTarget=void 0}Ll.resolvedTargetDeltas++}}}getClosestProjectingParent(){if(!(!this.parent||rv(this.parent.latestValues)||aE(this.parent.latestValues)))return this.parent.isProjecting()?this.parent:this.parent.getClosestProjectingParent()}isProjecting(){return!!((this.relativeTarget||this.targetDelta||this.options.layoutRoot)&&this.layout)}calcProjection(){var s;const o=this.getLead(),l=!!this.resumingFrom||this!==o;let c=!0;if((this.isProjectionDirty||!((s=this.parent)===null||s===void 0)&&s.isProjectionDirty)&&(c=!1),l&&(this.isSharedProjectionDirty||this.isTransformDirty)&&(c=!1),this.resolvedRelativeTargetAt===Mn.timestamp&&(c=!1),c)return;const{layout:u,layoutId:f}=this.options;if(this.isTreeAnimating=!!(this.parent&&this.parent.isTreeAnimating||this.currentAnimation||this.pendingAnimation),this.isTreeAnimating||(this.targetDelta=this.relativeTarget=void 0),!this.layout||!(u||f))return;Qa(this.layoutCorrected,this.layout.layoutBox);const d=this.treeScale.x,h=this.treeScale.y;WD(this.layoutCorrected,this.treeScale,this.path,l),o.layout&&!o.target&&(this.treeScale.x!==1||this.treeScale.y!==1)&&(o.target=o.layout.layoutBox);const{target:g}=o;if(!g){this.projectionTransform&&(this.projectionDelta=xu(),this.projectionTransform="none",this.scheduleRender());return}this.projectionDelta||(this.projectionDelta=xu(),this.projectionDeltaWithTransform=xu());const m=this.projectionTransform;Ef(this.projectionDelta,this.layoutCorrected,g,this.latestValues),this.projectionTransform=H4(this.projectionDelta,this.treeScale),(this.projectionTransform!==m||this.treeScale.x!==d||this.treeScale.y!==h)&&(this.hasProjected=!0,this.scheduleRender(),this.notifyListeners("projectionUpdate",g)),Ll.recalculatedProjection++}hide(){this.isVisible=!1}show(){this.isVisible=!0}scheduleRender(s=!0){if(this.options.scheduleRender&&this.options.scheduleRender(),s){const o=this.getStack();o&&o.scheduleRender()}this.resumingFrom&&!this.resumingFrom.instance&&(this.resumingFrom=void 0)}setAnimationOrigin(s,o=!1){const l=this.snapshot,c=l?l.latestValues:{},u={...this.latestValues},f=xu();(!this.relativeParent||!this.relativeParent.options.layoutRoot)&&(this.relativeTarget=this.relativeTargetOrigin=void 0),this.attemptToResolveRelativeTarget=!o;const d=Xr(),h=l?l.source:void 0,g=this.layout?this.layout.source:void 0,m=h!==g,_=this.getStack(),y=!_||_.members.length<=1,b=!!(m&&!y&&this.options.crossfade===!0&&!this.path.some(Oj));this.animationProgress=0;let w;this.mixTargetDelta=T=>{const F=T/1e3;X4(f.x,s.x,F),X4(f.y,s.y,F),this.setTargetDelta(f),this.relativeTarget&&this.relativeTargetOrigin&&this.layout&&this.relativeParent&&this.relativeParent.layout&&(Af(d,this.layout.layoutBox,this.relativeParent.layout.layoutBox),Fj(this.relativeTarget,this.relativeTargetOrigin,d,F),w&&fj(this.relativeTarget,w)&&(this.isProjectionDirty=!1),w||(w=Xr()),Qa(w,this.relativeTarget)),m&&(this.animationValues=u,ij(u,c,this.latestValues,F,b,y)),this.root.scheduleUpdateProjection(),this.scheduleRender(),this.animationProgress=F},this.mixTargetDelta(this.options.layoutRoot?1e3:0)}startAnimation(s){this.notifyListeners("animationStart"),this.currentAnimation&&this.currentAnimation.stop(),this.resumingFrom&&this.resumingFrom.currentAnimation&&this.resumingFrom.currentAnimation.stop(),this.pendingAnimation&&(Qs(this.pendingAnimation),this.pendingAnimation=void 0),this.pendingAnimation=pr.update(()=>{Mp.hasAnimatedSinceResize=!0,this.currentAnimation=vj(0,q4,{...s,onUpdate:o=>{this.mixTargetDelta(o),s.onUpdate&&s.onUpdate(o)},onComplete:()=>{s.onComplete&&s.onComplete(),this.completeAnimation()}}),this.resumingFrom&&(this.resumingFrom.currentAnimation=this.currentAnimation),this.pendingAnimation=void 0})}completeAnimation(){this.resumingFrom&&(this.resumingFrom.currentAnimation=void 0,this.resumingFrom.preserveOpacity=void 0);const s=this.getStack();s&&s.exitAnimationComplete(),this.resumingFrom=this.currentAnimation=this.animationValues=void 0,this.notifyListeners("animationComplete")}finishAnimation(){this.currentAnimation&&(this.mixTargetDelta&&this.mixTargetDelta(q4),this.currentAnimation.stop()),this.completeAnimation()}applyTransformsToTarget(){const s=this.getLead();let{targetWithTransforms:o,target:l,layout:c,latestValues:u}=s;if(!(!o||!l||!c)){if(this!==s&&this.layout&&c&&pE(this.options.animationType,this.layout.layoutBox,c.layoutBox)){l=this.target||Xr();const f=Ma(this.layout.layoutBox.x);l.x.min=s.target.x.min,l.x.max=l.x.min+f;const d=Ma(this.layout.layoutBox.y);l.y.min=s.target.y.min,l.y.max=l.y.min+d}Qa(o,l),vu(o,u),Ef(this.projectionDeltaWithTransform,this.layoutCorrected,o,u)}}registerSharedNode(s,o){this.sharedNodes.has(s)||this.sharedNodes.set(s,new hj),this.sharedNodes.get(s).add(o);const c=o.options.initialPromotionConfig;o.promote({transition:c?c.transition:void 0,preserveFollowOpacity:c&&c.shouldPreserveFollowOpacity?c.shouldPreserveFollowOpacity(o):void 0})}isLead(){const s=this.getStack();return s?s.lead===this:!0}getLead(){var s;const{layoutId:o}=this.options;return o?((s=this.getStack())===null||s===void 0?void 0:s.lead)||this:this}getPrevLead(){var s;const{layoutId:o}=this.options;return o?(s=this.getStack())===null||s===void 0?void 0:s.prevLead:void 0}getStack(){const{layoutId:s}=this.options;if(s)return this.root.sharedNodes.get(s)}promote({needsReset:s,transition:o,preserveFollowOpacity:l}={}){const c=this.getStack();c&&c.promote(this,l),s&&(this.projectionDelta=void 0,this.needsReset=!0),o&&this.setOptions({transition:o})}relegate(){const s=this.getStack();return s?s.relegate(this):!1}resetRotation(){const{visualElement:s}=this.options;if(!s)return;let o=!1;const{latestValues:l}=s;if((l.rotate||l.rotateX||l.rotateY||l.rotateZ)&&(o=!0),!o)return;const c={};for(let u=0;u<W4.length;u++){const f="rotate"+W4[u];l[f]&&(c[f]=l[f],s.setStaticValue(f,0))}s.render();for(const u in c)s.setStaticValue(u,c[u]);s.scheduleRender()}getProjectionStyles(s){var o,l;if(!this.instance||this.isSVG)return;if(!this.isVisible)return yj;const c={visibility:""},u=this.getTransformTemplate();if(this.needsReset)return this.needsReset=!1,c.opacity="",c.pointerEvents=Rp(s==null?void 0:s.pointerEvents)||"",c.transform=u?u(this.latestValues,""):"none",c;const f=this.getLead();if(!this.projectionDelta||!this.layout||!f.target){const m={};return this.options.layoutId&&(m.opacity=this.latestValues.opacity!==void 0?this.latestValues.opacity:1,m.pointerEvents=Rp(s==null?void 0:s.pointerEvents)||""),this.hasProjected&&!Pl(this.latestValues)&&(m.transform=u?u({},""):"none",this.hasProjected=!1),m}const d=f.animationValues||f.latestValues;this.applyTransformsToTarget(),c.transform=H4(this.projectionDeltaWithTransform,this.treeScale,d),u&&(c.transform=u(d,c.transform));const{x:h,y:g}=this.projectionDelta;c.transformOrigin=`${h.origin*100}% ${g.origin*100}% 0`,f.animationValues?c.opacity=f===this?(l=(o=d.opacity)!==null&&o!==void 0?o:this.latestValues.opacity)!==null&&l!==void 0?l:1:this.preserveOpacity?this.latestValues.opacity:d.opacityExit:c.opacity=f===this?d.opacity!==void 0?d.opacity:"":d.opacityExit!==void 0?d.opacityExit:0;for(const m in y1){if(d[m]===void 0)continue;const{correct:_,applyTo:y}=y1[m],b=c.transform==="none"?d[m]:_(d[m],f);if(y){const w=y.length;for(let T=0;T<w;T++)c[y[T]]=b}else c[m]=b}return this.options.layoutId&&(c.pointerEvents=f===this?Rp(s==null?void 0:s.pointerEvents)||"":"none"),c}clearSnapshot(){this.resumeFrom=this.snapshot=void 0}resetTree(){this.root.nodes.forEach(s=>{var o;return(o=s.currentAnimation)===null||o===void 0?void 0:o.stop()}),this.root.nodes.forEach(G4),this.root.sharedNodes.clear()}}}function bj(e){e.updateLayout()}function _j(e){var t;const r=((t=e.resumeFrom)===null||t===void 0?void 0:t.snapshot)||e.snapshot;if(e.isLead()&&e.layout&&r&&e.hasListeners("didUpdate")){const{layoutBox:n,measuredBox:a}=e.layout,{animationType:i}=e.options,s=r.source!==e.layout.source;i==="size"?ti(f=>{const d=s?r.measuredBox[f]:r.layoutBox[f],h=Ma(d);d.min=n[f].min,d.max=d.min+h}):pE(i,r.layoutBox,n)&&ti(f=>{const d=s?r.measuredBox[f]:r.layoutBox[f],h=Ma(n[f]);d.max=d.min+h,e.relativeTarget&&!e.currentAnimation&&(e.isProjectionDirty=!0,e.relativeTarget[f].max=e.relativeTarget[f].min+h)});const o=xu();Ef(o,n,r.layoutBox);const l=xu();s?Ef(l,e.applyTransform(a,!0),r.measuredBox):Ef(l,n,r.layoutBox);const c=!fE(o);let u=!1;if(!e.resumeFrom){const f=e.getClosestProjectingParent();if(f&&!f.resumeFrom){const{snapshot:d,layout:h}=f;if(d&&h){const g=Xr();Af(g,r.layoutBox,d.layoutBox);const m=Xr();Af(m,n,h.layoutBox),hE(g,m)||(u=!0),f.options.layoutRoot&&(e.relativeTarget=m,e.relativeTargetOrigin=g,e.relativeParent=f)}}}e.notifyListeners("didUpdate",{layout:n,snapshot:r,delta:l,layoutDelta:o,hasLayoutChanged:c,hasRelativeTargetChanged:u})}else if(e.isLead()){const{onExitComplete:n}=e.options;n&&n()}e.options.transition=void 0}function Sj(e){Ll.totalNodes++,e.parent&&(e.isProjecting()||(e.isProjectionDirty=e.parent.isProjectionDirty),e.isSharedProjectionDirty||(e.isSharedProjectionDirty=!!(e.isProjectionDirty||e.parent.isProjectionDirty||e.parent.isSharedProjectionDirty)),e.isTransformDirty||(e.isTransformDirty=e.parent.isTransformDirty))}function kj(e){e.isProjectionDirty=e.isSharedProjectionDirty=e.isTransformDirty=!1}function Ej(e){e.clearSnapshot()}function G4(e){e.clearMeasurements()}function Aj(e){e.isLayoutDirty=!1}function Tj(e){const{visualElement:t}=e.options;t&&t.getProps().onBeforeLayoutMeasure&&t.notify("BeforeLayoutMeasure"),e.resetTransform()}function K4(e){e.finishAnimation(),e.targetDelta=e.relativeTarget=e.target=void 0,e.isProjectionDirty=!0}function Cj(e){e.resolveTargetDelta()}function Nj(e){e.calcProjection()}function Pj(e){e.resetRotation()}function Lj(e){e.removeLeadSnapshot()}function X4(e,t,r){e.translate=kr(t.translate,0,r),e.scale=kr(t.scale,1,r),e.origin=t.origin,e.originPoint=t.originPoint}function Y4(e,t,r,n){e.min=kr(t.min,r.min,n),e.max=kr(t.max,r.max,n)}function Fj(e,t,r,n){Y4(e.x,t.x,r.x,n),Y4(e.y,t.y,r.y,n)}function Oj(e){return e.animationValues&&e.animationValues.opacityExit!==void 0}const Ij={duration:.45,ease:[.4,0,.1,1]},J4=e=>typeof navigator<"u"&&navigator.userAgent.toLowerCase().includes(e),Q4=J4("applewebkit/")&&!J4("chrome/")?Math.round:zr;function Z4(e){e.min=Q4(e.min),e.max=Q4(e.max)}function Dj(e){Z4(e.x),Z4(e.y)}function pE(e,t,r){return e==="position"||e==="preserve-aspect"&&!ev(z4(t),z4(r),.2)}const jj=dE({attachResizeListener:(e,t)=>Ms(e,"resize",t),measureScroll:()=>({x:document.documentElement.scrollLeft||document.body.scrollLeft,y:document.documentElement.scrollTop||document.body.scrollTop}),checkIsScrollRoot:()=>!0}),d2={current:void 0},mE=dE({measureScroll:e=>({x:e.scrollLeft,y:e.scrollTop}),defaultParent:()=>{if(!d2.current){const e=new jj({});e.mount(window),e.setOptions({layoutScroll:!0}),d2.current=e}return d2.current},resetTransform:(e,t)=>{e.style.transform=t!==void 0?t:"none"},checkIsScrollRoot:e=>window.getComputedStyle(e).position==="fixed"}),Rj={pan:{Feature:ZD},drag:{Feature:QD,ProjectionNode:mE,MeasureLayout:lE}},Mj=/var\((--[a-zA-Z0-9-_]+),? ?([a-zA-Z0-9 ()%#.,-]+)?\)/;function Bj(e){const t=Mj.exec(e);if(!t)return[,];const[,r,n]=t;return[r,n]}function av(e,t,r=1){const[n,a]=Bj(e);if(!n)return;const i=window.getComputedStyle(t).getPropertyValue(n);if(i){const s=i.trim();return J8(s)?parseFloat(s):s}else return Gx(a)?av(a,t,r+1):a}function Uj(e,{...t},r){const n=e.current;if(!(n instanceof Element))return{target:t,transitionEnd:r};r&&(r={...r}),e.values.forEach(a=>{const i=a.get();if(!Gx(i))return;const s=av(i,n);s&&a.set(s)});for(const a in t){const i=t[a];if(!Gx(i))continue;const s=av(i,n);s&&(t[a]=s,r||(r={}),r[a]===void 0&&(r[a]=i))}return{target:t,transitionEnd:r}}const $j=new Set(["width","height","top","left","right","bottom","x","y","translateX","translateY"]),gE=e=>$j.has(e),Vj=e=>Object.keys(e).some(gE),e3=e=>e===hc||e===xt,t3=(e,t)=>parseFloat(e.split(", ")[t]),r3=(e,t)=>(r,{transform:n})=>{if(n==="none"||!n)return 0;const a=n.match(/^matrix3d\((.+)\)$/);if(a)return t3(a[1],t);{const i=n.match(/^matrix\((.+)\)$/);return i?t3(i[1],e):0}},zj=new Set(["x","y","z"]),Hj=Lh.filter(e=>!zj.has(e));function Wj(e){const t=[];return Hj.forEach(r=>{const n=e.getValue(r);n!==void 0&&(t.push([r,n.get()]),n.set(r.startsWith("scale")?1:0))}),t.length&&e.render(),t}const qu={width:({x:e},{paddingLeft:t="0",paddingRight:r="0"})=>e.max-e.min-parseFloat(t)-parseFloat(r),height:({y:e},{paddingTop:t="0",paddingBottom:r="0"})=>e.max-e.min-parseFloat(t)-parseFloat(r),top:(e,{top:t})=>parseFloat(t),left:(e,{left:t})=>parseFloat(t),bottom:({y:e},{top:t})=>parseFloat(t)+(e.max-e.min),right:({x:e},{left:t})=>parseFloat(t)+(e.max-e.min),x:r3(4,13),y:r3(5,14)};qu.translateX=qu.x;qu.translateY=qu.y;const qj=(e,t,r)=>{const n=t.measureViewportBox(),a=t.current,i=getComputedStyle(a),{display:s}=i,o={};s==="none"&&t.setStaticValue("display",e.display||"block"),r.forEach(c=>{o[c]=qu[c](n,i)}),t.render();const l=t.measureViewportBox();return r.forEach(c=>{const u=t.getValue(c);u&&u.jump(o[c]),e[c]=qu[c](l,i)}),e},Gj=(e,t,r={},n={})=>{t={...t},n={...n};const a=Object.keys(t).filter(gE);let i=[],s=!1;const o=[];if(a.forEach(l=>{const c=e.getValue(l);if(!e.hasValue(l))return;let u=r[l],f=G0(u);const d=t[l];let h;if(b1(d)){const g=d.length,m=d[0]===null?1:0;u=d[m],f=G0(u);for(let _=m;_<g&&d[_]!==null;_++)h?_1(G0(d[_])===h):h=G0(d[_])}else h=G0(d);if(f!==h)if(e3(f)&&e3(h)){const g=c.get();typeof g=="string"&&c.set(parseFloat(g)),typeof d=="string"?t[l]=parseFloat(d):Array.isArray(d)&&h===xt&&(t[l]=d.map(parseFloat))}else f!=null&&f.transform&&(h!=null&&h.transform)&&(u===0||d===0)?u===0?c.set(h.transform(u)):t[l]=f.transform(d):(s||(i=Wj(e),s=!0),o.push(l),n[l]=n[l]!==void 0?n[l]:t[l],c.jump(d))}),o.length){const l=o.indexOf("height")>=0?window.pageYOffset:null,c=qj(t,e,o);return i.length&&i.forEach(([u,f])=>{e.getValue(u).set(f)}),e.render(),ym&&l!==null&&window.scrollTo({top:l}),{target:c,transitionEnd:n}}else return{target:t,transitionEnd:n}};function Kj(e,t,r,n){return Vj(t)?Gj(e,t,r,n):{target:t,transitionEnd:n}}const Xj=(e,t,r,n)=>{const a=Uj(e,t,n);return t=a.target,n=a.transitionEnd,Kj(e,t,r,n)},iv={current:null},xE={current:!1};function Yj(){if(xE.current=!0,!!ym)if(window.matchMedia){const e=window.matchMedia("(prefers-reduced-motion)"),t=()=>iv.current=e.matches;e.addListener(t),t()}else iv.current=!1}function Jj(e,t,r){const{willChange:n}=t;for(const a in t){const i=t[a],s=r[a];if(_a(i))e.addValue(a,i),A1(n)&&n.add(a);else if(_a(s))e.addValue(a,Wu(i,{owner:e})),A1(n)&&n.remove(a);else if(s!==i)if(e.hasValue(a)){const o=e.getValue(a);!o.hasAnimated&&o.set(i)}else{const o=e.getStaticValue(a);e.addValue(a,Wu(o!==void 0?o:i,{owner:e}))}}for(const a in r)t[a]===void 0&&e.removeValue(a);return t}const n3=new WeakMap,vE=Object.keys(oh),Qj=vE.length,a3=["AnimationStart","AnimationComplete","Update","BeforeLayoutMeasure","LayoutMeasure","LayoutAnimationStart","LayoutAnimationComplete"],Zj=Hy.length;class eR{constructor({parent:t,props:r,presenceContext:n,reducedMotionConfig:a,visualState:i},s={}){this.current=null,this.children=new Set,this.isVariantNode=!1,this.isControllingVariants=!1,this.shouldReduceMotion=null,this.values=new Map,this.features={},this.valueSubscriptions=new Map,this.prevMotionValues={},this.events={},this.propEventSubscriptions={},this.notifyUpdate=()=>this.notify("Update",this.latestValues),this.render=()=>{this.current&&(this.triggerBuild(),this.renderInstance(this.current,this.renderState,this.props.style,this.projection))},this.scheduleRender=()=>pr.render(this.render,!1,!0);const{latestValues:o,renderState:l}=i;this.latestValues=o,this.baseTarget={...o},this.initialValues=r.initial?{...o}:{},this.renderState=l,this.parent=t,this.props=r,this.presenceContext=n,this.depth=t?t.depth+1:0,this.reducedMotionConfig=a,this.options=s,this.isControllingVariants=bm(r),this.isVariantNode=r8(r),this.isVariantNode&&(this.variantChildren=new Set),this.manuallyAnimateOnMount=!!(t&&t.current);const{willChange:c,...u}=this.scrapeMotionValuesFromProps(r,{});for(const f in u){const d=u[f];o[f]!==void 0&&_a(d)&&(d.set(o[f],!1),A1(c)&&c.add(f))}}scrapeMotionValuesFromProps(t,r){return{}}mount(t){this.current=t,n3.set(t,this),this.projection&&!this.projection.instance&&this.projection.mount(t),this.parent&&this.isVariantNode&&!this.isControllingVariants&&(this.removeFromVariantTree=this.parent.addVariantChild(this)),this.values.forEach((r,n)=>this.bindToMotionValue(n,r)),xE.current||Yj(),this.shouldReduceMotion=this.reducedMotionConfig==="never"?!1:this.reducedMotionConfig==="always"?!0:iv.current,this.parent&&this.parent.children.add(this),this.update(this.props,this.presenceContext)}unmount(){n3.delete(this.current),this.projection&&this.projection.unmount(),Qs(this.notifyUpdate),Qs(this.render),this.valueSubscriptions.forEach(t=>t()),this.removeFromVariantTree&&this.removeFromVariantTree(),this.parent&&this.parent.children.delete(this);for(const t in this.events)this.events[t].clear();for(const t in this.features)this.features[t].unmount();this.current=null}bindToMotionValue(t,r){const n=fc.has(t),a=r.on("change",s=>{this.latestValues[t]=s,this.props.onUpdate&&pr.update(this.notifyUpdate,!1,!0),n&&this.projection&&(this.projection.isTransformDirty=!0)}),i=r.on("renderRequest",this.scheduleRender);this.valueSubscriptions.set(t,()=>{a(),i()})}sortNodePosition(t){return!this.current||!this.sortInstanceNodePosition||this.type!==t.type?0:this.sortInstanceNodePosition(this.current,t.current)}loadFeatures({children:t,...r},n,a,i){let s,o;for(let l=0;l<Qj;l++){const c=vE[l],{isEnabled:u,Feature:f,ProjectionNode:d,MeasureLayout:h}=oh[c];d&&(s=d),u(r)&&(!this.features[c]&&f&&(this.features[c]=new f(this)),h&&(o=h))}if((this.type==="html"||this.type==="svg")&&!this.projection&&s){this.projection=new s(this.latestValues,this.parent&&this.parent.projection);const{layoutId:l,layout:c,drag:u,dragConstraints:f,layoutScroll:d,layoutRoot:h}=r;this.projection.setOptions({layoutId:l,layout:c,alwaysMeasureLayout:!!u||f&&mu(f),visualElement:this,scheduleRender:()=>this.scheduleRender(),animationType:typeof c=="string"?c:"both",initialPromotionConfig:i,layoutScroll:d,layoutRoot:h})}return o}updateFeatures(){for(const t in this.features){const r=this.features[t];r.isMounted?r.update():(r.mount(),r.isMounted=!0)}}triggerBuild(){this.build(this.renderState,this.latestValues,this.options,this.props)}measureViewportBox(){return this.current?this.measureInstanceViewportBox(this.current,this.props):Xr()}getStaticValue(t){return this.latestValues[t]}setStaticValue(t,r){this.latestValues[t]=r}makeTargetAnimatable(t,r=!0){return this.makeTargetAnimatableFromInstance(t,this.props,r)}update(t,r){(t.transformTemplate||this.props.transformTemplate)&&this.scheduleRender(),this.prevProps=this.props,this.props=t,this.prevPresenceContext=this.presenceContext,this.presenceContext=r;for(let n=0;n<a3.length;n++){const a=a3[n];this.propEventSubscriptions[a]&&(this.propEventSubscriptions[a](),delete this.propEventSubscriptions[a]);const i=t["on"+a];i&&(this.propEventSubscriptions[a]=this.on(a,i))}this.prevMotionValues=Jj(this,this.scrapeMotionValuesFromProps(t,this.prevProps),this.prevMotionValues),this.handleChildMotionValue&&this.handleChildMotionValue()}getProps(){return this.props}getVariant(t){return this.props.variants?this.props.variants[t]:void 0}getDefaultTransition(){return this.props.transition}getTransformPagePoint(){return this.props.transformPagePoint}getClosestVariantNode(){return this.isVariantNode?this:this.parent?this.parent.getClosestVariantNode():void 0}getVariantContext(t=!1){if(t)return this.parent?this.parent.getVariantContext():void 0;if(!this.isControllingVariants){const n=this.parent?this.parent.getVariantContext()||{}:{};return this.props.initial!==void 0&&(n.initial=this.props.initial),n}const r={};for(let n=0;n<Zj;n++){const a=Hy[n],i=this.props[a];(sh(i)||i===!1)&&(r[a]=i)}return r}addVariantChild(t){const r=this.getClosestVariantNode();if(r)return r.variantChildren&&r.variantChildren.add(t),()=>r.variantChildren.delete(t)}addValue(t,r){r!==this.values.get(t)&&(this.removeValue(t),this.bindToMotionValue(t,r)),this.values.set(t,r),this.latestValues[t]=r.get()}removeValue(t){this.values.delete(t);const r=this.valueSubscriptions.get(t);r&&(r(),this.valueSubscriptions.delete(t)),delete this.latestValues[t],this.removeValueFromRenderState(t,this.renderState)}hasValue(t){return this.values.has(t)}getValue(t,r){if(this.props.values&&this.props.values[t])return this.props.values[t];let n=this.values.get(t);return n===void 0&&r!==void 0&&(n=Wu(r,{owner:this}),this.addValue(t,n)),n}readValue(t){var r;return this.latestValues[t]!==void 0||!this.current?this.latestValues[t]:(r=this.getBaseTargetFromProps(this.props,t))!==null&&r!==void 0?r:this.readValueFromInstance(this.current,t,this.options)}setBaseTarget(t,r){this.baseTarget[t]=r}getBaseTarget(t){var r;const{initial:n}=this.props,a=typeof n=="string"||typeof n=="object"?(r=Qy(this.props,n))===null||r===void 0?void 0:r[t]:void 0;if(n&&a!==void 0)return a;const i=this.getBaseTargetFromProps(this.props,t);return i!==void 0&&!_a(i)?i:this.initialValues[t]!==void 0&&a===void 0?void 0:this.baseTarget[t]}on(t,r){return this.events[t]||(this.events[t]=new o5),this.events[t].add(r)}notify(t,...r){this.events[t]&&this.events[t].notify(...r)}}class yE extends eR{sortInstanceNodePosition(t,r){return t.compareDocumentPosition(r)&2?1:-1}getBaseTargetFromProps(t,r){return t.style?t.style[r]:void 0}removeValueFromRenderState(t,{vars:r,style:n}){delete r[t],delete n[t]}makeTargetAnimatableFromInstance({transition:t,transitionEnd:r,...n},{transformValues:a},i){let s=xD(n,t||{},this);if(a&&(r&&(r=a(r)),n&&(n=a(n)),s&&(s=a(s))),i){mD(this,n,s);const o=Xj(this,n,s,r);r=o.transitionEnd,n=o.target}return{transition:t,transitionEnd:r,...n}}}function tR(e){return window.getComputedStyle(e)}class rR extends yE{constructor(){super(...arguments),this.type="html"}readValueFromInstance(t,r){if(fc.has(r)){const n=r5(r);return n&&n.default||0}else{const n=tR(t),a=(s8(r)?n.getPropertyValue(r):n[r])||0;return typeof a=="string"?a.trim():a}}measureInstanceViewportBox(t,{transformPagePoint:r}){return sE(t,r)}build(t,r,n,a){Gy(t,r,n,a.transformTemplate)}scrapeMotionValuesFromProps(t,r){return Jy(t,r)}handleChildMotionValue(){this.childSubscription&&(this.childSubscription(),delete this.childSubscription);const{children:t}=this.props;_a(t)&&(this.childSubscription=t.on("change",r=>{this.current&&(this.current.textContent=`${r}`)}))}renderInstance(t,r,n,a){h8(t,r,n,a)}}class nR extends yE{constructor(){super(...arguments),this.type="svg",this.isSVGTag=!1}getBaseTargetFromProps(t,r){return t[r]}readValueFromInstance(t,r){if(fc.has(r)){const n=r5(r);return n&&n.default||0}return r=d8.has(r)?r:Vy(r),t.getAttribute(r)}measureInstanceViewportBox(){return Xr()}scrapeMotionValuesFromProps(t,r){return m8(t,r)}build(t,r,n,a){Xy(t,r,n,this.isSVGTag,a.transformTemplate)}renderInstance(t,r,n,a){p8(t,r,n,a)}mount(t){this.isSVGTag=Yy(t.tagName),super.mount(t)}}const aR=(e,t)=>qy(e)?new nR(t,{enableHardwareAcceleration:!1}):new rR(t,{enableHardwareAcceleration:!0}),iR={layout:{ProjectionNode:mE,MeasureLayout:lE}},sR={...FD,...ZO,...Rj,...iR},er=lO((e,t)=>UO(e,t,sR,aR));function wE(){const e=ie.useRef(!1);return $y(()=>(e.current=!0,()=>{e.current=!1}),[]),e}function oR(){const e=wE(),[t,r]=ie.useState(0),n=ie.useCallback(()=>{e.current&&r(t+1)},[t]);return[ie.useCallback(()=>pr.postRender(n),[n]),t]}class lR extends ie.Component{getSnapshotBeforeUpdate(t){const r=this.props.childRef.current;if(r&&t.isPresent&&!this.props.isPresent){const n=this.props.sizeRef.current;n.height=r.offsetHeight||0,n.width=r.offsetWidth||0,n.top=r.offsetTop,n.left=r.offsetLeft}return null}componentDidUpdate(){}render(){return this.props.children}}function cR({children:e,isPresent:t}){const r=ie.useId(),n=ie.useRef(null),a=ie.useRef({width:0,height:0,top:0,left:0});return ie.useInsertionEffect(()=>{const{width:i,height:s,top:o,left:l}=a.current;if(t||!n.current||!i||!s)return;n.current.dataset.motionPopId=r;const c=document.createElement("style");return document.head.appendChild(c),c.sheet&&c.sheet.insertRule(`
          [data-motion-pop-id="${r}"] {
            position: absolute !important;
            width: ${i}px !important;
            height: ${s}px !important;
            top: ${o}px !important;
            left: ${l}px !important;
          }
        `),()=>{document.head.removeChild(c)}},[t]),ie.createElement(lR,{isPresent:t,childRef:n,sizeRef:a},ie.cloneElement(e,{ref:n}))}const p2=({children:e,initial:t,isPresent:r,onExitComplete:n,custom:a,presenceAffectsLayout:i,mode:s})=>{const o=g8(uR),l=ie.useId(),c=ie.useMemo(()=>({id:l,initial:t,isPresent:r,custom:a,onExitComplete:u=>{o.set(u,!0);for(const f of o.values())if(!f)return;n&&n()},register:u=>(o.set(u,!1),()=>o.delete(u))}),i?void 0:[r]);return ie.useMemo(()=>{o.forEach((u,f)=>o.set(f,!1))},[r]),ie.useEffect(()=>{!r&&!o.size&&n&&n()},[r]),s==="popLayout"&&(e=ie.createElement(cR,{isPresent:r},e)),ie.createElement(vm.Provider,{value:c},e)};function uR(){return new Map}function fR(e){return ie.useEffect(()=>()=>e(),[])}const Fl=e=>e.key||"";function hR(e,t){e.forEach(r=>{const n=Fl(r);t.set(n,r)})}function dR(e){const t=[];return ie.Children.forEach(e,r=>{ie.isValidElement(r)&&t.push(r)}),t}const Em=({children:e,custom:t,initial:r=!0,onExitComplete:n,exitBeforeEnter:a,presenceAffectsLayout:i=!0,mode:s="sync"})=>{const o=ie.useContext(Wy).forceRender||oR()[0],l=wE(),c=dR(e);let u=c;const f=ie.useRef(new Map).current,d=ie.useRef(u),h=ie.useRef(new Map).current,g=ie.useRef(!0);if($y(()=>{g.current=!1,hR(c,h),d.current=u}),fR(()=>{g.current=!0,h.clear(),f.clear()}),g.current)return ie.createElement(ie.Fragment,null,u.map(b=>ie.createElement(p2,{key:Fl(b),isPresent:!0,initial:r?void 0:!1,presenceAffectsLayout:i,mode:s},b)));u=[...u];const m=d.current.map(Fl),_=c.map(Fl),y=m.length;for(let b=0;b<y;b++){const w=m[b];_.indexOf(w)===-1&&!f.has(w)&&f.set(w,void 0)}return s==="wait"&&f.size&&(u=[]),f.forEach((b,w)=>{if(_.indexOf(w)!==-1)return;const T=h.get(w);if(!T)return;const F=m.indexOf(w);let I=b;if(!I){const A=()=>{f.delete(w);const P=Array.from(h.keys()).filter(j=>!_.includes(j));if(P.forEach(j=>h.delete(j)),d.current=c.filter(j=>{const J=Fl(j);return J===w||P.includes(J)}),!f.size){if(l.current===!1)return;o(),n&&n()}};I=ie.createElement(p2,{key:Fl(T),isPresent:!1,onExitComplete:A,custom:t,presenceAffectsLayout:i,mode:s},T),f.set(w,I)}u.splice(F,0,I)}),u=u.map(b=>{const w=b.key;return f.has(w)?b:ie.createElement(p2,{key:Fl(b),isPresent:!0,presenceAffectsLayout:i,mode:s},b)}),ie.createElement(ie.Fragment,null,f.size?u:u.map(b=>ie.cloneElement(b)))};/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */var pR={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const mR=e=>e.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase().trim(),Kt=(e,t)=>{const r=ie.forwardRef(({color:n="currentColor",size:a=24,strokeWidth:i=2,absoluteStrokeWidth:s,className:o="",children:l,...c},u)=>ie.createElement("svg",{ref:u,...pR,width:a,height:a,stroke:n,strokeWidth:s?Number(i)*24/Number(a):i,className:["lucide",`lucide-${mR(e)}`,o].join(" "),...c},[...t.map(([f,d])=>ie.createElement(f,d)),...Array.isArray(l)?l:[l]]));return r.displayName=`${e}`,r};/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Am=Kt("AlertTriangle",[["path",{d:"m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3Z",key:"c3ski4"}],["path",{d:"M12 9v4",key:"juzpu7"}],["path",{d:"M12 17h.01",key:"p32p05"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const gR=Kt("BarChart3",[["path",{d:"M3 3v18h18",key:"1s2lah"}],["path",{d:"M18 17V9",key:"2bz60n"}],["path",{d:"M13 17V5",key:"1frdt8"}],["path",{d:"M8 17v-3",key:"17ska0"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const xR=Kt("Bell",[["path",{d:"M6 8a6 6 0 0 1 12 0c0 7 3 9 3 9H3s3-2 3-9",key:"1qo2s2"}],["path",{d:"M10.3 21a1.94 1.94 0 0 0 3.4 0",key:"qgo35s"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const bE=Kt("Calendar",[["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M16 2v4",key:"4m81vk"}],["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",key:"1hopcy"}],["path",{d:"M3 10h18",key:"8toen8"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const op=Kt("CheckCircle",[["path",{d:"M22 11.08V12a10 10 0 1 1-5.93-9.14",key:"g774vq"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const i3=Kt("Database",[["ellipse",{cx:"12",cy:"5",rx:"9",ry:"3",key:"msslwz"}],["path",{d:"M3 5V19A9 3 0 0 0 21 19V5",key:"1wlel7"}],["path",{d:"M3 12A9 3 0 0 0 21 12",key:"mv7ke4"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const _E=Kt("DollarSign",[["line",{x1:"12",x2:"12",y1:"2",y2:"22",key:"7eqyqh"}],["path",{d:"M17 5H9.5a3.5 3.5 0 0 0 0 7h5a3.5 3.5 0 0 1 0 7H6",key:"1b0p4s"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ss=Kt("FileDown",[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"M12 18v-6",key:"17g6i2"}],["path",{d:"m9 15 3 3 3-3",key:"1npd3o"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const vR=Kt("FileText",[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"M10 9H8",key:"b1mrlr"}],["path",{d:"M16 13H8",key:"t4e002"}],["path",{d:"M16 17H8",key:"z1uh3a"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const yR=Kt("Home",[["path",{d:"m3 9 9-7 9 7v11a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z",key:"y5dka4"}],["polyline",{points:"9 22 9 12 15 12 15 22",key:"e2us08"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const s3=Kt("KeyRound",[["path",{d:"M2 18v3c0 .6.4 1 1 1h4v-3h3v-3h2l1.4-1.4a6.5 6.5 0 1 0-4-4Z",key:"167ctg"}],["circle",{cx:"16.5",cy:"7.5",r:".5",fill:"currentColor",key:"w0ekpg"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const SE=Kt("Layers",[["path",{d:"m12.83 2.18a2 2 0 0 0-1.66 0L2.6 6.08a1 1 0 0 0 0 1.83l8.58 3.91a2 2 0 0 0 1.66 0l8.58-3.9a1 1 0 0 0 0-1.83Z",key:"8b97xw"}],["path",{d:"m22 17.65-9.17 4.16a2 2 0 0 1-1.66 0L2 17.65",key:"dd6zsq"}],["path",{d:"m22 12.65-9.17 4.16a2 2 0 0 1-1.66 0L2 12.65",key:"ep9fru"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const wR=Kt("Lock",[["rect",{width:"18",height:"11",x:"3",y:"11",rx:"2",ry:"2",key:"1w4ew1"}],["path",{d:"M7 11V7a5 5 0 0 1 10 0v4",key:"fwvmzm"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const bR=Kt("LogIn",[["path",{d:"M15 3h4a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2h-4",key:"u53s6r"}],["polyline",{points:"10 17 15 12 10 7",key:"1ail0h"}],["line",{x1:"15",x2:"3",y1:"12",y2:"12",key:"v6grx8"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const _R=Kt("LogOut",[["path",{d:"M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4",key:"1uf3rs"}],["polyline",{points:"16 17 21 12 16 7",key:"1gabdz"}],["line",{x1:"21",x2:"9",y1:"12",y2:"12",key:"1uyos4"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const l5=Kt("Package",[["path",{d:"m7.5 4.27 9 5.15",key:"1c824w"}],["path",{d:"M21 8a2 2 0 0 0-1-1.73l-7-4a2 2 0 0 0-2 0l-7 4A2 2 0 0 0 3 8v8a2 2 0 0 0 1 1.73l7 4a2 2 0 0 0 2 0l7-4A2 2 0 0 0 21 16Z",key:"hh9hay"}],["path",{d:"m3.3 7 8.7 5 8.7-5",key:"g66t2b"}],["path",{d:"M12 22V12",key:"d0xqtd"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const kE=Kt("Pencil",[["path",{d:"M17 3a2.85 2.83 0 1 1 4 4L7.5 20.5 2 22l1.5-5.5Z",key:"5qss01"}],["path",{d:"m15 5 4 4",key:"1mk7zo"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const EE=Kt("Plus",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ch=Kt("Printer",[["polyline",{points:"6 9 6 2 18 2 18 9",key:"1306q4"}],["path",{d:"M6 18H4a2 2 0 0 1-2-2v-5a2 2 0 0 1 2-2h16a2 2 0 0 1 2 2v5a2 2 0 0 1-2 2h-2",key:"143wyd"}],["rect",{width:"12",height:"8",x:"6",y:"14",key:"5ipwut"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const SR=Kt("RefreshCw",[["path",{d:"M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8",key:"v9h5vc"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}],["path",{d:"M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16",key:"3uifl3"}],["path",{d:"M8 16H3v5",key:"1cv678"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const c5=Kt("Save",[["path",{d:"M19 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h11l5 5v11a2 2 0 0 1-2 2z",key:"1owoqh"}],["polyline",{points:"17 21 17 13 7 13 7 21",key:"1md35c"}],["polyline",{points:"7 3 7 8 15 8",key:"8nz8an"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const AE=Kt("Search",[["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}],["path",{d:"m21 21-4.3-4.3",key:"1qie3q"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const kR=Kt("SquarePen",[["path",{d:"M12 3H5a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7",key:"1m0v6g"}],["path",{d:"M18.375 2.625a2.121 2.121 0 1 1 3 3L12 15l-4 1 1-4Z",key:"1lpok0"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ER=Kt("Trash2",[["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6",key:"4alrt4"}],["path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2",key:"v07s0e"}],["line",{x1:"10",x2:"10",y1:"11",y2:"17",key:"1uufr5"}],["line",{x1:"14",x2:"14",y1:"11",y2:"17",key:"xtxkd"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const TE=Kt("Trash",[["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6",key:"4alrt4"}],["path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2",key:"v07s0e"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const sv=Kt("TrendingUp",[["polyline",{points:"22 7 13.5 15.5 8.5 10.5 2 17",key:"126l90"}],["polyline",{points:"16 7 22 7 22 13",key:"kwv8wd"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const AR=Kt("Upload",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"17 8 12 3 7 8",key:"t8dd8p"}],["line",{x1:"12",x2:"12",y1:"3",y2:"15",key:"widbto"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const TR=Kt("User",[["path",{d:"M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2",key:"975kel"}],["circle",{cx:"12",cy:"7",r:"4",key:"17ys0d"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const CR=Kt("Users",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["path",{d:"M22 21v-2a4 4 0 0 0-3-3.87",key:"kshegd"}],["path",{d:"M16 3.13a4 4 0 0 1 0 7.75",key:"1da9ce"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const m2=Kt("XCircle",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m15 9-6 6",key:"1uzhvr"}],["path",{d:"m9 9 6 6",key:"z0biqf"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Dh=Kt("X",[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]]),Tm=()=>{const e=ie.useContext(Uy);if(e===void 0)throw new Error("useAuth must be used within an AuthProvider");return e},NR=()=>{const[e,t]=ie.useState(""),[r,n]=ie.useState(""),[a,i]=ie.useState(!1),{login:s,isAuthenticated:o}=Tm(),l=ie.useRef(o);ie.useEffect(()=>{l.current&&!o&&(t(""),n("")),l.current=o},[o]);const c=async u=>{if(u.preventDefault(),!e||!r){st.error("Por favor complete todos los campos");return}i(!0);try{await s(e,r)||st.error("Usuario o contrasea incorrectos")}catch{st.error("Error al iniciar sesin")}finally{i(!1)}};return v.jsx("div",{className:"min-h-screen bg-gradient-to-br from-blue-50 via-white to-blue-100 flex items-center justify-center p-4",children:v.jsxs(er.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.6},className:"max-w-md w-full space-y-8",children:[v.jsxs("div",{className:"text-center",children:[v.jsx(er.div,{initial:{scale:0},animate:{scale:1},transition:{delay:.2,type:"spring",stiffness:260,damping:20},className:"mx-auto h-20 w-20 bg-gradient-to-r from-blue-600 to-blue-800 rounded-full flex items-center justify-center shadow-xl mb-6",children:v.jsx(SE,{className:"h-10 w-10 text-white"})}),v.jsxs(er.div,{initial:{opacity:0},animate:{opacity:1},transition:{delay:.4},children:[v.jsx("h1",{className:"text-3xl font-bold text-blue-900 mb-1",children:"Alcalda Municipal de Cabaas Oeste"}),v.jsx("p",{className:"text-base text-gray-700 mb-2",children:"Unidad de Informtica"}),v.jsx("h2",{className:"text-xl font-semibold text-gray-900 mb-2",children:"Sistema de Control de Inventario"})]})]}),v.jsx(er.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.6},className:"bg-white py-8 px-6 shadow-xl rounded-xl border border-gray-100",children:v.jsxs("form",{className:"space-y-6",onSubmit:c,autoComplete:"off",children:[v.jsx("input",{type:"text",name:"fakeusernameremembered",style:{display:"none"},autoComplete:"username"}),v.jsx("input",{type:"password",name:"fakepasswordremembered",style:{display:"none"},autoComplete:"current-password"}),v.jsxs("div",{children:[v.jsx("label",{htmlFor:"username",className:"block text-sm font-medium text-gray-700 mb-2",children:"Nombre de Usuario"}),v.jsxs("div",{className:"relative",children:[v.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:v.jsx(TR,{className:"h-5 w-5 text-gray-400"})}),v.jsx("input",{id:"username",name:"login_user",type:"text",autoComplete:"new-username",required:!0,value:e,onChange:u=>t(u.target.value),className:"block w-full pl-10 pr-3 py-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 text-sm transition-colors",placeholder:"Ingrese su nombre de usuario"})]})]}),v.jsxs("div",{children:[v.jsx("label",{htmlFor:"password",className:"block text-sm font-medium text-gray-700 mb-2",children:"Contrasea"}),v.jsxs("div",{className:"relative",children:[v.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:v.jsx(wR,{className:"h-5 w-5 text-gray-400"})}),v.jsx("input",{id:"password",name:"login_pass",type:"password",autoComplete:"new-password",required:!0,value:r,onChange:u=>n(u.target.value),className:"block w-full pl-10 pr-3 py-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 text-sm transition-colors",placeholder:"Ingrese su contrasea"})]})]}),v.jsx("div",{children:v.jsxs("button",{type:"submit",disabled:a,className:"group relative w-full flex justify-center py-3 px-4 border border-transparent text-sm font-medium rounded-lg text-white bg-gradient-to-r from-blue-600 to-blue-700 hover:from-blue-700 hover:to-blue-800 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 transition-all duration-200 shadow-lg hover:shadow-xl disabled:opacity-50 disabled:cursor-not-allowed",children:[v.jsx("span",{className:"absolute left-0 inset-y-0 flex items-center pl-3",children:a?v.jsx("div",{className:"animate-spin rounded-full h-5 w-5 border-b-2 border-blue-300"}):v.jsx(bR,{className:"h-5 w-5 text-blue-300 group-hover:text-blue-200"})}),a?"Iniciando...":"Iniciar Sesin"]})})]})}),v.jsxs(er.div,{initial:{opacity:0},animate:{opacity:1},transition:{delay:.8},className:"text-center text-xs text-gray-500",children:[v.jsx("p",{children:" 2025 Alcalda Municipal de Cabaas Oeste"}),v.jsx("p",{children:"Sistema desarrollado por la Unidad de Informtica"})]})]})})};var u5={};Object.defineProperty(u5,"__esModule",{value:!0});u5.parse=jR;u5.serialize=RR;const PR=/^[\u0021-\u003A\u003C\u003E-\u007E]+$/,LR=/^[\u0021-\u003A\u003C-\u007E]*$/,FR=/^([.]?[a-z0-9]([a-z0-9-]{0,61}[a-z0-9])?)([.][a-z0-9]([a-z0-9-]{0,61}[a-z0-9])?)*$/i,OR=/^[\u0020-\u003A\u003D-\u007E]*$/,IR=Object.prototype.toString,DR=(()=>{const e=function(){};return e.prototype=Object.create(null),e})();function jR(e,t){const r=new DR,n=e.length;if(n<2)return r;const a=(t==null?void 0:t.decode)||MR;let i=0;do{const s=e.indexOf("=",i);if(s===-1)break;const o=e.indexOf(";",i),l=o===-1?n:o;if(s>l){i=e.lastIndexOf(";",s-1)+1;continue}const c=o3(e,i,s),u=l3(e,s,c),f=e.slice(c,u);if(r[f]===void 0){let d=o3(e,s+1,l),h=l3(e,l,d);const g=a(e.slice(d,h));r[f]=g}i=l+1}while(i<n);return r}function o3(e,t,r){do{const n=e.charCodeAt(t);if(n!==32&&n!==9)return t}while(++t<r);return r}function l3(e,t,r){for(;t>r;){const n=e.charCodeAt(--t);if(n!==32&&n!==9)return t+1}return r}function RR(e,t,r){const n=(r==null?void 0:r.encode)||encodeURIComponent;if(!PR.test(e))throw new TypeError(`argument name is invalid: ${e}`);const a=n(t);if(!LR.test(a))throw new TypeError(`argument val is invalid: ${t}`);let i=e+"="+a;if(!r)return i;if(r.maxAge!==void 0){if(!Number.isInteger(r.maxAge))throw new TypeError(`option maxAge is invalid: ${r.maxAge}`);i+="; Max-Age="+r.maxAge}if(r.domain){if(!FR.test(r.domain))throw new TypeError(`option domain is invalid: ${r.domain}`);i+="; Domain="+r.domain}if(r.path){if(!OR.test(r.path))throw new TypeError(`option path is invalid: ${r.path}`);i+="; Path="+r.path}if(r.expires){if(!BR(r.expires)||!Number.isFinite(r.expires.valueOf()))throw new TypeError(`option expires is invalid: ${r.expires}`);i+="; Expires="+r.expires.toUTCString()}if(r.httpOnly&&(i+="; HttpOnly"),r.secure&&(i+="; Secure"),r.partitioned&&(i+="; Partitioned"),r.priority)switch(typeof r.priority=="string"?r.priority.toLowerCase():void 0){case"low":i+="; Priority=Low";break;case"medium":i+="; Priority=Medium";break;case"high":i+="; Priority=High";break;default:throw new TypeError(`option priority is invalid: ${r.priority}`)}if(r.sameSite)switch(typeof r.sameSite=="string"?r.sameSite.toLowerCase():r.sameSite){case!0:case"strict":i+="; SameSite=Strict";break;case"lax":i+="; SameSite=Lax";break;case"none":i+="; SameSite=None";break;default:throw new TypeError(`option sameSite is invalid: ${r.sameSite}`)}return i}function MR(e){if(e.indexOf("%")===-1)return e;try{return decodeURIComponent(e)}catch{return e}}function BR(e){return IR.call(e)==="[object Date]"}var c3="popstate";function UR(e={}){function t(n,a){let{pathname:i,search:s,hash:o}=n.location;return ov("",{pathname:i,search:s,hash:o},a.state&&a.state.usr||null,a.state&&a.state.key||"default")}function r(n,a){return typeof a=="string"?a:uh(a)}return VR(t,r,null,e)}function on(e,t){if(e===!1||e===null||typeof e>"u")throw new Error(t)}function hs(e,t){if(!e){typeof console<"u"&&console.warn(t);try{throw new Error(t)}catch{}}}function $R(){return Math.random().toString(36).substring(2,10)}function u3(e,t){return{usr:e.state,key:e.key,idx:t}}function ov(e,t,r=null,n){return{pathname:typeof e=="string"?e:e.pathname,search:"",hash:"",...typeof t=="string"?jh(t):t,state:r,key:t&&t.key||n||$R()}}function uh({pathname:e="/",search:t="",hash:r=""}){return t&&t!=="?"&&(e+=t.charAt(0)==="?"?t:"?"+t),r&&r!=="#"&&(e+=r.charAt(0)==="#"?r:"#"+r),e}function jh(e){let t={};if(e){let r=e.indexOf("#");r>=0&&(t.hash=e.substring(r),e=e.substring(0,r));let n=e.indexOf("?");n>=0&&(t.search=e.substring(n),e=e.substring(0,n)),e&&(t.pathname=e)}return t}function VR(e,t,r,n={}){let{window:a=document.defaultView,v5Compat:i=!1}=n,s=a.history,o="POP",l=null,c=u();c==null&&(c=0,s.replaceState({...s.state,idx:c},""));function u(){return(s.state||{idx:null}).idx}function f(){o="POP";let _=u(),y=_==null?null:_-c;c=_,l&&l({action:o,location:m.location,delta:y})}function d(_,y){o="PUSH";let b=ov(m.location,_,y);c=u()+1;let w=u3(b,c),T=m.createHref(b);try{s.pushState(w,"",T)}catch(F){if(F instanceof DOMException&&F.name==="DataCloneError")throw F;a.location.assign(T)}i&&l&&l({action:o,location:m.location,delta:1})}function h(_,y){o="REPLACE";let b=ov(m.location,_,y);c=u();let w=u3(b,c),T=m.createHref(b);s.replaceState(w,"",T),i&&l&&l({action:o,location:m.location,delta:0})}function g(_){return zR(_)}let m={get action(){return o},get location(){return e(a,s)},listen(_){if(l)throw new Error("A history only accepts one active listener");return a.addEventListener(c3,f),l=_,()=>{a.removeEventListener(c3,f),l=null}},createHref(_){return t(a,_)},createURL:g,encodeLocation(_){let y=g(_);return{pathname:y.pathname,search:y.search,hash:y.hash}},push:d,replace:h,go(_){return s.go(_)}};return m}function zR(e,t=!1){let r="http://localhost";typeof window<"u"&&(r=window.location.origin!=="null"?window.location.origin:window.location.href),on(r,"No window.location.(origin|href) available to create URL");let n=typeof e=="string"?e:uh(e);return n=n.replace(/ $/,"%20"),!t&&n.startsWith("//")&&(n=r+n),new URL(n,r)}function CE(e,t,r="/"){return HR(e,t,r,!1)}function HR(e,t,r,n){let a=typeof t=="string"?jh(t):t,i=Zs(a.pathname||"/",r);if(i==null)return null;let s=NE(e);WR(s);let o=null;for(let l=0;o==null&&l<s.length;++l){let c=rM(i);o=eM(s[l],c,n)}return o}function NE(e,t=[],r=[],n=""){let a=(i,s,o)=>{let l={relativePath:o===void 0?i.path||"":o,caseSensitive:i.caseSensitive===!0,childrenIndex:s,route:i};l.relativePath.startsWith("/")&&(on(l.relativePath.startsWith(n),`Absolute route path "${l.relativePath}" nested under path "${n}" is not valid. An absolute child route path must start with the combined path of all its parent routes.`),l.relativePath=l.relativePath.slice(n.length));let c=Hs([n,l.relativePath]),u=r.concat(l);i.children&&i.children.length>0&&(on(i.index!==!0,`Index routes must not have child routes. Please remove all child routes from route path "${c}".`),NE(i.children,t,u,c)),!(i.path==null&&!i.index)&&t.push({path:c,score:QR(c,i.index),routesMeta:u})};return e.forEach((i,s)=>{var o;if(i.path===""||!((o=i.path)!=null&&o.includes("?")))a(i,s);else for(let l of PE(i.path))a(i,s,l)}),t}function PE(e){let t=e.split("/");if(t.length===0)return[];let[r,...n]=t,a=r.endsWith("?"),i=r.replace(/\?$/,"");if(n.length===0)return a?[i,""]:[i];let s=PE(n.join("/")),o=[];return o.push(...s.map(l=>l===""?i:[i,l].join("/"))),a&&o.push(...s),o.map(l=>e.startsWith("/")&&l===""?"/":l)}function WR(e){e.sort((t,r)=>t.score!==r.score?r.score-t.score:ZR(t.routesMeta.map(n=>n.childrenIndex),r.routesMeta.map(n=>n.childrenIndex)))}var qR=/^:[\w-]+$/,GR=3,KR=2,XR=1,YR=10,JR=-2,f3=e=>e==="*";function QR(e,t){let r=e.split("/"),n=r.length;return r.some(f3)&&(n+=JR),t&&(n+=KR),r.filter(a=>!f3(a)).reduce((a,i)=>a+(qR.test(i)?GR:i===""?XR:YR),n)}function ZR(e,t){return e.length===t.length&&e.slice(0,-1).every((n,a)=>n===t[a])?e[e.length-1]-t[t.length-1]:0}function eM(e,t,r=!1){let{routesMeta:n}=e,a={},i="/",s=[];for(let o=0;o<n.length;++o){let l=n[o],c=o===n.length-1,u=i==="/"?t:t.slice(i.length)||"/",f=C1({path:l.relativePath,caseSensitive:l.caseSensitive,end:c},u),d=l.route;if(!f&&c&&r&&!n[n.length-1].route.index&&(f=C1({path:l.relativePath,caseSensitive:l.caseSensitive,end:!1},u)),!f)return null;Object.assign(a,f.params),s.push({params:a,pathname:Hs([i,f.pathname]),pathnameBase:sM(Hs([i,f.pathnameBase])),route:d}),f.pathnameBase!=="/"&&(i=Hs([i,f.pathnameBase]))}return s}function C1(e,t){typeof e=="string"&&(e={path:e,caseSensitive:!1,end:!0});let[r,n]=tM(e.path,e.caseSensitive,e.end),a=t.match(r);if(!a)return null;let i=a[0],s=i.replace(/(.)\/+$/,"$1"),o=a.slice(1);return{params:n.reduce((c,{paramName:u,isOptional:f},d)=>{if(u==="*"){let g=o[d]||"";s=i.slice(0,i.length-g.length).replace(/(.)\/+$/,"$1")}const h=o[d];return f&&!h?c[u]=void 0:c[u]=(h||"").replace(/%2F/g,"/"),c},{}),pathname:i,pathnameBase:s,pattern:e}}function tM(e,t=!1,r=!0){hs(e==="*"||!e.endsWith("*")||e.endsWith("/*"),`Route path "${e}" will be treated as if it were "${e.replace(/\*$/,"/*")}" because the \`*\` character must always follow a \`/\` in the pattern. To get rid of this warning, please change the route path to "${e.replace(/\*$/,"/*")}".`);let n=[],a="^"+e.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,(s,o,l)=>(n.push({paramName:o,isOptional:l!=null}),l?"/?([^\\/]+)?":"/([^\\/]+)"));return e.endsWith("*")?(n.push({paramName:"*"}),a+=e==="*"||e==="/*"?"(.*)$":"(?:\\/(.+)|\\/*)$"):r?a+="\\/*$":e!==""&&e!=="/"&&(a+="(?:(?=\\/|$))"),[new RegExp(a,t?void 0:"i"),n]}function rM(e){try{return e.split("/").map(t=>decodeURIComponent(t).replace(/\//g,"%2F")).join("/")}catch(t){return hs(!1,`The URL path "${e}" could not be decoded because it is a malformed URL segment. This is probably due to a bad percent encoding (${t}).`),e}}function Zs(e,t){if(t==="/")return e;if(!e.toLowerCase().startsWith(t.toLowerCase()))return null;let r=t.endsWith("/")?t.length-1:t.length,n=e.charAt(r);return n&&n!=="/"?null:e.slice(r)||"/"}function nM(e,t="/"){let{pathname:r,search:n="",hash:a=""}=typeof e=="string"?jh(e):e;return{pathname:r?r.startsWith("/")?r:aM(r,t):t,search:oM(n),hash:lM(a)}}function aM(e,t){let r=t.replace(/\/+$/,"").split("/");return e.split("/").forEach(a=>{a===".."?r.length>1&&r.pop():a!=="."&&r.push(a)}),r.length>1?r.join("/"):"/"}function g2(e,t,r,n){return`Cannot include a '${e}' character in a manually specified \`to.${t}\` field [${JSON.stringify(n)}].  Please separate it out to the \`to.${r}\` field. Alternatively you may provide the full path as a string in <Link to="..."> and the router will parse it for you.`}function iM(e){return e.filter((t,r)=>r===0||t.route.path&&t.route.path.length>0)}function LE(e){let t=iM(e);return t.map((r,n)=>n===t.length-1?r.pathname:r.pathnameBase)}function FE(e,t,r,n=!1){let a;typeof e=="string"?a=jh(e):(a={...e},on(!a.pathname||!a.pathname.includes("?"),g2("?","pathname","search",a)),on(!a.pathname||!a.pathname.includes("#"),g2("#","pathname","hash",a)),on(!a.search||!a.search.includes("#"),g2("#","search","hash",a)));let i=e===""||a.pathname==="",s=i?"/":a.pathname,o;if(s==null)o=r;else{let f=t.length-1;if(!n&&s.startsWith("..")){let d=s.split("/");for(;d[0]==="..";)d.shift(),f-=1;a.pathname=d.join("/")}o=f>=0?t[f]:"/"}let l=nM(a,o),c=s&&s!=="/"&&s.endsWith("/"),u=(i||s===".")&&r.endsWith("/");return!l.pathname.endsWith("/")&&(c||u)&&(l.pathname+="/"),l}var Hs=e=>e.join("/").replace(/\/\/+/g,"/"),sM=e=>e.replace(/\/+$/,"").replace(/^\/*/,"/"),oM=e=>!e||e==="?"?"":e.startsWith("?")?e:"?"+e,lM=e=>!e||e==="#"?"":e.startsWith("#")?e:"#"+e;function cM(e){return e!=null&&typeof e.status=="number"&&typeof e.statusText=="string"&&typeof e.internal=="boolean"&&"data"in e}var OE=["POST","PUT","PATCH","DELETE"];new Set(OE);var uM=["GET",...OE];new Set(uM);var n0=ie.createContext(null);n0.displayName="DataRouter";var Cm=ie.createContext(null);Cm.displayName="DataRouterState";var IE=ie.createContext({isTransitioning:!1});IE.displayName="ViewTransition";var fM=ie.createContext(new Map);fM.displayName="Fetchers";var hM=ie.createContext(null);hM.displayName="Await";var ms=ie.createContext(null);ms.displayName="Navigation";var Nm=ie.createContext(null);Nm.displayName="Location";var no=ie.createContext({outlet:null,matches:[],isDataRoute:!1});no.displayName="Route";var f5=ie.createContext(null);f5.displayName="RouteError";function dM(e,{relative:t}={}){on(Rh(),"useHref() may be used only in the context of a <Router> component.");let{basename:r,navigator:n}=ie.useContext(ms),{hash:a,pathname:i,search:s}=Mh(e,{relative:t}),o=i;return r!=="/"&&(o=i==="/"?r:Hs([r,i])),n.createHref({pathname:o,search:s,hash:a})}function Rh(){return ie.useContext(Nm)!=null}function dc(){return on(Rh(),"useLocation() may be used only in the context of a <Router> component."),ie.useContext(Nm).location}var DE="You should call navigate() in a React.useEffect(), not when your component is first rendered.";function jE(e){ie.useContext(ms).static||ie.useLayoutEffect(e)}function RE(){let{isDataRoute:e}=ie.useContext(no);return e?AM():pM()}function pM(){on(Rh(),"useNavigate() may be used only in the context of a <Router> component.");let e=ie.useContext(n0),{basename:t,navigator:r}=ie.useContext(ms),{matches:n}=ie.useContext(no),{pathname:a}=dc(),i=JSON.stringify(LE(n)),s=ie.useRef(!1);return jE(()=>{s.current=!0}),ie.useCallback((l,c={})=>{if(hs(s.current,DE),!s.current)return;if(typeof l=="number"){r.go(l);return}let u=FE(l,JSON.parse(i),a,c.relative==="path");e==null&&t!=="/"&&(u.pathname=u.pathname==="/"?t:Hs([t,u.pathname])),(c.replace?r.replace:r.push)(u,c.state,c)},[t,r,i,a,e])}ie.createContext(null);function Mh(e,{relative:t}={}){let{matches:r}=ie.useContext(no),{pathname:n}=dc(),a=JSON.stringify(LE(r));return ie.useMemo(()=>FE(e,JSON.parse(a),n,t==="path"),[e,a,n,t])}function mM(e,t,r,n){on(Rh(),"useRoutes() may be used only in the context of a <Router> component.");let{navigator:a}=ie.useContext(ms),{matches:i}=ie.useContext(no),s=i[i.length-1],o=s?s.params:{},l=s?s.pathname:"/",c=s?s.pathnameBase:"/",u=s&&s.route;{let y=u&&u.path||"";ME(l,!u||y.endsWith("*")||y.endsWith("*?"),`You rendered descendant <Routes> (or called \`useRoutes()\`) at "${l}" (under <Route path="${y}">) but the parent route path has no trailing "*". This means if you navigate deeper, the parent won't match anymore and therefore the child routes will never render.

Please change the parent <Route path="${y}"> to <Route path="${y==="/"?"*":`${y}/*`}">.`)}let f=dc(),d;d=f;let h=d.pathname||"/",g=h;if(c!=="/"){let y=c.replace(/^\//,"").split("/");g="/"+h.replace(/^\//,"").split("/").slice(y.length).join("/")}let m=CE(e,{pathname:g});return hs(u||m!=null,`No routes matched location "${d.pathname}${d.search}${d.hash}" `),hs(m==null||m[m.length-1].route.element!==void 0||m[m.length-1].route.Component!==void 0||m[m.length-1].route.lazy!==void 0,`Matched leaf route at location "${d.pathname}${d.search}${d.hash}" does not have an element or Component. This means it will render an <Outlet /> with a null value by default resulting in an "empty" page.`),wM(m&&m.map(y=>Object.assign({},y,{params:Object.assign({},o,y.params),pathname:Hs([c,a.encodeLocation?a.encodeLocation(y.pathname).pathname:y.pathname]),pathnameBase:y.pathnameBase==="/"?c:Hs([c,a.encodeLocation?a.encodeLocation(y.pathnameBase).pathname:y.pathnameBase])})),i,r,n)}function gM(){let e=EM(),t=cM(e)?`${e.status} ${e.statusText}`:e instanceof Error?e.message:JSON.stringify(e),r=e instanceof Error?e.stack:null,n="rgba(200,200,200, 0.5)",a={padding:"0.5rem",backgroundColor:n},i={padding:"2px 4px",backgroundColor:n},s=null;return console.error("Error handled by React Router default ErrorBoundary:",e),s=ie.createElement(ie.Fragment,null,ie.createElement("p",null," Hey developer "),ie.createElement("p",null,"You can provide a way better UX than this when your app throws errors by providing your own ",ie.createElement("code",{style:i},"ErrorBoundary")," or"," ",ie.createElement("code",{style:i},"errorElement")," prop on your route.")),ie.createElement(ie.Fragment,null,ie.createElement("h2",null,"Unexpected Application Error!"),ie.createElement("h3",{style:{fontStyle:"italic"}},t),r?ie.createElement("pre",{style:a},r):null,s)}var xM=ie.createElement(gM,null),vM=class extends ie.Component{constructor(e){super(e),this.state={location:e.location,revalidation:e.revalidation,error:e.error}}static getDerivedStateFromError(e){return{error:e}}static getDerivedStateFromProps(e,t){return t.location!==e.location||t.revalidation!=="idle"&&e.revalidation==="idle"?{error:e.error,location:e.location,revalidation:e.revalidation}:{error:e.error!==void 0?e.error:t.error,location:t.location,revalidation:e.revalidation||t.revalidation}}componentDidCatch(e,t){console.error("React Router caught the following error during render",e,t)}render(){return this.state.error!==void 0?ie.createElement(no.Provider,{value:this.props.routeContext},ie.createElement(f5.Provider,{value:this.state.error,children:this.props.component})):this.props.children}};function yM({routeContext:e,match:t,children:r}){let n=ie.useContext(n0);return n&&n.static&&n.staticContext&&(t.route.errorElement||t.route.ErrorBoundary)&&(n.staticContext._deepestRenderedBoundaryId=t.route.id),ie.createElement(no.Provider,{value:e},r)}function wM(e,t=[],r=null,n=null){if(e==null){if(!r)return null;if(r.errors)e=r.matches;else if(t.length===0&&!r.initialized&&r.matches.length>0)e=r.matches;else return null}let a=e,i=r==null?void 0:r.errors;if(i!=null){let l=a.findIndex(c=>c.route.id&&(i==null?void 0:i[c.route.id])!==void 0);on(l>=0,`Could not find a matching route for errors on route IDs: ${Object.keys(i).join(",")}`),a=a.slice(0,Math.min(a.length,l+1))}let s=!1,o=-1;if(r)for(let l=0;l<a.length;l++){let c=a[l];if((c.route.HydrateFallback||c.route.hydrateFallbackElement)&&(o=l),c.route.id){let{loaderData:u,errors:f}=r,d=c.route.loader&&!u.hasOwnProperty(c.route.id)&&(!f||f[c.route.id]===void 0);if(c.route.lazy||d){s=!0,o>=0?a=a.slice(0,o+1):a=[a[0]];break}}}return a.reduceRight((l,c,u)=>{let f,d=!1,h=null,g=null;r&&(f=i&&c.route.id?i[c.route.id]:void 0,h=c.route.errorElement||xM,s&&(o<0&&u===0?(ME("route-fallback",!1,"No `HydrateFallback` element provided to render during initial hydration"),d=!0,g=null):o===u&&(d=!0,g=c.route.hydrateFallbackElement||null)));let m=t.concat(a.slice(0,u+1)),_=()=>{let y;return f?y=h:d?y=g:c.route.Component?y=ie.createElement(c.route.Component,null):c.route.element?y=c.route.element:y=l,ie.createElement(yM,{match:c,routeContext:{outlet:l,matches:m,isDataRoute:r!=null},children:y})};return r&&(c.route.ErrorBoundary||c.route.errorElement||u===0)?ie.createElement(vM,{location:r.location,revalidation:r.revalidation,component:h,error:f,children:_(),routeContext:{outlet:null,matches:m,isDataRoute:!0}}):_()},null)}function h5(e){return`${e} must be used within a data router.  See https://reactrouter.com/en/main/routers/picking-a-router.`}function bM(e){let t=ie.useContext(n0);return on(t,h5(e)),t}function _M(e){let t=ie.useContext(Cm);return on(t,h5(e)),t}function SM(e){let t=ie.useContext(no);return on(t,h5(e)),t}function d5(e){let t=SM(e),r=t.matches[t.matches.length-1];return on(r.route.id,`${e} can only be used on routes that contain a unique "id"`),r.route.id}function kM(){return d5("useRouteId")}function EM(){var n;let e=ie.useContext(f5),t=_M("useRouteError"),r=d5("useRouteError");return e!==void 0?e:(n=t.errors)==null?void 0:n[r]}function AM(){let{router:e}=bM("useNavigate"),t=d5("useNavigate"),r=ie.useRef(!1);return jE(()=>{r.current=!0}),ie.useCallback(async(a,i={})=>{hs(r.current,DE),r.current&&(typeof a=="number"?e.navigate(a):await e.navigate(a,{fromRouteId:t,...i}))},[e,t])}var h3={};function ME(e,t,r){!t&&!h3[e]&&(h3[e]=!0,hs(!1,r))}ie.memo(TM);function TM({routes:e,future:t,state:r}){return mM(e,void 0,r,t)}function CM({basename:e="/",children:t=null,location:r,navigationType:n="POP",navigator:a,static:i=!1}){on(!Rh(),"You cannot render a <Router> inside another <Router>. You should never have more than one in your app.");let s=e.replace(/^\/*/,"/"),o=ie.useMemo(()=>({basename:s,navigator:a,static:i,future:{}}),[s,a,i]);typeof r=="string"&&(r=jh(r));let{pathname:l="/",search:c="",hash:u="",state:f=null,key:d="default"}=r,h=ie.useMemo(()=>{let g=Zs(l,s);return g==null?null:{location:{pathname:g,search:c,hash:u,state:f,key:d},navigationType:n}},[s,l,c,u,f,d,n]);return hs(h!=null,`<Router basename="${s}"> is not able to match the URL "${l}${c}${u}" because it does not start with the basename, so the <Router> won't render anything.`),h==null?null:ie.createElement(ms.Provider,{value:o},ie.createElement(Nm.Provider,{children:t,value:h}))}var Bp="get",Up="application/x-www-form-urlencoded";function Pm(e){return e!=null&&typeof e.tagName=="string"}function NM(e){return Pm(e)&&e.tagName.toLowerCase()==="button"}function PM(e){return Pm(e)&&e.tagName.toLowerCase()==="form"}function LM(e){return Pm(e)&&e.tagName.toLowerCase()==="input"}function FM(e){return!!(e.metaKey||e.altKey||e.ctrlKey||e.shiftKey)}function OM(e,t){return e.button===0&&(!t||t==="_self")&&!FM(e)}var lp=null;function IM(){if(lp===null)try{new FormData(document.createElement("form"),0),lp=!1}catch{lp=!0}return lp}var DM=new Set(["application/x-www-form-urlencoded","multipart/form-data","text/plain"]);function x2(e){return e!=null&&!DM.has(e)?(hs(!1,`"${e}" is not a valid \`encType\` for \`<Form>\`/\`<fetcher.Form>\` and will default to "${Up}"`),null):e}function jM(e,t){let r,n,a,i,s;if(PM(e)){let o=e.getAttribute("action");n=o?Zs(o,t):null,r=e.getAttribute("method")||Bp,a=x2(e.getAttribute("enctype"))||Up,i=new FormData(e)}else if(NM(e)||LM(e)&&(e.type==="submit"||e.type==="image")){let o=e.form;if(o==null)throw new Error('Cannot submit a <button> or <input type="submit"> without a <form>');let l=e.getAttribute("formaction")||o.getAttribute("action");if(n=l?Zs(l,t):null,r=e.getAttribute("formmethod")||o.getAttribute("method")||Bp,a=x2(e.getAttribute("formenctype"))||x2(o.getAttribute("enctype"))||Up,i=new FormData(o,e),!IM()){let{name:c,type:u,value:f}=e;if(u==="image"){let d=c?`${c}.`:"";i.append(`${d}x`,"0"),i.append(`${d}y`,"0")}else c&&i.append(c,f)}}else{if(Pm(e))throw new Error('Cannot submit element that is not <form>, <button>, or <input type="submit|image">');r=Bp,n=null,a=Up,s=e}return i&&a==="text/plain"&&(s=i,i=void 0),{action:n,method:r.toLowerCase(),encType:a,formData:i,body:s}}function p5(e,t){if(e===!1||e===null||typeof e>"u")throw new Error(t)}async function RM(e,t){if(e.id in t)return t[e.id];try{let r=await import(e.module);return t[e.id]=r,r}catch(r){return console.error(`Error loading route module \`${e.module}\`, reloading page...`),console.error(r),window.__reactRouterContext&&window.__reactRouterContext.isSpaMode,window.location.reload(),new Promise(()=>{})}}function MM(e){return e==null?!1:e.href==null?e.rel==="preload"&&typeof e.imageSrcSet=="string"&&typeof e.imageSizes=="string":typeof e.rel=="string"&&typeof e.href=="string"}async function BM(e,t,r){let n=await Promise.all(e.map(async a=>{let i=t.routes[a.route.id];if(i){let s=await RM(i,r);return s.links?s.links():[]}return[]}));return zM(n.flat(1).filter(MM).filter(a=>a.rel==="stylesheet"||a.rel==="preload").map(a=>a.rel==="stylesheet"?{...a,rel:"prefetch",as:"style"}:{...a,rel:"prefetch"}))}function d3(e,t,r,n,a,i){let s=(l,c)=>r[c]?l.route.id!==r[c].route.id:!0,o=(l,c)=>{var u;return r[c].pathname!==l.pathname||((u=r[c].route.path)==null?void 0:u.endsWith("*"))&&r[c].params["*"]!==l.params["*"]};return i==="assets"?t.filter((l,c)=>s(l,c)||o(l,c)):i==="data"?t.filter((l,c)=>{var f;let u=n.routes[l.route.id];if(!u||!u.hasLoader)return!1;if(s(l,c)||o(l,c))return!0;if(l.route.shouldRevalidate){let d=l.route.shouldRevalidate({currentUrl:new URL(a.pathname+a.search+a.hash,window.origin),currentParams:((f=r[0])==null?void 0:f.params)||{},nextUrl:new URL(e,window.origin),nextParams:l.params,defaultShouldRevalidate:!0});if(typeof d=="boolean")return d}return!0}):[]}function UM(e,t,{includeHydrateFallback:r}={}){return $M(e.map(n=>{let a=t.routes[n.route.id];if(!a)return[];let i=[a.module];return a.clientActionModule&&(i=i.concat(a.clientActionModule)),a.clientLoaderModule&&(i=i.concat(a.clientLoaderModule)),r&&a.hydrateFallbackModule&&(i=i.concat(a.hydrateFallbackModule)),a.imports&&(i=i.concat(a.imports)),i}).flat(1))}function $M(e){return[...new Set(e)]}function VM(e){let t={},r=Object.keys(e).sort();for(let n of r)t[n]=e[n];return t}function zM(e,t){let r=new Set;return new Set(t),e.reduce((n,a)=>{let i=JSON.stringify(VM(a));return r.has(i)||(r.add(i),n.push({key:i,link:a})),n},[])}Object.getOwnPropertyNames(Object.prototype).sort().join("\0");var HM=new Set([100,101,204,205]);function WM(e,t){let r=typeof e=="string"?new URL(e,typeof window>"u"?"server://singlefetch/":window.location.origin):e;return r.pathname==="/"?r.pathname="_root.data":t&&Zs(r.pathname,t)==="/"?r.pathname=`${t.replace(/\/$/,"")}/_root.data`:r.pathname=`${r.pathname.replace(/\/$/,"")}.data`,r}function BE(){let e=ie.useContext(n0);return p5(e,"You must render this element inside a <DataRouterContext.Provider> element"),e}function qM(){let e=ie.useContext(Cm);return p5(e,"You must render this element inside a <DataRouterStateContext.Provider> element"),e}var m5=ie.createContext(void 0);m5.displayName="FrameworkContext";function UE(){let e=ie.useContext(m5);return p5(e,"You must render this element inside a <HydratedRouter> element"),e}function GM(e,t){let r=ie.useContext(m5),[n,a]=ie.useState(!1),[i,s]=ie.useState(!1),{onFocus:o,onBlur:l,onMouseEnter:c,onMouseLeave:u,onTouchStart:f}=t,d=ie.useRef(null);ie.useEffect(()=>{if(e==="render"&&s(!0),e==="viewport"){let m=y=>{y.forEach(b=>{s(b.isIntersecting)})},_=new IntersectionObserver(m,{threshold:.5});return d.current&&_.observe(d.current),()=>{_.disconnect()}}},[e]),ie.useEffect(()=>{if(n){let m=setTimeout(()=>{s(!0)},100);return()=>{clearTimeout(m)}}},[n]);let h=()=>{a(!0)},g=()=>{a(!1),s(!1)};return r?e!=="intent"?[i,d,{}]:[i,d,{onFocus:X0(o,h),onBlur:X0(l,g),onMouseEnter:X0(c,h),onMouseLeave:X0(u,g),onTouchStart:X0(f,h)}]:[!1,d,{}]}function X0(e,t){return r=>{e&&e(r),r.defaultPrevented||t(r)}}function KM({page:e,...t}){let{router:r}=BE(),n=ie.useMemo(()=>CE(r.routes,e,r.basename),[r.routes,e,r.basename]);return n?ie.createElement(YM,{page:e,matches:n,...t}):null}function XM(e){let{manifest:t,routeModules:r}=UE(),[n,a]=ie.useState([]);return ie.useEffect(()=>{let i=!1;return BM(e,t,r).then(s=>{i||a(s)}),()=>{i=!0}},[e,t,r]),n}function YM({page:e,matches:t,...r}){let n=dc(),{manifest:a,routeModules:i}=UE(),{basename:s}=BE(),{loaderData:o,matches:l}=qM(),c=ie.useMemo(()=>d3(e,t,l,a,n,"data"),[e,t,l,a,n]),u=ie.useMemo(()=>d3(e,t,l,a,n,"assets"),[e,t,l,a,n]),f=ie.useMemo(()=>{if(e===n.pathname+n.search+n.hash)return[];let g=new Set,m=!1;if(t.forEach(y=>{var w;let b=a.routes[y.route.id];!b||!b.hasLoader||(!c.some(T=>T.route.id===y.route.id)&&y.route.id in o&&((w=i[y.route.id])!=null&&w.shouldRevalidate)||b.hasClientLoader?m=!0:g.add(y.route.id))}),g.size===0)return[];let _=WM(e,s);return m&&g.size>0&&_.searchParams.set("_routes",t.filter(y=>g.has(y.route.id)).map(y=>y.route.id).join(",")),[_.pathname+_.search]},[s,o,n,a,c,t,e,i]),d=ie.useMemo(()=>UM(u,a),[u,a]),h=XM(u);return ie.createElement(ie.Fragment,null,f.map(g=>ie.createElement("link",{key:g,rel:"prefetch",as:"fetch",href:g,...r})),d.map(g=>ie.createElement("link",{key:g,rel:"modulepreload",href:g,...r})),h.map(({key:g,link:m})=>ie.createElement("link",{key:g,...m})))}function JM(...e){return t=>{e.forEach(r=>{typeof r=="function"?r(t):r!=null&&(r.current=t)})}}var $E=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u";try{$E&&(window.__reactRouterVersion="7.6.3")}catch{}function QM({basename:e,children:t,window:r}){let n=ie.useRef();n.current==null&&(n.current=UR({window:r,v5Compat:!0}));let a=n.current,[i,s]=ie.useState({action:a.action,location:a.location}),o=ie.useCallback(l=>{ie.startTransition(()=>s(l))},[s]);return ie.useLayoutEffect(()=>a.listen(o),[a,o]),ie.createElement(CM,{basename:e,children:t,location:i.location,navigationType:i.action,navigator:a})}var VE=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,zE=ie.forwardRef(function({onClick:t,discover:r="render",prefetch:n="none",relative:a,reloadDocument:i,replace:s,state:o,target:l,to:c,preventScrollReset:u,viewTransition:f,...d},h){let{basename:g}=ie.useContext(ms),m=typeof c=="string"&&VE.test(c),_,y=!1;if(typeof c=="string"&&m&&(_=c,$E))try{let j=new URL(window.location.href),J=c.startsWith("//")?new URL(j.protocol+c):new URL(c),N=Zs(J.pathname,g);J.origin===j.origin&&N!=null?c=N+J.search+J.hash:y=!0}catch{hs(!1,`<Link to="${c}"> contains an invalid URL which will probably break when clicked - please update to a valid URL path.`)}let b=dM(c,{relative:a}),[w,T,F]=GM(n,d),I=rB(c,{replace:s,state:o,target:l,preventScrollReset:u,relative:a,viewTransition:f});function A(j){t&&t(j),j.defaultPrevented||I(j)}let P=ie.createElement("a",{...d,...F,href:_||b,onClick:y||i?t:A,ref:JM(h,T),target:l,"data-discover":!m&&r==="render"?"true":void 0});return w&&!m?ie.createElement(ie.Fragment,null,P,ie.createElement(KM,{page:b})):P});zE.displayName="Link";var ZM=ie.forwardRef(function({"aria-current":t="page",caseSensitive:r=!1,className:n="",end:a=!1,style:i,to:s,viewTransition:o,children:l,...c},u){let f=Mh(s,{relative:c.relative}),d=dc(),h=ie.useContext(Cm),{navigator:g,basename:m}=ie.useContext(ms),_=h!=null&&oB(f)&&o===!0,y=g.encodeLocation?g.encodeLocation(f).pathname:f.pathname,b=d.pathname,w=h&&h.navigation&&h.navigation.location?h.navigation.location.pathname:null;r||(b=b.toLowerCase(),w=w?w.toLowerCase():null,y=y.toLowerCase()),w&&m&&(w=Zs(w,m)||w);const T=y!=="/"&&y.endsWith("/")?y.length-1:y.length;let F=b===y||!a&&b.startsWith(y)&&b.charAt(T)==="/",I=w!=null&&(w===y||!a&&w.startsWith(y)&&w.charAt(y.length)==="/"),A={isActive:F,isPending:I,isTransitioning:_},P=F?t:void 0,j;typeof n=="function"?j=n(A):j=[n,F?"active":null,I?"pending":null,_?"transitioning":null].filter(Boolean).join(" ");let J=typeof i=="function"?i(A):i;return ie.createElement(zE,{...c,"aria-current":P,className:j,ref:u,style:J,to:s,viewTransition:o},typeof l=="function"?l(A):l)});ZM.displayName="NavLink";var eB=ie.forwardRef(({discover:e="render",fetcherKey:t,navigate:r,reloadDocument:n,replace:a,state:i,method:s=Bp,action:o,onSubmit:l,relative:c,preventScrollReset:u,viewTransition:f,...d},h)=>{let g=iB(),m=sB(o,{relative:c}),_=s.toLowerCase()==="get"?"get":"post",y=typeof o=="string"&&VE.test(o),b=w=>{if(l&&l(w),w.defaultPrevented)return;w.preventDefault();let T=w.nativeEvent.submitter,F=(T==null?void 0:T.getAttribute("formmethod"))||s;g(T||w.currentTarget,{fetcherKey:t,method:F,navigate:r,replace:a,state:i,relative:c,preventScrollReset:u,viewTransition:f})};return ie.createElement("form",{ref:h,method:_,action:m,onSubmit:n?l:b,...d,"data-discover":!y&&e==="render"?"true":void 0})});eB.displayName="Form";function tB(e){return`${e} must be used within a data router.  See https://reactrouter.com/en/main/routers/picking-a-router.`}function HE(e){let t=ie.useContext(n0);return on(t,tB(e)),t}function rB(e,{target:t,replace:r,state:n,preventScrollReset:a,relative:i,viewTransition:s}={}){let o=RE(),l=dc(),c=Mh(e,{relative:i});return ie.useCallback(u=>{if(OM(u,t)){u.preventDefault();let f=r!==void 0?r:uh(l)===uh(c);o(e,{replace:f,state:n,preventScrollReset:a,relative:i,viewTransition:s})}},[l,o,c,r,n,t,e,a,i,s])}var nB=0,aB=()=>`__${String(++nB)}__`;function iB(){let{router:e}=HE("useSubmit"),{basename:t}=ie.useContext(ms),r=kM();return ie.useCallback(async(n,a={})=>{let{action:i,method:s,encType:o,formData:l,body:c}=jM(n,t);if(a.navigate===!1){let u=a.fetcherKey||aB();await e.fetch(u,r,a.action||i,{preventScrollReset:a.preventScrollReset,formData:l,body:c,formMethod:a.method||s,formEncType:a.encType||o,flushSync:a.flushSync})}else await e.navigate(a.action||i,{preventScrollReset:a.preventScrollReset,formData:l,body:c,formMethod:a.method||s,formEncType:a.encType||o,replace:a.replace,state:a.state,fromRouteId:r,flushSync:a.flushSync,viewTransition:a.viewTransition})},[e,t,r])}function sB(e,{relative:t}={}){let{basename:r}=ie.useContext(ms),n=ie.useContext(no);on(n,"useFormAction must be used inside a RouteContext");let[a]=n.matches.slice(-1),i={...Mh(e||".",{relative:t})},s=dc();if(e==null){i.search=s.search;let o=new URLSearchParams(i.search),l=o.getAll("index");if(l.some(u=>u==="")){o.delete("index"),l.filter(f=>f).forEach(f=>o.append("index",f));let u=o.toString();i.search=u?`?${u}`:""}}return(!e||e===".")&&a.route.index&&(i.search=i.search?i.search.replace(/^\?/,"?index&"):"?index"),r!=="/"&&(i.pathname=i.pathname==="/"?r:Hs([r,i.pathname])),uh(i)}function oB(e,t={}){let r=ie.useContext(IE);on(r!=null,"`useViewTransitionState` must be used within `react-router-dom`'s `RouterProvider`.  Did you accidentally import `RouterProvider` from `react-router`?");let{basename:n}=HE("useViewTransitionState"),a=Mh(e,{relative:t.relative});if(!r.isTransitioning)return!1;let i=Zs(r.currentLocation.pathname,n)||r.currentLocation.pathname,s=Zs(r.nextLocation.pathname,n)||r.nextLocation.pathname;return C1(a.pathname,s)!=null||C1(a.pathname,i)!=null}[...HM];const lB=({isOpen:e,onClose:t})=>{const{user:r}=Tm(),[n,a]=ie.useState({full_name:(r==null?void 0:r.full_name)||"",email:(r==null?void 0:r.email)||""}),[i,s]=ie.useState(!1),[o,l]=ie.useState(!1),[c,u]=ie.useState({current:"",new:"",confirm:""}),[f,d]=ie.useState(!1);Fi.useEffect(()=>{r&&a({full_name:r.full_name||"",email:r.email||""})},[r,e]);const h=async m=>{m.preventDefault(),d(!0),setTimeout(()=>{st.success("Datos actualizados"),s(!1),d(!1),t()},1e3)},g=async m=>{if(m.preventDefault(),c.new!==c.confirm){st.error("Las contraseas no coinciden");return}d(!0),setTimeout(()=>{st.success("Contrasea cambiada"),l(!1),d(!1),u({current:"",new:"",confirm:""}),t()},1e3)};return v.jsx(Em,{children:e&&v.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50",children:v.jsxs(er.div,{initial:{opacity:0,scale:.9},animate:{opacity:1,scale:1},exit:{opacity:0,scale:.9},className:"bg-white rounded-xl p-6 max-w-md w-full shadow-2xl",children:[v.jsxs("div",{className:"flex justify-between items-center mb-4",children:[v.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Perfil de Usuario"}),v.jsx("button",{onClick:t,className:"text-gray-400 hover:text-gray-600 transition-colors",children:v.jsx(Dh,{className:"h-6 w-6"})})]}),o?v.jsxs("form",{onSubmit:g,className:"space-y-4",children:[v.jsxs("div",{children:[v.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Contrasea actual"}),v.jsx("input",{type:"password",value:c.current,onChange:m=>u({...c,current:m.target.value}),className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all",required:!0})]}),v.jsxs("div",{children:[v.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Nueva contrasea"}),v.jsx("input",{type:"password",value:c.new,onChange:m=>u({...c,new:m.target.value}),className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all",required:!0})]}),v.jsxs("div",{children:[v.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Confirmar nueva contrasea"}),v.jsx("input",{type:"password",value:c.confirm,onChange:m=>u({...c,confirm:m.target.value}),className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all",required:!0})]}),v.jsxs("div",{className:"flex gap-3 pt-4",children:[v.jsx("button",{type:"button",onClick:()=>l(!1),className:"flex-1 px-4 py-2 bg-gray-200 text-gray-800 rounded-lg hover:bg-gray-300 transition-colors font-medium",children:"Cancelar"}),v.jsxs("button",{type:"submit",disabled:f,className:"flex-1 px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors font-medium disabled:opacity-50 disabled:cursor-not-allowed flex items-center justify-center gap-2",children:[f?v.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white"}):v.jsx(s3,{className:"h-4 w-4"}),f?"Guardando...":"Cambiar"]})]})]}):v.jsxs("form",{onSubmit:h,className:"space-y-4",children:[v.jsxs("div",{children:[v.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Nombre completo"}),v.jsx("input",{type:"text",value:n.full_name,onChange:m=>a({...n,full_name:m.target.value}),className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all",disabled:!i})]}),v.jsxs("div",{children:[v.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Correo electrnico"}),v.jsx("input",{type:"email",value:n.email,onChange:m=>a({...n,email:m.target.value}),className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all",disabled:!i})]}),v.jsxs("div",{children:[v.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Usuario"}),v.jsx("input",{type:"text",value:(r==null?void 0:r.username)||"",disabled:!0,className:"w-full px-4 py-2 border border-gray-200 rounded-lg bg-gray-100 text-gray-500"})]}),v.jsxs("div",{children:[v.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Rol"}),v.jsx("input",{type:"text",value:(r==null?void 0:r.role)||"",disabled:!0,className:"w-full px-4 py-2 border border-gray-200 rounded-lg bg-gray-100 text-gray-500"})]}),v.jsx("div",{className:"flex gap-3 pt-4",children:i?v.jsxs(v.Fragment,{children:[v.jsx("button",{type:"button",onClick:()=>s(!1),className:"flex-1 px-4 py-2 bg-gray-200 text-gray-800 rounded-lg hover:bg-gray-300 transition-colors font-medium",children:"Cancelar"}),v.jsxs("button",{type:"submit",disabled:f,className:"flex-1 px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors font-medium disabled:opacity-50 disabled:cursor-not-allowed flex items-center justify-center gap-2",children:[f?v.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white"}):v.jsx(c5,{className:"h-4 w-4"}),f?"Guardando...":"Guardar"]})]}):v.jsxs(v.Fragment,{children:[v.jsx("button",{type:"button",onClick:()=>s(!0),className:"flex-1 px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors font-medium",children:"Editar datos"}),v.jsxs("button",{type:"button",onClick:()=>l(!0),className:"flex-1 px-4 py-2 bg-gray-200 text-gray-800 rounded-lg hover:bg-gray-300 transition-colors font-medium flex items-center gap-2",children:[v.jsx(s3,{className:"h-4 w-4"})," Cambiar contrasea"]})]})})]})]})})})},cB=()=>{const{user:e,logout:t}=Tm(),{articles:r,getStock:n}=ps();RE();const[a,i]=Fi.useState(!1),[s,o]=Fi.useState(!1),[l,c]=Fi.useState(!1),u="notificaciones_gestionadas",[f,d]=Fi.useState(()=>{try{return JSON.parse(localStorage.getItem(u)||"[]")}catch{return[]}}),m=[...r.filter(F=>n(F.id)>0&&n(F.id)<=5).map(F=>({id:`stock-${F.id}`,type:"stock",message:`Stock bajo: ${F.nombre} (${n(F.id)} unidades)`,articleId:F.id}))].filter(F=>!f.includes(F.id)),_=m.length>0,y=F=>{const I=[...f,F];d(I),localStorage.setItem(u,JSON.stringify(I))},b=F=>{y(F.id)};Fi.useEffect(()=>{const F=I=>{i(!1),o(!1)};if(a||s)return document.addEventListener("click",F),()=>document.removeEventListener("click",F)},[a,s]),Fi.useEffect(()=>{d(()=>{try{return JSON.parse(localStorage.getItem(u)||"[]")}catch{return[]}})},[e==null?void 0:e.id]);const w=new Date().toLocaleDateString("es-ES",{weekday:"long",year:"numeric",month:"long",day:"numeric"}),T=(e==null?void 0:e.username.slice(0,2).toUpperCase())||"U";return v.jsx("header",{className:"bg-white shadow-sm border-b border-gray-200 sticky top-0 z-30",children:v.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:v.jsxs("div",{className:"flex justify-between items-center py-4",children:[v.jsxs("div",{className:"flex items-center space-x-4",children:[v.jsx("div",{className:"bg-gradient-to-r from-blue-600 to-blue-700 p-2.5 rounded-xl shadow-lg",children:v.jsx(SE,{className:"h-6 w-6 text-white"})}),v.jsxs("div",{className:"hidden md:block",children:[v.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"Sistema de Control de Inventario"}),v.jsx("p",{className:"text-sm text-gray-600 mt-0.5",children:"Gestin profesional de inventarios"})]}),v.jsx("div",{className:"block md:hidden",children:v.jsx("h1",{className:"text-xl font-bold text-gray-900",children:"Inventario"})})]}),v.jsxs("div",{className:"flex items-center space-x-4",children:[v.jsxs("div",{className:"relative hidden md:block",children:[v.jsx(AE,{className:"absolute left-3 top-2.5 h-4 w-4 text-gray-400"}),v.jsx("input",{type:"text",placeholder:"Buscar en el sistema...",className:"w-48 pl-9 pr-4 py-2 bg-gray-100 border border-transparent rounded-lg focus:bg-white focus:border-blue-300 focus:ring-2 focus:ring-blue-200 transition-all text-sm"})]}),v.jsxs("div",{className:"relative",children:[v.jsxs("button",{className:"relative p-2 rounded-full hover:bg-gray-100 transition-colors",onClick:F=>{F.stopPropagation(),i(!a)},children:[v.jsx(xR,{className:"h-5 w-5 text-gray-600"}),_&&v.jsx("span",{className:"absolute top-1 right-1 h-2 w-2 bg-blue-600 rounded-full"})]}),a&&v.jsxs("div",{className:"absolute right-0 mt-2 w-80 bg-white border border-gray-200 rounded-lg shadow-lg z-50",children:[v.jsxs("div",{className:"p-4 border-b font-semibold text-gray-700 flex justify-between items-center",children:[v.jsx("span",{children:"Notificaciones"}),m.length>0&&v.jsx("button",{onClick:F=>{F.stopPropagation();const I=[...f,...m.map(A=>A.id)];d(I),localStorage.setItem(u,JSON.stringify(I))},className:"px-2 py-1 bg-blue-600 text-white rounded text-xs hover:bg-blue-700",children:"Marcar todas"})]}),m.length===0?v.jsx("div",{className:"p-4 text-gray-500 text-sm",children:"No hay notificaciones"}):m.map((F,I)=>v.jsxs("div",{className:"p-4 text-gray-700 text-sm border-b last:border-b-0 flex flex-col gap-2",children:[v.jsx("span",{children:F.message}),v.jsx("div",{className:"flex gap-2 mt-1",children:v.jsx("button",{onClick:A=>{A.stopPropagation(),b(F)},className:"px-2 py-1 bg-gray-200 text-gray-700 rounded text-xs hover:bg-gray-300",children:"Marcar como leda"})})]},I))]})]}),v.jsxs("div",{className:"hidden md:block text-right",children:[v.jsx("div",{className:"text-sm font-medium text-gray-900",children:"Alcalda Municipal de Cabaas Oeste"}),v.jsx("div",{className:"text-xs text-gray-500 mt-0.5 capitalize",children:w})]}),v.jsxs("div",{className:"relative flex items-center gap-3",children:[v.jsx("button",{className:"h-9 w-9 rounded-full bg-gradient-to-r from-blue-400 to-blue-600 flex items-center justify-center text-white font-medium shadow-md focus:outline-none",onClick:F=>{F.stopPropagation(),o(!s)},children:v.jsx("span",{children:T})}),s&&v.jsxs("div",{className:"absolute right-0 mt-12 w-48 bg-white border border-gray-200 rounded-lg shadow-lg z-50",children:[v.jsx("div",{className:"p-4 border-b font-semibold text-gray-700",children:"Perfil"}),v.jsx("div",{className:"p-4 text-gray-700 text-sm border-b",children:(e==null?void 0:e.username)||"Usuario"}),v.jsx("button",{onClick:()=>{c(!0),o(!1)},className:"w-full text-left px-4 py-2 text-blue-600 hover:bg-blue-100 font-medium flex items-center gap-2",children:"Ver perfil"}),v.jsxs("button",{onClick:t,className:"w-full text-left px-4 py-2 text-red-600 hover:bg-red-100 rounded-b-lg font-medium flex items-center gap-2",children:[v.jsx(_R,{className:"h-4 w-4"})," Cerrar Sesin"]})]}),v.jsx(lB,{isOpen:l,onClose:()=>c(!1)})]})]})]})})})},uB=[{id:"dashboard",label:"Dashboard",icon:yR},{id:"articles",label:"Artculos",icon:l5},{id:"movements",label:"Movimientos",icon:sv},{id:"existencias",label:"Existencias",icon:vR},{id:"control-card",label:"Tarjeta de Control",icon:bE},{id:"papeleria-nueva",label:"Papelera Nueva",icon:gR},{id:"import-export",label:"Importar/Exportar",icon:AR},{id:"usuarios",label:"Usuarios",icon:CR}],fB=({currentView:e,onViewChange:t})=>v.jsx("div",{className:"bg-white shadow-sm border-b border-gray-200 sticky top-16 z-20",children:v.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:v.jsx("nav",{className:"flex space-x-1 py-3 overflow-x-auto",children:uB.map(r=>{const n=r.icon,a=e===r.id;return v.jsxs("button",{onClick:()=>t(r.id),className:`flex items-center px-4 py-2 rounded-lg text-sm font-medium transition-all duration-200 whitespace-nowrap ${a?"bg-blue-50 text-blue-700":"text-gray-600 hover:text-gray-800 hover:bg-gray-50"}`,children:[v.jsx(n,{className:"h-4 w-4 mr-2"}),r.label]},r.id)})})})}),ft=e=>new Intl.NumberFormat("es-ES",{style:"currency",currency:"USD"}).format(e),WE=e=>{if(/^\d{4}-\d{2}-\d{2}$/.test(e)){const[r,n,a]=e.split("-");return`${a}/${n}/${r}`}return new Date(e).toLocaleDateString("es-ES",{year:"numeric",month:"2-digit",day:"2-digit"})},hB=({onStatusChange:e})=>{const[t,r]=ie.useState("loading"),[n,a]=ie.useState({connected:!1,tablesExist:!1,errors:[]}),[i,s]=ie.useState(!1),o=async()=>{s(!0);try{const u=await Jk(),f=await Y9(),d=await J9(),h={...u,stats:f,integrity:d};a(h),u.connected&&u.tablesExist&&d.valid?(r("connected"),e==null||e("connected")):(r("error"),e==null||e("error"))}catch(u){r("error"),a(f=>({...f,errors:[...f.errors,`Status check failed: ${u instanceof Error?u.message:"Unknown error"}`]})),e==null||e("error")}finally{s(!1)}};ie.useEffect(()=>{o()},[]);const l=()=>{switch(t){case"connected":return v.jsx(op,{className:"h-5 w-5 text-green-600"});case"error":return v.jsx(m2,{className:"h-5 w-5 text-red-600"});default:return v.jsx(i3,{className:"h-5 w-5 text-gray-400 animate-pulse"})}},c=()=>{switch(t){case"connected":return"border-green-200 bg-green-50";case"error":return"border-red-200 bg-red-50";default:return"border-gray-200 bg-gray-50"}};return v.jsxs(er.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},className:`border rounded-lg p-4 ${c()}`,children:[v.jsxs("div",{className:"flex items-center justify-between mb-3",children:[v.jsxs("div",{className:"flex items-center gap-2",children:[l(),v.jsx("h3",{className:"font-medium text-gray-900",children:"Estado de la Base de Datos"})]}),v.jsx("button",{onClick:o,disabled:i,className:"p-1 text-gray-500 hover:text-gray-700 transition-colors",children:v.jsx(SR,{className:`h-4 w-4 ${i?"animate-spin":""}`})})]}),v.jsxs("div",{className:"space-y-2 text-sm",children:[v.jsxs("div",{className:"flex items-center gap-2",children:[n.connected?v.jsx(op,{className:"h-4 w-4 text-green-500"}):v.jsx(m2,{className:"h-4 w-4 text-red-500"}),v.jsxs("span",{children:["Conexin a Supabase: ",n.connected?"Conectado":"Desconectado"]})]}),v.jsxs("div",{className:"flex items-center gap-2",children:[n.tablesExist?v.jsx(op,{className:"h-4 w-4 text-green-500"}):v.jsx(m2,{className:"h-4 w-4 text-red-500"}),v.jsxs("span",{children:["Tablas de inventario: ",n.tablesExist?"Existentes":"No encontradas"]})]}),n.stats&&v.jsxs("div",{className:"flex items-center gap-2",children:[v.jsx(i3,{className:"h-4 w-4 text-blue-500"}),v.jsxs("span",{children:["Datos: ",n.stats.articulos," artculos, ",n.stats.movimientos," movimientos"]})]}),n.integrity&&v.jsxs("div",{className:"flex items-center gap-2",children:[n.integrity.valid?v.jsx(op,{className:"h-4 w-4 text-green-500"}):v.jsx(Am,{className:"h-4 w-4 text-yellow-500"}),v.jsxs("span",{children:["Integridad: ",n.integrity.valid?"Vlida":`${n.integrity.issues.length} problemas`]})]})]}),n.errors.length>0&&v.jsxs("div",{className:"mt-3 p-2 bg-red-100 border border-red-200 rounded text-sm",children:[v.jsx("div",{className:"font-medium text-red-800 mb-1",children:"Errores encontrados:"}),v.jsx("ul",{className:"text-red-700 space-y-1",children:n.errors.map((u,f)=>v.jsxs("li",{children:[" ",u]},f))})]}),n.integrity&&n.integrity.issues.length>0&&v.jsxs("div",{className:"mt-3 p-2 bg-yellow-100 border border-yellow-200 rounded text-sm",children:[v.jsx("div",{className:"font-medium text-yellow-800 mb-1",children:"Problemas de integridad:"}),v.jsx("ul",{className:"text-yellow-700 space-y-1",children:n.integrity.issues.map((u,f)=>v.jsxs("li",{children:[" ",u]},f))})]}),!n.tablesExist&&v.jsxs("div",{className:"mt-3 p-2 bg-blue-100 border border-blue-200 rounded text-sm",children:[v.jsx("div",{className:"font-medium text-blue-800 mb-1",children:"Accin requerida:"}),v.jsx("p",{className:"text-blue-700",children:"Las tablas de inventario no existen. Por favor, ejecuta el archivo de migracin SQL en tu panel de Supabase para crear las tablas necesarias."})]})]})},dB=()=>{const{articles:e,movements:t,getStock:r,loading:n}=ps();if(n)return v.jsx("div",{className:"flex items-center justify-center py-12",children:v.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600"})});const a=e.length,i=e.reduce((c,u)=>{const f=r(u.id);return c+f*u.costo},0),s=e.filter(c=>r(c.id)<=5).length,o=t.slice(0,5),l=[{title:"Total Artculos",value:a,icon:l5,color:"blue",trend:"+8.2%"},{title:"Valor actual del stock",value:ft(i),icon:_E,color:"green",trend:"+12.5%"},{title:"Stock Bajo",value:s,icon:Am,color:"red",trend:"-5.2%"},{title:"Movimientos",value:t.length,icon:sv,color:"purple",trend:"+18.1%"}];return v.jsxs("div",{className:"space-y-8",children:[v.jsxs(er.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},className:"bg-white rounded-2xl shadow-lg p-8 border border-gray-100",children:[v.jsx("div",{className:"flex flex-col md:flex-row md:items-center md:justify-between gap-4",children:v.jsxs("div",{children:[v.jsx("h2",{className:"text-3xl font-bold text-gray-900 mb-2",children:"Dashboard de Inventario"}),v.jsx("p",{className:"text-gray-600",children:"Visualizacin general del sistema de control de inventario"})]})}),v.jsxs("div",{className:"mt-6 rounded-xl overflow-hidden h-40 md:h-64 relative",children:[v.jsx("img",{src:"https://images.pexels.com/photos/1181354/pexels-photo-1181354.jpeg?auto=compress&cs=tinysrgb&w=1260&h=750&dpr=1",alt:"Dashboard de gestin de inventario",className:"w-full h-full object-cover"}),v.jsx("div",{className:"absolute inset-0 bg-gradient-to-r from-blue-900/70 to-transparent flex items-center",children:v.jsxs("div",{className:"px-8 py-6 text-white max-w-lg",children:[v.jsx("h3",{className:"text-2xl font-bold mb-2 drop-shadow-md",children:"Sistema de Gestin de Inventario"}),v.jsx("p",{className:"text-white/90 drop-shadow-md",children:"Control total sobre su inventario de papelera y suministros de oficina"})]})})]})]}),v.jsx(er.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.1},children:v.jsx(hB,{})}),v.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6",children:l.map((c,u)=>{const f=c.icon;return v.jsxs(er.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:u*.1},className:"bg-white p-6 rounded-xl shadow-lg border border-gray-100 hover:shadow-xl transition-shadow duration-300",children:[v.jsxs("div",{className:"flex items-center justify-between mb-4",children:[v.jsx("div",{className:`p-3 rounded-lg bg-${c.color}-100`,children:v.jsx(f,{className:`h-6 w-6 text-${c.color}-600`})}),v.jsxs("div",{className:"flex items-center px-2 py-1 rounded-full text-xs font-medium bg-green-50 text-green-600",children:[v.jsx(sv,{className:"h-3 w-3 mr-1"}),c.trend]})]}),v.jsx("p",{className:`text-sm font-medium text-${c.color}-600 mb-1`,children:c.title}),v.jsx("p",{className:`text-2xl font-bold text-${c.color}-800`,children:c.value})]},c.title)})}),v.jsxs(er.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.4},className:"bg-white p-6 rounded-xl shadow-lg border border-gray-100",children:[v.jsx("h3",{className:"font-semibold text-gray-800 text-lg mb-6",children:"ltimos Movimientos"}),v.jsx("div",{className:"overflow-x-auto",children:v.jsxs("table",{className:"w-full text-left",children:[v.jsx("thead",{children:v.jsxs("tr",{className:"border-b border-gray-200",children:[v.jsx("th",{className:"pb-3 font-medium text-gray-500 text-sm",children:"Fecha"}),v.jsx("th",{className:"pb-3 font-medium text-gray-500 text-sm",children:"Artculo"}),v.jsx("th",{className:"pb-3 font-medium text-gray-500 text-sm",children:"Tipo"}),v.jsx("th",{className:"pb-3 font-medium text-gray-500 text-sm",children:"Cantidad"}),v.jsx("th",{className:"pb-3 font-medium text-gray-500 text-sm",children:"Valor"})]})}),v.jsx("tbody",{children:o.map(c=>{const u=e.find(f=>f.id===c.id_articulo);return v.jsxs("tr",{className:"border-b border-gray-100 hover:bg-gray-50 transition-colors",children:[v.jsx("td",{className:"py-4 text-sm text-gray-600",children:c.fecha}),v.jsx("td",{className:"py-4 text-sm font-medium text-gray-900",children:(u==null?void 0:u.nombre)||"Artculo no encontrado"}),v.jsx("td",{className:"py-4",children:v.jsx("span",{className:`inline-block px-2 py-1 rounded-full text-xs font-medium ${c.tipo==="Entrada"?"bg-green-100 text-green-800":"bg-red-100 text-red-800"}`,children:c.tipo})}),v.jsxs("td",{className:"py-4 text-sm text-gray-900",children:[c.cantidad," unidades"]}),v.jsx("td",{className:"py-4 text-sm font-medium text-gray-900",children:ft(c.cantidad*c.costo)})]},c.id)})})]})})]})]})},Gu=e=>`$${e.toFixed(2)}`,Lm=(e,t)=>[e.join(","),...t.map(n=>n.map(a=>`"${a}"`).join(","))].join(`
`),Fm=(e,t)=>{const r=new Blob([e],{type:"text/csv;charset=utf-8;"}),n=document.createElement("a"),a=URL.createObjectURL(r);n.setAttribute("href",a),n.setAttribute("download",t),n.style.visibility="hidden",document.body.appendChild(n),n.click(),document.body.removeChild(n),URL.revokeObjectURL(a)},Gl=(e,t,r)=>{const n=new Date().toLocaleDateString("es-ES",{weekday:"long",year:"numeric",month:"long",day:"numeric"}),a=new Date().toLocaleTimeString("es-ES",{hour:"2-digit",minute:"2-digit"});let i="";if(r){const s=[];r.articleId&&s.push(`Artculo: ${r.articleId}`),r.type&&s.push(`Tipo: ${r.type}`),r.dateFrom&&r.dateTo?s.push(`Perodo: ${r.dateFrom} al ${r.dateTo}`):r.dateFrom?s.push(`Desde: ${r.dateFrom}`):r.dateTo&&s.push(`Hasta: ${r.dateTo}`),r.description&&s.push(`Descripcin: "${r.description}"`),r.status&&s.push(`Estado: ${r.status}`),s.length>0&&(i=`<div class="filters-info">Filtros aplicados: ${s.join(" | ")}</div>`)}return`
<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>${e}</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            margin: 20px;
            background: white;
            color: #000;
        }
        .header {
            display: flex;
            justify-content: space-between;
            align-items: flex-start;
            margin-bottom: 20px;
            padding-bottom: 15px;
            border-bottom: 2px solid #000;
        }
        .header h1 {
            margin: 0;
            font-size: 24px;
            font-weight: bold;
            color: #000;
        }
        .header .meta {
            text-align: right;
            font-size: 12px;
            color: #666;
        }
        .company-info {
            margin-bottom: 10px;
            font-weight: bold;
            color: #000;
        }
        .filters-info {
            margin-bottom: 15px;
            padding: 10px;
            background-color: #f0f0f0;
            border: 1px solid #ccc;
            border-radius: 4px;
            font-size: 12px;
            color: #333;
        }
        table {
            border-collapse: collapse;
            width: 100%;
            font-size: 11px;
            margin-top: 10px;
        }
        th, td {
            border: 1px solid #000;
            padding: 6px 8px;
            text-align: left;
        }
        th {
            background-color: #f0f0f0;
            font-weight: bold;
            color: #000;
        }
        .text-center {
            text-align: center;
        }
        .text-right {
            text-align: right;
        }
        .font-medium {
            font-weight: 600;
        }
        .status-badge {
            padding: 2px 6px;
            border-radius: 4px;
            font-size: 10px;
            font-weight: bold;
        }
        .status-success { background-color: #dcfce7; color: #166534; }
        .status-warning { background-color: #fef3c7; color: #92400e; }
        .status-error { background-color: #fee2e2; color: #991b1b; }
        .status-info { background-color: #dbeafe; color: #1e40af; }
        @media print {
            body { margin: 0; }
            .no-print { display: none; }
        }
    </style>
</head>
<body>
    <div class="header">
        <div>
            <div class="company-info">Sistema de Control de Inventario</div>
            <div class="company-info">Alcalda Municipal de Cabaas Oeste</div>
            <h1>${e}</h1>
            <div>${n} - ${a}</div>
        </div>
        <div class="meta">
            <div>Unidad de Informtica</div>
            <div>Pgina 1 de 1</div>
        </div>
    </div>
    
    ${i}
    ${t}
    
    <div style="margin-top: 30px; font-size: 10px; color: #666; text-align: center; border-top: 1px solid #ccc; padding-top: 10px;">
        Sistema de Control de Inventario - Generado automticamente el ${n} a las ${a}
    </div>
</body>
</html>`},fh=(e,t)=>{const r=new Blob([e],{type:"text/html;charset=utf-8;"}),n=document.createElement("a"),a=URL.createObjectURL(r);n.setAttribute("href",a),n.setAttribute("download",t),n.style.visibility="hidden",document.body.appendChild(n),n.click(),document.body.removeChild(n),URL.revokeObjectURL(a)},g5=()=>{window.print()},pB=(e,t,r)=>{const n=["ID","Artculo","Costo Unitario","Stock Actual","Valor Total"],a=e.map(o=>{const l=t(o.id),c=l*o.costo;return[o.id.toString(),o.nombre,Gu(o.costo),`${l} unidades`,Gu(c)]}),i=Lm(n,a),s=`articulos_${new Date().toISOString().split("T")[0]}.csv`;Fm(i,s)},mB=(e,t,r)=>{const n=["Fecha","Artculo","Tipo","Cantidad","Costo","Descripcin","Valor Total"],a=e.map(o=>[WE(o.fecha),t(o.id_articulo),o.tipo,o.cantidad.toString(),Gu(o.costo),o.descripcion||"",Gu(o.cantidad*o.costo)]),i=Lm(n,a),s=`movimientos_${new Date().toISOString().split("T")[0]}.csv`;Fm(i,s)},gB=(e,t,r)=>{const n=["Artculo","Stock","Costo Unitario","Valor Total","Estado"],a=e.map(o=>{const l=t(o.id),c=l*o.costo;let u="Stock Normal";return l===0?u="Sin Stock":l<=5&&(u="Stock Bajo"),[o.nombre,`${l} unidades`,Gu(o.costo),Gu(c),u]}),i=Lm(n,a),s=`existencias_${new Date().toISOString().split("T")[0]}.csv`;Fm(i,s)},Cu=(e,t)=>`
    <table>
      <thead>
        <tr>
          ${e.map(r=>`<th>${r}</th>`).join("")}
        </tr>
      </thead>
      <tbody>
        ${t.map(r=>`
          <tr>
            ${r.map(n=>`<td>${n}</td>`).join("")}
          </tr>
        `).join("")}
      </tbody>
    </table>
  `,xB=({isOpen:e,onClose:t,article:r})=>{const{addArticle:n,updateArticle:a}=ps(),[i,s]=ie.useState({nombre:"",costo:""}),[o,l]=ie.useState(!1);ie.useEffect(()=>{s(r?{nombre:r.nombre,costo:r.costo.toString()}:{nombre:"",costo:""})},[r,e]);const c=async u=>{if(u.preventDefault(),!i.nombre.trim()||!i.costo||parseFloat(i.costo)<=0){st.error("Por favor complete todos los campos correctamente");return}l(!0);try{const f={nombre:i.nombre.trim().toUpperCase(),costo:parseFloat(i.costo)};r?await a(r.id,f):await n(f),t()}catch{}finally{l(!1)}};return v.jsx(Em,{children:e&&v.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50",children:v.jsxs(er.div,{initial:{opacity:0,scale:.9},animate:{opacity:1,scale:1},exit:{opacity:0,scale:.9},className:"bg-white rounded-xl p-6 max-w-md w-full shadow-2xl",children:[v.jsxs("div",{className:"flex justify-between items-center mb-4",children:[v.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:r?"Editar Artculo":"Agregar Artculo"}),v.jsx("button",{onClick:t,className:"text-gray-400 hover:text-gray-600 transition-colors",children:v.jsx(Dh,{className:"h-6 w-6"})})]}),v.jsxs("form",{onSubmit:c,className:"space-y-4",children:[v.jsxs("div",{children:[v.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Nombre del Artculo"}),v.jsx("input",{type:"text",value:i.nombre,onChange:u=>s({...i,nombre:u.target.value}),className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all",required:!0})]}),v.jsxs("div",{children:[v.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Costo Unitario"}),v.jsx("input",{type:"number",step:"0.01",min:"0",value:i.costo,onChange:u=>s({...i,costo:u.target.value}),className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all",required:!0})]}),v.jsxs("div",{className:"flex gap-3 pt-4",children:[v.jsx("button",{type:"button",onClick:t,className:"flex-1 px-4 py-2 bg-gray-200 text-gray-800 rounded-lg hover:bg-gray-300 transition-colors font-medium",children:"Cancelar"}),v.jsxs("button",{type:"submit",disabled:o,className:"flex-1 px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors font-medium disabled:opacity-50 disabled:cursor-not-allowed flex items-center justify-center gap-2",children:[o?v.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white"}):v.jsx(c5,{className:"h-4 w-4"}),o?"Guardando...":"Guardar"]})]})]})]})})})},vB=({isOpen:e,onClose:t,onConfirm:r,title:n,message:a,confirmText:i="Confirmar",cancelText:s="Cancelar",type:o="warning"})=>{const c={danger:{icon:"text-red-600",button:"bg-red-600 hover:bg-red-700",background:"bg-red-50"},warning:{icon:"text-yellow-600",button:"bg-yellow-600 hover:bg-yellow-700",background:"bg-yellow-50"},info:{icon:"text-blue-600",button:"bg-blue-600 hover:bg-blue-700",background:"bg-blue-50"}}[o];return v.jsx(Em,{children:e&&v.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50",children:v.jsxs(er.div,{initial:{opacity:0,scale:.9},animate:{opacity:1,scale:1},exit:{opacity:0,scale:.9},className:"bg-white rounded-xl p-6 max-w-md w-full shadow-2xl",children:[v.jsxs("div",{className:"flex items-center justify-between mb-4",children:[v.jsxs("div",{className:"flex items-center",children:[v.jsx("div",{className:`p-2 rounded-full ${c.background} mr-3`,children:v.jsx(Am,{className:`h-6 w-6 ${c.icon}`})}),v.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:n})]}),v.jsx("button",{onClick:t,className:"text-gray-400 hover:text-gray-600 transition-colors",children:v.jsx(Dh,{className:"h-6 w-6"})})]}),v.jsx("p",{className:"text-gray-600 mb-6",children:a}),v.jsxs("div",{className:"flex gap-3",children:[v.jsx("button",{onClick:t,className:"flex-1 px-4 py-2 bg-gray-200 text-gray-800 rounded-lg hover:bg-gray-300 transition-colors font-medium",children:s}),v.jsx("button",{onClick:()=>{r(),t()},className:`flex-1 px-4 py-2 text-white rounded-lg transition-colors font-medium ${c.button}`,children:i})]})]})})})},yB=()=>{const{articles:e,getStock:t,deleteArticle:r}=ps(),[n,a]=ie.useState(!1),[i,s]=ie.useState(null),[o,l]=ie.useState(""),[c,u]=ie.useState({dateFrom:"",dateTo:"",minCost:"",maxCost:"",stockStatus:""}),[f,d]=ie.useState(!1),[h,g]=ie.useState(null),m=N=>{const L=t(N);return L===0?"Sin Stock":L<=5?"Stock Bajo":"Stock Normal"},_=e.filter(N=>N.nombre.toLowerCase().includes(o.toLowerCase())&&(c.minCost===""||N.costo>=parseFloat(c.minCost))&&(c.maxCost===""||N.costo<=parseFloat(c.maxCost))&&(c.stockStatus===""||m(N.id)===c.stockStatus)),y=N=>{s(N),a(!0)},b=()=>{s(null),a(!0)},w=async N=>{const L=t(N);if(L>0){st.error(`No se puede eliminar un artculo que tiene existencias. Stock actual: ${L} unidades`);return}g(N)},T=()=>{l(""),u({dateFrom:"",dateTo:"",minCost:"",maxCost:"",stockStatus:""})},F=()=>{g5()},I=N=>`$${N.toFixed(2)}`,A=()=>{const N=["ID","Artculo","Costo Unitario","Stock Actual","Valor Total"],L=_.map(de=>{const X=t(de.id),ee=X*de.costo;return[de.id.toString(),de.nombre,I(de.costo),`${X} unidades`,I(ee)]}),G=Cu(N,L),W=Gl("Gestin de Artculos",G,{description:o,...c}),le=`articulos_${new Date().toISOString().split("T")[0]}.html`;fh(W,le),st.success("Artculos exportados a PDF/HTML")},P=()=>{pB(_,t,{description:o,...c}),st.success("Artculos exportados a CSV")},j=h!==null?e.find(N=>N.id===h):null,J=j?t(j.id):null;return v.jsxs("div",{className:"space-y-8",children:[v.jsx(er.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},className:"bg-white rounded-2xl shadow-lg p-8 border border-gray-100",children:v.jsxs("div",{className:"flex items-center justify-between",children:[v.jsxs("div",{children:[v.jsx("h2",{className:"text-3xl font-bold text-gray-900 mb-2",children:"Gestin de Artculos"}),v.jsx("p",{className:"text-gray-600",children:"Administra el catlogo de productos del inventario"})]}),v.jsxs("button",{onClick:b,className:"px-6 py-3 bg-blue-600 text-white rounded-lg hover:bg-blue-700 flex items-center justify-center gap-2 font-medium transition-all duration-300 shadow-lg hover:shadow-xl",children:[v.jsx(EE,{className:"h-4 w-4"}),"Nuevo Artculo"]})]})}),v.jsx(er.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.1},className:"bg-white rounded-xl shadow-lg p-6 border border-gray-100",children:v.jsxs("div",{className:"flex flex-col md:flex-row gap-4 items-center",children:[v.jsxs("div",{className:"flex-1 relative w-full",children:[v.jsx(AE,{className:"absolute left-3 top-3 h-5 w-5 text-gray-400"}),v.jsx("input",{type:"text",placeholder:"Buscar artculo por nombre...",value:o,onChange:N=>l(N.target.value),className:"w-full pl-10 pr-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all"})]}),v.jsx("div",{className:"flex justify-end w-full md:w-auto",children:v.jsx("button",{onClick:T,className:"px-4 py-2 bg-gray-100 text-gray-700 rounded-lg hover:bg-gray-200 transition-colors font-medium",children:"Limpiar filtro"})})]})}),v.jsxs(er.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.2},className:"bg-white rounded-xl shadow-lg overflow-hidden border border-gray-100",children:[v.jsx("div",{className:"p-6 border-b border-gray-200",children:v.jsxs("div",{className:"flex justify-between items-center",children:[v.jsxs("div",{children:[v.jsx("h3",{className:"font-semibold text-gray-800 text-lg",children:"Lista de Artculos"}),v.jsx("p",{className:"text-sm text-gray-600 mt-1",children:"Gestiona todos los artculos del inventario"})]}),v.jsxs("div",{className:"flex gap-2",children:[v.jsxs("button",{onClick:F,className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 flex items-center gap-2 font-medium",children:[v.jsx(ch,{className:"h-5 w-5"})," Imprimir"]}),v.jsxs("button",{onClick:A,className:"px-4 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700 flex items-center gap-2 font-medium",children:[v.jsx(ss,{className:"h-5 w-5"})," PDF"]}),v.jsxs("button",{onClick:P,className:"px-4 py-2 bg-gray-700 text-white rounded-lg hover:bg-gray-800 flex items-center gap-2 font-medium",children:[v.jsx(ss,{className:"h-5 w-5"})," CSV"]})]})]})}),v.jsx("div",{className:"overflow-x-auto",children:v.jsxs("table",{className:"w-full",children:[v.jsx("thead",{className:"bg-gray-50",children:v.jsxs("tr",{children:[v.jsx("th",{className:"px-6 py-4 text-left text-sm font-semibold text-gray-900",children:"ID"}),v.jsx("th",{className:"px-6 py-4 text-left text-sm font-semibold text-gray-900",children:"Artculo"}),v.jsx("th",{className:"px-6 py-4 text-left text-sm font-semibold text-gray-900",children:"Costo Unitario"}),v.jsx("th",{className:"px-6 py-4 text-left text-sm font-semibold text-gray-900",children:"Stock Actual"}),v.jsx("th",{className:"px-6 py-4 text-left text-sm font-semibold text-gray-900",children:"Valor Total"}),v.jsx("th",{className:"px-6 py-4 text-center text-sm font-semibold text-gray-900",children:"Acciones"})]})}),v.jsx("tbody",{className:"divide-y divide-gray-200",children:_.length===0?v.jsx("tr",{children:v.jsx("td",{colSpan:7,className:"px-6 py-8 text-center text-gray-500",children:"No hay artculos registrados"})}):_.map(N=>{const L=t(N.id),G=L*N.costo;return v.jsxs("tr",{className:"hover:bg-gray-50",children:[v.jsx("td",{className:"px-6 py-4 text-sm text-gray-900",children:N.id}),v.jsx("td",{className:"px-6 py-4 text-sm font-medium text-gray-900",children:N.nombre}),v.jsx("td",{className:"px-6 py-4 text-sm text-gray-900",children:ft(N.costo)}),v.jsx("td",{className:"px-6 py-4 text-sm",children:v.jsxs("span",{className:`inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium ${L===0?"bg-red-100 text-red-800":L<10?"bg-yellow-100 text-yellow-800":"bg-green-100 text-green-800"}`,children:[L," unidades"]})}),v.jsx("td",{className:"px-6 py-4 text-sm font-medium text-gray-900",children:ft(G)}),v.jsx("td",{className:"px-6 py-4 text-center no-print",children:v.jsxs("div",{className:"flex items-center justify-center gap-2",children:[v.jsx("button",{onClick:()=>y(N),className:"p-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors",title:"Editar artculo",children:v.jsx(kR,{className:"h-4 w-4"})}),v.jsx("button",{onClick:()=>w(N.id),className:"p-2 bg-red-600 text-white rounded-lg hover:bg-red-700 transition-colors",title:"Eliminar artculo",children:v.jsx(ER,{className:"h-4 w-4"})})]})})]},N.id)})})]})}),f&&v.jsxs(er.div,{initial:{opacity:0,height:0},animate:{opacity:1,height:"auto"},exit:{opacity:0,height:0},className:"bg-white rounded-xl shadow-lg p-6 border border-gray-100",children:[v.jsxs("div",{className:"flex justify-between items-center mb-4",children:[v.jsx("h3",{className:"font-semibold text-gray-800",children:"Filtros Avanzados"}),v.jsx("button",{onClick:()=>d(!1),className:"text-gray-400 hover:text-gray-600",children:v.jsx(Dh,{className:"h-5 w-5"})})]}),v.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4",children:[v.jsxs("div",{children:[v.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Costo Mnimo"}),v.jsx("input",{type:"number",step:"0.01",min:"0",value:c.minCost,onChange:N=>u({...c,minCost:N.target.value}),className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",placeholder:"0.00"})]}),v.jsxs("div",{children:[v.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Costo Mximo"}),v.jsx("input",{type:"number",step:"0.01",min:"0",value:c.maxCost,onChange:N=>u({...c,maxCost:N.target.value}),className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",placeholder:"999.99"})]}),v.jsxs("div",{children:[v.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Estado de Stock"}),v.jsxs("select",{value:c.stockStatus,onChange:N=>u({...c,stockStatus:N.target.value}),className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",children:[v.jsx("option",{value:"",children:"Todos los estados"}),v.jsx("option",{value:"Sin Stock",children:"Sin Stock"}),v.jsx("option",{value:"Stock Normal",children:"Stock Normal"})]})]}),v.jsxs("div",{className:"flex items-end",children:[v.jsxs("button",{onClick:F,className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors flex items-center gap-2",children:[v.jsx(ch,{className:"h-4 w-4"}),"Imprimir"]}),v.jsxs("button",{onClick:A,className:"px-4 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700 transition-colors flex items-center gap-2",children:[v.jsx(ss,{className:"h-4 w-4"}),"PDF"]}),v.jsxs("button",{onClick:P,className:"px-4 py-2 bg-gray-600 text-white rounded-lg hover:bg-gray-700 transition-colors flex items-center gap-2",children:[v.jsx(ss,{className:"h-4 w-4"}),"CSV"]})]})]})]})]}),v.jsx(vB,{isOpen:h!==null,onClose:()=>g(null),onConfirm:async()=>{if(h!==null)try{await r(h),g(null)}catch{}},title:"Advertencia de Eliminacin!",message:J===0?"Ests seguro de que deseas eliminar este artculo? Esta accin es irreversible.":"Si eliminas este artculo, tambin se eliminarn TODAS las entradas y salidas asociadas a l. Esta accin es irreversible. Deseas continuar?",confirmText:"S, eliminar todo",cancelText:"Cancelar",type:"danger"}),v.jsx(xB,{isOpen:n,onClose:()=>a(!1),article:i})]})},wB=({isOpen:e,onClose:t,movementToEdit:r})=>{const{articles:n,addMovement:a,updateMovement:i,getStock:s,movements:o}=ps(),[l,c]=ie.useState({id_articulo:"",tipo:"",cantidad:"",fecha:new Date().toISOString().split("T")[0],descripcion:""}),[u,f]=ie.useState(!1),[d,h]=ie.useState("");Fi.useEffect(()=>{c(r?{id_articulo:r.id_articulo.toString(),tipo:r.tipo,cantidad:r.cantidad.toString(),fecha:r.fecha,descripcion:r.descripcion}:{id_articulo:"",tipo:"",cantidad:"",fecha:new Date().toISOString().split("T")[0],descripcion:""})},[r,e]);const g=async m=>{if(m.preventDefault(),!l.id_articulo||!l.tipo||!l.cantidad||!l.descripcion){st.error("Por favor complete todos los campos");return}const _=parseInt(l.id_articulo),y=parseInt(l.cantidad);if(y<=0){console.log("VALIDACIN FALLIDA: cantidad menor o igual a 0"),st.error("La cantidad debe ser mayor a 0");return}if(l.tipo==="Entrada"){if(r){const w=o.filter(T=>T.id_articulo===_&&T.tipo==="Salida"&&new Date(T.fecha)>=new Date(l.fecha)).reduce((T,F)=>T+F.cantidad,0);if(y<w){const T=`No puedes registrar una entrada menor a las salidas ya realizadas (${w} unidades).`;h(T),console.log("VALIDACIN FALLIDA: entrada menor a salidas posteriores",T),st.error(T);return}else h("")}}else if(l.tipo==="Salida"){const b=o.filter(I=>I.id_articulo===_&&I.tipo==="Entrada"),w=o.filter(I=>I.id_articulo===_&&I.tipo==="Salida"&&I.id!==(r?r.id:null)),T=b.reduce((I,A)=>I+A.cantidad,0),F=w.reduce((I,A)=>I+A.cantidad,0);if(F+y>T){console.log("VALIDACIN FALLIDA: salida mayor al stock disponible",{totalSalidas:F,cantidad:y,totalEntradas:T}),st.error("No puedes registrar una salida mayor al stock disponible.");return}}f(!0);try{const b=n.find(T=>T.id===_);if(!b){st.error("Artculo no encontrado");return}const w={id_articulo:_,tipo:l.tipo,cantidad:y,fecha:l.fecha,descripcion:l.descripcion.trim().toUpperCase(),costo:b.costo};r?await i(r.id,w):await a(w),c({id_articulo:"",tipo:"",cantidad:"",fecha:new Date().toISOString().split("T")[0],descripcion:""}),t()}catch{}finally{f(!1)}};return v.jsx(Em,{children:e&&v.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50",children:v.jsxs(er.div,{initial:{opacity:0,scale:.9},animate:{opacity:1,scale:1},exit:{opacity:0,scale:.9},className:"bg-white rounded-xl p-6 max-w-md w-full shadow-2xl",children:[v.jsxs("div",{className:"flex justify-between items-center mb-4",children:[v.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:r?"Editar Movimiento":"Registrar Movimiento"}),v.jsx("button",{onClick:t,className:"text-gray-400 hover:text-gray-600 transition-colors",children:v.jsx(Dh,{className:"h-6 w-6"})})]}),v.jsxs("form",{onSubmit:g,className:"space-y-4",children:[v.jsxs("div",{children:[v.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Artculo"}),v.jsxs("select",{value:l.id_articulo,onChange:m=>c({...l,id_articulo:m.target.value}),className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all",required:!0,children:[v.jsx("option",{value:"",children:"Seleccionar artculo..."}),n.map(m=>v.jsx("option",{value:m.id,children:m.nombre},m.id))]})]}),v.jsxs("div",{children:[v.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Tipo de Movimiento"}),v.jsxs("select",{value:l.tipo,onChange:m=>c({...l,tipo:m.target.value}),className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all",required:!0,children:[v.jsx("option",{value:"",children:"Seleccionar tipo..."}),v.jsx("option",{value:"Entrada",children:"Entrada"}),v.jsx("option",{value:"Salida",children:"Salida"})]})]}),v.jsxs("div",{children:[v.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Cantidad"}),v.jsx("input",{type:"number",min:"1",value:l.cantidad,onChange:m=>c({...l,cantidad:m.target.value}),className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all",required:!0})]}),v.jsxs("div",{children:[v.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Fecha"}),v.jsx("input",{type:"date",value:l.fecha,onChange:m=>c({...l,fecha:m.target.value}),className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all",required:!0})]}),v.jsxs("div",{children:[v.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Descripcin"}),v.jsx("textarea",{rows:3,value:l.descripcion,onChange:m=>c({...l,descripcion:m.target.value}),className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all",required:!0})]}),v.jsxs("div",{children:[v.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Costo Unitario"}),v.jsx("input",{type:"number",value:(()=>{const m=n.find(_=>_.id===parseInt(l.id_articulo));return m?m.costo:""})(),readOnly:!0,className:"w-full px-4 py-2 border border-gray-300 rounded-lg bg-gray-100 focus:ring-0 focus:border-gray-300 transition-all",placeholder:"Selecciona un artculo"})]}),v.jsxs("div",{className:"flex gap-3 pt-4",children:[v.jsx("button",{type:"button",onClick:t,className:"flex-1 px-4 py-2 bg-gray-200 text-gray-800 rounded-lg hover:bg-gray-300 transition-colors font-medium",children:"Cancelar"}),v.jsxs("button",{type:"submit",disabled:u,className:"flex-1 px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors font-medium disabled:opacity-50 disabled:cursor-not-allowed flex items-center justify-center gap-2",children:[u?v.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white"}):v.jsx(c5,{className:"h-4 w-4"}),u?"Registrando...":"Registrar"]})]})]})]})})})},bB=()=>{const{movements:e,articles:t,deleteMovement:r,actualizarCostosMovimientos:n}=ps(),[a,i]=ie.useState(!1),[s,o]=ie.useState({articleId:"",type:"",month:"",year:"",description:""}),[l,c]=ie.useState(null),u=e.filter(b=>{if(t.find(w=>w.id===b.id_articulo),s.articleId&&b.id_articulo!==parseInt(s.articleId)||s.type&&b.tipo!==s.type)return!1;if(s.month&&s.year&&b.fecha){const w=new Date(b.fecha);if(w.getMonth()+1!==parseInt(s.month)||w.getFullYear()!==parseInt(s.year))return!1}return!(s.description&&!b.descripcion.toLowerCase().includes(s.description.toLowerCase()))}),f=b=>{const w=t.find(T=>T.id===b);return w?w.nombre:"Artculo no encontrado"},d=()=>{o({articleId:"",type:"",month:"",year:"",description:""})},h=()=>{g5()},g=b=>`$${b.toFixed(2)}`,m=()=>{const b=["Fecha","Artculo","Tipo","Cantidad","Costo","Descripcin","Valor Total"],w=u.map(A=>[A.fecha,f(A.id_articulo),A.tipo,A.cantidad.toString(),g(A.costo),A.descripcion||"",g(A.cantidad*A.costo)]),T=Cu(b,w),F=Gl("Movimientos de Inventario",T,s),I=`movimientos_${new Date().toISOString().split("T")[0]}.html`;fh(F,I),st.success("Movimientos exportados a PDF/HTML")},_=()=>{mB(u,f),st.success("Movimientos exportados a CSV")},y=async b=>{const w=f(b.id_articulo);if(b.tipo==="Entrada"&&e.some(F=>F.id_articulo===b.id_articulo&&F.tipo==="Salida"&&new Date(F.fecha)>=new Date(b.fecha))){st.error("No se puede eliminar esta entrada porque existen salidas asociadas posteriores. Solo puede editarse.");return}if(window.confirm(`Seguro que deseas eliminar el movimiento de "${w}"?`))try{await r(b.id)}catch{}};return v.jsxs("div",{className:"space-y-8",children:[v.jsx(er.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},className:"bg-white rounded-2xl shadow-lg p-8 border border-gray-100",children:v.jsxs("div",{className:"flex items-center justify-between",children:[v.jsxs("div",{children:[v.jsx("h2",{className:"text-3xl font-bold text-gray-900 mb-2",children:"Movimientos de Inventario"}),v.jsx("p",{className:"text-gray-600",children:"Registra entradas y salidas de productos"})]}),v.jsxs("button",{onClick:()=>i(!0),className:"px-6 py-3 bg-blue-600 text-white rounded-lg hover:bg-blue-700 flex items-center justify-center gap-2 font-medium transition-all duration-300 shadow-lg hover:shadow-xl",children:[v.jsx(EE,{className:"h-4 w-4"}),"Nuevo Movimiento"]})]})}),v.jsxs(er.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.1},className:"bg-white rounded-xl shadow-lg p-6 border border-gray-100",children:[v.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-6 gap-4",children:[v.jsxs("div",{children:[v.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Filtrar por Artculo"}),v.jsxs("select",{value:s.articleId,onChange:b=>o({...s,articleId:b.target.value}),className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",children:[v.jsx("option",{value:"",children:"Todos los artculos"}),t.map(b=>v.jsx("option",{value:b.id,children:b.nombre},b.id))]})]}),v.jsxs("div",{children:[v.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Tipo de Movimiento"}),v.jsxs("select",{value:s.type,onChange:b=>o({...s,type:b.target.value}),className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",children:[v.jsx("option",{value:"",children:"Todos los tipos"}),v.jsx("option",{value:"Entrada",children:"Entrada"}),v.jsx("option",{value:"Salida",children:"Salida"})]})]}),v.jsxs("div",{children:[v.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Mes"}),v.jsxs("select",{value:s.month,onChange:b=>o({...s,month:b.target.value}),className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",children:[v.jsx("option",{value:"",children:"Todos los meses"}),v.jsx("option",{value:"1",children:"Enero"}),v.jsx("option",{value:"2",children:"Febrero"}),v.jsx("option",{value:"3",children:"Marzo"}),v.jsx("option",{value:"4",children:"Abril"}),v.jsx("option",{value:"5",children:"Mayo"}),v.jsx("option",{value:"6",children:"Junio"}),v.jsx("option",{value:"7",children:"Julio"}),v.jsx("option",{value:"8",children:"Agosto"}),v.jsx("option",{value:"9",children:"Septiembre"}),v.jsx("option",{value:"10",children:"Octubre"}),v.jsx("option",{value:"11",children:"Noviembre"}),v.jsx("option",{value:"12",children:"Diciembre"})]})]}),v.jsxs("div",{children:[v.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Ao"}),v.jsxs("select",{value:s.year,onChange:b=>o({...s,year:b.target.value}),className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",children:[v.jsx("option",{value:"",children:"Todos los aos"}),(()=>{const b=new Date().getFullYear(),w=[];for(let T=2023;T<=b;T++)w.push(v.jsx("option",{value:T,children:T},T));return w})()]})]}),v.jsxs("div",{children:[v.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Descripcin"}),v.jsx("input",{type:"text",placeholder:"Buscar en descripcin...",value:s.description,onChange:b=>o({...s,description:b.target.value}),className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500"})]}),v.jsx("div",{className:"flex items-end",children:v.jsx("button",{onClick:d,className:"w-full px-4 py-2 bg-gray-100 text-gray-700 rounded-lg hover:bg-gray-200 transition-colors font-medium",children:"Limpiar Filtros"})})]}),v.jsx("div",{className:"flex justify-between items-center mt-4",children:v.jsxs("div",{className:"text-sm text-gray-600",children:["Mostrando ",u.length," de ",e.length," movimientos"]})})]}),v.jsxs(er.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.2},className:"bg-white rounded-xl shadow-lg overflow-hidden border border-gray-100",children:[v.jsx("div",{className:"p-6 border-b border-gray-200",children:v.jsxs("div",{className:"flex justify-between items-center",children:[v.jsxs("div",{children:[v.jsx("h3",{className:"font-semibold text-gray-800 text-lg",children:"Historial de Movimientos"}),v.jsx("p",{className:"text-sm text-gray-600 mt-1",children:"Registro filtrado de entradas y salidas"})]}),v.jsxs("div",{className:"flex gap-2",children:[v.jsxs("button",{onClick:h,className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 flex items-center gap-2 font-medium",children:[v.jsx(ch,{className:"h-5 w-5"})," Imprimir"]}),v.jsxs("button",{onClick:m,className:"px-4 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700 flex items-center gap-2 font-medium",children:[v.jsx(ss,{className:"h-5 w-5"})," PDF"]}),v.jsxs("button",{onClick:_,className:"px-4 py-2 bg-gray-700 text-white rounded-lg hover:bg-gray-800 flex items-center gap-2 font-medium",children:[v.jsx(ss,{className:"h-5 w-5"})," CSV"]})]})]})}),v.jsx("div",{className:"overflow-x-auto",children:v.jsxs("table",{className:"w-full",children:[v.jsx("thead",{className:"bg-gray-50",children:v.jsxs("tr",{children:[v.jsx("th",{className:"px-6 py-4 text-left text-sm font-semibold text-gray-900 min-w-[130px]",children:"Fecha"}),v.jsx("th",{className:"px-6 py-4 text-left text-sm font-semibold text-gray-900",children:"Artculo"}),v.jsx("th",{className:"px-6 py-4 text-left text-sm font-semibold text-gray-900",children:"Tipo"}),v.jsx("th",{className:"px-6 py-4 text-left text-sm font-semibold text-gray-900",children:"Cantidad"}),v.jsx("th",{className:"px-6 py-4 text-left text-sm font-semibold text-gray-900",children:"Costo"}),v.jsx("th",{className:"px-6 py-4 text-left text-sm font-semibold text-gray-900",children:"Descripcin"}),v.jsx("th",{className:"px-6 py-4 text-left text-sm font-semibold text-gray-900",children:"Valor Total"})]})}),v.jsxs("tbody",{className:"divide-y divide-gray-200",children:[u.map(b=>v.jsxs("tr",{className:"hover:bg-gray-50 transition-colors",children:[v.jsx("td",{className:"px-6 py-4 text-sm text-gray-600 min-w-[130px]",children:b.fecha}),v.jsx("td",{className:"px-6 py-4 text-sm font-medium text-gray-900",children:f(b.id_articulo)}),v.jsx("td",{className:"px-6 py-4",children:v.jsx("span",{className:`inline-block px-2 py-1 rounded-full text-xs font-medium ${b.tipo==="Entrada"?"bg-green-100 text-green-800":"bg-red-100 text-red-800"}`,children:b.tipo})}),v.jsx("td",{className:"px-6 py-4 text-sm text-gray-900",children:b.cantidad}),v.jsx("td",{className:"px-6 py-4 text-sm text-gray-900",children:ft(b.costo)}),v.jsx("td",{className:"px-6 py-4 text-sm text-gray-600",children:b.descripcion}),v.jsx("td",{className:"px-6 py-4 text-sm font-medium text-gray-900",children:ft(b.cantidad*b.costo)}),v.jsxs("td",{className:"px-6 py-4 text-center no-print flex gap-2 justify-center",children:[v.jsx("button",{className:"p-2 rounded-full bg-yellow-100 hover:bg-yellow-200 text-yellow-700 transition-colors",title:"Editar",onClick:()=>{c(b),i(!0)},children:v.jsx(kE,{className:"w-4 h-4"})}),v.jsx("button",{className:"p-2 rounded-full bg-red-100 hover:bg-red-200 text-red-700 transition-colors",title:"Eliminar",onClick:()=>y(b),children:v.jsx(TE,{className:"w-4 h-4"})})]})]},b.id)),u.length===0&&v.jsx("tr",{children:v.jsx("td",{colSpan:8,className:"px-6 py-8 text-center text-gray-500",children:"No se encontraron movimientos que coincidan con los filtros aplicados"})})]})]})})]}),v.jsx(wB,{isOpen:a,onClose:()=>{i(!1),c(null)},movementToEdit:l})]})},p3=e=>`$${e.toFixed(2)}`,_B=()=>{const{articles:e,getStock:t}=ps(),[r,n]=Fi.useState({articleId:"",status:""}),i=e.filter(m=>{if(r.articleId&&m.id!==parseInt(r.articleId))return!1;const _=t(m.id);_*m.costo;let y;return _===0?y="Sin Stock":_<=5?y="Stock Bajo":y="Stock Normal",!(r.status&&y!==r.status)}),s=i.map(m=>{const _=t(m.id),y=_*m.costo;let b;return _===0?b="Sin Stock":_<=5?b="Stock Bajo":b="Stock Normal",{article:m,stock:_,totalValue:y,status:b}}),o=s.reduce((m,_)=>m+_.stock,0),l=s.filter(m=>m.stock<=5).length,c=s.reduce((m,_)=>m+_.totalValue,0),u=()=>{n({articleId:"",status:""})},f=()=>{g5()},d=()=>{const m=["Artculo","Stock","Costo Unitario","Valor Total","Estado"],_=s.map(({article:T,stock:F,totalValue:I,status:A})=>[T.nombre,`${F} unidades`,p3(T.costo),p3(I),A]),y=Cu(m,_),b=Gl("Control de Existencias",y,r),w=`existencias_${new Date().toISOString().split("T")[0]}.html`;fh(b,w),st.success("Existencias exportadas a PDF/HTML")},h=()=>{gB(i,t),st.success("Existencias exportadas a CSV")},g=[{title:"Total Unidades",value:o,icon:l5,color:"blue"},{title:"Stock Bajo",value:l,icon:Am,color:"red"},{title:"Valor Total",value:ft(c),icon:_E,color:"green"}];return v.jsxs("div",{className:"space-y-8",children:[v.jsx(er.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},className:"bg-white rounded-2xl shadow-lg p-8 border border-gray-100",children:v.jsx("div",{className:"flex items-center justify-between",children:v.jsxs("div",{children:[v.jsx("h2",{className:"text-3xl font-bold text-gray-900 mb-2",children:"Control de Existencias"}),v.jsx("p",{className:"text-gray-600",children:"Visualiza el stock de productos por perodo y artculo"})]})})}),v.jsxs(er.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.1},className:"bg-white rounded-xl shadow-lg p-6 border border-gray-100",children:[v.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-4 gap-4",children:[v.jsxs("div",{children:[v.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Filtrar por Artculo"}),v.jsxs("select",{value:r.articleId,onChange:m=>n({...r,articleId:m.target.value}),className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",children:[v.jsx("option",{value:"",children:"Todos los artculos"}),e.map(m=>v.jsx("option",{value:m.id,children:m.nombre},m.id))]})]}),v.jsxs("div",{children:[v.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Estado"}),v.jsxs("select",{value:r.status,onChange:m=>n({...r,status:m.target.value}),className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",children:[v.jsx("option",{value:"",children:"Todos los estados"}),v.jsx("option",{value:"Sin Stock",children:"Sin Stock"}),v.jsx("option",{value:"Stock Bajo",children:"Stock Bajo"}),v.jsx("option",{value:"Stock Normal",children:"Stock Normal"})]})]}),v.jsx("div",{className:"flex items-end",children:v.jsx("button",{onClick:u,className:"w-full px-4 py-2 bg-gray-100 text-gray-700 rounded-lg hover:bg-gray-200 transition-colors font-medium",children:"Limpiar Filtros"})})]}),v.jsx("div",{className:"flex justify-between items-center mt-4",children:v.jsxs("div",{className:"text-sm text-gray-600",children:["Mostrando ",i.length," de ",e.length," artculos"]})})]}),v.jsx("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:g.map((m,_)=>{const y=m.icon;return v.jsx(er.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:_*.1},className:"bg-white p-6 rounded-xl shadow-lg border border-gray-100",children:v.jsxs("div",{className:"flex items-center",children:[v.jsx("div",{className:`p-3 bg-${m.color}-100 rounded-lg mr-4`,children:v.jsx(y,{className:`h-6 w-6 text-${m.color}-600`})}),v.jsxs("div",{children:[v.jsx("p",{className:"text-sm font-medium text-gray-600",children:m.title}),v.jsx("p",{className:"text-2xl font-bold text-gray-900",children:m.value})]})]})},m.title)})}),v.jsxs(er.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.3},className:"bg-white rounded-xl shadow-lg overflow-hidden border border-gray-100",children:[v.jsx("div",{className:"p-6 border-b border-gray-200",children:v.jsxs("div",{className:"flex justify-between items-center",children:[v.jsxs("div",{children:[v.jsx("h3",{className:"font-semibold text-gray-800 text-lg",children:"Estado del Inventario"}),v.jsx("p",{className:"text-sm text-gray-600 mt-1",children:"Stock actual por artculo"})]}),v.jsxs("div",{className:"flex gap-2",children:[v.jsxs("button",{onClick:f,className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 flex items-center gap-2 font-medium",children:[v.jsx(ch,{className:"h-5 w-5"})," Imprimir"]}),v.jsxs("button",{onClick:d,className:"px-4 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700 flex items-center gap-2 font-medium",children:[v.jsx(ss,{className:"h-5 w-5"})," PDF"]}),v.jsxs("button",{onClick:h,className:"px-4 py-2 bg-gray-700 text-white rounded-lg hover:bg-gray-800 flex items-center gap-2 font-medium",children:[v.jsx(ss,{className:"h-5 w-5"})," CSV"]})]})]})}),v.jsx("div",{className:"overflow-x-auto",children:v.jsxs("table",{className:"w-full",children:[v.jsx("thead",{className:"bg-gray-50",children:v.jsxs("tr",{children:[v.jsx("th",{className:"px-6 py-4 text-left text-sm font-semibold text-gray-900",children:"Artculo"}),v.jsx("th",{className:"px-6 py-4 text-left text-sm font-semibold text-gray-900",children:"Stock"}),v.jsx("th",{className:"px-6 py-4 text-left text-sm font-semibold text-gray-900",children:"Costo Unitario"}),v.jsx("th",{className:"px-6 py-4 text-left text-sm font-semibold text-gray-900",children:"Valor Total"}),v.jsx("th",{className:"px-6 py-4 text-left text-sm font-semibold text-gray-900",children:"Estado"})]})}),v.jsxs("tbody",{className:"divide-y divide-gray-200",children:[s.map(({article:m,stock:_,totalValue:y,status:b})=>{const w=b==="Sin Stock"?"bg-red-100 text-red-800":b==="Stock Bajo"?"bg-yellow-100 text-yellow-800":"bg-green-100 text-green-800";return v.jsxs("tr",{className:"hover:bg-gray-50 transition-colors",children:[v.jsx("td",{className:"px-6 py-4 text-sm font-medium text-gray-900",children:m.nombre}),v.jsxs("td",{className:"px-6 py-4 text-sm text-gray-900",children:[_," unidades"]}),v.jsx("td",{className:"px-6 py-4 text-sm text-gray-900",children:ft(m.costo)}),v.jsx("td",{className:"px-6 py-4 text-sm font-medium text-gray-900",children:ft(y)}),v.jsx("td",{className:"px-6 py-4",children:v.jsx("span",{className:`inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium ${w}`,children:b})})]},m.id)}),s.length===0&&v.jsx("tr",{children:v.jsx("td",{colSpan:6,className:"px-6 py-8 text-center text-gray-500",children:"No se encontraron artculos que coincidan con los filtros aplicados"})})]})]})})]})]})};var lv={exports:{}},nc={},qE={exports:{}},SB="SECRET_DO_NOT_PASS_THIS_OR_YOU_WILL_BE_FIRED",kB=SB,EB=kB;function GE(){}function KE(){}KE.resetWarningCache=GE;var AB=function(){function e(n,a,i,s,o,l){if(l!==EB){var c=new Error("Calling PropTypes validators directly is not supported by the `prop-types` package. Use PropTypes.checkPropTypes() to call them. Read more at http://fb.me/use-check-prop-types");throw c.name="Invariant Violation",c}}e.isRequired=e;function t(){return e}var r={array:e,bigint:e,bool:e,func:e,number:e,object:e,string:e,symbol:e,any:e,arrayOf:t,element:e,elementType:e,instanceOf:t,node:e,objectOf:t,oneOf:t,oneOfType:t,shape:t,exact:t,checkPropTypes:KE,resetWarningCache:GE};return r.PropTypes=r,r};qE.exports=AB();var XE=qE.exports,cv={exports:{}},zi={},uv={exports:{}};(function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.default=u;/*!
 * Adapted from jQuery UI core
 *
 * http://jqueryui.com
 *
 * Copyright 2014 jQuery Foundation and other contributors
 * Released under the MIT license.
 * http://jquery.org/license
 *
 * http://api.jqueryui.com/category/ui-core/
 */var r="none",n="contents",a=/^(input|select|textarea|button|object|iframe)$/;function i(f,d){return d.getPropertyValue("overflow")!=="visible"||f.scrollWidth<=0&&f.scrollHeight<=0}function s(f){var d=f.offsetWidth<=0&&f.offsetHeight<=0;if(d&&!f.innerHTML)return!0;try{var h=window.getComputedStyle(f),g=h.getPropertyValue("display");return d?g!==n&&i(f,h):g===r}catch{return console.warn("Failed to inspect element style"),!1}}function o(f){for(var d=f,h=f.getRootNode&&f.getRootNode();d&&d!==document.body;){if(h&&d===h&&(d=h.host.parentNode),s(d))return!1;d=d.parentNode}return!0}function l(f,d){var h=f.nodeName.toLowerCase(),g=a.test(h)&&!f.disabled||h==="a"&&f.href||d;return g&&o(f)}function c(f){var d=f.getAttribute("tabindex");d===null&&(d=void 0);var h=isNaN(d);return(h||d>=0)&&l(f,!h)}function u(f){var d=[].slice.call(f.querySelectorAll("*"),0).reduce(function(h,g){return h.concat(g.shadowRoot?u(g.shadowRoot):[g])},[]);return d.filter(c)}e.exports=t.default})(uv,uv.exports);var YE=uv.exports;Object.defineProperty(zi,"__esModule",{value:!0});zi.resetState=PB;zi.log=LB;zi.handleBlur=hh;zi.handleFocus=dh;zi.markForFocusLater=FB;zi.returnFocus=OB;zi.popWithoutFocus=IB;zi.setupScopedFocus=DB;zi.teardownScopedFocus=jB;var TB=YE,CB=NB(TB);function NB(e){return e&&e.__esModule?e:{default:e}}var Ku=[],yu=null,fv=!1;function PB(){Ku=[]}function LB(){}function hh(){fv=!0}function dh(){if(fv){if(fv=!1,!yu)return;setTimeout(function(){if(!yu.contains(document.activeElement)){var e=(0,CB.default)(yu)[0]||yu;e.focus()}},0)}}function FB(){Ku.push(document.activeElement)}function OB(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,t=null;try{Ku.length!==0&&(t=Ku.pop(),t.focus({preventScroll:e}));return}catch{console.warn(["You tried to return focus to",t,"but it is not in the DOM anymore"].join(" "))}}function IB(){Ku.length>0&&Ku.pop()}function DB(e){yu=e,window.addEventListener?(window.addEventListener("blur",hh,!1),document.addEventListener("focus",dh,!0)):(window.attachEvent("onBlur",hh),document.attachEvent("onFocus",dh))}function jB(){yu=null,window.addEventListener?(window.removeEventListener("blur",hh),document.removeEventListener("focus",dh)):(window.detachEvent("onBlur",hh),document.detachEvent("onFocus",dh))}var hv={exports:{}};(function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.default=s;var r=YE,n=a(r);function a(o){return o&&o.__esModule?o:{default:o}}function i(){var o=arguments.length>0&&arguments[0]!==void 0?arguments[0]:document;return o.activeElement.shadowRoot?i(o.activeElement.shadowRoot):o.activeElement}function s(o,l){var c=(0,n.default)(o);if(!c.length){l.preventDefault();return}var u=void 0,f=l.shiftKey,d=c[0],h=c[c.length-1],g=i();if(o===g){if(!f)return;u=h}if(h===g&&!f&&(u=d),d===g&&f&&(u=h),u){l.preventDefault(),u.focus();return}var m=/(\bChrome\b|\bSafari\b)\//.exec(navigator.userAgent),_=m!=null&&m[1]!="Chrome"&&/\biPod\b|\biPad\b/g.exec(navigator.userAgent)==null;if(_){var y=c.indexOf(g);if(y>-1&&(y+=f?-1:1),u=c[y],typeof u>"u"){l.preventDefault(),u=f?h:d,u.focus();return}l.preventDefault(),u.focus()}}e.exports=t.default})(hv,hv.exports);var RB=hv.exports,Hi={},MB=function(){},BB=MB,Ui={},JE={exports:{}};/*!
  Copyright (c) 2015 Jed Watson.
  Based on code that is Copyright 2013-2015, Facebook, Inc.
  All rights reserved.
*/(function(e){(function(){var t=!!(typeof window<"u"&&window.document&&window.document.createElement),r={canUseDOM:t,canUseWorkers:typeof Worker<"u",canUseEventListeners:t&&!!(window.addEventListener||window.attachEvent),canUseViewport:t&&!!window.screen};e.exports?e.exports=r:window.ExecutionEnvironment=r})()})(JE);var UB=JE.exports;Object.defineProperty(Ui,"__esModule",{value:!0});Ui.canUseDOM=Ui.SafeNodeList=Ui.SafeHTMLCollection=void 0;var $B=UB,VB=zB($B);function zB(e){return e&&e.__esModule?e:{default:e}}var Om=VB.default,HB=Om.canUseDOM?window.HTMLElement:{};Ui.SafeHTMLCollection=Om.canUseDOM?window.HTMLCollection:{};Ui.SafeNodeList=Om.canUseDOM?window.NodeList:{};Ui.canUseDOM=Om.canUseDOM;Ui.default=HB;Object.defineProperty(Hi,"__esModule",{value:!0});Hi.resetState=XB;Hi.log=YB;Hi.assertNodeList=QE;Hi.setElement=JB;Hi.validateElement=x5;Hi.hide=QB;Hi.show=ZB;Hi.documentNotReadyOrSSRTesting=eU;var WB=BB,qB=KB(WB),GB=Ui;function KB(e){return e&&e.__esModule?e:{default:e}}var ni=null;function XB(){ni&&(ni.removeAttribute?ni.removeAttribute("aria-hidden"):ni.length!=null?ni.forEach(function(e){return e.removeAttribute("aria-hidden")}):document.querySelectorAll(ni).forEach(function(e){return e.removeAttribute("aria-hidden")})),ni=null}function YB(){}function QE(e,t){if(!e||!e.length)throw new Error("react-modal: No elements were found for selector "+t+".")}function JB(e){var t=e;if(typeof t=="string"&&GB.canUseDOM){var r=document.querySelectorAll(t);QE(r,t),t=r}return ni=t||ni,ni}function x5(e){var t=e||ni;return t?Array.isArray(t)||t instanceof HTMLCollection||t instanceof NodeList?t:[t]:((0,qB.default)(!1,["react-modal: App element is not defined.","Please use `Modal.setAppElement(el)` or set `appElement={el}`.","This is needed so screen readers don't see main content","when modal is opened. It is not recommended, but you can opt-out","by setting `ariaHideApp={false}`."].join(" ")),[])}function QB(e){var t=!0,r=!1,n=void 0;try{for(var a=x5(e)[Symbol.iterator](),i;!(t=(i=a.next()).done);t=!0){var s=i.value;s.setAttribute("aria-hidden","true")}}catch(o){r=!0,n=o}finally{try{!t&&a.return&&a.return()}finally{if(r)throw n}}}function ZB(e){var t=!0,r=!1,n=void 0;try{for(var a=x5(e)[Symbol.iterator](),i;!(t=(i=a.next()).done);t=!0){var s=i.value;s.removeAttribute("aria-hidden")}}catch(o){r=!0,n=o}finally{try{!t&&a.return&&a.return()}finally{if(r)throw n}}}function eU(){ni=null}var a0={};Object.defineProperty(a0,"__esModule",{value:!0});a0.resetState=tU;a0.log=rU;var Tf={},Cf={};function m3(e,t){e.classList.remove(t)}function tU(){var e=document.getElementsByTagName("html")[0];for(var t in Tf)m3(e,Tf[t]);var r=document.body;for(var n in Cf)m3(r,Cf[n]);Tf={},Cf={}}function rU(){}var nU=function(t,r){return t[r]||(t[r]=0),t[r]+=1,r},aU=function(t,r){return t[r]&&(t[r]-=1),r},iU=function(t,r,n){n.forEach(function(a){nU(r,a),t.add(a)})},sU=function(t,r,n){n.forEach(function(a){aU(r,a),r[a]===0&&t.remove(a)})};a0.add=function(t,r){return iU(t.classList,t.nodeName.toLowerCase()=="html"?Tf:Cf,r.split(" "))};a0.remove=function(t,r){return sU(t.classList,t.nodeName.toLowerCase()=="html"?Tf:Cf,r.split(" "))};var i0={};Object.defineProperty(i0,"__esModule",{value:!0});i0.log=lU;i0.resetState=cU;function oU(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var ZE=function e(){var t=this;oU(this,e),this.register=function(r){t.openInstances.indexOf(r)===-1&&(t.openInstances.push(r),t.emit("register"))},this.deregister=function(r){var n=t.openInstances.indexOf(r);n!==-1&&(t.openInstances.splice(n,1),t.emit("deregister"))},this.subscribe=function(r){t.subscribers.push(r)},this.emit=function(r){t.subscribers.forEach(function(n){return n(r,t.openInstances.slice())})},this.openInstances=[],this.subscribers=[]},N1=new ZE;function lU(){console.log("portalOpenInstances ----------"),console.log(N1.openInstances.length),N1.openInstances.forEach(function(e){return console.log(e)}),console.log("end portalOpenInstances ----------")}function cU(){N1=new ZE}i0.default=N1;var v5={};Object.defineProperty(v5,"__esModule",{value:!0});v5.resetState=dU;v5.log=pU;var uU=i0,fU=hU(uU);function hU(e){return e&&e.__esModule?e:{default:e}}var Rn=void 0,Ci=void 0,Kl=[];function dU(){for(var e=[Rn,Ci],t=0;t<e.length;t++){var r=e[t];r&&r.parentNode&&r.parentNode.removeChild(r)}Rn=Ci=null,Kl=[]}function pU(){console.log("bodyTrap ----------"),console.log(Kl.length);for(var e=[Rn,Ci],t=0;t<e.length;t++){var r=e[t],n=r||{};console.log(n.nodeName,n.className,n.id)}console.log("edn bodyTrap ----------")}function g3(){Kl.length!==0&&Kl[Kl.length-1].focusContent()}function mU(e,t){!Rn&&!Ci&&(Rn=document.createElement("div"),Rn.setAttribute("data-react-modal-body-trap",""),Rn.style.position="absolute",Rn.style.opacity="0",Rn.setAttribute("tabindex","0"),Rn.addEventListener("focus",g3),Ci=Rn.cloneNode(),Ci.addEventListener("focus",g3)),Kl=t,Kl.length>0?(document.body.firstChild!==Rn&&document.body.insertBefore(Rn,document.body.firstChild),document.body.lastChild!==Ci&&document.body.appendChild(Ci)):(Rn.parentElement&&Rn.parentElement.removeChild(Rn),Ci.parentElement&&Ci.parentElement.removeChild(Ci))}fU.default.subscribe(mU);(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var r=Object.assign||function(W){for(var le=1;le<arguments.length;le++){var de=arguments[le];for(var X in de)Object.prototype.hasOwnProperty.call(de,X)&&(W[X]=de[X])}return W},n=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(W){return typeof W}:function(W){return W&&typeof Symbol=="function"&&W.constructor===Symbol&&W!==Symbol.prototype?"symbol":typeof W},a=function(){function W(le,de){for(var X=0;X<de.length;X++){var ee=de[X];ee.enumerable=ee.enumerable||!1,ee.configurable=!0,"value"in ee&&(ee.writable=!0),Object.defineProperty(le,ee.key,ee)}}return function(le,de,X){return de&&W(le.prototype,de),X&&W(le,X),le}}(),i=ie,s=XE,o=F(s),l=zi,c=T(l),u=RB,f=F(u),d=Hi,h=T(d),g=a0,m=T(g),_=Ui,y=F(_),b=i0,w=F(b);function T(W){if(W&&W.__esModule)return W;var le={};if(W!=null)for(var de in W)Object.prototype.hasOwnProperty.call(W,de)&&(le[de]=W[de]);return le.default=W,le}function F(W){return W&&W.__esModule?W:{default:W}}function I(W,le){if(!(W instanceof le))throw new TypeError("Cannot call a class as a function")}function A(W,le){if(!W)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return le&&(typeof le=="object"||typeof le=="function")?le:W}function P(W,le){if(typeof le!="function"&&le!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof le);W.prototype=Object.create(le&&le.prototype,{constructor:{value:W,enumerable:!1,writable:!0,configurable:!0}}),le&&(Object.setPrototypeOf?Object.setPrototypeOf(W,le):W.__proto__=le)}var j={overlay:"ReactModal__Overlay",content:"ReactModal__Content"},J=function(le){return le.code==="Tab"||le.keyCode===9},N=function(le){return le.code==="Escape"||le.keyCode===27},L=0,G=function(W){P(le,W);function le(de){I(this,le);var X=A(this,(le.__proto__||Object.getPrototypeOf(le)).call(this,de));return X.setOverlayRef=function(ee){X.overlay=ee,X.props.overlayRef&&X.props.overlayRef(ee)},X.setContentRef=function(ee){X.content=ee,X.props.contentRef&&X.props.contentRef(ee)},X.afterClose=function(){var ee=X.props,R=ee.appElement,pe=ee.ariaHideApp,me=ee.htmlOpenClassName,E=ee.bodyOpenClassName,D=ee.parentSelector,O=D&&D().ownerDocument||document;E&&m.remove(O.body,E),me&&m.remove(O.getElementsByTagName("html")[0],me),pe&&L>0&&(L-=1,L===0&&h.show(R)),X.props.shouldFocusAfterRender&&(X.props.shouldReturnFocusAfterClose?(c.returnFocus(X.props.preventScroll),c.teardownScopedFocus()):c.popWithoutFocus()),X.props.onAfterClose&&X.props.onAfterClose(),w.default.deregister(X)},X.open=function(){X.beforeOpen(),X.state.afterOpen&&X.state.beforeClose?(clearTimeout(X.closeTimer),X.setState({beforeClose:!1})):(X.props.shouldFocusAfterRender&&(c.setupScopedFocus(X.node),c.markForFocusLater()),X.setState({isOpen:!0},function(){X.openAnimationFrame=requestAnimationFrame(function(){X.setState({afterOpen:!0}),X.props.isOpen&&X.props.onAfterOpen&&X.props.onAfterOpen({overlayEl:X.overlay,contentEl:X.content})})}))},X.close=function(){X.props.closeTimeoutMS>0?X.closeWithTimeout():X.closeWithoutTimeout()},X.focusContent=function(){return X.content&&!X.contentHasFocus()&&X.content.focus({preventScroll:!0})},X.closeWithTimeout=function(){var ee=Date.now()+X.props.closeTimeoutMS;X.setState({beforeClose:!0,closesAt:ee},function(){X.closeTimer=setTimeout(X.closeWithoutTimeout,X.state.closesAt-Date.now())})},X.closeWithoutTimeout=function(){X.setState({beforeClose:!1,isOpen:!1,afterOpen:!1,closesAt:null},X.afterClose)},X.handleKeyDown=function(ee){J(ee)&&(0,f.default)(X.content,ee),X.props.shouldCloseOnEsc&&N(ee)&&(ee.stopPropagation(),X.requestClose(ee))},X.handleOverlayOnClick=function(ee){X.shouldClose===null&&(X.shouldClose=!0),X.shouldClose&&X.props.shouldCloseOnOverlayClick&&(X.ownerHandlesClose()?X.requestClose(ee):X.focusContent()),X.shouldClose=null},X.handleContentOnMouseUp=function(){X.shouldClose=!1},X.handleOverlayOnMouseDown=function(ee){!X.props.shouldCloseOnOverlayClick&&ee.target==X.overlay&&ee.preventDefault()},X.handleContentOnClick=function(){X.shouldClose=!1},X.handleContentOnMouseDown=function(){X.shouldClose=!1},X.requestClose=function(ee){return X.ownerHandlesClose()&&X.props.onRequestClose(ee)},X.ownerHandlesClose=function(){return X.props.onRequestClose},X.shouldBeClosed=function(){return!X.state.isOpen&&!X.state.beforeClose},X.contentHasFocus=function(){return document.activeElement===X.content||X.content.contains(document.activeElement)},X.buildClassName=function(ee,R){var pe=(typeof R>"u"?"undefined":n(R))==="object"?R:{base:j[ee],afterOpen:j[ee]+"--after-open",beforeClose:j[ee]+"--before-close"},me=pe.base;return X.state.afterOpen&&(me=me+" "+pe.afterOpen),X.state.beforeClose&&(me=me+" "+pe.beforeClose),typeof R=="string"&&R?me+" "+R:me},X.attributesFromObject=function(ee,R){return Object.keys(R).reduce(function(pe,me){return pe[ee+"-"+me]=R[me],pe},{})},X.state={afterOpen:!1,beforeClose:!1},X.shouldClose=null,X.moveFromContentToOverlay=null,X}return a(le,[{key:"componentDidMount",value:function(){this.props.isOpen&&this.open()}},{key:"componentDidUpdate",value:function(X,ee){this.props.isOpen&&!X.isOpen?this.open():!this.props.isOpen&&X.isOpen&&this.close(),this.props.shouldFocusAfterRender&&this.state.isOpen&&!ee.isOpen&&this.focusContent()}},{key:"componentWillUnmount",value:function(){this.state.isOpen&&this.afterClose(),clearTimeout(this.closeTimer),cancelAnimationFrame(this.openAnimationFrame)}},{key:"beforeOpen",value:function(){var X=this.props,ee=X.appElement,R=X.ariaHideApp,pe=X.htmlOpenClassName,me=X.bodyOpenClassName,E=X.parentSelector,D=E&&E().ownerDocument||document;me&&m.add(D.body,me),pe&&m.add(D.getElementsByTagName("html")[0],pe),R&&(L+=1,h.hide(ee)),w.default.register(this)}},{key:"render",value:function(){var X=this.props,ee=X.id,R=X.className,pe=X.overlayClassName,me=X.defaultStyles,E=X.children,D=R?{}:me.content,O=pe?{}:me.overlay;if(this.shouldBeClosed())return null;var M={ref:this.setOverlayRef,className:this.buildClassName("overlay",pe),style:r({},O,this.props.style.overlay),onClick:this.handleOverlayOnClick,onMouseDown:this.handleOverlayOnMouseDown},K=r({id:ee,ref:this.setContentRef,style:r({},D,this.props.style.content),className:this.buildClassName("content",R),tabIndex:"-1",onKeyDown:this.handleKeyDown,onMouseDown:this.handleContentOnMouseDown,onMouseUp:this.handleContentOnMouseUp,onClick:this.handleContentOnClick,role:this.props.role,"aria-label":this.props.contentLabel},this.attributesFromObject("aria",r({modal:!0},this.props.aria)),this.attributesFromObject("data",this.props.data||{}),{"data-testid":this.props.testId}),Y=this.props.contentElement(K,E);return this.props.overlayElement(M,Y)}}]),le}(i.Component);G.defaultProps={style:{overlay:{},content:{}},defaultStyles:{}},G.propTypes={isOpen:o.default.bool.isRequired,defaultStyles:o.default.shape({content:o.default.object,overlay:o.default.object}),style:o.default.shape({content:o.default.object,overlay:o.default.object}),className:o.default.oneOfType([o.default.string,o.default.object]),overlayClassName:o.default.oneOfType([o.default.string,o.default.object]),parentSelector:o.default.func,bodyOpenClassName:o.default.string,htmlOpenClassName:o.default.string,ariaHideApp:o.default.bool,appElement:o.default.oneOfType([o.default.instanceOf(y.default),o.default.instanceOf(_.SafeHTMLCollection),o.default.instanceOf(_.SafeNodeList),o.default.arrayOf(o.default.instanceOf(y.default))]),onAfterOpen:o.default.func,onAfterClose:o.default.func,onRequestClose:o.default.func,closeTimeoutMS:o.default.number,shouldFocusAfterRender:o.default.bool,shouldCloseOnOverlayClick:o.default.bool,shouldReturnFocusAfterClose:o.default.bool,preventScroll:o.default.bool,role:o.default.string,contentLabel:o.default.string,aria:o.default.object,data:o.default.object,children:o.default.node,shouldCloseOnEsc:o.default.bool,overlayRef:o.default.func,contentRef:o.default.func,id:o.default.string,overlayElement:o.default.func,contentElement:o.default.func,testId:o.default.string},t.default=G,e.exports=t.default})(cv,cv.exports);var gU=cv.exports;function eA(){var e=this.constructor.getDerivedStateFromProps(this.props,this.state);e!=null&&this.setState(e)}function tA(e){function t(r){var n=this.constructor.getDerivedStateFromProps(e,r);return n??null}this.setState(t.bind(this))}function rA(e,t){try{var r=this.props,n=this.state;this.props=e,this.state=t,this.__reactInternalSnapshotFlag=!0,this.__reactInternalSnapshot=this.getSnapshotBeforeUpdate(r,n)}finally{this.props=r,this.state=n}}eA.__suppressDeprecationWarning=!0;tA.__suppressDeprecationWarning=!0;rA.__suppressDeprecationWarning=!0;function xU(e){var t=e.prototype;if(!t||!t.isReactComponent)throw new Error("Can only polyfill class components");if(typeof e.getDerivedStateFromProps!="function"&&typeof t.getSnapshotBeforeUpdate!="function")return e;var r=null,n=null,a=null;if(typeof t.componentWillMount=="function"?r="componentWillMount":typeof t.UNSAFE_componentWillMount=="function"&&(r="UNSAFE_componentWillMount"),typeof t.componentWillReceiveProps=="function"?n="componentWillReceiveProps":typeof t.UNSAFE_componentWillReceiveProps=="function"&&(n="UNSAFE_componentWillReceiveProps"),typeof t.componentWillUpdate=="function"?a="componentWillUpdate":typeof t.UNSAFE_componentWillUpdate=="function"&&(a="UNSAFE_componentWillUpdate"),r!==null||n!==null||a!==null){var i=e.displayName||e.name,s=typeof e.getDerivedStateFromProps=="function"?"getDerivedStateFromProps()":"getSnapshotBeforeUpdate()";throw Error(`Unsafe legacy lifecycles will not be called for components using new component APIs.

`+i+" uses "+s+" but also contains the following legacy lifecycles:"+(r!==null?`
  `+r:"")+(n!==null?`
  `+n:"")+(a!==null?`
  `+a:"")+`

The above lifecycles should be removed. Learn more about this warning here:
https://fb.me/react-async-component-lifecycle-hooks`)}if(typeof e.getDerivedStateFromProps=="function"&&(t.componentWillMount=eA,t.componentWillReceiveProps=tA),typeof t.getSnapshotBeforeUpdate=="function"){if(typeof t.componentDidUpdate!="function")throw new Error("Cannot polyfill getSnapshotBeforeUpdate() for components that do not define componentDidUpdate() on the prototype");t.componentWillUpdate=rA;var o=t.componentDidUpdate;t.componentDidUpdate=function(c,u,f){var d=this.__reactInternalSnapshotFlag?this.__reactInternalSnapshot:f;o.call(this,c,u,d)}}return e}const vU=Object.freeze(Object.defineProperty({__proto__:null,polyfill:xU},Symbol.toStringTag,{value:"Module"})),yU=t6(vU);Object.defineProperty(nc,"__esModule",{value:!0});nc.bodyOpenClassName=nc.portalClassName=void 0;var x3=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},wU=function(){function e(t,r){for(var n=0;n<r.length;n++){var a=r[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(t,a.key,a)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),nA=ie,P1=Bh(nA),bU=pk,L1=Bh(bU),_U=XE,Tt=Bh(_U),SU=gU,v3=Bh(SU),kU=Hi,EU=TU(kU),Bo=Ui,y3=Bh(Bo),AU=yU;function TU(e){if(e&&e.__esModule)return e;var t={};if(e!=null)for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t.default=e,t}function Bh(e){return e&&e.__esModule?e:{default:e}}function CU(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function w3(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t&&(typeof t=="object"||typeof t=="function")?t:e}function NU(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var PU=nc.portalClassName="ReactModalPortal",LU=nc.bodyOpenClassName="ReactModal__Body--open",Ol=Bo.canUseDOM&&L1.default.createPortal!==void 0,b3=function(t){return document.createElement(t)},_3=function(){return Ol?L1.default.createPortal:L1.default.unstable_renderSubtreeIntoContainer};function cp(e){return e()}var Uh=function(e){NU(t,e);function t(){var r,n,a,i;CU(this,t);for(var s=arguments.length,o=Array(s),l=0;l<s;l++)o[l]=arguments[l];return i=(n=(a=w3(this,(r=t.__proto__||Object.getPrototypeOf(t)).call.apply(r,[this].concat(o))),a),a.removePortal=function(){!Ol&&L1.default.unmountComponentAtNode(a.node);var c=cp(a.props.parentSelector);c&&c.contains(a.node)?c.removeChild(a.node):console.warn('React-Modal: "parentSelector" prop did not returned any DOM element. Make sure that the parent element is unmounted to avoid any memory leaks.')},a.portalRef=function(c){a.portal=c},a.renderPortal=function(c){var u=_3(),f=u(a,P1.default.createElement(v3.default,x3({defaultStyles:t.defaultStyles},c)),a.node);a.portalRef(f)},n),w3(a,i)}return wU(t,[{key:"componentDidMount",value:function(){if(Bo.canUseDOM){Ol||(this.node=b3("div")),this.node.className=this.props.portalClassName;var n=cp(this.props.parentSelector);n.appendChild(this.node),!Ol&&this.renderPortal(this.props)}}},{key:"getSnapshotBeforeUpdate",value:function(n){var a=cp(n.parentSelector),i=cp(this.props.parentSelector);return{prevParent:a,nextParent:i}}},{key:"componentDidUpdate",value:function(n,a,i){if(Bo.canUseDOM){var s=this.props,o=s.isOpen,l=s.portalClassName;n.portalClassName!==l&&(this.node.className=l);var c=i.prevParent,u=i.nextParent;u!==c&&(c.removeChild(this.node),u.appendChild(this.node)),!(!n.isOpen&&!o)&&!Ol&&this.renderPortal(this.props)}}},{key:"componentWillUnmount",value:function(){if(!(!Bo.canUseDOM||!this.node||!this.portal)){var n=this.portal.state,a=Date.now(),i=n.isOpen&&this.props.closeTimeoutMS&&(n.closesAt||a+this.props.closeTimeoutMS);i?(n.beforeClose||this.portal.closeWithTimeout(),setTimeout(this.removePortal,i-a)):this.removePortal()}}},{key:"render",value:function(){if(!Bo.canUseDOM||!Ol)return null;!this.node&&Ol&&(this.node=b3("div"));var n=_3();return n(P1.default.createElement(v3.default,x3({ref:this.portalRef,defaultStyles:t.defaultStyles},this.props)),this.node)}}],[{key:"setAppElement",value:function(n){EU.setElement(n)}}]),t}(nA.Component);Uh.propTypes={isOpen:Tt.default.bool.isRequired,style:Tt.default.shape({content:Tt.default.object,overlay:Tt.default.object}),portalClassName:Tt.default.string,bodyOpenClassName:Tt.default.string,htmlOpenClassName:Tt.default.string,className:Tt.default.oneOfType([Tt.default.string,Tt.default.shape({base:Tt.default.string.isRequired,afterOpen:Tt.default.string.isRequired,beforeClose:Tt.default.string.isRequired})]),overlayClassName:Tt.default.oneOfType([Tt.default.string,Tt.default.shape({base:Tt.default.string.isRequired,afterOpen:Tt.default.string.isRequired,beforeClose:Tt.default.string.isRequired})]),appElement:Tt.default.oneOfType([Tt.default.instanceOf(y3.default),Tt.default.instanceOf(Bo.SafeHTMLCollection),Tt.default.instanceOf(Bo.SafeNodeList),Tt.default.arrayOf(Tt.default.instanceOf(y3.default))]),onAfterOpen:Tt.default.func,onRequestClose:Tt.default.func,closeTimeoutMS:Tt.default.number,ariaHideApp:Tt.default.bool,shouldFocusAfterRender:Tt.default.bool,shouldCloseOnOverlayClick:Tt.default.bool,shouldReturnFocusAfterClose:Tt.default.bool,preventScroll:Tt.default.bool,parentSelector:Tt.default.func,aria:Tt.default.object,data:Tt.default.object,role:Tt.default.string,contentLabel:Tt.default.string,shouldCloseOnEsc:Tt.default.bool,overlayRef:Tt.default.func,contentRef:Tt.default.func,id:Tt.default.string,overlayElement:Tt.default.func,contentElement:Tt.default.func};Uh.defaultProps={isOpen:!1,portalClassName:PU,bodyOpenClassName:LU,role:"dialog",ariaHideApp:!0,closeTimeoutMS:0,shouldFocusAfterRender:!0,shouldCloseOnEsc:!0,shouldCloseOnOverlayClick:!0,shouldReturnFocusAfterClose:!0,preventScroll:!1,parentSelector:function(){return document.body},overlayElement:function(t,r){return P1.default.createElement("div",t,r)},contentElement:function(t,r){return P1.default.createElement("div",t,r)}};Uh.defaultStyles={overlay:{position:"fixed",top:0,left:0,right:0,bottom:0,backgroundColor:"rgba(255, 255, 255, 0.75)"},content:{position:"absolute",top:"40px",left:"40px",right:"40px",bottom:"40px",border:"1px solid #ccc",background:"#fff",overflow:"auto",WebkitOverflowScrolling:"touch",borderRadius:"4px",outline:"none",padding:"20px"}};(0,AU.polyfill)(Uh);nc.default=Uh;(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var r=nc,n=a(r);function a(i){return i&&i.__esModule?i:{default:i}}t.default=n.default,e.exports=t.default})(lv,lv.exports);var FU=lv.exports;const Xu=e6(FU),OU=()=>{var ee;const{articles:e,movements:t,updateMovement:r,deleteMovement:n,refreshData:a}=ps(),[i,s]=ie.useState(""),[o,l]=ie.useState(""),[c,u]=ie.useState(""),[f,d]=ie.useState([]),[h,g]=ie.useState({description:""}),[m,_]=ie.useState(!1),[y,b]=ie.useState(null),[w,T]=ie.useState(!1),[F,I]=ie.useState(!1),[A,P]=ie.useState(null);ie.useEffect(()=>{j()},[i,o,c,e,t]);const j=()=>{let R=t,pe=null;i&&(pe=e.find(Y=>Y.id===parseInt(i)),R=R.filter(Y=>Y.id_articulo===parseInt(i)));let me={},E={};(o||c)&&e.forEach(Y=>{const re=t.filter(Ce=>{if(Ce.id_articulo!==Y.id)return!1;const[Z,Ie]=Ce.fecha.split("-"),He=c&&Z<c,Te=c&&Z===c&&o&&Ie<o.padStart(2,"0");return He||Te});let se=0,xe=Y.costo;re.forEach(Ce=>{Ce.tipo==="Entrada"?(se+=Ce.cantidad,Ce.costo>0&&(xe=Ce.costo)):se-=Ce.cantidad}),me[Y.id]=se,E[Y.id]=xe}),(o||c)&&(R=R.filter(Y=>{const[re,se]=Y.fecha.split("-");return(!o||se===o.padStart(2,"0"))&&(!c||re===c)})),R.sort((Y,re)=>{const se=Y.fecha,xe=re.fecha;return se!==xe?se.localeCompare(xe):Y.tipo===re.tipo?0:Y.tipo==="Entrada"?-1:1});let D={...me},O={...E};const M=R.map(Y=>{let re=pe;return re||(re=e.find(se=>se.id===Y.id_articulo)),re?(D[re.id]===void 0&&(D[re.id]=0),O[re.id]===void 0&&(O[re.id]=re.costo),Y.tipo==="Entrada"?(D[re.id]+=Y.cantidad,Y.costo>0&&(O[re.id]=Y.costo)):D[re.id]-=Y.cantidad,{...Y,article:re,balance:D[re.id],costoUnit:O[re.id],totalValue:Y.cantidad*(Y.costo>0?Y.costo:O[re.id]),balanceValue:D[re.id]*O[re.id]}):null}).filter(Boolean);let K=null;if((o||c)&&i){const Y=e.find(re=>re.id===parseInt(i));Y&&(K={fecha:"",descripcion:"Saldo Inicial",tipo:"",cantidad:"",costo:"",article:Y,balance:me[Y.id],costoUnit:E[Y.id],totalValue:"",balanceValue:me[Y.id]*E[Y.id]})}d(K?[K,...M]:M)},J=R=>{const pe=window.open("","_blank");pe&&(pe.document.open(),pe.document.write(R),pe.document.close(),setTimeout(()=>{pe.focus(),pe.print(),pe.close()},300))},N=()=>{if(i){const E=X();J(E);return}if(!e||e.length===0){st.error("No hay artculos disponibles para imprimir");return}const R={};f.forEach(E=>{var O;const D=((O=E.article)==null?void 0:O.id)??E.id_articulo;R[D]||(R[D]=[]),R[D].push(E)});const pe=Object.keys(R).map(E=>parseInt(E)).sort((E,D)=>E-D).map(E=>{const D=e.find(Y=>Y.id===E);if(!D)return"";const O=["Fecha","Descripcin","Entrada Cant.","Entrada Costo","Entrada Total","Salida Cant.","Salida Costo","Salida Total","Existencia","Costo Unit.","Total"],M=R[E].map(Y=>{const re=Y.tipo==="Entrada",se=Y.cantidad*(Y.costo>0?Y.costo:Y.costoUnit),xe=Y.balance*Y.costoUnit;return[Y.fecha,Y.descripcion,re?Y.cantidad.toString():"0",ft(re?Y.costo:0),ft(re?se:0),re?"0":Y.cantidad.toString(),ft(re?0:Y.costo),ft(re?0:se),Y.balance.toString(),ft(Y.costoUnit),ft(xe)]}),K=Cu(O,M);return`
          <div style="margin-top:12px; font-size:12px; font-weight:bold;">Artculo: ${D.nombre}</div>
          ${K}
        `}).join(`
`),me=Gl("Tarjeta de Control - Todos los artculos",pe,{articleId:"",dateFrom:o&&c?`${c}-${o}-01`:"",dateTo:o&&c?`${c}-${o}-31`:"",...h});J(me)},L=()=>{if(i){const D=e.find(se=>se.id===parseInt(i));if(!D)return;const O=["Fecha","Descripcin","Entrada Cant.","Entrada Costo","Entrada Total","Salida Cant.","Salida Costo","Salida Total","Existencia","Costo Unit.","Total"],M=f.map(se=>{const xe=se.tipo==="Entrada",Ce=se.cantidad*(se.costo>0?se.costo:se.costoUnit),Z=se.balance*se.costoUnit;return[se.fecha,se.descripcion,xe?se.cantidad.toString():"0",ft(xe?se.costo:0),ft(xe?Ce:0),xe?"0":se.cantidad.toString(),ft(xe?0:se.costo),ft(xe?0:Ce),se.balance.toString(),ft(se.costoUnit),ft(Z)]}),K=Cu(O,M),Y=Gl(`Tarjeta de Control - ${D.nombre}`,K,{articleId:i,dateFrom:o&&c?`${c}-${o}-01`:"",dateTo:o&&c?`${c}-${o}-31`:"",...h}),re=`tarjeta_control_${D.nombre.replace(/\s+/g,"_").toLowerCase()}_${new Date().toISOString().split("T")[0]}.html`;fh(Y,re),st.success("Tarjeta de control exportada a PDF/HTML");return}if(!e||e.length===0){st.error("No hay artculos para exportar");return}const R={};f.forEach(D=>{var M;const O=((M=D.article)==null?void 0:M.id)??D.id_articulo;R[O]||(R[O]=[]),R[O].push(D)});const pe=Object.keys(R).map(D=>parseInt(D)).sort((D,O)=>D-O).map(D=>{const O=e.find(re=>re.id===D);if(!O)return"";const M=["Fecha","Descripcin","Entrada Cant.","Entrada Costo","Entrada Total","Salida Cant.","Salida Costo","Salida Total","Existencia","Costo Unit.","Total"],K=R[D].map(re=>{const se=re.tipo==="Entrada",xe=re.cantidad*(re.costo>0?re.costo:re.costoUnit),Ce=re.balance*re.costoUnit;return[re.fecha,re.descripcion,se?re.cantidad.toString():"0",ft(se?re.costo:0),ft(se?xe:0),se?"0":re.cantidad.toString(),ft(se?0:re.costo),ft(se?0:xe),re.balance.toString(),ft(re.costoUnit),ft(Ce)]}),Y=Cu(M,K);return`
          <div style="margin-top:12px; font-size:12px; font-weight:bold;">Artculo: ${O.nombre}</div>
          ${Y}
        `}).join(`
`),me=Gl("Tarjeta de Control - Todos los artculos",pe,{articleId:"",dateFrom:o&&c?`${c}-${o}-01`:"",dateTo:o&&c?`${c}-${o}-31`:"",...h}),E=`tarjeta_control_todos_${new Date().toISOString().split("T")[0]}.html`;fh(me,E),st.success("Tarjeta de control (todos los artculos) exportada a PDF/HTML")},G=R=>`$${R.toFixed(2)}`,W=()=>{if(i){const K=e.find(Ie=>Ie.id===parseInt(i));if(!K)return;const Y=["Fecha","Descripcin","Entrada Cant.","Entrada Costo","Entrada Total","Salida Cant.","Salida Costo","Salida Total","Existencia","Costo Unit.","Total"],re=f.map(Ie=>{const He=Ie.tipo==="Entrada",Te=Ie.cantidad*(Ie.costo>0?Ie.costo:Ie.costoUnit),oe=Ie.balance*Ie.costoUnit;return[Ie.fecha,Ie.descripcion,He?Ie.cantidad.toString():"0",G(He?Ie.costo:0),G(He?Te:0),He?"0":Ie.cantidad.toString(),G(He?0:Ie.costo),G(He?0:Te),Ie.balance.toString(),G(Ie.costoUnit),G(oe)]}),se=[Y.join(","),...re.map(Ie=>Ie.map(He=>`"${He}"`).join(","))].join(`
`),xe=new Blob([se],{type:"text/csv;charset=utf-8;"}),Ce=document.createElement("a"),Z=URL.createObjectURL(xe);Ce.setAttribute("href",Z),Ce.setAttribute("download",`tarjeta_control_${K.nombre.replace(/\s+/g,"_").toLowerCase()}_${new Date().toISOString().split("T")[0]}.csv`),Ce.style.visibility="hidden",document.body.appendChild(Ce),Ce.click(),document.body.removeChild(Ce),URL.revokeObjectURL(Z),st.success("Tarjeta de control exportada a CSV");return}if(!e||e.length===0){st.error("No hay artculos para exportar");return}const R={};f.forEach(K=>{var re;const Y=((re=K.article)==null?void 0:re.id)??K.id_articulo;R[Y]||(R[Y]=[]),R[Y].push(K)});const pe=["Fecha","Descripcin","Entrada Cant.","Entrada Costo","Entrada Total","Salida Cant.","Salida Costo","Salida Total","Existencia","Costo Unit.","Total"],me=[];Object.keys(R).map(K=>parseInt(K)).sort((K,Y)=>K-Y).forEach(K=>{const Y=e.find(re=>re.id===K);Y&&(me.push(`"Artculo: ${Y.nombre}"`),me.push(pe.join(",")),R[K].forEach(re=>{const se=re.tipo==="Entrada",xe=re.cantidad*(re.costo>0?re.costo:re.costoUnit),Ce=re.balance*re.costoUnit,Z=[re.fecha,re.descripcion,se?re.cantidad.toString():"0",G(se?re.costo:0),G(se?xe:0),se?"0":re.cantidad.toString(),G(se?0:re.costo),G(se?0:xe),re.balance.toString(),G(re.costoUnit),G(Ce)];me.push(Z.map(Ie=>`"${Ie}"`).join(","))}),me.push(""))});const E=me.join(`
`),D=new Blob([E],{type:"text/csv;charset=utf-8;"}),O=document.createElement("a"),M=URL.createObjectURL(D);O.setAttribute("href",M),O.setAttribute("download",`tarjeta_control_todos_${new Date().toISOString().split("T")[0]}.csv`),O.style.visibility="hidden",document.body.appendChild(O),O.click(),document.body.removeChild(O),URL.revokeObjectURL(M),st.success("Tarjeta de control (todos los artculos) exportada a CSV")},le=()=>{N()},de=()=>{L()},X=()=>{const R=e.find(me=>me.id===parseInt(i)),pe=new Date().toLocaleDateString("es-ES");return`
      <!DOCTYPE html>
      <html>
      <head>
        <title>Tarjeta de Control - ${R==null?void 0:R.nombre}</title>
        <style>
          body { font-family: Arial, sans-serif; margin: 20px; }
          table { width: 100%; border-collapse: collapse; margin-top: 20px; }
          th, td { border: 1px solid #000; padding: 8px; text-align: center; font-size: 12px; }
          th { background-color: #f0f0f0; }
          .header { text-align: center; margin-bottom: 20px; }
          .article-info { margin-bottom: 15px; }
        </style>
      </head>
      <body>
        <div class="header">
          <h1>TARJETA DE CONTROL</h1>
          <p>Alcalda Municipal de Cabaas Oeste</p>
          <p>Fecha: ${pe}</p>
        </div>
        <div class="article-info">
          <strong>Artculo:</strong> ${R==null?void 0:R.nombre}<br>
          <strong>Costo Unitario:</strong> ${ft((R==null?void 0:R.costo)||0)}
        </div>
        <table>
          <thead>
            <tr>
              <th rowspan="2">Fecha</th>
              <th rowspan="2">Descripcin</th>
              <th colspan="3">ENTRADA</th>
              <th colspan="3">SALIDA</th>
              <th colspan="3">EXISTENCIA</th>
            </tr>
            <tr>
              <th>Cantidad</th>
              <th>Costo Unit.</th>
              <th>Total</th>
              <th>Cantidad</th>
              <th>Costo Unit.</th>
              <th>Total</th>
              <th>Cantidad</th>
              <th>Costo Unit.</th>
              <th>Total</th>
            </tr>
          </thead>
          <tbody>
            ${f.map(me=>`
              <tr>
                <td>${me.fecha}</td>
                <td>${me.descripcion}</td>
                <td>${me.tipo==="Entrada"?me.cantidad:""}</td>
                <td>${me.tipo==="Entrada"?ft(me.costo):""}</td>
                <td>${me.tipo==="Entrada"?ft(me.totalValue):""}</td>
                <td>${me.tipo==="Salida"?me.cantidad:""}</td>
                <td>${me.tipo==="Salida"?ft(me.costo):""}</td>
                <td>${me.tipo==="Salida"?ft(me.totalValue):""}</td>
                <td>${me.balance}</td>
                <td>${ft((R==null?void 0:R.costo)||0)}</td>
                <td>${ft(me.balanceValue)}</td>
              </tr>
            `).join("")}
          </tbody>
        </table>
      </body>
      </html>
    `};return v.jsxs("div",{className:"space-y-8",children:[o&&!c&&v.jsx("div",{className:"bg-yellow-100 border-l-4 border-yellow-500 p-4 mb-4 text-yellow-800 font-semibold",children:" Por favor, selecciona tambin un ao para filtrar por mes. Filtrar solo por mes puede mostrar datos incongruentes."}),v.jsx(er.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},className:"bg-white rounded-2xl shadow-lg p-8 border border-gray-100",children:v.jsxs("div",{className:"flex items-center justify-between",children:[v.jsxs("div",{children:[v.jsx("h2",{className:"text-3xl font-bold text-gray-900 mb-2",children:"Tarjeta de Control"}),v.jsx("p",{className:"text-gray-600",children:"Historial detallado de movimientos por artculo"})]}),v.jsx(bE,{className:"h-12 w-12 text-blue-600"})]})}),v.jsx(er.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.1},className:"bg-white rounded-xl shadow-lg p-6 border border-gray-100",children:v.jsxs("div",{className:"flex flex-col gap-4",children:[v.jsxs("div",{className:"flex flex-col md:flex-row md:items-end md:justify-between gap-4",children:[v.jsxs("div",{className:"flex flex-col md:flex-row gap-4 flex-1",children:[v.jsxs("div",{className:"flex flex-col flex-1 min-w-[180px]",children:[v.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Artculo"}),v.jsxs("select",{value:i,onChange:R=>s(R.target.value),className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",children:[v.jsx("option",{value:"",children:"Todos los artculos"}),e.map(R=>v.jsx("option",{value:R.id,children:R.nombre},R.id))]})]}),v.jsxs("div",{className:"flex flex-col flex-1 min-w-[150px]",children:[v.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Mes"}),v.jsxs("select",{value:o,onChange:R=>l(R.target.value),className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",children:[v.jsx("option",{value:"",children:"Todos los meses"}),v.jsx("option",{value:"1",children:"Enero"}),v.jsx("option",{value:"2",children:"Febrero"}),v.jsx("option",{value:"3",children:"Marzo"}),v.jsx("option",{value:"4",children:"Abril"}),v.jsx("option",{value:"5",children:"Mayo"}),v.jsx("option",{value:"6",children:"Junio"}),v.jsx("option",{value:"7",children:"Julio"}),v.jsx("option",{value:"8",children:"Agosto"}),v.jsx("option",{value:"9",children:"Septiembre"}),v.jsx("option",{value:"10",children:"Octubre"}),v.jsx("option",{value:"11",children:"Noviembre"}),v.jsx("option",{value:"12",children:"Diciembre"})]})]}),v.jsxs("div",{className:"flex flex-col flex-1 min-w-[150px]",children:[v.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Ao"}),v.jsxs("select",{value:c,onChange:R=>u(R.target.value),className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",children:[v.jsx("option",{value:"",children:"Todos los aos"}),v.jsx("option",{value:"2023",children:"2023"}),v.jsx("option",{value:"2024",children:"2024"}),v.jsx("option",{value:"2025",children:"2025"})]})]}),v.jsxs("div",{className:"flex flex-col flex-1 min-w-[220px]",children:[v.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Descripcin"}),v.jsx("input",{type:"text",value:h.description,onChange:R=>g({...h,description:R.target.value}),className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",placeholder:"Buscar en descripcin..."})]})]}),v.jsx("div",{className:"flex justify-end mt-2 md:mt-0",children:v.jsx("button",{onClick:()=>{s(""),l(""),u(""),g({description:""})},className:"px-4 py-2 bg-gray-100 text-gray-700 rounded-lg hover:bg-gray-200 transition-colors font-medium",children:"Limpiar Filtros"})})]}),v.jsxs("div",{className:"flex flex-row gap-2 justify-end mt-2",children:[v.jsxs("button",{onClick:le,className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors flex items-center gap-2",children:[v.jsx(ch,{className:"h-4 w-4"}),"Imprimir"]}),v.jsxs("button",{onClick:de,className:"px-4 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700 transition-colors flex items-center gap-2",children:[v.jsx(ss,{className:"h-4 w-4"}),"Exportar PDF"]}),v.jsxs("button",{onClick:W,className:"px-4 py-2 bg-gray-600 text-white rounded-lg hover:bg-gray-700 transition-colors flex items-center gap-2",children:[v.jsx(ss,{className:"h-4 w-4"}),"Exportar CSV"]})]})]})}),(i||!i)&&v.jsxs(er.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.2},className:"bg-white rounded-xl shadow-lg overflow-hidden border border-gray-100",children:[v.jsxs("div",{className:"p-6 border-b border-gray-200",children:[v.jsxs("h3",{className:"font-semibold text-gray-800 text-lg",children:["Tarjeta de Control - ",((ee=e.find(R=>R.id===parseInt(i)))==null?void 0:ee.nombre)||"Todos los artculos"]}),v.jsxs("p",{className:"text-sm text-gray-600 mt-1",children:["Mostrando ",f.length," movimientos"]})]}),v.jsx("div",{className:"overflow-x-auto",children:v.jsxs("table",{className:"w-full",children:[v.jsxs("thead",{className:"bg-gray-50",children:[v.jsxs("tr",{children:[v.jsx("th",{rowSpan:2,className:"px-4 py-3 text-center text-sm font-semibold text-gray-900 border-r",children:"Fecha"}),v.jsx("th",{rowSpan:2,className:"px-4 py-3 text-center text-sm font-semibold text-gray-900 border-r",children:"Descripcin"}),v.jsx("th",{colSpan:3,className:"px-4 py-2 text-center text-sm font-semibold text-gray-900 border-r bg-green-50",children:"ENTRADA"}),v.jsx("th",{colSpan:3,className:"px-4 py-2 text-center text-sm font-semibold text-gray-900 border-r bg-red-50",children:"SALIDA"}),v.jsx("th",{colSpan:3,className:"px-4 py-2 text-center text-sm font-semibold text-gray-900 bg-blue-50",children:"EXISTENCIA"})]}),v.jsxs("tr",{children:[v.jsx("th",{className:"px-2 py-2 text-center text-xs font-medium text-gray-700 border-r",children:"Cantidad"}),v.jsx("th",{className:"px-2 py-2 text-center text-xs font-medium text-gray-700 border-r",children:"Costo Unit."}),v.jsx("th",{className:"px-2 py-2 text-center text-xs font-medium text-gray-700 border-r",children:"Total"}),v.jsx("th",{className:"px-2 py-2 text-center text-xs font-medium text-gray-700 border-r",children:"Cantidad"}),v.jsx("th",{className:"px-2 py-2 text-center text-xs font-medium text-gray-700 border-r",children:"Costo Unit."}),v.jsx("th",{className:"px-2 py-2 text-center text-xs font-medium text-gray-700 border-r",children:"Total"}),v.jsx("th",{className:"px-2 py-2 text-center text-xs font-medium text-gray-700 border-r",children:"Cantidad"}),v.jsx("th",{className:"px-2 py-2 text-center text-xs font-medium text-gray-700 border-r",children:"Costo Unit."}),v.jsx("th",{className:"px-2 py-2 text-center text-xs font-medium text-gray-700",children:"Total"})]})]}),v.jsx("tbody",{className:"divide-y divide-gray-200",children:f.length===0?v.jsx("tr",{children:v.jsx("td",{colSpan:11,className:"px-6 py-8 text-center text-gray-500",children:"No hay movimientos registrados para este artculo en el perodo seleccionado"})}):f.map((R,pe)=>v.jsxs("tr",{className:"hover:bg-gray-50",children:[v.jsx("td",{className:"px-4 py-3 text-sm text-gray-600 border-r",children:WE(R.fecha)}),v.jsx("td",{className:"px-4 py-3 text-sm text-gray-900 border-r",children:R.descripcion}),v.jsx("td",{className:"px-2 py-3 text-center text-sm text-gray-900 border-r",children:R.tipo==="Entrada"?R.cantidad:""}),v.jsx("td",{className:"px-2 py-3 text-center text-sm text-gray-600 border-r",children:R.tipo==="Entrada"?ft(R.costo):""}),v.jsx("td",{className:"px-2 py-3 text-center text-sm text-gray-600 border-r",children:R.tipo==="Entrada"?ft(R.totalValue):""}),v.jsx("td",{className:"px-2 py-3 text-center text-sm text-gray-900 border-r",children:R.tipo==="Salida"?R.cantidad:""}),v.jsx("td",{className:"px-2 py-3 text-center text-sm text-gray-600 border-r",children:R.tipo==="Salida"?ft(R.costo):""}),v.jsx("td",{className:"px-2 py-3 text-center text-sm text-gray-600 border-r",children:R.tipo==="Salida"?ft(R.totalValue):""}),v.jsx("td",{className:"px-2 py-3 text-center text-sm font-medium text-gray-900 border-r",children:R.balance}),v.jsx("td",{className:"px-2 py-3 text-center text-sm text-gray-600 border-r",children:ft(R.costoUnit)}),v.jsx("td",{className:"px-2 py-3 text-center text-sm font-medium text-gray-900",children:ft(R.balanceValue)}),v.jsx("td",{className:"px-2 py-3 text-center text-sm",children:v.jsxs("div",{className:"flex gap-2 justify-center",children:[v.jsx("button",{className:"p-2 rounded-full bg-blue-600 hover:bg-blue-700 text-white transition-colors",title:"Editar",onClick:()=>{const me=t.find(E=>E.id===R.id);b(me),_(!0)},children:v.jsx(kE,{className:"w-4 h-4"})}),v.jsx("button",{className:"p-2 rounded-full bg-red-600 hover:bg-red-700 text-white transition-colors",title:"Eliminar",onClick:()=>P({open:!0,movement:R}),disabled:F,children:v.jsx(TE,{className:"w-4 h-4"})})]})})]},pe))})]})})]}),v.jsxs(Xu,{isOpen:m,onRequestClose:()=>_(!1),className:"bg-white rounded-2xl shadow-lg p-8 border border-gray-100 max-w-lg mx-auto mt-20 outline-none",overlayClassName:"fixed inset-0 bg-black bg-opacity-40 flex items-center justify-center z-50",ariaHideApp:!1,children:[v.jsx("h2",{className:"text-2xl font-bold mb-4 text-center",children:"Editar movimiento"}),y&&v.jsxs("form",{onSubmit:async R=>{R.preventDefault(),T(!0);try{await r(y.id,{cantidad:Number(y.cantidad),fecha:y.fecha,descripcion:y.descripcion,costo:Number(y.costo)}),st.success("Movimiento actualizado correctamente"),_(!1),b(null),a()}catch{st.error("Error al actualizar movimiento")}finally{T(!1)}},className:"space-y-4",children:[v.jsxs("div",{children:[v.jsx("label",{className:"block text-sm font-medium mb-1",children:"Cantidad"}),v.jsx("input",{type:"number",value:y.cantidad,min:1,required:!0,onChange:R=>b({...y,cantidad:R.target.value}),className:"w-full border rounded px-2 py-1"})]}),v.jsxs("div",{children:[v.jsx("label",{className:"block text-sm font-medium mb-1",children:"Fecha"}),v.jsx("input",{type:"date",value:y.fecha?y.fecha.slice(0,10):"",required:!0,onChange:R=>b({...y,fecha:R.target.value}),className:"w-full border rounded px-2 py-1"})]}),v.jsxs("div",{children:[v.jsx("label",{className:"block text-sm font-medium mb-1",children:"Descripcin"}),v.jsx("input",{type:"text",value:y.descripcion,onChange:R=>b({...y,descripcion:R.target.value}),className:"w-full border rounded px-2 py-1"})]}),v.jsxs("div",{children:[v.jsx("label",{className:"block text-sm font-medium mb-1",children:"Costo unitario"}),v.jsx("input",{type:"number",step:"0.01",value:y.costo,onChange:R=>b({...y,costo:R.target.value}),className:"w-full border rounded px-2 py-1"})]}),v.jsxs("div",{className:"flex gap-2 mt-6",children:[v.jsx("button",{type:"submit",disabled:w,className:"flex-1 bg-blue-600 text-white py-2 rounded-lg",children:w?"Guardando...":"Guardar cambios"}),v.jsx("button",{type:"button",onClick:()=>_(!1),className:"flex-1 bg-gray-200 text-gray-700 py-2 rounded-lg",children:"Cancelar"})]})]})]}),v.jsxs(Xu,{isOpen:!!(A!=null&&A.open),onRequestClose:()=>P(null),className:"bg-white rounded-2xl shadow-lg p-8 border border-gray-100 max-w-md mx-auto mt-20 outline-none",overlayClassName:"fixed inset-0 bg-black bg-opacity-40 flex items-center justify-center z-50",ariaHideApp:!1,children:[v.jsx("h2",{className:"text-xl font-bold mb-4 text-center",children:"Eliminar movimiento?"}),v.jsx("p",{className:"mb-4 text-center",children:"Esta accin no se puede deshacer."}),v.jsxs("div",{className:"flex gap-2 mt-6",children:[v.jsx("button",{onClick:async()=>{if(A!=null&&A.movement){I(!0);try{await n(A.movement.id),st.success("Movimiento eliminado correctamente"),P(null),a()}catch{st.error("Error al eliminar movimiento")}finally{I(!1)}}},disabled:F,className:"flex-1 bg-red-600 text-white py-2 rounded-lg",children:F?"Eliminando...":"Eliminar"}),v.jsx("button",{onClick:()=>P(null),className:"flex-1 bg-gray-200 text-gray-700 py-2 rounded-lg",children:"Cancelar"})]})]})]})};/*! xlsx.js (C) 2013-present SheetJS -- http://sheetjs.com */var aA=1252,IU=[874,932,936,949,950,1250,1251,1252,1253,1254,1255,1256,1257,1258,1e4],y5={0:1252,1:65001,2:65001,77:1e4,128:932,129:949,130:1361,134:936,136:950,161:1253,162:1254,163:1258,177:1255,178:1256,186:1257,204:1251,222:874,238:1250,255:1252,69:6969},w5=function(e){IU.indexOf(e)!=-1&&(aA=y5[0]=e)};function DU(){w5(1252)}var ji=function(e){w5(e)};function iA(){ji(1200),DU()}function S3(e){for(var t=[],r=0,n=e.length;r<n;++r)t[r]=e.charCodeAt(r);return t}function jU(e){for(var t=[],r=0;r<e.length>>1;++r)t[r]=String.fromCharCode(e.charCodeAt(2*r)+(e.charCodeAt(2*r+1)<<8));return t.join("")}function sA(e){for(var t=[],r=0;r<e.length>>1;++r)t[r]=String.fromCharCode(e.charCodeAt(2*r+1)+(e.charCodeAt(2*r)<<8));return t.join("")}var af=function(e){var t=e.charCodeAt(0),r=e.charCodeAt(1);return t==255&&r==254?jU(e.slice(2)):t==254&&r==255?sA(e.slice(2)):t==65279?e.slice(1):e},up=function(t){return String.fromCharCode(t)},k3=function(t){return String.fromCharCode(t)},Do,Uo="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";function E3(e){for(var t="",r=0,n=0,a=0,i=0,s=0,o=0,l=0,c=0;c<e.length;)r=e.charCodeAt(c++),i=r>>2,n=e.charCodeAt(c++),s=(r&3)<<4|n>>4,a=e.charCodeAt(c++),o=(n&15)<<2|a>>6,l=a&63,isNaN(n)?o=l=64:isNaN(a)&&(l=64),t+=Uo.charAt(i)+Uo.charAt(s)+Uo.charAt(o)+Uo.charAt(l);return t}function Ba(e){var t="",r=0,n=0,a=0,i=0,s=0,o=0,l=0;e=e.replace(/[^\w\+\/\=]/g,"");for(var c=0;c<e.length;)i=Uo.indexOf(e.charAt(c++)),s=Uo.indexOf(e.charAt(c++)),r=i<<2|s>>4,t+=String.fromCharCode(r),o=Uo.indexOf(e.charAt(c++)),n=(s&15)<<4|o>>2,o!==64&&(t+=String.fromCharCode(n)),l=Uo.indexOf(e.charAt(c++)),a=(o&3)<<6|l,l!==64&&(t+=String.fromCharCode(a));return t}var Mt=function(){return typeof Buffer<"u"&&typeof process<"u"&&typeof process.versions<"u"&&!!process.versions.node}(),pc=function(){if(typeof Buffer<"u"){var e=!Buffer.from;if(!e)try{Buffer.from("foo","utf8")}catch{e=!0}return e?function(t,r){return r?new Buffer(t,r):new Buffer(t)}:Buffer.from.bind(Buffer)}return function(){}}();function al(e){return Mt?Buffer.alloc?Buffer.alloc(e):new Buffer(e):typeof Uint8Array<"u"?new Uint8Array(e):new Array(e)}function A3(e){return Mt?Buffer.allocUnsafe?Buffer.allocUnsafe(e):new Buffer(e):typeof Uint8Array<"u"?new Uint8Array(e):new Array(e)}var Ii=function(t){return Mt?pc(t,"binary"):t.split("").map(function(r){return r.charCodeAt(0)&255})};function mc(e){if(Array.isArray(e))return e.map(function(n){return String.fromCharCode(n)}).join("");for(var t=[],r=0;r<e.length;++r)t[r]=String.fromCharCode(e[r]);return t.join("")}function b5(e){if(typeof ArrayBuffer>"u")throw new Error("Unsupported");if(e instanceof ArrayBuffer)return b5(new Uint8Array(e));for(var t=new Array(e.length),r=0;r<e.length;++r)t[r]=e[r];return t}var jo=Mt?function(e){return Buffer.concat(e.map(function(t){return Buffer.isBuffer(t)?t:pc(t)}))}:function(e){if(typeof Uint8Array<"u"){var t=0,r=0;for(t=0;t<e.length;++t)r+=e[t].length;var n=new Uint8Array(r),a=0;for(t=0,r=0;t<e.length;r+=a,++t)if(a=e[t].length,e[t]instanceof Uint8Array)n.set(e[t],r);else{if(typeof e[t]=="string")throw"wtf";n.set(new Uint8Array(e[t]),r)}return n}return[].concat.apply([],e.map(function(i){return Array.isArray(i)?i:[].slice.call(i)}))};function RU(e){for(var t=[],r=0,n=e.length+250,a=al(e.length+255),i=0;i<e.length;++i){var s=e.charCodeAt(i);if(s<128)a[r++]=s;else if(s<2048)a[r++]=192|s>>6&31,a[r++]=128|s&63;else if(s>=55296&&s<57344){s=(s&1023)+64;var o=e.charCodeAt(++i)&1023;a[r++]=240|s>>8&7,a[r++]=128|s>>2&63,a[r++]=128|o>>6&15|(s&3)<<4,a[r++]=128|o&63}else a[r++]=224|s>>12&15,a[r++]=128|s>>6&63,a[r++]=128|s&63;r>n&&(t.push(a.slice(0,r)),r=0,a=al(65535),n=65530)}return t.push(a.slice(0,r)),jo(t)}var aa=/\u0000/g,sf=/[\u0001-\u0006]/g;function Nu(e){for(var t="",r=e.length-1;r>=0;)t+=e.charAt(r--);return t}function Ri(e,t){var r=""+e;return r.length>=t?r:Fr("0",t-r.length)+r}function _5(e,t){var r=""+e;return r.length>=t?r:Fr(" ",t-r.length)+r}function F1(e,t){var r=""+e;return r.length>=t?r:r+Fr(" ",t-r.length)}function MU(e,t){var r=""+Math.round(e);return r.length>=t?r:Fr("0",t-r.length)+r}function BU(e,t){var r=""+e;return r.length>=t?r:Fr("0",t-r.length)+r}var T3=Math.pow(2,32);function Xc(e,t){if(e>T3||e<-T3)return MU(e,t);var r=Math.round(e);return BU(r,t)}function O1(e,t){return t=t||0,e.length>=7+t&&(e.charCodeAt(t)|32)===103&&(e.charCodeAt(t+1)|32)===101&&(e.charCodeAt(t+2)|32)===110&&(e.charCodeAt(t+3)|32)===101&&(e.charCodeAt(t+4)|32)===114&&(e.charCodeAt(t+5)|32)===97&&(e.charCodeAt(t+6)|32)===108}var C3=[["Sun","Sunday"],["Mon","Monday"],["Tue","Tuesday"],["Wed","Wednesday"],["Thu","Thursday"],["Fri","Friday"],["Sat","Saturday"]],v2=[["J","Jan","January"],["F","Feb","February"],["M","Mar","March"],["A","Apr","April"],["M","May","May"],["J","Jun","June"],["J","Jul","July"],["A","Aug","August"],["S","Sep","September"],["O","Oct","October"],["N","Nov","November"],["D","Dec","December"]];function UU(e){return e||(e={}),e[0]="General",e[1]="0",e[2]="0.00",e[3]="#,##0",e[4]="#,##0.00",e[9]="0%",e[10]="0.00%",e[11]="0.00E+00",e[12]="# ?/?",e[13]="# ??/??",e[14]="m/d/yy",e[15]="d-mmm-yy",e[16]="d-mmm",e[17]="mmm-yy",e[18]="h:mm AM/PM",e[19]="h:mm:ss AM/PM",e[20]="h:mm",e[21]="h:mm:ss",e[22]="m/d/yy h:mm",e[37]="#,##0 ;(#,##0)",e[38]="#,##0 ;[Red](#,##0)",e[39]="#,##0.00;(#,##0.00)",e[40]="#,##0.00;[Red](#,##0.00)",e[45]="mm:ss",e[46]="[h]:mm:ss",e[47]="mmss.0",e[48]="##0.0E+0",e[49]="@",e[56]='"/ "hh""mm""ss" "',e}var Ot={0:"General",1:"0",2:"0.00",3:"#,##0",4:"#,##0.00",9:"0%",10:"0.00%",11:"0.00E+00",12:"# ?/?",13:"# ??/??",14:"m/d/yy",15:"d-mmm-yy",16:"d-mmm",17:"mmm-yy",18:"h:mm AM/PM",19:"h:mm:ss AM/PM",20:"h:mm",21:"h:mm:ss",22:"m/d/yy h:mm",37:"#,##0 ;(#,##0)",38:"#,##0 ;[Red](#,##0)",39:"#,##0.00;(#,##0.00)",40:"#,##0.00;[Red](#,##0.00)",45:"mm:ss",46:"[h]:mm:ss",47:"mmss.0",48:"##0.0E+0",49:"@",56:'"/ "hh""mm""ss" "'},N3={5:37,6:38,7:39,8:40,23:0,24:0,25:0,26:0,27:14,28:14,29:14,30:14,31:14,50:14,51:14,52:14,53:14,54:14,55:14,56:14,57:14,58:14,59:1,60:2,61:3,62:4,67:9,68:10,69:12,70:13,71:14,72:14,73:15,74:16,75:17,76:20,77:21,78:22,79:45,80:46,81:47,82:0},$U={5:'"$"#,##0_);\\("$"#,##0\\)',63:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',41:'_(* #,##0_);_(* \\(#,##0\\);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* \\(#,##0\\);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* \\(#,##0.00\\);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* \\(#,##0.00\\);_("$"* "-"??_);_(@_)'};function I1(e,t,r){for(var n=e<0?-1:1,a=e*n,i=0,s=1,o=0,l=1,c=0,u=0,f=Math.floor(a);c<t&&(f=Math.floor(a),o=f*s+i,u=f*c+l,!(a-f<5e-8));)a=1/(a-f),i=s,s=o,l=c,c=u;if(u>t&&(c>t?(u=l,o=i):(u=c,o=s)),!r)return[0,n*o,u];var d=Math.floor(n*o/u);return[d,n*o-d*u,u]}function zl(e,t,r){if(e>2958465||e<0)return null;var n=e|0,a=Math.floor(86400*(e-n)),i=0,s=[],o={D:n,T:a,u:86400*(e-n)-a,y:0,m:0,d:0,H:0,M:0,S:0,q:0};if(Math.abs(o.u)<1e-6&&(o.u=0),t&&t.date1904&&(n+=1462),o.u>.9999&&(o.u=0,++a==86400&&(o.T=a=0,++n,++o.D)),n===60)s=r?[1317,10,29]:[1900,2,29],i=3;else if(n===0)s=r?[1317,8,29]:[1900,1,0],i=6;else{n>60&&--n;var l=new Date(1900,0,1);l.setDate(l.getDate()+n-1),s=[l.getFullYear(),l.getMonth()+1,l.getDate()],i=l.getDay(),n<60&&(i=(i+6)%7),r&&(i=GU(l,s))}return o.y=s[0],o.m=s[1],o.d=s[2],o.S=a%60,a=Math.floor(a/60),o.M=a%60,a=Math.floor(a/60),o.H=a,o.q=i,o}var oA=new Date(1899,11,31,0,0,0),VU=oA.getTime(),zU=new Date(1900,2,1,0,0,0);function lA(e,t){var r=e.getTime();return t?r-=1461*24*60*60*1e3:e>=zU&&(r+=24*60*60*1e3),(r-(VU+(e.getTimezoneOffset()-oA.getTimezoneOffset())*6e4))/(24*60*60*1e3)}function S5(e){return e.indexOf(".")==-1?e:e.replace(/(?:\.0*|(\.\d*[1-9])0+)$/,"$1")}function HU(e){return e.indexOf("E")==-1?e:e.replace(/(?:\.0*|(\.\d*[1-9])0+)[Ee]/,"$1E").replace(/(E[+-])(\d)$/,"$10$2")}function WU(e){var t=e<0?12:11,r=S5(e.toFixed(12));return r.length<=t||(r=e.toPrecision(10),r.length<=t)?r:e.toExponential(5)}function qU(e){var t=S5(e.toFixed(11));return t.length>(e<0?12:11)||t==="0"||t==="-0"?e.toPrecision(6):t}function ph(e){var t=Math.floor(Math.log(Math.abs(e))*Math.LOG10E),r;return t>=-4&&t<=-1?r=e.toPrecision(10+t):Math.abs(t)<=9?r=WU(e):t===10?r=e.toFixed(10).substr(0,12):r=qU(e),S5(HU(r.toUpperCase()))}function ac(e,t){switch(typeof e){case"string":return e;case"boolean":return e?"TRUE":"FALSE";case"number":return(e|0)===e?e.toString(10):ph(e);case"undefined":return"";case"object":if(e==null)return"";if(e instanceof Date)return fi(14,lA(e,t&&t.date1904),t)}throw new Error("unsupported value in General format: "+e)}function GU(e,t){t[0]-=581;var r=e.getDay();return e<60&&(r=(r+6)%7),r}function KU(e,t,r,n){var a="",i=0,s=0,o=r.y,l,c=0;switch(e){case 98:o=r.y+543;case 121:switch(t.length){case 1:case 2:l=o%100,c=2;break;default:l=o%1e4,c=4;break}break;case 109:switch(t.length){case 1:case 2:l=r.m,c=t.length;break;case 3:return v2[r.m-1][1];case 5:return v2[r.m-1][0];default:return v2[r.m-1][2]}break;case 100:switch(t.length){case 1:case 2:l=r.d,c=t.length;break;case 3:return C3[r.q][0];default:return C3[r.q][1]}break;case 104:switch(t.length){case 1:case 2:l=1+(r.H+11)%12,c=t.length;break;default:throw"bad hour format: "+t}break;case 72:switch(t.length){case 1:case 2:l=r.H,c=t.length;break;default:throw"bad hour format: "+t}break;case 77:switch(t.length){case 1:case 2:l=r.M,c=t.length;break;default:throw"bad minute format: "+t}break;case 115:if(t!="s"&&t!="ss"&&t!=".0"&&t!=".00"&&t!=".000")throw"bad second format: "+t;return r.u===0&&(t=="s"||t=="ss")?Ri(r.S,t.length):(n>=2?s=n===3?1e3:100:s=n===1?10:1,i=Math.round(s*(r.S+r.u)),i>=60*s&&(i=0),t==="s"?i===0?"0":""+i/s:(a=Ri(i,2+n),t==="ss"?a.substr(0,2):"."+a.substr(2,t.length-1)));case 90:switch(t){case"[h]":case"[hh]":l=r.D*24+r.H;break;case"[m]":case"[mm]":l=(r.D*24+r.H)*60+r.M;break;case"[s]":case"[ss]":l=((r.D*24+r.H)*60+r.M)*60+Math.round(r.S+r.u);break;default:throw"bad abstime format: "+t}c=t.length===3?1:2;break;case 101:l=o,c=1;break}var u=c>0?Ri(l,c):"";return u}function $o(e){var t=3;if(e.length<=t)return e;for(var r=e.length%t,n=e.substr(0,r);r!=e.length;r+=t)n+=(n.length>0?",":"")+e.substr(r,t);return n}var cA=/%/g;function XU(e,t,r){var n=t.replace(cA,""),a=t.length-n.length;return Ws(e,n,r*Math.pow(10,2*a))+Fr("%",a)}function YU(e,t,r){for(var n=t.length-1;t.charCodeAt(n-1)===44;)--n;return Ws(e,t.substr(0,n),r/Math.pow(10,3*(t.length-n)))}function uA(e,t){var r,n=e.indexOf("E")-e.indexOf(".")-1;if(e.match(/^#+0.0E\+0$/)){if(t==0)return"0.0E+0";if(t<0)return"-"+uA(e,-t);var a=e.indexOf(".");a===-1&&(a=e.indexOf("E"));var i=Math.floor(Math.log(t)*Math.LOG10E)%a;if(i<0&&(i+=a),r=(t/Math.pow(10,i)).toPrecision(n+1+(a+i)%a),r.indexOf("e")===-1){var s=Math.floor(Math.log(t)*Math.LOG10E);for(r.indexOf(".")===-1?r=r.charAt(0)+"."+r.substr(1)+"E+"+(s-r.length+i):r+="E+"+(s-i);r.substr(0,2)==="0.";)r=r.charAt(0)+r.substr(2,a)+"."+r.substr(2+a),r=r.replace(/^0+([1-9])/,"$1").replace(/^0+\./,"0.");r=r.replace(/\+-/,"-")}r=r.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(o,l,c,u){return l+c+u.substr(0,(a+i)%a)+"."+u.substr(i)+"E"})}else r=t.toExponential(n);return e.match(/E\+00$/)&&r.match(/e[+-]\d$/)&&(r=r.substr(0,r.length-1)+"0"+r.charAt(r.length-1)),e.match(/E\-/)&&r.match(/e\+/)&&(r=r.replace(/e\+/,"e")),r.replace("e","E")}var fA=/# (\?+)( ?)\/( ?)(\d+)/;function JU(e,t,r){var n=parseInt(e[4],10),a=Math.round(t*n),i=Math.floor(a/n),s=a-i*n,o=n;return r+(i===0?"":""+i)+" "+(s===0?Fr(" ",e[1].length+1+e[4].length):_5(s,e[1].length)+e[2]+"/"+e[3]+Ri(o,e[4].length))}function QU(e,t,r){return r+(t===0?"":""+t)+Fr(" ",e[1].length+2+e[4].length)}var hA=/^#*0*\.([0#]+)/,dA=/\).*[0#]/,pA=/\(###\) ###\\?-####/;function Zn(e){for(var t="",r,n=0;n!=e.length;++n)switch(r=e.charCodeAt(n)){case 35:break;case 63:t+=" ";break;case 48:t+="0";break;default:t+=String.fromCharCode(r)}return t}function P3(e,t){var r=Math.pow(10,t);return""+Math.round(e*r)/r}function L3(e,t){var r=e-Math.floor(e),n=Math.pow(10,t);return t<(""+Math.round(r*n)).length?0:Math.round(r*n)}function ZU(e,t){return t<(""+Math.round((e-Math.floor(e))*Math.pow(10,t))).length?1:0}function e$(e){return e<2147483647&&e>-2147483648?""+(e>=0?e|0:e-1|0):""+Math.floor(e)}function ei(e,t,r){if(e.charCodeAt(0)===40&&!t.match(dA)){var n=t.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return r>=0?ei("n",n,r):"("+ei("n",n,-r)+")"}if(t.charCodeAt(t.length-1)===44)return YU(e,t,r);if(t.indexOf("%")!==-1)return XU(e,t,r);if(t.indexOf("E")!==-1)return uA(t,r);if(t.charCodeAt(0)===36)return"$"+ei(e,t.substr(t.charAt(1)==" "?2:1),r);var a,i,s,o,l=Math.abs(r),c=r<0?"-":"";if(t.match(/^00+$/))return c+Xc(l,t.length);if(t.match(/^[#?]+$/))return a=Xc(r,0),a==="0"&&(a=""),a.length>t.length?a:Zn(t.substr(0,t.length-a.length))+a;if(i=t.match(fA))return JU(i,l,c);if(t.match(/^#+0+$/))return c+Xc(l,t.length-t.indexOf("0"));if(i=t.match(hA))return a=P3(r,i[1].length).replace(/^([^\.]+)$/,"$1."+Zn(i[1])).replace(/\.$/,"."+Zn(i[1])).replace(/\.(\d*)$/,function(g,m){return"."+m+Fr("0",Zn(i[1]).length-m.length)}),t.indexOf("0.")!==-1?a:a.replace(/^0\./,".");if(t=t.replace(/^#+([0.])/,"$1"),i=t.match(/^(0*)\.(#*)$/))return c+P3(l,i[2].length).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,i[1].length?"0.":".");if(i=t.match(/^#{1,3},##0(\.?)$/))return c+$o(Xc(l,0));if(i=t.match(/^#,##0\.([#0]*0)$/))return r<0?"-"+ei(e,t,-r):$o(""+(Math.floor(r)+ZU(r,i[1].length)))+"."+Ri(L3(r,i[1].length),i[1].length);if(i=t.match(/^#,#*,#0/))return ei(e,t.replace(/^#,#*,/,""),r);if(i=t.match(/^([0#]+)(\\?-([0#]+))+$/))return a=Nu(ei(e,t.replace(/[\\-]/g,""),r)),s=0,Nu(Nu(t.replace(/\\/g,"")).replace(/[0#]/g,function(g){return s<a.length?a.charAt(s++):g==="0"?"0":""}));if(t.match(pA))return a=ei(e,"##########",r),"("+a.substr(0,3)+") "+a.substr(3,3)+"-"+a.substr(6);var u="";if(i=t.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return s=Math.min(i[4].length,7),o=I1(l,Math.pow(10,s)-1,!1),a=""+c,u=Ws("n",i[1],o[1]),u.charAt(u.length-1)==" "&&(u=u.substr(0,u.length-1)+"0"),a+=u+i[2]+"/"+i[3],u=F1(o[2],s),u.length<i[4].length&&(u=Zn(i[4].substr(i[4].length-u.length))+u),a+=u,a;if(i=t.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return s=Math.min(Math.max(i[1].length,i[4].length),7),o=I1(l,Math.pow(10,s)-1,!0),c+(o[0]||(o[1]?"":"0"))+" "+(o[1]?_5(o[1],s)+i[2]+"/"+i[3]+F1(o[2],s):Fr(" ",2*s+1+i[2].length+i[3].length));if(i=t.match(/^[#0?]+$/))return a=Xc(r,0),t.length<=a.length?a:Zn(t.substr(0,t.length-a.length))+a;if(i=t.match(/^([#0?]+)\.([#0]+)$/)){a=""+r.toFixed(Math.min(i[2].length,10)).replace(/([^0])0+$/,"$1"),s=a.indexOf(".");var f=t.indexOf(".")-s,d=t.length-a.length-f;return Zn(t.substr(0,f)+a+t.substr(t.length-d))}if(i=t.match(/^00,000\.([#0]*0)$/))return s=L3(r,i[1].length),r<0?"-"+ei(e,t,-r):$o(e$(r)).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(g){return"00,"+(g.length<3?Ri(0,3-g.length):"")+g})+"."+Ri(s,i[1].length);switch(t){case"###,##0.00":return ei(e,"#,##0.00",r);case"###,###":case"##,###":case"#,###":var h=$o(Xc(l,0));return h!=="0"?c+h:"";case"###,###.00":return ei(e,"###,##0.00",r).replace(/^0\./,".");case"#,###.00":return ei(e,"#,##0.00",r).replace(/^0\./,".")}throw new Error("unsupported format |"+t+"|")}function t$(e,t,r){for(var n=t.length-1;t.charCodeAt(n-1)===44;)--n;return Ws(e,t.substr(0,n),r/Math.pow(10,3*(t.length-n)))}function r$(e,t,r){var n=t.replace(cA,""),a=t.length-n.length;return Ws(e,n,r*Math.pow(10,2*a))+Fr("%",a)}function mA(e,t){var r,n=e.indexOf("E")-e.indexOf(".")-1;if(e.match(/^#+0.0E\+0$/)){if(t==0)return"0.0E+0";if(t<0)return"-"+mA(e,-t);var a=e.indexOf(".");a===-1&&(a=e.indexOf("E"));var i=Math.floor(Math.log(t)*Math.LOG10E)%a;if(i<0&&(i+=a),r=(t/Math.pow(10,i)).toPrecision(n+1+(a+i)%a),!r.match(/[Ee]/)){var s=Math.floor(Math.log(t)*Math.LOG10E);r.indexOf(".")===-1?r=r.charAt(0)+"."+r.substr(1)+"E+"+(s-r.length+i):r+="E+"+(s-i),r=r.replace(/\+-/,"-")}r=r.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(o,l,c,u){return l+c+u.substr(0,(a+i)%a)+"."+u.substr(i)+"E"})}else r=t.toExponential(n);return e.match(/E\+00$/)&&r.match(/e[+-]\d$/)&&(r=r.substr(0,r.length-1)+"0"+r.charAt(r.length-1)),e.match(/E\-/)&&r.match(/e\+/)&&(r=r.replace(/e\+/,"e")),r.replace("e","E")}function rs(e,t,r){if(e.charCodeAt(0)===40&&!t.match(dA)){var n=t.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return r>=0?rs("n",n,r):"("+rs("n",n,-r)+")"}if(t.charCodeAt(t.length-1)===44)return t$(e,t,r);if(t.indexOf("%")!==-1)return r$(e,t,r);if(t.indexOf("E")!==-1)return mA(t,r);if(t.charCodeAt(0)===36)return"$"+rs(e,t.substr(t.charAt(1)==" "?2:1),r);var a,i,s,o,l=Math.abs(r),c=r<0?"-":"";if(t.match(/^00+$/))return c+Ri(l,t.length);if(t.match(/^[#?]+$/))return a=""+r,r===0&&(a=""),a.length>t.length?a:Zn(t.substr(0,t.length-a.length))+a;if(i=t.match(fA))return QU(i,l,c);if(t.match(/^#+0+$/))return c+Ri(l,t.length-t.indexOf("0"));if(i=t.match(hA))return a=(""+r).replace(/^([^\.]+)$/,"$1."+Zn(i[1])).replace(/\.$/,"."+Zn(i[1])),a=a.replace(/\.(\d*)$/,function(g,m){return"."+m+Fr("0",Zn(i[1]).length-m.length)}),t.indexOf("0.")!==-1?a:a.replace(/^0\./,".");if(t=t.replace(/^#+([0.])/,"$1"),i=t.match(/^(0*)\.(#*)$/))return c+(""+l).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,i[1].length?"0.":".");if(i=t.match(/^#{1,3},##0(\.?)$/))return c+$o(""+l);if(i=t.match(/^#,##0\.([#0]*0)$/))return r<0?"-"+rs(e,t,-r):$o(""+r)+"."+Fr("0",i[1].length);if(i=t.match(/^#,#*,#0/))return rs(e,t.replace(/^#,#*,/,""),r);if(i=t.match(/^([0#]+)(\\?-([0#]+))+$/))return a=Nu(rs(e,t.replace(/[\\-]/g,""),r)),s=0,Nu(Nu(t.replace(/\\/g,"")).replace(/[0#]/g,function(g){return s<a.length?a.charAt(s++):g==="0"?"0":""}));if(t.match(pA))return a=rs(e,"##########",r),"("+a.substr(0,3)+") "+a.substr(3,3)+"-"+a.substr(6);var u="";if(i=t.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return s=Math.min(i[4].length,7),o=I1(l,Math.pow(10,s)-1,!1),a=""+c,u=Ws("n",i[1],o[1]),u.charAt(u.length-1)==" "&&(u=u.substr(0,u.length-1)+"0"),a+=u+i[2]+"/"+i[3],u=F1(o[2],s),u.length<i[4].length&&(u=Zn(i[4].substr(i[4].length-u.length))+u),a+=u,a;if(i=t.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return s=Math.min(Math.max(i[1].length,i[4].length),7),o=I1(l,Math.pow(10,s)-1,!0),c+(o[0]||(o[1]?"":"0"))+" "+(o[1]?_5(o[1],s)+i[2]+"/"+i[3]+F1(o[2],s):Fr(" ",2*s+1+i[2].length+i[3].length));if(i=t.match(/^[#0?]+$/))return a=""+r,t.length<=a.length?a:Zn(t.substr(0,t.length-a.length))+a;if(i=t.match(/^([#0]+)\.([#0]+)$/)){a=""+r.toFixed(Math.min(i[2].length,10)).replace(/([^0])0+$/,"$1"),s=a.indexOf(".");var f=t.indexOf(".")-s,d=t.length-a.length-f;return Zn(t.substr(0,f)+a+t.substr(t.length-d))}if(i=t.match(/^00,000\.([#0]*0)$/))return r<0?"-"+rs(e,t,-r):$o(""+r).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(g){return"00,"+(g.length<3?Ri(0,3-g.length):"")+g})+"."+Ri(0,i[1].length);switch(t){case"###,###":case"##,###":case"#,###":var h=$o(""+l);return h!=="0"?c+h:"";default:if(t.match(/\.[0#?]*$/))return rs(e,t.slice(0,t.lastIndexOf(".")),r)+Zn(t.slice(t.lastIndexOf(".")))}throw new Error("unsupported format |"+t+"|")}function Ws(e,t,r){return(r|0)===r?rs(e,t,r):ei(e,t,r)}function n$(e){for(var t=[],r=!1,n=0,a=0;n<e.length;++n)switch(e.charCodeAt(n)){case 34:r=!r;break;case 95:case 42:case 92:++n;break;case 59:t[t.length]=e.substr(a,n-a),a=n+1}if(t[t.length]=e.substr(a),r===!0)throw new Error("Format |"+e+"| unterminated string ");return t}var gA=/\[[HhMmSs\u0E0A\u0E19\u0E17]*\]/;function s0(e){for(var t=0,r="",n="";t<e.length;)switch(r=e.charAt(t)){case"G":O1(e,t)&&(t+=6),t++;break;case'"':for(;e.charCodeAt(++t)!==34&&t<e.length;);++t;break;case"\\":t+=2;break;case"_":t+=2;break;case"@":++t;break;case"B":case"b":if(e.charAt(t+1)==="1"||e.charAt(t+1)==="2")return!0;case"M":case"D":case"Y":case"H":case"S":case"E":case"m":case"d":case"y":case"h":case"s":case"e":case"g":return!0;case"A":case"a":case"":if(e.substr(t,3).toUpperCase()==="A/P"||e.substr(t,5).toUpperCase()==="AM/PM"||e.substr(t,5).toUpperCase()==="/")return!0;++t;break;case"[":for(n=r;e.charAt(t++)!=="]"&&t<e.length;)n+=e.charAt(t);if(n.match(gA))return!0;break;case".":case"0":case"#":for(;t<e.length&&("0#?.,E+-%".indexOf(r=e.charAt(++t))>-1||r=="\\"&&e.charAt(t+1)=="-"&&"0#".indexOf(e.charAt(t+2))>-1););break;case"?":for(;e.charAt(++t)===r;);break;case"*":++t,(e.charAt(t)==" "||e.charAt(t)=="*")&&++t;break;case"(":case")":++t;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(;t<e.length&&"0123456789".indexOf(e.charAt(++t))>-1;);break;case" ":++t;break;default:++t;break}return!1}function a$(e,t,r,n){for(var a=[],i="",s=0,o="",l="t",c,u,f,d="H";s<e.length;)switch(o=e.charAt(s)){case"G":if(!O1(e,s))throw new Error("unrecognized character "+o+" in "+e);a[a.length]={t:"G",v:"General"},s+=7;break;case'"':for(i="";(f=e.charCodeAt(++s))!==34&&s<e.length;)i+=String.fromCharCode(f);a[a.length]={t:"t",v:i},++s;break;case"\\":var h=e.charAt(++s),g=h==="("||h===")"?h:"t";a[a.length]={t:g,v:h},++s;break;case"_":a[a.length]={t:"t",v:" "},s+=2;break;case"@":a[a.length]={t:"T",v:t},++s;break;case"B":case"b":if(e.charAt(s+1)==="1"||e.charAt(s+1)==="2"){if(c==null&&(c=zl(t,r,e.charAt(s+1)==="2"),c==null))return"";a[a.length]={t:"X",v:e.substr(s,2)},l=o,s+=2;break}case"M":case"D":case"Y":case"H":case"S":case"E":o=o.toLowerCase();case"m":case"d":case"y":case"h":case"s":case"e":case"g":if(t<0||c==null&&(c=zl(t,r),c==null))return"";for(i=o;++s<e.length&&e.charAt(s).toLowerCase()===o;)i+=o;o==="m"&&l.toLowerCase()==="h"&&(o="M"),o==="h"&&(o=d),a[a.length]={t:o,v:i},l=o;break;case"A":case"a":case"":var m={t:o,v:o};if(c==null&&(c=zl(t,r)),e.substr(s,3).toUpperCase()==="A/P"?(c!=null&&(m.v=c.H>=12?"P":"A"),m.t="T",d="h",s+=3):e.substr(s,5).toUpperCase()==="AM/PM"?(c!=null&&(m.v=c.H>=12?"PM":"AM"),m.t="T",s+=5,d="h"):e.substr(s,5).toUpperCase()==="/"?(c!=null&&(m.v=c.H>=12?"":""),m.t="T",s+=5,d="h"):(m.t="t",++s),c==null&&m.t==="T")return"";a[a.length]=m,l=o;break;case"[":for(i=o;e.charAt(s++)!=="]"&&s<e.length;)i+=e.charAt(s);if(i.slice(-1)!=="]")throw'unterminated "[" block: |'+i+"|";if(i.match(gA)){if(c==null&&(c=zl(t,r),c==null))return"";a[a.length]={t:"Z",v:i.toLowerCase()},l=i.charAt(1)}else i.indexOf("$")>-1&&(i=(i.match(/\$([^-\[\]]*)/)||[])[1]||"$",s0(e)||(a[a.length]={t:"t",v:i}));break;case".":if(c!=null){for(i=o;++s<e.length&&(o=e.charAt(s))==="0";)i+=o;a[a.length]={t:"s",v:i};break}case"0":case"#":for(i=o;++s<e.length&&"0#?.,E+-%".indexOf(o=e.charAt(s))>-1;)i+=o;a[a.length]={t:"n",v:i};break;case"?":for(i=o;e.charAt(++s)===o;)i+=o;a[a.length]={t:o,v:i},l=o;break;case"*":++s,(e.charAt(s)==" "||e.charAt(s)=="*")&&++s;break;case"(":case")":a[a.length]={t:n===1?"t":o,v:o},++s;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(i=o;s<e.length&&"0123456789".indexOf(e.charAt(++s))>-1;)i+=e.charAt(s);a[a.length]={t:"D",v:i};break;case" ":a[a.length]={t:o,v:o},++s;break;case"$":a[a.length]={t:"t",v:"$"},++s;break;default:if(",$-+/():!^&'~{}<>=acfijklopqrtuvwxzP".indexOf(o)===-1)throw new Error("unrecognized character "+o+" in "+e);a[a.length]={t:"t",v:o},++s;break}var _=0,y=0,b;for(s=a.length-1,l="t";s>=0;--s)switch(a[s].t){case"h":case"H":a[s].t=d,l="h",_<1&&(_=1);break;case"s":(b=a[s].v.match(/\.0+$/))&&(y=Math.max(y,b[0].length-1)),_<3&&(_=3);case"d":case"y":case"M":case"e":l=a[s].t;break;case"m":l==="s"&&(a[s].t="M",_<2&&(_=2));break;case"X":break;case"Z":_<1&&a[s].v.match(/[Hh]/)&&(_=1),_<2&&a[s].v.match(/[Mm]/)&&(_=2),_<3&&a[s].v.match(/[Ss]/)&&(_=3)}switch(_){case 0:break;case 1:c.u>=.5&&(c.u=0,++c.S),c.S>=60&&(c.S=0,++c.M),c.M>=60&&(c.M=0,++c.H);break;case 2:c.u>=.5&&(c.u=0,++c.S),c.S>=60&&(c.S=0,++c.M);break}var w="",T;for(s=0;s<a.length;++s)switch(a[s].t){case"t":case"T":case" ":case"D":break;case"X":a[s].v="",a[s].t=";";break;case"d":case"m":case"y":case"h":case"H":case"M":case"s":case"e":case"b":case"Z":a[s].v=KU(a[s].t.charCodeAt(0),a[s].v,c,y),a[s].t="t";break;case"n":case"?":for(T=s+1;a[T]!=null&&((o=a[T].t)==="?"||o==="D"||(o===" "||o==="t")&&a[T+1]!=null&&(a[T+1].t==="?"||a[T+1].t==="t"&&a[T+1].v==="/")||a[s].t==="("&&(o===" "||o==="n"||o===")")||o==="t"&&(a[T].v==="/"||a[T].v===" "&&a[T+1]!=null&&a[T+1].t=="?"));)a[s].v+=a[T].v,a[T]={v:"",t:";"},++T;w+=a[s].v,s=T-1;break;case"G":a[s].t="t",a[s].v=ac(t,r);break}var F="",I,A;if(w.length>0){w.charCodeAt(0)==40?(I=t<0&&w.charCodeAt(0)===45?-t:t,A=Ws("n",w,I)):(I=t<0&&n>1?-t:t,A=Ws("n",w,I),I<0&&a[0]&&a[0].t=="t"&&(A=A.substr(1),a[0].v="-"+a[0].v)),T=A.length-1;var P=a.length;for(s=0;s<a.length;++s)if(a[s]!=null&&a[s].t!="t"&&a[s].v.indexOf(".")>-1){P=s;break}var j=a.length;if(P===a.length&&A.indexOf("E")===-1){for(s=a.length-1;s>=0;--s)a[s]==null||"n?".indexOf(a[s].t)===-1||(T>=a[s].v.length-1?(T-=a[s].v.length,a[s].v=A.substr(T+1,a[s].v.length)):T<0?a[s].v="":(a[s].v=A.substr(0,T+1),T=-1),a[s].t="t",j=s);T>=0&&j<a.length&&(a[j].v=A.substr(0,T+1)+a[j].v)}else if(P!==a.length&&A.indexOf("E")===-1){for(T=A.indexOf(".")-1,s=P;s>=0;--s)if(!(a[s]==null||"n?".indexOf(a[s].t)===-1)){for(u=a[s].v.indexOf(".")>-1&&s===P?a[s].v.indexOf(".")-1:a[s].v.length-1,F=a[s].v.substr(u+1);u>=0;--u)T>=0&&(a[s].v.charAt(u)==="0"||a[s].v.charAt(u)==="#")&&(F=A.charAt(T--)+F);a[s].v=F,a[s].t="t",j=s}for(T>=0&&j<a.length&&(a[j].v=A.substr(0,T+1)+a[j].v),T=A.indexOf(".")+1,s=P;s<a.length;++s)if(!(a[s]==null||"n?(".indexOf(a[s].t)===-1&&s!==P)){for(u=a[s].v.indexOf(".")>-1&&s===P?a[s].v.indexOf(".")+1:0,F=a[s].v.substr(0,u);u<a[s].v.length;++u)T<A.length&&(F+=A.charAt(T++));a[s].v=F,a[s].t="t",j=s}}}for(s=0;s<a.length;++s)a[s]!=null&&"n?".indexOf(a[s].t)>-1&&(I=n>1&&t<0&&s>0&&a[s-1].v==="-"?-t:t,a[s].v=Ws(a[s].t,a[s].v,I),a[s].t="t");var J="";for(s=0;s!==a.length;++s)a[s]!=null&&(J+=a[s].v);return J}var F3=/\[(=|>[=]?|<[>=]?)(-?\d+(?:\.\d*)?)\]/;function O3(e,t){if(t==null)return!1;var r=parseFloat(t[2]);switch(t[1]){case"=":if(e==r)return!0;break;case">":if(e>r)return!0;break;case"<":if(e<r)return!0;break;case"<>":if(e!=r)return!0;break;case">=":if(e>=r)return!0;break;case"<=":if(e<=r)return!0;break}return!1}function i$(e,t){var r=n$(e),n=r.length,a=r[n-1].indexOf("@");if(n<4&&a>-1&&--n,r.length>4)throw new Error("cannot find right format for |"+r.join("|")+"|");if(typeof t!="number")return[4,r.length===4||a>-1?r[r.length-1]:"@"];switch(r.length){case 1:r=a>-1?["General","General","General",r[0]]:[r[0],r[0],r[0],"@"];break;case 2:r=a>-1?[r[0],r[0],r[0],r[1]]:[r[0],r[1],r[0],"@"];break;case 3:r=a>-1?[r[0],r[1],r[0],r[2]]:[r[0],r[1],r[2],"@"];break}var i=t>0?r[0]:t<0?r[1]:r[2];if(r[0].indexOf("[")===-1&&r[1].indexOf("[")===-1)return[n,i];if(r[0].match(/\[[=<>]/)!=null||r[1].match(/\[[=<>]/)!=null){var s=r[0].match(F3),o=r[1].match(F3);return O3(t,s)?[n,r[0]]:O3(t,o)?[n,r[1]]:[n,r[s!=null&&o!=null?2:1]]}return[n,i]}function fi(e,t,r){r==null&&(r={});var n="";switch(typeof e){case"string":e=="m/d/yy"&&r.dateNF?n=r.dateNF:n=e;break;case"number":e==14&&r.dateNF?n=r.dateNF:n=(r.table!=null?r.table:Ot)[e],n==null&&(n=r.table&&r.table[N3[e]]||Ot[N3[e]]),n==null&&(n=$U[e]||"General");break}if(O1(n,0))return ac(t,r);t instanceof Date&&(t=lA(t,r.date1904));var a=i$(n,t);if(O1(a[1]))return ac(t,r);if(t===!0)t="TRUE";else if(t===!1)t="FALSE";else if(t===""||t==null)return"";return a$(a[1],t,r,a[0])}function Xl(e,t){if(typeof t!="number"){t=+t||-1;for(var r=0;r<392;++r){if(Ot[r]==null){t<0&&(t=r);continue}if(Ot[r]==e){t=r;break}}t<0&&(t=391)}return Ot[t]=e,t}function xA(){Ot=UU()}var s$={5:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',23:"General",24:"General",25:"General",26:"General",27:"m/d/yy",28:"m/d/yy",29:"m/d/yy",30:"m/d/yy",31:"m/d/yy",32:"h:mm:ss",33:"h:mm:ss",34:"h:mm:ss",35:"h:mm:ss",36:"m/d/yy",41:'_(* #,##0_);_(* (#,##0);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* (#,##0);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* (#,##0.00);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* (#,##0.00);_("$"* "-"??_);_(@_)',50:"m/d/yy",51:"m/d/yy",52:"m/d/yy",53:"m/d/yy",54:"m/d/yy",55:"m/d/yy",56:"m/d/yy",57:"m/d/yy",58:"m/d/yy",59:"0",60:"0.00",61:"#,##0",62:"#,##0.00",63:'"$"#,##0_);\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',67:"0%",68:"0.00%",69:"# ?/?",70:"# ??/??",71:"m/d/yy",72:"m/d/yy",73:"d-mmm-yy",74:"d-mmm",75:"mmm-yy",76:"h:mm",77:"h:mm:ss",78:"m/d/yy h:mm",79:"mm:ss",80:"[h]:mm:ss",81:"mmss.0"},vA=/[dD]+|[mM]+|[yYeE]+|[Hh]+|[Ss]+/g;function o$(e){var t=typeof e=="number"?Ot[e]:e;return t=t.replace(vA,"(\\d+)"),new RegExp("^"+t+"$")}function l$(e,t,r){var n=-1,a=-1,i=-1,s=-1,o=-1,l=-1;(t.match(vA)||[]).forEach(function(f,d){var h=parseInt(r[d+1],10);switch(f.toLowerCase().charAt(0)){case"y":n=h;break;case"d":i=h;break;case"h":s=h;break;case"s":l=h;break;case"m":s>=0?o=h:a=h;break}}),l>=0&&o==-1&&a>=0&&(o=a,a=-1);var c=(""+(n>=0?n:new Date().getFullYear())).slice(-4)+"-"+("00"+(a>=1?a:1)).slice(-2)+"-"+("00"+(i>=1?i:1)).slice(-2);c.length==7&&(c="0"+c),c.length==8&&(c="20"+c);var u=("00"+(s>=0?s:0)).slice(-2)+":"+("00"+(o>=0?o:0)).slice(-2)+":"+("00"+(l>=0?l:0)).slice(-2);return s==-1&&o==-1&&l==-1?c:n==-1&&a==-1&&i==-1?u:c+"T"+u}var c$=function(){var e={};e.version="1.2.0";function t(){for(var A=0,P=new Array(256),j=0;j!=256;++j)A=j,A=A&1?-306674912^A>>>1:A>>>1,A=A&1?-306674912^A>>>1:A>>>1,A=A&1?-306674912^A>>>1:A>>>1,A=A&1?-306674912^A>>>1:A>>>1,A=A&1?-306674912^A>>>1:A>>>1,A=A&1?-306674912^A>>>1:A>>>1,A=A&1?-306674912^A>>>1:A>>>1,A=A&1?-306674912^A>>>1:A>>>1,P[j]=A;return typeof Int32Array<"u"?new Int32Array(P):P}var r=t();function n(A){var P=0,j=0,J=0,N=typeof Int32Array<"u"?new Int32Array(4096):new Array(4096);for(J=0;J!=256;++J)N[J]=A[J];for(J=0;J!=256;++J)for(j=A[J],P=256+J;P<4096;P+=256)j=N[P]=j>>>8^A[j&255];var L=[];for(J=1;J!=16;++J)L[J-1]=typeof Int32Array<"u"?N.subarray(J*256,J*256+256):N.slice(J*256,J*256+256);return L}var a=n(r),i=a[0],s=a[1],o=a[2],l=a[3],c=a[4],u=a[5],f=a[6],d=a[7],h=a[8],g=a[9],m=a[10],_=a[11],y=a[12],b=a[13],w=a[14];function T(A,P){for(var j=P^-1,J=0,N=A.length;J<N;)j=j>>>8^r[(j^A.charCodeAt(J++))&255];return~j}function F(A,P){for(var j=P^-1,J=A.length-15,N=0;N<J;)j=w[A[N++]^j&255]^b[A[N++]^j>>8&255]^y[A[N++]^j>>16&255]^_[A[N++]^j>>>24]^m[A[N++]]^g[A[N++]]^h[A[N++]]^d[A[N++]]^f[A[N++]]^u[A[N++]]^c[A[N++]]^l[A[N++]]^o[A[N++]]^s[A[N++]]^i[A[N++]]^r[A[N++]];for(J+=15;N<J;)j=j>>>8^r[(j^A[N++])&255];return~j}function I(A,P){for(var j=P^-1,J=0,N=A.length,L=0,G=0;J<N;)L=A.charCodeAt(J++),L<128?j=j>>>8^r[(j^L)&255]:L<2048?(j=j>>>8^r[(j^(192|L>>6&31))&255],j=j>>>8^r[(j^(128|L&63))&255]):L>=55296&&L<57344?(L=(L&1023)+64,G=A.charCodeAt(J++)&1023,j=j>>>8^r[(j^(240|L>>8&7))&255],j=j>>>8^r[(j^(128|L>>2&63))&255],j=j>>>8^r[(j^(128|G>>6&15|(L&3)<<4))&255],j=j>>>8^r[(j^(128|G&63))&255]):(j=j>>>8^r[(j^(224|L>>12&15))&255],j=j>>>8^r[(j^(128|L>>6&63))&255],j=j>>>8^r[(j^(128|L&63))&255]);return~j}return e.table=r,e.bstr=T,e.buf=F,e.str=I,e}(),Ut=function(){var t={};t.version="1.2.1";function r(z,ue){for(var te=z.split("/"),ne=ue.split("/"),ce=0,fe=0,ke=Math.min(te.length,ne.length);ce<ke;++ce){if(fe=te[ce].length-ne[ce].length)return fe;if(te[ce]!=ne[ce])return te[ce]<ne[ce]?-1:1}return te.length-ne.length}function n(z){if(z.charAt(z.length-1)=="/")return z.slice(0,-1).indexOf("/")===-1?z:n(z.slice(0,-1));var ue=z.lastIndexOf("/");return ue===-1?z:z.slice(0,ue+1)}function a(z){if(z.charAt(z.length-1)=="/")return a(z.slice(0,-1));var ue=z.lastIndexOf("/");return ue===-1?z:z.slice(ue+1)}function i(z,ue){typeof ue=="string"&&(ue=new Date(ue));var te=ue.getHours();te=te<<6|ue.getMinutes(),te=te<<5|ue.getSeconds()>>>1,z.write_shift(2,te);var ne=ue.getFullYear()-1980;ne=ne<<4|ue.getMonth()+1,ne=ne<<5|ue.getDate(),z.write_shift(2,ne)}function s(z){var ue=z.read_shift(2)&65535,te=z.read_shift(2)&65535,ne=new Date,ce=te&31;te>>>=5;var fe=te&15;te>>>=4,ne.setMilliseconds(0),ne.setFullYear(te+1980),ne.setMonth(fe-1),ne.setDate(ce);var ke=ue&31;ue>>>=5;var Le=ue&63;return ue>>>=6,ne.setHours(ue),ne.setMinutes(Le),ne.setSeconds(ke<<1),ne}function o(z){bn(z,0);for(var ue={},te=0;z.l<=z.length-4;){var ne=z.read_shift(2),ce=z.read_shift(2),fe=z.l+ce,ke={};switch(ne){case 21589:te=z.read_shift(1),te&1&&(ke.mtime=z.read_shift(4)),ce>5&&(te&2&&(ke.atime=z.read_shift(4)),te&4&&(ke.ctime=z.read_shift(4))),ke.mtime&&(ke.mt=new Date(ke.mtime*1e3));break}z.l=fe,ue[ne]=ke}return ue}var l;function c(){return l||(l={})}function u(z,ue){if(z[0]==80&&z[1]==75)return gr(z,ue);if((z[0]|32)==109&&(z[1]|32)==105)return Ha(z,ue);if(z.length<512)throw new Error("CFB file size "+z.length+" < 512");var te=3,ne=512,ce=0,fe=0,ke=0,Le=0,Se=0,Ne=[],Pe=z.slice(0,512);bn(Pe,0);var Ve=f(Pe);switch(te=Ve[0],te){case 3:ne=512;break;case 4:ne=4096;break;case 0:if(Ve[1]==0)return gr(z,ue);default:throw new Error("Major Version: Expected 3 or 4 saw "+te)}ne!==512&&(Pe=z.slice(0,ne),bn(Pe,28));var Ke=z.slice(0,ne);d(Pe,te);var rt=Pe.read_shift(4,"i");if(te===3&&rt!==0)throw new Error("# Directory Sectors: Expected 0 saw "+rt);Pe.l+=4,ke=Pe.read_shift(4,"i"),Pe.l+=4,Pe.chk("00100000","Mini Stream Cutoff Size: "),Le=Pe.read_shift(4,"i"),ce=Pe.read_shift(4,"i"),Se=Pe.read_shift(4,"i"),fe=Pe.read_shift(4,"i");for(var qe=-1,tt=0;tt<109&&(qe=Pe.read_shift(4,"i"),!(qe<0));++tt)Ne[tt]=qe;var _t=h(z,ne);_(Se,fe,_t,ne,Ne);var Yt=b(_t,ke,Ne,ne);Yt[ke].name="!Directory",ce>0&&Le!==G&&(Yt[Le].name="!MiniFAT"),Yt[Ne[0]].name="!FAT",Yt.fat_addrs=Ne,Yt.ssz=ne;var nr={},Hr=[],pi=[],ws=[];w(ke,Yt,_t,Hr,ce,nr,pi,Le),g(pi,ws,Hr),Hr.shift();var Ki={FileIndex:pi,FullPaths:ws};return ue&&ue.raw&&(Ki.raw={header:Ke,sectors:_t}),Ki}function f(z){if(z[z.l]==80&&z[z.l+1]==75)return[0,0];z.chk(W,"Header Signature: "),z.l+=16;var ue=z.read_shift(2,"u");return[z.read_shift(2,"u"),ue]}function d(z,ue){var te=9;switch(z.l+=2,te=z.read_shift(2)){case 9:if(ue!=3)throw new Error("Sector Shift: Expected 9 saw "+te);break;case 12:if(ue!=4)throw new Error("Sector Shift: Expected 12 saw "+te);break;default:throw new Error("Sector Shift: Expected 9 or 12 saw "+te)}z.chk("0600","Mini Sector Shift: "),z.chk("000000000000","Reserved: ")}function h(z,ue){for(var te=Math.ceil(z.length/ue)-1,ne=[],ce=1;ce<te;++ce)ne[ce-1]=z.slice(ce*ue,(ce+1)*ue);return ne[te-1]=z.slice(te*ue),ne}function g(z,ue,te){for(var ne=0,ce=0,fe=0,ke=0,Le=0,Se=te.length,Ne=[],Pe=[];ne<Se;++ne)Ne[ne]=Pe[ne]=ne,ue[ne]=te[ne];for(;Le<Pe.length;++Le)ne=Pe[Le],ce=z[ne].L,fe=z[ne].R,ke=z[ne].C,Ne[ne]===ne&&(ce!==-1&&Ne[ce]!==ce&&(Ne[ne]=Ne[ce]),fe!==-1&&Ne[fe]!==fe&&(Ne[ne]=Ne[fe])),ke!==-1&&(Ne[ke]=ne),ce!==-1&&ne!=Ne[ne]&&(Ne[ce]=Ne[ne],Pe.lastIndexOf(ce)<Le&&Pe.push(ce)),fe!==-1&&ne!=Ne[ne]&&(Ne[fe]=Ne[ne],Pe.lastIndexOf(fe)<Le&&Pe.push(fe));for(ne=1;ne<Se;++ne)Ne[ne]===ne&&(fe!==-1&&Ne[fe]!==fe?Ne[ne]=Ne[fe]:ce!==-1&&Ne[ce]!==ce&&(Ne[ne]=Ne[ce]));for(ne=1;ne<Se;++ne)if(z[ne].type!==0){if(Le=ne,Le!=Ne[Le])do Le=Ne[Le],ue[ne]=ue[Le]+"/"+ue[ne];while(Le!==0&&Ne[Le]!==-1&&Le!=Ne[Le]);Ne[ne]=-1}for(ue[0]+="/",ne=1;ne<Se;++ne)z[ne].type!==2&&(ue[ne]+="/")}function m(z,ue,te){for(var ne=z.start,ce=z.size,fe=[],ke=ne;te&&ce>0&&ke>=0;)fe.push(ue.slice(ke*L,ke*L+L)),ce-=L,ke=jl(te,ke*4);return fe.length===0?rn(0):jo(fe).slice(0,z.size)}function _(z,ue,te,ne,ce){var fe=G;if(z===G){if(ue!==0)throw new Error("DIFAT chain shorter than expected")}else if(z!==-1){var ke=te[z],Le=(ne>>>2)-1;if(!ke)return;for(var Se=0;Se<Le&&(fe=jl(ke,Se*4))!==G;++Se)ce.push(fe);_(jl(ke,ne-4),ue-1,te,ne,ce)}}function y(z,ue,te,ne,ce){var fe=[],ke=[];ce||(ce=[]);var Le=ne-1,Se=0,Ne=0;for(Se=ue;Se>=0;){ce[Se]=!0,fe[fe.length]=Se,ke.push(z[Se]);var Pe=te[Math.floor(Se*4/ne)];if(Ne=Se*4&Le,ne<4+Ne)throw new Error("FAT boundary crossed: "+Se+" 4 "+ne);if(!z[Pe])break;Se=jl(z[Pe],Ne)}return{nodes:fe,data:z3([ke])}}function b(z,ue,te,ne){var ce=z.length,fe=[],ke=[],Le=[],Se=[],Ne=ne-1,Pe=0,Ve=0,Ke=0,rt=0;for(Pe=0;Pe<ce;++Pe)if(Le=[],Ke=Pe+ue,Ke>=ce&&(Ke-=ce),!ke[Ke]){Se=[];var qe=[];for(Ve=Ke;Ve>=0;){qe[Ve]=!0,ke[Ve]=!0,Le[Le.length]=Ve,Se.push(z[Ve]);var tt=te[Math.floor(Ve*4/ne)];if(rt=Ve*4&Ne,ne<4+rt)throw new Error("FAT boundary crossed: "+Ve+" 4 "+ne);if(!z[tt]||(Ve=jl(z[tt],rt),qe[Ve]))break}fe[Ke]={nodes:Le,data:z3([Se])}}return fe}function w(z,ue,te,ne,ce,fe,ke,Le){for(var Se=0,Ne=ne.length?2:0,Pe=ue[z].data,Ve=0,Ke=0,rt;Ve<Pe.length;Ve+=128){var qe=Pe.slice(Ve,Ve+128);bn(qe,64),Ke=qe.read_shift(2),rt=C5(qe,0,Ke-Ne),ne.push(rt);var tt={name:rt,type:qe.read_shift(1),color:qe.read_shift(1),L:qe.read_shift(4,"i"),R:qe.read_shift(4,"i"),C:qe.read_shift(4,"i"),clsid:qe.read_shift(16),state:qe.read_shift(4,"i"),start:0,size:0},_t=qe.read_shift(2)+qe.read_shift(2)+qe.read_shift(2)+qe.read_shift(2);_t!==0&&(tt.ct=T(qe,qe.l-8));var Yt=qe.read_shift(2)+qe.read_shift(2)+qe.read_shift(2)+qe.read_shift(2);Yt!==0&&(tt.mt=T(qe,qe.l-8)),tt.start=qe.read_shift(4,"i"),tt.size=qe.read_shift(4,"i"),tt.size<0&&tt.start<0&&(tt.size=tt.type=0,tt.start=G,tt.name=""),tt.type===5?(Se=tt.start,ce>0&&Se!==G&&(ue[Se].name="!StreamData")):tt.size>=4096?(tt.storage="fat",ue[tt.start]===void 0&&(ue[tt.start]=y(te,tt.start,ue.fat_addrs,ue.ssz)),ue[tt.start].name=tt.name,tt.content=ue[tt.start].data.slice(0,tt.size)):(tt.storage="minifat",tt.size<0?tt.size=0:Se!==G&&tt.start!==G&&ue[Se]&&(tt.content=m(tt,ue[Se].data,(ue[Le]||{}).data))),tt.content&&bn(tt.content,0),fe[rt]=tt,ke.push(tt)}}function T(z,ue){return new Date((Fa(z,ue+4)/1e7*Math.pow(2,32)+Fa(z,ue)/1e7-11644473600)*1e3)}function F(z,ue){return c(),u(l.readFileSync(z),ue)}function I(z,ue){var te=ue&&ue.type;switch(te||Mt&&Buffer.isBuffer(z)&&(te="buffer"),te||"base64"){case"file":return F(z,ue);case"base64":return u(Ii(Ba(z)),ue);case"binary":return u(Ii(z),ue)}return u(z,ue)}function A(z,ue){var te=ue||{},ne=te.root||"Root Entry";if(z.FullPaths||(z.FullPaths=[]),z.FileIndex||(z.FileIndex=[]),z.FullPaths.length!==z.FileIndex.length)throw new Error("inconsistent CFB structure");z.FullPaths.length===0&&(z.FullPaths[0]=ne+"/",z.FileIndex[0]={name:ne,type:5}),te.CLSID&&(z.FileIndex[0].clsid=te.CLSID),P(z)}function P(z){var ue="Sh33tJ5";if(!Ut.find(z,"/"+ue)){var te=rn(4);te[0]=55,te[1]=te[3]=50,te[2]=54,z.FileIndex.push({name:ue,type:2,content:te,size:4,L:69,R:69,C:69}),z.FullPaths.push(z.FullPaths[0]+ue),j(z)}}function j(z,ue){A(z);for(var te=!1,ne=!1,ce=z.FullPaths.length-1;ce>=0;--ce){var fe=z.FileIndex[ce];switch(fe.type){case 0:ne?te=!0:(z.FileIndex.pop(),z.FullPaths.pop());break;case 1:case 2:case 5:ne=!0,isNaN(fe.R*fe.L*fe.C)&&(te=!0),fe.R>-1&&fe.L>-1&&fe.R==fe.L&&(te=!0);break;default:te=!0;break}}if(!(!te&&!ue)){var ke=new Date(1987,1,19),Le=0,Se=Object.create?Object.create(null):{},Ne=[];for(ce=0;ce<z.FullPaths.length;++ce)Se[z.FullPaths[ce]]=!0,z.FileIndex[ce].type!==0&&Ne.push([z.FullPaths[ce],z.FileIndex[ce]]);for(ce=0;ce<Ne.length;++ce){var Pe=n(Ne[ce][0]);ne=Se[Pe],ne||(Ne.push([Pe,{name:a(Pe).replace("/",""),type:1,clsid:de,ct:ke,mt:ke,content:null}]),Se[Pe]=!0)}for(Ne.sort(function(rt,qe){return r(rt[0],qe[0])}),z.FullPaths=[],z.FileIndex=[],ce=0;ce<Ne.length;++ce)z.FullPaths[ce]=Ne[ce][0],z.FileIndex[ce]=Ne[ce][1];for(ce=0;ce<Ne.length;++ce){var Ve=z.FileIndex[ce],Ke=z.FullPaths[ce];if(Ve.name=a(Ke).replace("/",""),Ve.L=Ve.R=Ve.C=-(Ve.color=1),Ve.size=Ve.content?Ve.content.length:0,Ve.start=0,Ve.clsid=Ve.clsid||de,ce===0)Ve.C=Ne.length>1?1:-1,Ve.size=0,Ve.type=5;else if(Ke.slice(-1)=="/"){for(Le=ce+1;Le<Ne.length&&n(z.FullPaths[Le])!=Ke;++Le);for(Ve.C=Le>=Ne.length?-1:Le,Le=ce+1;Le<Ne.length&&n(z.FullPaths[Le])!=n(Ke);++Le);Ve.R=Le>=Ne.length?-1:Le,Ve.type=1}else n(z.FullPaths[ce+1]||"")==n(Ke)&&(Ve.R=ce+1),Ve.type=2}}}function J(z,ue){var te=ue||{};if(te.fileType=="mad")return pt(z,te);switch(j(z),te.fileType){case"zip":return di(z,te)}var ne=function(rt){for(var qe=0,tt=0,_t=0;_t<rt.FileIndex.length;++_t){var Yt=rt.FileIndex[_t];if(Yt.content){var nr=Yt.content.length;nr>0&&(nr<4096?qe+=nr+63>>6:tt+=nr+511>>9)}}for(var Hr=rt.FullPaths.length+3>>2,pi=qe+7>>3,ws=qe+127>>7,Ki=pi+tt+Hr+ws,mi=Ki+127>>7,Xi=mi<=109?0:Math.ceil((mi-109)/127);Ki+mi+Xi+127>>7>mi;)Xi=++mi<=109?0:Math.ceil((mi-109)/127);var Aa=[1,Xi,mi,ws,Hr,tt,qe,0];return rt.FileIndex[0].size=qe<<6,Aa[7]=(rt.FileIndex[0].start=Aa[0]+Aa[1]+Aa[2]+Aa[3]+Aa[4]+Aa[5])+(Aa[6]+7>>3),Aa}(z),ce=rn(ne[7]<<9),fe=0,ke=0;{for(fe=0;fe<8;++fe)ce.write_shift(1,le[fe]);for(fe=0;fe<8;++fe)ce.write_shift(2,0);for(ce.write_shift(2,62),ce.write_shift(2,3),ce.write_shift(2,65534),ce.write_shift(2,9),ce.write_shift(2,6),fe=0;fe<3;++fe)ce.write_shift(2,0);for(ce.write_shift(4,0),ce.write_shift(4,ne[2]),ce.write_shift(4,ne[0]+ne[1]+ne[2]+ne[3]-1),ce.write_shift(4,0),ce.write_shift(4,4096),ce.write_shift(4,ne[3]?ne[0]+ne[1]+ne[2]-1:G),ce.write_shift(4,ne[3]),ce.write_shift(-4,ne[1]?ne[0]-1:G),ce.write_shift(4,ne[1]),fe=0;fe<109;++fe)ce.write_shift(-4,fe<ne[2]?ne[1]+fe:-1)}if(ne[1])for(ke=0;ke<ne[1];++ke){for(;fe<236+ke*127;++fe)ce.write_shift(-4,fe<ne[2]?ne[1]+fe:-1);ce.write_shift(-4,ke===ne[1]-1?G:ke+1)}var Le=function(rt){for(ke+=rt;fe<ke-1;++fe)ce.write_shift(-4,fe+1);rt&&(++fe,ce.write_shift(-4,G))};for(ke=fe=0,ke+=ne[1];fe<ke;++fe)ce.write_shift(-4,X.DIFSECT);for(ke+=ne[2];fe<ke;++fe)ce.write_shift(-4,X.FATSECT);Le(ne[3]),Le(ne[4]);for(var Se=0,Ne=0,Pe=z.FileIndex[0];Se<z.FileIndex.length;++Se)Pe=z.FileIndex[Se],Pe.content&&(Ne=Pe.content.length,!(Ne<4096)&&(Pe.start=ke,Le(Ne+511>>9)));for(Le(ne[6]+7>>3);ce.l&511;)ce.write_shift(-4,X.ENDOFCHAIN);for(ke=fe=0,Se=0;Se<z.FileIndex.length;++Se)Pe=z.FileIndex[Se],Pe.content&&(Ne=Pe.content.length,!(!Ne||Ne>=4096)&&(Pe.start=ke,Le(Ne+63>>6)));for(;ce.l&511;)ce.write_shift(-4,X.ENDOFCHAIN);for(fe=0;fe<ne[4]<<2;++fe){var Ve=z.FullPaths[fe];if(!Ve||Ve.length===0){for(Se=0;Se<17;++Se)ce.write_shift(4,0);for(Se=0;Se<3;++Se)ce.write_shift(4,-1);for(Se=0;Se<12;++Se)ce.write_shift(4,0);continue}Pe=z.FileIndex[fe],fe===0&&(Pe.start=Pe.size?Pe.start-1:G);var Ke=fe===0&&te.root||Pe.name;if(Ne=2*(Ke.length+1),ce.write_shift(64,Ke,"utf16le"),ce.write_shift(2,Ne),ce.write_shift(1,Pe.type),ce.write_shift(1,Pe.color),ce.write_shift(-4,Pe.L),ce.write_shift(-4,Pe.R),ce.write_shift(-4,Pe.C),Pe.clsid)ce.write_shift(16,Pe.clsid,"hex");else for(Se=0;Se<4;++Se)ce.write_shift(4,0);ce.write_shift(4,Pe.state||0),ce.write_shift(4,0),ce.write_shift(4,0),ce.write_shift(4,0),ce.write_shift(4,0),ce.write_shift(4,Pe.start),ce.write_shift(4,Pe.size),ce.write_shift(4,0)}for(fe=1;fe<z.FileIndex.length;++fe)if(Pe=z.FileIndex[fe],Pe.size>=4096)if(ce.l=Pe.start+1<<9,Mt&&Buffer.isBuffer(Pe.content))Pe.content.copy(ce,ce.l,0,Pe.size),ce.l+=Pe.size+511&-512;else{for(Se=0;Se<Pe.size;++Se)ce.write_shift(1,Pe.content[Se]);for(;Se&511;++Se)ce.write_shift(1,0)}for(fe=1;fe<z.FileIndex.length;++fe)if(Pe=z.FileIndex[fe],Pe.size>0&&Pe.size<4096)if(Mt&&Buffer.isBuffer(Pe.content))Pe.content.copy(ce,ce.l,0,Pe.size),ce.l+=Pe.size+63&-64;else{for(Se=0;Se<Pe.size;++Se)ce.write_shift(1,Pe.content[Se]);for(;Se&63;++Se)ce.write_shift(1,0)}if(Mt)ce.l=ce.length;else for(;ce.l<ce.length;)ce.write_shift(1,0);return ce}function N(z,ue){var te=z.FullPaths.map(function(Se){return Se.toUpperCase()}),ne=te.map(function(Se){var Ne=Se.split("/");return Ne[Ne.length-(Se.slice(-1)=="/"?2:1)]}),ce=!1;ue.charCodeAt(0)===47?(ce=!0,ue=te[0].slice(0,-1)+ue):ce=ue.indexOf("/")!==-1;var fe=ue.toUpperCase(),ke=ce===!0?te.indexOf(fe):ne.indexOf(fe);if(ke!==-1)return z.FileIndex[ke];var Le=!fe.match(sf);for(fe=fe.replace(aa,""),Le&&(fe=fe.replace(sf,"!")),ke=0;ke<te.length;++ke)if((Le?te[ke].replace(sf,"!"):te[ke]).replace(aa,"")==fe||(Le?ne[ke].replace(sf,"!"):ne[ke]).replace(aa,"")==fe)return z.FileIndex[ke];return null}var L=64,G=-2,W="d0cf11e0a1b11ae1",le=[208,207,17,224,161,177,26,225],de="00000000000000000000000000000000",X={MAXREGSECT:-6,DIFSECT:-4,FATSECT:-3,ENDOFCHAIN:G,FREESECT:-1,HEADER_SIGNATURE:W,HEADER_MINOR_VERSION:"3e00",MAXREGSID:-6,NOSTREAM:-1,HEADER_CLSID:de,EntryTypes:["unknown","storage","stream","lockbytes","property","root"]};function ee(z,ue,te){c();var ne=J(z,te);l.writeFileSync(ue,ne)}function R(z){for(var ue=new Array(z.length),te=0;te<z.length;++te)ue[te]=String.fromCharCode(z[te]);return ue.join("")}function pe(z,ue){var te=J(z,ue);switch(ue&&ue.type||"buffer"){case"file":return c(),l.writeFileSync(ue.filename,te),te;case"binary":return typeof te=="string"?te:R(te);case"base64":return E3(typeof te=="string"?te:R(te));case"buffer":if(Mt)return Buffer.isBuffer(te)?te:pc(te);case"array":return typeof te=="string"?Ii(te):te}return te}var me;function E(z){try{var ue=z.InflateRaw,te=new ue;if(te._processChunk(new Uint8Array([3,0]),te._finishFlushFlag),te.bytesRead)me=z;else throw new Error("zlib does not expose bytesRead")}catch(ne){console.error("cannot use native zlib: "+(ne.message||ne))}}function D(z,ue){if(!me)return Vt(z,ue);var te=me.InflateRaw,ne=new te,ce=ne._processChunk(z.slice(z.l),ne._finishFlushFlag);return z.l+=ne.bytesRead,ce}function O(z){return me?me.deflateRawSync(z):Ze(z)}var M=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],K=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258],Y=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577];function re(z){var ue=(z<<1|z<<11)&139536|(z<<5|z<<15)&558144;return(ue>>16|ue>>8|ue)&255}for(var se=typeof Uint8Array<"u",xe=se?new Uint8Array(256):[],Ce=0;Ce<256;++Ce)xe[Ce]=re(Ce);function Z(z,ue){var te=xe[z&255];return ue<=8?te>>>8-ue:(te=te<<8|xe[z>>8&255],ue<=16?te>>>16-ue:(te=te<<8|xe[z>>16&255],te>>>24-ue))}function Ie(z,ue){var te=ue&7,ne=ue>>>3;return(z[ne]|(te<=6?0:z[ne+1]<<8))>>>te&3}function He(z,ue){var te=ue&7,ne=ue>>>3;return(z[ne]|(te<=5?0:z[ne+1]<<8))>>>te&7}function Te(z,ue){var te=ue&7,ne=ue>>>3;return(z[ne]|(te<=4?0:z[ne+1]<<8))>>>te&15}function oe(z,ue){var te=ue&7,ne=ue>>>3;return(z[ne]|(te<=3?0:z[ne+1]<<8))>>>te&31}function De(z,ue){var te=ue&7,ne=ue>>>3;return(z[ne]|(te<=1?0:z[ne+1]<<8))>>>te&127}function Xe(z,ue,te){var ne=ue&7,ce=ue>>>3,fe=(1<<te)-1,ke=z[ce]>>>ne;return te<8-ne||(ke|=z[ce+1]<<8-ne,te<16-ne)||(ke|=z[ce+2]<<16-ne,te<24-ne)||(ke|=z[ce+3]<<24-ne),ke&fe}function Be(z,ue,te){var ne=ue&7,ce=ue>>>3;return ne<=5?z[ce]|=(te&7)<<ne:(z[ce]|=te<<ne&255,z[ce+1]=(te&7)>>8-ne),ue+3}function Ge(z,ue,te){var ne=ue&7,ce=ue>>>3;return te=(te&1)<<ne,z[ce]|=te,ue+1}function Ye(z,ue,te){var ne=ue&7,ce=ue>>>3;return te<<=ne,z[ce]|=te&255,te>>>=8,z[ce+1]=te,ue+8}function Je(z,ue,te){var ne=ue&7,ce=ue>>>3;return te<<=ne,z[ce]|=te&255,te>>>=8,z[ce+1]=te&255,z[ce+2]=te>>>8,ue+16}function ot(z,ue){var te=z.length,ne=2*te>ue?2*te:ue+5,ce=0;if(te>=ue)return z;if(Mt){var fe=A3(ne);if(z.copy)z.copy(fe);else for(;ce<z.length;++ce)fe[ce]=z[ce];return fe}else if(se){var ke=new Uint8Array(ne);if(ke.set)ke.set(z);else for(;ce<te;++ce)ke[ce]=z[ce];return ke}return z.length=ne,z}function ct(z){for(var ue=new Array(z),te=0;te<z;++te)ue[te]=0;return ue}function gt(z,ue,te){var ne=1,ce=0,fe=0,ke=0,Le=0,Se=z.length,Ne=se?new Uint16Array(32):ct(32);for(fe=0;fe<32;++fe)Ne[fe]=0;for(fe=Se;fe<te;++fe)z[fe]=0;Se=z.length;var Pe=se?new Uint16Array(Se):ct(Se);for(fe=0;fe<Se;++fe)Ne[ce=z[fe]]++,ne<ce&&(ne=ce),Pe[fe]=0;for(Ne[0]=0,fe=1;fe<=ne;++fe)Ne[fe+16]=Le=Le+Ne[fe-1]<<1;for(fe=0;fe<Se;++fe)Le=z[fe],Le!=0&&(Pe[fe]=Ne[Le+16]++);var Ve=0;for(fe=0;fe<Se;++fe)if(Ve=z[fe],Ve!=0)for(Le=Z(Pe[fe],ne)>>ne-Ve,ke=(1<<ne+4-Ve)-1;ke>=0;--ke)ue[Le|ke<<Ve]=Ve&15|fe<<4;return ne}var bt=se?new Uint16Array(512):ct(512),It=se?new Uint16Array(32):ct(32);if(!se){for(var Et=0;Et<512;++Et)bt[Et]=0;for(Et=0;Et<32;++Et)It[Et]=0}(function(){for(var z=[],ue=0;ue<32;ue++)z.push(5);gt(z,It,32);var te=[];for(ue=0;ue<=143;ue++)te.push(8);for(;ue<=255;ue++)te.push(9);for(;ue<=279;ue++)te.push(7);for(;ue<=287;ue++)te.push(8);gt(te,bt,288)})();var ut=function(){for(var ue=se?new Uint8Array(32768):[],te=0,ne=0;te<Y.length-1;++te)for(;ne<Y[te+1];++ne)ue[ne]=te;for(;ne<32768;++ne)ue[ne]=29;var ce=se?new Uint8Array(259):[];for(te=0,ne=0;te<K.length-1;++te)for(;ne<K[te+1];++ne)ce[ne]=te;function fe(Le,Se){for(var Ne=0;Ne<Le.length;){var Pe=Math.min(65535,Le.length-Ne),Ve=Ne+Pe==Le.length;for(Se.write_shift(1,+Ve),Se.write_shift(2,Pe),Se.write_shift(2,~Pe&65535);Pe-- >0;)Se[Se.l++]=Le[Ne++]}return Se.l}function ke(Le,Se){for(var Ne=0,Pe=0,Ve=se?new Uint16Array(32768):[];Pe<Le.length;){var Ke=Math.min(65535,Le.length-Pe);if(Ke<10){for(Ne=Be(Se,Ne,+(Pe+Ke==Le.length)),Ne&7&&(Ne+=8-(Ne&7)),Se.l=Ne/8|0,Se.write_shift(2,Ke),Se.write_shift(2,~Ke&65535);Ke-- >0;)Se[Se.l++]=Le[Pe++];Ne=Se.l*8;continue}Ne=Be(Se,Ne,+(Pe+Ke==Le.length)+2);for(var rt=0;Ke-- >0;){var qe=Le[Pe];rt=(rt<<5^qe)&32767;var tt=-1,_t=0;if((tt=Ve[rt])&&(tt|=Pe&-32768,tt>Pe&&(tt-=32768),tt<Pe))for(;Le[tt+_t]==Le[Pe+_t]&&_t<250;)++_t;if(_t>2){qe=ce[_t],qe<=22?Ne=Ye(Se,Ne,xe[qe+1]>>1)-1:(Ye(Se,Ne,3),Ne+=5,Ye(Se,Ne,xe[qe-23]>>5),Ne+=3);var Yt=qe<8?0:qe-4>>2;Yt>0&&(Je(Se,Ne,_t-K[qe]),Ne+=Yt),qe=ue[Pe-tt],Ne=Ye(Se,Ne,xe[qe]>>3),Ne-=3;var nr=qe<4?0:qe-2>>1;nr>0&&(Je(Se,Ne,Pe-tt-Y[qe]),Ne+=nr);for(var Hr=0;Hr<_t;++Hr)Ve[rt]=Pe&32767,rt=(rt<<5^Le[Pe])&32767,++Pe;Ke-=_t-1}else qe<=143?qe=qe+48:Ne=Ge(Se,Ne,1),Ne=Ye(Se,Ne,xe[qe]),Ve[rt]=Pe&32767,++Pe}Ne=Ye(Se,Ne,0)-1}return Se.l=(Ne+7)/8|0,Se.l}return function(Se,Ne){return Se.length<8?fe(Se,Ne):ke(Se,Ne)}}();function Ze(z){var ue=rn(50+Math.floor(z.length*1.1)),te=ut(z,ue);return ue.slice(0,te)}var ze=se?new Uint16Array(32768):ct(32768),Jt=se?new Uint16Array(32768):ct(32768),dt=se?new Uint16Array(128):ct(128),Zr=1,Xt=1;function cr(z,ue){var te=oe(z,ue)+257;ue+=5;var ne=oe(z,ue)+1;ue+=5;var ce=Te(z,ue)+4;ue+=4;for(var fe=0,ke=se?new Uint8Array(19):ct(19),Le=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],Se=1,Ne=se?new Uint8Array(8):ct(8),Pe=se?new Uint8Array(8):ct(8),Ve=ke.length,Ke=0;Ke<ce;++Ke)ke[M[Ke]]=fe=He(z,ue),Se<fe&&(Se=fe),Ne[fe]++,ue+=3;var rt=0;for(Ne[0]=0,Ke=1;Ke<=Se;++Ke)Pe[Ke]=rt=rt+Ne[Ke-1]<<1;for(Ke=0;Ke<Ve;++Ke)(rt=ke[Ke])!=0&&(Le[Ke]=Pe[rt]++);var qe=0;for(Ke=0;Ke<Ve;++Ke)if(qe=ke[Ke],qe!=0){rt=xe[Le[Ke]]>>8-qe;for(var tt=(1<<7-qe)-1;tt>=0;--tt)dt[rt|tt<<qe]=qe&7|Ke<<3}var _t=[];for(Se=1;_t.length<te+ne;)switch(rt=dt[De(z,ue)],ue+=rt&7,rt>>>=3){case 16:for(fe=3+Ie(z,ue),ue+=2,rt=_t[_t.length-1];fe-- >0;)_t.push(rt);break;case 17:for(fe=3+He(z,ue),ue+=3;fe-- >0;)_t.push(0);break;case 18:for(fe=11+De(z,ue),ue+=7;fe-- >0;)_t.push(0);break;default:_t.push(rt),Se<rt&&(Se=rt);break}var Yt=_t.slice(0,te),nr=_t.slice(te);for(Ke=te;Ke<286;++Ke)Yt[Ke]=0;for(Ke=ne;Ke<30;++Ke)nr[Ke]=0;return Zr=gt(Yt,ze,286),Xt=gt(nr,Jt,30),ue}function Va(z,ue){if(z[0]==3&&!(z[1]&3))return[al(ue),2];for(var te=0,ne=0,ce=A3(ue||1<<18),fe=0,ke=ce.length>>>0,Le=0,Se=0;!(ne&1);){if(ne=He(z,te),te+=3,ne>>>1)ne>>1==1?(Le=9,Se=5):(te=cr(z,te),Le=Zr,Se=Xt);else{te&7&&(te+=8-(te&7));var Ne=z[te>>>3]|z[(te>>>3)+1]<<8;if(te+=32,Ne>0)for(!ue&&ke<fe+Ne&&(ce=ot(ce,fe+Ne),ke=ce.length);Ne-- >0;)ce[fe++]=z[te>>>3],te+=8;continue}for(;;){!ue&&ke<fe+32767&&(ce=ot(ce,fe+32767),ke=ce.length);var Pe=Xe(z,te,Le),Ve=ne>>>1==1?bt[Pe]:ze[Pe];if(te+=Ve&15,Ve>>>=4,!(Ve>>>8&255))ce[fe++]=Ve;else{if(Ve==256)break;Ve-=257;var Ke=Ve<8?0:Ve-4>>2;Ke>5&&(Ke=0);var rt=fe+K[Ve];Ke>0&&(rt+=Xe(z,te,Ke),te+=Ke),Pe=Xe(z,te,Se),Ve=ne>>>1==1?It[Pe]:Jt[Pe],te+=Ve&15,Ve>>>=4;var qe=Ve<4?0:Ve-2>>1,tt=Y[Ve];for(qe>0&&(tt+=Xe(z,te,qe),te+=qe),!ue&&ke<rt&&(ce=ot(ce,rt+100),ke=ce.length);fe<rt;)ce[fe]=ce[fe-tt],++fe}}}return ue?[ce,te+7>>>3]:[ce.slice(0,fe),te+7>>>3]}function Vt(z,ue){var te=z.slice(z.l||0),ne=Va(te,ue);return z.l+=ne[1],ne[0]}function Gi(z,ue){if(z)typeof console<"u"&&console.error(ue);else throw new Error(ue)}function gr(z,ue){var te=z;bn(te,0);var ne=[],ce=[],fe={FileIndex:ne,FullPaths:ce};A(fe,{root:ue.root});for(var ke=te.length-4;(te[ke]!=80||te[ke+1]!=75||te[ke+2]!=5||te[ke+3]!=6)&&ke>=0;)--ke;te.l=ke+4,te.l+=4;var Le=te.read_shift(2);te.l+=6;var Se=te.read_shift(4);for(te.l=Se,ke=0;ke<Le;++ke){te.l+=20;var Ne=te.read_shift(4),Pe=te.read_shift(4),Ve=te.read_shift(2),Ke=te.read_shift(2),rt=te.read_shift(2);te.l+=8;var qe=te.read_shift(4),tt=o(te.slice(te.l+Ve,te.l+Ve+Ke));te.l+=Ve+Ke+rt;var _t=te.l;te.l=qe+4,ka(te,Ne,Pe,fe,tt),te.l=_t}return fe}function ka(z,ue,te,ne,ce){z.l+=2;var fe=z.read_shift(2),ke=z.read_shift(2),Le=s(z);if(fe&8257)throw new Error("Unsupported ZIP encryption");for(var Se=z.read_shift(4),Ne=z.read_shift(4),Pe=z.read_shift(4),Ve=z.read_shift(2),Ke=z.read_shift(2),rt="",qe=0;qe<Ve;++qe)rt+=String.fromCharCode(z[z.l++]);if(Ke){var tt=o(z.slice(z.l,z.l+Ke));(tt[21589]||{}).mt&&(Le=tt[21589].mt),((ce||{})[21589]||{}).mt&&(Le=ce[21589].mt)}z.l+=Ke;var _t=z.slice(z.l,z.l+Ne);switch(ke){case 8:_t=D(z,Pe);break;case 0:break;default:throw new Error("Unsupported ZIP Compression method "+ke)}var Yt=!1;fe&8&&(Se=z.read_shift(4),Se==134695760&&(Se=z.read_shift(4),Yt=!0),Ne=z.read_shift(4),Pe=z.read_shift(4)),Ne!=ue&&Gi(Yt,"Bad compressed size: "+ue+" != "+Ne),Pe!=te&&Gi(Yt,"Bad uncompressed size: "+te+" != "+Pe),la(ne,rt,_t,{unsafe:!0,mt:Le})}function di(z,ue){var te=ue||{},ne=[],ce=[],fe=rn(1),ke=te.compression?8:0,Le=0,Se=0,Ne=0,Pe=0,Ve=0,Ke=z.FullPaths[0],rt=Ke,qe=z.FileIndex[0],tt=[],_t=0;for(Se=1;Se<z.FullPaths.length;++Se)if(rt=z.FullPaths[Se].slice(Ke.length),qe=z.FileIndex[Se],!(!qe.size||!qe.content||rt=="Sh33tJ5")){var Yt=Pe,nr=rn(rt.length);for(Ne=0;Ne<rt.length;++Ne)nr.write_shift(1,rt.charCodeAt(Ne)&127);nr=nr.slice(0,nr.l),tt[Ve]=c$.buf(qe.content,0);var Hr=qe.content;ke==8&&(Hr=O(Hr)),fe=rn(30),fe.write_shift(4,67324752),fe.write_shift(2,20),fe.write_shift(2,Le),fe.write_shift(2,ke),qe.mt?i(fe,qe.mt):fe.write_shift(4,0),fe.write_shift(-4,tt[Ve]),fe.write_shift(4,Hr.length),fe.write_shift(4,qe.content.length),fe.write_shift(2,nr.length),fe.write_shift(2,0),Pe+=fe.length,ne.push(fe),Pe+=nr.length,ne.push(nr),Pe+=Hr.length,ne.push(Hr),fe=rn(46),fe.write_shift(4,33639248),fe.write_shift(2,0),fe.write_shift(2,20),fe.write_shift(2,Le),fe.write_shift(2,ke),fe.write_shift(4,0),fe.write_shift(-4,tt[Ve]),fe.write_shift(4,Hr.length),fe.write_shift(4,qe.content.length),fe.write_shift(2,nr.length),fe.write_shift(2,0),fe.write_shift(2,0),fe.write_shift(2,0),fe.write_shift(2,0),fe.write_shift(4,0),fe.write_shift(4,Yt),_t+=fe.l,ce.push(fe),_t+=nr.length,ce.push(nr),++Ve}return fe=rn(22),fe.write_shift(4,101010256),fe.write_shift(2,0),fe.write_shift(2,0),fe.write_shift(2,Ve),fe.write_shift(2,Ve),fe.write_shift(4,_t),fe.write_shift(4,Pe),fe.write_shift(2,0),jo([jo(ne),jo(ce),fe])}var sr={htm:"text/html",xml:"text/xml",gif:"image/gif",jpg:"image/jpeg",png:"image/png",mso:"application/x-mso",thmx:"application/vnd.ms-officetheme",sh33tj5:"application/octet-stream"};function St(z,ue){if(z.ctype)return z.ctype;var te=z.name||"",ne=te.match(/\.([^\.]+)$/);return ne&&sr[ne[1]]||ue&&(ne=(te=ue).match(/[\.\\]([^\.\\])+$/),ne&&sr[ne[1]])?sr[ne[1]]:"application/octet-stream"}function qt(z){for(var ue=E3(z),te=[],ne=0;ne<ue.length;ne+=76)te.push(ue.slice(ne,ne+76));return te.join(`\r
`)+`\r
`}function ys(z){var ue=z.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF=]/g,function(Ne){var Pe=Ne.charCodeAt(0).toString(16).toUpperCase();return"="+(Pe.length==1?"0"+Pe:Pe)});ue=ue.replace(/ $/mg,"=20").replace(/\t$/mg,"=09"),ue.charAt(0)==`
`&&(ue="=0D"+ue.slice(1)),ue=ue.replace(/\r(?!\n)/mg,"=0D").replace(/\n\n/mg,`
=0A`).replace(/([^\r\n])\n/mg,"$1=0A");for(var te=[],ne=ue.split(`\r
`),ce=0;ce<ne.length;++ce){var fe=ne[ce];if(fe.length==0){te.push("");continue}for(var ke=0;ke<fe.length;){var Le=76,Se=fe.slice(ke,ke+Le);Se.charAt(Le-1)=="="?Le--:Se.charAt(Le-2)=="="?Le-=2:Se.charAt(Le-3)=="="&&(Le-=3),Se=fe.slice(ke,ke+Le),ke+=Le,ke<fe.length&&(Se+="="),te.push(Se)}}return te.join(`\r
`)}function en(z){for(var ue=[],te=0;te<z.length;++te){for(var ne=z[te];te<=z.length&&ne.charAt(ne.length-1)=="=";)ne=ne.slice(0,ne.length-1)+z[++te];ue.push(ne)}for(var ce=0;ce<ue.length;++ce)ue[ce]=ue[ce].replace(/[=][0-9A-Fa-f]{2}/g,function(fe){return String.fromCharCode(parseInt(fe.slice(1),16))});return Ii(ue.join(`\r
`))}function za(z,ue,te){for(var ne="",ce="",fe="",ke,Le=0;Le<10;++Le){var Se=ue[Le];if(!Se||Se.match(/^\s*$/))break;var Ne=Se.match(/^(.*?):\s*([^\s].*)$/);if(Ne)switch(Ne[1].toLowerCase()){case"content-location":ne=Ne[2].trim();break;case"content-type":fe=Ne[2].trim();break;case"content-transfer-encoding":ce=Ne[2].trim();break}}switch(++Le,ce.toLowerCase()){case"base64":ke=Ii(Ba(ue.slice(Le).join("")));break;case"quoted-printable":ke=en(ue.slice(Le));break;default:throw new Error("Unsupported Content-Transfer-Encoding "+ce)}var Pe=la(z,ne.slice(te.length),ke,{unsafe:!0});fe&&(Pe.ctype=fe)}function Ha(z,ue){if(R(z.slice(0,13)).toLowerCase()!="mime-version:")throw new Error("Unsupported MAD header");var te=ue&&ue.root||"",ne=(Mt&&Buffer.isBuffer(z)?z.toString("binary"):R(z)).split(`\r
`),ce=0,fe="";for(ce=0;ce<ne.length;++ce)if(fe=ne[ce],!!/^Content-Location:/i.test(fe)&&(fe=fe.slice(fe.indexOf("file")),te||(te=fe.slice(0,fe.lastIndexOf("/")+1)),fe.slice(0,te.length)!=te))for(;te.length>0&&(te=te.slice(0,te.length-1),te=te.slice(0,te.lastIndexOf("/")+1),fe.slice(0,te.length)!=te););var ke=(ne[1]||"").match(/boundary="(.*?)"/);if(!ke)throw new Error("MAD cannot find boundary");var Le="--"+(ke[1]||""),Se=[],Ne=[],Pe={FileIndex:Se,FullPaths:Ne};A(Pe);var Ve,Ke=0;for(ce=0;ce<ne.length;++ce){var rt=ne[ce];rt!==Le&&rt!==Le+"--"||(Ke++&&za(Pe,ne.slice(Ve,ce),te),Ve=ce)}return Pe}function pt(z,ue){var te=ue||{},ne=te.boundary||"SheetJS";ne="------="+ne;for(var ce=["MIME-Version: 1.0",'Content-Type: multipart/related; boundary="'+ne.slice(2)+'"',"","",""],fe=z.FullPaths[0],ke=fe,Le=z.FileIndex[0],Se=1;Se<z.FullPaths.length;++Se)if(ke=z.FullPaths[Se].slice(fe.length),Le=z.FileIndex[Se],!(!Le.size||!Le.content||ke=="Sh33tJ5")){ke=ke.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF]/g,function(_t){return"_x"+_t.charCodeAt(0).toString(16)+"_"}).replace(/[\u0080-\uFFFF]/g,function(_t){return"_u"+_t.charCodeAt(0).toString(16)+"_"});for(var Ne=Le.content,Pe=Mt&&Buffer.isBuffer(Ne)?Ne.toString("binary"):R(Ne),Ve=0,Ke=Math.min(1024,Pe.length),rt=0,qe=0;qe<=Ke;++qe)(rt=Pe.charCodeAt(qe))>=32&&rt<128&&++Ve;var tt=Ve>=Ke*4/5;ce.push(ne),ce.push("Content-Location: "+(te.root||"file:///C:/SheetJS/")+ke),ce.push("Content-Transfer-Encoding: "+(tt?"quoted-printable":"base64")),ce.push("Content-Type: "+St(Le,ke)),ce.push(""),ce.push(tt?ys(Pe):qt(Pe))}return ce.push(ne+`--\r
`),ce.join(`\r
`)}function Ea(z){var ue={};return A(ue,z),ue}function la(z,ue,te,ne){var ce=ne&&ne.unsafe;ce||A(z);var fe=!ce&&Ut.find(z,ue);if(!fe){var ke=z.FullPaths[0];ue.slice(0,ke.length)==ke?ke=ue:(ke.slice(-1)!="/"&&(ke+="/"),ke=(ke+ue).replace("//","/")),fe={name:a(ue),type:2},z.FileIndex.push(fe),z.FullPaths.push(ke),ce||Ut.utils.cfb_gc(z)}return fe.content=te,fe.size=te?te.length:0,ne&&(ne.CLSID&&(fe.clsid=ne.CLSID),ne.mt&&(fe.mt=ne.mt),ne.ct&&(fe.ct=ne.ct)),fe}function An(z,ue){A(z);var te=Ut.find(z,ue);if(te){for(var ne=0;ne<z.FileIndex.length;++ne)if(z.FileIndex[ne]==te)return z.FileIndex.splice(ne,1),z.FullPaths.splice(ne,1),!0}return!1}function Ir(z,ue,te){A(z);var ne=Ut.find(z,ue);if(ne){for(var ce=0;ce<z.FileIndex.length;++ce)if(z.FileIndex[ce]==ne)return z.FileIndex[ce].name=a(te),z.FullPaths[ce]=te,!0}return!1}function Tr(z){j(z,!0)}return t.find=N,t.read=I,t.parse=u,t.write=pe,t.writeFile=ee,t.utils={cfb_new:Ea,cfb_add:la,cfb_del:An,cfb_mov:Ir,cfb_gc:Tr,ReadShift:Nf,CheckField:UA,prep_blob:bn,bconcat:jo,use_zlib:E,_deflateRaw:Ze,_inflateRaw:Vt,consts:X},t}();function u$(e){if(typeof Deno<"u")return Deno.readFileSync(e);if(typeof $<"u"&&typeof File<"u"&&typeof Folder<"u")try{var t=File(e);t.open("r"),t.encoding="binary";var r=t.read();return t.close(),r}catch(n){if(!n.message||!n.message.match(/onstruct/))throw n}throw new Error("Cannot access file "+e)}function ds(e){for(var t=Object.keys(e),r=[],n=0;n<t.length;++n)Object.prototype.hasOwnProperty.call(e,t[n])&&r.push(t[n]);return r}function k5(e){for(var t=[],r=ds(e),n=0;n!==r.length;++n)t[e[r[n]]]=r[n];return t}var D1=new Date(1899,11,30,0,0,0);function ia(e,t){var r=e.getTime(),n=D1.getTime()+(e.getTimezoneOffset()-D1.getTimezoneOffset())*6e4;return(r-n)/(24*60*60*1e3)}var yA=new Date,f$=D1.getTime()+(yA.getTimezoneOffset()-D1.getTimezoneOffset())*6e4,I3=yA.getTimezoneOffset();function Im(e){var t=new Date;return t.setTime(e*24*60*60*1e3+f$),t.getTimezoneOffset()!==I3&&t.setTime(t.getTime()+(t.getTimezoneOffset()-I3)*6e4),t}function h$(e){var t=0,r=0,n=!1,a=e.match(/P([0-9\.]+Y)?([0-9\.]+M)?([0-9\.]+D)?T([0-9\.]+H)?([0-9\.]+M)?([0-9\.]+S)?/);if(!a)throw new Error("|"+e+"| is not an ISO8601 Duration");for(var i=1;i!=a.length;++i)if(a[i]){switch(r=1,i>3&&(n=!0),a[i].slice(a[i].length-1)){case"Y":throw new Error("Unsupported ISO Duration Field: "+a[i].slice(a[i].length-1));case"D":r*=24;case"H":r*=60;case"M":if(n)r*=60;else throw new Error("Unsupported ISO Duration Field: M")}t+=r*parseInt(a[i],10)}return t}var D3=new Date("2017-02-19T19:06:09.000Z"),wA=isNaN(D3.getFullYear())?new Date("2/19/17"):D3,d$=wA.getFullYear()==2017;function xn(e,t){var r=new Date(e);if(d$)return t>0?r.setTime(r.getTime()+r.getTimezoneOffset()*60*1e3):t<0&&r.setTime(r.getTime()-r.getTimezoneOffset()*60*1e3),r;if(e instanceof Date)return e;if(wA.getFullYear()==1917&&!isNaN(r.getFullYear())){var n=r.getFullYear();return e.indexOf(""+n)>-1||r.setFullYear(r.getFullYear()+100),r}var a=e.match(/\d+/g)||["2017","2","19","0","0","0"],i=new Date(+a[0],+a[1]-1,+a[2],+a[3]||0,+a[4]||0,+a[5]||0);return e.indexOf("Z")>-1&&(i=new Date(i.getTime()-i.getTimezoneOffset()*60*1e3)),i}function ic(e,t){if(Mt&&Buffer.isBuffer(e)){if(t){if(e[0]==255&&e[1]==254)return lf(e.slice(2).toString("utf16le"));if(e[1]==254&&e[2]==255)return lf(sA(e.slice(2).toString("binary")))}return e.toString("binary")}if(typeof TextDecoder<"u")try{if(t){if(e[0]==255&&e[1]==254)return lf(new TextDecoder("utf-16le").decode(e.slice(2)));if(e[0]==254&&e[1]==255)return lf(new TextDecoder("utf-16be").decode(e.slice(2)))}var r={"":"","":"",:"","":"","":"","":"","":"","":"","":"",:"","":"",:"",:"","":"","":"","":"","":"","":"","":"","":"","":"","":"",:"","":"",:"",:"",:""};return Array.isArray(e)&&(e=new Uint8Array(e)),new TextDecoder("latin1").decode(e).replace(/[]/g,function(i){return r[i]||i})}catch{}for(var n=[],a=0;a!=e.length;++a)n.push(String.fromCharCode(e[a]));return n.join("")}function Sn(e){if(typeof JSON<"u"&&!Array.isArray(e))return JSON.parse(JSON.stringify(e));if(typeof e!="object"||e==null)return e;if(e instanceof Date)return new Date(e.getTime());var t={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=Sn(e[r]));return t}function Fr(e,t){for(var r="";r.length<t;)r+=e;return r}function $i(e){var t=Number(e);if(!isNaN(t))return isFinite(t)?t:NaN;if(!/\d/.test(e))return t;var r=1,n=e.replace(/([\d]),([\d])/g,"$1$2").replace(/[$]/g,"").replace(/[%]/g,function(){return r*=100,""});return!isNaN(t=Number(n))||(n=n.replace(/[(](.*)[)]/,function(a,i){return r=-r,i}),!isNaN(t=Number(n)))?t/r:t}var p$=["january","february","march","april","may","june","july","august","september","october","november","december"];function Yu(e){var t=new Date(e),r=new Date(NaN),n=t.getYear(),a=t.getMonth(),i=t.getDate();if(isNaN(i))return r;var s=e.toLowerCase();if(s.match(/jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec/)){if(s=s.replace(/[^a-z]/g,"").replace(/([^a-z]|^)[ap]m?([^a-z]|$)/,""),s.length>3&&p$.indexOf(s)==-1)return r}else if(s.match(/[a-z]/))return r;return n<0||n>8099?r:(a>0||i>1)&&n!=101?t:e.match(/[^-0-9:,\/\\]/)?r:t}var m$=function(){var e="abacaba".split(/(:?b)/i).length==5;return function(r,n,a){if(e||typeof n=="string")return r.split(n);for(var i=r.split(n),s=[i[0]],o=1;o<i.length;++o)s.push(a),s.push(i[o]);return s}}();function bA(e){return e?e.content&&e.type?ic(e.content,!0):e.data?af(e.data):e.asNodeBuffer&&Mt?af(e.asNodeBuffer().toString("binary")):e.asBinary?af(e.asBinary()):e._data&&e._data.getContent?af(ic(Array.prototype.slice.call(e._data.getContent(),0))):null:null}function _A(e){if(!e)return null;if(e.data)return S3(e.data);if(e.asNodeBuffer&&Mt)return e.asNodeBuffer();if(e._data&&e._data.getContent){var t=e._data.getContent();return typeof t=="string"?S3(t):Array.prototype.slice.call(t)}return e.content&&e.type?e.content:null}function g$(e){return e&&e.name.slice(-4)===".bin"?_A(e):bA(e)}function ri(e,t){for(var r=e.FullPaths||ds(e.files),n=t.toLowerCase().replace(/[\/]/g,"\\"),a=n.replace(/\\/g,"/"),i=0;i<r.length;++i){var s=r[i].replace(/^Root Entry[\/]/,"").toLowerCase();if(n==s||a==s)return e.files?e.files[r[i]]:e.FileIndex[i]}return null}function E5(e,t){var r=ri(e,t);if(r==null)throw new Error("Cannot find file "+t+" in zip");return r}function Yr(e,t,r){if(!r)return g$(E5(e,t));if(!t)return null;try{return Yr(e,t)}catch{return null}}function Oa(e,t,r){if(!r)return bA(E5(e,t));if(!t)return null;try{return Oa(e,t)}catch{return null}}function x$(e,t,r){return _A(E5(e,t))}function j3(e){for(var t=e.FullPaths||ds(e.files),r=[],n=0;n<t.length;++n)t[n].slice(-1)!="/"&&r.push(t[n].replace(/^Root Entry[\/]/,""));return r.sort()}function v$(e,t,r){if(e.FullPaths){if(typeof r=="string"){var n;return Mt?n=pc(r):n=RU(r),Ut.utils.cfb_add(e,t,n)}Ut.utils.cfb_add(e,t,r)}else e.file(t,r)}function SA(e,t){switch(t.type){case"base64":return Ut.read(e,{type:"base64"});case"binary":return Ut.read(e,{type:"binary"});case"buffer":case"array":return Ut.read(e,{type:"buffer"})}throw new Error("Unrecognized type "+t.type)}function of(e,t){if(e.charAt(0)=="/")return e.slice(1);var r=t.split("/");t.slice(-1)!="/"&&r.pop();for(var n=e.split("/");n.length!==0;){var a=n.shift();a===".."?r.pop():a!=="."&&r.push(a)}return r.join("/")}var kA=`<?xml version="1.0" encoding="UTF-8" standalone="yes"?>\r
`,y$=/([^"\s?>\/]+)\s*=\s*((?:")([^"]*)(?:")|(?:')([^']*)(?:')|([^'">\s]+))/g,R3=/<[\/\?]?[a-zA-Z0-9:_-]+(?:\s+[^"\s?>\/]+\s*=\s*(?:"[^"]*"|'[^']*'|[^'">\s=]+))*\s*[\/\?]?>/mg,w$=/<[^>]*>/g,Gn=kA.match(R3)?R3:w$,b$=/<\w*:/,_$=/<(\/?)\w+:/;function wt(e,t,r){for(var n={},a=0,i=0;a!==e.length&&!((i=e.charCodeAt(a))===32||i===10||i===13);++a);if(t||(n[0]=e.slice(0,a)),a===e.length)return n;var s=e.match(y$),o=0,l="",c=0,u="",f="",d=1;if(s)for(c=0;c!=s.length;++c){for(f=s[c],i=0;i!=f.length&&f.charCodeAt(i)!==61;++i);for(u=f.slice(0,i).trim();f.charCodeAt(i+1)==32;)++i;for(d=(a=f.charCodeAt(i+1))==34||a==39?1:0,l=f.slice(i+1+d,f.length-d),o=0;o!=u.length&&u.charCodeAt(o)!==58;++o);if(o===u.length)u.indexOf("_")>0&&(u=u.slice(0,u.indexOf("_"))),n[u]=l,n[u.toLowerCase()]=l;else{var h=(o===5&&u.slice(0,5)==="xmlns"?"xmlns":"")+u.slice(o+1);if(n[h]&&u.slice(o-3,o)=="ext")continue;n[h]=l,n[h.toLowerCase()]=l}}return n}function gs(e){return e.replace(_$,"<$1")}var EA={"&quot;":'"',"&apos;":"'","&gt;":">","&lt;":"<","&amp;":"&"},S$=k5(EA),Wt=function(){var e=/&(?:quot|apos|gt|lt|amp|#x?([\da-fA-F]+));/ig,t=/_x([\da-fA-F]{4})_/ig;return function r(n){var a=n+"",i=a.indexOf("<![CDATA[");if(i==-1)return a.replace(e,function(o,l){return EA[o]||String.fromCharCode(parseInt(l,o.indexOf("x")>-1?16:10))||o}).replace(t,function(o,l){return String.fromCharCode(parseInt(l,16))});var s=a.indexOf("]]>");return r(a.slice(0,i))+a.slice(i+9,s)+r(a.slice(s+3))}}(),k$=/[&<>'"]/g,E$=/[\u0000-\u001f]/g;function A5(e){var t=e+"";return t.replace(k$,function(r){return S$[r]}).replace(/\n/g,"<br/>").replace(E$,function(r){return"&#x"+("000"+r.charCodeAt(0).toString(16)).slice(-4)+";"})}var M3=function(){var e=/&#(\d+);/g;function t(r,n){return String.fromCharCode(parseInt(n,10))}return function(n){return n.replace(e,t)}}();function wr(e){switch(e){case 1:case!0:case"1":case"true":case"TRUE":return!0;default:return!1}}function y2(e){for(var t="",r=0,n=0,a=0,i=0,s=0,o=0;r<e.length;){if(n=e.charCodeAt(r++),n<128){t+=String.fromCharCode(n);continue}if(a=e.charCodeAt(r++),n>191&&n<224){s=(n&31)<<6,s|=a&63,t+=String.fromCharCode(s);continue}if(i=e.charCodeAt(r++),n<240){t+=String.fromCharCode((n&15)<<12|(a&63)<<6|i&63);continue}s=e.charCodeAt(r++),o=((n&7)<<18|(a&63)<<12|(i&63)<<6|s&63)-65536,t+=String.fromCharCode(55296+(o>>>10&1023)),t+=String.fromCharCode(56320+(o&1023))}return t}function B3(e){var t=al(2*e.length),r,n,a=1,i=0,s=0,o;for(n=0;n<e.length;n+=a)a=1,(o=e.charCodeAt(n))<128?r=o:o<224?(r=(o&31)*64+(e.charCodeAt(n+1)&63),a=2):o<240?(r=(o&15)*4096+(e.charCodeAt(n+1)&63)*64+(e.charCodeAt(n+2)&63),a=3):(a=4,r=(o&7)*262144+(e.charCodeAt(n+1)&63)*4096+(e.charCodeAt(n+2)&63)*64+(e.charCodeAt(n+3)&63),r-=65536,s=55296+(r>>>10&1023),r=56320+(r&1023)),s!==0&&(t[i++]=s&255,t[i++]=s>>>8,s=0),t[i++]=r%256,t[i++]=r>>>8;return t.slice(0,i).toString("ucs2")}function U3(e){return pc(e,"binary").toString("utf8")}var fp="foo bar baz",mr=Mt&&(U3(fp)==y2(fp)&&U3||B3(fp)==y2(fp)&&B3)||y2,lf=Mt?function(e){return pc(e,"utf8").toString("binary")}:function(e){for(var t=[],r=0,n=0,a=0;r<e.length;)switch(n=e.charCodeAt(r++),!0){case n<128:t.push(String.fromCharCode(n));break;case n<2048:t.push(String.fromCharCode(192+(n>>6))),t.push(String.fromCharCode(128+(n&63)));break;case(n>=55296&&n<57344):n-=55296,a=e.charCodeAt(r++)-56320+(n<<10),t.push(String.fromCharCode(240+(a>>18&7))),t.push(String.fromCharCode(144+(a>>12&63))),t.push(String.fromCharCode(128+(a>>6&63))),t.push(String.fromCharCode(128+(a&63)));break;default:t.push(String.fromCharCode(224+(n>>12))),t.push(String.fromCharCode(128+(n>>6&63))),t.push(String.fromCharCode(128+(n&63)))}return t.join("")},mh=function(){var e={};return function(r,n){var a=r+"|"+(n||"");return e[a]?e[a]:e[a]=new RegExp("<(?:\\w+:)?"+r+'(?: xml:space="preserve")?(?:[^>]*)>([\\s\\S]*?)</(?:\\w+:)?'+r+">",n||"")}}(),AA=function(){var e=[["nbsp"," "],["middot",""],["quot",'"'],["apos","'"],["gt",">"],["lt","<"],["amp","&"]].map(function(t){return[new RegExp("&"+t[0]+";","ig"),t[1]]});return function(r){for(var n=r.replace(/^[\t\n\r ]+/,"").replace(/[\t\n\r ]+$/,"").replace(/>\s+/g,">").replace(/\s+</g,"<").replace(/[\t\n\r ]+/g," ").replace(/<\s*[bB][rR]\s*\/?>/g,`
`).replace(/<[^>]*>/g,""),a=0;a<e.length;++a)n=n.replace(e[a][0],e[a][1]);return n}}(),A$=function(){var e={};return function(r){return e[r]!==void 0?e[r]:e[r]=new RegExp("<(?:vt:)?"+r+">([\\s\\S]*?)</(?:vt:)?"+r+">","g")}}(),T$=/<\/?(?:vt:)?variant>/g,C$=/<(?:vt:)([^>]*)>([\s\S]*)</;function $3(e,t){var r=wt(e),n=e.match(A$(r.baseType))||[],a=[];if(n.length!=r.size){if(t.WTF)throw new Error("unexpected vector length "+n.length+" != "+r.size);return a}return n.forEach(function(i){var s=i.replace(T$,"").match(C$);s&&a.push({v:mr(s[2]),t:s[1]})}),a}var N$=/(^\s|\s$|\n)/;function P$(e){return ds(e).map(function(t){return" "+t+'="'+e[t]+'"'}).join("")}function L$(e,t,r){return"<"+e+(r!=null?P$(r):"")+(t!=null?(t.match(N$)?' xml:space="preserve"':"")+">"+t+"</"+e:"/")+">"}function T5(e){if(Mt&&Buffer.isBuffer(e))return e.toString("utf8");if(typeof e=="string")return e;if(typeof Uint8Array<"u"&&e instanceof Uint8Array)return mr(mc(b5(e)));throw new Error("Bad input format: expected Buffer or string")}var gh=/<(\/?)([^\s?><!\/:]*:|)([^\s?<>:\/]+)(?:[\s?:\/][^>]*)?>/mg,F$={CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/metadata/core-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/custom-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/extended-properties",CT:"http://schemas.openxmlformats.org/package/2006/content-types",RELS:"http://schemas.openxmlformats.org/package/2006/relationships",TCMNT:"http://schemas.microsoft.com/office/spreadsheetml/2018/threadedcomments",dc:"http://purl.org/dc/elements/1.1/",dcterms:"http://purl.org/dc/terms/",dcmitype:"http://purl.org/dc/dcmitype/",mx:"http://schemas.microsoft.com/office/mac/excel/2008/main",r:"http://schemas.openxmlformats.org/officeDocument/2006/relationships",sjs:"http://schemas.openxmlformats.org/package/2006/sheetjs/core-properties",vt:"http://schemas.openxmlformats.org/officeDocument/2006/docPropsVTypes",xsi:"http://www.w3.org/2001/XMLSchema-instance",xsd:"http://www.w3.org/2001/XMLSchema"},O$=["http://schemas.openxmlformats.org/spreadsheetml/2006/main","http://purl.oclc.org/ooxml/spreadsheetml/main","http://schemas.microsoft.com/office/excel/2006/main","http://schemas.microsoft.com/office/excel/2006/2"];function I$(e,t){for(var r=1-2*(e[t+7]>>>7),n=((e[t+7]&127)<<4)+(e[t+6]>>>4&15),a=e[t+6]&15,i=5;i>=0;--i)a=a*256+e[t+i];return n==2047?a==0?r*(1/0):NaN:(n==0?n=-1022:(n-=1023,a+=Math.pow(2,52)),r*Math.pow(2,n-52)*a)}function D$(e,t,r){var n=(t<0||1/t==-1/0?1:0)<<7,a=0,i=0,s=n?-t:t;isFinite(s)?s==0?a=i=0:(a=Math.floor(Math.log(s)/Math.LN2),i=s*Math.pow(2,52-a),a<=-1023&&(!isFinite(i)||i<Math.pow(2,52))?a=-1022:(i-=Math.pow(2,52),a+=1023)):(a=2047,i=isNaN(t)?26985:0);for(var o=0;o<=5;++o,i/=256)e[r+o]=i&255;e[r+6]=(a&15)<<4|i&15,e[r+7]=a>>4|n}var V3=function(e){for(var t=[],r=10240,n=0;n<e[0].length;++n)if(e[0][n])for(var a=0,i=e[0][n].length;a<i;a+=r)t.push.apply(t,e[0][n].slice(a,a+r));return t},z3=Mt?function(e){return e[0].length>0&&Buffer.isBuffer(e[0][0])?Buffer.concat(e[0].map(function(t){return Buffer.isBuffer(t)?t:pc(t)})):V3(e)}:V3,H3=function(e,t,r){for(var n=[],a=t;a<r;a+=2)n.push(String.fromCharCode(Bs(e,a)));return n.join("").replace(aa,"")},C5=Mt?function(e,t,r){return Buffer.isBuffer(e)?e.toString("utf16le",t,r).replace(aa,""):H3(e,t,r)}:H3,W3=function(e,t,r){for(var n=[],a=t;a<t+r;++a)n.push(("0"+e[a].toString(16)).slice(-2));return n.join("")},TA=Mt?function(e,t,r){return Buffer.isBuffer(e)?e.toString("hex",t,t+r):W3(e,t,r)}:W3,q3=function(e,t,r){for(var n=[],a=t;a<r;a++)n.push(String.fromCharCode(eu(e,a)));return n.join("")},$h=Mt?function(t,r,n){return Buffer.isBuffer(t)?t.toString("utf8",r,n):q3(t,r,n)}:q3,CA=function(e,t){var r=Fa(e,t);return r>0?$h(e,t+4,t+4+r-1):""},NA=CA,PA=function(e,t){var r=Fa(e,t);return r>0?$h(e,t+4,t+4+r-1):""},LA=PA,FA=function(e,t){var r=2*Fa(e,t);return r>0?$h(e,t+4,t+4+r-1):""},OA=FA,IA=function(t,r){var n=Fa(t,r);return n>0?C5(t,r+4,r+4+n):""},DA=IA,jA=function(e,t){var r=Fa(e,t);return r>0?$h(e,t+4,t+4+r):""},RA=jA,MA=function(e,t){return I$(e,t)},j1=MA,BA=function(t){return Array.isArray(t)||typeof Uint8Array<"u"&&t instanceof Uint8Array};Mt&&(NA=function(t,r){if(!Buffer.isBuffer(t))return CA(t,r);var n=t.readUInt32LE(r);return n>0?t.toString("utf8",r+4,r+4+n-1):""},LA=function(t,r){if(!Buffer.isBuffer(t))return PA(t,r);var n=t.readUInt32LE(r);return n>0?t.toString("utf8",r+4,r+4+n-1):""},OA=function(t,r){if(!Buffer.isBuffer(t))return FA(t,r);var n=2*t.readUInt32LE(r);return t.toString("utf16le",r+4,r+4+n-1)},DA=function(t,r){if(!Buffer.isBuffer(t))return IA(t,r);var n=t.readUInt32LE(r);return t.toString("utf16le",r+4,r+4+n)},RA=function(t,r){if(!Buffer.isBuffer(t))return jA(t,r);var n=t.readUInt32LE(r);return t.toString("utf8",r+4,r+4+n)},j1=function(t,r){return Buffer.isBuffer(t)?t.readDoubleLE(r):MA(t,r)},BA=function(t){return Buffer.isBuffer(t)||Array.isArray(t)||typeof Uint8Array<"u"&&t instanceof Uint8Array});var eu=function(e,t){return e[t]},Bs=function(e,t){return e[t+1]*256+e[t]},j$=function(e,t){var r=e[t+1]*256+e[t];return r<32768?r:(65535-r+1)*-1},Fa=function(e,t){return e[t+3]*(1<<24)+(e[t+2]<<16)+(e[t+1]<<8)+e[t]},jl=function(e,t){return e[t+3]<<24|e[t+2]<<16|e[t+1]<<8|e[t]},R$=function(e,t){return e[t]<<24|e[t+1]<<16|e[t+2]<<8|e[t+3]};function Nf(e,t){var r="",n,a,i=[],s,o,l,c;switch(t){case"dbcs":if(c=this.l,Mt&&Buffer.isBuffer(this))r=this.slice(this.l,this.l+2*e).toString("utf16le");else for(l=0;l<e;++l)r+=String.fromCharCode(Bs(this,c)),c+=2;e*=2;break;case"utf8":r=$h(this,this.l,this.l+e);break;case"utf16le":e*=2,r=C5(this,this.l,this.l+e);break;case"wstr":return Nf.call(this,e,"dbcs");case"lpstr-ansi":r=NA(this,this.l),e=4+Fa(this,this.l);break;case"lpstr-cp":r=LA(this,this.l),e=4+Fa(this,this.l);break;case"lpwstr":r=OA(this,this.l),e=4+2*Fa(this,this.l);break;case"lpp4":e=4+Fa(this,this.l),r=DA(this,this.l),e&2&&(e+=2);break;case"8lpp4":e=4+Fa(this,this.l),r=RA(this,this.l),e&3&&(e+=4-(e&3));break;case"cstr":for(e=0,r="";(s=eu(this,this.l+e++))!==0;)i.push(up(s));r=i.join("");break;case"_wstr":for(e=0,r="";(s=Bs(this,this.l+e))!==0;)i.push(up(s)),e+=2;e+=2,r=i.join("");break;case"dbcs-cont":for(r="",c=this.l,l=0;l<e;++l){if(this.lens&&this.lens.indexOf(c)!==-1)return s=eu(this,c),this.l=c+1,o=Nf.call(this,e-l,s?"dbcs-cont":"sbcs-cont"),i.join("")+o;i.push(up(Bs(this,c))),c+=2}r=i.join(""),e*=2;break;case"cpstr":case"sbcs-cont":for(r="",c=this.l,l=0;l!=e;++l){if(this.lens&&this.lens.indexOf(c)!==-1)return s=eu(this,c),this.l=c+1,o=Nf.call(this,e-l,s?"dbcs-cont":"sbcs-cont"),i.join("")+o;i.push(up(eu(this,c))),c+=1}r=i.join("");break;default:switch(e){case 1:return n=eu(this,this.l),this.l++,n;case 2:return n=(t==="i"?j$:Bs)(this,this.l),this.l+=2,n;case 4:case-4:return t==="i"||!(this[this.l+3]&128)?(n=(e>0?jl:R$)(this,this.l),this.l+=4,n):(a=Fa(this,this.l),this.l+=4,a);case 8:case-8:if(t==="f")return e==8?a=j1(this,this.l):a=j1([this[this.l+7],this[this.l+6],this[this.l+5],this[this.l+4],this[this.l+3],this[this.l+2],this[this.l+1],this[this.l+0]],0),this.l+=8,a;e=8;case 16:r=TA(this,this.l,e);break}}return this.l+=e,r}var M$=function(e,t,r){e[r]=t&255,e[r+1]=t>>>8&255,e[r+2]=t>>>16&255,e[r+3]=t>>>24&255},B$=function(e,t,r){e[r]=t&255,e[r+1]=t>>8&255,e[r+2]=t>>16&255,e[r+3]=t>>24&255},U$=function(e,t,r){e[r]=t&255,e[r+1]=t>>>8&255};function $$(e,t,r){var n=0,a=0;if(r==="dbcs"){for(a=0;a!=t.length;++a)U$(this,t.charCodeAt(a),this.l+2*a);n=2*t.length}else if(r==="sbcs"){for(t=t.replace(/[^\x00-\x7F]/g,"_"),a=0;a!=t.length;++a)this[this.l+a]=t.charCodeAt(a)&255;n=t.length}else if(r==="hex"){for(;a<e;++a)this[this.l++]=parseInt(t.slice(2*a,2*a+2),16)||0;return this}else if(r==="utf16le"){var i=Math.min(this.l+e,this.length);for(a=0;a<Math.min(t.length,e);++a){var s=t.charCodeAt(a);this[this.l++]=s&255,this[this.l++]=s>>8}for(;this.l<i;)this[this.l++]=0;return this}else switch(e){case 1:n=1,this[this.l]=t&255;break;case 2:n=2,this[this.l]=t&255,t>>>=8,this[this.l+1]=t&255;break;case 3:n=3,this[this.l]=t&255,t>>>=8,this[this.l+1]=t&255,t>>>=8,this[this.l+2]=t&255;break;case 4:n=4,M$(this,t,this.l);break;case 8:if(n=8,r==="f"){D$(this,t,this.l);break}case 16:break;case-4:n=4,B$(this,t,this.l);break}return this.l+=n,this}function UA(e,t){var r=TA(this,this.l,e.length>>1);if(r!==e)throw new Error(t+"Expected "+e+" saw "+r);this.l+=e.length>>1}function bn(e,t){e.l=t,e.read_shift=Nf,e.chk=UA,e.write_shift=$$}function qn(e,t){e.l+=t}function rn(e){var t=al(e);return bn(t,0),t}function ao(e,t,r){if(e){var n,a,i;bn(e,e.l||0);for(var s=e.length,o=0,l=0;e.l<s;){o=e.read_shift(1),o&128&&(o=(o&127)+((e.read_shift(1)&127)<<7));var c=V1[o]||V1[65535];for(n=e.read_shift(1),i=n&127,a=1;a<4&&n&128;++a)i+=((n=e.read_shift(1))&127)<<7*a;l=e.l+i;var u=c.f&&c.f(e,i,r);if(e.l=l,t(u,c,o))return}}}function dv(){var e=[],t=Mt?256:2048,r=function(c){var u=rn(c);return bn(u,0),u},n=r(t),a=function(){n&&(n.length>n.l&&(n=n.slice(0,n.l),n.l=n.length),n.length>0&&e.push(n),n=null)},i=function(c){return n&&c<n.length-n.l?n:(a(),n=r(Math.max(c+1,t)))},s=function(){return a(),jo(e)},o=function(c){a(),n=c,n.l==null&&(n.l=n.length),i(t)};return{next:i,push:o,end:s,_bufs:e}}function Pf(e,t,r){var n=Sn(e);if(t.s?(n.cRel&&(n.c+=t.s.c),n.rRel&&(n.r+=t.s.r)):(n.cRel&&(n.c+=t.c),n.rRel&&(n.r+=t.r)),!r||r.biff<12){for(;n.c>=256;)n.c-=256;for(;n.r>=65536;)n.r-=65536}return n}function G3(e,t,r){var n=Sn(e);return n.s=Pf(n.s,t.s,r),n.e=Pf(n.e,t.s,r),n}function Lf(e,t){if(e.cRel&&e.c<0)for(e=Sn(e);e.c<0;)e.c+=t>8?16384:256;if(e.rRel&&e.r<0)for(e=Sn(e);e.r<0;)e.r+=t>8?1048576:t>5?65536:16384;var r=Nt(e);return!e.cRel&&e.cRel!=null&&(r=H$(r)),!e.rRel&&e.rRel!=null&&(r=V$(r)),r}function w2(e,t){return e.s.r==0&&!e.s.rRel&&e.e.r==(t.biff>=12?1048575:t.biff>=8?65536:16384)&&!e.e.rRel?(e.s.cRel?"":"$")+sn(e.s.c)+":"+(e.e.cRel?"":"$")+sn(e.e.c):e.s.c==0&&!e.s.cRel&&e.e.c==(t.biff>=12?16383:255)&&!e.e.cRel?(e.s.rRel?"":"$")+kn(e.s.r)+":"+(e.e.rRel?"":"$")+kn(e.e.r):Lf(e.s,t.biff)+":"+Lf(e.e,t.biff)}function N5(e){return parseInt(z$(e),10)-1}function kn(e){return""+(e+1)}function V$(e){return e.replace(/([A-Z]|^)(\d+)$/,"$1$$$2")}function z$(e){return e.replace(/\$(\d+)$/,"$1")}function P5(e){for(var t=W$(e),r=0,n=0;n!==t.length;++n)r=26*r+t.charCodeAt(n)-64;return r-1}function sn(e){if(e<0)throw new Error("invalid column "+e);var t="";for(++e;e;e=Math.floor((e-1)/26))t=String.fromCharCode((e-1)%26+65)+t;return t}function H$(e){return e.replace(/^([A-Z])/,"$$$1")}function W$(e){return e.replace(/^\$([A-Z])/,"$1")}function q$(e){return e.replace(/(\$?[A-Z]*)(\$?\d*)/,"$1,$2").split(",")}function ra(e){for(var t=0,r=0,n=0;n<e.length;++n){var a=e.charCodeAt(n);a>=48&&a<=57?t=10*t+(a-48):a>=65&&a<=90&&(r=26*r+(a-64))}return{c:r-1,r:t-1}}function Nt(e){for(var t=e.c+1,r="";t;t=(t-1)/26|0)r=String.fromCharCode((t-1)%26+65)+r;return r+(e.r+1)}function o0(e){var t=e.indexOf(":");return t==-1?{s:ra(e),e:ra(e)}:{s:ra(e.slice(0,t)),e:ra(e.slice(t+1))}}function $t(e,t){return typeof t>"u"||typeof t=="number"?$t(e.s,e.e):(typeof e!="string"&&(e=Nt(e)),typeof t!="string"&&(t=Nt(t)),e==t?e:e+":"+t)}function Or(e){var t={s:{c:0,r:0},e:{c:0,r:0}},r=0,n=0,a=0,i=e.length;for(r=0;n<i&&!((a=e.charCodeAt(n)-64)<1||a>26);++n)r=26*r+a;for(t.s.c=--r,r=0;n<i&&!((a=e.charCodeAt(n)-48)<0||a>9);++n)r=10*r+a;if(t.s.r=--r,n===i||a!=10)return t.e.c=t.s.c,t.e.r=t.s.r,t;for(++n,r=0;n!=i&&!((a=e.charCodeAt(n)-64)<1||a>26);++n)r=26*r+a;for(t.e.c=--r,r=0;n!=i&&!((a=e.charCodeAt(n)-48)<0||a>9);++n)r=10*r+a;return t.e.r=--r,t}function K3(e,t){var r=e.t=="d"&&t instanceof Date;if(e.z!=null)try{return e.w=fi(e.z,r?ia(t):t)}catch{}try{return e.w=fi((e.XF||{}).numFmtId||(r?14:0),r?ia(t):t)}catch{return""+t}}function eo(e,t,r){return e==null||e.t==null||e.t=="z"?"":e.w!==void 0?e.w:(e.t=="d"&&!e.z&&r&&r.dateNF&&(e.z=r.dateNF),e.t=="e"?vc[e.v]||e.v:t==null?K3(e,e.v):K3(e,t))}function pl(e,t){var r=t&&t.sheet?t.sheet:"Sheet1",n={};return n[r]=e,{SheetNames:[r],Sheets:n}}function $A(e,t,r){var n=r||{},a=e?Array.isArray(e):n.dense,i=e||(a?[]:{}),s=0,o=0;if(i&&n.origin!=null){if(typeof n.origin=="number")s=n.origin;else{var l=typeof n.origin=="string"?ra(n.origin):n.origin;s=l.r,o=l.c}i["!ref"]||(i["!ref"]="A1:A1")}var c={s:{c:1e7,r:1e7},e:{c:0,r:0}};if(i["!ref"]){var u=Or(i["!ref"]);c.s.c=u.s.c,c.s.r=u.s.r,c.e.c=Math.max(c.e.c,u.e.c),c.e.r=Math.max(c.e.r,u.e.r),s==-1&&(c.e.r=s=u.e.r+1)}for(var f=0;f!=t.length;++f)if(t[f]){if(!Array.isArray(t[f]))throw new Error("aoa_to_sheet expects an array of arrays");for(var d=0;d!=t[f].length;++d)if(!(typeof t[f][d]>"u")){var h={v:t[f][d]},g=s+f,m=o+d;if(c.s.r>g&&(c.s.r=g),c.s.c>m&&(c.s.c=m),c.e.r<g&&(c.e.r=g),c.e.c<m&&(c.e.c=m),t[f][d]&&typeof t[f][d]=="object"&&!Array.isArray(t[f][d])&&!(t[f][d]instanceof Date))h=t[f][d];else if(Array.isArray(h.v)&&(h.f=t[f][d][1],h.v=h.v[0]),h.v===null)if(h.f)h.t="n";else if(n.nullError)h.t="e",h.v=0;else if(n.sheetStubs)h.t="z";else continue;else typeof h.v=="number"?h.t="n":typeof h.v=="boolean"?h.t="b":h.v instanceof Date?(h.z=n.dateNF||Ot[14],n.cellDates?(h.t="d",h.w=fi(h.z,ia(h.v))):(h.t="n",h.v=ia(h.v),h.w=fi(h.z,h.v))):h.t="s";if(a)i[g]||(i[g]=[]),i[g][m]&&i[g][m].z&&(h.z=i[g][m].z),i[g][m]=h;else{var _=Nt({c:m,r:g});i[_]&&i[_].z&&(h.z=i[_].z),i[_]=h}}}return c.s.c<1e7&&(i["!ref"]=$t(c)),i}function l0(e,t){return $A(null,e,t)}function G$(e){return e.read_shift(4,"i")}function Hn(e){var t=e.read_shift(4);return t===0?"":e.read_shift(t,"dbcs")}function K$(e){return{ich:e.read_shift(2),ifnt:e.read_shift(2)}}function L5(e,t){var r=e.l,n=e.read_shift(1),a=Hn(e),i=[],s={t:a,h:a};if(n&1){for(var o=e.read_shift(4),l=0;l!=o;++l)i.push(K$(e));s.r=i}else s.r=[{ich:0,ifnt:0}];return e.l=r+t,s}var X$=L5;function hi(e){var t=e.read_shift(4),r=e.read_shift(2);return r+=e.read_shift(1)<<16,e.l++,{c:t,iStyleRef:r}}function gc(e){var t=e.read_shift(2);return t+=e.read_shift(1)<<16,e.l++,{c:-1,iStyleRef:t}}var Y$=Hn;function F5(e){var t=e.read_shift(4);return t===0||t===4294967295?"":e.read_shift(t,"dbcs")}var J$=Hn,pv=F5;function O5(e){var t=e.slice(e.l,e.l+4),r=t[0]&1,n=t[0]&2;e.l+=4;var a=n===0?j1([0,0,0,0,t[0]&252,t[1],t[2],t[3]],0):jl(t,0)>>2;return r?a/100:a}function VA(e){var t={s:{},e:{}};return t.s.r=e.read_shift(4),t.e.r=e.read_shift(4),t.s.c=e.read_shift(4),t.e.c=e.read_shift(4),t}var xc=VA;function $n(e){if(e.length-e.l<8)throw"XLS Xnum Buffer underflow";return e.read_shift(8,"f")}function Q$(e){var t={},r=e.read_shift(1),n=r>>>1,a=e.read_shift(1),i=e.read_shift(2,"i"),s=e.read_shift(1),o=e.read_shift(1),l=e.read_shift(1);switch(e.l++,n){case 0:t.auto=1;break;case 1:t.index=a;var c=Yl[a];c&&(t.rgb=vh(c));break;case 2:t.rgb=vh([s,o,l]);break;case 3:t.theme=a;break}return i!=0&&(t.tint=i>0?i/32767:i/32768),t}function Z$(e){var t=e.read_shift(1);e.l++;var r={fBold:t&1,fItalic:t&2,fUnderline:t&4,fStrikeout:t&8,fOutline:t&16,fShadow:t&32,fCondense:t&64,fExtend:t&128};return r}function zA(e,t){var r={2:"BITMAP",3:"METAFILEPICT",8:"DIB",14:"ENHMETAFILE"},n=e.read_shift(4);switch(n){case 0:return"";case 4294967295:case 4294967294:return r[e.read_shift(4)]||""}if(n>400)throw new Error("Unsupported Clipboard: "+n.toString(16));return e.l-=4,e.read_shift(0,t==1?"lpstr":"lpwstr")}function eV(e){return zA(e,1)}function tV(e){return zA(e,2)}var I5=2,ma=3,hp=11,X3=12,R1=19,dp=64,rV=65,nV=71,aV=4108,iV=4126,dn=80,HA=81,sV=[dn,HA],oV={1:{n:"CodePage",t:I5},2:{n:"Category",t:dn},3:{n:"PresentationFormat",t:dn},4:{n:"ByteCount",t:ma},5:{n:"LineCount",t:ma},6:{n:"ParagraphCount",t:ma},7:{n:"SlideCount",t:ma},8:{n:"NoteCount",t:ma},9:{n:"HiddenCount",t:ma},10:{n:"MultimediaClipCount",t:ma},11:{n:"ScaleCrop",t:hp},12:{n:"HeadingPairs",t:aV},13:{n:"TitlesOfParts",t:iV},14:{n:"Manager",t:dn},15:{n:"Company",t:dn},16:{n:"LinksUpToDate",t:hp},17:{n:"CharacterCount",t:ma},19:{n:"SharedDoc",t:hp},22:{n:"HyperlinksChanged",t:hp},23:{n:"AppVersion",t:ma,p:"version"},24:{n:"DigSig",t:rV},26:{n:"ContentType",t:dn},27:{n:"ContentStatus",t:dn},28:{n:"Language",t:dn},29:{n:"Version",t:dn},255:{},2147483648:{n:"Locale",t:R1},2147483651:{n:"Behavior",t:R1},1919054434:{}},lV={1:{n:"CodePage",t:I5},2:{n:"Title",t:dn},3:{n:"Subject",t:dn},4:{n:"Author",t:dn},5:{n:"Keywords",t:dn},6:{n:"Comments",t:dn},7:{n:"Template",t:dn},8:{n:"LastAuthor",t:dn},9:{n:"RevNumber",t:dn},10:{n:"EditTime",t:dp},11:{n:"LastPrinted",t:dp},12:{n:"CreatedDate",t:dp},13:{n:"ModifiedDate",t:dp},14:{n:"PageCount",t:ma},15:{n:"WordCount",t:ma},16:{n:"CharCount",t:ma},17:{n:"Thumbnail",t:nV},18:{n:"Application",t:dn},19:{n:"DocSecurity",t:ma},255:{},2147483648:{n:"Locale",t:R1},2147483651:{n:"Behavior",t:R1},1919054434:{}},Y3={1:"US",2:"CA",3:"",7:"RU",20:"EG",30:"GR",31:"NL",32:"BE",33:"FR",34:"ES",36:"HU",39:"IT",41:"CH",43:"AT",44:"GB",45:"DK",46:"SE",47:"NO",48:"PL",49:"DE",52:"MX",55:"BR",61:"AU",64:"NZ",66:"TH",81:"JP",82:"KR",84:"VN",86:"CN",90:"TR",105:"JS",213:"DZ",216:"MA",218:"LY",351:"PT",354:"IS",358:"FI",420:"CZ",886:"TW",961:"LB",962:"JO",963:"SY",964:"IQ",965:"KW",966:"SA",971:"AE",972:"IL",974:"QA",981:"IR",65535:"US"},cV=[null,"solid","mediumGray","darkGray","lightGray","darkHorizontal","darkVertical","darkDown","darkUp","darkGrid","darkTrellis","lightHorizontal","lightVertical","lightDown","lightUp","lightGrid","lightTrellis","gray125","gray0625"];function uV(e){return e.map(function(t){return[t>>16&255,t>>8&255,t&255]})}var fV=uV([0,16777215,16711680,65280,255,16776960,16711935,65535,0,16777215,16711680,65280,255,16776960,16711935,65535,8388608,32768,128,8421376,8388736,32896,12632256,8421504,10066431,10040166,16777164,13434879,6684774,16744576,26316,13421823,128,16711935,16776960,65535,8388736,8388608,32896,255,52479,13434879,13434828,16777113,10079487,16751052,13408767,16764057,3368703,3394764,10079232,16763904,16750848,16737792,6710937,9868950,13158,3381606,13056,3355392,10040064,10040166,3355545,3355443,16777215,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]),Yl=Sn(fV),vc={0:"#NULL!",7:"#DIV/0!",15:"#VALUE!",23:"#REF!",29:"#NAME?",36:"#NUM!",42:"#N/A",43:"#GETTING_DATA",255:"#WTF?"},WA={"#NULL!":0,"#DIV/0!":7,"#VALUE!":15,"#REF!":23,"#NAME?":29,"#NUM!":36,"#N/A":42,"#GETTING_DATA":43,"#WTF?":255},J3={"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml":"workbooks","application/vnd.ms-excel.sheet.macroEnabled.main+xml":"workbooks","application/vnd.ms-excel.sheet.binary.macroEnabled.main":"workbooks","application/vnd.ms-excel.addin.macroEnabled.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml":"sheets","application/vnd.ms-excel.worksheet":"sheets","application/vnd.ms-excel.binIndexWs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml":"charts","application/vnd.ms-excel.chartsheet":"charts","application/vnd.ms-excel.macrosheet+xml":"macros","application/vnd.ms-excel.macrosheet":"macros","application/vnd.ms-excel.intlmacrosheet":"TODO","application/vnd.ms-excel.binIndexMs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml":"dialogs","application/vnd.ms-excel.dialogsheet":"dialogs","application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml":"strs","application/vnd.ms-excel.sharedStrings":"strs","application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml":"styles","application/vnd.ms-excel.styles":"styles","application/vnd.openxmlformats-package.core-properties+xml":"coreprops","application/vnd.openxmlformats-officedocument.custom-properties+xml":"custprops","application/vnd.openxmlformats-officedocument.extended-properties+xml":"extprops","application/vnd.openxmlformats-officedocument.customXmlProperties+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.customProperty":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml":"comments","application/vnd.ms-excel.comments":"comments","application/vnd.ms-excel.threadedcomments+xml":"threadedcomments","application/vnd.ms-excel.person+xml":"people","application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml":"metadata","application/vnd.ms-excel.sheetMetadata":"metadata","application/vnd.ms-excel.pivotTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotTable+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.chart+xml":"TODO","application/vnd.ms-office.chartcolorstyle+xml":"TODO","application/vnd.ms-office.chartstyle+xml":"TODO","application/vnd.ms-office.chartex+xml":"TODO","application/vnd.ms-excel.calcChain":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.calcChain+xml":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.printerSettings":"TODO","application/vnd.ms-office.activeX":"TODO","application/vnd.ms-office.activeX+xml":"TODO","application/vnd.ms-excel.attachedToolbars":"TODO","application/vnd.ms-excel.connections":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.connections+xml":"TODO","application/vnd.ms-excel.externalLink":"links","application/vnd.openxmlformats-officedocument.spreadsheetml.externalLink+xml":"links","application/vnd.ms-excel.pivotCacheDefinition":"TODO","application/vnd.ms-excel.pivotCacheRecords":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheDefinition+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheRecords+xml":"TODO","application/vnd.ms-excel.queryTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.queryTable+xml":"TODO","application/vnd.ms-excel.userNames":"TODO","application/vnd.ms-excel.revisionHeaders":"TODO","application/vnd.ms-excel.revisionLog":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionHeaders+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionLog+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.userNames+xml":"TODO","application/vnd.ms-excel.tableSingleCells":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.tableSingleCells+xml":"TODO","application/vnd.ms-excel.slicer":"TODO","application/vnd.ms-excel.slicerCache":"TODO","application/vnd.ms-excel.slicer+xml":"TODO","application/vnd.ms-excel.slicerCache+xml":"TODO","application/vnd.ms-excel.wsSortMap":"TODO","application/vnd.ms-excel.table":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.table+xml":"TODO","application/vnd.openxmlformats-officedocument.theme+xml":"themes","application/vnd.openxmlformats-officedocument.themeOverride+xml":"TODO","application/vnd.ms-excel.Timeline+xml":"TODO","application/vnd.ms-excel.TimelineCache+xml":"TODO","application/vnd.ms-office.vbaProject":"vba","application/vnd.ms-office.vbaProjectSignature":"TODO","application/vnd.ms-office.volatileDependencies":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.volatileDependencies+xml":"TODO","application/vnd.ms-excel.controlproperties+xml":"TODO","application/vnd.openxmlformats-officedocument.model+data":"TODO","application/vnd.ms-excel.Survey+xml":"TODO","application/vnd.openxmlformats-officedocument.drawing+xml":"drawings","application/vnd.openxmlformats-officedocument.drawingml.chartshapes+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramColors+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramData+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramLayout+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramStyle+xml":"TODO","application/vnd.openxmlformats-officedocument.vmlDrawing":"TODO","application/vnd.openxmlformats-package.relationships+xml":"rels","application/vnd.openxmlformats-officedocument.oleObject":"TODO","image/png":"TODO",sheet:"js"};function hV(){return{workbooks:[],sheets:[],charts:[],dialogs:[],macros:[],rels:[],strs:[],comments:[],threadedcomments:[],links:[],coreprops:[],extprops:[],custprops:[],themes:[],styles:[],calcchains:[],vba:[],drawings:[],metadata:[],people:[],TODO:[],xmlns:""}}function dV(e){var t=hV();if(!e||!e.match)return t;var r={};if((e.match(Gn)||[]).forEach(function(n){var a=wt(n);switch(a[0].replace(b$,"<")){case"<?xml":break;case"<Types":t.xmlns=a["xmlns"+(a[0].match(/<(\w+):/)||["",""])[1]];break;case"<Default":r[a.Extension]=a.ContentType;break;case"<Override":t[J3[a.ContentType]]!==void 0&&t[J3[a.ContentType]].push(a.PartName);break}}),t.xmlns!==F$.CT)throw new Error("Unknown Namespace: "+t.xmlns);return t.calcchain=t.calcchains.length>0?t.calcchains[0]:"",t.sst=t.strs.length>0?t.strs[0]:"",t.style=t.styles.length>0?t.styles[0]:"",t.defaults=r,delete t.calcchains,t}var wu={WB:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/officeDocument",SHEET:"http://sheetjs.openxmlformats.org/officeDocument/2006/relationships/officeDocument",HLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/hyperlink",VML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/vmlDrawing",XPATH:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLinkPath",XMISS:"http://schemas.microsoft.com/office/2006/relationships/xlExternalLinkPath/xlPathMissing",XLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLink",CXML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXml",CXMLP:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXmlProps",CMNT:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/comments",CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/relationships/metadata/core-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/extended-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/custom-properties",SST:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sharedStrings",STY:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/styles",THEME:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/theme",CHART:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chart",CHARTEX:"http://schemas.microsoft.com/office/2014/relationships/chartEx",CS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chartsheet",WS:["http://schemas.openxmlformats.org/officeDocument/2006/relationships/worksheet","http://purl.oclc.org/ooxml/officeDocument/relationships/worksheet"],DS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/dialogsheet",MS:"http://schemas.microsoft.com/office/2006/relationships/xlMacrosheet",IMG:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/image",DRAW:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/drawing",XLMETA:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sheetMetadata",TCMNT:"http://schemas.microsoft.com/office/2017/10/relationships/threadedComment",PEOPLE:"http://schemas.microsoft.com/office/2017/10/relationships/person",VBA:"http://schemas.microsoft.com/office/2006/relationships/vbaProject"};function mv(e){var t=e.lastIndexOf("/");return e.slice(0,t+1)+"_rels/"+e.slice(t+1)+".rels"}function Ff(e,t){var r={"!id":{}};if(!e)return r;t.charAt(0)!=="/"&&(t="/"+t);var n={};return(e.match(Gn)||[]).forEach(function(a){var i=wt(a);if(i[0]==="<Relationship"){var s={};s.Type=i.Type,s.Target=i.Target,s.Id=i.Id,i.TargetMode&&(s.TargetMode=i.TargetMode);var o=i.TargetMode==="External"?i.Target:of(i.Target,t);r[o]=s,n[i.Id]=s}}),r["!id"]=n,r}var pV="application/vnd.oasis.opendocument.spreadsheet";function mV(e,t){for(var r=T5(e),n,a;n=gh.exec(r);)switch(n[3]){case"manifest":break;case"file-entry":if(a=wt(n[0],!1),a.path=="/"&&a.type!==pV)throw new Error("This OpenDocument is not a spreadsheet");break;case"encryption-data":case"algorithm":case"start-key-generation":case"key-derivation":throw new Error("Unsupported ODS Encryption");default:if(t&&t.WTF)throw n}}var Of=[["cp:category","Category"],["cp:contentStatus","ContentStatus"],["cp:keywords","Keywords"],["cp:lastModifiedBy","LastAuthor"],["cp:lastPrinted","LastPrinted"],["cp:revision","RevNumber"],["cp:version","Version"],["dc:creator","Author"],["dc:description","Comments"],["dc:identifier","Identifier"],["dc:language","Language"],["dc:subject","Subject"],["dc:title","Title"],["dcterms:created","CreatedDate","date"],["dcterms:modified","ModifiedDate","date"]],gV=function(){for(var e=new Array(Of.length),t=0;t<Of.length;++t){var r=Of[t],n="(?:"+r[0].slice(0,r[0].indexOf(":"))+":)"+r[0].slice(r[0].indexOf(":")+1);e[t]=new RegExp("<"+n+"[^>]*>([\\s\\S]*?)</"+n+">")}return e}();function qA(e){var t={};e=mr(e);for(var r=0;r<Of.length;++r){var n=Of[r],a=e.match(gV[r]);a!=null&&a.length>0&&(t[n[1]]=Wt(a[1])),n[2]==="date"&&t[n[1]]&&(t[n[1]]=xn(t[n[1]]))}return t}var xV=[["Application","Application","string"],["AppVersion","AppVersion","string"],["Company","Company","string"],["DocSecurity","DocSecurity","string"],["Manager","Manager","string"],["HyperlinksChanged","HyperlinksChanged","bool"],["SharedDoc","SharedDoc","bool"],["LinksUpToDate","LinksUpToDate","bool"],["ScaleCrop","ScaleCrop","bool"],["HeadingPairs","HeadingPairs","raw"],["TitlesOfParts","TitlesOfParts","raw"]];function GA(e,t,r,n){var a=[];if(typeof e=="string")a=$3(e,n);else for(var i=0;i<e.length;++i)a=a.concat(e[i].map(function(u){return{v:u}}));var s=typeof t=="string"?$3(t,n).map(function(u){return u.v}):t,o=0,l=0;if(s.length>0)for(var c=0;c!==a.length;c+=2){switch(l=+a[c+1].v,a[c].v){case"Worksheets":case"":case"":case" ":case"":case" ":case"Arbeitsbltter":case"alma Sayfalar":case"Feuilles de calcul":case"Fogli di lavoro":case"Folhas de clculo":case"Planilhas":case"Regneark":case"Hojas de clculo":case"Werkbladen":r.Worksheets=l,r.SheetNames=s.slice(o,o+l);break;case"Named Ranges":case"Rangos con nombre":case"":case"Benannte Bereiche":case"Navngivne omrder":r.NamedRanges=l,r.DefinedNames=s.slice(o,o+l);break;case"Charts":case"Diagramme":r.Chartsheets=l,r.ChartNames=s.slice(o,o+l);break}o+=l}}function vV(e,t,r){var n={};return t||(t={}),e=mr(e),xV.forEach(function(a){var i=(e.match(mh(a[0]))||[])[1];switch(a[2]){case"string":i&&(t[a[1]]=Wt(i));break;case"bool":t[a[1]]=i==="true";break;case"raw":var s=e.match(new RegExp("<"+a[0]+"[^>]*>([\\s\\S]*?)</"+a[0]+">"));s&&s.length>0&&(n[a[1]]=s[1]);break}}),n.HeadingPairs&&n.TitlesOfParts&&GA(n.HeadingPairs,n.TitlesOfParts,t,r),t}var yV=/<[^>]+>[^<]*/g;function wV(e,t){var r={},n="",a=e.match(yV);if(a)for(var i=0;i!=a.length;++i){var s=a[i],o=wt(s);switch(o[0]){case"<?xml":break;case"<Properties":break;case"<property":n=Wt(o.name);break;case"</property>":n=null;break;default:if(s.indexOf("<vt:")===0){var l=s.split(">"),c=l[0].slice(4),u=l[1];switch(c){case"lpstr":case"bstr":case"lpwstr":r[n]=Wt(u);break;case"bool":r[n]=wr(u);break;case"i1":case"i2":case"i4":case"i8":case"int":case"uint":r[n]=parseInt(u,10);break;case"r4":case"r8":case"decimal":r[n]=parseFloat(u);break;case"filetime":case"date":r[n]=xn(u);break;case"cy":case"error":r[n]=Wt(u);break;default:if(c.slice(-1)=="/")break;t.WTF&&typeof console<"u"&&console.warn("Unexpected",s,c,l)}}else if(s.slice(0,2)!=="</"){if(t.WTF)throw new Error(s)}}}return r}var bV={Title:"Title",Subject:"Subject",Author:"Author",Keywords:"Keywords",Comments:"Description",LastAuthor:"LastAuthor",RevNumber:"Revision",Application:"AppName",LastPrinted:"LastPrinted",CreatedDate:"Created",ModifiedDate:"LastSaved",Category:"Category",Manager:"Manager",Company:"Company",AppVersion:"Version",ContentStatus:"ContentStatus",Identifier:"Identifier",Language:"Language"},b2;function _V(e,t,r){b2||(b2=k5(bV)),t=b2[t]||t,e[t]=r}function D5(e){var t=e.read_shift(4),r=e.read_shift(4);return new Date((r/1e7*Math.pow(2,32)+t/1e7-11644473600)*1e3).toISOString().replace(/\.000/,"")}function KA(e,t,r){var n=e.l,a=e.read_shift(0,"lpstr-cp");if(r)for(;e.l-n&3;)++e.l;return a}function XA(e,t,r){var n=e.read_shift(0,"lpwstr");return n}function YA(e,t,r){return t===31?XA(e):KA(e,t,r)}function gv(e,t,r){return YA(e,t,r===!1?0:4)}function SV(e,t){if(!t)throw new Error("VtUnalignedString must have positive length");return YA(e,t,0)}function kV(e){for(var t=e.read_shift(4),r=[],n=0;n!=t;++n){var a=e.l;r[n]=e.read_shift(0,"lpwstr").replace(aa,""),e.l-a&2&&(e.l+=2)}return r}function EV(e){for(var t=e.read_shift(4),r=[],n=0;n!=t;++n)r[n]=e.read_shift(0,"lpstr-cp").replace(aa,"");return r}function AV(e){var t=e.l,r=M1(e,HA);e[e.l]==0&&e[e.l+1]==0&&e.l-t&2&&(e.l+=2);var n=M1(e,ma);return[r,n]}function TV(e){for(var t=e.read_shift(4),r=[],n=0;n<t/2;++n)r.push(AV(e));return r}function Q3(e,t){for(var r=e.read_shift(4),n={},a=0;a!=r;++a){var i=e.read_shift(4),s=e.read_shift(4);n[i]=e.read_shift(s,t===1200?"utf16le":"utf8").replace(aa,"").replace(sf,"!"),t===1200&&s%2&&(e.l+=2)}return e.l&3&&(e.l=e.l>>3<<2),n}function JA(e){var t=e.read_shift(4),r=e.slice(e.l,e.l+t);return e.l+=t,(t&3)>0&&(e.l+=4-(t&3)&3),r}function CV(e){var t={};return t.Size=e.read_shift(4),e.l+=t.Size+3-(t.Size-1)%4,t}function M1(e,t,r){var n=e.read_shift(2),a,i=r||{};if(e.l+=2,t!==X3&&n!==t&&sV.indexOf(t)===-1&&!((t&65534)==4126&&(n&65534)==4126))throw new Error("Expected type "+t+" saw "+n);switch(t===X3?n:t){case 2:return a=e.read_shift(2,"i"),i.raw||(e.l+=2),a;case 3:return a=e.read_shift(4,"i"),a;case 11:return e.read_shift(4)!==0;case 19:return a=e.read_shift(4),a;case 30:return KA(e,n,4).replace(aa,"");case 31:return XA(e);case 64:return D5(e);case 65:return JA(e);case 71:return CV(e);case 80:return gv(e,n,!i.raw).replace(aa,"");case 81:return SV(e,n).replace(aa,"");case 4108:return TV(e);case 4126:case 4127:return n==4127?kV(e):EV(e);default:throw new Error("TypedPropertyValue unrecognized type "+t+" "+n)}}function Z3(e,t){var r=e.l,n=e.read_shift(4),a=e.read_shift(4),i=[],s=0,o=0,l=-1,c={};for(s=0;s!=a;++s){var u=e.read_shift(4),f=e.read_shift(4);i[s]=[u,f+r]}i.sort(function(b,w){return b[1]-w[1]});var d={};for(s=0;s!=a;++s){if(e.l!==i[s][1]){var h=!0;if(s>0&&t)switch(t[i[s-1][0]].t){case 2:e.l+2===i[s][1]&&(e.l+=2,h=!1);break;case 80:e.l<=i[s][1]&&(e.l=i[s][1],h=!1);break;case 4108:e.l<=i[s][1]&&(e.l=i[s][1],h=!1);break}if((!t||s==0)&&e.l<=i[s][1]&&(h=!1,e.l=i[s][1]),h)throw new Error("Read Error: Expected address "+i[s][1]+" at "+e.l+" :"+s)}if(t){var g=t[i[s][0]];if(d[g.n]=M1(e,g.t,{raw:!0}),g.p==="version"&&(d[g.n]=String(d[g.n]>>16)+"."+("0000"+String(d[g.n]&65535)).slice(-4)),g.n=="CodePage")switch(d[g.n]){case 0:d[g.n]=1252;case 874:case 932:case 936:case 949:case 950:case 1250:case 1251:case 1253:case 1254:case 1255:case 1256:case 1257:case 1258:case 1e4:case 1200:case 1201:case 1252:case 65e3:case-536:case 65001:case-535:ji(o=d[g.n]>>>0&65535);break;default:throw new Error("Unsupported CodePage: "+d[g.n])}}else if(i[s][0]===1){if(o=d.CodePage=M1(e,I5),ji(o),l!==-1){var m=e.l;e.l=i[l][1],c=Q3(e,o),e.l=m}}else if(i[s][0]===0){if(o===0){l=s,e.l=i[s+1][1];continue}c=Q3(e,o)}else{var _=c[i[s][0]],y;switch(e[e.l]){case 65:e.l+=4,y=JA(e);break;case 30:e.l+=4,y=gv(e,e[e.l-4]).replace(/\u0000+$/,"");break;case 31:e.l+=4,y=gv(e,e[e.l-4]).replace(/\u0000+$/,"");break;case 3:e.l+=4,y=e.read_shift(4,"i");break;case 19:e.l+=4,y=e.read_shift(4);break;case 5:e.l+=4,y=e.read_shift(8,"f");break;case 11:e.l+=4,y=Mr(e,4);break;case 64:e.l+=4,y=xn(D5(e));break;default:throw new Error("unparsed value: "+e[e.l])}d[_]=y}}return e.l=r+n,d}function e_(e,t,r){var n=e.content;if(!n)return{};bn(n,0);var a,i,s,o,l=0;n.chk("feff","Byte Order: "),n.read_shift(2);var c=n.read_shift(4),u=n.read_shift(16);if(u!==Ut.utils.consts.HEADER_CLSID&&u!==r)throw new Error("Bad PropertySet CLSID "+u);if(a=n.read_shift(4),a!==1&&a!==2)throw new Error("Unrecognized #Sets: "+a);if(i=n.read_shift(16),o=n.read_shift(4),a===1&&o!==n.l)throw new Error("Length mismatch: "+o+" !== "+n.l);a===2&&(s=n.read_shift(16),l=n.read_shift(4));var f=Z3(n,t),d={SystemIdentifier:c};for(var h in f)d[h]=f[h];if(d.FMTID=i,a===1)return d;if(l-n.l==2&&(n.l+=2),n.l!==l)throw new Error("Length mismatch 2: "+n.l+" !== "+l);var g;try{g=Z3(n,null)}catch{}for(h in g)d[h]=g[h];return d.FMTID=[i,s],d}function _o(e,t){return e.read_shift(t),null}function NV(e,t,r){for(var n=[],a=e.l+t;e.l<a;)n.push(r(e,a-e.l));if(a!==e.l)throw new Error("Slurp error");return n}function Mr(e,t){return e.read_shift(t)===1}function Jr(e){return e.read_shift(2,"u")}function QA(e,t){return NV(e,t,Jr)}function PV(e){var t=e.read_shift(1),r=e.read_shift(1);return r===1?t:t===1}function Vh(e,t,r){var n=e.read_shift(r&&r.biff>=12?2:1),a="sbcs-cont";if(r&&r.biff>=8,!r||r.biff==8){var i=e.read_shift(1);i&&(a="dbcs-cont")}else r.biff==12&&(a="wstr");r.biff>=2&&r.biff<=5&&(a="cpstr");var s=n?e.read_shift(n,a):"";return s}function LV(e){var t=e.read_shift(2),r=e.read_shift(1),n=r&4,a=r&8,i=1+(r&1),s=0,o,l={};a&&(s=e.read_shift(2)),n&&(o=e.read_shift(4));var c=i==2?"dbcs-cont":"sbcs-cont",u=t===0?"":e.read_shift(t,c);return a&&(e.l+=4*s),n&&(e.l+=o),l.t=u,a||(l.raw="<t>"+l.t+"</t>",l.r=l.t),l}function sc(e,t,r){var n;if(r){if(r.biff>=2&&r.biff<=5)return e.read_shift(t,"cpstr");if(r.biff>=12)return e.read_shift(t,"dbcs-cont")}var a=e.read_shift(1);return a===0?n=e.read_shift(t,"sbcs-cont"):n=e.read_shift(t,"dbcs-cont"),n}function zh(e,t,r){var n=e.read_shift(r&&r.biff==2?1:2);return n===0?(e.l++,""):sc(e,n,r)}function yc(e,t,r){if(r.biff>5)return zh(e,t,r);var n=e.read_shift(1);return n===0?(e.l++,""):e.read_shift(n,r.biff<=4||!e.lens?"cpstr":"sbcs-cont")}function FV(e){var t=e.read_shift(1);e.l++;var r=e.read_shift(2);return e.l+=2,[t,r]}function OV(e){var t=e.read_shift(4),r=e.l,n=!1;t>24&&(e.l+=t-24,e.read_shift(16)==="795881f43b1d7f48af2c825dc4852763"&&(n=!0),e.l=r);var a=e.read_shift((n?t-24:t)>>1,"utf16le").replace(aa,"");return n&&(e.l+=24),a}function IV(e){for(var t=e.read_shift(2),r="";t-- >0;)r+="../";var n=e.read_shift(0,"lpstr-ansi");if(e.l+=2,e.read_shift(2)!=57005)throw new Error("Bad FileMoniker");var a=e.read_shift(4);if(a===0)return r+n.replace(/\\/g,"/");var i=e.read_shift(4);if(e.read_shift(2)!=3)throw new Error("Bad FileMoniker");var s=e.read_shift(i>>1,"utf16le").replace(aa,"");return r+s}function DV(e,t){var r=e.read_shift(16);switch(r){case"e0c9ea79f9bace118c8200aa004ba90b":return OV(e);case"0303000000000000c000000000000046":return IV(e);default:throw new Error("Unsupported Moniker "+r)}}function pp(e){var t=e.read_shift(4),r=t>0?e.read_shift(t,"utf16le").replace(aa,""):"";return r}function jV(e,t){var r=e.l+t,n=e.read_shift(4);if(n!==2)throw new Error("Unrecognized streamVersion: "+n);var a=e.read_shift(2);e.l+=2;var i,s,o,l,c="",u,f;a&16&&(i=pp(e,r-e.l)),a&128&&(s=pp(e,r-e.l)),(a&257)===257&&(o=pp(e,r-e.l)),(a&257)===1&&(l=DV(e,r-e.l)),a&8&&(c=pp(e,r-e.l)),a&32&&(u=e.read_shift(16)),a&64&&(f=D5(e)),e.l=r;var d=s||o||l||"";d&&c&&(d+="#"+c),d||(d="#"+c),a&2&&d.charAt(0)=="/"&&d.charAt(1)!="/"&&(d="file://"+d);var h={Target:d};return u&&(h.guid=u),f&&(h.time=f),i&&(h.Tooltip=i),h}function ZA(e){var t=e.read_shift(1),r=e.read_shift(1),n=e.read_shift(1),a=e.read_shift(1);return[t,r,n,a]}function eT(e,t){var r=ZA(e);return r[3]=0,r}function xs(e){var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(2);return{r:t,c:r,ixfe:n}}function RV(e){var t=e.read_shift(2),r=e.read_shift(2);return e.l+=8,{type:t,flags:r}}function MV(e,t,r){return t===0?"":yc(e,t,r)}function BV(e,t,r){var n=r.biff>8?4:2,a=e.read_shift(n),i=e.read_shift(n,"i"),s=e.read_shift(n,"i");return[a,i,s]}function tT(e){var t=e.read_shift(2),r=O5(e);return[t,r]}function UV(e,t,r){e.l+=4,t-=4;var n=e.l+t,a=Vh(e,t,r),i=e.read_shift(2);if(n-=e.l,i!==n)throw new Error("Malformed AddinUdf: padding = "+n+" != "+i);return e.l+=i,a}function Dm(e){var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(2),a=e.read_shift(2);return{s:{c:n,r:t},e:{c:a,r}}}function rT(e){var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(1),a=e.read_shift(1);return{s:{c:n,r:t},e:{c:a,r}}}var $V=rT;function nT(e){e.l+=4;var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(2);return e.l+=12,[r,t,n]}function VV(e){var t={};return e.l+=4,e.l+=16,t.fSharedNote=e.read_shift(2),e.l+=4,t}function zV(e){var t={};return e.l+=4,e.cf=e.read_shift(2),t}function Ln(e){e.l+=2,e.l+=e.read_shift(2)}var HV={0:Ln,4:Ln,5:Ln,6:Ln,7:zV,8:Ln,9:Ln,10:Ln,11:Ln,12:Ln,13:VV,14:Ln,15:Ln,16:Ln,17:Ln,18:Ln,19:Ln,20:Ln,21:nT};function WV(e,t){for(var r=e.l+t,n=[];e.l<r;){var a=e.read_shift(2);e.l-=2;try{n.push(HV[a](e,r-e.l))}catch{return e.l=r,n}}return e.l!=r&&(e.l=r),n}function mp(e,t){var r={BIFFVer:0,dt:0};switch(r.BIFFVer=e.read_shift(2),t-=2,t>=2&&(r.dt=e.read_shift(2),e.l-=2),r.BIFFVer){case 1536:case 1280:case 1024:case 768:case 512:case 2:case 7:break;default:if(t>6)throw new Error("Unexpected BIFF Ver "+r.BIFFVer)}return e.read_shift(t),r}function qV(e,t){return t===0||e.read_shift(2),1200}function GV(e,t,r){if(r.enc)return e.l+=t,"";var n=e.l,a=yc(e,0,r);return e.read_shift(t+n-e.l),a}function KV(e,t,r){var n=r&&r.biff==8||t==2?e.read_shift(2):(e.l+=t,0);return{fDialog:n&16,fBelow:n&64,fRight:n&128}}function XV(e,t,r){var n=e.read_shift(4),a=e.read_shift(1)&3,i=e.read_shift(1);switch(i){case 0:i="Worksheet";break;case 1:i="Macrosheet";break;case 2:i="Chartsheet";break;case 6:i="VBAModule";break}var s=Vh(e,0,r);return s.length===0&&(s="Sheet1"),{pos:n,hs:a,dt:i,name:s}}function YV(e,t){for(var r=e.l+t,n=e.read_shift(4),a=e.read_shift(4),i=[],s=0;s!=a&&e.l<r;++s)i.push(LV(e));return i.Count=n,i.Unique=a,i}function JV(e,t){var r={};return r.dsst=e.read_shift(2),e.l+=t-2,r}function QV(e){var t={};t.r=e.read_shift(2),t.c=e.read_shift(2),t.cnt=e.read_shift(2)-t.c;var r=e.read_shift(2);e.l+=4;var n=e.read_shift(1);return e.l+=3,n&7&&(t.level=n&7),n&32&&(t.hidden=!0),n&64&&(t.hpt=r/20),t}function ZV(e){var t=RV(e);if(t.type!=2211)throw new Error("Invalid Future Record "+t.type);var r=e.read_shift(4);return r!==0}function ez(e){return e.read_shift(2),e.read_shift(4)}function t_(e,t,r){var n=0;r&&r.biff==2||(n=e.read_shift(2));var a=e.read_shift(2);r&&r.biff==2&&(n=1-(a>>15),a&=32767);var i={Unsynced:n&1,DyZero:(n&2)>>1,ExAsc:(n&4)>>2,ExDsc:(n&8)>>3};return[i,a]}function tz(e){var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(2),a=e.read_shift(2),i=e.read_shift(2),s=e.read_shift(2),o=e.read_shift(2),l=e.read_shift(2),c=e.read_shift(2);return{Pos:[t,r],Dim:[n,a],Flags:i,CurTab:s,FirstTab:o,Selected:l,TabRatio:c}}function rz(e,t,r){if(r&&r.biff>=2&&r.biff<5)return{};var n=e.read_shift(2);return{RTL:n&64}}function nz(){}function az(e,t,r){var n={dyHeight:e.read_shift(2),fl:e.read_shift(2)};switch(r&&r.biff||8){case 2:break;case 3:case 4:e.l+=2;break;default:e.l+=10;break}return n.name=Vh(e,0,r),n}function iz(e){var t=xs(e);return t.isst=e.read_shift(4),t}function sz(e,t,r){r.biffguess&&r.biff==2&&(r.biff=5);var n=e.l+t,a=xs(e);r.biff==2&&e.l++;var i=zh(e,n-e.l,r);return a.val=i,a}function oz(e,t,r){var n=e.read_shift(2),a=yc(e,0,r);return[n,a]}var lz=yc;function r_(e,t,r){var n=e.l+t,a=r.biff==8||!r.biff?4:2,i=e.read_shift(a),s=e.read_shift(a),o=e.read_shift(2),l=e.read_shift(2);return e.l=n,{s:{r:i,c:o},e:{r:s,c:l}}}function cz(e){var t=e.read_shift(2),r=e.read_shift(2),n=tT(e);return{r:t,c:r,ixfe:n[0],rknum:n[1]}}function uz(e,t){for(var r=e.l+t-2,n=e.read_shift(2),a=e.read_shift(2),i=[];e.l<r;)i.push(tT(e));if(e.l!==r)throw new Error("MulRK read error");var s=e.read_shift(2);if(i.length!=s-a+1)throw new Error("MulRK length mismatch");return{r:n,c:a,C:s,rkrec:i}}function fz(e,t){for(var r=e.l+t-2,n=e.read_shift(2),a=e.read_shift(2),i=[];e.l<r;)i.push(e.read_shift(2));if(e.l!==r)throw new Error("MulBlank read error");var s=e.read_shift(2);if(i.length!=s-a+1)throw new Error("MulBlank length mismatch");return{r:n,c:a,C:s,ixfe:i}}function hz(e,t,r,n){var a={},i=e.read_shift(4),s=e.read_shift(4),o=e.read_shift(4),l=e.read_shift(2);return a.patternType=cV[o>>26],n.cellStyles&&(a.alc=i&7,a.fWrap=i>>3&1,a.alcV=i>>4&7,a.fJustLast=i>>7&1,a.trot=i>>8&255,a.cIndent=i>>16&15,a.fShrinkToFit=i>>20&1,a.iReadOrder=i>>22&2,a.fAtrNum=i>>26&1,a.fAtrFnt=i>>27&1,a.fAtrAlc=i>>28&1,a.fAtrBdr=i>>29&1,a.fAtrPat=i>>30&1,a.fAtrProt=i>>31&1,a.dgLeft=s&15,a.dgRight=s>>4&15,a.dgTop=s>>8&15,a.dgBottom=s>>12&15,a.icvLeft=s>>16&127,a.icvRight=s>>23&127,a.grbitDiag=s>>30&3,a.icvTop=o&127,a.icvBottom=o>>7&127,a.icvDiag=o>>14&127,a.dgDiag=o>>21&15,a.icvFore=l&127,a.icvBack=l>>7&127,a.fsxButton=l>>14&1),a}function dz(e,t,r){var n={};return n.ifnt=e.read_shift(2),n.numFmtId=e.read_shift(2),n.flags=e.read_shift(2),n.fStyle=n.flags>>2&1,t-=6,n.data=hz(e,t,n.fStyle,r),n}function pz(e){e.l+=4;var t=[e.read_shift(2),e.read_shift(2)];if(t[0]!==0&&t[0]--,t[1]!==0&&t[1]--,t[0]>7||t[1]>7)throw new Error("Bad Gutters: "+t.join("|"));return t}function n_(e,t,r){var n=xs(e);(r.biff==2||t==9)&&++e.l;var a=PV(e);return n.val=a,n.t=a===!0||a===!1?"b":"e",n}function mz(e,t,r){r.biffguess&&r.biff==2&&(r.biff=5);var n=xs(e),a=$n(e);return n.val=a,n}var a_=MV;function gz(e,t,r){var n=e.l+t,a=e.read_shift(2),i=e.read_shift(2);if(r.sbcch=i,i==1025||i==14849)return[i,a];if(i<1||i>255)throw new Error("Unexpected SupBook type: "+i);for(var s=sc(e,i),o=[];n>e.l;)o.push(zh(e));return[i,a,s,o]}function i_(e,t,r){var n=e.read_shift(2),a,i={fBuiltIn:n&1,fWantAdvise:n>>>1&1,fWantPict:n>>>2&1,fOle:n>>>3&1,fOleLink:n>>>4&1,cf:n>>>5&1023,fIcon:n>>>15&1};return r.sbcch===14849&&(a=UV(e,t-2,r)),i.body=a||e.read_shift(t-2),typeof a=="string"&&(i.Name=a),i}var xz=["_xlnm.Consolidate_Area","_xlnm.Auto_Open","_xlnm.Auto_Close","_xlnm.Extract","_xlnm.Database","_xlnm.Criteria","_xlnm.Print_Area","_xlnm.Print_Titles","_xlnm.Recorder","_xlnm.Data_Form","_xlnm.Auto_Activate","_xlnm.Auto_Deactivate","_xlnm.Sheet_Title","_xlnm._FilterDatabase"];function s_(e,t,r){var n=e.l+t,a=e.read_shift(2),i=e.read_shift(1),s=e.read_shift(1),o=e.read_shift(r&&r.biff==2?1:2),l=0;(!r||r.biff>=5)&&(r.biff!=5&&(e.l+=2),l=e.read_shift(2),r.biff==5&&(e.l+=2),e.l+=4);var c=sc(e,s,r);a&32&&(c=xz[c.charCodeAt(0)]);var u=n-e.l;r&&r.biff==2&&--u;var f=n==e.l||o===0||!(u>0)?[]:Qq(e,u,r,o);return{chKey:i,Name:c,itab:l,rgce:f}}function aT(e,t,r){if(r.biff<8)return vz(e,t,r);for(var n=[],a=e.l+t,i=e.read_shift(r.biff>8?4:2);i--!==0;)n.push(BV(e,r.biff>8?12:6,r));if(e.l!=a)throw new Error("Bad ExternSheet: "+e.l+" != "+a);return n}function vz(e,t,r){e[e.l+1]==3&&e[e.l]++;var n=Vh(e,t,r);return n.charCodeAt(0)==3?n.slice(1):n}function yz(e,t,r){if(r.biff<8){e.l+=t;return}var n=e.read_shift(2),a=e.read_shift(2),i=sc(e,n,r),s=sc(e,a,r);return[i,s]}function wz(e,t,r){var n=rT(e);e.l++;var a=e.read_shift(1);return t-=8,[Zq(e,t,r),a,n]}function o_(e,t,r){var n=$V(e);switch(r.biff){case 2:e.l++,t-=7;break;case 3:case 4:e.l+=2,t-=8;break;default:e.l+=6,t-=12}return[n,Yq(e,t,r)]}function bz(e){var t=e.read_shift(4)!==0,r=e.read_shift(4)!==0,n=e.read_shift(4);return[t,r,n]}function _z(e,t,r){if(!(r.biff<8)){var n=e.read_shift(2),a=e.read_shift(2),i=e.read_shift(2),s=e.read_shift(2),o=yc(e,0,r);return r.biff<8&&e.read_shift(1),[{r:n,c:a},o,s,i]}}function Sz(e,t,r){return _z(e,t,r)}function kz(e,t){for(var r=[],n=e.read_shift(2);n--;)r.push(Dm(e));return r}function Ez(e,t,r){if(r&&r.biff<8)return Tz(e,t,r);var n=nT(e),a=WV(e,t-22,n[1]);return{cmo:n,ft:a}}var Az={8:function(e,t){var r=e.l+t;e.l+=10;var n=e.read_shift(2);e.l+=4,e.l+=2,e.l+=2,e.l+=2,e.l+=4;var a=e.read_shift(1);return e.l+=a,e.l=r,{fmt:n}}};function Tz(e,t,r){e.l+=4;var n=e.read_shift(2),a=e.read_shift(2),i=e.read_shift(2);e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=6,t-=36;var s=[];return s.push((Az[n]||qn)(e,t,r)),{cmo:[a,n,i],ft:s}}function Cz(e,t,r){var n=e.l,a="";try{e.l+=4;var i=(r.lastobj||{cmo:[0,0]}).cmo[1],s;[0,5,7,11,12,14].indexOf(i)==-1?e.l+=6:s=FV(e,6,r);var o=e.read_shift(2);e.read_shift(2),Jr(e,2);var l=e.read_shift(2);e.l+=l;for(var c=1;c<e.lens.length-1;++c){if(e.l-n!=e.lens[c])throw new Error("TxO: bad continue record");var u=e[e.l],f=sc(e,e.lens[c+1]-e.lens[c]-1);if(a+=f,a.length>=(u?o:2*o))break}if(a.length!==o&&a.length!==o*2)throw new Error("cchText: "+o+" != "+a.length);return e.l=n+t,{t:a}}catch{return e.l=n+t,{t:a}}}function Nz(e,t){var r=Dm(e);e.l+=16;var n=jV(e,t-24);return[r,n]}function Pz(e,t){e.read_shift(2);var r=Dm(e),n=e.read_shift((t-10)/2,"dbcs-cont");return n=n.replace(aa,""),[r,n]}function Lz(e){var t=[0,0],r;return r=e.read_shift(2),t[0]=Y3[r]||r,r=e.read_shift(2),t[1]=Y3[r]||r,t}function Fz(e){for(var t=e.read_shift(2),r=[];t-- >0;)r.push(eT(e));return r}function Oz(e){for(var t=e.read_shift(2),r=[];t-- >0;)r.push(eT(e));return r}function Iz(e){e.l+=2;var t={cxfs:0,crc:0};return t.cxfs=e.read_shift(2),t.crc=e.read_shift(4),t}function iT(e,t,r){if(!r.cellStyles)return qn(e,t);var n=r&&r.biff>=12?4:2,a=e.read_shift(n),i=e.read_shift(n),s=e.read_shift(n),o=e.read_shift(n),l=e.read_shift(2);n==2&&(e.l+=2);var c={s:a,e:i,w:s,ixfe:o,flags:l};return(r.biff>=5||!r.biff)&&(c.level=l>>8&7),c}function Dz(e,t){var r={};return t<32||(e.l+=16,r.header=$n(e),r.footer=$n(e),e.l+=2),r}function jz(e,t,r){var n={area:!1};if(r.biff!=5)return e.l+=t,n;var a=e.read_shift(1);return e.l+=3,a&16&&(n.area=!0),n}var Rz=xs,Mz=QA,Bz=zh;function Uz(e){var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(4),a={fmt:t,env:r,len:n,data:e.slice(e.l,e.l+n)};return e.l+=n,a}function $z(e,t,r){r.biffguess&&r.biff==5&&(r.biff=2);var n=xs(e);++e.l;var a=yc(e,t-7,r);return n.t="str",n.val=a,n}function Vz(e){var t=xs(e);++e.l;var r=$n(e);return t.t="n",t.val=r,t}function zz(e){var t=xs(e);++e.l;var r=e.read_shift(2);return t.t="n",t.val=r,t}function Hz(e){var t=e.read_shift(1);return t===0?(e.l++,""):e.read_shift(t,"sbcs-cont")}function Wz(e,t){e.l+=6,e.l+=2,e.l+=1,e.l+=3,e.l+=1,e.l+=t-13}function qz(e,t,r){var n=e.l+t,a=xs(e),i=e.read_shift(2),s=sc(e,i,r);return e.l=n,a.t="str",a.val=s,a}var Gz=[2,3,48,49,131,139,140,245],l_=function(){var e={1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127,8:865,9:437,10:850,11:437,13:437,14:850,15:437,16:850,17:437,18:850,19:932,20:850,21:437,22:850,23:865,24:437,25:437,26:850,27:437,28:863,29:850,31:852,34:852,35:852,36:860,37:850,38:866,55:850,64:852,77:936,78:949,79:950,80:874,87:1252,88:1252,89:1252,108:863,134:737,135:852,136:857,204:1257,255:16969},t=k5({1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127});function r(o,l){var c=[],u=al(1);switch(l.type){case"base64":u=Ii(Ba(o));break;case"binary":u=Ii(o);break;case"buffer":case"array":u=o;break}bn(u,0);var f=u.read_shift(1),d=!!(f&136),h=!1,g=!1;switch(f){case 2:break;case 3:break;case 48:h=!0,d=!0;break;case 49:h=!0,d=!0;break;case 131:break;case 139:break;case 140:g=!0;break;case 245:break;default:throw new Error("DBF Unsupported Version: "+f.toString(16))}var m=0,_=521;f==2&&(m=u.read_shift(2)),u.l+=3,f!=2&&(m=u.read_shift(4)),m>1048576&&(m=1e6),f!=2&&(_=u.read_shift(2));var y=u.read_shift(2),b=l.codepage||1252;f!=2&&(u.l+=16,u.read_shift(1),u[u.l]!==0&&(b=e[u[u.l]]),u.l+=1,u.l+=2),g&&(u.l+=36);for(var w=[],T={},F=Math.min(u.length,f==2?521:_-10-(h?264:0)),I=g?32:11;u.l<F&&u[u.l]!=13;)switch(T={},T.name=Do.utils.decode(b,u.slice(u.l,u.l+I)).replace(/[\u0000\r\n].*$/g,""),u.l+=I,T.type=String.fromCharCode(u.read_shift(1)),f!=2&&!g&&(T.offset=u.read_shift(4)),T.len=u.read_shift(1),f==2&&(T.offset=u.read_shift(2)),T.dec=u.read_shift(1),T.name.length&&w.push(T),f!=2&&(u.l+=g?13:14),T.type){case"B":(!h||T.len!=8)&&l.WTF&&console.log("Skipping "+T.name+":"+T.type);break;case"G":case"P":l.WTF&&console.log("Skipping "+T.name+":"+T.type);break;case"+":case"0":case"@":case"C":case"D":case"F":case"I":case"L":case"M":case"N":case"O":case"T":case"Y":break;default:throw new Error("Unknown Field Type: "+T.type)}if(u[u.l]!==13&&(u.l=_-1),u.read_shift(1)!==13)throw new Error("DBF Terminator not found "+u.l+" "+u[u.l]);u.l=_;var A=0,P=0;for(c[0]=[],P=0;P!=w.length;++P)c[0][P]=w[P].name;for(;m-- >0;){if(u[u.l]===42){u.l+=y;continue}for(++u.l,c[++A]=[],P=0,P=0;P!=w.length;++P){var j=u.slice(u.l,u.l+w[P].len);u.l+=w[P].len,bn(j,0);var J=Do.utils.decode(b,j);switch(w[P].type){case"C":J.trim().length&&(c[A][P]=J.replace(/\s+$/,""));break;case"D":J.length===8?c[A][P]=new Date(+J.slice(0,4),+J.slice(4,6)-1,+J.slice(6,8)):c[A][P]=J;break;case"F":c[A][P]=parseFloat(J.trim());break;case"+":case"I":c[A][P]=g?j.read_shift(-4,"i")^2147483648:j.read_shift(4,"i");break;case"L":switch(J.trim().toUpperCase()){case"Y":case"T":c[A][P]=!0;break;case"N":case"F":c[A][P]=!1;break;case"":case"?":break;default:throw new Error("DBF Unrecognized L:|"+J+"|")}break;case"M":if(!d)throw new Error("DBF Unexpected MEMO for type "+f.toString(16));c[A][P]="##MEMO##"+(g?parseInt(J.trim(),10):j.read_shift(4));break;case"N":J=J.replace(/\u0000/g,"").trim(),J&&J!="."&&(c[A][P]=+J||0);break;case"@":c[A][P]=new Date(j.read_shift(-8,"f")-621356832e5);break;case"T":c[A][P]=new Date((j.read_shift(4)-2440588)*864e5+j.read_shift(4));break;case"Y":c[A][P]=j.read_shift(4,"i")/1e4+j.read_shift(4,"i")/1e4*Math.pow(2,32);break;case"O":c[A][P]=-j.read_shift(-8,"f");break;case"B":if(h&&w[P].len==8){c[A][P]=j.read_shift(8,"f");break}case"G":case"P":j.l+=w[P].len;break;case"0":if(w[P].name==="_NullFlags")break;default:throw new Error("DBF Unsupported data type "+w[P].type)}}}if(f!=2&&u.l<u.length&&u[u.l++]!=26)throw new Error("DBF EOF Marker missing "+(u.l-1)+" of "+u.length+" "+u[u.l-1].toString(16));return l&&l.sheetRows&&(c=c.slice(0,l.sheetRows)),l.DBF=w,c}function n(o,l){var c=l||{};c.dateNF||(c.dateNF="yyyymmdd");var u=l0(r(o,c),c);return u["!cols"]=c.DBF.map(function(f){return{wch:f.len,DBF:f}}),delete c.DBF,u}function a(o,l){try{return pl(n(o,l),l)}catch(c){if(l&&l.WTF)throw c}return{SheetNames:[],Sheets:{}}}var i={B:8,C:250,L:1,D:8,"?":0,"":0};function s(o,l){var c=l||{};if(+c.codepage>=0&&ji(+c.codepage),c.type=="string")throw new Error("Cannot write DBF to JS string");var u=dv(),f=Sv(o,{header:1,raw:!0,cellDates:!0}),d=f[0],h=f.slice(1),g=o["!cols"]||[],m=0,_=0,y=0,b=1;for(m=0;m<d.length;++m){if(((g[m]||{}).DBF||{}).name){d[m]=g[m].DBF.name,++y;continue}if(d[m]!=null){if(++y,typeof d[m]=="number"&&(d[m]=d[m].toString(10)),typeof d[m]!="string")throw new Error("DBF Invalid column name "+d[m]+" |"+typeof d[m]+"|");if(d.indexOf(d[m])!==m){for(_=0;_<1024;++_)if(d.indexOf(d[m]+"_"+_)==-1){d[m]+="_"+_;break}}}}var w=Or(o["!ref"]),T=[],F=[],I=[];for(m=0;m<=w.e.c-w.s.c;++m){var A="",P="",j=0,J=[];for(_=0;_<h.length;++_)h[_][m]!=null&&J.push(h[_][m]);if(J.length==0||d[m]==null){T[m]="?";continue}for(_=0;_<J.length;++_){switch(typeof J[_]){case"number":P="B";break;case"string":P="C";break;case"boolean":P="L";break;case"object":P=J[_]instanceof Date?"D":"C";break;default:P="C"}j=Math.max(j,String(J[_]).length),A=A&&A!=P?"C":P}j>250&&(j=250),P=((g[m]||{}).DBF||{}).type,P=="C"&&g[m].DBF.len>j&&(j=g[m].DBF.len),A=="B"&&P=="N"&&(A="N",I[m]=g[m].DBF.dec,j=g[m].DBF.len),F[m]=A=="C"||P=="N"?j:i[A]||0,b+=F[m],T[m]=A}var N=u.next(32);for(N.write_shift(4,318902576),N.write_shift(4,h.length),N.write_shift(2,296+32*y),N.write_shift(2,b),m=0;m<4;++m)N.write_shift(4,0);for(N.write_shift(4,0|(+t[aA]||3)<<8),m=0,_=0;m<d.length;++m)if(d[m]!=null){var L=u.next(32),G=(d[m].slice(-10)+"\0\0\0\0\0\0\0\0\0\0\0").slice(0,11);L.write_shift(1,G,"sbcs"),L.write_shift(1,T[m]=="?"?"C":T[m],"sbcs"),L.write_shift(4,_),L.write_shift(1,F[m]||i[T[m]]||0),L.write_shift(1,I[m]||0),L.write_shift(1,2),L.write_shift(4,0),L.write_shift(1,0),L.write_shift(4,0),L.write_shift(4,0),_+=F[m]||i[T[m]]||0}var W=u.next(264);for(W.write_shift(4,13),m=0;m<65;++m)W.write_shift(4,0);for(m=0;m<h.length;++m){var le=u.next(b);for(le.write_shift(1,0),_=0;_<d.length;++_)if(d[_]!=null)switch(T[_]){case"L":le.write_shift(1,h[m][_]==null?63:h[m][_]?84:70);break;case"B":le.write_shift(8,h[m][_]||0,"f");break;case"N":var de="0";for(typeof h[m][_]=="number"&&(de=h[m][_].toFixed(I[_]||0)),y=0;y<F[_]-de.length;++y)le.write_shift(1,32);le.write_shift(1,de,"sbcs");break;case"D":h[m][_]?(le.write_shift(4,("0000"+h[m][_].getFullYear()).slice(-4),"sbcs"),le.write_shift(2,("00"+(h[m][_].getMonth()+1)).slice(-2),"sbcs"),le.write_shift(2,("00"+h[m][_].getDate()).slice(-2),"sbcs")):le.write_shift(8,"00000000","sbcs");break;case"C":var X=String(h[m][_]!=null?h[m][_]:"").slice(0,F[_]);for(le.write_shift(1,X,"sbcs"),y=0;y<F[_]-X.length;++y)le.write_shift(1,32);break}}return u.next(1).write_shift(1,26),u.end()}return{to_workbook:a,to_sheet:n,from_sheet:s}}(),Kz=function(){var e={AA:"",BA:"",CA:"",DA:195,HA:"",JA:197,AE:"",BE:"",CE:"",HE:"",AI:"",BI:"",CI:"",HI:"",AO:"",BO:"",CO:"",DO:213,HO:"",AU:"",BU:"",CU:"",HU:"",Aa:"",Ba:"",Ca:"",Da:227,Ha:"",Ja:229,Ae:"",Be:"",Ce:"",He:"",Ai:"",Bi:"",Ci:"",Hi:"",Ao:"",Bo:"",Co:"",Do:245,Ho:"",Au:"",Bu:"",Cu:"",Hu:"",KC:"",Kc:"",q:"",z:"",a:"",j:"",DN:209,Dn:241,Hy:255,S:169,c:170,R:174,"B ":180,0:176,1:177,2:178,3:179,5:181,6:182,7:183,Q:185,k:186,b:208,i:216,l:222,s:240,y:248,"!":161,'"':162,"#":163,"(":164,"%":165,"'":167,"H ":168,"+":171,";":187,"<":188,"=":189,">":190,"?":191,"{":223},t=new RegExp("\x1BN("+ds(e).join("|").replace(/\|\|\|/,"|\\||").replace(/([?()+])/g,"\\$1")+"|\\|)","gm"),r=function(d,h){var g=e[h];return typeof g=="number"?k3(g):g},n=function(d,h,g){var m=h.charCodeAt(0)-32<<4|g.charCodeAt(0)-48;return m==59?d:k3(m)};e["|"]=254;function a(d,h){switch(h.type){case"base64":return i(Ba(d),h);case"binary":return i(d,h);case"buffer":return i(Mt&&Buffer.isBuffer(d)?d.toString("binary"):mc(d),h);case"array":return i(ic(d),h)}throw new Error("Unrecognized type "+h.type)}function i(d,h){var g=d.split(/[\n\r]+/),m=-1,_=-1,y=0,b=0,w=[],T=[],F=null,I={},A=[],P=[],j=[],J=0,N;for(+h.codepage>=0&&ji(+h.codepage);y!==g.length;++y){J=0;var L=g[y].trim().replace(/\x1B([\x20-\x2F])([\x30-\x3F])/g,n).replace(t,r),G=L.replace(/;;/g,"\0").split(";").map(function(M){return M.replace(/\u0000/g,";")}),W=G[0],le;if(L.length>0)switch(W){case"ID":break;case"E":break;case"B":break;case"O":break;case"W":break;case"P":G[1].charAt(0)=="P"&&T.push(L.slice(3).replace(/;;/g,";"));break;case"C":var de=!1,X=!1,ee=!1,R=!1,pe=-1,me=-1;for(b=1;b<G.length;++b)switch(G[b].charAt(0)){case"A":break;case"X":_=parseInt(G[b].slice(1))-1,X=!0;break;case"Y":for(m=parseInt(G[b].slice(1))-1,X||(_=0),N=w.length;N<=m;++N)w[N]=[];break;case"K":le=G[b].slice(1),le.charAt(0)==='"'?le=le.slice(1,le.length-1):le==="TRUE"?le=!0:le==="FALSE"?le=!1:isNaN($i(le))?isNaN(Yu(le).getDate())||(le=xn(le)):(le=$i(le),F!==null&&s0(F)&&(le=Im(le))),de=!0;break;case"E":R=!0;var E=Pu(G[b].slice(1),{r:m,c:_});w[m][_]=[w[m][_],E];break;case"S":ee=!0,w[m][_]=[w[m][_],"S5S"];break;case"G":break;case"R":pe=parseInt(G[b].slice(1))-1;break;case"C":me=parseInt(G[b].slice(1))-1;break;default:if(h&&h.WTF)throw new Error("SYLK bad record "+L)}if(de&&(w[m][_]&&w[m][_].length==2?w[m][_][0]=le:w[m][_]=le,F=null),ee){if(R)throw new Error("SYLK shared formula cannot have own formula");var D=pe>-1&&w[pe][me];if(!D||!D[1])throw new Error("SYLK shared formula cannot find base");w[m][_][1]=mT(D[1],{r:m-pe,c:_-me})}break;case"F":var O=0;for(b=1;b<G.length;++b)switch(G[b].charAt(0)){case"X":_=parseInt(G[b].slice(1))-1,++O;break;case"Y":for(m=parseInt(G[b].slice(1))-1,N=w.length;N<=m;++N)w[N]=[];break;case"M":J=parseInt(G[b].slice(1))/20;break;case"F":break;case"G":break;case"P":F=T[parseInt(G[b].slice(1))];break;case"S":break;case"D":break;case"N":break;case"W":for(j=G[b].slice(1).split(" "),N=parseInt(j[0],10);N<=parseInt(j[1],10);++N)J=parseInt(j[2],10),P[N-1]=J===0?{hidden:!0}:{wch:J},Ju(P[N-1]);break;case"C":_=parseInt(G[b].slice(1))-1,P[_]||(P[_]={});break;case"R":m=parseInt(G[b].slice(1))-1,A[m]||(A[m]={}),J>0?(A[m].hpt=J,A[m].hpx=yh(J)):J===0&&(A[m].hidden=!0);break;default:if(h&&h.WTF)throw new Error("SYLK bad record "+L)}O<1&&(F=null);break;default:if(h&&h.WTF)throw new Error("SYLK bad record "+L)}}return A.length>0&&(I["!rows"]=A),P.length>0&&(I["!cols"]=P),h&&h.sheetRows&&(w=w.slice(0,h.sheetRows)),[w,I]}function s(d,h){var g=a(d,h),m=g[0],_=g[1],y=l0(m,h);return ds(_).forEach(function(b){y[b]=_[b]}),y}function o(d,h){return pl(s(d,h),h)}function l(d,h,g,m){var _="C;Y"+(g+1)+";X"+(m+1)+";K";switch(d.t){case"n":_+=d.v||0,d.f&&!d.F&&(_+=";E"+IW(d.f,{r:g,c:m}));break;case"b":_+=d.v?"TRUE":"FALSE";break;case"e":_+=d.w||d.v;break;case"d":_+='"'+(d.w||d.v)+'"';break;case"s":_+='"'+d.v.replace(/"/g,"").replace(/;/g,";;")+'"';break}return _}function c(d,h){h.forEach(function(g,m){var _="F;W"+(m+1)+" "+(m+1)+" ";g.hidden?_+="0":(typeof g.width=="number"&&!g.wpx&&(g.wpx=U1(g.width)),typeof g.wpx=="number"&&!g.wch&&(g.wch=$1(g.wpx)),typeof g.wch=="number"&&(_+=Math.round(g.wch))),_.charAt(_.length-1)!=" "&&d.push(_)})}function u(d,h){h.forEach(function(g,m){var _="F;";g.hidden?_+="M0;":g.hpt?_+="M"+20*g.hpt+";":g.hpx&&(_+="M"+20*hT(g.hpx)+";"),_.length>2&&d.push(_+"R"+(m+1))})}function f(d,h){var g=["ID;PWXL;N;E"],m=[],_=Or(d["!ref"]),y,b=Array.isArray(d),w=`\r
`;g.push("P;PGeneral"),g.push("F;P0;DG0G8;M255"),d["!cols"]&&c(g,d["!cols"]),d["!rows"]&&u(g,d["!rows"]),g.push("B;Y"+(_.e.r-_.s.r+1)+";X"+(_.e.c-_.s.c+1)+";D"+[_.s.c,_.s.r,_.e.c,_.e.r].join(" "));for(var T=_.s.r;T<=_.e.r;++T)for(var F=_.s.c;F<=_.e.c;++F){var I=Nt({r:T,c:F});y=b?(d[T]||[])[F]:d[I],!(!y||y.v==null&&(!y.f||y.F))&&m.push(l(y,d,T,F))}return g.join(w)+w+m.join(w)+w+"E"+w}return{to_workbook:o,to_sheet:s,from_sheet:f}}(),Xz=function(){function e(i,s){switch(s.type){case"base64":return t(Ba(i),s);case"binary":return t(i,s);case"buffer":return t(Mt&&Buffer.isBuffer(i)?i.toString("binary"):mc(i),s);case"array":return t(ic(i),s)}throw new Error("Unrecognized type "+s.type)}function t(i,s){for(var o=i.split(`
`),l=-1,c=-1,u=0,f=[];u!==o.length;++u){if(o[u].trim()==="BOT"){f[++l]=[],c=0;continue}if(!(l<0)){var d=o[u].trim().split(","),h=d[0],g=d[1];++u;for(var m=o[u]||"";(m.match(/["]/g)||[]).length&1&&u<o.length-1;)m+=`
`+o[++u];switch(m=m.trim(),+h){case-1:if(m==="BOT"){f[++l]=[],c=0;continue}else if(m!=="EOD")throw new Error("Unrecognized DIF special command "+m);break;case 0:m==="TRUE"?f[l][c]=!0:m==="FALSE"?f[l][c]=!1:isNaN($i(g))?isNaN(Yu(g).getDate())?f[l][c]=g:f[l][c]=xn(g):f[l][c]=$i(g),++c;break;case 1:m=m.slice(1,m.length-1),m=m.replace(/""/g,'"'),m&&m.match(/^=".*"$/)&&(m=m.slice(2,-1)),f[l][c++]=m!==""?m:null;break}if(m==="EOD")break}}return s&&s.sheetRows&&(f=f.slice(0,s.sheetRows)),f}function r(i,s){return l0(e(i,s),s)}function n(i,s){return pl(r(i,s),s)}var a=function(){var i=function(l,c,u,f,d){l.push(c),l.push(u+","+f),l.push('"'+d.replace(/"/g,'""')+'"')},s=function(l,c,u,f){l.push(c+","+u),l.push(c==1?'"'+f.replace(/"/g,'""')+'"':f)};return function(l){var c=[],u=Or(l["!ref"]),f,d=Array.isArray(l);i(c,"TABLE",0,1,"sheetjs"),i(c,"VECTORS",0,u.e.r-u.s.r+1,""),i(c,"TUPLES",0,u.e.c-u.s.c+1,""),i(c,"DATA",0,0,"");for(var h=u.s.r;h<=u.e.r;++h){s(c,-1,0,"BOT");for(var g=u.s.c;g<=u.e.c;++g){var m=Nt({r:h,c:g});if(f=d?(l[h]||[])[g]:l[m],!f){s(c,1,0,"");continue}switch(f.t){case"n":var _=f.w;!_&&f.v!=null&&(_=f.v),_==null?f.f&&!f.F?s(c,1,0,"="+f.f):s(c,1,0,""):s(c,0,_,"V");break;case"b":s(c,0,f.v?1:0,f.v?"TRUE":"FALSE");break;case"s":s(c,1,0,isNaN(f.v)?f.v:'="'+f.v+'"');break;case"d":f.w||(f.w=fi(f.z||Ot[14],ia(xn(f.v)))),s(c,0,f.w,"V");break;default:s(c,1,0,"")}}}s(c,-1,0,"EOD");var y=`\r
`,b=c.join(y);return b}}();return{to_workbook:n,to_sheet:r,from_sheet:a}}(),Yz=function(){function e(f){return f.replace(/\\b/g,"\\").replace(/\\c/g,":").replace(/\\n/g,`
`)}function t(f){return f.replace(/\\/g,"\\b").replace(/:/g,"\\c").replace(/\n/g,"\\n")}function r(f,d){for(var h=f.split(`
`),g=-1,m=-1,_=0,y=[];_!==h.length;++_){var b=h[_].trim().split(":");if(b[0]==="cell"){var w=ra(b[1]);if(y.length<=w.r)for(g=y.length;g<=w.r;++g)y[g]||(y[g]=[]);switch(g=w.r,m=w.c,b[2]){case"t":y[g][m]=e(b[3]);break;case"v":y[g][m]=+b[3];break;case"vtf":var T=b[b.length-1];case"vtc":switch(b[3]){case"nl":y[g][m]=!!+b[4];break;default:y[g][m]=+b[4];break}b[2]=="vtf"&&(y[g][m]=[y[g][m],T])}}}return d&&d.sheetRows&&(y=y.slice(0,d.sheetRows)),y}function n(f,d){return l0(r(f,d),d)}function a(f,d){return pl(n(f,d),d)}var i=["socialcalc:version:1.5","MIME-Version: 1.0","Content-Type: multipart/mixed; boundary=SocialCalcSpreadsheetControlSave"].join(`
`),s=["--SocialCalcSpreadsheetControlSave","Content-type: text/plain; charset=UTF-8"].join(`
`)+`
`,o=["# SocialCalc Spreadsheet Control Save","part:sheet"].join(`
`),l="--SocialCalcSpreadsheetControlSave--";function c(f){if(!f||!f["!ref"])return"";for(var d=[],h=[],g,m="",_=o0(f["!ref"]),y=Array.isArray(f),b=_.s.r;b<=_.e.r;++b)for(var w=_.s.c;w<=_.e.c;++w)if(m=Nt({r:b,c:w}),g=y?(f[b]||[])[w]:f[m],!(!g||g.v==null||g.t==="z")){switch(h=["cell",m,"t"],g.t){case"s":case"str":h.push(t(g.v));break;case"n":g.f?(h[2]="vtf",h[3]="n",h[4]=g.v,h[5]=t(g.f)):(h[2]="v",h[3]=g.v);break;case"b":h[2]="vt"+(g.f?"f":"c"),h[3]="nl",h[4]=g.v?"1":"0",h[5]=t(g.f||(g.v?"TRUE":"FALSE"));break;case"d":var T=ia(xn(g.v));h[2]="vtc",h[3]="nd",h[4]=""+T,h[5]=g.w||fi(g.z||Ot[14],T);break;case"e":continue}d.push(h.join(":"))}return d.push("sheet:c:"+(_.e.c-_.s.c+1)+":r:"+(_.e.r-_.s.r+1)+":tvf:1"),d.push("valueformat:1:text-wiki"),d.join(`
`)}function u(f){return[i,s,o,s,c(f),l].join(`
`)}return{to_workbook:a,to_sheet:n,from_sheet:u}}(),xh=function(){function e(u,f,d,h,g){g.raw?f[d][h]=u:u===""||(u==="TRUE"?f[d][h]=!0:u==="FALSE"?f[d][h]=!1:isNaN($i(u))?isNaN(Yu(u).getDate())?f[d][h]=u:f[d][h]=xn(u):f[d][h]=$i(u))}function t(u,f){var d=f||{},h=[];if(!u||u.length===0)return h;for(var g=u.split(/[\r\n]/),m=g.length-1;m>=0&&g[m].length===0;)--m;for(var _=10,y=0,b=0;b<=m;++b)y=g[b].indexOf(" "),y==-1?y=g[b].length:y++,_=Math.max(_,y);for(b=0;b<=m;++b){h[b]=[];var w=0;for(e(g[b].slice(0,_).trim(),h,b,w,d),w=1;w<=(g[b].length-_)/10+1;++w)e(g[b].slice(_+(w-1)*10,_+w*10).trim(),h,b,w,d)}return d.sheetRows&&(h=h.slice(0,d.sheetRows)),h}var r={44:",",9:"	",59:";",124:"|"},n={44:3,9:2,59:1,124:0};function a(u){for(var f={},d=!1,h=0,g=0;h<u.length;++h)(g=u.charCodeAt(h))==34?d=!d:!d&&g in r&&(f[g]=(f[g]||0)+1);g=[];for(h in f)Object.prototype.hasOwnProperty.call(f,h)&&g.push([f[h],h]);if(!g.length){f=n;for(h in f)Object.prototype.hasOwnProperty.call(f,h)&&g.push([f[h],h])}return g.sort(function(m,_){return m[0]-_[0]||n[m[1]]-n[_[1]]}),r[g.pop()[1]]||44}function i(u,f){var d=f||{},h="",g=d.dense?[]:{},m={s:{c:0,r:0},e:{c:0,r:0}};u.slice(0,4)=="sep="?u.charCodeAt(5)==13&&u.charCodeAt(6)==10?(h=u.charAt(4),u=u.slice(7)):u.charCodeAt(5)==13||u.charCodeAt(5)==10?(h=u.charAt(4),u=u.slice(6)):h=a(u.slice(0,1024)):d&&d.FS?h=d.FS:h=a(u.slice(0,1024));var _=0,y=0,b=0,w=0,T=0,F=h.charCodeAt(0),I=!1,A=0,P=u.charCodeAt(0);u=u.replace(/\r\n/mg,`
`);var j=d.dateNF!=null?o$(d.dateNF):null;function J(){var N=u.slice(w,T),L={};if(N.charAt(0)=='"'&&N.charAt(N.length-1)=='"'&&(N=N.slice(1,-1).replace(/""/g,'"')),N.length===0)L.t="z";else if(d.raw)L.t="s",L.v=N;else if(N.trim().length===0)L.t="s",L.v=N;else if(N.charCodeAt(0)==61)N.charCodeAt(1)==34&&N.charCodeAt(N.length-1)==34?(L.t="s",L.v=N.slice(2,-1).replace(/""/g,'"')):jW(N)?(L.t="n",L.f=N.slice(1)):(L.t="s",L.v=N);else if(N=="TRUE")L.t="b",L.v=!0;else if(N=="FALSE")L.t="b",L.v=!1;else if(!isNaN(b=$i(N)))L.t="n",d.cellText!==!1&&(L.w=N),L.v=b;else if(!isNaN(Yu(N).getDate())||j&&N.match(j)){L.z=d.dateNF||Ot[14];var G=0;j&&N.match(j)&&(N=l$(N,d.dateNF,N.match(j)||[]),G=1),d.cellDates?(L.t="d",L.v=xn(N,G)):(L.t="n",L.v=ia(xn(N,G))),d.cellText!==!1&&(L.w=fi(L.z,L.v instanceof Date?ia(L.v):L.v)),d.cellNF||delete L.z}else L.t="s",L.v=N;if(L.t=="z"||(d.dense?(g[_]||(g[_]=[]),g[_][y]=L):g[Nt({c:y,r:_})]=L),w=T+1,P=u.charCodeAt(w),m.e.c<y&&(m.e.c=y),m.e.r<_&&(m.e.r=_),A==F)++y;else if(y=0,++_,d.sheetRows&&d.sheetRows<=_)return!0}e:for(;T<u.length;++T)switch(A=u.charCodeAt(T)){case 34:P===34&&(I=!I);break;case F:case 10:case 13:if(!I&&J())break e;break}return T-w>0&&J(),g["!ref"]=$t(m),g}function s(u,f){return!(f&&f.PRN)||f.FS||u.slice(0,4)=="sep="||u.indexOf("	")>=0||u.indexOf(",")>=0||u.indexOf(";")>=0?i(u,f):l0(t(u,f),f)}function o(u,f){var d="",h=f.type=="string"?[0,0,0,0]:z5(u,f);switch(f.type){case"base64":d=Ba(u);break;case"binary":d=u;break;case"buffer":f.codepage==65001?d=u.toString("utf8"):f.codepage&&typeof Do<"u"?d=Do.utils.decode(f.codepage,u):d=Mt&&Buffer.isBuffer(u)?u.toString("binary"):mc(u);break;case"array":d=ic(u);break;case"string":d=u;break;default:throw new Error("Unrecognized type "+f.type)}return h[0]==239&&h[1]==187&&h[2]==191?d=mr(d.slice(3)):f.type!="string"&&f.type!="buffer"&&f.codepage==65001?d=mr(d):f.type=="binary"&&typeof Do<"u"&&f.codepage&&(d=Do.utils.decode(f.codepage,Do.utils.encode(28591,d))),d.slice(0,19)=="socialcalc:version:"?Yz.to_sheet(f.type=="string"?d:mr(d),f):s(d,f)}function l(u,f){return pl(o(u,f),f)}function c(u){for(var f=[],d=Or(u["!ref"]),h,g=Array.isArray(u),m=d.s.r;m<=d.e.r;++m){for(var _=[],y=d.s.c;y<=d.e.c;++y){var b=Nt({r:m,c:y});if(h=g?(u[m]||[])[y]:u[b],!h||h.v==null){_.push("          ");continue}for(var w=(h.w||(eo(h),h.w)||"").slice(0,10);w.length<10;)w+=" ";_.push(w+(y===0?" ":""))}f.push(_.join(""))}return f.join(`
`)}return{to_workbook:l,to_sheet:o,from_sheet:c}}();function Jz(e,t){var r=t||{},n=!!r.WTF;r.WTF=!0;try{var a=Kz.to_workbook(e,r);return r.WTF=n,a}catch(i){if(r.WTF=n,!i.message.match(/SYLK bad record ID/)&&n)throw i;return xh.to_workbook(e,t)}}var If=function(){function e(E,D,O){if(E){bn(E,E.l||0);for(var M=O.Enum||pe;E.l<E.length;){var K=E.read_shift(2),Y=M[K]||M[65535],re=E.read_shift(2),se=E.l+re,xe=Y.f&&Y.f(E,re,O);if(E.l=se,D(xe,Y,K))return}}}function t(E,D){switch(D.type){case"base64":return r(Ii(Ba(E)),D);case"binary":return r(Ii(E),D);case"buffer":case"array":return r(E,D)}throw"Unsupported type "+D.type}function r(E,D){if(!E)return E;var O=D||{},M=O.dense?[]:{},K="Sheet1",Y="",re=0,se={},xe=[],Ce=[],Z={s:{r:0,c:0},e:{r:0,c:0}},Ie=O.sheetRows||0;if(E[2]==0&&(E[3]==8||E[3]==9)&&E.length>=16&&E[14]==5&&E[15]===108)throw new Error("Unsupported Works 3 for Mac file");if(E[2]==2)O.Enum=pe,e(E,function(De,Xe,Be){switch(Be){case 0:O.vers=De,De>=4096&&(O.qpro=!0);break;case 6:Z=De;break;case 204:De&&(Y=De);break;case 222:Y=De;break;case 15:case 51:O.qpro||(De[1].v=De[1].v.slice(1));case 13:case 14:case 16:Be==14&&(De[2]&112)==112&&(De[2]&15)>1&&(De[2]&15)<15&&(De[1].z=O.dateNF||Ot[14],O.cellDates&&(De[1].t="d",De[1].v=Im(De[1].v))),O.qpro&&De[3]>re&&(M["!ref"]=$t(Z),se[K]=M,xe.push(K),M=O.dense?[]:{},Z={s:{r:0,c:0},e:{r:0,c:0}},re=De[3],K=Y||"Sheet"+(re+1),Y="");var Ge=O.dense?(M[De[0].r]||[])[De[0].c]:M[Nt(De[0])];if(Ge){Ge.t=De[1].t,Ge.v=De[1].v,De[1].z!=null&&(Ge.z=De[1].z),De[1].f!=null&&(Ge.f=De[1].f);break}O.dense?(M[De[0].r]||(M[De[0].r]=[]),M[De[0].r][De[0].c]=De[1]):M[Nt(De[0])]=De[1];break}},O);else if(E[2]==26||E[2]==14)O.Enum=me,E[2]==14&&(O.qpro=!0,E.l=0),e(E,function(De,Xe,Be){switch(Be){case 204:K=De;break;case 22:De[1].v=De[1].v.slice(1);case 23:case 24:case 25:case 37:case 39:case 40:if(De[3]>re&&(M["!ref"]=$t(Z),se[K]=M,xe.push(K),M=O.dense?[]:{},Z={s:{r:0,c:0},e:{r:0,c:0}},re=De[3],K="Sheet"+(re+1)),Ie>0&&De[0].r>=Ie)break;O.dense?(M[De[0].r]||(M[De[0].r]=[]),M[De[0].r][De[0].c]=De[1]):M[Nt(De[0])]=De[1],Z.e.c<De[0].c&&(Z.e.c=De[0].c),Z.e.r<De[0].r&&(Z.e.r=De[0].r);break;case 27:De[14e3]&&(Ce[De[14e3][0]]=De[14e3][1]);break;case 1537:Ce[De[0]]=De[1],De[0]==re&&(K=De[1]);break}},O);else throw new Error("Unrecognized LOTUS BOF "+E[2]);if(M["!ref"]=$t(Z),se[Y||K]=M,xe.push(Y||K),!Ce.length)return{SheetNames:xe,Sheets:se};for(var He={},Te=[],oe=0;oe<Ce.length;++oe)se[xe[oe]]?(Te.push(Ce[oe]||xe[oe]),He[Ce[oe]]=se[Ce[oe]]||se[xe[oe]]):(Te.push(Ce[oe]),He[Ce[oe]]={"!ref":"A1"});return{SheetNames:Te,Sheets:He}}function n(E,D){var O=D||{};if(+O.codepage>=0&&ji(+O.codepage),O.type=="string")throw new Error("Cannot write WK1 to JS string");var M=dv(),K=Or(E["!ref"]),Y=Array.isArray(E),re=[];Si(M,0,i(1030)),Si(M,6,l(K));for(var se=Math.min(K.e.r,8191),xe=K.s.r;xe<=se;++xe)for(var Ce=kn(xe),Z=K.s.c;Z<=K.e.c;++Z){xe===K.s.r&&(re[Z]=sn(Z));var Ie=re[Z]+Ce,He=Y?(E[xe]||[])[Z]:E[Ie];if(!(!He||He.t=="z"))if(He.t=="n")(He.v|0)==He.v&&He.v>=-32768&&He.v<=32767?Si(M,13,h(xe,Z,He.v)):Si(M,14,m(xe,Z,He.v));else{var Te=eo(He);Si(M,15,f(xe,Z,Te.slice(0,239)))}}return Si(M,1),M.end()}function a(E,D){var O=D||{};if(+O.codepage>=0&&ji(+O.codepage),O.type=="string")throw new Error("Cannot write WK3 to JS string");var M=dv();Si(M,0,s(E));for(var K=0,Y=0;K<E.SheetNames.length;++K)(E.Sheets[E.SheetNames[K]]||{})["!ref"]&&Si(M,27,R(E.SheetNames[K],Y++));var re=0;for(K=0;K<E.SheetNames.length;++K){var se=E.Sheets[E.SheetNames[K]];if(!(!se||!se["!ref"])){for(var xe=Or(se["!ref"]),Ce=Array.isArray(se),Z=[],Ie=Math.min(xe.e.r,8191),He=xe.s.r;He<=Ie;++He)for(var Te=kn(He),oe=xe.s.c;oe<=xe.e.c;++oe){He===xe.s.r&&(Z[oe]=sn(oe));var De=Z[oe]+Te,Xe=Ce?(se[He]||[])[oe]:se[De];if(!(!Xe||Xe.t=="z"))if(Xe.t=="n")Si(M,23,J(He,oe,re,Xe.v));else{var Be=eo(Xe);Si(M,22,A(He,oe,re,Be.slice(0,239)))}}++re}}return Si(M,1),M.end()}function i(E){var D=rn(2);return D.write_shift(2,E),D}function s(E){var D=rn(26);D.write_shift(2,4096),D.write_shift(2,4),D.write_shift(4,0);for(var O=0,M=0,K=0,Y=0;Y<E.SheetNames.length;++Y){var re=E.SheetNames[Y],se=E.Sheets[re];if(!(!se||!se["!ref"])){++K;var xe=o0(se["!ref"]);O<xe.e.r&&(O=xe.e.r),M<xe.e.c&&(M=xe.e.c)}}return O>8191&&(O=8191),D.write_shift(2,O),D.write_shift(1,K),D.write_shift(1,M),D.write_shift(2,0),D.write_shift(2,0),D.write_shift(1,1),D.write_shift(1,2),D.write_shift(4,0),D.write_shift(4,0),D}function o(E,D,O){var M={s:{c:0,r:0},e:{c:0,r:0}};return D==8&&O.qpro?(M.s.c=E.read_shift(1),E.l++,M.s.r=E.read_shift(2),M.e.c=E.read_shift(1),E.l++,M.e.r=E.read_shift(2),M):(M.s.c=E.read_shift(2),M.s.r=E.read_shift(2),D==12&&O.qpro&&(E.l+=2),M.e.c=E.read_shift(2),M.e.r=E.read_shift(2),D==12&&O.qpro&&(E.l+=2),M.s.c==65535&&(M.s.c=M.e.c=M.s.r=M.e.r=0),M)}function l(E){var D=rn(8);return D.write_shift(2,E.s.c),D.write_shift(2,E.s.r),D.write_shift(2,E.e.c),D.write_shift(2,E.e.r),D}function c(E,D,O){var M=[{c:0,r:0},{t:"n",v:0},0,0];return O.qpro&&O.vers!=20768?(M[0].c=E.read_shift(1),M[3]=E.read_shift(1),M[0].r=E.read_shift(2),E.l+=2):(M[2]=E.read_shift(1),M[0].c=E.read_shift(2),M[0].r=E.read_shift(2)),M}function u(E,D,O){var M=E.l+D,K=c(E,D,O);if(K[1].t="s",O.vers==20768){E.l++;var Y=E.read_shift(1);return K[1].v=E.read_shift(Y,"utf8"),K}return O.qpro&&E.l++,K[1].v=E.read_shift(M-E.l,"cstr"),K}function f(E,D,O){var M=rn(7+O.length);M.write_shift(1,255),M.write_shift(2,D),M.write_shift(2,E),M.write_shift(1,39);for(var K=0;K<M.length;++K){var Y=O.charCodeAt(K);M.write_shift(1,Y>=128?95:Y)}return M.write_shift(1,0),M}function d(E,D,O){var M=c(E,D,O);return M[1].v=E.read_shift(2,"i"),M}function h(E,D,O){var M=rn(7);return M.write_shift(1,255),M.write_shift(2,D),M.write_shift(2,E),M.write_shift(2,O,"i"),M}function g(E,D,O){var M=c(E,D,O);return M[1].v=E.read_shift(8,"f"),M}function m(E,D,O){var M=rn(13);return M.write_shift(1,255),M.write_shift(2,D),M.write_shift(2,E),M.write_shift(8,O,"f"),M}function _(E,D,O){var M=E.l+D,K=c(E,D,O);if(K[1].v=E.read_shift(8,"f"),O.qpro)E.l=M;else{var Y=E.read_shift(2);T(E.slice(E.l,E.l+Y),K),E.l+=Y}return K}function y(E,D,O){var M=D&32768;return D&=-32769,D=(M?E:0)+(D>=8192?D-16384:D),(M?"":"$")+(O?sn(D):kn(D))}var b={51:["FALSE",0],52:["TRUE",0],70:["LEN",1],80:["SUM",69],81:["AVERAGEA",69],82:["COUNTA",69],83:["MINA",69],84:["MAXA",69],111:["T",1]},w=["","","","","","","","","","+","-","*","/","^","=","<>","<=",">=","<",">","","","","","&","","","","","","",""];function T(E,D){bn(E,0);for(var O=[],M=0,K="",Y="",re="",se="";E.l<E.length;){var xe=E[E.l++];switch(xe){case 0:O.push(E.read_shift(8,"f"));break;case 1:Y=y(D[0].c,E.read_shift(2),!0),K=y(D[0].r,E.read_shift(2),!1),O.push(Y+K);break;case 2:{var Ce=y(D[0].c,E.read_shift(2),!0),Z=y(D[0].r,E.read_shift(2),!1);Y=y(D[0].c,E.read_shift(2),!0),K=y(D[0].r,E.read_shift(2),!1),O.push(Ce+Z+":"+Y+K)}break;case 3:if(E.l<E.length){console.error("WK1 premature formula end");return}break;case 4:O.push("("+O.pop()+")");break;case 5:O.push(E.read_shift(2));break;case 6:{for(var Ie="";xe=E[E.l++];)Ie+=String.fromCharCode(xe);O.push('"'+Ie.replace(/"/g,'""')+'"')}break;case 8:O.push("-"+O.pop());break;case 23:O.push("+"+O.pop());break;case 22:O.push("NOT("+O.pop()+")");break;case 20:case 21:se=O.pop(),re=O.pop(),O.push(["AND","OR"][xe-20]+"("+re+","+se+")");break;default:if(xe<32&&w[xe])se=O.pop(),re=O.pop(),O.push(re+w[xe]+se);else if(b[xe]){if(M=b[xe][1],M==69&&(M=E[E.l++]),M>O.length){console.error("WK1 bad formula parse 0x"+xe.toString(16)+":|"+O.join("|")+"|");return}var He=O.slice(-M);O.length-=M,O.push(b[xe][0]+"("+He.join(",")+")")}else return xe<=7?console.error("WK1 invalid opcode "+xe.toString(16)):xe<=24?console.error("WK1 unsupported op "+xe.toString(16)):xe<=30?console.error("WK1 invalid opcode "+xe.toString(16)):xe<=115?console.error("WK1 unsupported function opcode "+xe.toString(16)):console.error("WK1 unrecognized opcode "+xe.toString(16))}}O.length==1?D[1].f=""+O[0]:console.error("WK1 bad formula parse |"+O.join("|")+"|")}function F(E){var D=[{c:0,r:0},{t:"n",v:0},0];return D[0].r=E.read_shift(2),D[3]=E[E.l++],D[0].c=E[E.l++],D}function I(E,D){var O=F(E);return O[1].t="s",O[1].v=E.read_shift(D-4,"cstr"),O}function A(E,D,O,M){var K=rn(6+M.length);K.write_shift(2,E),K.write_shift(1,O),K.write_shift(1,D),K.write_shift(1,39);for(var Y=0;Y<M.length;++Y){var re=M.charCodeAt(Y);K.write_shift(1,re>=128?95:re)}return K.write_shift(1,0),K}function P(E,D){var O=F(E);O[1].v=E.read_shift(2);var M=O[1].v>>1;if(O[1].v&1)switch(M&7){case 0:M=(M>>3)*5e3;break;case 1:M=(M>>3)*500;break;case 2:M=(M>>3)/20;break;case 3:M=(M>>3)/200;break;case 4:M=(M>>3)/2e3;break;case 5:M=(M>>3)/2e4;break;case 6:M=(M>>3)/16;break;case 7:M=(M>>3)/64;break}return O[1].v=M,O}function j(E,D){var O=F(E),M=E.read_shift(4),K=E.read_shift(4),Y=E.read_shift(2);if(Y==65535)return M===0&&K===3221225472?(O[1].t="e",O[1].v=15):M===0&&K===3489660928?(O[1].t="e",O[1].v=42):O[1].v=0,O;var re=Y&32768;return Y=(Y&32767)-16446,O[1].v=(1-re*2)*(K*Math.pow(2,Y+32)+M*Math.pow(2,Y)),O}function J(E,D,O,M){var K=rn(14);if(K.write_shift(2,E),K.write_shift(1,O),K.write_shift(1,D),M==0)return K.write_shift(4,0),K.write_shift(4,0),K.write_shift(2,65535),K;var Y=0,re=0,se=0,xe=0;return M<0&&(Y=1,M=-M),re=Math.log2(M)|0,M/=Math.pow(2,re-31),xe=M>>>0,xe&2147483648||(M/=2,++re,xe=M>>>0),M-=xe,xe|=2147483648,xe>>>=0,M*=Math.pow(2,32),se=M>>>0,K.write_shift(4,se),K.write_shift(4,xe),re+=16383+(Y?32768:0),K.write_shift(2,re),K}function N(E,D){var O=j(E);return E.l+=D-14,O}function L(E,D){var O=F(E),M=E.read_shift(4);return O[1].v=M>>6,O}function G(E,D){var O=F(E),M=E.read_shift(8,"f");return O[1].v=M,O}function W(E,D){var O=G(E);return E.l+=D-10,O}function le(E,D){return E[E.l+D-1]==0?E.read_shift(D,"cstr"):""}function de(E,D){var O=E[E.l++];O>D-1&&(O=D-1);for(var M="";M.length<O;)M+=String.fromCharCode(E[E.l++]);return M}function X(E,D,O){if(!(!O.qpro||D<21)){var M=E.read_shift(1);E.l+=17,E.l+=1,E.l+=2;var K=E.read_shift(D-21,"cstr");return[M,K]}}function ee(E,D){for(var O={},M=E.l+D;E.l<M;){var K=E.read_shift(2);if(K==14e3){for(O[K]=[0,""],O[K][0]=E.read_shift(2);E[E.l];)O[K][1]+=String.fromCharCode(E[E.l]),E.l++;E.l++}}return O}function R(E,D){var O=rn(5+E.length);O.write_shift(2,14e3),O.write_shift(2,D);for(var M=0;M<E.length;++M){var K=E.charCodeAt(M);O[O.l++]=K>127?95:K}return O[O.l++]=0,O}var pe={0:{n:"BOF",f:Jr},1:{n:"EOF"},2:{n:"CALCMODE"},3:{n:"CALCORDER"},4:{n:"SPLIT"},5:{n:"SYNC"},6:{n:"RANGE",f:o},7:{n:"WINDOW1"},8:{n:"COLW1"},9:{n:"WINTWO"},10:{n:"COLW2"},11:{n:"NAME"},12:{n:"BLANK"},13:{n:"INTEGER",f:d},14:{n:"NUMBER",f:g},15:{n:"LABEL",f:u},16:{n:"FORMULA",f:_},24:{n:"TABLE"},25:{n:"ORANGE"},26:{n:"PRANGE"},27:{n:"SRANGE"},28:{n:"FRANGE"},29:{n:"KRANGE1"},32:{n:"HRANGE"},35:{n:"KRANGE2"},36:{n:"PROTEC"},37:{n:"FOOTER"},38:{n:"HEADER"},39:{n:"SETUP"},40:{n:"MARGINS"},41:{n:"LABELFMT"},42:{n:"TITLES"},43:{n:"SHEETJS"},45:{n:"GRAPH"},46:{n:"NGRAPH"},47:{n:"CALCCOUNT"},48:{n:"UNFORMATTED"},49:{n:"CURSORW12"},50:{n:"WINDOW"},51:{n:"STRING",f:u},55:{n:"PASSWORD"},56:{n:"LOCKED"},60:{n:"QUERY"},61:{n:"QUERYNAME"},62:{n:"PRINT"},63:{n:"PRINTNAME"},64:{n:"GRAPH2"},65:{n:"GRAPHNAME"},66:{n:"ZOOM"},67:{n:"SYMSPLIT"},68:{n:"NSROWS"},69:{n:"NSCOLS"},70:{n:"RULER"},71:{n:"NNAME"},72:{n:"ACOMM"},73:{n:"AMACRO"},74:{n:"PARSE"},102:{n:"PRANGES??"},103:{n:"RRANGES??"},104:{n:"FNAME??"},105:{n:"MRANGES??"},204:{n:"SHEETNAMECS",f:le},222:{n:"SHEETNAMELP",f:de},65535:{n:""}},me={0:{n:"BOF"},1:{n:"EOF"},2:{n:"PASSWORD"},3:{n:"CALCSET"},4:{n:"WINDOWSET"},5:{n:"SHEETCELLPTR"},6:{n:"SHEETLAYOUT"},7:{n:"COLUMNWIDTH"},8:{n:"HIDDENCOLUMN"},9:{n:"USERRANGE"},10:{n:"SYSTEMRANGE"},11:{n:"ZEROFORCE"},12:{n:"SORTKEYDIR"},13:{n:"FILESEAL"},14:{n:"DATAFILLNUMS"},15:{n:"PRINTMAIN"},16:{n:"PRINTSTRING"},17:{n:"GRAPHMAIN"},18:{n:"GRAPHSTRING"},19:{n:"??"},20:{n:"ERRCELL"},21:{n:"NACELL"},22:{n:"LABEL16",f:I},23:{n:"NUMBER17",f:j},24:{n:"NUMBER18",f:P},25:{n:"FORMULA19",f:N},26:{n:"FORMULA1A"},27:{n:"XFORMAT",f:ee},28:{n:"DTLABELMISC"},29:{n:"DTLABELCELL"},30:{n:"GRAPHWINDOW"},31:{n:"CPA"},32:{n:"LPLAUTO"},33:{n:"QUERY"},34:{n:"HIDDENSHEET"},35:{n:"??"},37:{n:"NUMBER25",f:L},38:{n:"??"},39:{n:"NUMBER27",f:G},40:{n:"FORMULA28",f:W},142:{n:"??"},147:{n:"??"},150:{n:"??"},151:{n:"??"},152:{n:"??"},153:{n:"??"},154:{n:"??"},155:{n:"??"},156:{n:"??"},163:{n:"??"},174:{n:"??"},175:{n:"??"},176:{n:"??"},177:{n:"??"},184:{n:"??"},185:{n:"??"},186:{n:"??"},187:{n:"??"},188:{n:"??"},195:{n:"??"},201:{n:"??"},204:{n:"SHEETNAMECS",f:le},205:{n:"??"},206:{n:"??"},207:{n:"??"},208:{n:"??"},256:{n:"??"},259:{n:"??"},260:{n:"??"},261:{n:"??"},262:{n:"??"},263:{n:"??"},265:{n:"??"},266:{n:"??"},267:{n:"??"},268:{n:"??"},270:{n:"??"},271:{n:"??"},384:{n:"??"},389:{n:"??"},390:{n:"??"},393:{n:"??"},396:{n:"??"},512:{n:"??"},514:{n:"??"},513:{n:"??"},516:{n:"??"},517:{n:"??"},640:{n:"??"},641:{n:"??"},642:{n:"??"},643:{n:"??"},644:{n:"??"},645:{n:"??"},646:{n:"??"},647:{n:"??"},648:{n:"??"},658:{n:"??"},659:{n:"??"},660:{n:"??"},661:{n:"??"},662:{n:"??"},665:{n:"??"},666:{n:"??"},768:{n:"??"},772:{n:"??"},1537:{n:"SHEETINFOQP",f:X},1600:{n:"??"},1602:{n:"??"},1793:{n:"??"},1794:{n:"??"},1795:{n:"??"},1796:{n:"??"},1920:{n:"??"},2048:{n:"??"},2049:{n:"??"},2052:{n:"??"},2688:{n:"??"},10998:{n:"??"},12849:{n:"??"},28233:{n:"??"},28484:{n:"??"},65535:{n:""}};return{sheet_to_wk1:n,book_to_wk3:a,to_workbook:t}}();function Qz(e){var t={},r=e.match(Gn),n=0,a=!1;if(r)for(;n!=r.length;++n){var i=wt(r[n]);switch(i[0].replace(/\w*:/g,"")){case"<condense":break;case"<extend":break;case"<shadow":if(!i.val)break;case"<shadow>":case"<shadow/>":t.shadow=1;break;case"</shadow>":break;case"<charset":if(i.val=="1")break;t.cp=y5[parseInt(i.val,10)];break;case"<outline":if(!i.val)break;case"<outline>":case"<outline/>":t.outline=1;break;case"</outline>":break;case"<rFont":t.name=i.val;break;case"<sz":t.sz=i.val;break;case"<strike":if(!i.val)break;case"<strike>":case"<strike/>":t.strike=1;break;case"</strike>":break;case"<u":if(!i.val)break;switch(i.val){case"double":t.uval="double";break;case"singleAccounting":t.uval="single-accounting";break;case"doubleAccounting":t.uval="double-accounting";break}case"<u>":case"<u/>":t.u=1;break;case"</u>":break;case"<b":if(i.val=="0")break;case"<b>":case"<b/>":t.b=1;break;case"</b>":break;case"<i":if(i.val=="0")break;case"<i>":case"<i/>":t.i=1;break;case"</i>":break;case"<color":i.rgb&&(t.color=i.rgb.slice(2,8));break;case"<color>":case"<color/>":case"</color>":break;case"<family":t.family=i.val;break;case"<family>":case"<family/>":case"</family>":break;case"<vertAlign":t.valign=i.val;break;case"<vertAlign>":case"<vertAlign/>":case"</vertAlign>":break;case"<scheme":break;case"<scheme>":case"<scheme/>":case"</scheme>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":a=!0;break;case"</ext>":a=!1;break;default:if(i[0].charCodeAt(1)!==47&&!a)throw new Error("Unrecognized rich format "+i[0])}}return t}var Zz=function(){var e=mh("t"),t=mh("rPr");function r(i){var s=i.match(e);if(!s)return{t:"s",v:""};var o={t:"s",v:Wt(s[1])},l=i.match(t);return l&&(o.s=Qz(l[1])),o}var n=/<(?:\w+:)?r>/g,a=/<\/(?:\w+:)?r>/;return function(s){return s.replace(n,"").split(a).map(r).filter(function(o){return o.v})}}(),eH=function(){var t=/(\r\n|\n)/g;function r(a,i,s){var o=[];a.u&&o.push("text-decoration: underline;"),a.uval&&o.push("text-underline-style:"+a.uval+";"),a.sz&&o.push("font-size:"+a.sz+"pt;"),a.outline&&o.push("text-effect: outline;"),a.shadow&&o.push("text-shadow: auto;"),i.push('<span style="'+o.join("")+'">'),a.b&&(i.push("<b>"),s.push("</b>")),a.i&&(i.push("<i>"),s.push("</i>")),a.strike&&(i.push("<s>"),s.push("</s>"));var l=a.valign||"";return l=="superscript"||l=="super"?l="sup":l=="subscript"&&(l="sub"),l!=""&&(i.push("<"+l+">"),s.push("</"+l+">")),s.push("</span>"),a}function n(a){var i=[[],a.v,[]];return a.v?(a.s&&r(a.s,i[0],i[2]),i[0].join("")+i[1].replace(t,"<br/>")+i[2].join("")):""}return function(i){return i.map(n).join("")}}(),tH=/<(?:\w+:)?t[^>]*>([^<]*)<\/(?:\w+:)?t>/g,rH=/<(?:\w+:)?r>/,nH=/<(?:\w+:)?rPh.*?>([\s\S]*?)<\/(?:\w+:)?rPh>/g;function j5(e,t){var r=t?t.cellHTML:!0,n={};return e?(e.match(/^\s*<(?:\w+:)?t[^>]*>/)?(n.t=Wt(mr(e.slice(e.indexOf(">")+1).split(/<\/(?:\w+:)?t>/)[0]||"")),n.r=mr(e),r&&(n.h=A5(n.t))):e.match(rH)&&(n.r=mr(e),n.t=Wt(mr((e.replace(nH,"").match(tH)||[]).join("").replace(Gn,""))),r&&(n.h=eH(Zz(n.r)))),n):{t:""}}var aH=/<(?:\w+:)?sst([^>]*)>([\s\S]*)<\/(?:\w+:)?sst>/,iH=/<(?:\w+:)?(?:si|sstItem)>/g,sH=/<\/(?:\w+:)?(?:si|sstItem)>/;function oH(e,t){var r=[],n="";if(!e)return r;var a=e.match(aH);if(a){n=a[2].replace(iH,"").split(sH);for(var i=0;i!=n.length;++i){var s=j5(n[i].trim(),t);s!=null&&(r[r.length]=s)}a=wt(a[1]),r.Count=a.count,r.Unique=a.uniqueCount}return r}function lH(e){return[e.read_shift(4),e.read_shift(4)]}function cH(e,t){var r=[],n=!1;return ao(e,function(i,s,o){switch(o){case 159:r.Count=i[0],r.Unique=i[1];break;case 19:r.push(i);break;case 160:return!0;case 35:n=!0;break;case 36:n=!1;break;default:if(s.T,!n||t.WTF)throw new Error("Unexpected record 0x"+o.toString(16))}}),r}function sT(e){for(var t=[],r=e.split(""),n=0;n<r.length;++n)t[n]=r[n].charCodeAt(0);return t}function qs(e,t){var r={};return r.Major=e.read_shift(2),r.Minor=e.read_shift(2),t>=4&&(e.l+=t-4),r}function uH(e){var t={};return t.id=e.read_shift(0,"lpp4"),t.R=qs(e,4),t.U=qs(e,4),t.W=qs(e,4),t}function fH(e){for(var t=e.read_shift(4),r=e.l+t-4,n={},a=e.read_shift(4),i=[];a-- >0;)i.push({t:e.read_shift(4),v:e.read_shift(0,"lpp4")});if(n.name=e.read_shift(0,"lpp4"),n.comps=i,e.l!=r)throw new Error("Bad DataSpaceMapEntry: "+e.l+" != "+r);return n}function hH(e){var t=[];e.l+=4;for(var r=e.read_shift(4);r-- >0;)t.push(fH(e));return t}function dH(e){var t=[];e.l+=4;for(var r=e.read_shift(4);r-- >0;)t.push(e.read_shift(0,"lpp4"));return t}function pH(e){var t={};return e.read_shift(4),e.l+=4,t.id=e.read_shift(0,"lpp4"),t.name=e.read_shift(0,"lpp4"),t.R=qs(e,4),t.U=qs(e,4),t.W=qs(e,4),t}function mH(e){var t=pH(e);if(t.ename=e.read_shift(0,"8lpp4"),t.blksz=e.read_shift(4),t.cmode=e.read_shift(4),e.read_shift(4)!=4)throw new Error("Bad !Primary record");return t}function oT(e,t){var r=e.l+t,n={};n.Flags=e.read_shift(4)&63,e.l+=4,n.AlgID=e.read_shift(4);var a=!1;switch(n.AlgID){case 26126:case 26127:case 26128:a=n.Flags==36;break;case 26625:a=n.Flags==4;break;case 0:a=n.Flags==16||n.Flags==4||n.Flags==36;break;default:throw"Unrecognized encryption algorithm: "+n.AlgID}if(!a)throw new Error("Encryption Flags/AlgID mismatch");return n.AlgIDHash=e.read_shift(4),n.KeySize=e.read_shift(4),n.ProviderType=e.read_shift(4),e.l+=8,n.CSPName=e.read_shift(r-e.l>>1,"utf16le"),e.l=r,n}function lT(e,t){var r={},n=e.l+t;return e.l+=4,r.Salt=e.slice(e.l,e.l+16),e.l+=16,r.Verifier=e.slice(e.l,e.l+16),e.l+=16,e.read_shift(4),r.VerifierHash=e.slice(e.l,n),e.l=n,r}function gH(e){var t=qs(e);switch(t.Minor){case 2:return[t.Minor,xH(e)];case 3:return[t.Minor,vH()];case 4:return[t.Minor,yH(e)]}throw new Error("ECMA-376 Encrypted file unrecognized Version: "+t.Minor)}function xH(e){var t=e.read_shift(4);if((t&63)!=36)throw new Error("EncryptionInfo mismatch");var r=e.read_shift(4),n=oT(e,r),a=lT(e,e.length-e.l);return{t:"Std",h:n,v:a}}function vH(){throw new Error("File is password-protected: ECMA-376 Extensible")}function yH(e){var t=["saltSize","blockSize","keyBits","hashSize","cipherAlgorithm","cipherChaining","hashAlgorithm","saltValue"];e.l+=4;var r=e.read_shift(e.length-e.l,"utf8"),n={};return r.replace(Gn,function(i){var s=wt(i);switch(gs(s[0])){case"<?xml":break;case"<encryption":case"</encryption>":break;case"<keyData":t.forEach(function(o){n[o]=s[o]});break;case"<dataIntegrity":n.encryptedHmacKey=s.encryptedHmacKey,n.encryptedHmacValue=s.encryptedHmacValue;break;case"<keyEncryptors>":case"<keyEncryptors":n.encs=[];break;case"</keyEncryptors>":break;case"<keyEncryptor":n.uri=s.uri;break;case"</keyEncryptor>":break;case"<encryptedKey":n.encs.push(s);break;default:throw s[0]}}),n}function wH(e,t){var r={},n=r.EncryptionVersionInfo=qs(e,4);if(t-=4,n.Minor!=2)throw new Error("unrecognized minor version code: "+n.Minor);if(n.Major>4||n.Major<2)throw new Error("unrecognized major version code: "+n.Major);r.Flags=e.read_shift(4),t-=4;var a=e.read_shift(4);return t-=4,r.EncryptionHeader=oT(e,a),t-=a,r.EncryptionVerifier=lT(e,t),r}function bH(e){var t={},r=t.EncryptionVersionInfo=qs(e,4);if(r.Major!=1||r.Minor!=1)throw"unrecognized version code "+r.Major+" : "+r.Minor;return t.Salt=e.read_shift(16),t.EncryptedVerifier=e.read_shift(16),t.EncryptedVerifierHash=e.read_shift(16),t}function _H(e){var t=0,r,n=sT(e),a=n.length+1,i,s,o,l,c;for(r=al(a),r[0]=n.length,i=1;i!=a;++i)r[i]=n[i-1];for(i=a-1;i>=0;--i)s=r[i],o=t&16384?1:0,l=t<<1&32767,c=o|l,t=c^s;return t^52811}var cT=function(){var e=[187,255,255,186,255,255,185,128,0,190,15,0,191,15,0],t=[57840,7439,52380,33984,4364,3600,61902,12606,6258,57657,54287,34041,10252,43370,20163],r=[44796,19929,39858,10053,20106,40212,10761,31585,63170,64933,60267,50935,40399,11199,17763,35526,1453,2906,5812,11624,23248,885,1770,3540,7080,14160,28320,56640,55369,41139,20807,41614,21821,43642,17621,28485,56970,44341,19019,38038,14605,29210,60195,50791,40175,10751,21502,43004,24537,18387,36774,3949,7898,15796,31592,63184,47201,24803,49606,37805,14203,28406,56812,17824,35648,1697,3394,6788,13576,27152,43601,17539,35078,557,1114,2228,4456,30388,60776,51953,34243,7079,14158,28316,14128,28256,56512,43425,17251,34502,7597,13105,26210,52420,35241,883,1766,3532,4129,8258,16516,33032,4657,9314,18628],n=function(s){return(s/2|s*128)&255},a=function(s,o){return n(s^o)},i=function(s){for(var o=t[s.length-1],l=104,c=s.length-1;c>=0;--c)for(var u=s[c],f=0;f!=7;++f)u&64&&(o^=r[l]),u*=2,--l;return o};return function(s){for(var o=sT(s),l=i(o),c=o.length,u=al(16),f=0;f!=16;++f)u[f]=0;var d,h,g;for((c&1)===1&&(d=l>>8,u[c]=a(e[0],d),--c,d=l&255,h=o[o.length-1],u[c]=a(h,d));c>0;)--c,d=l>>8,u[c]=a(o[c],d),--c,d=l&255,u[c]=a(o[c],d);for(c=15,g=15-o.length;g>0;)d=l>>8,u[c]=a(e[g],d),--c,--g,d=l&255,u[c]=a(o[c],d),--c,--g;return u}}(),SH=function(e,t,r,n,a){a||(a=t),n||(n=cT(e));var i,s;for(i=0;i!=t.length;++i)s=t[i],s^=n[r],s=(s>>5|s<<3)&255,a[i]=s,++r;return[a,r,n]},kH=function(e){var t=0,r=cT(e);return function(n){var a=SH("",n,t,r);return t=a[1],a[0]}};function EH(e,t,r,n){var a={key:Jr(e),verificationBytes:Jr(e)};return r.password&&(a.verifier=_H(r.password)),n.valid=a.verificationBytes===a.verifier,n.valid&&(n.insitu=kH(r.password)),a}function AH(e,t,r){var n=r||{};return n.Info=e.read_shift(2),e.l-=2,n.Info===1?n.Data=bH(e):n.Data=wH(e,t),n}function TH(e,t,r){var n={Type:r.biff>=8?e.read_shift(2):0};return n.Type?AH(e,t-2,n):EH(e,r.biff>=8?t:t-2,r,n),n}var CH=function(){function e(a,i){switch(i.type){case"base64":return t(Ba(a),i);case"binary":return t(a,i);case"buffer":return t(Mt&&Buffer.isBuffer(a)?a.toString("binary"):mc(a),i);case"array":return t(ic(a),i)}throw new Error("Unrecognized type "+i.type)}function t(a,i){var s=i||{},o=s.dense?[]:{},l=a.match(/\\trowd.*?\\row\b/g);if(!l.length)throw new Error("RTF missing table");var c={s:{c:0,r:0},e:{c:0,r:l.length-1}};return l.forEach(function(u,f){Array.isArray(o)&&(o[f]=[]);for(var d=/\\\w+\b/g,h=0,g,m=-1;g=d.exec(u);){switch(g[0]){case"\\cell":var _=u.slice(h,d.lastIndex-g[0].length);if(_[0]==" "&&(_=_.slice(1)),++m,_.length){var y={v:_,t:"s"};Array.isArray(o)?o[f][m]=y:o[Nt({r:f,c:m})]=y}break}h=d.lastIndex}m>c.e.c&&(c.e.c=m)}),o["!ref"]=$t(c),o}function r(a,i){return pl(e(a,i),i)}function n(a){for(var i=["{\\rtf1\\ansi"],s=Or(a["!ref"]),o,l=Array.isArray(a),c=s.s.r;c<=s.e.r;++c){i.push("\\trowd\\trautofit1");for(var u=s.s.c;u<=s.e.c;++u)i.push("\\cellx"+(u+1));for(i.push("\\pard\\intbl"),u=s.s.c;u<=s.e.c;++u){var f=Nt({r:c,c:u});o=l?(a[c]||[])[u]:a[f],!(!o||o.v==null&&(!o.f||o.F))&&(i.push(" "+(o.w||(eo(o),o.w))),i.push("\\cell"))}i.push("\\pard\\intbl\\row")}return i.join("")+"}"}return{to_workbook:r,to_sheet:e,from_sheet:n}}();function NH(e){var t=e.slice(e[0]==="#"?1:0).slice(0,6);return[parseInt(t.slice(0,2),16),parseInt(t.slice(2,4),16),parseInt(t.slice(4,6),16)]}function vh(e){for(var t=0,r=1;t!=3;++t)r=r*256+(e[t]>255?255:e[t]<0?0:e[t]);return r.toString(16).toUpperCase().slice(1)}function PH(e){var t=e[0]/255,r=e[1]/255,n=e[2]/255,a=Math.max(t,r,n),i=Math.min(t,r,n),s=a-i;if(s===0)return[0,0,t];var o=0,l=0,c=a+i;switch(l=s/(c>1?2-c:c),a){case t:o=((r-n)/s+6)%6;break;case r:o=(n-t)/s+2;break;case n:o=(t-r)/s+4;break}return[o/6,l,c/2]}function LH(e){var t=e[0],r=e[1],n=e[2],a=r*2*(n<.5?n:1-n),i=n-a/2,s=[i,i,i],o=6*t,l;if(r!==0)switch(o|0){case 0:case 6:l=a*o,s[0]+=a,s[1]+=l;break;case 1:l=a*(2-o),s[0]+=l,s[1]+=a;break;case 2:l=a*(o-2),s[1]+=a,s[2]+=l;break;case 3:l=a*(4-o),s[1]+=l,s[2]+=a;break;case 4:l=a*(o-4),s[2]+=a,s[0]+=l;break;case 5:l=a*(6-o),s[2]+=l,s[0]+=a;break}for(var c=0;c!=3;++c)s[c]=Math.round(s[c]*255);return s}function B1(e,t){if(t===0)return e;var r=PH(NH(e));return t<0?r[2]=r[2]*(1+t):r[2]=1-(1-r[2])*(1-t),vh(LH(r))}var uT=6,FH=15,OH=1,ta=uT;function U1(e){return Math.floor((e+Math.round(128/ta)/256)*ta)}function $1(e){return Math.floor((e-5)/ta*100+.5)/100}function xv(e){return Math.round((e*ta+5)/ta*256)/256}function _2(e){return xv($1(U1(e)))}function R5(e){var t=Math.abs(e-_2(e)),r=ta;if(t>.005)for(ta=OH;ta<FH;++ta)Math.abs(e-_2(e))<=t&&(t=Math.abs(e-_2(e)),r=ta);ta=r}function Ju(e){e.width?(e.wpx=U1(e.width),e.wch=$1(e.wpx),e.MDW=ta):e.wpx?(e.wch=$1(e.wpx),e.width=xv(e.wch),e.MDW=ta):typeof e.wch=="number"&&(e.width=xv(e.wch),e.wpx=U1(e.width),e.MDW=ta),e.customWidth&&delete e.customWidth}var IH=96,fT=IH;function hT(e){return e*96/fT}function yh(e){return e*fT/96}var DH={None:"none",Solid:"solid",Gray50:"mediumGray",Gray75:"darkGray",Gray25:"lightGray",HorzStripe:"darkHorizontal",VertStripe:"darkVertical",ReverseDiagStripe:"darkDown",DiagStripe:"darkUp",DiagCross:"darkGrid",ThickDiagCross:"darkTrellis",ThinHorzStripe:"lightHorizontal",ThinVertStripe:"lightVertical",ThinReverseDiagStripe:"lightDown",ThinHorzCross:"lightGrid"};function jH(e,t,r,n){t.Borders=[];var a={},i=!1;(e[0].match(Gn)||[]).forEach(function(s){var o=wt(s);switch(gs(o[0])){case"<borders":case"<borders>":case"</borders>":break;case"<border":case"<border>":case"<border/>":a={},o.diagonalUp&&(a.diagonalUp=wr(o.diagonalUp)),o.diagonalDown&&(a.diagonalDown=wr(o.diagonalDown)),t.Borders.push(a);break;case"</border>":break;case"<left/>":break;case"<left":case"<left>":break;case"</left>":break;case"<right/>":break;case"<right":case"<right>":break;case"</right>":break;case"<top/>":break;case"<top":case"<top>":break;case"</top>":break;case"<bottom/>":break;case"<bottom":case"<bottom>":break;case"</bottom>":break;case"<diagonal":case"<diagonal>":case"<diagonal/>":break;case"</diagonal>":break;case"<horizontal":case"<horizontal>":case"<horizontal/>":break;case"</horizontal>":break;case"<vertical":case"<vertical>":case"<vertical/>":break;case"</vertical>":break;case"<start":case"<start>":case"<start/>":break;case"</start>":break;case"<end":case"<end>":case"<end/>":break;case"</end>":break;case"<color":case"<color>":break;case"<color/>":case"</color>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":i=!0;break;case"</ext>":i=!1;break;default:if(n&&n.WTF&&!i)throw new Error("unrecognized "+o[0]+" in borders")}})}function RH(e,t,r,n){t.Fills=[];var a={},i=!1;(e[0].match(Gn)||[]).forEach(function(s){var o=wt(s);switch(gs(o[0])){case"<fills":case"<fills>":case"</fills>":break;case"<fill>":case"<fill":case"<fill/>":a={},t.Fills.push(a);break;case"</fill>":break;case"<gradientFill>":break;case"<gradientFill":case"</gradientFill>":t.Fills.push(a),a={};break;case"<patternFill":case"<patternFill>":o.patternType&&(a.patternType=o.patternType);break;case"<patternFill/>":case"</patternFill>":break;case"<bgColor":a.bgColor||(a.bgColor={}),o.indexed&&(a.bgColor.indexed=parseInt(o.indexed,10)),o.theme&&(a.bgColor.theme=parseInt(o.theme,10)),o.tint&&(a.bgColor.tint=parseFloat(o.tint)),o.rgb&&(a.bgColor.rgb=o.rgb.slice(-6));break;case"<bgColor/>":case"</bgColor>":break;case"<fgColor":a.fgColor||(a.fgColor={}),o.theme&&(a.fgColor.theme=parseInt(o.theme,10)),o.tint&&(a.fgColor.tint=parseFloat(o.tint)),o.rgb!=null&&(a.fgColor.rgb=o.rgb.slice(-6));break;case"<fgColor/>":case"</fgColor>":break;case"<stop":case"<stop/>":break;case"</stop>":break;case"<color":case"<color/>":break;case"</color>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":i=!0;break;case"</ext>":i=!1;break;default:if(n&&n.WTF&&!i)throw new Error("unrecognized "+o[0]+" in fills")}})}function MH(e,t,r,n){t.Fonts=[];var a={},i=!1;(e[0].match(Gn)||[]).forEach(function(s){var o=wt(s);switch(gs(o[0])){case"<fonts":case"<fonts>":case"</fonts>":break;case"<font":case"<font>":break;case"</font>":case"<font/>":t.Fonts.push(a),a={};break;case"<name":o.val&&(a.name=mr(o.val));break;case"<name/>":case"</name>":break;case"<b":a.bold=o.val?wr(o.val):1;break;case"<b/>":a.bold=1;break;case"<i":a.italic=o.val?wr(o.val):1;break;case"<i/>":a.italic=1;break;case"<u":switch(o.val){case"none":a.underline=0;break;case"single":a.underline=1;break;case"double":a.underline=2;break;case"singleAccounting":a.underline=33;break;case"doubleAccounting":a.underline=34;break}break;case"<u/>":a.underline=1;break;case"<strike":a.strike=o.val?wr(o.val):1;break;case"<strike/>":a.strike=1;break;case"<outline":a.outline=o.val?wr(o.val):1;break;case"<outline/>":a.outline=1;break;case"<shadow":a.shadow=o.val?wr(o.val):1;break;case"<shadow/>":a.shadow=1;break;case"<condense":a.condense=o.val?wr(o.val):1;break;case"<condense/>":a.condense=1;break;case"<extend":a.extend=o.val?wr(o.val):1;break;case"<extend/>":a.extend=1;break;case"<sz":o.val&&(a.sz=+o.val);break;case"<sz/>":case"</sz>":break;case"<vertAlign":o.val&&(a.vertAlign=o.val);break;case"<vertAlign/>":case"</vertAlign>":break;case"<family":o.val&&(a.family=parseInt(o.val,10));break;case"<family/>":case"</family>":break;case"<scheme":o.val&&(a.scheme=o.val);break;case"<scheme/>":case"</scheme>":break;case"<charset":if(o.val=="1")break;o.codepage=y5[parseInt(o.val,10)];break;case"<color":if(a.color||(a.color={}),o.auto&&(a.color.auto=wr(o.auto)),o.rgb)a.color.rgb=o.rgb.slice(-6);else if(o.indexed){a.color.index=parseInt(o.indexed,10);var l=Yl[a.color.index];a.color.index==81&&(l=Yl[1]),l||(l=Yl[1]),a.color.rgb=l[0].toString(16)+l[1].toString(16)+l[2].toString(16)}else o.theme&&(a.color.theme=parseInt(o.theme,10),o.tint&&(a.color.tint=parseFloat(o.tint)),o.theme&&r.themeElements&&r.themeElements.clrScheme&&(a.color.rgb=B1(r.themeElements.clrScheme[a.color.theme].rgb,a.color.tint||0)));break;case"<color/>":case"</color>":break;case"<AlternateContent":i=!0;break;case"</AlternateContent>":i=!1;break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":i=!0;break;case"</ext>":i=!1;break;default:if(n&&n.WTF&&!i)throw new Error("unrecognized "+o[0]+" in fonts")}})}function BH(e,t,r){t.NumberFmt=[];for(var n=ds(Ot),a=0;a<n.length;++a)t.NumberFmt[n[a]]=Ot[n[a]];var i=e[0].match(Gn);if(i)for(a=0;a<i.length;++a){var s=wt(i[a]);switch(gs(s[0])){case"<numFmts":case"</numFmts>":case"<numFmts/>":case"<numFmts>":break;case"<numFmt":{var o=Wt(mr(s.formatCode)),l=parseInt(s.numFmtId,10);if(t.NumberFmt[l]=o,l>0){if(l>392){for(l=392;l>60&&t.NumberFmt[l]!=null;--l);t.NumberFmt[l]=o}Xl(o,l)}}break;case"</numFmt>":break;default:if(r.WTF)throw new Error("unrecognized "+s[0]+" in numFmts")}}}var gp=["numFmtId","fillId","fontId","borderId","xfId"],xp=["applyAlignment","applyBorder","applyFill","applyFont","applyNumberFormat","applyProtection","pivotButton","quotePrefix"];function UH(e,t,r){t.CellXf=[];var n,a=!1;(e[0].match(Gn)||[]).forEach(function(i){var s=wt(i),o=0;switch(gs(s[0])){case"<cellXfs":case"<cellXfs>":case"<cellXfs/>":case"</cellXfs>":break;case"<xf":case"<xf/>":for(n=s,delete n[0],o=0;o<gp.length;++o)n[gp[o]]&&(n[gp[o]]=parseInt(n[gp[o]],10));for(o=0;o<xp.length;++o)n[xp[o]]&&(n[xp[o]]=wr(n[xp[o]]));if(t.NumberFmt&&n.numFmtId>392){for(o=392;o>60;--o)if(t.NumberFmt[n.numFmtId]==t.NumberFmt[o]){n.numFmtId=o;break}}t.CellXf.push(n);break;case"</xf>":break;case"<alignment":case"<alignment/>":var l={};s.vertical&&(l.vertical=s.vertical),s.horizontal&&(l.horizontal=s.horizontal),s.textRotation!=null&&(l.textRotation=s.textRotation),s.indent&&(l.indent=s.indent),s.wrapText&&(l.wrapText=wr(s.wrapText)),n.alignment=l;break;case"</alignment>":break;case"<protection":break;case"</protection>":case"<protection/>":break;case"<AlternateContent":a=!0;break;case"</AlternateContent>":a=!1;break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":a=!0;break;case"</ext>":a=!1;break;default:if(r&&r.WTF&&!a)throw new Error("unrecognized "+s[0]+" in cellXfs")}})}var $H=function(){var t=/<(?:\w+:)?numFmts([^>]*)>[\S\s]*?<\/(?:\w+:)?numFmts>/,r=/<(?:\w+:)?cellXfs([^>]*)>[\S\s]*?<\/(?:\w+:)?cellXfs>/,n=/<(?:\w+:)?fills([^>]*)>[\S\s]*?<\/(?:\w+:)?fills>/,a=/<(?:\w+:)?fonts([^>]*)>[\S\s]*?<\/(?:\w+:)?fonts>/,i=/<(?:\w+:)?borders([^>]*)>[\S\s]*?<\/(?:\w+:)?borders>/;return function(o,l,c){var u={};if(!o)return u;o=o.replace(/<!--([\s\S]*?)-->/mg,"").replace(/<!DOCTYPE[^\[]*\[[^\]]*\]>/gm,"");var f;return(f=o.match(t))&&BH(f,u,c),(f=o.match(a))&&MH(f,u,l,c),(f=o.match(n))&&RH(f,u,l,c),(f=o.match(i))&&jH(f,u,l,c),(f=o.match(r))&&UH(f,u,c),u}}();function VH(e,t){var r=e.read_shift(2),n=Hn(e);return[r,n]}function zH(e,t,r){var n={};n.sz=e.read_shift(2)/20;var a=Z$(e);a.fItalic&&(n.italic=1),a.fCondense&&(n.condense=1),a.fExtend&&(n.extend=1),a.fShadow&&(n.shadow=1),a.fOutline&&(n.outline=1),a.fStrikeout&&(n.strike=1);var i=e.read_shift(2);switch(i===700&&(n.bold=1),e.read_shift(2)){case 1:n.vertAlign="superscript";break;case 2:n.vertAlign="subscript";break}var s=e.read_shift(1);s!=0&&(n.underline=s);var o=e.read_shift(1);o>0&&(n.family=o);var l=e.read_shift(1);switch(l>0&&(n.charset=l),e.l++,n.color=Q$(e),e.read_shift(1)){case 1:n.scheme="major";break;case 2:n.scheme="minor";break}return n.name=Hn(e),n}var HH=qn;function WH(e,t){var r=e.l+t,n=e.read_shift(2),a=e.read_shift(2);return e.l=r,{ixfe:n,numFmtId:a}}var qH=qn;function GH(e,t,r){var n={};n.NumberFmt=[];for(var a in Ot)n.NumberFmt[a]=Ot[a];n.CellXf=[],n.Fonts=[];var i=[],s=!1;return ao(e,function(l,c,u){switch(u){case 44:n.NumberFmt[l[0]]=l[1],Xl(l[1],l[0]);break;case 43:n.Fonts.push(l),l.color.theme!=null&&t&&t.themeElements&&t.themeElements.clrScheme&&(l.color.rgb=B1(t.themeElements.clrScheme[l.color.theme].rgb,l.color.tint||0));break;case 1025:break;case 45:break;case 46:break;case 47:i[i.length-1]==617&&n.CellXf.push(l);break;case 48:case 507:case 572:case 475:break;case 1171:case 2102:case 1130:case 512:case 2095:case 3072:break;case 35:s=!0;break;case 36:s=!1;break;case 37:i.push(u),s=!0;break;case 38:i.pop(),s=!1;break;default:if(c.T>0)i.push(u);else if(c.T<0)i.pop();else if(!s||r.WTF&&i[i.length-1]!=37)throw new Error("Unexpected record 0x"+u.toString(16))}}),n}var KH=["</a:lt1>","</a:dk1>","</a:lt2>","</a:dk2>","</a:accent1>","</a:accent2>","</a:accent3>","</a:accent4>","</a:accent5>","</a:accent6>","</a:hlink>","</a:folHlink>"];function XH(e,t,r){t.themeElements.clrScheme=[];var n={};(e[0].match(Gn)||[]).forEach(function(a){var i=wt(a);switch(i[0]){case"<a:clrScheme":case"</a:clrScheme>":break;case"<a:srgbClr":n.rgb=i.val;break;case"<a:sysClr":n.rgb=i.lastClr;break;case"<a:dk1>":case"</a:dk1>":case"<a:lt1>":case"</a:lt1>":case"<a:dk2>":case"</a:dk2>":case"<a:lt2>":case"</a:lt2>":case"<a:accent1>":case"</a:accent1>":case"<a:accent2>":case"</a:accent2>":case"<a:accent3>":case"</a:accent3>":case"<a:accent4>":case"</a:accent4>":case"<a:accent5>":case"</a:accent5>":case"<a:accent6>":case"</a:accent6>":case"<a:hlink>":case"</a:hlink>":case"<a:folHlink>":case"</a:folHlink>":i[0].charAt(1)==="/"?(t.themeElements.clrScheme[KH.indexOf(i[0])]=n,n={}):n.name=i[0].slice(3,i[0].length-1);break;default:if(r&&r.WTF)throw new Error("Unrecognized "+i[0]+" in clrScheme")}})}function YH(){}function JH(){}var QH=/<a:clrScheme([^>]*)>[\s\S]*<\/a:clrScheme>/,ZH=/<a:fontScheme([^>]*)>[\s\S]*<\/a:fontScheme>/,eW=/<a:fmtScheme([^>]*)>[\s\S]*<\/a:fmtScheme>/;function tW(e,t,r){t.themeElements={};var n;[["clrScheme",QH,XH],["fontScheme",ZH,YH],["fmtScheme",eW,JH]].forEach(function(a){if(!(n=e.match(a[1])))throw new Error(a[0]+" not found in themeElements");a[2](n,t,r)})}var rW=/<a:themeElements([^>]*)>[\s\S]*<\/a:themeElements>/;function dT(e,t){(!e||e.length===0)&&(e=nW());var r,n={};if(!(r=e.match(rW)))throw new Error("themeElements not found in theme");return tW(r[0],n,t),n.raw=e,n}function nW(e,t){var r=[kA];return r[r.length]='<a:theme xmlns:a="http://schemas.openxmlformats.org/drawingml/2006/main" name="Office Theme">',r[r.length]="<a:themeElements>",r[r.length]='<a:clrScheme name="Office">',r[r.length]='<a:dk1><a:sysClr val="windowText" lastClr="000000"/></a:dk1>',r[r.length]='<a:lt1><a:sysClr val="window" lastClr="FFFFFF"/></a:lt1>',r[r.length]='<a:dk2><a:srgbClr val="1F497D"/></a:dk2>',r[r.length]='<a:lt2><a:srgbClr val="EEECE1"/></a:lt2>',r[r.length]='<a:accent1><a:srgbClr val="4F81BD"/></a:accent1>',r[r.length]='<a:accent2><a:srgbClr val="C0504D"/></a:accent2>',r[r.length]='<a:accent3><a:srgbClr val="9BBB59"/></a:accent3>',r[r.length]='<a:accent4><a:srgbClr val="8064A2"/></a:accent4>',r[r.length]='<a:accent5><a:srgbClr val="4BACC6"/></a:accent5>',r[r.length]='<a:accent6><a:srgbClr val="F79646"/></a:accent6>',r[r.length]='<a:hlink><a:srgbClr val="0000FF"/></a:hlink>',r[r.length]='<a:folHlink><a:srgbClr val="800080"/></a:folHlink>',r[r.length]="</a:clrScheme>",r[r.length]='<a:fontScheme name="Office">',r[r.length]="<a:majorFont>",r[r.length]='<a:latin typeface="Cambria"/>',r[r.length]='<a:ea typeface=""/>',r[r.length]='<a:cs typeface=""/>',r[r.length]='<a:font script="Jpan" typeface=" "/>',r[r.length]='<a:font script="Hang" typeface=" "/>',r[r.length]='<a:font script="Hans" typeface=""/>',r[r.length]='<a:font script="Hant" typeface=""/>',r[r.length]='<a:font script="Arab" typeface="Times New Roman"/>',r[r.length]='<a:font script="Hebr" typeface="Times New Roman"/>',r[r.length]='<a:font script="Thai" typeface="Tahoma"/>',r[r.length]='<a:font script="Ethi" typeface="Nyala"/>',r[r.length]='<a:font script="Beng" typeface="Vrinda"/>',r[r.length]='<a:font script="Gujr" typeface="Shruti"/>',r[r.length]='<a:font script="Khmr" typeface="MoolBoran"/>',r[r.length]='<a:font script="Knda" typeface="Tunga"/>',r[r.length]='<a:font script="Guru" typeface="Raavi"/>',r[r.length]='<a:font script="Cans" typeface="Euphemia"/>',r[r.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',r[r.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',r[r.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',r[r.length]='<a:font script="Thaa" typeface="MV Boli"/>',r[r.length]='<a:font script="Deva" typeface="Mangal"/>',r[r.length]='<a:font script="Telu" typeface="Gautami"/>',r[r.length]='<a:font script="Taml" typeface="Latha"/>',r[r.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',r[r.length]='<a:font script="Orya" typeface="Kalinga"/>',r[r.length]='<a:font script="Mlym" typeface="Kartika"/>',r[r.length]='<a:font script="Laoo" typeface="DokChampa"/>',r[r.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',r[r.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',r[r.length]='<a:font script="Viet" typeface="Times New Roman"/>',r[r.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',r[r.length]='<a:font script="Geor" typeface="Sylfaen"/>',r[r.length]="</a:majorFont>",r[r.length]="<a:minorFont>",r[r.length]='<a:latin typeface="Calibri"/>',r[r.length]='<a:ea typeface=""/>',r[r.length]='<a:cs typeface=""/>',r[r.length]='<a:font script="Jpan" typeface=" "/>',r[r.length]='<a:font script="Hang" typeface=" "/>',r[r.length]='<a:font script="Hans" typeface=""/>',r[r.length]='<a:font script="Hant" typeface=""/>',r[r.length]='<a:font script="Arab" typeface="Arial"/>',r[r.length]='<a:font script="Hebr" typeface="Arial"/>',r[r.length]='<a:font script="Thai" typeface="Tahoma"/>',r[r.length]='<a:font script="Ethi" typeface="Nyala"/>',r[r.length]='<a:font script="Beng" typeface="Vrinda"/>',r[r.length]='<a:font script="Gujr" typeface="Shruti"/>',r[r.length]='<a:font script="Khmr" typeface="DaunPenh"/>',r[r.length]='<a:font script="Knda" typeface="Tunga"/>',r[r.length]='<a:font script="Guru" typeface="Raavi"/>',r[r.length]='<a:font script="Cans" typeface="Euphemia"/>',r[r.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',r[r.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',r[r.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',r[r.length]='<a:font script="Thaa" typeface="MV Boli"/>',r[r.length]='<a:font script="Deva" typeface="Mangal"/>',r[r.length]='<a:font script="Telu" typeface="Gautami"/>',r[r.length]='<a:font script="Taml" typeface="Latha"/>',r[r.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',r[r.length]='<a:font script="Orya" typeface="Kalinga"/>',r[r.length]='<a:font script="Mlym" typeface="Kartika"/>',r[r.length]='<a:font script="Laoo" typeface="DokChampa"/>',r[r.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',r[r.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',r[r.length]='<a:font script="Viet" typeface="Arial"/>',r[r.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',r[r.length]='<a:font script="Geor" typeface="Sylfaen"/>',r[r.length]="</a:minorFont>",r[r.length]="</a:fontScheme>",r[r.length]='<a:fmtScheme name="Office">',r[r.length]="<a:fillStyleLst>",r[r.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="50000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="35000"><a:schemeClr val="phClr"><a:tint val="37000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="15000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:lin ang="16200000" scaled="1"/>',r[r.length]="</a:gradFill>",r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="100000"/><a:shade val="100000"/><a:satMod val="130000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="50000"/><a:shade val="100000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:lin ang="16200000" scaled="0"/>',r[r.length]="</a:gradFill>",r[r.length]="</a:fillStyleLst>",r[r.length]="<a:lnStyleLst>",r[r.length]='<a:ln w="9525" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"><a:shade val="95000"/><a:satMod val="105000"/></a:schemeClr></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]='<a:ln w="25400" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]='<a:ln w="38100" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]="</a:lnStyleLst>",r[r.length]="<a:effectStyleLst>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="20000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="38000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]="</a:effectStyle>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]="</a:effectStyle>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]='<a:scene3d><a:camera prst="orthographicFront"><a:rot lat="0" lon="0" rev="0"/></a:camera><a:lightRig rig="threePt" dir="t"><a:rot lat="0" lon="0" rev="1200000"/></a:lightRig></a:scene3d>',r[r.length]='<a:sp3d><a:bevelT w="63500" h="25400"/></a:sp3d>',r[r.length]="</a:effectStyle>",r[r.length]="</a:effectStyleLst>",r[r.length]="<a:bgFillStyleLst>",r[r.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="40000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="40000"><a:schemeClr val="phClr"><a:tint val="45000"/><a:shade val="99000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="20000"/><a:satMod val="255000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:path path="circle"><a:fillToRect l="50000" t="-80000" r="50000" b="180000"/></a:path>',r[r.length]="</a:gradFill>",r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="80000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="30000"/><a:satMod val="200000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:path path="circle"><a:fillToRect l="50000" t="50000" r="50000" b="50000"/></a:path>',r[r.length]="</a:gradFill>",r[r.length]="</a:bgFillStyleLst>",r[r.length]="</a:fmtScheme>",r[r.length]="</a:themeElements>",r[r.length]="<a:objectDefaults>",r[r.length]="<a:spDef>",r[r.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="1"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="3"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="2"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="lt1"/></a:fontRef></a:style>',r[r.length]="</a:spDef>",r[r.length]="<a:lnDef>",r[r.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="2"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="0"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="1"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="tx1"/></a:fontRef></a:style>',r[r.length]="</a:lnDef>",r[r.length]="</a:objectDefaults>",r[r.length]="<a:extraClrSchemeLst/>",r[r.length]="</a:theme>",r.join("")}function aW(e,t,r){var n=e.l+t,a=e.read_shift(4);if(a!==124226){if(!r.cellStyles){e.l=n;return}var i=e.slice(e.l);e.l=n;var s;try{s=SA(i,{type:"array"})}catch{return}var o=Oa(s,"theme/theme/theme1.xml",!0);if(o)return dT(o,r)}}function iW(e){return e.read_shift(4)}function sW(e){var t={};switch(t.xclrType=e.read_shift(2),t.nTintShade=e.read_shift(2),t.xclrType){case 0:e.l+=4;break;case 1:t.xclrValue=oW(e,4);break;case 2:t.xclrValue=ZA(e);break;case 3:t.xclrValue=iW(e);break;case 4:e.l+=4;break}return e.l+=8,t}function oW(e,t){return qn(e,t)}function lW(e,t){return qn(e,t)}function cW(e){var t=e.read_shift(2),r=e.read_shift(2)-4,n=[t];switch(t){case 4:case 5:case 7:case 8:case 9:case 10:case 11:case 13:n[1]=sW(e);break;case 6:n[1]=lW(e,r);break;case 14:case 15:n[1]=e.read_shift(r===1?1:2);break;default:throw new Error("Unrecognized ExtProp type: "+t+" "+r)}return n}function uW(e,t){var r=e.l+t;e.l+=2;var n=e.read_shift(2);e.l+=2;for(var a=e.read_shift(2),i=[];a-- >0;)i.push(cW(e,r-e.l));return{ixfe:n,ext:i}}function fW(e,t){t.forEach(function(r){switch(r[0]){}})}function hW(e,t){return{flags:e.read_shift(4),version:e.read_shift(4),name:Hn(e)}}function dW(e){for(var t=[],r=e.read_shift(4);r-- >0;)t.push([e.read_shift(4),e.read_shift(4)]);return t}function pW(e){return e.l+=4,e.read_shift(4)!=0}function mW(e,t,r){var n={Types:[],Cell:[],Value:[]},a=r||{},i=[],s=!1,o=2;return ao(e,function(l,c,u){switch(u){case 335:n.Types.push({name:l.name});break;case 51:l.forEach(function(f){o==1?n.Cell.push({type:n.Types[f[0]-1].name,index:f[1]}):o==0&&n.Value.push({type:n.Types[f[0]-1].name,index:f[1]})});break;case 337:o=l?1:0;break;case 338:o=2;break;case 35:i.push(u),s=!0;break;case 36:i.pop(),s=!1;break;default:if(!c.T){if(!s||a.WTF&&i[i.length-1]!=35)throw new Error("Unexpected record 0x"+u.toString(16))}}}),n}function gW(e,t,r){var n={Types:[],Cell:[],Value:[]};if(!e)return n;var a=!1,i=2,s;return e.replace(Gn,function(o){var l=wt(o);switch(gs(l[0])){case"<?xml":break;case"<metadata":case"</metadata>":break;case"<metadataTypes":case"</metadataTypes>":break;case"<metadataType":n.Types.push({name:l.name});break;case"</metadataType>":break;case"<futureMetadata":for(var c=0;c<n.Types.length;++c)n.Types[c].name==l.name&&(s=n.Types[c]);break;case"</futureMetadata>":break;case"<bk>":break;case"</bk>":break;case"<rc":i==1?n.Cell.push({type:n.Types[l.t-1].name,index:+l.v}):i==0&&n.Value.push({type:n.Types[l.t-1].name,index:+l.v});break;case"</rc>":break;case"<cellMetadata":i=1;break;case"</cellMetadata>":i=2;break;case"<valueMetadata":i=0;break;case"</valueMetadata>":i=2;break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":a=!0;break;case"</ext>":a=!1;break;case"<rvb":if(!s)break;s.offsets||(s.offsets=[]),s.offsets.push(+l.i);break;default:if(!a&&r.WTF)throw new Error("unrecognized "+l[0]+" in metadata")}return o}),n}function xW(e){var t=[];if(!e)return t;var r=1;return(e.match(Gn)||[]).forEach(function(n){var a=wt(n);switch(a[0]){case"<?xml":break;case"<calcChain":case"<calcChain>":case"</calcChain>":break;case"<c":delete a[0],a.i?r=a.i:a.i=r,t.push(a);break}}),t}function vW(e){var t={};t.i=e.read_shift(4);var r={};r.r=e.read_shift(4),r.c=e.read_shift(4),t.r=Nt(r);var n=e.read_shift(1);return n&2&&(t.l="1"),n&8&&(t.a="1"),t}function yW(e,t,r){var n=[];return ao(e,function(i,s,o){switch(o){case 63:n.push(i);break;default:if(!s.T)throw new Error("Unexpected record 0x"+o.toString(16))}}),n}function wW(e,t,r,n){if(!e)return e;var a=n||{},i=!1;ao(e,function(o,l,c){switch(c){case 359:case 363:case 364:case 366:case 367:case 368:case 369:case 370:case 371:case 472:case 577:case 578:case 579:case 580:case 581:case 582:case 583:case 584:case 585:case 586:case 587:break;case 35:i=!0;break;case 36:i=!1;break;default:if(!l.T){if(!i||a.WTF)throw new Error("Unexpected record 0x"+c.toString(16))}}},a)}function bW(e,t){if(!e)return"??";var r=(e.match(/<c:chart [^>]*r:id="([^"]*)"/)||["",""])[1];return t["!id"][r].Target}function c_(e,t,r,n){var a=Array.isArray(e),i;t.forEach(function(s){var o=ra(s.ref);if(a?(e[o.r]||(e[o.r]=[]),i=e[o.r][o.c]):i=e[s.ref],!i){i={t:"z"},a?e[o.r][o.c]=i:e[s.ref]=i;var l=Or(e["!ref"]||"BDWGO1000001:A1");l.s.r>o.r&&(l.s.r=o.r),l.e.r<o.r&&(l.e.r=o.r),l.s.c>o.c&&(l.s.c=o.c),l.e.c<o.c&&(l.e.c=o.c);var c=$t(l);c!==e["!ref"]&&(e["!ref"]=c)}i.c||(i.c=[]);var u={a:s.author,t:s.t,r:s.r,T:r};s.h&&(u.h=s.h);for(var f=i.c.length-1;f>=0;--f){if(!r&&i.c[f].T)return;r&&!i.c[f].T&&i.c.splice(f,1)}if(r&&n){for(f=0;f<n.length;++f)if(u.a==n[f].id){u.a=n[f].name||u.a;break}}i.c.push(u)})}function _W(e,t){if(e.match(/<(?:\w+:)?comments *\/>/))return[];var r=[],n=[],a=e.match(/<(?:\w+:)?authors>([\s\S]*)<\/(?:\w+:)?authors>/);a&&a[1]&&a[1].split(/<\/\w*:?author>/).forEach(function(s){if(!(s===""||s.trim()==="")){var o=s.match(/<(?:\w+:)?author[^>]*>(.*)/);o&&r.push(o[1])}});var i=e.match(/<(?:\w+:)?commentList>([\s\S]*)<\/(?:\w+:)?commentList>/);return i&&i[1]&&i[1].split(/<\/\w*:?comment>/).forEach(function(s){if(!(s===""||s.trim()==="")){var o=s.match(/<(?:\w+:)?comment[^>]*>/);if(o){var l=wt(o[0]),c={author:l.authorId&&r[l.authorId]||"sheetjsghost",ref:l.ref,guid:l.guid},u=ra(l.ref);if(!(t.sheetRows&&t.sheetRows<=u.r)){var f=s.match(/<(?:\w+:)?text>([\s\S]*)<\/(?:\w+:)?text>/),d=!!f&&!!f[1]&&j5(f[1])||{r:"",t:"",h:""};c.r=d.r,d.r=="<t></t>"&&(d.t=d.h=""),c.t=(d.t||"").replace(/\r\n/g,`
`).replace(/\r/g,`
`),t.cellHTML&&(c.h=d.h),n.push(c)}}}}),n}function SW(e,t){var r=[],n=!1,a={},i=0;return e.replace(Gn,function(o,l){var c=wt(o);switch(gs(c[0])){case"<?xml":break;case"<ThreadedComments":break;case"</ThreadedComments>":break;case"<threadedComment":a={author:c.personId,guid:c.id,ref:c.ref,T:1};break;case"</threadedComment>":a.t!=null&&r.push(a);break;case"<text>":case"<text":i=l+o.length;break;case"</text>":a.t=e.slice(i,l).replace(/\r\n/g,`
`).replace(/\r/g,`
`);break;case"<mentions":case"<mentions>":n=!0;break;case"</mentions>":n=!1;break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":n=!0;break;case"</ext>":n=!1;break;default:if(!n&&t.WTF)throw new Error("unrecognized "+c[0]+" in threaded comments")}return o}),r}function kW(e,t){var r=[],n=!1;return e.replace(Gn,function(i){var s=wt(i);switch(gs(s[0])){case"<?xml":break;case"<personList":break;case"</personList>":break;case"<person":r.push({name:s.displayname,id:s.id});break;case"</person>":break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":n=!0;break;case"</ext>":n=!1;break;default:if(!n&&t.WTF)throw new Error("unrecognized "+s[0]+" in threaded comments")}return i}),r}function EW(e){var t={};t.iauthor=e.read_shift(4);var r=xc(e);return t.rfx=r.s,t.ref=Nt(r.s),e.l+=16,t}var AW=Hn;function TW(e,t){var r=[],n=[],a={},i=!1;return ao(e,function(o,l,c){switch(c){case 632:n.push(o);break;case 635:a=o;break;case 637:a.t=o.t,a.h=o.h,a.r=o.r;break;case 636:if(a.author=n[a.iauthor],delete a.iauthor,t.sheetRows&&a.rfx&&t.sheetRows<=a.rfx.r)break;a.t||(a.t=""),delete a.rfx,r.push(a);break;case 3072:break;case 35:i=!0;break;case 36:i=!1;break;case 37:break;case 38:break;default:if(!l.T){if(!i||t.WTF)throw new Error("Unexpected record 0x"+c.toString(16))}}}),r}var CW="application/vnd.ms-office.vbaProject";function NW(e){var t=Ut.utils.cfb_new({root:"R"});return e.FullPaths.forEach(function(r,n){if(!(r.slice(-1)==="/"||!r.match(/_VBA_PROJECT_CUR/))){var a=r.replace(/^[^\/]*/,"R").replace(/\/_VBA_PROJECT_CUR\u0000*/,"");Ut.utils.cfb_add(t,a,e.FileIndex[n].content)}}),Ut.write(t)}function PW(){return{"!type":"dialog"}}function LW(){return{"!type":"dialog"}}function FW(){return{"!type":"macro"}}function OW(){return{"!type":"macro"}}var Pu=function(){var e=/(^|[^A-Za-z_])R(\[?-?\d+\]|[1-9]\d*|)C(\[?-?\d+\]|[1-9]\d*|)(?![A-Za-z0-9_])/g,t={r:0,c:0};function r(n,a,i,s){var o=!1,l=!1;i.length==0?l=!0:i.charAt(0)=="["&&(l=!0,i=i.slice(1,-1)),s.length==0?o=!0:s.charAt(0)=="["&&(o=!0,s=s.slice(1,-1));var c=i.length>0?parseInt(i,10)|0:0,u=s.length>0?parseInt(s,10)|0:0;return o?u+=t.c:--u,l?c+=t.r:--c,a+(o?"":"$")+sn(u)+(l?"":"$")+kn(c)}return function(a,i){return t=i,a.replace(e,r)}}(),pT=/(^|[^._A-Z0-9])([$]?)([A-Z]{1,2}|[A-W][A-Z]{2}|X[A-E][A-Z]|XF[A-D])([$]?)(10[0-3]\d{4}|104[0-7]\d{3}|1048[0-4]\d{2}|10485[0-6]\d|104857[0-6]|[1-9]\d{0,5})(?![_.\(A-Za-z0-9])/g,IW=function(){return function(t,r){return t.replace(pT,function(n,a,i,s,o,l){var c=P5(s)-(i?0:r.c),u=N5(l)-(o?0:r.r),f=u==0?"":o?u+1:"["+u+"]",d=c==0?"":i?c+1:"["+c+"]";return a+"R"+f+"C"+d})}}();function mT(e,t){return e.replace(pT,function(r,n,a,i,s,o){return n+(a=="$"?a+i:sn(P5(i)+t.c))+(s=="$"?s+o:kn(N5(o)+t.r))})}function DW(e,t,r){var n=o0(t),a=n.s,i=ra(r),s={r:i.r-a.r,c:i.c-a.c};return mT(e,s)}function jW(e){return e.length!=1}function u_(e){return e.replace(/_xlfn\./g,"")}function Kr(e){e.l+=1}function il(e,t){var r=e.read_shift(2);return[r&16383,r>>14&1,r>>15&1]}function gT(e,t,r){var n=2;if(r){if(r.biff>=2&&r.biff<=5)return xT(e);r.biff==12&&(n=4)}var a=e.read_shift(n),i=e.read_shift(n),s=il(e),o=il(e);return{s:{r:a,c:s[0],cRel:s[1],rRel:s[2]},e:{r:i,c:o[0],cRel:o[1],rRel:o[2]}}}function xT(e){var t=il(e),r=il(e),n=e.read_shift(1),a=e.read_shift(1);return{s:{r:t[0],c:n,cRel:t[1],rRel:t[2]},e:{r:r[0],c:a,cRel:r[1],rRel:r[2]}}}function RW(e,t,r){if(r.biff<8)return xT(e);var n=e.read_shift(r.biff==12?4:2),a=e.read_shift(r.biff==12?4:2),i=il(e),s=il(e);return{s:{r:n,c:i[0],cRel:i[1],rRel:i[2]},e:{r:a,c:s[0],cRel:s[1],rRel:s[2]}}}function vT(e,t,r){if(r&&r.biff>=2&&r.biff<=5)return MW(e);var n=e.read_shift(r&&r.biff==12?4:2),a=il(e);return{r:n,c:a[0],cRel:a[1],rRel:a[2]}}function MW(e){var t=il(e),r=e.read_shift(1);return{r:t[0],c:r,cRel:t[1],rRel:t[2]}}function BW(e){var t=e.read_shift(2),r=e.read_shift(2);return{r:t,c:r&255,fQuoted:!!(r&16384),cRel:r>>15,rRel:r>>15}}function UW(e,t,r){var n=r&&r.biff?r.biff:8;if(n>=2&&n<=5)return $W(e);var a=e.read_shift(n>=12?4:2),i=e.read_shift(2),s=(i&16384)>>14,o=(i&32768)>>15;if(i&=16383,o==1)for(;a>524287;)a-=1048576;if(s==1)for(;i>8191;)i=i-16384;return{r:a,c:i,cRel:s,rRel:o}}function $W(e){var t=e.read_shift(2),r=e.read_shift(1),n=(t&32768)>>15,a=(t&16384)>>14;return t&=16383,n==1&&t>=8192&&(t=t-16384),a==1&&r>=128&&(r=r-256),{r:t,c:r,cRel:a,rRel:n}}function VW(e,t,r){var n=(e[e.l++]&96)>>5,a=gT(e,r.biff>=2&&r.biff<=5?6:8,r);return[n,a]}function zW(e,t,r){var n=(e[e.l++]&96)>>5,a=e.read_shift(2,"i"),i=8;if(r)switch(r.biff){case 5:e.l+=12,i=6;break;case 12:i=12;break}var s=gT(e,i,r);return[n,a,s]}function HW(e,t,r){var n=(e[e.l++]&96)>>5;return e.l+=r&&r.biff>8?12:r.biff<8?6:8,[n]}function WW(e,t,r){var n=(e[e.l++]&96)>>5,a=e.read_shift(2),i=8;if(r)switch(r.biff){case 5:e.l+=12,i=6;break;case 12:i=12;break}return e.l+=i,[n,a]}function qW(e,t,r){var n=(e[e.l++]&96)>>5,a=RW(e,t-1,r);return[n,a]}function GW(e,t,r){var n=(e[e.l++]&96)>>5;return e.l+=r.biff==2?6:r.biff==12?14:7,[n]}function f_(e){var t=e[e.l+1]&1,r=1;return e.l+=4,[t,r]}function KW(e,t,r){e.l+=2;for(var n=e.read_shift(r&&r.biff==2?1:2),a=[],i=0;i<=n;++i)a.push(e.read_shift(r&&r.biff==2?1:2));return a}function XW(e,t,r){var n=e[e.l+1]&255?1:0;return e.l+=2,[n,e.read_shift(r&&r.biff==2?1:2)]}function YW(e,t,r){var n=e[e.l+1]&255?1:0;return e.l+=2,[n,e.read_shift(r&&r.biff==2?1:2)]}function JW(e){var t=e[e.l+1]&255?1:0;return e.l+=2,[t,e.read_shift(2)]}function QW(e,t,r){var n=e[e.l+1]&255?1:0;return e.l+=r&&r.biff==2?3:4,[n]}function yT(e){var t=e.read_shift(1),r=e.read_shift(1);return[t,r]}function ZW(e){return e.read_shift(2),yT(e)}function eq(e){return e.read_shift(2),yT(e)}function tq(e,t,r){var n=(e[e.l]&96)>>5;e.l+=1;var a=vT(e,0,r);return[n,a]}function rq(e,t,r){var n=(e[e.l]&96)>>5;e.l+=1;var a=UW(e,0,r);return[n,a]}function nq(e,t,r){var n=(e[e.l]&96)>>5;e.l+=1;var a=e.read_shift(2);r&&r.biff==5&&(e.l+=12);var i=vT(e,0,r);return[n,a,i]}function aq(e,t,r){var n=(e[e.l]&96)>>5;e.l+=1;var a=e.read_shift(r&&r.biff<=3?1:2);return[iG[a],_T[a],n]}function iq(e,t,r){var n=e[e.l++],a=e.read_shift(1),i=r&&r.biff<=3?[n==88?-1:0,e.read_shift(1)]:sq(e);return[a,(i[0]===0?_T:aG)[i[1]]]}function sq(e){return[e[e.l+1]>>7,e.read_shift(2)&32767]}function oq(e,t,r){e.l+=r&&r.biff==2?3:4}function lq(e,t,r){if(e.l++,r&&r.biff==12)return[e.read_shift(4,"i"),0];var n=e.read_shift(2),a=e.read_shift(r&&r.biff==2?1:2);return[n,a]}function cq(e){return e.l++,vc[e.read_shift(1)]}function uq(e){return e.l++,e.read_shift(2)}function fq(e){return e.l++,e.read_shift(1)!==0}function hq(e){return e.l++,$n(e)}function dq(e,t,r){return e.l++,Vh(e,t-1,r)}function pq(e,t){var r=[e.read_shift(1)];if(t==12)switch(r[0]){case 2:r[0]=4;break;case 4:r[0]=16;break;case 0:r[0]=1;break;case 1:r[0]=2;break}switch(r[0]){case 4:r[1]=Mr(e,1)?"TRUE":"FALSE",t!=12&&(e.l+=7);break;case 37:case 16:r[1]=vc[e[e.l]],e.l+=t==12?4:8;break;case 0:e.l+=8;break;case 1:r[1]=$n(e);break;case 2:r[1]=yc(e,0,{biff:t>0&&t<8?2:t});break;default:throw new Error("Bad SerAr: "+r[0])}return r}function mq(e,t,r){for(var n=e.read_shift(r.biff==12?4:2),a=[],i=0;i!=n;++i)a.push((r.biff==12?xc:Dm)(e));return a}function gq(e,t,r){var n=0,a=0;r.biff==12?(n=e.read_shift(4),a=e.read_shift(4)):(a=1+e.read_shift(1),n=1+e.read_shift(2)),r.biff>=2&&r.biff<8&&(--n,--a==0&&(a=256));for(var i=0,s=[];i!=n&&(s[i]=[]);++i)for(var o=0;o!=a;++o)s[i][o]=pq(e,r.biff);return s}function xq(e,t,r){var n=e.read_shift(1)>>>5&3,a=!r||r.biff>=8?4:2,i=e.read_shift(a);switch(r.biff){case 2:e.l+=5;break;case 3:case 4:e.l+=8;break;case 5:e.l+=12;break}return[n,0,i]}function vq(e,t,r){if(r.biff==5)return yq(e);var n=e.read_shift(1)>>>5&3,a=e.read_shift(2),i=e.read_shift(4);return[n,a,i]}function yq(e){var t=e.read_shift(1)>>>5&3,r=e.read_shift(2,"i");e.l+=8;var n=e.read_shift(2);return e.l+=12,[t,r,n]}function wq(e,t,r){var n=e.read_shift(1)>>>5&3;e.l+=r&&r.biff==2?3:4;var a=e.read_shift(r&&r.biff==2?1:2);return[n,a]}function bq(e,t,r){var n=e.read_shift(1)>>>5&3,a=e.read_shift(r&&r.biff==2?1:2);return[n,a]}function _q(e,t,r){var n=e.read_shift(1)>>>5&3;return e.l+=4,r.biff<8&&e.l--,r.biff==12&&(e.l+=2),[n]}function Sq(e,t,r){var n=(e[e.l++]&96)>>5,a=e.read_shift(2),i=4;if(r)switch(r.biff){case 5:i=15;break;case 12:i=6;break}return e.l+=i,[n,a]}var kq=qn,Eq=qn,Aq=qn;function Hh(e,t,r){return e.l+=2,[BW(e)]}function M5(e){return e.l+=6,[]}var Tq=Hh,Cq=M5,Nq=M5,Pq=Hh;function wT(e){return e.l+=2,[Jr(e),e.read_shift(2)&1]}var Lq=Hh,Fq=wT,Oq=M5,Iq=Hh,Dq=Hh,jq=["Data","All","Headers","??","?Data2","??","?DataHeaders","??","Totals","??","??","??","?DataTotals","??","??","??","?Current"];function Rq(e){e.l+=2;var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(4),a=e.read_shift(2),i=e.read_shift(2),s=jq[r>>2&31];return{ixti:t,coltype:r&3,rt:s,idx:n,c:a,C:i}}function Mq(e){return e.l+=2,[e.read_shift(4)]}function Bq(e,t,r){return e.l+=5,e.l+=2,e.l+=r.biff==2?1:4,["PTGSHEET"]}function Uq(e,t,r){return e.l+=r.biff==2?4:5,["PTGENDSHEET"]}function $q(e){var t=e.read_shift(1)>>>5&3,r=e.read_shift(2);return[t,r]}function Vq(e){var t=e.read_shift(1)>>>5&3,r=e.read_shift(2);return[t,r]}function zq(e){return e.l+=4,[0,0]}var h_={1:{n:"PtgExp",f:lq},2:{n:"PtgTbl",f:Aq},3:{n:"PtgAdd",f:Kr},4:{n:"PtgSub",f:Kr},5:{n:"PtgMul",f:Kr},6:{n:"PtgDiv",f:Kr},7:{n:"PtgPower",f:Kr},8:{n:"PtgConcat",f:Kr},9:{n:"PtgLt",f:Kr},10:{n:"PtgLe",f:Kr},11:{n:"PtgEq",f:Kr},12:{n:"PtgGe",f:Kr},13:{n:"PtgGt",f:Kr},14:{n:"PtgNe",f:Kr},15:{n:"PtgIsect",f:Kr},16:{n:"PtgUnion",f:Kr},17:{n:"PtgRange",f:Kr},18:{n:"PtgUplus",f:Kr},19:{n:"PtgUminus",f:Kr},20:{n:"PtgPercent",f:Kr},21:{n:"PtgParen",f:Kr},22:{n:"PtgMissArg",f:Kr},23:{n:"PtgStr",f:dq},26:{n:"PtgSheet",f:Bq},27:{n:"PtgEndSheet",f:Uq},28:{n:"PtgErr",f:cq},29:{n:"PtgBool",f:fq},30:{n:"PtgInt",f:uq},31:{n:"PtgNum",f:hq},32:{n:"PtgArray",f:GW},33:{n:"PtgFunc",f:aq},34:{n:"PtgFuncVar",f:iq},35:{n:"PtgName",f:xq},36:{n:"PtgRef",f:tq},37:{n:"PtgArea",f:VW},38:{n:"PtgMemArea",f:wq},39:{n:"PtgMemErr",f:kq},40:{n:"PtgMemNoMem",f:Eq},41:{n:"PtgMemFunc",f:bq},42:{n:"PtgRefErr",f:_q},43:{n:"PtgAreaErr",f:HW},44:{n:"PtgRefN",f:rq},45:{n:"PtgAreaN",f:qW},46:{n:"PtgMemAreaN",f:$q},47:{n:"PtgMemNoMemN",f:Vq},57:{n:"PtgNameX",f:vq},58:{n:"PtgRef3d",f:nq},59:{n:"PtgArea3d",f:zW},60:{n:"PtgRefErr3d",f:Sq},61:{n:"PtgAreaErr3d",f:WW},255:{}},Hq={64:32,96:32,65:33,97:33,66:34,98:34,67:35,99:35,68:36,100:36,69:37,101:37,70:38,102:38,71:39,103:39,72:40,104:40,73:41,105:41,74:42,106:42,75:43,107:43,76:44,108:44,77:45,109:45,78:46,110:46,79:47,111:47,88:34,120:34,89:57,121:57,90:58,122:58,91:59,123:59,92:60,124:60,93:61,125:61},Wq={1:{n:"PtgElfLel",f:wT},2:{n:"PtgElfRw",f:Iq},3:{n:"PtgElfCol",f:Tq},6:{n:"PtgElfRwV",f:Dq},7:{n:"PtgElfColV",f:Pq},10:{n:"PtgElfRadical",f:Lq},11:{n:"PtgElfRadicalS",f:Oq},13:{n:"PtgElfColS",f:Cq},15:{n:"PtgElfColSV",f:Nq},16:{n:"PtgElfRadicalLel",f:Fq},25:{n:"PtgList",f:Rq},29:{n:"PtgSxName",f:Mq},255:{}},qq={0:{n:"PtgAttrNoop",f:zq},1:{n:"PtgAttrSemi",f:QW},2:{n:"PtgAttrIf",f:YW},4:{n:"PtgAttrChoose",f:KW},8:{n:"PtgAttrGoto",f:XW},16:{n:"PtgAttrSum",f:oq},32:{n:"PtgAttrBaxcel",f:f_},33:{n:"PtgAttrBaxcel",f:f_},64:{n:"PtgAttrSpace",f:ZW},65:{n:"PtgAttrSpaceSemi",f:eq},128:{n:"PtgAttrIfError",f:JW},255:{}};function Wh(e,t,r,n){if(n.biff<8)return qn(e,t);for(var a=e.l+t,i=[],s=0;s!==r.length;++s)switch(r[s][0]){case"PtgArray":r[s][1]=gq(e,0,n),i.push(r[s][1]);break;case"PtgMemArea":r[s][2]=mq(e,r[s][1],n),i.push(r[s][2]);break;case"PtgExp":n&&n.biff==12&&(r[s][1][1]=e.read_shift(4),i.push(r[s][1]));break;case"PtgList":case"PtgElfRadicalS":case"PtgElfColS":case"PtgElfColSV":throw"Unsupported "+r[s][0]}return t=a-e.l,t!==0&&i.push(qn(e,t)),i}function qh(e,t,r){for(var n=e.l+t,a,i,s=[];n!=e.l;)t=n-e.l,i=e[e.l],a=h_[i]||h_[Hq[i]],(i===24||i===25)&&(a=(i===24?Wq:qq)[e[e.l+1]]),!a||!a.f?qn(e,t):s.push([a.n,a.f(e,t,r)]);return s}function Gq(e){for(var t=[],r=0;r<e.length;++r){for(var n=e[r],a=[],i=0;i<n.length;++i){var s=n[i];if(s)switch(s[0]){case 2:a.push('"'+s[1].replace(/"/g,'""')+'"');break;default:a.push(s[1])}else a.push("")}t.push(a.join(","))}return t.join(";")}var Kq={PtgAdd:"+",PtgConcat:"&",PtgDiv:"/",PtgEq:"=",PtgGe:">=",PtgGt:">",PtgLe:"<=",PtgLt:"<",PtgMul:"*",PtgNe:"<>",PtgPower:"^",PtgSub:"-"};function Xq(e,t){if(!e&&!(t&&t.biff<=5&&t.biff>=2))throw new Error("empty sheet name");return/[^\w\u4E00-\u9FFF\u3040-\u30FF]/.test(e)?"'"+e+"'":e}function bT(e,t,r){if(!e)return"SH33TJSERR0";if(r.biff>8&&(!e.XTI||!e.XTI[t]))return e.SheetNames[t];if(!e.XTI)return"SH33TJSERR6";var n=e.XTI[t];if(r.biff<8)return t>1e4&&(t-=65536),t<0&&(t=-t),t==0?"":e.XTI[t-1];if(!n)return"SH33TJSERR1";var a="";if(r.biff>8)switch(e[n[0]][0]){case 357:return a=n[1]==-1?"#REF":e.SheetNames[n[1]],n[1]==n[2]?a:a+":"+e.SheetNames[n[2]];case 358:return r.SID!=null?e.SheetNames[r.SID]:"SH33TJSSAME"+e[n[0]][0];case 355:default:return"SH33TJSSRC"+e[n[0]][0]}switch(e[n[0]][0][0]){case 1025:return a=n[1]==-1?"#REF":e.SheetNames[n[1]]||"SH33TJSERR3",n[1]==n[2]?a:a+":"+e.SheetNames[n[2]];case 14849:return e[n[0]].slice(1).map(function(i){return i.Name}).join(";;");default:return e[n[0]][0][3]?(a=n[1]==-1?"#REF":e[n[0]][0][3][n[1]]||"SH33TJSERR4",n[1]==n[2]?a:a+":"+e[n[0]][0][3][n[2]]):"SH33TJSERR2"}}function d_(e,t,r){var n=bT(e,t,r);return n=="#REF"?n:Xq(n,r)}function Bn(e,t,r,n,a){var i=a&&a.biff||8,s={s:{c:0,r:0},e:{c:0,r:0}},o=[],l,c,u,f=0,d=0,h,g="";if(!e[0]||!e[0][0])return"";for(var m=-1,_="",y=0,b=e[0].length;y<b;++y){var w=e[0][y];switch(w[0]){case"PtgUminus":o.push("-"+o.pop());break;case"PtgUplus":o.push("+"+o.pop());break;case"PtgPercent":o.push(o.pop()+"%");break;case"PtgAdd":case"PtgConcat":case"PtgDiv":case"PtgEq":case"PtgGe":case"PtgGt":case"PtgLe":case"PtgLt":case"PtgMul":case"PtgNe":case"PtgPower":case"PtgSub":if(l=o.pop(),c=o.pop(),m>=0){switch(e[0][m][1][0]){case 0:_=Fr(" ",e[0][m][1][1]);break;case 1:_=Fr("\r",e[0][m][1][1]);break;default:if(_="",a.WTF)throw new Error("Unexpected PtgAttrSpaceType "+e[0][m][1][0])}c=c+_,m=-1}o.push(c+Kq[w[0]]+l);break;case"PtgIsect":l=o.pop(),c=o.pop(),o.push(c+" "+l);break;case"PtgUnion":l=o.pop(),c=o.pop(),o.push(c+","+l);break;case"PtgRange":l=o.pop(),c=o.pop(),o.push(c+":"+l);break;case"PtgAttrChoose":break;case"PtgAttrGoto":break;case"PtgAttrIf":break;case"PtgAttrIfError":break;case"PtgRef":u=Pf(w[1][1],s,a),o.push(Lf(u,i));break;case"PtgRefN":u=r?Pf(w[1][1],r,a):w[1][1],o.push(Lf(u,i));break;case"PtgRef3d":f=w[1][1],u=Pf(w[1][2],s,a),g=d_(n,f,a),o.push(g+"!"+Lf(u,i));break;case"PtgFunc":case"PtgFuncVar":var T=w[1][0],F=w[1][1];T||(T=0),T&=127;var I=T==0?[]:o.slice(-T);o.length-=T,F==="User"&&(F=I.shift()),o.push(F+"("+I.join(",")+")");break;case"PtgBool":o.push(w[1]?"TRUE":"FALSE");break;case"PtgInt":o.push(w[1]);break;case"PtgNum":o.push(String(w[1]));break;case"PtgStr":o.push('"'+w[1].replace(/"/g,'""')+'"');break;case"PtgErr":o.push(w[1]);break;case"PtgAreaN":h=G3(w[1][1],r?{s:r}:s,a),o.push(w2(h,a));break;case"PtgArea":h=G3(w[1][1],s,a),o.push(w2(h,a));break;case"PtgArea3d":f=w[1][1],h=w[1][2],g=d_(n,f,a),o.push(g+"!"+w2(h,a));break;case"PtgAttrSum":o.push("SUM("+o.pop()+")");break;case"PtgAttrBaxcel":case"PtgAttrSemi":break;case"PtgName":d=w[1][2];var A=(n.names||[])[d-1]||(n[0]||[])[d],P=A?A.Name:"SH33TJSNAME"+String(d);P&&P.slice(0,6)=="_xlfn."&&!a.xlfn&&(P=P.slice(6)),o.push(P);break;case"PtgNameX":var j=w[1][1];d=w[1][2];var J;if(a.biff<=5)j<0&&(j=-j),n[j]&&(J=n[j][d]);else{var N="";if(((n[j]||[])[0]||[])[0]==14849||(((n[j]||[])[0]||[])[0]==1025?n[j][d]&&n[j][d].itab>0&&(N=n.SheetNames[n[j][d].itab-1]+"!"):N=n.SheetNames[d-1]+"!"),n[j]&&n[j][d])N+=n[j][d].Name;else if(n[0]&&n[0][d])N+=n[0][d].Name;else{var L=(bT(n,j,a)||"").split(";;");L[d-1]?N=L[d-1]:N+="SH33TJSERRX"}o.push(N);break}J||(J={Name:"SH33TJSERRY"}),o.push(J.Name);break;case"PtgParen":var G="(",W=")";if(m>=0){switch(_="",e[0][m][1][0]){case 2:G=Fr(" ",e[0][m][1][1])+G;break;case 3:G=Fr("\r",e[0][m][1][1])+G;break;case 4:W=Fr(" ",e[0][m][1][1])+W;break;case 5:W=Fr("\r",e[0][m][1][1])+W;break;default:if(a.WTF)throw new Error("Unexpected PtgAttrSpaceType "+e[0][m][1][0])}m=-1}o.push(G+o.pop()+W);break;case"PtgRefErr":o.push("#REF!");break;case"PtgRefErr3d":o.push("#REF!");break;case"PtgExp":u={c:w[1][1],r:w[1][0]};var le={c:r.c,r:r.r};if(n.sharedf[Nt(u)]){var de=n.sharedf[Nt(u)];o.push(Bn(de,s,le,n,a))}else{var X=!1;for(l=0;l!=n.arrayf.length;++l)if(c=n.arrayf[l],!(u.c<c[0].s.c||u.c>c[0].e.c)&&!(u.r<c[0].s.r||u.r>c[0].e.r)){o.push(Bn(c[1],s,le,n,a)),X=!0;break}X||o.push(w[1])}break;case"PtgArray":o.push("{"+Gq(w[1])+"}");break;case"PtgMemArea":break;case"PtgAttrSpace":case"PtgAttrSpaceSemi":m=y;break;case"PtgTbl":break;case"PtgMemErr":break;case"PtgMissArg":o.push("");break;case"PtgAreaErr":o.push("#REF!");break;case"PtgAreaErr3d":o.push("#REF!");break;case"PtgList":o.push("Table"+w[1].idx+"[#"+w[1].rt+"]");break;case"PtgMemAreaN":case"PtgMemNoMemN":case"PtgAttrNoop":case"PtgSheet":case"PtgEndSheet":break;case"PtgMemFunc":break;case"PtgMemNoMem":break;case"PtgElfCol":case"PtgElfColS":case"PtgElfColSV":case"PtgElfColV":case"PtgElfLel":case"PtgElfRadical":case"PtgElfRadicalLel":case"PtgElfRadicalS":case"PtgElfRw":case"PtgElfRwV":throw new Error("Unsupported ELFs");case"PtgSxName":throw new Error("Unrecognized Formula Token: "+String(w));default:throw new Error("Unrecognized Formula Token: "+String(w))}var ee=["PtgAttrSpace","PtgAttrSpaceSemi","PtgAttrGoto"];if(a.biff!=3&&m>=0&&ee.indexOf(e[0][y][0])==-1){w=e[0][m];var R=!0;switch(w[1][0]){case 4:R=!1;case 0:_=Fr(" ",w[1][1]);break;case 5:R=!1;case 1:_=Fr("\r",w[1][1]);break;default:if(_="",a.WTF)throw new Error("Unexpected PtgAttrSpaceType "+w[1][0])}o.push((R?_:"")+o.pop()+(R?"":_)),m=-1}}if(o.length>1&&a.WTF)throw new Error("bad formula stack");return o[0]}function Yq(e,t,r){var n=e.l+t,a=r.biff==2?1:2,i,s=e.read_shift(a);if(s==65535)return[[],qn(e,t-2)];var o=qh(e,s,r);return t!==s+a&&(i=Wh(e,t-s-a,o,r)),e.l=n,[o,i]}function Jq(e,t,r){var n=e.l+t,a=r.biff==2?1:2,i,s=e.read_shift(a);if(s==65535)return[[],qn(e,t-2)];var o=qh(e,s,r);return t!==s+a&&(i=Wh(e,t-s-a,o,r)),e.l=n,[o,i]}function Qq(e,t,r,n){var a=e.l+t,i=qh(e,n,r),s;return a!==e.l&&(s=Wh(e,a-e.l,i,r)),[i,s]}function Zq(e,t,r){var n=e.l+t,a,i=e.read_shift(2),s=qh(e,i,r);return i==65535?[[],qn(e,t-2)]:(t!==i+2&&(a=Wh(e,n-i-2,s,r)),[s,a])}function eG(e){var t;if(Bs(e,e.l+6)!==65535)return[$n(e),"n"];switch(e[e.l]){case 0:return e.l+=8,["String","s"];case 1:return t=e[e.l+2]===1,e.l+=8,[t,"b"];case 2:return t=e[e.l+2],e.l+=8,[t,"e"];case 3:return e.l+=8,["","s"]}return[]}function S2(e,t,r){var n=e.l+t,a=xs(e);r.biff==2&&++e.l;var i=eG(e),s=e.read_shift(1);r.biff!=2&&(e.read_shift(1),r.biff>=5&&e.read_shift(4));var o=Jq(e,n-e.l,r);return{cell:a,val:i[0],formula:o,shared:s>>3&1,tt:i[1]}}function jm(e,t,r){var n=e.read_shift(4),a=qh(e,n,r),i=e.read_shift(4),s=i>0?Wh(e,i,a,r):null;return[a,s]}var tG=jm,Rm=jm,rG=jm,nG=jm,aG={0:"BEEP",1:"OPEN",2:"OPEN.LINKS",3:"CLOSE.ALL",4:"SAVE",5:"SAVE.AS",6:"FILE.DELETE",7:"PAGE.SETUP",8:"PRINT",9:"PRINTER.SETUP",10:"QUIT",11:"NEW.WINDOW",12:"ARRANGE.ALL",13:"WINDOW.SIZE",14:"WINDOW.MOVE",15:"FULL",16:"CLOSE",17:"RUN",22:"SET.PRINT.AREA",23:"SET.PRINT.TITLES",24:"SET.PAGE.BREAK",25:"REMOVE.PAGE.BREAK",26:"FONT",27:"DISPLAY",28:"PROTECT.DOCUMENT",29:"PRECISION",30:"A1.R1C1",31:"CALCULATE.NOW",32:"CALCULATION",34:"DATA.FIND",35:"EXTRACT",36:"DATA.DELETE",37:"SET.DATABASE",38:"SET.CRITERIA",39:"SORT",40:"DATA.SERIES",41:"TABLE",42:"FORMAT.NUMBER",43:"ALIGNMENT",44:"STYLE",45:"BORDER",46:"CELL.PROTECTION",47:"COLUMN.WIDTH",48:"UNDO",49:"CUT",50:"COPY",51:"PASTE",52:"CLEAR",53:"PASTE.SPECIAL",54:"EDIT.DELETE",55:"INSERT",56:"FILL.RIGHT",57:"FILL.DOWN",61:"DEFINE.NAME",62:"CREATE.NAMES",63:"FORMULA.GOTO",64:"FORMULA.FIND",65:"SELECT.LAST.CELL",66:"SHOW.ACTIVE.CELL",67:"GALLERY.AREA",68:"GALLERY.BAR",69:"GALLERY.COLUMN",70:"GALLERY.LINE",71:"GALLERY.PIE",72:"GALLERY.SCATTER",73:"COMBINATION",74:"PREFERRED",75:"ADD.OVERLAY",76:"GRIDLINES",77:"SET.PREFERRED",78:"AXES",79:"LEGEND",80:"ATTACH.TEXT",81:"ADD.ARROW",82:"SELECT.CHART",83:"SELECT.PLOT.AREA",84:"PATTERNS",85:"MAIN.CHART",86:"OVERLAY",87:"SCALE",88:"FORMAT.LEGEND",89:"FORMAT.TEXT",90:"EDIT.REPEAT",91:"PARSE",92:"JUSTIFY",93:"HIDE",94:"UNHIDE",95:"WORKSPACE",96:"FORMULA",97:"FORMULA.FILL",98:"FORMULA.ARRAY",99:"DATA.FIND.NEXT",100:"DATA.FIND.PREV",101:"FORMULA.FIND.NEXT",102:"FORMULA.FIND.PREV",103:"ACTIVATE",104:"ACTIVATE.NEXT",105:"ACTIVATE.PREV",106:"UNLOCKED.NEXT",107:"UNLOCKED.PREV",108:"COPY.PICTURE",109:"SELECT",110:"DELETE.NAME",111:"DELETE.FORMAT",112:"VLINE",113:"HLINE",114:"VPAGE",115:"HPAGE",116:"VSCROLL",117:"HSCROLL",118:"ALERT",119:"NEW",120:"CANCEL.COPY",121:"SHOW.CLIPBOARD",122:"MESSAGE",124:"PASTE.LINK",125:"APP.ACTIVATE",126:"DELETE.ARROW",127:"ROW.HEIGHT",128:"FORMAT.MOVE",129:"FORMAT.SIZE",130:"FORMULA.REPLACE",131:"SEND.KEYS",132:"SELECT.SPECIAL",133:"APPLY.NAMES",134:"REPLACE.FONT",135:"FREEZE.PANES",136:"SHOW.INFO",137:"SPLIT",138:"ON.WINDOW",139:"ON.DATA",140:"DISABLE.INPUT",142:"OUTLINE",143:"LIST.NAMES",144:"FILE.CLOSE",145:"SAVE.WORKBOOK",146:"DATA.FORM",147:"COPY.CHART",148:"ON.TIME",149:"WAIT",150:"FORMAT.FONT",151:"FILL.UP",152:"FILL.LEFT",153:"DELETE.OVERLAY",155:"SHORT.MENUS",159:"SET.UPDATE.STATUS",161:"COLOR.PALETTE",162:"DELETE.STYLE",163:"WINDOW.RESTORE",164:"WINDOW.MAXIMIZE",166:"CHANGE.LINK",167:"CALCULATE.DOCUMENT",168:"ON.KEY",169:"APP.RESTORE",170:"APP.MOVE",171:"APP.SIZE",172:"APP.MINIMIZE",173:"APP.MAXIMIZE",174:"BRING.TO.FRONT",175:"SEND.TO.BACK",185:"MAIN.CHART.TYPE",186:"OVERLAY.CHART.TYPE",187:"SELECT.END",188:"OPEN.MAIL",189:"SEND.MAIL",190:"STANDARD.FONT",191:"CONSOLIDATE",192:"SORT.SPECIAL",193:"GALLERY.3D.AREA",194:"GALLERY.3D.COLUMN",195:"GALLERY.3D.LINE",196:"GALLERY.3D.PIE",197:"VIEW.3D",198:"GOAL.SEEK",199:"WORKGROUP",200:"FILL.GROUP",201:"UPDATE.LINK",202:"PROMOTE",203:"DEMOTE",204:"SHOW.DETAIL",206:"UNGROUP",207:"OBJECT.PROPERTIES",208:"SAVE.NEW.OBJECT",209:"SHARE",210:"SHARE.NAME",211:"DUPLICATE",212:"APPLY.STYLE",213:"ASSIGN.TO.OBJECT",214:"OBJECT.PROTECTION",215:"HIDE.OBJECT",216:"SET.EXTRACT",217:"CREATE.PUBLISHER",218:"SUBSCRIBE.TO",219:"ATTRIBUTES",220:"SHOW.TOOLBAR",222:"PRINT.PREVIEW",223:"EDIT.COLOR",224:"SHOW.LEVELS",225:"FORMAT.MAIN",226:"FORMAT.OVERLAY",227:"ON.RECALC",228:"EDIT.SERIES",229:"DEFINE.STYLE",240:"LINE.PRINT",243:"ENTER.DATA",249:"GALLERY.RADAR",250:"MERGE.STYLES",251:"EDITION.OPTIONS",252:"PASTE.PICTURE",253:"PASTE.PICTURE.LINK",254:"SPELLING",256:"ZOOM",259:"INSERT.OBJECT",260:"WINDOW.MINIMIZE",265:"SOUND.NOTE",266:"SOUND.PLAY",267:"FORMAT.SHAPE",268:"EXTEND.POLYGON",269:"FORMAT.AUTO",272:"GALLERY.3D.BAR",273:"GALLERY.3D.SURFACE",274:"FILL.AUTO",276:"CUSTOMIZE.TOOLBAR",277:"ADD.TOOL",278:"EDIT.OBJECT",279:"ON.DOUBLECLICK",280:"ON.ENTRY",281:"WORKBOOK.ADD",282:"WORKBOOK.MOVE",283:"WORKBOOK.COPY",284:"WORKBOOK.OPTIONS",285:"SAVE.WORKSPACE",288:"CHART.WIZARD",289:"DELETE.TOOL",290:"MOVE.TOOL",291:"WORKBOOK.SELECT",292:"WORKBOOK.ACTIVATE",293:"ASSIGN.TO.TOOL",295:"COPY.TOOL",296:"RESET.TOOL",297:"CONSTRAIN.NUMERIC",298:"PASTE.TOOL",302:"WORKBOOK.NEW",305:"SCENARIO.CELLS",306:"SCENARIO.DELETE",307:"SCENARIO.ADD",308:"SCENARIO.EDIT",309:"SCENARIO.SHOW",310:"SCENARIO.SHOW.NEXT",311:"SCENARIO.SUMMARY",312:"PIVOT.TABLE.WIZARD",313:"PIVOT.FIELD.PROPERTIES",314:"PIVOT.FIELD",315:"PIVOT.ITEM",316:"PIVOT.ADD.FIELDS",318:"OPTIONS.CALCULATION",319:"OPTIONS.EDIT",320:"OPTIONS.VIEW",321:"ADDIN.MANAGER",322:"MENU.EDITOR",323:"ATTACH.TOOLBARS",324:"VBAActivate",325:"OPTIONS.CHART",328:"VBA.INSERT.FILE",330:"VBA.PROCEDURE.DEFINITION",336:"ROUTING.SLIP",338:"ROUTE.DOCUMENT",339:"MAIL.LOGON",342:"INSERT.PICTURE",343:"EDIT.TOOL",344:"GALLERY.DOUGHNUT",350:"CHART.TREND",352:"PIVOT.ITEM.PROPERTIES",354:"WORKBOOK.INSERT",355:"OPTIONS.TRANSITION",356:"OPTIONS.GENERAL",370:"FILTER.ADVANCED",373:"MAIL.ADD.MAILER",374:"MAIL.DELETE.MAILER",375:"MAIL.REPLY",376:"MAIL.REPLY.ALL",377:"MAIL.FORWARD",378:"MAIL.NEXT.LETTER",379:"DATA.LABEL",380:"INSERT.TITLE",381:"FONT.PROPERTIES",382:"MACRO.OPTIONS",383:"WORKBOOK.HIDE",384:"WORKBOOK.UNHIDE",385:"WORKBOOK.DELETE",386:"WORKBOOK.NAME",388:"GALLERY.CUSTOM",390:"ADD.CHART.AUTOFORMAT",391:"DELETE.CHART.AUTOFORMAT",392:"CHART.ADD.DATA",393:"AUTO.OUTLINE",394:"TAB.ORDER",395:"SHOW.DIALOG",396:"SELECT.ALL",397:"UNGROUP.SHEETS",398:"SUBTOTAL.CREATE",399:"SUBTOTAL.REMOVE",400:"RENAME.OBJECT",412:"WORKBOOK.SCROLL",413:"WORKBOOK.NEXT",414:"WORKBOOK.PREV",415:"WORKBOOK.TAB.SPLIT",416:"FULL.SCREEN",417:"WORKBOOK.PROTECT",420:"SCROLLBAR.PROPERTIES",421:"PIVOT.SHOW.PAGES",422:"TEXT.TO.COLUMNS",423:"FORMAT.CHARTTYPE",424:"LINK.FORMAT",425:"TRACER.DISPLAY",430:"TRACER.NAVIGATE",431:"TRACER.CLEAR",432:"TRACER.ERROR",433:"PIVOT.FIELD.GROUP",434:"PIVOT.FIELD.UNGROUP",435:"CHECKBOX.PROPERTIES",436:"LABEL.PROPERTIES",437:"LISTBOX.PROPERTIES",438:"EDITBOX.PROPERTIES",439:"PIVOT.REFRESH",440:"LINK.COMBO",441:"OPEN.TEXT",442:"HIDE.DIALOG",443:"SET.DIALOG.FOCUS",444:"ENABLE.OBJECT",445:"PUSHBUTTON.PROPERTIES",446:"SET.DIALOG.DEFAULT",447:"FILTER",448:"FILTER.SHOW.ALL",449:"CLEAR.OUTLINE",450:"FUNCTION.WIZARD",451:"ADD.LIST.ITEM",452:"SET.LIST.ITEM",453:"REMOVE.LIST.ITEM",454:"SELECT.LIST.ITEM",455:"SET.CONTROL.VALUE",456:"SAVE.COPY.AS",458:"OPTIONS.LISTS.ADD",459:"OPTIONS.LISTS.DELETE",460:"SERIES.AXES",461:"SERIES.X",462:"SERIES.Y",463:"ERRORBAR.X",464:"ERRORBAR.Y",465:"FORMAT.CHART",466:"SERIES.ORDER",467:"MAIL.LOGOFF",468:"CLEAR.ROUTING.SLIP",469:"APP.ACTIVATE.MICROSOFT",470:"MAIL.EDIT.MAILER",471:"ON.SHEET",472:"STANDARD.WIDTH",473:"SCENARIO.MERGE",474:"SUMMARY.INFO",475:"FIND.FILE",476:"ACTIVE.CELL.FONT",477:"ENABLE.TIPWIZARD",478:"VBA.MAKE.ADDIN",480:"INSERTDATATABLE",481:"WORKGROUP.OPTIONS",482:"MAIL.SEND.MAILER",485:"AUTOCORRECT",489:"POST.DOCUMENT",491:"PICKLIST",493:"VIEW.SHOW",494:"VIEW.DEFINE",495:"VIEW.DELETE",509:"SHEET.BACKGROUND",510:"INSERT.MAP.OBJECT",511:"OPTIONS.MENONO",517:"MSOCHECKS",518:"NORMAL",519:"LAYOUT",520:"RM.PRINT.AREA",521:"CLEAR.PRINT.AREA",522:"ADD.PRINT.AREA",523:"MOVE.BRK",545:"HIDECURR.NOTE",546:"HIDEALL.NOTES",547:"DELETE.NOTE",548:"TRAVERSE.NOTES",549:"ACTIVATE.NOTES",620:"PROTECT.REVISIONS",621:"UNPROTECT.REVISIONS",647:"OPTIONS.ME",653:"WEB.PUBLISH",667:"NEWWEBQUERY",673:"PIVOT.TABLE.CHART",753:"OPTIONS.SAVE",755:"OPTIONS.SPELL",808:"HIDEALL.INKANNOTS"},_T={0:"COUNT",1:"IF",2:"ISNA",3:"ISERROR",4:"SUM",5:"AVERAGE",6:"MIN",7:"MAX",8:"ROW",9:"COLUMN",10:"NA",11:"NPV",12:"STDEV",13:"DOLLAR",14:"FIXED",15:"SIN",16:"COS",17:"TAN",18:"ATAN",19:"PI",20:"SQRT",21:"EXP",22:"LN",23:"LOG10",24:"ABS",25:"INT",26:"SIGN",27:"ROUND",28:"LOOKUP",29:"INDEX",30:"REPT",31:"MID",32:"LEN",33:"VALUE",34:"TRUE",35:"FALSE",36:"AND",37:"OR",38:"NOT",39:"MOD",40:"DCOUNT",41:"DSUM",42:"DAVERAGE",43:"DMIN",44:"DMAX",45:"DSTDEV",46:"VAR",47:"DVAR",48:"TEXT",49:"LINEST",50:"TREND",51:"LOGEST",52:"GROWTH",53:"GOTO",54:"HALT",55:"RETURN",56:"PV",57:"FV",58:"NPER",59:"PMT",60:"RATE",61:"MIRR",62:"IRR",63:"RAND",64:"MATCH",65:"DATE",66:"TIME",67:"DAY",68:"MONTH",69:"YEAR",70:"WEEKDAY",71:"HOUR",72:"MINUTE",73:"SECOND",74:"NOW",75:"AREAS",76:"ROWS",77:"COLUMNS",78:"OFFSET",79:"ABSREF",80:"RELREF",81:"ARGUMENT",82:"SEARCH",83:"TRANSPOSE",84:"ERROR",85:"STEP",86:"TYPE",87:"ECHO",88:"SET.NAME",89:"CALLER",90:"DEREF",91:"WINDOWS",92:"SERIES",93:"DOCUMENTS",94:"ACTIVE.CELL",95:"SELECTION",96:"RESULT",97:"ATAN2",98:"ASIN",99:"ACOS",100:"CHOOSE",101:"HLOOKUP",102:"VLOOKUP",103:"LINKS",104:"INPUT",105:"ISREF",106:"GET.FORMULA",107:"GET.NAME",108:"SET.VALUE",109:"LOG",110:"EXEC",111:"CHAR",112:"LOWER",113:"UPPER",114:"PROPER",115:"LEFT",116:"RIGHT",117:"EXACT",118:"TRIM",119:"REPLACE",120:"SUBSTITUTE",121:"CODE",122:"NAMES",123:"DIRECTORY",124:"FIND",125:"CELL",126:"ISERR",127:"ISTEXT",128:"ISNUMBER",129:"ISBLANK",130:"T",131:"N",132:"FOPEN",133:"FCLOSE",134:"FSIZE",135:"FREADLN",136:"FREAD",137:"FWRITELN",138:"FWRITE",139:"FPOS",140:"DATEVALUE",141:"TIMEVALUE",142:"SLN",143:"SYD",144:"DDB",145:"GET.DEF",146:"REFTEXT",147:"TEXTREF",148:"INDIRECT",149:"REGISTER",150:"CALL",151:"ADD.BAR",152:"ADD.MENU",153:"ADD.COMMAND",154:"ENABLE.COMMAND",155:"CHECK.COMMAND",156:"RENAME.COMMAND",157:"SHOW.BAR",158:"DELETE.MENU",159:"DELETE.COMMAND",160:"GET.CHART.ITEM",161:"DIALOG.BOX",162:"CLEAN",163:"MDETERM",164:"MINVERSE",165:"MMULT",166:"FILES",167:"IPMT",168:"PPMT",169:"COUNTA",170:"CANCEL.KEY",171:"FOR",172:"WHILE",173:"BREAK",174:"NEXT",175:"INITIATE",176:"REQUEST",177:"POKE",178:"EXECUTE",179:"TERMINATE",180:"RESTART",181:"HELP",182:"GET.BAR",183:"PRODUCT",184:"FACT",185:"GET.CELL",186:"GET.WORKSPACE",187:"GET.WINDOW",188:"GET.DOCUMENT",189:"DPRODUCT",190:"ISNONTEXT",191:"GET.NOTE",192:"NOTE",193:"STDEVP",194:"VARP",195:"DSTDEVP",196:"DVARP",197:"TRUNC",198:"ISLOGICAL",199:"DCOUNTA",200:"DELETE.BAR",201:"UNREGISTER",204:"USDOLLAR",205:"FINDB",206:"SEARCHB",207:"REPLACEB",208:"LEFTB",209:"RIGHTB",210:"MIDB",211:"LENB",212:"ROUNDUP",213:"ROUNDDOWN",214:"ASC",215:"DBCS",216:"RANK",219:"ADDRESS",220:"DAYS360",221:"TODAY",222:"VDB",223:"ELSE",224:"ELSE.IF",225:"END.IF",226:"FOR.CELL",227:"MEDIAN",228:"SUMPRODUCT",229:"SINH",230:"COSH",231:"TANH",232:"ASINH",233:"ACOSH",234:"ATANH",235:"DGET",236:"CREATE.OBJECT",237:"VOLATILE",238:"LAST.ERROR",239:"CUSTOM.UNDO",240:"CUSTOM.REPEAT",241:"FORMULA.CONVERT",242:"GET.LINK.INFO",243:"TEXT.BOX",244:"INFO",245:"GROUP",246:"GET.OBJECT",247:"DB",248:"PAUSE",251:"RESUME",252:"FREQUENCY",253:"ADD.TOOLBAR",254:"DELETE.TOOLBAR",255:"User",256:"RESET.TOOLBAR",257:"EVALUATE",258:"GET.TOOLBAR",259:"GET.TOOL",260:"SPELLING.CHECK",261:"ERROR.TYPE",262:"APP.TITLE",263:"WINDOW.TITLE",264:"SAVE.TOOLBAR",265:"ENABLE.TOOL",266:"PRESS.TOOL",267:"REGISTER.ID",268:"GET.WORKBOOK",269:"AVEDEV",270:"BETADIST",271:"GAMMALN",272:"BETAINV",273:"BINOMDIST",274:"CHIDIST",275:"CHIINV",276:"COMBIN",277:"CONFIDENCE",278:"CRITBINOM",279:"EVEN",280:"EXPONDIST",281:"FDIST",282:"FINV",283:"FISHER",284:"FISHERINV",285:"FLOOR",286:"GAMMADIST",287:"GAMMAINV",288:"CEILING",289:"HYPGEOMDIST",290:"LOGNORMDIST",291:"LOGINV",292:"NEGBINOMDIST",293:"NORMDIST",294:"NORMSDIST",295:"NORMINV",296:"NORMSINV",297:"STANDARDIZE",298:"ODD",299:"PERMUT",300:"POISSON",301:"TDIST",302:"WEIBULL",303:"SUMXMY2",304:"SUMX2MY2",305:"SUMX2PY2",306:"CHITEST",307:"CORREL",308:"COVAR",309:"FORECAST",310:"FTEST",311:"INTERCEPT",312:"PEARSON",313:"RSQ",314:"STEYX",315:"SLOPE",316:"TTEST",317:"PROB",318:"DEVSQ",319:"GEOMEAN",320:"HARMEAN",321:"SUMSQ",322:"KURT",323:"SKEW",324:"ZTEST",325:"LARGE",326:"SMALL",327:"QUARTILE",328:"PERCENTILE",329:"PERCENTRANK",330:"MODE",331:"TRIMMEAN",332:"TINV",334:"MOVIE.COMMAND",335:"GET.MOVIE",336:"CONCATENATE",337:"POWER",338:"PIVOT.ADD.DATA",339:"GET.PIVOT.TABLE",340:"GET.PIVOT.FIELD",341:"GET.PIVOT.ITEM",342:"RADIANS",343:"DEGREES",344:"SUBTOTAL",345:"SUMIF",346:"COUNTIF",347:"COUNTBLANK",348:"SCENARIO.GET",349:"OPTIONS.LISTS.GET",350:"ISPMT",351:"DATEDIF",352:"DATESTRING",353:"NUMBERSTRING",354:"ROMAN",355:"OPEN.DIALOG",356:"SAVE.DIALOG",357:"VIEW.GET",358:"GETPIVOTDATA",359:"HYPERLINK",360:"PHONETIC",361:"AVERAGEA",362:"MAXA",363:"MINA",364:"STDEVPA",365:"VARPA",366:"STDEVA",367:"VARA",368:"BAHTTEXT",369:"THAIDAYOFWEEK",370:"THAIDIGIT",371:"THAIMONTHOFYEAR",372:"THAINUMSOUND",373:"THAINUMSTRING",374:"THAISTRINGLENGTH",375:"ISTHAIDIGIT",376:"ROUNDBAHTDOWN",377:"ROUNDBAHTUP",378:"THAIYEAR",379:"RTD",380:"CUBEVALUE",381:"CUBEMEMBER",382:"CUBEMEMBERPROPERTY",383:"CUBERANKEDMEMBER",384:"HEX2BIN",385:"HEX2DEC",386:"HEX2OCT",387:"DEC2BIN",388:"DEC2HEX",389:"DEC2OCT",390:"OCT2BIN",391:"OCT2HEX",392:"OCT2DEC",393:"BIN2DEC",394:"BIN2OCT",395:"BIN2HEX",396:"IMSUB",397:"IMDIV",398:"IMPOWER",399:"IMABS",400:"IMSQRT",401:"IMLN",402:"IMLOG2",403:"IMLOG10",404:"IMSIN",405:"IMCOS",406:"IMEXP",407:"IMARGUMENT",408:"IMCONJUGATE",409:"IMAGINARY",410:"IMREAL",411:"COMPLEX",412:"IMSUM",413:"IMPRODUCT",414:"SERIESSUM",415:"FACTDOUBLE",416:"SQRTPI",417:"QUOTIENT",418:"DELTA",419:"GESTEP",420:"ISEVEN",421:"ISODD",422:"MROUND",423:"ERF",424:"ERFC",425:"BESSELJ",426:"BESSELK",427:"BESSELY",428:"BESSELI",429:"XIRR",430:"XNPV",431:"PRICEMAT",432:"YIELDMAT",433:"INTRATE",434:"RECEIVED",435:"DISC",436:"PRICEDISC",437:"YIELDDISC",438:"TBILLEQ",439:"TBILLPRICE",440:"TBILLYIELD",441:"PRICE",442:"YIELD",443:"DOLLARDE",444:"DOLLARFR",445:"NOMINAL",446:"EFFECT",447:"CUMPRINC",448:"CUMIPMT",449:"EDATE",450:"EOMONTH",451:"YEARFRAC",452:"COUPDAYBS",453:"COUPDAYS",454:"COUPDAYSNC",455:"COUPNCD",456:"COUPNUM",457:"COUPPCD",458:"DURATION",459:"MDURATION",460:"ODDLPRICE",461:"ODDLYIELD",462:"ODDFPRICE",463:"ODDFYIELD",464:"RANDBETWEEN",465:"WEEKNUM",466:"AMORDEGRC",467:"AMORLINC",468:"CONVERT",724:"SHEETJS",469:"ACCRINT",470:"ACCRINTM",471:"WORKDAY",472:"NETWORKDAYS",473:"GCD",474:"MULTINOMIAL",475:"LCM",476:"FVSCHEDULE",477:"CUBEKPIMEMBER",478:"CUBESET",479:"CUBESETCOUNT",480:"IFERROR",481:"COUNTIFS",482:"SUMIFS",483:"AVERAGEIF",484:"AVERAGEIFS"},iG={2:1,3:1,10:0,15:1,16:1,17:1,18:1,19:0,20:1,21:1,22:1,23:1,24:1,25:1,26:1,27:2,30:2,31:3,32:1,33:1,34:0,35:0,38:1,39:2,40:3,41:3,42:3,43:3,44:3,45:3,47:3,48:2,53:1,61:3,63:0,65:3,66:3,67:1,68:1,69:1,70:1,71:1,72:1,73:1,74:0,75:1,76:1,77:1,79:2,80:2,83:1,85:0,86:1,89:0,90:1,94:0,95:0,97:2,98:1,99:1,101:3,102:3,105:1,106:1,108:2,111:1,112:1,113:1,114:1,117:2,118:1,119:4,121:1,126:1,127:1,128:1,129:1,130:1,131:1,133:1,134:1,135:1,136:2,137:2,138:2,140:1,141:1,142:3,143:4,144:4,161:1,162:1,163:1,164:1,165:2,172:1,175:2,176:2,177:3,178:2,179:1,184:1,186:1,189:3,190:1,195:3,196:3,197:1,198:1,199:3,201:1,207:4,210:3,211:1,212:2,213:2,214:1,215:1,225:0,229:1,230:1,231:1,232:1,233:1,234:1,235:3,244:1,247:4,252:2,257:1,261:1,271:1,273:4,274:2,275:2,276:2,277:3,278:3,279:1,280:3,281:3,282:3,283:1,284:1,285:2,286:4,287:3,288:2,289:4,290:3,291:3,292:3,293:4,294:1,295:3,296:1,297:3,298:1,299:2,300:3,301:3,302:4,303:2,304:2,305:2,306:2,307:2,308:2,309:3,310:2,311:2,312:2,313:2,314:2,315:2,316:4,325:2,326:2,327:2,328:2,331:2,332:2,337:2,342:1,343:1,346:2,347:1,350:4,351:3,352:1,353:2,360:1,368:1,369:1,370:1,371:1,372:1,373:1,374:1,375:1,376:1,377:1,378:1,382:3,385:1,392:1,393:1,396:2,397:2,398:2,399:1,400:1,401:1,402:1,403:1,404:1,405:1,406:1,407:1,408:1,409:1,410:1,414:4,415:1,416:1,417:2,420:1,421:1,422:2,424:1,425:2,426:2,427:2,428:2,430:3,438:3,439:3,440:3,443:2,444:2,445:2,446:2,447:6,448:6,449:2,450:2,464:2,468:3,476:2,479:1,480:2,65535:0};function p_(e){return e.slice(0,3)=="of:"&&(e=e.slice(3)),e.charCodeAt(0)==61&&(e=e.slice(1),e.charCodeAt(0)==61&&(e=e.slice(1))),e=e.replace(/COM\.MICROSOFT\./g,""),e=e.replace(/\[((?:\.[A-Z]+[0-9]+)(?::\.[A-Z]+[0-9]+)?)\]/g,function(t,r){return r.replace(/\./g,"")}),e=e.replace(/\[.(#[A-Z]*[?!])\]/g,"$1"),e.replace(/[;~]/g,",").replace(/\|/g,";")}function k2(e){var t=e.split(":"),r=t[0].split(".")[0];return[r,t[0].split(".")[1]+(t.length>1?":"+(t[1].split(".")[1]||t[1].split(".")[0]):"")]}var Df={},Lu={};function jf(e,t){if(e){var r=[.7,.7,.75,.75,.3,.3];t=="xlml"&&(r=[1,1,1,1,.5,.5]),e.left==null&&(e.left=r[0]),e.right==null&&(e.right=r[1]),e.top==null&&(e.top=r[2]),e.bottom==null&&(e.bottom=r[3]),e.header==null&&(e.header=r[4]),e.footer==null&&(e.footer=r[5])}}function ST(e,t,r,n,a,i){try{n.cellNF&&(e.z=Ot[t])}catch(o){if(n.WTF)throw o}if(!(e.t==="z"&&!n.cellStyles)){if(e.t==="d"&&typeof e.v=="string"&&(e.v=xn(e.v)),(!n||n.cellText!==!1)&&e.t!=="z")try{if(Ot[t]==null&&Xl(s$[t]||"General",t),e.t==="e")e.w=e.w||vc[e.v];else if(t===0)if(e.t==="n")(e.v|0)===e.v?e.w=e.v.toString(10):e.w=ph(e.v);else if(e.t==="d"){var s=ia(e.v);(s|0)===s?e.w=s.toString(10):e.w=ph(s)}else{if(e.v===void 0)return"";e.w=ac(e.v,Lu)}else e.t==="d"?e.w=fi(t,ia(e.v),Lu):e.w=fi(t,e.v,Lu)}catch(o){if(n.WTF)throw o}if(n.cellStyles&&r!=null)try{e.s=i.Fills[r],e.s.fgColor&&e.s.fgColor.theme&&!e.s.fgColor.rgb&&(e.s.fgColor.rgb=B1(a.themeElements.clrScheme[e.s.fgColor.theme].rgb,e.s.fgColor.tint||0),n.WTF&&(e.s.fgColor.raw_rgb=a.themeElements.clrScheme[e.s.fgColor.theme].rgb)),e.s.bgColor&&e.s.bgColor.theme&&(e.s.bgColor.rgb=B1(a.themeElements.clrScheme[e.s.bgColor.theme].rgb,e.s.bgColor.tint||0),n.WTF&&(e.s.bgColor.raw_rgb=a.themeElements.clrScheme[e.s.bgColor.theme].rgb))}catch(o){if(n.WTF&&i.Fills)throw o}}}function sG(e,t){var r=Or(t);r.s.r<=r.e.r&&r.s.c<=r.e.c&&r.s.r>=0&&r.s.c>=0&&(e["!ref"]=$t(r))}var oG=/<(?:\w:)?mergeCell ref="[A-Z0-9:]+"\s*[\/]?>/g,lG=/<(?:\w+:)?sheetData[^>]*>([\s\S]*)<\/(?:\w+:)?sheetData>/,cG=/<(?:\w:)?hyperlink [^>]*>/mg,uG=/"(\w*:\w*)"/,fG=/<(?:\w:)?col\b[^>]*[\/]?>/g,hG=/<(?:\w:)?autoFilter[^>]*([\/]|>([\s\S]*)<\/(?:\w:)?autoFilter)>/g,dG=/<(?:\w:)?pageMargins[^>]*\/>/g,kT=/<(?:\w:)?sheetPr\b(?:[^>a-z][^>]*)?\/>/,pG=/<(?:\w:)?sheetPr[^>]*(?:[\/]|>([\s\S]*)<\/(?:\w:)?sheetPr)>/,mG=/<(?:\w:)?sheetViews[^>]*(?:[\/]|>([\s\S]*)<\/(?:\w:)?sheetViews)>/;function gG(e,t,r,n,a,i,s){if(!e)return e;n||(n={"!id":{}});var o=t.dense?[]:{},l={s:{r:2e6,c:2e6},e:{r:0,c:0}},c="",u="",f=e.match(lG);f?(c=e.slice(0,f.index),u=e.slice(f.index+f[0].length)):c=u=e;var d=c.match(kT);d?B5(d[0],o,a,r):(d=c.match(pG))&&xG(d[0],d[1]||"",o,a,r);var h=(c.match(/<(?:\w*:)?dimension/)||{index:-1}).index;if(h>0){var g=c.slice(h,h+50).match(uG);g&&sG(o,g[1])}var m=c.match(mG);m&&m[1]&&SG(m[1],a);var _=[];if(t.cellStyles){var y=c.match(fG);y&&wG(_,y)}f&&kG(f[1],o,t,l,i,s);var b=u.match(hG);b&&(o["!autofilter"]=bG(b[0]));var w=[],T=u.match(oG);if(T)for(h=0;h!=T.length;++h)w[h]=Or(T[h].slice(T[h].indexOf('"')+1));var F=u.match(cG);F&&vG(o,F,n);var I=u.match(dG);if(I&&(o["!margins"]=yG(wt(I[0]))),!o["!ref"]&&l.e.c>=l.s.c&&l.e.r>=l.s.r&&(o["!ref"]=$t(l)),t.sheetRows>0&&o["!ref"]){var A=Or(o["!ref"]);t.sheetRows<=+A.e.r&&(A.e.r=t.sheetRows-1,A.e.r>l.e.r&&(A.e.r=l.e.r),A.e.r<A.s.r&&(A.s.r=A.e.r),A.e.c>l.e.c&&(A.e.c=l.e.c),A.e.c<A.s.c&&(A.s.c=A.e.c),o["!fullref"]=o["!ref"],o["!ref"]=$t(A))}return _.length>0&&(o["!cols"]=_),w.length>0&&(o["!merges"]=w),o}function B5(e,t,r,n){var a=wt(e);r.Sheets[n]||(r.Sheets[n]={}),a.codeName&&(r.Sheets[n].CodeName=Wt(mr(a.codeName)))}function xG(e,t,r,n,a){B5(e.slice(0,e.indexOf(">")),r,n,a)}function vG(e,t,r){for(var n=Array.isArray(e),a=0;a!=t.length;++a){var i=wt(mr(t[a]),!0);if(!i.ref)return;var s=((r||{})["!id"]||[])[i.id];s?(i.Target=s.Target,i.location&&(i.Target+="#"+Wt(i.location))):(i.Target="#"+Wt(i.location),s={Target:i.Target,TargetMode:"Internal"}),i.Rel=s,i.tooltip&&(i.Tooltip=i.tooltip,delete i.tooltip);for(var o=Or(i.ref),l=o.s.r;l<=o.e.r;++l)for(var c=o.s.c;c<=o.e.c;++c){var u=Nt({c,r:l});n?(e[l]||(e[l]=[]),e[l][c]||(e[l][c]={t:"z",v:void 0}),e[l][c].l=i):(e[u]||(e[u]={t:"z",v:void 0}),e[u].l=i)}}}function yG(e){var t={};return["left","right","top","bottom","header","footer"].forEach(function(r){e[r]&&(t[r]=parseFloat(e[r]))}),t}function wG(e,t){for(var r=!1,n=0;n!=t.length;++n){var a=wt(t[n],!0);a.hidden&&(a.hidden=wr(a.hidden));var i=parseInt(a.min,10)-1,s=parseInt(a.max,10)-1;for(a.outlineLevel&&(a.level=+a.outlineLevel||0),delete a.min,delete a.max,a.width=+a.width,!r&&a.width&&(r=!0,R5(a.width)),Ju(a);i<=s;)e[i++]=Sn(a)}}function bG(e){var t={ref:(e.match(/ref="([^"]*)"/)||[])[1]};return t}var _G=/<(?:\w:)?sheetView(?:[^>a-z][^>]*)?\/?>/;function SG(e,t){t.Views||(t.Views=[{}]),(e.match(_G)||[]).forEach(function(r,n){var a=wt(r);t.Views[n]||(t.Views[n]={}),+a.zoomScale&&(t.Views[n].zoom=+a.zoomScale),wr(a.rightToLeft)&&(t.Views[n].RTL=!0)})}var kG=function(){var e=/<(?:\w+:)?c[ \/>]/,t=/<\/(?:\w+:)?row>/,r=/r=["']([^"']*)["']/,n=/<(?:\w+:)?is>([\S\s]*?)<\/(?:\w+:)?is>/,a=/ref=["']([^"']*)["']/,i=mh("v"),s=mh("f");return function(l,c,u,f,d,h){for(var g=0,m="",_=[],y=[],b=0,w=0,T=0,F="",I,A,P=0,j=0,J,N,L=0,G=0,W=Array.isArray(h.CellXf),le,de=[],X=[],ee=Array.isArray(c),R=[],pe={},me=!1,E=!!u.sheetStubs,D=l.split(t),O=0,M=D.length;O!=M;++O){m=D[O].trim();var K=m.length;if(K!==0){var Y=0;e:for(g=0;g<K;++g)switch(m[g]){case">":if(m[g-1]!="/"){++g;break e}if(u&&u.cellStyles){if(A=wt(m.slice(Y,g),!0),P=A.r!=null?parseInt(A.r,10):P+1,j=-1,u.sheetRows&&u.sheetRows<P)continue;pe={},me=!1,A.ht&&(me=!0,pe.hpt=parseFloat(A.ht),pe.hpx=yh(pe.hpt)),A.hidden=="1"&&(me=!0,pe.hidden=!0),A.outlineLevel!=null&&(me=!0,pe.level=+A.outlineLevel),me&&(R[P-1]=pe)}break;case"<":Y=g;break}if(Y>=g)break;if(A=wt(m.slice(Y,g),!0),P=A.r!=null?parseInt(A.r,10):P+1,j=-1,!(u.sheetRows&&u.sheetRows<P)){f.s.r>P-1&&(f.s.r=P-1),f.e.r<P-1&&(f.e.r=P-1),u&&u.cellStyles&&(pe={},me=!1,A.ht&&(me=!0,pe.hpt=parseFloat(A.ht),pe.hpx=yh(pe.hpt)),A.hidden=="1"&&(me=!0,pe.hidden=!0),A.outlineLevel!=null&&(me=!0,pe.level=+A.outlineLevel),me&&(R[P-1]=pe)),_=m.slice(g).split(e);for(var re=0;re!=_.length&&_[re].trim().charAt(0)=="<";++re);for(_=_.slice(re),g=0;g!=_.length;++g)if(m=_[g].trim(),m.length!==0){if(y=m.match(r),b=g,w=0,T=0,m="<c "+(m.slice(0,1)=="<"?">":"")+m,y!=null&&y.length===2){for(b=0,F=y[1],w=0;w!=F.length&&!((T=F.charCodeAt(w)-64)<1||T>26);++w)b=26*b+T;--b,j=b}else++j;for(w=0;w!=m.length&&m.charCodeAt(w)!==62;++w);if(++w,A=wt(m.slice(0,w),!0),A.r||(A.r=Nt({r:P-1,c:j})),F=m.slice(w),I={t:""},(y=F.match(i))!=null&&y[1]!==""&&(I.v=Wt(y[1])),u.cellFormula){if((y=F.match(s))!=null&&y[1]!==""){if(I.f=Wt(mr(y[1])).replace(/\r\n/g,`
`),u.xlfn||(I.f=u_(I.f)),y[0].indexOf('t="array"')>-1)I.F=(F.match(a)||[])[1],I.F.indexOf(":")>-1&&de.push([Or(I.F),I.F]);else if(y[0].indexOf('t="shared"')>-1){N=wt(y[0]);var se=Wt(mr(y[1]));u.xlfn||(se=u_(se)),X[parseInt(N.si,10)]=[N,se,A.r]}}else(y=F.match(/<f[^>]*\/>/))&&(N=wt(y[0]),X[N.si]&&(I.f=DW(X[N.si][1],X[N.si][2],A.r)));var xe=ra(A.r);for(w=0;w<de.length;++w)xe.r>=de[w][0].s.r&&xe.r<=de[w][0].e.r&&xe.c>=de[w][0].s.c&&xe.c<=de[w][0].e.c&&(I.F=de[w][1])}if(A.t==null&&I.v===void 0)if(I.f||I.F)I.v=0,I.t="n";else if(E)I.t="z";else continue;else I.t=A.t||"n";switch(f.s.c>j&&(f.s.c=j),f.e.c<j&&(f.e.c=j),I.t){case"n":if(I.v==""||I.v==null){if(!E)continue;I.t="z"}else I.v=parseFloat(I.v);break;case"s":if(typeof I.v>"u"){if(!E)continue;I.t="z"}else J=Df[parseInt(I.v,10)],I.v=J.t,I.r=J.r,u.cellHTML&&(I.h=J.h);break;case"str":I.t="s",I.v=I.v!=null?mr(I.v):"",u.cellHTML&&(I.h=A5(I.v));break;case"inlineStr":y=F.match(n),I.t="s",y!=null&&(J=j5(y[1]))?(I.v=J.t,u.cellHTML&&(I.h=J.h)):I.v="";break;case"b":I.v=wr(I.v);break;case"d":u.cellDates?I.v=xn(I.v,1):(I.v=ia(xn(I.v,1)),I.t="n");break;case"e":(!u||u.cellText!==!1)&&(I.w=I.v),I.v=WA[I.v];break}if(L=G=0,le=null,W&&A.s!==void 0&&(le=h.CellXf[A.s],le!=null&&(le.numFmtId!=null&&(L=le.numFmtId),u.cellStyles&&le.fillId!=null&&(G=le.fillId))),ST(I,L,G,u,d,h),u.cellDates&&W&&I.t=="n"&&s0(Ot[L])&&(I.t="d",I.v=Im(I.v)),A.cm&&u.xlmeta){var Ce=(u.xlmeta.Cell||[])[+A.cm-1];Ce&&Ce.type=="XLDAPR"&&(I.D=!0)}if(ee){var Z=ra(A.r);c[Z.r]||(c[Z.r]=[]),c[Z.r][Z.c]=I}else c[A.r]=I}}}}R.length>0&&(c["!rows"]=R)}}();function EG(e,t){var r={},n=e.l+t;r.r=e.read_shift(4),e.l+=4;var a=e.read_shift(2);e.l+=1;var i=e.read_shift(1);return e.l=n,i&7&&(r.level=i&7),i&16&&(r.hidden=!0),i&32&&(r.hpt=a/20),r}var AG=xc;function TG(){}function CG(e,t){var r={},n=e[e.l];return++e.l,r.above=!(n&64),r.left=!(n&128),e.l+=18,r.name=Y$(e),r}function NG(e){var t=hi(e);return[t]}function PG(e){var t=gc(e);return[t]}function LG(e){var t=hi(e),r=e.read_shift(1);return[t,r,"b"]}function FG(e){var t=gc(e),r=e.read_shift(1);return[t,r,"b"]}function OG(e){var t=hi(e),r=e.read_shift(1);return[t,r,"e"]}function IG(e){var t=gc(e),r=e.read_shift(1);return[t,r,"e"]}function DG(e){var t=hi(e),r=e.read_shift(4);return[t,r,"s"]}function jG(e){var t=gc(e),r=e.read_shift(4);return[t,r,"s"]}function RG(e){var t=hi(e),r=$n(e);return[t,r,"n"]}function ET(e){var t=gc(e),r=$n(e);return[t,r,"n"]}function MG(e){var t=hi(e),r=O5(e);return[t,r,"n"]}function BG(e){var t=gc(e),r=O5(e);return[t,r,"n"]}function UG(e){var t=hi(e),r=L5(e);return[t,r,"is"]}function $G(e){var t=hi(e),r=Hn(e);return[t,r,"str"]}function VG(e){var t=gc(e),r=Hn(e);return[t,r,"str"]}function zG(e,t,r){var n=e.l+t,a=hi(e);a.r=r["!row"];var i=e.read_shift(1),s=[a,i,"b"];if(r.cellFormula){e.l+=2;var o=Rm(e,n-e.l,r);s[3]=Bn(o,null,a,r.supbooks,r)}else e.l=n;return s}function HG(e,t,r){var n=e.l+t,a=hi(e);a.r=r["!row"];var i=e.read_shift(1),s=[a,i,"e"];if(r.cellFormula){e.l+=2;var o=Rm(e,n-e.l,r);s[3]=Bn(o,null,a,r.supbooks,r)}else e.l=n;return s}function WG(e,t,r){var n=e.l+t,a=hi(e);a.r=r["!row"];var i=$n(e),s=[a,i,"n"];if(r.cellFormula){e.l+=2;var o=Rm(e,n-e.l,r);s[3]=Bn(o,null,a,r.supbooks,r)}else e.l=n;return s}function qG(e,t,r){var n=e.l+t,a=hi(e);a.r=r["!row"];var i=Hn(e),s=[a,i,"str"];if(r.cellFormula){e.l+=2;var o=Rm(e,n-e.l,r);s[3]=Bn(o,null,a,r.supbooks,r)}else e.l=n;return s}var GG=xc;function KG(e,t){var r=e.l+t,n=xc(e),a=F5(e),i=Hn(e),s=Hn(e),o=Hn(e);e.l=r;var l={rfx:n,relId:a,loc:i,display:o};return s&&(l.Tooltip=s),l}function XG(){}function YG(e,t,r){var n=e.l+t,a=VA(e),i=e.read_shift(1),s=[a];if(s[2]=i,r.cellFormula){var o=tG(e,n-e.l,r);s[1]=o}else e.l=n;return s}function JG(e,t,r){var n=e.l+t,a=xc(e),i=[a];if(r.cellFormula){var s=nG(e,n-e.l,r);i[1]=s,e.l=n}else e.l=n;return i}var QG=["left","right","top","bottom","header","footer"];function ZG(e){var t={};return QG.forEach(function(r){t[r]=$n(e)}),t}function eK(e){var t=e.read_shift(2);return e.l+=28,{RTL:t&32}}function tK(){}function rK(){}function nK(e,t,r,n,a,i,s){if(!e)return e;var o=t||{};n||(n={"!id":{}});var l=o.dense?[]:{},c,u={s:{r:2e6,c:2e6},e:{r:0,c:0}},f=!1,d=!1,h,g,m,_,y,b,w,T,F,I=[];o.biff=12,o["!row"]=0;var A=0,P=!1,j=[],J={},N=o.supbooks||a.supbooks||[[]];if(N.sharedf=J,N.arrayf=j,N.SheetNames=a.SheetNames||a.Sheets.map(function(ee){return ee.name}),!o.supbooks&&(o.supbooks=N,a.Names))for(var L=0;L<a.Names.length;++L)N[0][L+1]=a.Names[L];var G=[],W=[],le=!1;V1[16]={n:"BrtShortReal",f:ET};var de;if(ao(e,function(R,pe,me){if(!d)switch(me){case 148:c=R;break;case 0:h=R,o.sheetRows&&o.sheetRows<=h.r&&(d=!0),T=kn(_=h.r),o["!row"]=h.r,(R.hidden||R.hpt||R.level!=null)&&(R.hpt&&(R.hpx=yh(R.hpt)),W[R.r]=R);break;case 2:case 3:case 4:case 5:case 6:case 7:case 8:case 9:case 10:case 11:case 13:case 14:case 15:case 16:case 17:case 18:case 62:switch(g={t:R[2]},R[2]){case"n":g.v=R[1];break;case"s":w=Df[R[1]],g.v=w.t,g.r=w.r;break;case"b":g.v=!!R[1];break;case"e":g.v=R[1],o.cellText!==!1&&(g.w=vc[g.v]);break;case"str":g.t="s",g.v=R[1];break;case"is":g.t="s",g.v=R[1].t;break}if((m=s.CellXf[R[0].iStyleRef])&&ST(g,m.numFmtId,null,o,i,s),y=R[0].c==-1?y+1:R[0].c,o.dense?(l[_]||(l[_]=[]),l[_][y]=g):l[sn(y)+T]=g,o.cellFormula){for(P=!1,A=0;A<j.length;++A){var E=j[A];h.r>=E[0].s.r&&h.r<=E[0].e.r&&y>=E[0].s.c&&y<=E[0].e.c&&(g.F=$t(E[0]),P=!0)}!P&&R.length>3&&(g.f=R[3])}if(u.s.r>h.r&&(u.s.r=h.r),u.s.c>y&&(u.s.c=y),u.e.r<h.r&&(u.e.r=h.r),u.e.c<y&&(u.e.c=y),o.cellDates&&m&&g.t=="n"&&s0(Ot[m.numFmtId])){var D=zl(g.v);D&&(g.t="d",g.v=new Date(D.y,D.m-1,D.d,D.H,D.M,D.S,D.u))}de&&(de.type=="XLDAPR"&&(g.D=!0),de=void 0);break;case 1:case 12:if(!o.sheetStubs||f)break;g={t:"z",v:void 0},y=R[0].c==-1?y+1:R[0].c,o.dense?(l[_]||(l[_]=[]),l[_][y]=g):l[sn(y)+T]=g,u.s.r>h.r&&(u.s.r=h.r),u.s.c>y&&(u.s.c=y),u.e.r<h.r&&(u.e.r=h.r),u.e.c<y&&(u.e.c=y),de&&(de.type=="XLDAPR"&&(g.D=!0),de=void 0);break;case 176:I.push(R);break;case 49:de=((o.xlmeta||{}).Cell||[])[R-1];break;case 494:var O=n["!id"][R.relId];for(O?(R.Target=O.Target,R.loc&&(R.Target+="#"+R.loc),R.Rel=O):R.relId==""&&(R.Target="#"+R.loc),_=R.rfx.s.r;_<=R.rfx.e.r;++_)for(y=R.rfx.s.c;y<=R.rfx.e.c;++y)o.dense?(l[_]||(l[_]=[]),l[_][y]||(l[_][y]={t:"z",v:void 0}),l[_][y].l=R):(b=Nt({c:y,r:_}),l[b]||(l[b]={t:"z",v:void 0}),l[b].l=R);break;case 426:if(!o.cellFormula)break;j.push(R),F=o.dense?l[_][y]:l[sn(y)+T],F.f=Bn(R[1],u,{r:h.r,c:y},N,o),F.F=$t(R[0]);break;case 427:if(!o.cellFormula)break;J[Nt(R[0].s)]=R[1],F=o.dense?l[_][y]:l[sn(y)+T],F.f=Bn(R[1],u,{r:h.r,c:y},N,o);break;case 60:if(!o.cellStyles)break;for(;R.e>=R.s;)G[R.e--]={width:R.w/256,hidden:!!(R.flags&1),level:R.level},le||(le=!0,R5(R.w/256)),Ju(G[R.e+1]);break;case 161:l["!autofilter"]={ref:$t(R)};break;case 476:l["!margins"]=R;break;case 147:a.Sheets[r]||(a.Sheets[r]={}),R.name&&(a.Sheets[r].CodeName=R.name),(R.above||R.left)&&(l["!outline"]={above:R.above,left:R.left});break;case 137:a.Views||(a.Views=[{}]),a.Views[0]||(a.Views[0]={}),R.RTL&&(a.Views[0].RTL=!0);break;case 485:break;case 64:case 1053:break;case 151:break;case 152:case 175:case 644:case 625:case 562:case 396:case 1112:case 1146:case 471:case 1050:case 649:case 1105:case 589:case 607:case 564:case 1055:case 168:case 174:case 1180:case 499:case 507:case 550:case 171:case 167:case 1177:case 169:case 1181:case 551:case 552:case 661:case 639:case 478:case 537:case 477:case 536:case 1103:case 680:case 1104:case 1024:case 663:case 535:case 678:case 504:case 1043:case 428:case 170:case 3072:case 50:case 2070:case 1045:break;case 35:f=!0;break;case 36:f=!1;break;case 37:f=!0;break;case 38:f=!1;break;default:if(!pe.T){if(!f||o.WTF)throw new Error("Unexpected record 0x"+me.toString(16))}}},o),delete o.supbooks,delete o["!row"],!l["!ref"]&&(u.s.r<2e6||c&&(c.e.r>0||c.e.c>0||c.s.r>0||c.s.c>0))&&(l["!ref"]=$t(c||u)),o.sheetRows&&l["!ref"]){var X=Or(l["!ref"]);o.sheetRows<=+X.e.r&&(X.e.r=o.sheetRows-1,X.e.r>u.e.r&&(X.e.r=u.e.r),X.e.r<X.s.r&&(X.s.r=X.e.r),X.e.c>u.e.c&&(X.e.c=u.e.c),X.e.c<X.s.c&&(X.s.c=X.e.c),l["!fullref"]=l["!ref"],l["!ref"]=$t(X))}return I.length>0&&(l["!merges"]=I),G.length>0&&(l["!cols"]=G),W.length>0&&(l["!rows"]=W),l}function aK(e){var t=[],r=e.match(/^<c:numCache>/),n;(e.match(/<c:pt idx="(\d*)">(.*?)<\/c:pt>/mg)||[]).forEach(function(i){var s=i.match(/<c:pt idx="(\d*?)"><c:v>(.*)<\/c:v><\/c:pt>/);s&&(t[+s[1]]=r?+s[2]:s[2])});var a=Wt((e.match(/<c:formatCode>([\s\S]*?)<\/c:formatCode>/)||["","General"])[1]);return(e.match(/<c:f>(.*?)<\/c:f>/mg)||[]).forEach(function(i){n=i.replace(/<.*?>/g,"")}),[t,a,n]}function iK(e,t,r,n,a,i){var s=i||{"!type":"chart"};if(!e)return i;var o=0,l=0,c="A",u={s:{r:2e6,c:2e6},e:{r:0,c:0}};return(e.match(/<c:numCache>[\s\S]*?<\/c:numCache>/gm)||[]).forEach(function(f){var d=aK(f);u.s.r=u.s.c=0,u.e.c=o,c=sn(o),d[0].forEach(function(h,g){s[c+kn(g)]={t:"n",v:h,z:d[1]},l=g}),u.e.r<l&&(u.e.r=l),++o}),o>0&&(s["!ref"]=$t(u)),s}function sK(e,t,r,n,a){if(!e)return e;n||(n={"!id":{}});var i={"!type":"chart","!drawel":null,"!rel":""},s,o=e.match(kT);return o&&B5(o[0],i,a,r),(s=e.match(/drawing r:id="(.*?)"/))&&(i["!rel"]=s[1]),n["!id"][i["!rel"]]&&(i["!drawel"]=n["!id"][i["!rel"]]),i}function oK(e,t){e.l+=10;var r=Hn(e);return{name:r}}function lK(e,t,r,n,a){if(!e)return e;n||(n={"!id":{}});var i={"!type":"chart","!drawel":null,"!rel":""},s=!1;return ao(e,function(l,c,u){switch(u){case 550:i["!rel"]=l;break;case 651:a.Sheets[r]||(a.Sheets[r]={}),l.name&&(a.Sheets[r].CodeName=l.name);break;case 562:case 652:case 669:case 679:case 551:case 552:case 476:case 3072:break;case 35:s=!0;break;case 36:s=!1;break;case 37:break;case 38:break;default:if(!(c.T>0)){if(!(c.T<0)){if(!s||t.WTF)throw new Error("Unexpected record 0x"+u.toString(16))}}}},t),n["!id"][i["!rel"]]&&(i["!drawel"]=n["!id"][i["!rel"]]),i}var AT=[["allowRefreshQuery",!1,"bool"],["autoCompressPictures",!0,"bool"],["backupFile",!1,"bool"],["checkCompatibility",!1,"bool"],["CodeName",""],["date1904",!1,"bool"],["defaultThemeVersion",0,"int"],["filterPrivacy",!1,"bool"],["hidePivotFieldList",!1,"bool"],["promptedSolutions",!1,"bool"],["publishItems",!1,"bool"],["refreshAllConnections",!1,"bool"],["saveExternalLinkValues",!0,"bool"],["showBorderUnselectedTables",!0,"bool"],["showInkAnnotation",!0,"bool"],["showObjects","all"],["showPivotChartFilter",!1,"bool"],["updateLinks","userSet"]],cK=[["activeTab",0,"int"],["autoFilterDateGrouping",!0,"bool"],["firstSheet",0,"int"],["minimized",!1,"bool"],["showHorizontalScroll",!0,"bool"],["showSheetTabs",!0,"bool"],["showVerticalScroll",!0,"bool"],["tabRatio",600,"int"],["visibility","visible"]],uK=[],fK=[["calcCompleted","true"],["calcMode","auto"],["calcOnSave","true"],["concurrentCalc","true"],["fullCalcOnLoad","false"],["fullPrecision","true"],["iterate","false"],["iterateCount","100"],["iterateDelta","0.001"],["refMode","A1"]];function m_(e,t){for(var r=0;r!=e.length;++r)for(var n=e[r],a=0;a!=t.length;++a){var i=t[a];if(n[i[0]]==null)n[i[0]]=i[1];else switch(i[2]){case"bool":typeof n[i[0]]=="string"&&(n[i[0]]=wr(n[i[0]]));break;case"int":typeof n[i[0]]=="string"&&(n[i[0]]=parseInt(n[i[0]],10));break}}}function g_(e,t){for(var r=0;r!=t.length;++r){var n=t[r];if(e[n[0]]==null)e[n[0]]=n[1];else switch(n[2]){case"bool":typeof e[n[0]]=="string"&&(e[n[0]]=wr(e[n[0]]));break;case"int":typeof e[n[0]]=="string"&&(e[n[0]]=parseInt(e[n[0]],10));break}}}function TT(e){g_(e.WBProps,AT),g_(e.CalcPr,fK),m_(e.WBView,cK),m_(e.Sheets,uK),Lu.date1904=wr(e.WBProps.date1904)}var hK="][*?/\\".split("");function dK(e,t){if(e.length>31)throw new Error("Sheet names cannot exceed 31 chars");var r=!0;return hK.forEach(function(n){if(e.indexOf(n)!=-1)throw new Error("Sheet name cannot contain : \\ / ? * [ ]")}),r}var pK=/<\w+:workbook/;function mK(e,t){if(!e)throw new Error("Could not find file");var r={AppVersion:{},WBProps:{},WBView:[],Sheets:[],CalcPr:{},Names:[],xmlns:""},n=!1,a="xmlns",i={},s=0;if(e.replace(Gn,function(l,c){var u=wt(l);switch(gs(u[0])){case"<?xml":break;case"<workbook":l.match(pK)&&(a="xmlns"+l.match(/<(\w+):/)[1]),r.xmlns=u[a];break;case"</workbook>":break;case"<fileVersion":delete u[0],r.AppVersion=u;break;case"<fileVersion/>":case"</fileVersion>":break;case"<fileSharing":break;case"<fileSharing/>":break;case"<workbookPr":case"<workbookPr/>":AT.forEach(function(f){if(u[f[0]]!=null)switch(f[2]){case"bool":r.WBProps[f[0]]=wr(u[f[0]]);break;case"int":r.WBProps[f[0]]=parseInt(u[f[0]],10);break;default:r.WBProps[f[0]]=u[f[0]]}}),u.codeName&&(r.WBProps.CodeName=mr(u.codeName));break;case"</workbookPr>":break;case"<workbookProtection":break;case"<workbookProtection/>":break;case"<bookViews":case"<bookViews>":case"</bookViews>":break;case"<workbookView":case"<workbookView/>":delete u[0],r.WBView.push(u);break;case"</workbookView>":break;case"<sheets":case"<sheets>":case"</sheets>":break;case"<sheet":switch(u.state){case"hidden":u.Hidden=1;break;case"veryHidden":u.Hidden=2;break;default:u.Hidden=0}delete u.state,u.name=Wt(mr(u.name)),delete u[0],r.Sheets.push(u);break;case"</sheet>":break;case"<functionGroups":case"<functionGroups/>":break;case"<functionGroup":break;case"<externalReferences":case"</externalReferences>":case"<externalReferences>":break;case"<externalReference":break;case"<definedNames/>":break;case"<definedNames>":case"<definedNames":n=!0;break;case"</definedNames>":n=!1;break;case"<definedName":i={},i.Name=mr(u.name),u.comment&&(i.Comment=u.comment),u.localSheetId&&(i.Sheet=+u.localSheetId),wr(u.hidden||"0")&&(i.Hidden=!0),s=c+l.length;break;case"</definedName>":i.Ref=Wt(mr(e.slice(s,c))),r.Names.push(i);break;case"<definedName/>":break;case"<calcPr":delete u[0],r.CalcPr=u;break;case"<calcPr/>":delete u[0],r.CalcPr=u;break;case"</calcPr>":break;case"<oleSize":break;case"<customWorkbookViews>":case"</customWorkbookViews>":case"<customWorkbookViews":break;case"<customWorkbookView":case"</customWorkbookView>":break;case"<pivotCaches>":case"</pivotCaches>":case"<pivotCaches":break;case"<pivotCache":break;case"<smartTagPr":case"<smartTagPr/>":break;case"<smartTagTypes":case"<smartTagTypes>":case"</smartTagTypes>":break;case"<smartTagType":break;case"<webPublishing":case"<webPublishing/>":break;case"<fileRecoveryPr":case"<fileRecoveryPr/>":break;case"<webPublishObjects>":case"<webPublishObjects":case"</webPublishObjects>":break;case"<webPublishObject":break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":n=!0;break;case"</ext>":n=!1;break;case"<ArchID":break;case"<AlternateContent":case"<AlternateContent>":n=!0;break;case"</AlternateContent>":n=!1;break;case"<revisionPtr":break;default:if(!n&&t.WTF)throw new Error("unrecognized "+u[0]+" in workbook")}return l}),O$.indexOf(r.xmlns)===-1)throw new Error("Unknown Namespace: "+r.xmlns);return TT(r),r}function gK(e,t){var r={};return r.Hidden=e.read_shift(4),r.iTabID=e.read_shift(4),r.strRelID=pv(e),r.name=Hn(e),r}function xK(e,t){var r={},n=e.read_shift(4);r.defaultThemeVersion=e.read_shift(4);var a=t>8?Hn(e):"";return a.length>0&&(r.CodeName=a),r.autoCompressPictures=!!(n&65536),r.backupFile=!!(n&64),r.checkCompatibility=!!(n&4096),r.date1904=!!(n&1),r.filterPrivacy=!!(n&8),r.hidePivotFieldList=!!(n&1024),r.promptedSolutions=!!(n&16),r.publishItems=!!(n&2048),r.refreshAllConnections=!!(n&262144),r.saveExternalLinkValues=!!(n&128),r.showBorderUnselectedTables=!!(n&4),r.showInkAnnotation=!!(n&32),r.showObjects=["all","placeholders","none"][n>>13&3],r.showPivotChartFilter=!!(n&32768),r.updateLinks=["userSet","never","always"][n>>8&3],r}function vK(e,t){var r={};return e.read_shift(4),r.ArchID=e.read_shift(4),e.l+=t-8,r}function yK(e,t,r){var n=e.l+t;e.l+=4,e.l+=1;var a=e.read_shift(4),i=J$(e),s=rG(e,0,r),o=F5(e);e.l=n;var l={Name:i,Ptg:s};return a<268435455&&(l.Sheet=a),o&&(l.Comment=o),l}function wK(e,t){var r={AppVersion:{},WBProps:{},WBView:[],Sheets:[],CalcPr:{},xmlns:""},n=[],a=!1;t||(t={}),t.biff=12;var i=[],s=[[]];return s.SheetNames=[],s.XTI=[],V1[16]={n:"BrtFRTArchID$",f:vK},ao(e,function(l,c,u){switch(u){case 156:s.SheetNames.push(l.name),r.Sheets.push(l);break;case 153:r.WBProps=l;break;case 39:l.Sheet!=null&&(t.SID=l.Sheet),l.Ref=Bn(l.Ptg,null,null,s,t),delete t.SID,delete l.Ptg,i.push(l);break;case 1036:break;case 357:case 358:case 355:case 667:s[0].length?s.push([u,l]):s[0]=[u,l],s[s.length-1].XTI=[];break;case 362:s.length===0&&(s[0]=[],s[0].XTI=[]),s[s.length-1].XTI=s[s.length-1].XTI.concat(l),s.XTI=s.XTI.concat(l);break;case 361:break;case 2071:case 158:case 143:case 664:case 353:break;case 3072:case 3073:case 534:case 677:case 157:case 610:case 2050:case 155:case 548:case 676:case 128:case 665:case 2128:case 2125:case 549:case 2053:case 596:case 2076:case 2075:case 2082:case 397:case 154:case 1117:case 553:case 2091:break;case 35:n.push(u),a=!0;break;case 36:n.pop(),a=!1;break;case 37:n.push(u),a=!0;break;case 38:n.pop(),a=!1;break;case 16:break;default:if(!c.T){if(!a||t.WTF&&n[n.length-1]!=37&&n[n.length-1]!=35)throw new Error("Unexpected record 0x"+u.toString(16))}}},t),TT(r),r.Names=i,r.supbooks=s,r}function bK(e,t,r){return t.slice(-4)===".bin"?wK(e,r):mK(e,r)}function _K(e,t,r,n,a,i,s,o){return t.slice(-4)===".bin"?nK(e,n,r,a,i,s,o):gG(e,n,r,a,i,s,o)}function SK(e,t,r,n,a,i,s,o){return t.slice(-4)===".bin"?lK(e,n,r,a,i):sK(e,n,r,a,i)}function kK(e,t,r,n,a,i,s,o){return t.slice(-4)===".bin"?FW():OW()}function EK(e,t,r,n,a,i,s,o){return t.slice(-4)===".bin"?PW():LW()}function AK(e,t,r,n){return t.slice(-4)===".bin"?GH(e,r,n):$H(e,r,n)}function TK(e,t,r){return dT(e,r)}function CK(e,t,r){return t.slice(-4)===".bin"?cH(e,r):oH(e,r)}function NK(e,t,r){return t.slice(-4)===".bin"?TW(e,r):_W(e,r)}function PK(e,t,r){return t.slice(-4)===".bin"?yW(e):xW(e)}function LK(e,t,r,n){return r.slice(-4)===".bin"?wW(e,t,r,n):void 0}function FK(e,t,r){return t.slice(-4)===".bin"?mW(e,t,r):gW(e,t,r)}var CT=/([\w:]+)=((?:")([^"]*)(?:")|(?:')([^']*)(?:'))/g,NT=/([\w:]+)=((?:")(?:[^"]*)(?:")|(?:')(?:[^']*)(?:'))/;function _i(e,t){var r=e.split(/\s+/),n=[];if(n[0]=r[0],r.length===1)return n;var a=e.match(CT),i,s,o,l;if(a)for(l=0;l!=a.length;++l)i=a[l].match(NT),(s=i[1].indexOf(":"))===-1?n[i[1]]=i[2].slice(1,i[2].length-1):(i[1].slice(0,6)==="xmlns:"?o="xmlns"+i[1].slice(6):o=i[1].slice(s+1),n[o]=i[2].slice(1,i[2].length-1));return n}function OK(e){var t=e.split(/\s+/),r={};if(t.length===1)return r;var n=e.match(CT),a,i,s,o;if(n)for(o=0;o!=n.length;++o)a=n[o].match(NT),(i=a[1].indexOf(":"))===-1?r[a[1]]=a[2].slice(1,a[2].length-1):(a[1].slice(0,6)==="xmlns:"?s="xmlns"+a[1].slice(6):s=a[1].slice(i+1),r[s]=a[2].slice(1,a[2].length-1));return r}var Rf;function IK(e,t){var r=Rf[e]||Wt(e);return r==="General"?ac(t):fi(r,t)}function DK(e,t,r,n){var a=n;switch((r[0].match(/dt:dt="([\w.]+)"/)||["",""])[1]){case"boolean":a=wr(n);break;case"i2":case"int":a=parseInt(n,10);break;case"r4":case"float":a=parseFloat(n);break;case"date":case"dateTime.tz":a=xn(n);break;case"i8":case"string":case"fixed":case"uuid":case"bin.base64":break;default:throw new Error("bad custprop:"+r[0])}e[Wt(t)]=a}function jK(e,t,r){if(e.t!=="z"){if(!r||r.cellText!==!1)try{e.t==="e"?e.w=e.w||vc[e.v]:t==="General"?e.t==="n"?(e.v|0)===e.v?e.w=e.v.toString(10):e.w=ph(e.v):e.w=ac(e.v):e.w=IK(t||"General",e.v)}catch(i){if(r.WTF)throw i}try{var n=Rf[t]||t||"General";if(r.cellNF&&(e.z=n),r.cellDates&&e.t=="n"&&s0(n)){var a=zl(e.v);a&&(e.t="d",e.v=new Date(a.y,a.m-1,a.d,a.H,a.M,a.S,a.u))}}catch(i){if(r.WTF)throw i}}}function RK(e,t,r){if(r.cellStyles&&t.Interior){var n=t.Interior;n.Pattern&&(n.patternType=DH[n.Pattern]||n.Pattern)}e[t.ID]=t}function MK(e,t,r,n,a,i,s,o,l,c){var u="General",f=n.StyleID,d={};c=c||{};var h=[],g=0;for(f===void 0&&o&&(f=o.StyleID),f===void 0&&s&&(f=s.StyleID);i[f]!==void 0&&(i[f].nf&&(u=i[f].nf),i[f].Interior&&h.push(i[f].Interior),!!i[f].Parent);)f=i[f].Parent;switch(r.Type){case"Boolean":n.t="b",n.v=wr(e);break;case"String":n.t="s",n.r=M3(Wt(e)),n.v=e.indexOf("<")>-1?Wt(t||e).replace(/<.*?>/g,""):n.r;break;case"DateTime":e.slice(-1)!="Z"&&(e+="Z"),n.v=(xn(e)-new Date(Date.UTC(1899,11,30)))/(24*60*60*1e3),n.v!==n.v?n.v=Wt(e):n.v<60&&(n.v=n.v-1),(!u||u=="General")&&(u="yyyy-mm-dd");case"Number":n.v===void 0&&(n.v=+e),n.t||(n.t="n");break;case"Error":n.t="e",n.v=WA[e],c.cellText!==!1&&(n.w=e);break;default:e==""&&t==""?n.t="z":(n.t="s",n.v=M3(t||e));break}if(jK(n,u,c),c.cellFormula!==!1)if(n.Formula){var m=Wt(n.Formula);m.charCodeAt(0)==61&&(m=m.slice(1)),n.f=Pu(m,a),delete n.Formula,n.ArrayRange=="RC"?n.F=Pu("RC:RC",a):n.ArrayRange&&(n.F=Pu(n.ArrayRange,a),l.push([Or(n.F),n.F]))}else for(g=0;g<l.length;++g)a.r>=l[g][0].s.r&&a.r<=l[g][0].e.r&&a.c>=l[g][0].s.c&&a.c<=l[g][0].e.c&&(n.F=l[g][1]);c.cellStyles&&(h.forEach(function(_){!d.patternType&&_.patternType&&(d.patternType=_.patternType)}),n.s=d),n.StyleID!==void 0&&(n.ixfe=n.StyleID)}function BK(e){e.t=e.v||"",e.t=e.t.replace(/\r\n/g,`
`).replace(/\r/g,`
`),e.v=e.w=e.ixfe=void 0}function E2(e,t){var r=t||{};xA();var n=af(T5(e));(r.type=="binary"||r.type=="array"||r.type=="base64")&&(n=mr(n));var a=n.slice(0,1024).toLowerCase(),i=!1;if(a=a.replace(/".*?"/g,""),(a.indexOf(">")&1023)>Math.min(a.indexOf(",")&1023,a.indexOf(";")&1023)){var s=Sn(r);return s.type="string",xh.to_workbook(n,s)}if(a.indexOf("<?xml")==-1&&["html","table","head","meta","script","style","div"].forEach(function(Xe){a.indexOf("<"+Xe)>=0&&(i=!0)}),i)return KK(n,r);Rf={"General Number":"General","General Date":Ot[22],"Long Date":"dddd, mmmm dd, yyyy","Medium Date":Ot[15],"Short Date":Ot[14],"Long Time":Ot[19],"Medium Time":Ot[18],"Short Time":Ot[20],Currency:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',Fixed:Ot[2],Standard:Ot[4],Percent:Ot[10],Scientific:Ot[11],"Yes/No":'"Yes";"Yes";"No";@',"True/False":'"True";"True";"False";@',"On/Off":'"Yes";"Yes";"No";@'};var o,l=[],c,u={},f=[],d=r.dense?[]:{},h="",g={},m={},_=_i('<Data ss:Type="String">'),y=0,b=0,w=0,T={s:{r:2e6,c:2e6},e:{r:0,c:0}},F={},I={},A="",P=0,j=[],J={},N={},L=0,G=[],W=[],le={},de=[],X,ee=!1,R=[],pe=[],me={},E=0,D=0,O={Sheets:[],WBProps:{date1904:!1}},M={};gh.lastIndex=0,n=n.replace(/<!--([\s\S]*?)-->/mg,"");for(var K="";o=gh.exec(n);)switch(o[3]=(K=o[3]).toLowerCase()){case"data":if(K=="data"){if(o[1]==="/"){if((c=l.pop())[0]!==o[3])throw new Error("Bad state: "+c.join("|"))}else o[0].charAt(o[0].length-2)!=="/"&&l.push([o[3],!0]);break}if(l[l.length-1][1])break;o[1]==="/"?MK(n.slice(y,o.index),A,_,l[l.length-1][0]=="comment"?le:g,{c:b,r:w},F,de[b],m,R,r):(A="",_=_i(o[0]),y=o.index+o[0].length);break;case"cell":if(o[1]==="/")if(W.length>0&&(g.c=W),(!r.sheetRows||r.sheetRows>w)&&g.v!==void 0&&(r.dense?(d[w]||(d[w]=[]),d[w][b]=g):d[sn(b)+kn(w)]=g),g.HRef&&(g.l={Target:Wt(g.HRef)},g.HRefScreenTip&&(g.l.Tooltip=g.HRefScreenTip),delete g.HRef,delete g.HRefScreenTip),(g.MergeAcross||g.MergeDown)&&(E=b+(parseInt(g.MergeAcross,10)|0),D=w+(parseInt(g.MergeDown,10)|0),j.push({s:{c:b,r:w},e:{c:E,r:D}})),!r.sheetStubs)g.MergeAcross?b=E+1:++b;else if(g.MergeAcross||g.MergeDown){for(var Y=b;Y<=E;++Y)for(var re=w;re<=D;++re)(Y>b||re>w)&&(r.dense?(d[re]||(d[re]=[]),d[re][Y]={t:"z"}):d[sn(Y)+kn(re)]={t:"z"});b=E+1}else++b;else g=OK(o[0]),g.Index&&(b=+g.Index-1),b<T.s.c&&(T.s.c=b),b>T.e.c&&(T.e.c=b),o[0].slice(-2)==="/>"&&++b,W=[];break;case"row":o[1]==="/"||o[0].slice(-2)==="/>"?(w<T.s.r&&(T.s.r=w),w>T.e.r&&(T.e.r=w),o[0].slice(-2)==="/>"&&(m=_i(o[0]),m.Index&&(w=+m.Index-1)),b=0,++w):(m=_i(o[0]),m.Index&&(w=+m.Index-1),me={},(m.AutoFitHeight=="0"||m.Height)&&(me.hpx=parseInt(m.Height,10),me.hpt=hT(me.hpx),pe[w]=me),m.Hidden=="1"&&(me.hidden=!0,pe[w]=me));break;case"worksheet":if(o[1]==="/"){if((c=l.pop())[0]!==o[3])throw new Error("Bad state: "+c.join("|"));f.push(h),T.s.r<=T.e.r&&T.s.c<=T.e.c&&(d["!ref"]=$t(T),r.sheetRows&&r.sheetRows<=T.e.r&&(d["!fullref"]=d["!ref"],T.e.r=r.sheetRows-1,d["!ref"]=$t(T))),j.length&&(d["!merges"]=j),de.length>0&&(d["!cols"]=de),pe.length>0&&(d["!rows"]=pe),u[h]=d}else T={s:{r:2e6,c:2e6},e:{r:0,c:0}},w=b=0,l.push([o[3],!1]),c=_i(o[0]),h=Wt(c.Name),d=r.dense?[]:{},j=[],R=[],pe=[],M={name:h,Hidden:0},O.Sheets.push(M);break;case"table":if(o[1]==="/"){if((c=l.pop())[0]!==o[3])throw new Error("Bad state: "+c.join("|"))}else{if(o[0].slice(-2)=="/>")break;l.push([o[3],!1]),de=[],ee=!1}break;case"style":o[1]==="/"?RK(F,I,r):I=_i(o[0]);break;case"numberformat":I.nf=Wt(_i(o[0]).Format||"General"),Rf[I.nf]&&(I.nf=Rf[I.nf]);for(var se=0;se!=392&&Ot[se]!=I.nf;++se);if(se==392){for(se=57;se!=392;++se)if(Ot[se]==null){Xl(I.nf,se);break}}break;case"column":if(l[l.length-1][0]!=="table")break;if(X=_i(o[0]),X.Hidden&&(X.hidden=!0,delete X.Hidden),X.Width&&(X.wpx=parseInt(X.Width,10)),!ee&&X.wpx>10){ee=!0,ta=uT;for(var xe=0;xe<de.length;++xe)de[xe]&&Ju(de[xe])}ee&&Ju(X),de[X.Index-1||de.length]=X;for(var Ce=0;Ce<+X.Span;++Ce)de[de.length]=Sn(X);break;case"namedrange":if(o[1]==="/")break;O.Names||(O.Names=[]);var Z=wt(o[0]),Ie={Name:Z.Name,Ref:Pu(Z.RefersTo.slice(1),{r:0,c:0})};O.Sheets.length>0&&(Ie.Sheet=O.Sheets.length-1),O.Names.push(Ie);break;case"namedcell":break;case"b":break;case"i":break;case"u":break;case"s":break;case"em":break;case"h2":break;case"h3":break;case"sub":break;case"sup":break;case"span":break;case"alignment":break;case"borders":break;case"border":break;case"font":if(o[0].slice(-2)==="/>")break;o[1]==="/"?A+=n.slice(P,o.index):P=o.index+o[0].length;break;case"interior":if(!r.cellStyles)break;I.Interior=_i(o[0]);break;case"protection":break;case"author":case"title":case"description":case"created":case"keywords":case"subject":case"category":case"company":case"lastauthor":case"lastsaved":case"lastprinted":case"version":case"revision":case"totaltime":case"hyperlinkbase":case"manager":case"contentstatus":case"identifier":case"language":case"appname":if(o[0].slice(-2)==="/>")break;o[1]==="/"?_V(J,K,n.slice(L,o.index)):L=o.index+o[0].length;break;case"paragraphs":break;case"styles":case"workbook":if(o[1]==="/"){if((c=l.pop())[0]!==o[3])throw new Error("Bad state: "+c.join("|"))}else l.push([o[3],!1]);break;case"comment":if(o[1]==="/"){if((c=l.pop())[0]!==o[3])throw new Error("Bad state: "+c.join("|"));BK(le),W.push(le)}else l.push([o[3],!1]),c=_i(o[0]),le={a:c.Author};break;case"autofilter":if(o[1]==="/"){if((c=l.pop())[0]!==o[3])throw new Error("Bad state: "+c.join("|"))}else if(o[0].charAt(o[0].length-2)!=="/"){var He=_i(o[0]);d["!autofilter"]={ref:Pu(He.Range).replace(/\$/g,"")},l.push([o[3],!0])}break;case"name":break;case"datavalidation":if(o[1]==="/"){if((c=l.pop())[0]!==o[3])throw new Error("Bad state: "+c.join("|"))}else o[0].charAt(o[0].length-2)!=="/"&&l.push([o[3],!0]);break;case"pixelsperinch":break;case"componentoptions":case"documentproperties":case"customdocumentproperties":case"officedocumentsettings":case"pivottable":case"pivotcache":case"names":case"mapinfo":case"pagebreaks":case"querytable":case"sorting":case"schema":case"conditionalformatting":case"smarttagtype":case"smarttags":case"excelworkbook":case"workbookoptions":case"worksheetoptions":if(o[1]==="/"){if((c=l.pop())[0]!==o[3])throw new Error("Bad state: "+c.join("|"))}else o[0].charAt(o[0].length-2)!=="/"&&l.push([o[3],!0]);break;case"null":break;default:if(l.length==0&&o[3]=="document"||l.length==0&&o[3]=="uof")return __(n,r);var Te=!0;switch(l[l.length-1][0]){case"officedocumentsettings":switch(o[3]){case"allowpng":break;case"removepersonalinformation":break;case"downloadcomponents":break;case"locationofcomponents":break;case"colors":break;case"color":break;case"index":break;case"rgb":break;case"targetscreensize":break;case"readonlyrecommended":break;default:Te=!1}break;case"componentoptions":switch(o[3]){case"toolbar":break;case"hideofficelogo":break;case"spreadsheetautofit":break;case"label":break;case"caption":break;case"maxheight":break;case"maxwidth":break;case"nextsheetnumber":break;default:Te=!1}break;case"excelworkbook":switch(o[3]){case"date1904":O.WBProps.date1904=!0;break;case"windowheight":break;case"windowwidth":break;case"windowtopx":break;case"windowtopy":break;case"tabratio":break;case"protectstructure":break;case"protectwindow":break;case"protectwindows":break;case"activesheet":break;case"displayinknotes":break;case"firstvisiblesheet":break;case"supbook":break;case"sheetname":break;case"sheetindex":break;case"sheetindexfirst":break;case"sheetindexlast":break;case"dll":break;case"acceptlabelsinformulas":break;case"donotsavelinkvalues":break;case"iteration":break;case"maxiterations":break;case"maxchange":break;case"path":break;case"xct":break;case"count":break;case"selectedsheets":break;case"calculation":break;case"uncalced":break;case"startupprompt":break;case"crn":break;case"externname":break;case"formula":break;case"colfirst":break;case"collast":break;case"wantadvise":break;case"boolean":break;case"error":break;case"text":break;case"ole":break;case"noautorecover":break;case"publishobjects":break;case"donotcalculatebeforesave":break;case"number":break;case"refmoder1c1":break;case"embedsavesmarttags":break;default:Te=!1}break;case"workbookoptions":switch(o[3]){case"owcversion":break;case"height":break;case"width":break;default:Te=!1}break;case"worksheetoptions":switch(o[3]){case"visible":if(o[0].slice(-2)!=="/>")if(o[1]==="/")switch(n.slice(L,o.index)){case"SheetHidden":M.Hidden=1;break;case"SheetVeryHidden":M.Hidden=2;break}else L=o.index+o[0].length;break;case"header":d["!margins"]||jf(d["!margins"]={},"xlml"),isNaN(+wt(o[0]).Margin)||(d["!margins"].header=+wt(o[0]).Margin);break;case"footer":d["!margins"]||jf(d["!margins"]={},"xlml"),isNaN(+wt(o[0]).Margin)||(d["!margins"].footer=+wt(o[0]).Margin);break;case"pagemargins":var oe=wt(o[0]);d["!margins"]||jf(d["!margins"]={},"xlml"),isNaN(+oe.Top)||(d["!margins"].top=+oe.Top),isNaN(+oe.Left)||(d["!margins"].left=+oe.Left),isNaN(+oe.Right)||(d["!margins"].right=+oe.Right),isNaN(+oe.Bottom)||(d["!margins"].bottom=+oe.Bottom);break;case"displayrighttoleft":O.Views||(O.Views=[]),O.Views[0]||(O.Views[0]={}),O.Views[0].RTL=!0;break;case"freezepanes":break;case"frozennosplit":break;case"splithorizontal":case"splitvertical":break;case"donotdisplaygridlines":break;case"activerow":break;case"activecol":break;case"toprowbottompane":break;case"leftcolumnrightpane":break;case"unsynced":break;case"print":break;case"printerrors":break;case"panes":break;case"scale":break;case"pane":break;case"number":break;case"layout":break;case"pagesetup":break;case"selected":break;case"protectobjects":break;case"enableselection":break;case"protectscenarios":break;case"validprinterinfo":break;case"horizontalresolution":break;case"verticalresolution":break;case"numberofcopies":break;case"activepane":break;case"toprowvisible":break;case"leftcolumnvisible":break;case"fittopage":break;case"rangeselection":break;case"papersizeindex":break;case"pagelayoutzoom":break;case"pagebreakzoom":break;case"filteron":break;case"fitwidth":break;case"fitheight":break;case"commentslayout":break;case"zoom":break;case"lefttoright":break;case"gridlines":break;case"allowsort":break;case"allowfilter":break;case"allowinsertrows":break;case"allowdeleterows":break;case"allowinsertcols":break;case"allowdeletecols":break;case"allowinserthyperlinks":break;case"allowformatcells":break;case"allowsizecols":break;case"allowsizerows":break;case"nosummaryrowsbelowdetail":d["!outline"]||(d["!outline"]={}),d["!outline"].above=!0;break;case"tabcolorindex":break;case"donotdisplayheadings":break;case"showpagelayoutzoom":break;case"nosummarycolumnsrightdetail":d["!outline"]||(d["!outline"]={}),d["!outline"].left=!0;break;case"blackandwhite":break;case"donotdisplayzeros":break;case"displaypagebreak":break;case"rowcolheadings":break;case"donotdisplayoutline":break;case"noorientation":break;case"allowusepivottables":break;case"zeroheight":break;case"viewablerange":break;case"selection":break;case"protectcontents":break;default:Te=!1}break;case"pivottable":case"pivotcache":switch(o[3]){case"immediateitemsondrop":break;case"showpagemultipleitemlabel":break;case"compactrowindent":break;case"location":break;case"pivotfield":break;case"orientation":break;case"layoutform":break;case"layoutsubtotallocation":break;case"layoutcompactrow":break;case"position":break;case"pivotitem":break;case"datatype":break;case"datafield":break;case"sourcename":break;case"parentfield":break;case"ptlineitems":break;case"ptlineitem":break;case"countofsameitems":break;case"item":break;case"itemtype":break;case"ptsource":break;case"cacheindex":break;case"consolidationreference":break;case"filename":break;case"reference":break;case"nocolumngrand":break;case"norowgrand":break;case"blanklineafteritems":break;case"hidden":break;case"subtotal":break;case"basefield":break;case"mapchilditems":break;case"function":break;case"refreshonfileopen":break;case"printsettitles":break;case"mergelabels":break;case"defaultversion":break;case"refreshname":break;case"refreshdate":break;case"refreshdatecopy":break;case"versionlastrefresh":break;case"versionlastupdate":break;case"versionupdateablemin":break;case"versionrefreshablemin":break;case"calculation":break;default:Te=!1}break;case"pagebreaks":switch(o[3]){case"colbreaks":break;case"colbreak":break;case"rowbreaks":break;case"rowbreak":break;case"colstart":break;case"colend":break;case"rowend":break;default:Te=!1}break;case"autofilter":switch(o[3]){case"autofiltercolumn":break;case"autofiltercondition":break;case"autofilterand":break;case"autofilteror":break;default:Te=!1}break;case"querytable":switch(o[3]){case"id":break;case"autoformatfont":break;case"autoformatpattern":break;case"querysource":break;case"querytype":break;case"enableredirections":break;case"refreshedinxl9":break;case"urlstring":break;case"htmltables":break;case"connection":break;case"commandtext":break;case"refreshinfo":break;case"notitles":break;case"nextid":break;case"columninfo":break;case"overwritecells":break;case"donotpromptforfile":break;case"textwizardsettings":break;case"source":break;case"number":break;case"decimal":break;case"thousandseparator":break;case"trailingminusnumbers":break;case"formatsettings":break;case"fieldtype":break;case"delimiters":break;case"tab":break;case"comma":break;case"autoformatname":break;case"versionlastedit":break;case"versionlastrefresh":break;default:Te=!1}break;case"datavalidation":switch(o[3]){case"range":break;case"type":break;case"min":break;case"max":break;case"sort":break;case"descending":break;case"order":break;case"casesensitive":break;case"value":break;case"errorstyle":break;case"errormessage":break;case"errortitle":break;case"inputmessage":break;case"inputtitle":break;case"combohide":break;case"inputhide":break;case"condition":break;case"qualifier":break;case"useblank":break;case"value1":break;case"value2":break;case"format":break;case"cellrangelist":break;default:Te=!1}break;case"sorting":case"conditionalformatting":switch(o[3]){case"range":break;case"type":break;case"min":break;case"max":break;case"sort":break;case"descending":break;case"order":break;case"casesensitive":break;case"value":break;case"errorstyle":break;case"errormessage":break;case"errortitle":break;case"cellrangelist":break;case"inputmessage":break;case"inputtitle":break;case"combohide":break;case"inputhide":break;case"condition":break;case"qualifier":break;case"useblank":break;case"value1":break;case"value2":break;case"format":break;default:Te=!1}break;case"mapinfo":case"schema":case"data":switch(o[3]){case"map":break;case"entry":break;case"range":break;case"xpath":break;case"field":break;case"xsdtype":break;case"filteron":break;case"aggregate":break;case"elementtype":break;case"attributetype":break;case"schema":case"element":case"complextype":case"datatype":case"all":case"attribute":case"extends":break;case"row":break;default:Te=!1}break;case"smarttags":break;default:Te=!1;break}if(Te||o[3].match(/!\[CDATA/))break;if(!l[l.length-1][1])throw"Unrecognized tag: "+o[3]+"|"+l.join("|");if(l[l.length-1][0]==="customdocumentproperties"){if(o[0].slice(-2)==="/>")break;o[1]==="/"?DK(N,K,G,n.slice(L,o.index)):(G=o,L=o.index+o[0].length);break}if(r.WTF)throw"Unrecognized tag: "+o[3]+"|"+l.join("|")}var De={};return!r.bookSheets&&!r.bookProps&&(De.Sheets=u),De.SheetNames=f,De.Workbook=O,De.SSF=Sn(Ot),De.Props=J,De.Custprops=N,De}function vv(e,t){switch(V5(t=t||{}),t.type||"base64"){case"base64":return E2(Ba(e),t);case"binary":case"buffer":case"file":return E2(e,t);case"array":return E2(mc(e),t)}}function UK(e){var t={},r=e.content;if(r.l=28,t.AnsiUserType=r.read_shift(0,"lpstr-ansi"),t.AnsiClipboardFormat=eV(r),r.length-r.l<=4)return t;var n=r.read_shift(4);if(n==0||n>40||(r.l-=4,t.Reserved1=r.read_shift(0,"lpstr-ansi"),r.length-r.l<=4)||(n=r.read_shift(4),n!==1907505652)||(t.UnicodeClipboardFormat=tV(r),n=r.read_shift(4),n==0||n>40))return t;r.l-=4,t.Reserved2=r.read_shift(0,"lpwstr")}var $K=[60,1084,2066,2165,2175];function VK(e,t,r,n,a){var i=n,s=[],o=r.slice(r.l,r.l+i);if(a&&a.enc&&a.enc.insitu&&o.length>0)switch(e){case 9:case 521:case 1033:case 2057:case 47:case 405:case 225:case 406:case 312:case 404:case 10:break;case 133:break;default:a.enc.insitu(o)}s.push(o),r.l+=i;for(var l=Bs(r,r.l),c=yv[l],u=0;c!=null&&$K.indexOf(l)>-1;)i=Bs(r,r.l+2),u=r.l+4,l==2066?u+=4:(l==2165||l==2175)&&(u+=12),o=r.slice(u,r.l+4+i),s.push(o),r.l+=4+i,c=yv[l=Bs(r,r.l)];var f=jo(s);bn(f,0);var d=0;f.lens=[];for(var h=0;h<s.length;++h)f.lens.push(d),d+=s[h].length;if(f.length<n)throw"XLS Record 0x"+e.toString(16)+" Truncated: "+f.length+" < "+n;return t.f(f,f.length,a)}function ts(e,t,r){if(e.t!=="z"&&e.XF){var n=0;try{n=e.z||e.XF.numFmtId||0,t.cellNF&&(e.z=Ot[n])}catch(i){if(t.WTF)throw i}if(!t||t.cellText!==!1)try{e.t==="e"?e.w=e.w||vc[e.v]:n===0||n=="General"?e.t==="n"?(e.v|0)===e.v?e.w=e.v.toString(10):e.w=ph(e.v):e.w=ac(e.v):e.w=fi(n,e.v,{date1904:!!r,dateNF:t&&t.dateNF})}catch(i){if(t.WTF)throw i}if(t.cellDates&&n&&e.t=="n"&&s0(Ot[n]||String(n))){var a=zl(e.v);a&&(e.t="d",e.v=new Date(a.y,a.m-1,a.d,a.H,a.M,a.S,a.u))}}}function vp(e,t,r){return{v:e,ixfe:t,t:r}}function zK(e,t){var r={opts:{}},n={},a=t.dense?[]:{},i={},s={},o=null,l=[],c="",u={},f,d="",h,g,m,_,y={},b=[],w,T,F=[],I=[],A={Sheets:[],WBProps:{date1904:!1},Views:[{}]},P={},j=function(Ze){return Ze<8?Yl[Ze]:Ze<64&&I[Ze-8]||Yl[Ze]},J=function(Ze,ze,Jt){var dt=ze.XF.data;if(!(!dt||!dt.patternType||!Jt||!Jt.cellStyles)){ze.s={},ze.s.patternType=dt.patternType;var Zr;(Zr=vh(j(dt.icvFore)))&&(ze.s.fgColor={rgb:Zr}),(Zr=vh(j(dt.icvBack)))&&(ze.s.bgColor={rgb:Zr})}},N=function(Ze,ze,Jt){if(!(me>1)&&!(Jt.sheetRows&&Ze.r>=Jt.sheetRows)){if(Jt.cellStyles&&ze.XF&&ze.XF.data&&J(Ze,ze,Jt),delete ze.ixfe,delete ze.XF,f=Ze,d=Nt(Ze),(!s||!s.s||!s.e)&&(s={s:{r:0,c:0},e:{r:0,c:0}}),Ze.r<s.s.r&&(s.s.r=Ze.r),Ze.c<s.s.c&&(s.s.c=Ze.c),Ze.r+1>s.e.r&&(s.e.r=Ze.r+1),Ze.c+1>s.e.c&&(s.e.c=Ze.c+1),Jt.cellFormula&&ze.f){for(var dt=0;dt<b.length;++dt)if(!(b[dt][0].s.c>Ze.c||b[dt][0].s.r>Ze.r)&&!(b[dt][0].e.c<Ze.c||b[dt][0].e.r<Ze.r)){ze.F=$t(b[dt][0]),(b[dt][0].s.c!=Ze.c||b[dt][0].s.r!=Ze.r)&&delete ze.f,ze.f&&(ze.f=""+Bn(b[dt][1],s,Ze,R,L));break}}Jt.dense?(a[Ze.r]||(a[Ze.r]=[]),a[Ze.r][Ze.c]=ze):a[d]=ze}},L={enc:!1,sbcch:0,snames:[],sharedf:y,arrayf:b,rrtabid:[],lastuser:"",biff:8,codepage:0,winlocked:0,cellStyles:!!t&&!!t.cellStyles,WTF:!!t&&!!t.wtf};t.password&&(L.password=t.password);var G,W=[],le=[],de=[],X=[],ee=!1,R=[];R.SheetNames=L.snames,R.sharedf=L.sharedf,R.arrayf=L.arrayf,R.names=[],R.XTI=[];var pe=0,me=0,E=0,D=[],O=[],M;L.codepage=1200,ji(1200);for(var K=!1;e.l<e.length-1;){var Y=e.l,re=e.read_shift(2);if(re===0&&pe===10)break;var se=e.l===e.length?0:e.read_shift(2),xe=yv[re];if(xe&&xe.f){if(t.bookSheets&&pe===133&&re!==133)break;if(pe=re,xe.r===2||xe.r==12){var Ce=e.read_shift(2);if(se-=2,!L.enc&&Ce!==re&&((Ce&255)<<8|Ce>>8)!==re)throw new Error("rt mismatch: "+Ce+"!="+re);xe.r==12&&(e.l+=10,se-=10)}var Z={};if(re===10?Z=xe.f(e,se,L):Z=VK(re,xe,e,se,L),me==0&&[9,521,1033,2057].indexOf(pe)===-1)continue;switch(re){case 34:r.opts.Date1904=A.WBProps.date1904=Z;break;case 134:r.opts.WriteProtect=!0;break;case 47:if(L.enc||(e.l=0),L.enc=Z,!t.password)throw new Error("File is password-protected");if(Z.valid==null)throw new Error("Encryption scheme unsupported");if(!Z.valid)throw new Error("Password is incorrect");break;case 92:L.lastuser=Z;break;case 66:var Ie=Number(Z);switch(Ie){case 21010:Ie=1200;break;case 32768:Ie=1e4;break;case 32769:Ie=1252;break}ji(L.codepage=Ie),K=!0;break;case 317:L.rrtabid=Z;break;case 25:L.winlocked=Z;break;case 439:r.opts.RefreshAll=Z;break;case 12:r.opts.CalcCount=Z;break;case 16:r.opts.CalcDelta=Z;break;case 17:r.opts.CalcIter=Z;break;case 13:r.opts.CalcMode=Z;break;case 14:r.opts.CalcPrecision=Z;break;case 95:r.opts.CalcSaveRecalc=Z;break;case 15:L.CalcRefMode=Z;break;case 2211:r.opts.FullCalc=Z;break;case 129:Z.fDialog&&(a["!type"]="dialog"),Z.fBelow||((a["!outline"]||(a["!outline"]={})).above=!0),Z.fRight||((a["!outline"]||(a["!outline"]={})).left=!0);break;case 224:F.push(Z);break;case 430:R.push([Z]),R[R.length-1].XTI=[];break;case 35:case 547:R[R.length-1].push(Z);break;case 24:case 536:M={Name:Z.Name,Ref:Bn(Z.rgce,s,null,R,L)},Z.itab>0&&(M.Sheet=Z.itab-1),R.names.push(M),R[0]||(R[0]=[],R[0].XTI=[]),R[R.length-1].push(Z),Z.Name=="_xlnm._FilterDatabase"&&Z.itab>0&&Z.rgce&&Z.rgce[0]&&Z.rgce[0][0]&&Z.rgce[0][0][0]=="PtgArea3d"&&(O[Z.itab-1]={ref:$t(Z.rgce[0][0][1][2])});break;case 22:L.ExternCount=Z;break;case 23:R.length==0&&(R[0]=[],R[0].XTI=[]),R[R.length-1].XTI=R[R.length-1].XTI.concat(Z),R.XTI=R.XTI.concat(Z);break;case 2196:if(L.biff<8)break;M!=null&&(M.Comment=Z[1]);break;case 18:a["!protect"]=Z;break;case 19:Z!==0&&L.WTF&&console.error("Password verifier: "+Z);break;case 133:i[Z.pos]=Z,L.snames.push(Z.name);break;case 10:{if(--me)break;if(s.e){if(s.e.r>0&&s.e.c>0){if(s.e.r--,s.e.c--,a["!ref"]=$t(s),t.sheetRows&&t.sheetRows<=s.e.r){var He=s.e.r;s.e.r=t.sheetRows-1,a["!fullref"]=a["!ref"],a["!ref"]=$t(s),s.e.r=He}s.e.r++,s.e.c++}W.length>0&&(a["!merges"]=W),le.length>0&&(a["!objects"]=le),de.length>0&&(a["!cols"]=de),X.length>0&&(a["!rows"]=X),A.Sheets.push(P)}c===""?u=a:n[c]=a,a=t.dense?[]:{}}break;case 9:case 521:case 1033:case 2057:{if(L.biff===8&&(L.biff={9:2,521:3,1033:4}[re]||{512:2,768:3,1024:4,1280:5,1536:8,2:2,7:2}[Z.BIFFVer]||8),L.biffguess=Z.BIFFVer==0,Z.BIFFVer==0&&Z.dt==4096&&(L.biff=5,K=!0,ji(L.codepage=28591)),L.biff==8&&Z.BIFFVer==0&&Z.dt==16&&(L.biff=2),me++)break;if(a=t.dense?[]:{},L.biff<8&&!K&&(K=!0,ji(L.codepage=t.codepage||1252)),L.biff<5||Z.BIFFVer==0&&Z.dt==4096){c===""&&(c="Sheet1"),s={s:{r:0,c:0},e:{r:0,c:0}};var Te={pos:e.l-se,name:c};i[Te.pos]=Te,L.snames.push(c)}else c=(i[Y]||{name:""}).name;Z.dt==32&&(a["!type"]="chart"),Z.dt==64&&(a["!type"]="macro"),W=[],le=[],L.arrayf=b=[],de=[],X=[],ee=!1,P={Hidden:(i[Y]||{hs:0}).hs,name:c}}break;case 515:case 3:case 2:a["!type"]=="chart"&&(t.dense?(a[Z.r]||[])[Z.c]:a[Nt({c:Z.c,r:Z.r})])&&++Z.c,w={ixfe:Z.ixfe,XF:F[Z.ixfe]||{},v:Z.val,t:"n"},E>0&&(w.z=D[w.ixfe>>8&63]),ts(w,t,r.opts.Date1904),N({c:Z.c,r:Z.r},w,t);break;case 5:case 517:w={ixfe:Z.ixfe,XF:F[Z.ixfe],v:Z.val,t:Z.t},E>0&&(w.z=D[w.ixfe>>8&63]),ts(w,t,r.opts.Date1904),N({c:Z.c,r:Z.r},w,t);break;case 638:w={ixfe:Z.ixfe,XF:F[Z.ixfe],v:Z.rknum,t:"n"},E>0&&(w.z=D[w.ixfe>>8&63]),ts(w,t,r.opts.Date1904),N({c:Z.c,r:Z.r},w,t);break;case 189:for(var oe=Z.c;oe<=Z.C;++oe){var De=Z.rkrec[oe-Z.c][0];w={ixfe:De,XF:F[De],v:Z.rkrec[oe-Z.c][1],t:"n"},E>0&&(w.z=D[w.ixfe>>8&63]),ts(w,t,r.opts.Date1904),N({c:oe,r:Z.r},w,t)}break;case 6:case 518:case 1030:{if(Z.val=="String"){o=Z;break}if(w=vp(Z.val,Z.cell.ixfe,Z.tt),w.XF=F[w.ixfe],t.cellFormula){var Xe=Z.formula;if(Xe&&Xe[0]&&Xe[0][0]&&Xe[0][0][0]=="PtgExp"){var Be=Xe[0][0][1][0],Ge=Xe[0][0][1][1],Ye=Nt({r:Be,c:Ge});y[Ye]?w.f=""+Bn(Z.formula,s,Z.cell,R,L):w.F=((t.dense?(a[Be]||[])[Ge]:a[Ye])||{}).F}else w.f=""+Bn(Z.formula,s,Z.cell,R,L)}E>0&&(w.z=D[w.ixfe>>8&63]),ts(w,t,r.opts.Date1904),N(Z.cell,w,t),o=Z}break;case 7:case 519:if(o)o.val=Z,w=vp(Z,o.cell.ixfe,"s"),w.XF=F[w.ixfe],t.cellFormula&&(w.f=""+Bn(o.formula,s,o.cell,R,L)),E>0&&(w.z=D[w.ixfe>>8&63]),ts(w,t,r.opts.Date1904),N(o.cell,w,t),o=null;else throw new Error("String record expects Formula");break;case 33:case 545:{b.push(Z);var Je=Nt(Z[0].s);if(h=t.dense?(a[Z[0].s.r]||[])[Z[0].s.c]:a[Je],t.cellFormula&&h){if(!o||!Je||!h)break;h.f=""+Bn(Z[1],s,Z[0],R,L),h.F=$t(Z[0])}}break;case 1212:{if(!t.cellFormula)break;if(d){if(!o)break;y[Nt(o.cell)]=Z[0],h=t.dense?(a[o.cell.r]||[])[o.cell.c]:a[Nt(o.cell)],(h||{}).f=""+Bn(Z[0],s,f,R,L)}}break;case 253:w=vp(l[Z.isst].t,Z.ixfe,"s"),l[Z.isst].h&&(w.h=l[Z.isst].h),w.XF=F[w.ixfe],E>0&&(w.z=D[w.ixfe>>8&63]),ts(w,t,r.opts.Date1904),N({c:Z.c,r:Z.r},w,t);break;case 513:t.sheetStubs&&(w={ixfe:Z.ixfe,XF:F[Z.ixfe],t:"z"},E>0&&(w.z=D[w.ixfe>>8&63]),ts(w,t,r.opts.Date1904),N({c:Z.c,r:Z.r},w,t));break;case 190:if(t.sheetStubs)for(var ot=Z.c;ot<=Z.C;++ot){var ct=Z.ixfe[ot-Z.c];w={ixfe:ct,XF:F[ct],t:"z"},E>0&&(w.z=D[w.ixfe>>8&63]),ts(w,t,r.opts.Date1904),N({c:ot,r:Z.r},w,t)}break;case 214:case 516:case 4:w=vp(Z.val,Z.ixfe,"s"),w.XF=F[w.ixfe],E>0&&(w.z=D[w.ixfe>>8&63]),ts(w,t,r.opts.Date1904),N({c:Z.c,r:Z.r},w,t);break;case 0:case 512:me===1&&(s=Z);break;case 252:l=Z;break;case 1054:if(L.biff==4){D[E++]=Z[1];for(var gt=0;gt<E+163&&Ot[gt]!=Z[1];++gt);gt>=163&&Xl(Z[1],E+163)}else Xl(Z[1],Z[0]);break;case 30:{D[E++]=Z;for(var bt=0;bt<E+163&&Ot[bt]!=Z;++bt);bt>=163&&Xl(Z,E+163)}break;case 229:W=W.concat(Z);break;case 93:le[Z.cmo[0]]=L.lastobj=Z;break;case 438:L.lastobj.TxO=Z;break;case 127:L.lastobj.ImData=Z;break;case 440:for(_=Z[0].s.r;_<=Z[0].e.r;++_)for(m=Z[0].s.c;m<=Z[0].e.c;++m)h=t.dense?(a[_]||[])[m]:a[Nt({c:m,r:_})],h&&(h.l=Z[1]);break;case 2048:for(_=Z[0].s.r;_<=Z[0].e.r;++_)for(m=Z[0].s.c;m<=Z[0].e.c;++m)h=t.dense?(a[_]||[])[m]:a[Nt({c:m,r:_})],h&&h.l&&(h.l.Tooltip=Z[1]);break;case 28:{if(L.biff<=5&&L.biff>=2)break;h=t.dense?(a[Z[0].r]||[])[Z[0].c]:a[Nt(Z[0])];var It=le[Z[2]];h||(t.dense?(a[Z[0].r]||(a[Z[0].r]=[]),h=a[Z[0].r][Z[0].c]={t:"z"}):h=a[Nt(Z[0])]={t:"z"},s.e.r=Math.max(s.e.r,Z[0].r),s.s.r=Math.min(s.s.r,Z[0].r),s.e.c=Math.max(s.e.c,Z[0].c),s.s.c=Math.min(s.s.c,Z[0].c)),h.c||(h.c=[]),g={a:Z[1],t:It.TxO.t},h.c.push(g)}break;case 2173:fW(F[Z.ixfe],Z.ext);break;case 125:{if(!L.cellStyles)break;for(;Z.e>=Z.s;)de[Z.e--]={width:Z.w/256,level:Z.level||0,hidden:!!(Z.flags&1)},ee||(ee=!0,R5(Z.w/256)),Ju(de[Z.e+1])}break;case 520:{var Et={};Z.level!=null&&(X[Z.r]=Et,Et.level=Z.level),Z.hidden&&(X[Z.r]=Et,Et.hidden=!0),Z.hpt&&(X[Z.r]=Et,Et.hpt=Z.hpt,Et.hpx=yh(Z.hpt))}break;case 38:case 39:case 40:case 41:a["!margins"]||jf(a["!margins"]={}),a["!margins"][{38:"left",39:"right",40:"top",41:"bottom"}[re]]=Z;break;case 161:a["!margins"]||jf(a["!margins"]={}),a["!margins"].header=Z.header,a["!margins"].footer=Z.footer;break;case 574:Z.RTL&&(A.Views[0].RTL=!0);break;case 146:I=Z;break;case 2198:G=Z;break;case 140:T=Z;break;case 442:c?P.CodeName=Z||P.name:A.WBProps.CodeName=Z||"ThisWorkbook";break}}else xe||console.error("Missing Info for XLS Record 0x"+re.toString(16)),e.l+=se}return r.SheetNames=ds(i).sort(function(ut,Ze){return Number(ut)-Number(Ze)}).map(function(ut){return i[ut].name}),t.bookSheets||(r.Sheets=n),!r.SheetNames.length&&u["!ref"]?(r.SheetNames.push("Sheet1"),r.Sheets&&(r.Sheets.Sheet1=u)):r.Preamble=u,r.Sheets&&O.forEach(function(ut,Ze){r.Sheets[r.SheetNames[Ze]]["!autofilter"]=ut}),r.Strings=l,r.SSF=Sn(Ot),L.enc&&(r.Encryption=L.enc),G&&(r.Themes=G),r.Metadata={},T!==void 0&&(r.Metadata.Country=T),R.names.length>0&&(A.Names=R.names),r.Workbook=A,r}var x_={SI:"e0859ff2f94f6810ab9108002b27b3d9",DSI:"02d5cdd59c2e1b10939708002b2cf9ae",UDI:"05d5cdd59c2e1b10939708002b2cf9ae"};function HK(e,t,r){var n=Ut.find(e,"/!DocumentSummaryInformation");if(n&&n.size>0)try{var a=e_(n,oV,x_.DSI);for(var i in a)t[i]=a[i]}catch(c){if(r.WTF)throw c}var s=Ut.find(e,"/!SummaryInformation");if(s&&s.size>0)try{var o=e_(s,lV,x_.SI);for(var l in o)t[l]==null&&(t[l]=o[l])}catch(c){if(r.WTF)throw c}t.HeadingPairs&&t.TitlesOfParts&&(GA(t.HeadingPairs,t.TitlesOfParts,t,r),delete t.HeadingPairs,delete t.TitlesOfParts)}function PT(e,t){t||(t={}),V5(t),iA(),t.codepage&&w5(t.codepage);var r,n;if(e.FullPaths){if(Ut.find(e,"/encryption"))throw new Error("File is password-protected");r=Ut.find(e,"!CompObj"),n=Ut.find(e,"/Workbook")||Ut.find(e,"/Book")}else{switch(t.type){case"base64":e=Ii(Ba(e));break;case"binary":e=Ii(e);break;case"buffer":break;case"array":Array.isArray(e)||(e=Array.prototype.slice.call(e));break}bn(e,0),n={content:e}}var a,i;if(r&&UK(r),t.bookProps&&!t.bookSheets)a={};else{var s=Mt?"buffer":"array";if(n&&n.content)a=zK(n.content,t);else if((i=Ut.find(e,"PerfectOffice_MAIN"))&&i.content)a=If.to_workbook(i.content,(t.type=s,t));else if((i=Ut.find(e,"NativeContent_MAIN"))&&i.content)a=If.to_workbook(i.content,(t.type=s,t));else throw(i=Ut.find(e,"MN0"))&&i.content?new Error("Unsupported Works 4 for Mac file"):new Error("Cannot find Workbook stream");t.bookVBA&&e.FullPaths&&Ut.find(e,"/_VBA_PROJECT_CUR/VBA/dir")&&(a.vbaraw=NW(e))}var o={};return e.FullPaths&&HK(e,o,t),a.Props=a.Custprops=o,t.bookFiles&&(a.cfb=e),a}var V1={0:{f:EG},1:{f:NG},2:{f:MG},3:{f:OG},4:{f:LG},5:{f:RG},6:{f:$G},7:{f:DG},8:{f:qG},9:{f:WG},10:{f:zG},11:{f:HG},12:{f:PG},13:{f:BG},14:{f:IG},15:{f:FG},16:{f:ET},17:{f:VG},18:{f:jG},19:{f:L5},20:{},21:{},22:{},23:{},24:{},25:{},26:{},27:{},28:{},29:{},30:{},31:{},32:{},33:{},34:{},35:{T:1},36:{T:-1},37:{T:1},38:{T:-1},39:{f:yK},40:{},42:{},43:{f:zH},44:{f:VH},45:{f:HH},46:{f:qH},47:{f:WH},48:{},49:{f:G$},50:{},51:{f:dW},52:{T:1},53:{T:-1},54:{T:1},55:{T:-1},56:{T:1},57:{T:-1},58:{},59:{},60:{f:iT},62:{f:UG},63:{f:vW},64:{f:tK},65:{},66:{},67:{},68:{},69:{},70:{},128:{},129:{T:1},130:{T:-1},131:{T:1,f:qn,p:0},132:{T:-1},133:{T:1},134:{T:-1},135:{T:1},136:{T:-1},137:{T:1,f:eK},138:{T:-1},139:{T:1},140:{T:-1},141:{T:1},142:{T:-1},143:{T:1},144:{T:-1},145:{T:1},146:{T:-1},147:{f:CG},148:{f:AG,p:16},151:{f:XG},152:{},153:{f:xK},154:{},155:{},156:{f:gK},157:{},158:{},159:{T:1,f:lH},160:{T:-1},161:{T:1,f:xc},162:{T:-1},163:{T:1},164:{T:-1},165:{T:1},166:{T:-1},167:{},168:{},169:{},170:{},171:{},172:{T:1},173:{T:-1},174:{},175:{},176:{f:GG},177:{T:1},178:{T:-1},179:{T:1},180:{T:-1},181:{T:1},182:{T:-1},183:{T:1},184:{T:-1},185:{T:1},186:{T:-1},187:{T:1},188:{T:-1},189:{T:1},190:{T:-1},191:{T:1},192:{T:-1},193:{T:1},194:{T:-1},195:{T:1},196:{T:-1},197:{T:1},198:{T:-1},199:{T:1},200:{T:-1},201:{T:1},202:{T:-1},203:{T:1},204:{T:-1},205:{T:1},206:{T:-1},207:{T:1},208:{T:-1},209:{T:1},210:{T:-1},211:{T:1},212:{T:-1},213:{T:1},214:{T:-1},215:{T:1},216:{T:-1},217:{T:1},218:{T:-1},219:{T:1},220:{T:-1},221:{T:1},222:{T:-1},223:{T:1},224:{T:-1},225:{T:1},226:{T:-1},227:{T:1},228:{T:-1},229:{T:1},230:{T:-1},231:{T:1},232:{T:-1},233:{T:1},234:{T:-1},235:{T:1},236:{T:-1},237:{T:1},238:{T:-1},239:{T:1},240:{T:-1},241:{T:1},242:{T:-1},243:{T:1},244:{T:-1},245:{T:1},246:{T:-1},247:{T:1},248:{T:-1},249:{T:1},250:{T:-1},251:{T:1},252:{T:-1},253:{T:1},254:{T:-1},255:{T:1},256:{T:-1},257:{T:1},258:{T:-1},259:{T:1},260:{T:-1},261:{T:1},262:{T:-1},263:{T:1},264:{T:-1},265:{T:1},266:{T:-1},267:{T:1},268:{T:-1},269:{T:1},270:{T:-1},271:{T:1},272:{T:-1},273:{T:1},274:{T:-1},275:{T:1},276:{T:-1},277:{},278:{T:1},279:{T:-1},280:{T:1},281:{T:-1},282:{T:1},283:{T:1},284:{T:-1},285:{T:1},286:{T:-1},287:{T:1},288:{T:-1},289:{T:1},290:{T:-1},291:{T:1},292:{T:-1},293:{T:1},294:{T:-1},295:{T:1},296:{T:-1},297:{T:1},298:{T:-1},299:{T:1},300:{T:-1},301:{T:1},302:{T:-1},303:{T:1},304:{T:-1},305:{T:1},306:{T:-1},307:{T:1},308:{T:-1},309:{T:1},310:{T:-1},311:{T:1},312:{T:-1},313:{T:-1},314:{T:1},315:{T:-1},316:{T:1},317:{T:-1},318:{T:1},319:{T:-1},320:{T:1},321:{T:-1},322:{T:1},323:{T:-1},324:{T:1},325:{T:-1},326:{T:1},327:{T:-1},328:{T:1},329:{T:-1},330:{T:1},331:{T:-1},332:{T:1},333:{T:-1},334:{T:1},335:{f:hW},336:{T:-1},337:{f:pW,T:1},338:{T:-1},339:{T:1},340:{T:-1},341:{T:1},342:{T:-1},343:{T:1},344:{T:-1},345:{T:1},346:{T:-1},347:{T:1},348:{T:-1},349:{T:1},350:{T:-1},351:{},352:{},353:{T:1},354:{T:-1},355:{f:pv},357:{},358:{},359:{},360:{T:1},361:{},362:{f:aT},363:{},364:{},366:{},367:{},368:{},369:{},370:{},371:{},372:{T:1},373:{T:-1},374:{T:1},375:{T:-1},376:{T:1},377:{T:-1},378:{T:1},379:{T:-1},380:{T:1},381:{T:-1},382:{T:1},383:{T:-1},384:{T:1},385:{T:-1},386:{T:1},387:{T:-1},388:{T:1},389:{T:-1},390:{T:1},391:{T:-1},392:{T:1},393:{T:-1},394:{T:1},395:{T:-1},396:{},397:{},398:{},399:{},400:{},401:{T:1},403:{},404:{},405:{},406:{},407:{},408:{},409:{},410:{},411:{},412:{},413:{},414:{},415:{},416:{},417:{},418:{},419:{},420:{},421:{},422:{T:1},423:{T:1},424:{T:-1},425:{T:-1},426:{f:YG},427:{f:JG},428:{},429:{T:1},430:{T:-1},431:{T:1},432:{T:-1},433:{T:1},434:{T:-1},435:{T:1},436:{T:-1},437:{T:1},438:{T:-1},439:{T:1},440:{T:-1},441:{T:1},442:{T:-1},443:{T:1},444:{T:-1},445:{T:1},446:{T:-1},447:{T:1},448:{T:-1},449:{T:1},450:{T:-1},451:{T:1},452:{T:-1},453:{T:1},454:{T:-1},455:{T:1},456:{T:-1},457:{T:1},458:{T:-1},459:{T:1},460:{T:-1},461:{T:1},462:{T:-1},463:{T:1},464:{T:-1},465:{T:1},466:{T:-1},467:{T:1},468:{T:-1},469:{T:1},470:{T:-1},471:{},472:{},473:{T:1},474:{T:-1},475:{},476:{f:ZG},477:{},478:{},479:{T:1},480:{T:-1},481:{T:1},482:{T:-1},483:{T:1},484:{T:-1},485:{f:TG},486:{T:1},487:{T:-1},488:{T:1},489:{T:-1},490:{T:1},491:{T:-1},492:{T:1},493:{T:-1},494:{f:KG},495:{T:1},496:{T:-1},497:{T:1},498:{T:-1},499:{},500:{T:1},501:{T:-1},502:{T:1},503:{T:-1},504:{},505:{T:1},506:{T:-1},507:{},508:{T:1},509:{T:-1},510:{T:1},511:{T:-1},512:{},513:{},514:{T:1},515:{T:-1},516:{T:1},517:{T:-1},518:{T:1},519:{T:-1},520:{T:1},521:{T:-1},522:{},523:{},524:{},525:{},526:{},527:{},528:{T:1},529:{T:-1},530:{T:1},531:{T:-1},532:{T:1},533:{T:-1},534:{},535:{},536:{},537:{},538:{T:1},539:{T:-1},540:{T:1},541:{T:-1},542:{T:1},548:{},549:{},550:{f:pv},551:{},552:{},553:{},554:{T:1},555:{T:-1},556:{T:1},557:{T:-1},558:{T:1},559:{T:-1},560:{T:1},561:{T:-1},562:{},564:{},565:{T:1},566:{T:-1},569:{T:1},570:{T:-1},572:{},573:{T:1},574:{T:-1},577:{},578:{},579:{},580:{},581:{},582:{},583:{},584:{},585:{},586:{},587:{},588:{T:-1},589:{},590:{T:1},591:{T:-1},592:{T:1},593:{T:-1},594:{T:1},595:{T:-1},596:{},597:{T:1},598:{T:-1},599:{T:1},600:{T:-1},601:{T:1},602:{T:-1},603:{T:1},604:{T:-1},605:{T:1},606:{T:-1},607:{},608:{T:1},609:{T:-1},610:{},611:{T:1},612:{T:-1},613:{T:1},614:{T:-1},615:{T:1},616:{T:-1},617:{T:1},618:{T:-1},619:{T:1},620:{T:-1},625:{},626:{T:1},627:{T:-1},628:{T:1},629:{T:-1},630:{T:1},631:{T:-1},632:{f:AW},633:{T:1},634:{T:-1},635:{T:1,f:EW},636:{T:-1},637:{f:X$},638:{T:1},639:{},640:{T:-1},641:{T:1},642:{T:-1},643:{T:1},644:{},645:{T:-1},646:{T:1},648:{T:1},649:{},650:{T:-1},651:{f:oK},652:{},653:{T:1},654:{T:-1},655:{T:1},656:{T:-1},657:{T:1},658:{T:-1},659:{},660:{T:1},661:{},662:{T:-1},663:{},664:{T:1},665:{},666:{T:-1},667:{},668:{},669:{},671:{T:1},672:{T:-1},673:{T:1},674:{T:-1},675:{},676:{},677:{},678:{},679:{},680:{},681:{},1024:{},1025:{},1026:{T:1},1027:{T:-1},1028:{T:1},1029:{T:-1},1030:{},1031:{T:1},1032:{T:-1},1033:{T:1},1034:{T:-1},1035:{},1036:{},1037:{},1038:{T:1},1039:{T:-1},1040:{},1041:{T:1},1042:{T:-1},1043:{},1044:{},1045:{},1046:{T:1},1047:{T:-1},1048:{T:1},1049:{T:-1},1050:{},1051:{T:1},1052:{T:1},1053:{f:rK},1054:{T:1},1055:{},1056:{T:1},1057:{T:-1},1058:{T:1},1059:{T:-1},1061:{},1062:{T:1},1063:{T:-1},1064:{T:1},1065:{T:-1},1066:{T:1},1067:{T:-1},1068:{T:1},1069:{T:-1},1070:{T:1},1071:{T:-1},1072:{T:1},1073:{T:-1},1075:{T:1},1076:{T:-1},1077:{T:1},1078:{T:-1},1079:{T:1},1080:{T:-1},1081:{T:1},1082:{T:-1},1083:{T:1},1084:{T:-1},1085:{},1086:{T:1},1087:{T:-1},1088:{T:1},1089:{T:-1},1090:{T:1},1091:{T:-1},1092:{T:1},1093:{T:-1},1094:{T:1},1095:{T:-1},1096:{},1097:{T:1},1098:{},1099:{T:-1},1100:{T:1},1101:{T:-1},1102:{},1103:{},1104:{},1105:{},1111:{},1112:{},1113:{T:1},1114:{T:-1},1115:{T:1},1116:{T:-1},1117:{},1118:{T:1},1119:{T:-1},1120:{T:1},1121:{T:-1},1122:{T:1},1123:{T:-1},1124:{T:1},1125:{T:-1},1126:{},1128:{T:1},1129:{T:-1},1130:{},1131:{T:1},1132:{T:-1},1133:{T:1},1134:{T:-1},1135:{T:1},1136:{T:-1},1137:{T:1},1138:{T:-1},1139:{T:1},1140:{T:-1},1141:{},1142:{T:1},1143:{T:-1},1144:{T:1},1145:{T:-1},1146:{},1147:{T:1},1148:{T:-1},1149:{T:1},1150:{T:-1},1152:{T:1},1153:{T:-1},1154:{T:-1},1155:{T:-1},1156:{T:-1},1157:{T:1},1158:{T:-1},1159:{T:1},1160:{T:-1},1161:{T:1},1162:{T:-1},1163:{T:1},1164:{T:-1},1165:{T:1},1166:{T:-1},1167:{T:1},1168:{T:-1},1169:{T:1},1170:{T:-1},1171:{},1172:{T:1},1173:{T:-1},1177:{},1178:{T:1},1180:{},1181:{},1182:{},2048:{T:1},2049:{T:-1},2050:{},2051:{T:1},2052:{T:-1},2053:{},2054:{},2055:{T:1},2056:{T:-1},2057:{T:1},2058:{T:-1},2060:{},2067:{},2068:{T:1},2069:{T:-1},2070:{},2071:{},2072:{T:1},2073:{T:-1},2075:{},2076:{},2077:{T:1},2078:{T:-1},2079:{},2080:{T:1},2081:{T:-1},2082:{},2083:{T:1},2084:{T:-1},2085:{T:1},2086:{T:-1},2087:{T:1},2088:{T:-1},2089:{T:1},2090:{T:-1},2091:{},2092:{},2093:{T:1},2094:{T:-1},2095:{},2096:{T:1},2097:{T:-1},2098:{T:1},2099:{T:-1},2100:{T:1},2101:{T:-1},2102:{},2103:{T:1},2104:{T:-1},2105:{},2106:{T:1},2107:{T:-1},2108:{},2109:{T:1},2110:{T:-1},2111:{T:1},2112:{T:-1},2113:{T:1},2114:{T:-1},2115:{},2116:{},2117:{},2118:{T:1},2119:{T:-1},2120:{},2121:{T:1},2122:{T:-1},2123:{T:1},2124:{T:-1},2125:{},2126:{T:1},2127:{T:-1},2128:{},2129:{T:1},2130:{T:-1},2131:{T:1},2132:{T:-1},2133:{T:1},2134:{},2135:{},2136:{},2137:{T:1},2138:{T:-1},2139:{T:1},2140:{T:-1},2141:{},3072:{},3073:{},4096:{T:1},4097:{T:-1},5002:{T:1},5003:{T:-1},5081:{T:1},5082:{T:-1},5083:{},5084:{T:1},5085:{T:-1},5086:{T:1},5087:{T:-1},5088:{},5089:{},5090:{},5092:{T:1},5093:{T:-1},5094:{},5095:{T:1},5096:{T:-1},5097:{},5099:{},65535:{n:""}},yv={6:{f:S2},10:{f:_o},12:{f:Jr},13:{f:Jr},14:{f:Mr},15:{f:Mr},16:{f:$n},17:{f:Mr},18:{f:Mr},19:{f:Jr},20:{f:a_},21:{f:a_},23:{f:aT},24:{f:s_},25:{f:Mr},26:{},27:{},28:{f:Sz},29:{},34:{f:Mr},35:{f:i_},38:{f:$n},39:{f:$n},40:{f:$n},41:{f:$n},42:{f:Mr},43:{f:Mr},47:{f:TH},49:{f:az},51:{f:Jr},60:{},61:{f:tz},64:{f:Mr},65:{f:nz},66:{f:Jr},77:{},80:{},81:{},82:{},85:{f:Jr},89:{},90:{},91:{},92:{f:GV},93:{f:Ez},94:{},95:{f:Mr},96:{},97:{},99:{f:Mr},125:{f:iT},128:{f:pz},129:{f:KV},130:{f:Jr},131:{f:Mr},132:{f:Mr},133:{f:XV},134:{},140:{f:Lz},141:{f:Jr},144:{},146:{f:Oz},151:{},152:{},153:{},154:{},155:{},156:{f:Jr},157:{},158:{},160:{f:Mz},161:{f:Dz},174:{},175:{},176:{},177:{},178:{},180:{},181:{},182:{},184:{},185:{},189:{f:uz},190:{f:fz},193:{f:_o},197:{},198:{},199:{},200:{},201:{},202:{f:Mr},203:{},204:{},205:{},206:{},207:{},208:{},209:{},210:{},211:{},213:{},215:{},216:{},217:{},218:{f:Jr},220:{},221:{f:Mr},222:{},224:{f:dz},225:{f:qV},226:{f:_o},227:{},229:{f:kz},233:{},235:{},236:{},237:{},239:{},240:{},241:{},242:{},244:{},245:{},246:{},247:{},248:{},249:{},251:{},252:{f:YV},253:{f:iz},255:{f:JV},256:{},259:{},290:{},311:{},312:{},315:{},317:{f:QA},318:{},319:{},320:{},330:{},331:{},333:{},334:{},335:{},336:{},337:{},338:{},339:{},340:{},351:{},352:{f:Mr},353:{f:_o},401:{},402:{},403:{},404:{},405:{},406:{},407:{},408:{},425:{},426:{},427:{},428:{},429:{},430:{f:gz},431:{f:Mr},432:{},433:{},434:{},437:{},438:{f:Cz},439:{f:Mr},440:{f:Nz},441:{},442:{f:zh},443:{},444:{f:Jr},445:{},446:{},448:{f:_o},449:{f:ez,r:2},450:{f:_o},512:{f:r_},513:{f:Rz},515:{f:mz},516:{f:sz},517:{f:n_},519:{f:Bz},520:{f:QV},523:{},545:{f:o_},549:{f:t_},566:{},574:{f:rz},638:{f:cz},659:{},1048:{},1054:{f:oz},1084:{},1212:{f:wz},2048:{f:Pz},2049:{},2050:{},2051:{},2052:{},2053:{},2054:{},2055:{},2056:{},2057:{f:mp},2058:{},2059:{},2060:{},2061:{},2062:{},2063:{},2064:{},2066:{},2067:{},2128:{},2129:{},2130:{},2131:{},2132:{},2133:{},2134:{},2135:{},2136:{},2137:{},2138:{},2146:{},2147:{r:12},2148:{},2149:{},2150:{},2151:{f:_o},2152:{},2154:{},2155:{},2156:{},2161:{},2162:{},2164:{},2165:{},2166:{},2167:{},2168:{},2169:{},2170:{},2171:{},2172:{f:Iz,r:12},2173:{f:uW,r:12},2174:{},2175:{},2180:{},2181:{},2182:{},2183:{},2184:{},2185:{},2186:{},2187:{},2188:{f:Mr,r:12},2189:{},2190:{r:12},2191:{},2192:{},2194:{},2195:{},2196:{f:yz,r:12},2197:{},2198:{f:aW,r:12},2199:{},2200:{},2201:{},2202:{f:bz,r:12},2203:{f:_o},2204:{},2205:{},2206:{},2207:{},2211:{f:ZV},2212:{},2213:{},2214:{},2215:{},4097:{},4098:{},4099:{},4102:{},4103:{},4105:{},4106:{},4107:{},4108:{},4109:{},4116:{},4117:{},4118:{},4119:{},4120:{},4121:{},4122:{},4123:{},4124:{},4125:{},4126:{},4127:{},4128:{},4129:{},4130:{},4132:{},4133:{},4134:{f:Jr},4135:{},4146:{},4147:{},4148:{},4149:{},4154:{},4156:{},4157:{},4158:{},4159:{},4160:{},4161:{},4163:{},4164:{f:jz},4165:{},4166:{},4168:{},4170:{},4171:{},4174:{},4175:{},4176:{},4177:{},4187:{},4188:{f:Fz},4189:{},4191:{},4192:{},4193:{},4194:{},4195:{},4196:{},4197:{},4198:{},4199:{},4200:{},0:{f:r_},1:{},2:{f:zz},3:{f:Vz},4:{f:$z},5:{f:n_},7:{f:Hz},8:{},9:{f:mp},11:{},22:{f:Jr},30:{f:lz},31:{},32:{},33:{f:o_},36:{},37:{f:t_},50:{f:Wz},62:{},52:{},67:{},68:{f:Jr},69:{},86:{},126:{},127:{f:Uz},135:{},136:{},137:{},145:{},148:{},149:{},150:{},169:{},171:{},188:{},191:{},192:{},194:{},195:{},214:{f:qz},223:{},234:{},354:{},421:{},518:{f:S2},521:{f:mp},536:{f:s_},547:{f:i_},561:{},579:{},1030:{f:S2},1033:{f:mp},1091:{},2157:{},2163:{},2177:{},2240:{},2241:{},2242:{},2243:{},2244:{},2245:{},2246:{},2247:{},2248:{},2249:{},2250:{},2251:{},2262:{r:12},29282:{}};function Si(e,t,r,n){var a=t;if(!isNaN(a)){var i=(r||[]).length||0,s=e.next(4);s.write_shift(2,a),s.write_shift(2,i),i>0&&BA(r)&&e.push(r)}}function v_(e,t){var r=t||{},n=r.dense?[]:{};e=e.replace(/<!--.*?-->/g,"");var a=e.match(/<table/i);if(!a)throw new Error("Invalid HTML: could not find <table>");var i=e.match(/<\/table/i),s=a.index,o=i&&i.index||e.length,l=m$(e.slice(s,o),/(:?<tr[^>]*>)/i,"<tr>"),c=-1,u=0,f=0,d=0,h={s:{r:1e7,c:1e7},e:{r:0,c:0}},g=[];for(s=0;s<l.length;++s){var m=l[s].trim(),_=m.slice(0,3).toLowerCase();if(_=="<tr"){if(++c,r.sheetRows&&r.sheetRows<=c){--c;break}u=0;continue}if(!(_!="<td"&&_!="<th")){var y=m.split(/<\/t[dh]>/i);for(o=0;o<y.length;++o){var b=y[o].trim();if(b.match(/<t[dh]/i)){for(var w=b,T=0;w.charAt(0)=="<"&&(T=w.indexOf(">"))>-1;)w=w.slice(T+1);for(var F=0;F<g.length;++F){var I=g[F];I.s.c==u&&I.s.r<c&&c<=I.e.r&&(u=I.e.c+1,F=-1)}var A=wt(b.slice(0,b.indexOf(">")));d=A.colspan?+A.colspan:1,((f=+A.rowspan)>1||d>1)&&g.push({s:{r:c,c:u},e:{r:c+(f||1)-1,c:u+d-1}});var P=A.t||A["data-t"]||"";if(!w.length){u+=d;continue}if(w=AA(w),h.s.r>c&&(h.s.r=c),h.e.r<c&&(h.e.r=c),h.s.c>u&&(h.s.c=u),h.e.c<u&&(h.e.c=u),!w.length){u+=d;continue}var j={t:"s",v:w};r.raw||!w.trim().length||P=="s"||(w==="TRUE"?j={t:"b",v:!0}:w==="FALSE"?j={t:"b",v:!1}:isNaN($i(w))?isNaN(Yu(w).getDate())||(j={t:"d",v:xn(w)},r.cellDates||(j={t:"n",v:ia(j.v)}),j.z=r.dateNF||Ot[14]):j={t:"n",v:$i(w)}),r.dense?(n[c]||(n[c]=[]),n[c][u]=j):n[Nt({r:c,c:u})]=j,u+=d}}}}return n["!ref"]=$t(h),g.length&&(n["!merges"]=g),n}function WK(e,t,r,n){for(var a=e["!merges"]||[],i=[],s=t.s.c;s<=t.e.c;++s){for(var o=0,l=0,c=0;c<a.length;++c)if(!(a[c].s.r>r||a[c].s.c>s)&&!(a[c].e.r<r||a[c].e.c<s)){if(a[c].s.r<r||a[c].s.c<s){o=-1;break}o=a[c].e.r-a[c].s.r+1,l=a[c].e.c-a[c].s.c+1;break}if(!(o<0)){var u=Nt({r,c:s}),f=n.dense?(e[r]||[])[s]:e[u],d=f&&f.v!=null&&(f.h||A5(f.w||(eo(f),f.w)||""))||"",h={};o>1&&(h.rowspan=o),l>1&&(h.colspan=l),n.editable?d='<span contenteditable="true">'+d+"</span>":f&&(h["data-t"]=f&&f.t||"z",f.v!=null&&(h["data-v"]=f.v),f.z!=null&&(h["data-z"]=f.z),f.l&&(f.l.Target||"#").charAt(0)!="#"&&(d='<a href="'+f.l.Target+'">'+d+"</a>")),h.id=(n.id||"sjs")+"-"+u,i.push(L$("td",d,h))}}var g="<tr>";return g+i.join("")+"</tr>"}var qK='<html><head><meta charset="utf-8"/><title>SheetJS Table Export</title></head><body>',GK="</body></html>";function KK(e,t){var r=e.match(/<table[\s\S]*?>[\s\S]*?<\/table>/gi);if(!r||r.length==0)throw new Error("Invalid HTML: could not find <table>");if(r.length==1)return pl(v_(r[0],t),t);var n=H5();return r.forEach(function(a,i){W5(n,v_(a,t),"Sheet"+(i+1))}),n}function XK(e,t,r){var n=[];return n.join("")+"<table"+(r&&r.id?' id="'+r.id+'"':"")+">"}function YK(e,t){var r=t||{},n=r.header!=null?r.header:qK,a=r.footer!=null?r.footer:GK,i=[n],s=o0(e["!ref"]);r.dense=Array.isArray(e),i.push(XK(e,s,r));for(var o=s.s.r;o<=s.e.r;++o)i.push(WK(e,s,o,r));return i.push("</table>"+a),i.join("")}function LT(e,t,r){var n=r||{},a=0,i=0;if(n.origin!=null)if(typeof n.origin=="number")a=n.origin;else{var s=typeof n.origin=="string"?ra(n.origin):n.origin;a=s.r,i=s.c}var o=t.getElementsByTagName("tr"),l=Math.min(n.sheetRows||1e7,o.length),c={s:{r:0,c:0},e:{r:a,c:i}};if(e["!ref"]){var u=o0(e["!ref"]);c.s.r=Math.min(c.s.r,u.s.r),c.s.c=Math.min(c.s.c,u.s.c),c.e.r=Math.max(c.e.r,u.e.r),c.e.c=Math.max(c.e.c,u.e.c),a==-1&&(c.e.r=a=u.e.r+1)}var f=[],d=0,h=e["!rows"]||(e["!rows"]=[]),g=0,m=0,_=0,y=0,b=0,w=0;for(e["!cols"]||(e["!cols"]=[]);g<o.length&&m<l;++g){var T=o[g];if(y_(T)){if(n.display)continue;h[m]={hidden:!0}}var F=T.children;for(_=y=0;_<F.length;++_){var I=F[_];if(!(n.display&&y_(I))){var A=I.hasAttribute("data-v")?I.getAttribute("data-v"):I.hasAttribute("v")?I.getAttribute("v"):AA(I.innerHTML),P=I.getAttribute("data-z")||I.getAttribute("z");for(d=0;d<f.length;++d){var j=f[d];j.s.c==y+i&&j.s.r<m+a&&m+a<=j.e.r&&(y=j.e.c+1-i,d=-1)}w=+I.getAttribute("colspan")||1,((b=+I.getAttribute("rowspan")||1)>1||w>1)&&f.push({s:{r:m+a,c:y+i},e:{r:m+a+(b||1)-1,c:y+i+(w||1)-1}});var J={t:"s",v:A},N=I.getAttribute("data-t")||I.getAttribute("t")||"";A!=null&&(A.length==0?J.t=N||"z":n.raw||A.trim().length==0||N=="s"||(A==="TRUE"?J={t:"b",v:!0}:A==="FALSE"?J={t:"b",v:!1}:isNaN($i(A))?isNaN(Yu(A).getDate())||(J={t:"d",v:xn(A)},n.cellDates||(J={t:"n",v:ia(J.v)}),J.z=n.dateNF||Ot[14]):J={t:"n",v:$i(A)})),J.z===void 0&&P!=null&&(J.z=P);var L="",G=I.getElementsByTagName("A");if(G&&G.length)for(var W=0;W<G.length&&!(G[W].hasAttribute("href")&&(L=G[W].getAttribute("href"),L.charAt(0)!="#"));++W);L&&L.charAt(0)!="#"&&(J.l={Target:L}),n.dense?(e[m+a]||(e[m+a]=[]),e[m+a][y+i]=J):e[Nt({c:y+i,r:m+a})]=J,c.e.c<y+i&&(c.e.c=y+i),y+=w}}++m}return f.length&&(e["!merges"]=(e["!merges"]||[]).concat(f)),c.e.r=Math.max(c.e.r,m-1+a),e["!ref"]=$t(c),m>=l&&(e["!fullref"]=$t((c.e.r=o.length-g+m-1+a,c))),e}function FT(e,t){var r=t||{},n=r.dense?[]:{};return LT(n,e,t)}function JK(e,t){return pl(FT(e,t),t)}function y_(e){var t="",r=QK(e);return r&&(t=r(e).getPropertyValue("display")),t||(t=e.style&&e.style.display),t==="none"}function QK(e){return e.ownerDocument.defaultView&&typeof e.ownerDocument.defaultView.getComputedStyle=="function"?e.ownerDocument.defaultView.getComputedStyle:typeof getComputedStyle=="function"?getComputedStyle:null}function ZK(e){var t=e.replace(/[\t\r\n]/g," ").trim().replace(/ +/g," ").replace(/<text:s\/>/g," ").replace(/<text:s text:c="(\d+)"\/>/g,function(n,a){return Array(parseInt(a,10)+1).join(" ")}).replace(/<text:tab[^>]*\/>/g,"	").replace(/<text:line-break\/>/g,`
`),r=Wt(t.replace(/<[^>]*>/g,""));return[r]}var w_={day:["d","dd"],month:["m","mm"],year:["y","yy"],hours:["h","hh"],minutes:["m","mm"],seconds:["s","ss"],"am-pm":["A/P","AM/PM"],"day-of-week":["ddd","dddd"],era:["e","ee"],quarter:["\\Qm",'m\\"th quarter"']};function OT(e,t){var r=t||{},n=T5(e),a=[],i,s,o={name:""},l="",c=0,u,f,d={},h=[],g=r.dense?[]:{},m,_,y={value:""},b="",w=0,T=[],F=-1,I=-1,A={s:{r:1e6,c:1e7},e:{r:0,c:0}},P=0,j={},J=[],N={},L=0,G=0,W=[],le=1,de=1,X=[],ee={Names:[]},R={},pe=["",""],me=[],E={},D="",O=0,M=!1,K=!1,Y=0;for(gh.lastIndex=0,n=n.replace(/<!--([\s\S]*?)-->/mg,"").replace(/<!DOCTYPE[^\[]*\[[^\]]*\]>/gm,"");m=gh.exec(n);)switch(m[3]=m[3].replace(/_.*$/,"")){case"table":case"":m[1]==="/"?(A.e.c>=A.s.c&&A.e.r>=A.s.r?g["!ref"]=$t(A):g["!ref"]="A1:A1",r.sheetRows>0&&r.sheetRows<=A.e.r&&(g["!fullref"]=g["!ref"],A.e.r=r.sheetRows-1,g["!ref"]=$t(A)),J.length&&(g["!merges"]=J),W.length&&(g["!rows"]=W),u.name=u.||u.name,typeof JSON<"u"&&JSON.stringify(u),h.push(u.name),d[u.name]=g,K=!1):m[0].charAt(m[0].length-2)!=="/"&&(u=wt(m[0],!1),F=I=-1,A.s.r=A.s.c=1e7,A.e.r=A.e.c=0,g=r.dense?[]:{},J=[],W=[],K=!0);break;case"table-row-group":m[1]==="/"?--P:++P;break;case"table-row":case"":if(m[1]==="/"){F+=le,le=1;break}if(f=wt(m[0],!1),f.?F=f.-1:F==-1&&(F=0),le=+f["number-rows-repeated"]||1,le<10)for(Y=0;Y<le;++Y)P>0&&(W[F+Y]={level:P});I=-1;break;case"covered-table-cell":m[1]!=="/"&&++I,r.sheetStubs&&(r.dense?(g[F]||(g[F]=[]),g[F][I]={t:"z"}):g[Nt({r:F,c:I})]={t:"z"}),b="",T=[];break;case"table-cell":case"":if(m[0].charAt(m[0].length-2)==="/")++I,y=wt(m[0],!1),de=parseInt(y["number-columns-repeated"]||"1",10),_={t:"z",v:null},y.formula&&r.cellFormula!=!1&&(_.f=p_(Wt(y.formula))),(y.||y["value-type"])=="string"&&(_.t="s",_.v=Wt(y["string-value"]||""),r.dense?(g[F]||(g[F]=[]),g[F][I]=_):g[Nt({r:F,c:I})]=_),I+=de-1;else if(m[1]!=="/"){++I,b="",w=0,T=[],de=1;var re=le?F+le-1:F;if(I>A.e.c&&(A.e.c=I),I<A.s.c&&(A.s.c=I),F<A.s.r&&(A.s.r=F),re>A.e.r&&(A.e.r=re),y=wt(m[0],!1),me=[],E={},_={t:y.||y["value-type"],v:null},r.cellFormula)if(y.formula&&(y.formula=Wt(y.formula)),y["number-matrix-columns-spanned"]&&y["number-matrix-rows-spanned"]&&(L=parseInt(y["number-matrix-rows-spanned"],10)||0,G=parseInt(y["number-matrix-columns-spanned"],10)||0,N={s:{r:F,c:I},e:{r:F+L-1,c:I+G-1}},_.F=$t(N),X.push([N,_.F])),y.formula)_.f=p_(y.formula);else for(Y=0;Y<X.length;++Y)F>=X[Y][0].s.r&&F<=X[Y][0].e.r&&I>=X[Y][0].s.c&&I<=X[Y][0].e.c&&(_.F=X[Y][1]);switch((y["number-columns-spanned"]||y["number-rows-spanned"])&&(L=parseInt(y["number-rows-spanned"],10)||0,G=parseInt(y["number-columns-spanned"],10)||0,N={s:{r:F,c:I},e:{r:F+L-1,c:I+G-1}},J.push(N)),y["number-columns-repeated"]&&(de=parseInt(y["number-columns-repeated"],10)),_.t){case"boolean":_.t="b",_.v=wr(y["boolean-value"]);break;case"float":_.t="n",_.v=parseFloat(y.value);break;case"percentage":_.t="n",_.v=parseFloat(y.value);break;case"currency":_.t="n",_.v=parseFloat(y.value);break;case"date":_.t="d",_.v=xn(y["date-value"]),r.cellDates||(_.t="n",_.v=ia(_.v)),_.z="m/d/yy";break;case"time":_.t="n",_.v=h$(y["time-value"])/86400,r.cellDates&&(_.t="d",_.v=Im(_.v)),_.z="HH:MM:SS";break;case"number":_.t="n",_.v=parseFloat(y.);break;default:if(_.t==="string"||_.t==="text"||!_.t)_.t="s",y["string-value"]!=null&&(b=Wt(y["string-value"]),T=[]);else throw new Error("Unsupported value type "+_.t)}}else{if(M=!1,_.t==="s"&&(_.v=b||"",T.length&&(_.R=T),M=w==0),R.Target&&(_.l=R),me.length>0&&(_.c=me,me=[]),b&&r.cellText!==!1&&(_.w=b),M&&(_.t="z",delete _.v),(!M||r.sheetStubs)&&!(r.sheetRows&&r.sheetRows<=F))for(var se=0;se<le;++se){if(de=parseInt(y["number-columns-repeated"]||"1",10),r.dense)for(g[F+se]||(g[F+se]=[]),g[F+se][I]=se==0?_:Sn(_);--de>0;)g[F+se][I+de]=Sn(_);else for(g[Nt({r:F+se,c:I})]=_;--de>0;)g[Nt({r:F+se,c:I+de})]=Sn(_);A.e.c<=I&&(A.e.c=I)}de=parseInt(y["number-columns-repeated"]||"1",10),I+=de-1,de=0,_={},b="",T=[]}R={};break;case"document":case"document-content":case"":case"spreadsheet":case"":case"scripts":case"styles":case"font-face-decls":case"master-styles":if(m[1]==="/"){if((i=a.pop())[0]!==m[3])throw"Bad state: "+i}else m[0].charAt(m[0].length-2)!=="/"&&a.push([m[3],!0]);break;case"annotation":if(m[1]==="/"){if((i=a.pop())[0]!==m[3])throw"Bad state: "+i;E.t=b,T.length&&(E.R=T),E.a=D,me.push(E)}else m[0].charAt(m[0].length-2)!=="/"&&a.push([m[3],!1]);D="",O=0,b="",w=0,T=[];break;case"creator":m[1]==="/"?D=n.slice(O,m.index):O=m.index+m[0].length;break;case"meta":case"":case"settings":case"config-item-set":case"config-item-map-indexed":case"config-item-map-entry":case"config-item-map-named":case"shapes":case"frame":case"text-box":case"image":case"data-pilot-tables":case"list-style":case"form":case"dde-links":case"event-listeners":case"chart":if(m[1]==="/"){if((i=a.pop())[0]!==m[3])throw"Bad state: "+i}else m[0].charAt(m[0].length-2)!=="/"&&a.push([m[3],!1]);b="",w=0,T=[];break;case"scientific-number":break;case"currency-symbol":break;case"currency-style":break;case"number-style":case"percentage-style":case"date-style":case"time-style":if(m[1]==="/"){if(j[o.name]=l,(i=a.pop())[0]!==m[3])throw"Bad state: "+i}else m[0].charAt(m[0].length-2)!=="/"&&(l="",o=wt(m[0],!1),a.push([m[3],!0]));break;case"script":break;case"libraries":break;case"automatic-styles":break;case"default-style":case"page-layout":break;case"style":break;case"map":break;case"font-face":break;case"paragraph-properties":break;case"table-properties":break;case"table-column-properties":break;case"table-row-properties":break;case"table-cell-properties":break;case"number":switch(a[a.length-1][0]){case"time-style":case"date-style":s=wt(m[0],!1),l+=w_[m[3]][s.style==="long"?1:0];break}break;case"fraction":break;case"day":case"month":case"year":case"era":case"day-of-week":case"week-of-year":case"quarter":case"hours":case"minutes":case"seconds":case"am-pm":switch(a[a.length-1][0]){case"time-style":case"date-style":s=wt(m[0],!1),l+=w_[m[3]][s.style==="long"?1:0];break}break;case"boolean-style":break;case"boolean":break;case"text-style":break;case"text":if(m[0].slice(-2)==="/>")break;if(m[1]==="/")switch(a[a.length-1][0]){case"number-style":case"date-style":case"time-style":l+=n.slice(c,m.index);break}else c=m.index+m[0].length;break;case"named-range":s=wt(m[0],!1),pe=k2(s["cell-range-address"]);var xe={Name:s.name,Ref:pe[0]+"!"+pe[1]};K&&(xe.Sheet=h.length),ee.Names.push(xe);break;case"text-content":break;case"text-properties":break;case"embedded-text":break;case"body":case"":break;case"forms":break;case"table-column":break;case"table-header-rows":break;case"table-rows":break;case"table-column-group":break;case"table-header-columns":break;case"table-columns":break;case"null-date":break;case"graphic-properties":break;case"calculation-settings":break;case"named-expressions":break;case"label-range":break;case"label-ranges":break;case"named-expression":break;case"sort":break;case"sort-by":break;case"sort-groups":break;case"tab":break;case"line-break":break;case"span":break;case"p":case"":if(["master-styles"].indexOf(a[a.length-1][0])>-1)break;if(m[1]==="/"&&(!y||!y["string-value"])){var Ce=ZK(n.slice(w,m.index));b=(b.length>0?b+`
`:"")+Ce[0]}else wt(m[0],!1),w=m.index+m[0].length;break;case"s":break;case"database-range":if(m[1]==="/")break;try{pe=k2(wt(m[0])["target-range-address"]),d[pe[0]]["!autofilter"]={ref:pe[1]}}catch{}break;case"date":break;case"object":break;case"title":case"":break;case"desc":break;case"binary-data":break;case"table-source":break;case"scenario":break;case"iteration":break;case"content-validations":break;case"content-validation":break;case"help-message":break;case"error-message":break;case"database-ranges":break;case"filter":break;case"filter-and":break;case"filter-or":break;case"filter-condition":break;case"list-level-style-bullet":break;case"list-level-style-number":break;case"list-level-properties":break;case"sender-firstname":case"sender-lastname":case"sender-initials":case"sender-title":case"sender-position":case"sender-email":case"sender-phone-private":case"sender-fax":case"sender-company":case"sender-phone-work":case"sender-street":case"sender-city":case"sender-postal-code":case"sender-country":case"sender-state-or-province":case"author-name":case"author-initials":case"chapter":case"file-name":case"template-name":case"sheet-name":break;case"event-listener":break;case"initial-creator":case"creation-date":case"print-date":case"generator":case"document-statistic":case"user-defined":case"editing-duration":case"editing-cycles":break;case"config-item":break;case"page-number":break;case"page-count":break;case"time":break;case"cell-range-source":break;case"detective":break;case"operation":break;case"highlighted-range":break;case"data-pilot-table":case"source-cell-range":case"source-service":case"data-pilot-field":case"data-pilot-level":case"data-pilot-subtotals":case"data-pilot-subtotal":case"data-pilot-members":case"data-pilot-member":case"data-pilot-display-info":case"data-pilot-sort-info":case"data-pilot-layout-info":case"data-pilot-field-reference":case"data-pilot-groups":case"data-pilot-group":case"data-pilot-group-member":break;case"rect":break;case"dde-connection-decls":case"dde-connection-decl":case"dde-link":case"dde-source":break;case"properties":break;case"property":break;case"a":if(m[1]!=="/"){if(R=wt(m[0],!1),!R.href)break;R.Target=Wt(R.href),delete R.href,R.Target.charAt(0)=="#"&&R.Target.indexOf(".")>-1?(pe=k2(R.Target.slice(1)),R.Target="#"+pe[0]+"!"+pe[1]):R.Target.match(/^\.\.[\\\/]/)&&(R.Target=R.Target.slice(3))}break;case"table-protection":break;case"data-pilot-grand-total":break;case"office-document-common-attrs":break;default:switch(m[2]){case"dc:":case"calcext:":case"loext:":case"ooo:":case"chartooo:":case"draw:":case"style:":case"chart:":case"form:":case"uof:":case":":case":":break;default:if(r.WTF)throw new Error(m)}}var Z={Sheets:d,SheetNames:h,Workbook:ee};return r.bookSheets&&delete Z.Sheets,Z}function b_(e,t){t=t||{},ri(e,"META-INF/manifest.xml")&&mV(Yr(e,"META-INF/manifest.xml"),t);var r=Oa(e,"content.xml");if(!r)throw new Error("Missing content.xml in ODS / UOF file");var n=OT(mr(r),t);return ri(e,"meta.xml")&&(n.Props=qA(Yr(e,"meta.xml"))),n}function __(e,t){return OT(e,t)}/*! sheetjs (C) 2013-present SheetJS -- http://sheetjs.com */function U5(e){return new DataView(e.buffer,e.byteOffset,e.byteLength)}function wv(e){return typeof TextDecoder<"u"?new TextDecoder().decode(e):mr(mc(e))}function bv(e){var t=e.reduce(function(a,i){return a+i.length},0),r=new Uint8Array(t),n=0;return e.forEach(function(a){r.set(a,n),n+=a.length}),r}function S_(e){return e-=e>>1&1431655765,e=(e&858993459)+(e>>2&858993459),(e+(e>>4)&252645135)*16843009>>>24}function eX(e,t){for(var r=(e[t+15]&127)<<7|e[t+14]>>1,n=e[t+14]&1,a=t+13;a>=t;--a)n=n*256+e[a];return(e[t+15]&128?-n:n)*Math.pow(10,r-6176)}function wh(e,t){var r=t?t[0]:0,n=e[r]&127;e:if(e[r++]>=128&&(n|=(e[r]&127)<<7,e[r++]<128||(n|=(e[r]&127)<<14,e[r++]<128)||(n|=(e[r]&127)<<21,e[r++]<128)||(n+=(e[r]&127)*Math.pow(2,28),++r,e[r++]<128)||(n+=(e[r]&127)*Math.pow(2,35),++r,e[r++]<128)||(n+=(e[r]&127)*Math.pow(2,42),++r,e[r++]<128)))break e;return t&&(t[0]=r),n}function ln(e){var t=0,r=e[t]&127;e:if(e[t++]>=128){if(r|=(e[t]&127)<<7,e[t++]<128||(r|=(e[t]&127)<<14,e[t++]<128)||(r|=(e[t]&127)<<21,e[t++]<128))break e;r|=(e[t]&127)<<28}return r}function zn(e){for(var t=[],r=[0];r[0]<e.length;){var n=r[0],a=wh(e,r),i=a&7;a=Math.floor(a/8);var s=0,o;if(a==0)break;switch(i){case 0:{for(var l=r[0];e[r[0]++]>=128;);o=e.slice(l,r[0])}break;case 5:s=4,o=e.slice(r[0],r[0]+s),r[0]+=s;break;case 1:s=8,o=e.slice(r[0],r[0]+s),r[0]+=s;break;case 2:s=wh(e,r),o=e.slice(r[0],r[0]+s),r[0]+=s;break;case 3:case 4:default:throw new Error("PB Type ".concat(i," for Field ").concat(a," at offset ").concat(n))}var c={data:o,type:i};t[a]==null?t[a]=[c]:t[a].push(c)}return t}function $5(e,t){return(e==null?void 0:e.map(function(r){return t(r.data)}))||[]}function tX(e){for(var t,r=[],n=[0];n[0]<e.length;){var a=wh(e,n),i=zn(e.slice(n[0],n[0]+a));n[0]+=a;var s={id:ln(i[1][0].data),messages:[]};i[2].forEach(function(o){var l=zn(o.data),c=ln(l[3][0].data);s.messages.push({meta:l,data:e.slice(n[0],n[0]+c)}),n[0]+=c}),(t=i[3])!=null&&t[0]&&(s.merge=ln(i[3][0].data)>>>0>0),r.push(s)}return r}function rX(e,t){if(e!=0)throw new Error("Unexpected Snappy chunk type ".concat(e));for(var r=[0],n=wh(t,r),a=[];r[0]<t.length;){var i=t[r[0]]&3;if(i==0){var s=t[r[0]++]>>2;if(s<60)++s;else{var o=s-59;s=t[r[0]],o>1&&(s|=t[r[0]+1]<<8),o>2&&(s|=t[r[0]+2]<<16),o>3&&(s|=t[r[0]+3]<<24),s>>>=0,s++,r[0]+=o}a.push(t.slice(r[0],r[0]+s)),r[0]+=s;continue}else{var l=0,c=0;if(i==1?(c=(t[r[0]]>>2&7)+4,l=(t[r[0]++]&224)<<3,l|=t[r[0]++]):(c=(t[r[0]++]>>2)+1,i==2?(l=t[r[0]]|t[r[0]+1]<<8,r[0]+=2):(l=(t[r[0]]|t[r[0]+1]<<8|t[r[0]+2]<<16|t[r[0]+3]<<24)>>>0,r[0]+=4)),a=[bv(a)],l==0)throw new Error("Invalid offset 0");if(l>a[0].length)throw new Error("Invalid offset beyond length");if(c>=l)for(a.push(a[0].slice(-l)),c-=l;c>=a[a.length-1].length;)a.push(a[a.length-1]),c-=a[a.length-1].length;a.push(a[0].slice(-l,-l+c))}}var u=bv(a);if(u.length!=n)throw new Error("Unexpected length: ".concat(u.length," != ").concat(n));return u}function nX(e){for(var t=[],r=0;r<e.length;){var n=e[r++],a=e[r]|e[r+1]<<8|e[r+2]<<16;r+=3,t.push(rX(n,e.slice(r,r+a))),r+=a}if(r!==e.length)throw new Error("data is not a valid framed stream!");return bv(t)}function aX(e,t,r,n){var a=U5(e),i=a.getUint32(4,!0),s=(n>1?12:8)+S_(i&(n>1?3470:398))*4,o=-1,l=-1,c=NaN,u=new Date(2001,0,1);i&512&&(o=a.getUint32(s,!0),s+=4),s+=S_(i&(n>1?12288:4096))*4,i&16&&(l=a.getUint32(s,!0),s+=4),i&32&&(c=a.getFloat64(s,!0),s+=8),i&64&&(u.setTime(u.getTime()+a.getFloat64(s,!0)*1e3),s+=8);var f;switch(e[2]){case 0:break;case 2:f={t:"n",v:c};break;case 3:f={t:"s",v:t[l]};break;case 5:f={t:"d",v:u};break;case 6:f={t:"b",v:c>0};break;case 7:f={t:"n",v:c/86400};break;case 8:f={t:"e",v:0};break;case 9:if(o>-1)f={t:"s",v:r[o]};else if(l>-1)f={t:"s",v:t[l]};else if(!isNaN(c))f={t:"n",v:c};else throw new Error("Unsupported cell type ".concat(e.slice(0,4)));break;default:throw new Error("Unsupported cell type ".concat(e.slice(0,4)))}return f}function iX(e,t,r){var n=U5(e),a=n.getUint32(8,!0),i=12,s=-1,o=-1,l=NaN,c=NaN,u=new Date(2001,0,1);a&1&&(l=eX(e,i),i+=16),a&2&&(c=n.getFloat64(i,!0),i+=8),a&4&&(u.setTime(u.getTime()+n.getFloat64(i,!0)*1e3),i+=8),a&8&&(o=n.getUint32(i,!0),i+=4),a&16&&(s=n.getUint32(i,!0),i+=4);var f;switch(e[1]){case 0:break;case 2:f={t:"n",v:l};break;case 3:f={t:"s",v:t[o]};break;case 5:f={t:"d",v:u};break;case 6:f={t:"b",v:c>0};break;case 7:f={t:"n",v:c/86400};break;case 8:f={t:"e",v:0};break;case 9:if(s>-1)f={t:"s",v:r[s]};else throw new Error("Unsupported cell type ".concat(e[1]," : ").concat(a&31," : ").concat(e.slice(0,4)));break;case 10:f={t:"n",v:l};break;default:throw new Error("Unsupported cell type ".concat(e[1]," : ").concat(a&31," : ").concat(e.slice(0,4)))}return f}function sX(e,t,r){switch(e[0]){case 0:case 1:case 2:case 3:return aX(e,t,r,e[0]);case 5:return iX(e,t,r);default:throw new Error("Unsupported payload version ".concat(e[0]))}}function Qo(e){var t=zn(e);return wh(t[1][0].data)}function k_(e,t){var r=zn(t.data),n=ln(r[1][0].data),a=r[3],i=[];return(a||[]).forEach(function(s){var o=zn(s.data),l=ln(o[1][0].data)>>>0;switch(n){case 1:i[l]=wv(o[3][0].data);break;case 8:{var c=e[Qo(o[9][0].data)][0],u=zn(c.data),f=e[Qo(u[1][0].data)][0],d=ln(f.meta[1][0].data);if(d!=2001)throw new Error("2000 unexpected reference to ".concat(d));var h=zn(f.data);i[l]=h[3].map(function(g){return wv(g.data)}).join("")}break}}),i}function oX(e,t){var r,n,a,i,s,o,l,c,u,f,d,h,g,m,_=zn(e),y=ln(_[1][0].data)>>>0,b=ln(_[2][0].data)>>>0,w=((n=(r=_[8])==null?void 0:r[0])==null?void 0:n.data)&&ln(_[8][0].data)>0||!1,T,F;if((i=(a=_[7])==null?void 0:a[0])!=null&&i.data&&t!=0)T=(o=(s=_[7])==null?void 0:s[0])==null?void 0:o.data,F=(c=(l=_[6])==null?void 0:l[0])==null?void 0:c.data;else if((f=(u=_[4])==null?void 0:u[0])!=null&&f.data&&t!=1)T=(h=(d=_[4])==null?void 0:d[0])==null?void 0:h.data,F=(m=(g=_[3])==null?void 0:g[0])==null?void 0:m.data;else throw"NUMBERS Tile missing ".concat(t," cell storage");for(var I=w?4:1,A=U5(T),P=[],j=0;j<T.length/2;++j){var J=A.getUint16(j*2,!0);J<65535&&P.push([j,J])}if(P.length!=b)throw"Expected ".concat(b," cells, found ").concat(P.length);var N=[];for(j=0;j<P.length-1;++j)N[P[j][0]]=F.subarray(P[j][1]*I,P[j+1][1]*I);return P.length>=1&&(N[P[P.length-1][0]]=F.subarray(P[P.length-1][1]*I)),{R:y,cells:N}}function lX(e,t){var r,n=zn(t.data),a=(r=n==null?void 0:n[7])!=null&&r[0]?ln(n[7][0].data)>>>0>0?1:0:-1,i=$5(n[5],function(s){return oX(s,a)});return{nrows:ln(n[4][0].data)>>>0,data:i.reduce(function(s,o){return s[o.R]||(s[o.R]=[]),o.cells.forEach(function(l,c){if(s[o.R][c])throw new Error("Duplicate cell r=".concat(o.R," c=").concat(c));s[o.R][c]=l}),s},[])}}function cX(e,t,r){var n,a=zn(t.data),i={s:{r:0,c:0},e:{r:0,c:0}};if(i.e.r=(ln(a[6][0].data)>>>0)-1,i.e.r<0)throw new Error("Invalid row varint ".concat(a[6][0].data));if(i.e.c=(ln(a[7][0].data)>>>0)-1,i.e.c<0)throw new Error("Invalid col varint ".concat(a[7][0].data));r["!ref"]=$t(i);var s=zn(a[4][0].data),o=k_(e,e[Qo(s[4][0].data)][0]),l=(n=s[17])!=null&&n[0]?k_(e,e[Qo(s[17][0].data)][0]):[],c=zn(s[3][0].data),u=0;c[1].forEach(function(f){var d=zn(f.data),h=e[Qo(d[2][0].data)][0],g=ln(h.meta[1][0].data);if(g!=6002)throw new Error("6001 unexpected reference to ".concat(g));var m=lX(e,h);m.data.forEach(function(_,y){_.forEach(function(b,w){var T=Nt({r:u+y,c:w}),F=sX(b,o,l);F&&(r[T]=F)})}),u+=m.nrows})}function uX(e,t){var r=zn(t.data),n={"!ref":"A1"},a=e[Qo(r[2][0].data)],i=ln(a[0].meta[1][0].data);if(i!=6001)throw new Error("6000 unexpected reference to ".concat(i));return cX(e,a[0],n),n}function fX(e,t){var r,n=zn(t.data),a={name:(r=n[1])!=null&&r[0]?wv(n[1][0].data):"",sheets:[]},i=$5(n[2],Qo);return i.forEach(function(s){e[s].forEach(function(o){var l=ln(o.meta[1][0].data);l==6e3&&a.sheets.push(uX(e,o))})}),a}function hX(e,t){var r=H5(),n=zn(t.data),a=$5(n[1],Qo);if(a.forEach(function(i){e[i].forEach(function(s){var o=ln(s.meta[1][0].data);if(o==2){var l=fX(e,s);l.sheets.forEach(function(c,u){W5(r,c,u==0?l.name:l.name+"_"+u,!0)})}})}),r.SheetNames.length==0)throw new Error("Empty NUMBERS file");return r}function A2(e){var t,r,n,a,i={},s=[];if(e.FullPaths.forEach(function(l){if(l.match(/\.iwpv2/))throw new Error("Unsupported password protection")}),e.FileIndex.forEach(function(l){if(l.name.match(/\.iwa$/)){var c;try{c=nX(l.content)}catch(f){return console.log("?? "+l.content.length+" "+(f.message||f))}var u;try{u=tX(c)}catch(f){return console.log("## "+(f.message||f))}u.forEach(function(f){i[f.id]=f.messages,s.push(f.id)})}}),!s.length)throw new Error("File has no messages");var o=((a=(n=(r=(t=i==null?void 0:i[1])==null?void 0:t[0])==null?void 0:r.meta)==null?void 0:n[1])==null?void 0:a[0].data)&&ln(i[1][0].meta[1][0].data)==1&&i[1][0];if(o||s.forEach(function(l){i[l].forEach(function(c){var u=ln(c.meta[1][0].data)>>>0;if(u==1)if(!o)o=c;else throw new Error("Document has multiple roots")})}),!o)throw new Error("Cannot find Document root");return hX(i,o)}function dX(e){return function(r){for(var n=0;n!=e.length;++n){var a=e[n];r[a[0]]===void 0&&(r[a[0]]=a[1]),a[2]==="n"&&(r[a[0]]=Number(r[a[0]]))}}}function V5(e){dX([["cellNF",!1],["cellHTML",!0],["cellFormula",!0],["cellStyles",!1],["cellText",!0],["cellDates",!1],["sheetStubs",!1],["sheetRows",0,"n"],["bookDeps",!1],["bookSheets",!1],["bookProps",!1],["bookFiles",!1],["bookVBA",!1],["password",""],["WTF",!1]])(e)}function pX(e){return wu.WS.indexOf(e)>-1?"sheet":e==wu.CS?"chart":e==wu.DS?"dialog":e==wu.MS?"macro":e&&e.length?e:"sheet"}function mX(e,t){if(!e)return 0;try{e=t.map(function(n){return n.id||(n.id=n.strRelID),[n.name,e["!id"][n.id].Target,pX(e["!id"][n.id].Type)]})}catch{return null}return!e||e.length===0?null:e}function gX(e,t,r,n,a,i,s,o,l,c,u,f){try{i[n]=Ff(Oa(e,r,!0),t);var d=Yr(e,t),h;switch(o){case"sheet":h=_K(d,t,a,l,i[n],c,u,f);break;case"chart":if(h=SK(d,t,a,l,i[n],c,u,f),!h||!h["!drawel"])break;var g=of(h["!drawel"].Target,t),m=mv(g),_=bW(Oa(e,g,!0),Ff(Oa(e,m,!0),g)),y=of(_,g),b=mv(y);h=iK(Oa(e,y,!0),y,l,Ff(Oa(e,b,!0),y),c,h);break;case"macro":h=kK(d,t,a,l,i[n],c,u,f);break;case"dialog":h=EK(d,t,a,l,i[n],c,u,f);break;default:throw new Error("Unrecognized sheet type "+o)}s[n]=h;var w=[];i&&i[n]&&ds(i[n]).forEach(function(T){var F="";if(i[n][T].Type==wu.CMNT){F=of(i[n][T].Target,t);var I=NK(Yr(e,F,!0),F,l);if(!I||!I.length)return;c_(h,I,!1)}i[n][T].Type==wu.TCMNT&&(F=of(i[n][T].Target,t),w=w.concat(SW(Yr(e,F,!0),l)))}),w&&w.length&&c_(h,w,!0,l.people||[])}catch(T){if(l.WTF)throw T}}function Za(e){return e.charAt(0)=="/"?e.slice(1):e}function xX(e,t){if(xA(),t=t||{},V5(t),ri(e,"META-INF/manifest.xml")||ri(e,"objectdata.xml"))return b_(e,t);if(ri(e,"Index/Document.iwa")){if(typeof Uint8Array>"u")throw new Error("NUMBERS file parsing requires Uint8Array support");if(typeof A2<"u"){if(e.FileIndex)return A2(e);var r=Ut.utils.cfb_new();return j3(e).forEach(function(W){v$(r,W,x$(e,W))}),A2(r)}throw new Error("Unsupported NUMBERS file")}if(!ri(e,"[Content_Types].xml"))throw ri(e,"index.xml.gz")?new Error("Unsupported NUMBERS 08 file"):ri(e,"index.xml")?new Error("Unsupported NUMBERS 09 file"):new Error("Unsupported ZIP file");var n=j3(e),a=dV(Oa(e,"[Content_Types].xml")),i=!1,s,o;if(a.workbooks.length===0&&(o="xl/workbook.xml",Yr(e,o,!0)&&a.workbooks.push(o)),a.workbooks.length===0){if(o="xl/workbook.bin",!Yr(e,o,!0))throw new Error("Could not find workbook");a.workbooks.push(o),i=!0}a.workbooks[0].slice(-3)=="bin"&&(i=!0);var l={},c={};if(!t.bookSheets&&!t.bookProps){if(Df=[],a.sst)try{Df=CK(Yr(e,Za(a.sst)),a.sst,t)}catch(W){if(t.WTF)throw W}t.cellStyles&&a.themes.length&&(l=TK(Oa(e,a.themes[0].replace(/^\//,""),!0)||"",a.themes[0],t)),a.style&&(c=AK(Yr(e,Za(a.style)),a.style,l,t))}a.links.map(function(W){try{var le=Ff(Oa(e,mv(Za(W))),W);return LK(Yr(e,Za(W)),le,W,t)}catch{}});var u=bK(Yr(e,Za(a.workbooks[0])),a.workbooks[0],t),f={},d="";a.coreprops.length&&(d=Yr(e,Za(a.coreprops[0]),!0),d&&(f=qA(d)),a.extprops.length!==0&&(d=Yr(e,Za(a.extprops[0]),!0),d&&vV(d,f,t)));var h={};(!t.bookSheets||t.bookProps)&&a.custprops.length!==0&&(d=Oa(e,Za(a.custprops[0]),!0),d&&(h=wV(d,t)));var g={};if((t.bookSheets||t.bookProps)&&(u.Sheets?s=u.Sheets.map(function(le){return le.name}):f.Worksheets&&f.SheetNames.length>0&&(s=f.SheetNames),t.bookProps&&(g.Props=f,g.Custprops=h),t.bookSheets&&typeof s<"u"&&(g.SheetNames=s),t.bookSheets?g.SheetNames:t.bookProps))return g;s={};var m={};t.bookDeps&&a.calcchain&&(m=PK(Yr(e,Za(a.calcchain)),a.calcchain));var _=0,y={},b,w;{var T=u.Sheets;f.Worksheets=T.length,f.SheetNames=[];for(var F=0;F!=T.length;++F)f.SheetNames[F]=T[F].name}var I=i?"bin":"xml",A=a.workbooks[0].lastIndexOf("/"),P=(a.workbooks[0].slice(0,A+1)+"_rels/"+a.workbooks[0].slice(A+1)+".rels").replace(/^\//,"");ri(e,P)||(P="xl/_rels/workbook."+I+".rels");var j=Ff(Oa(e,P,!0),P.replace(/_rels.*/,"s5s"));(a.metadata||[]).length>=1&&(t.xlmeta=FK(Yr(e,Za(a.metadata[0])),a.metadata[0],t)),(a.people||[]).length>=1&&(t.people=kW(Yr(e,Za(a.people[0])),t)),j&&(j=mX(j,u.Sheets));var J=Yr(e,"xl/worksheets/sheet.xml",!0)?1:0;e:for(_=0;_!=f.Worksheets;++_){var N="sheet";if(j&&j[_]?(b="xl/"+j[_][1].replace(/[\/]?xl\//,""),ri(e,b)||(b=j[_][1]),ri(e,b)||(b=P.replace(/_rels\/.*$/,"")+j[_][1]),N=j[_][2]):(b="xl/worksheets/sheet"+(_+1-J)+"."+I,b=b.replace(/sheet0\./,"sheet.")),w=b.replace(/^(.*)(\/)([^\/]*)$/,"$1/_rels/$3.rels"),t&&t.sheets!=null)switch(typeof t.sheets){case"number":if(_!=t.sheets)continue e;break;case"string":if(f.SheetNames[_].toLowerCase()!=t.sheets.toLowerCase())continue e;break;default:if(Array.isArray&&Array.isArray(t.sheets)){for(var L=!1,G=0;G!=t.sheets.length;++G)typeof t.sheets[G]=="number"&&t.sheets[G]==_&&(L=1),typeof t.sheets[G]=="string"&&t.sheets[G].toLowerCase()==f.SheetNames[_].toLowerCase()&&(L=1);if(!L)continue e}}gX(e,b,w,f.SheetNames[_],_,y,s,N,t,u,l,c)}return g={Directory:a,Workbook:u,Props:f,Custprops:h,Deps:m,Sheets:s,SheetNames:f.SheetNames,Strings:Df,Styles:c,Themes:l,SSF:Sn(Ot)},t&&t.bookFiles&&(e.files?(g.keys=n,g.files=e.files):(g.keys=[],g.files={},e.FullPaths.forEach(function(W,le){W=W.replace(/^Root Entry[\/]/,""),g.keys.push(W),g.files[W]=e.FileIndex[le]}))),t&&t.bookVBA&&(a.vba.length>0?g.vbaraw=Yr(e,Za(a.vba[0]),!0):a.defaults&&a.defaults.bin===CW&&(g.vbaraw=Yr(e,"xl/vbaProject.bin",!0))),g}function vX(e,t){var r=t||{},n="Workbook",a=Ut.find(e,n);try{if(n="/!DataSpaces/Version",a=Ut.find(e,n),!a||!a.content)throw new Error("ECMA-376 Encrypted file missing "+n);if(uH(a.content),n="/!DataSpaces/DataSpaceMap",a=Ut.find(e,n),!a||!a.content)throw new Error("ECMA-376 Encrypted file missing "+n);var i=hH(a.content);if(i.length!==1||i[0].comps.length!==1||i[0].comps[0].t!==0||i[0].name!=="StrongEncryptionDataSpace"||i[0].comps[0].v!=="EncryptedPackage")throw new Error("ECMA-376 Encrypted file bad "+n);if(n="/!DataSpaces/DataSpaceInfo/StrongEncryptionDataSpace",a=Ut.find(e,n),!a||!a.content)throw new Error("ECMA-376 Encrypted file missing "+n);var s=dH(a.content);if(s.length!=1||s[0]!="StrongEncryptionTransform")throw new Error("ECMA-376 Encrypted file bad "+n);if(n="/!DataSpaces/TransformInfo/StrongEncryptionTransform/!Primary",a=Ut.find(e,n),!a||!a.content)throw new Error("ECMA-376 Encrypted file missing "+n);mH(a.content)}catch{}if(n="/EncryptionInfo",a=Ut.find(e,n),!a||!a.content)throw new Error("ECMA-376 Encrypted file missing "+n);var o=gH(a.content);if(n="/EncryptedPackage",a=Ut.find(e,n),!a||!a.content)throw new Error("ECMA-376 Encrypted file missing "+n);if(o[0]==4&&typeof decrypt_agile<"u")return decrypt_agile(o[1],a.content,r.password||"",r);if(o[0]==2&&typeof decrypt_std76<"u")return decrypt_std76(o[1],a.content,r.password||"",r);throw new Error("File is password-protected")}function z5(e,t){var r="";switch((t||{}).type||"base64"){case"buffer":return[e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7]];case"base64":r=Ba(e.slice(0,12));break;case"binary":r=e;break;case"array":return[e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7]];default:throw new Error("Unrecognized type "+(t&&t.type||"undefined"))}return[r.charCodeAt(0),r.charCodeAt(1),r.charCodeAt(2),r.charCodeAt(3),r.charCodeAt(4),r.charCodeAt(5),r.charCodeAt(6),r.charCodeAt(7)]}function yX(e,t){return Ut.find(e,"EncryptedPackage")?vX(e,t):PT(e,t)}function wX(e,t){var r,n=e,a=t||{};return a.type||(a.type=Mt&&Buffer.isBuffer(e)?"buffer":"base64"),r=SA(n,a),xX(r,a)}function IT(e,t){var r=0;e:for(;r<e.length;)switch(e.charCodeAt(r)){case 10:case 13:case 32:++r;break;case 60:return vv(e.slice(r),t);default:break e}return xh.to_workbook(e,t)}function bX(e,t){var r="",n=z5(e,t);switch(t.type){case"base64":r=Ba(e);break;case"binary":r=e;break;case"buffer":r=e.toString("binary");break;case"array":r=ic(e);break;default:throw new Error("Unrecognized type "+t.type)}return n[0]==239&&n[1]==187&&n[2]==191&&(r=mr(r)),t.type="binary",IT(r,t)}function _X(e,t){var r=e;return t.type=="base64"&&(r=Ba(r)),r=Do.utils.decode(1200,r.slice(2),"str"),t.type="binary",IT(r,t)}function SX(e){return e.match(/[^\x00-\x7F]/)?lf(e):e}function T2(e,t,r,n){return n?(r.type="string",xh.to_workbook(e,r)):xh.to_workbook(t,r)}function _v(e,t){iA();var r=t||{};if(typeof ArrayBuffer<"u"&&e instanceof ArrayBuffer)return _v(new Uint8Array(e),(r=Sn(r),r.type="array",r));typeof Uint8Array<"u"&&e instanceof Uint8Array&&!r.type&&(r.type=typeof Deno<"u"?"buffer":"array");var n=e,a=[0,0,0,0],i=!1;if(r.cellStyles&&(r.cellNF=!0,r.sheetStubs=!0),Lu={},r.dateNF&&(Lu.dateNF=r.dateNF),r.type||(r.type=Mt&&Buffer.isBuffer(e)?"buffer":"base64"),r.type=="file"&&(r.type=Mt?"buffer":"binary",n=u$(e),typeof Uint8Array<"u"&&!Mt&&(r.type="array")),r.type=="string"&&(i=!0,r.type="binary",r.codepage=65001,n=SX(e)),r.type=="array"&&typeof Uint8Array<"u"&&e instanceof Uint8Array&&typeof ArrayBuffer<"u"){var s=new ArrayBuffer(3),o=new Uint8Array(s);if(o.foo="bar",!o.foo)return r=Sn(r),r.type="array",_v(b5(n),r)}switch((a=z5(n,r))[0]){case 208:if(a[1]===207&&a[2]===17&&a[3]===224&&a[4]===161&&a[5]===177&&a[6]===26&&a[7]===225)return yX(Ut.read(n,r),r);break;case 9:if(a[1]<=8)return PT(n,r);break;case 60:return vv(n,r);case 73:if(a[1]===73&&a[2]===42&&a[3]===0)throw new Error("TIFF Image File is not a spreadsheet");if(a[1]===68)return Jz(n,r);break;case 84:if(a[1]===65&&a[2]===66&&a[3]===76)return Xz.to_workbook(n,r);break;case 80:return a[1]===75&&a[2]<9&&a[3]<9?wX(n,r):T2(e,n,r,i);case 239:return a[3]===60?vv(n,r):T2(e,n,r,i);case 255:if(a[1]===254)return _X(n,r);if(a[1]===0&&a[2]===2&&a[3]===0)return If.to_workbook(n,r);break;case 0:if(a[1]===0&&(a[2]>=2&&a[3]===0||a[2]===0&&(a[3]===8||a[3]===9)))return If.to_workbook(n,r);break;case 3:case 131:case 139:case 140:return l_.to_workbook(n,r);case 123:if(a[1]===92&&a[2]===114&&a[3]===116)return CH.to_workbook(n,r);break;case 10:case 13:case 32:return bX(n,r);case 137:if(a[1]===80&&a[2]===78&&a[3]===71)throw new Error("PNG Image File is not a spreadsheet");break}return Gz.indexOf(a[0])>-1&&a[2]<=12&&a[3]<=31?l_.to_workbook(n,r):T2(e,n,r,i)}function kX(e,t,r,n,a,i,s,o){var l=kn(r),c=o.defval,u=o.raw||!Object.prototype.hasOwnProperty.call(o,"raw"),f=!0,d=a===1?[]:{};if(a!==1)if(Object.defineProperty)try{Object.defineProperty(d,"__rowNum__",{value:r,enumerable:!1})}catch{d.__rowNum__=r}else d.__rowNum__=r;if(!s||e[r])for(var h=t.s.c;h<=t.e.c;++h){var g=s?e[r][h]:e[n[h]+l];if(g===void 0||g.t===void 0){if(c===void 0)continue;i[h]!=null&&(d[i[h]]=c);continue}var m=g.v;switch(g.t){case"z":if(m==null)break;continue;case"e":m=m==0?null:void 0;break;case"s":case"d":case"b":case"n":break;default:throw new Error("unrecognized type "+g.t)}if(i[h]!=null){if(m==null)if(g.t=="e"&&m===null)d[i[h]]=null;else if(c!==void 0)d[i[h]]=c;else if(u&&m===null)d[i[h]]=null;else continue;else d[i[h]]=u&&(g.t!=="n"||g.t==="n"&&o.rawNumbers!==!1)?m:eo(g,m,o);m!=null&&(f=!1)}}return{row:d,isempty:f}}function Sv(e,t){if(e==null||e["!ref"]==null)return[];var r={t:"n",v:0},n=0,a=1,i=[],s=0,o="",l={s:{r:0,c:0},e:{r:0,c:0}},c=t||{},u=c.range!=null?c.range:e["!ref"];switch(c.header===1?n=1:c.header==="A"?n=2:Array.isArray(c.header)?n=3:c.header==null&&(n=0),typeof u){case"string":l=Or(u);break;case"number":l=Or(e["!ref"]),l.s.r=u;break;default:l=u}n>0&&(a=0);var f=kn(l.s.r),d=[],h=[],g=0,m=0,_=Array.isArray(e),y=l.s.r,b=0,w={};_&&!e[y]&&(e[y]=[]);var T=c.skipHidden&&e["!cols"]||[],F=c.skipHidden&&e["!rows"]||[];for(b=l.s.c;b<=l.e.c;++b)if(!(T[b]||{}).hidden)switch(d[b]=sn(b),r=_?e[y][b]:e[d[b]+f],n){case 1:i[b]=b-l.s.c;break;case 2:i[b]=d[b];break;case 3:i[b]=c.header[b-l.s.c];break;default:if(r==null&&(r={w:"__EMPTY",t:"s"}),o=s=eo(r,null,c),m=w[s]||0,!m)w[s]=1;else{do o=s+"_"+m++;while(w[o]);w[s]=m,w[o]=1}i[b]=o}for(y=l.s.r+a;y<=l.e.r;++y)if(!(F[y]||{}).hidden){var I=kX(e,l,y,d,n,i,_,c);(I.isempty===!1||(n===1?c.blankrows!==!1:c.blankrows))&&(h[g++]=I.row)}return h.length=g,h}var E_=/"/g;function EX(e,t,r,n,a,i,s,o){for(var l=!0,c=[],u="",f=kn(r),d=t.s.c;d<=t.e.c;++d)if(n[d]){var h=o.dense?(e[r]||[])[d]:e[n[d]+f];if(h==null)u="";else if(h.v!=null){l=!1,u=""+(o.rawNumbers&&h.t=="n"?h.v:eo(h,null,o));for(var g=0,m=0;g!==u.length;++g)if((m=u.charCodeAt(g))===a||m===i||m===34||o.forceQuotes){u='"'+u.replace(E_,'""')+'"';break}u=="ID"&&(u='"ID"')}else h.f!=null&&!h.F?(l=!1,u="="+h.f,u.indexOf(",")>=0&&(u='"'+u.replace(E_,'""')+'"')):u="";c.push(u)}return o.blankrows===!1&&l?null:c.join(s)}function DT(e,t){var r=[],n=t??{};if(e==null||e["!ref"]==null)return"";var a=Or(e["!ref"]),i=n.FS!==void 0?n.FS:",",s=i.charCodeAt(0),o=n.RS!==void 0?n.RS:`
`,l=o.charCodeAt(0),c=new RegExp((i=="|"?"\\|":i)+"+$"),u="",f=[];n.dense=Array.isArray(e);for(var d=n.skipHidden&&e["!cols"]||[],h=n.skipHidden&&e["!rows"]||[],g=a.s.c;g<=a.e.c;++g)(d[g]||{}).hidden||(f[g]=sn(g));for(var m=0,_=a.s.r;_<=a.e.r;++_)(h[_]||{}).hidden||(u=EX(e,a,_,f,s,l,i,n),u!=null&&(n.strip&&(u=u.replace(c,"")),(u||n.blankrows!==!1)&&r.push((m++?o:"")+u)));return delete n.dense,r.join("")}function AX(e,t){t||(t={}),t.FS="	",t.RS=`
`;var r=DT(e,t);return r}function TX(e){var t="",r,n="";if(e==null||e["!ref"]==null)return[];var a=Or(e["!ref"]),i="",s=[],o,l=[],c=Array.isArray(e);for(o=a.s.c;o<=a.e.c;++o)s[o]=sn(o);for(var u=a.s.r;u<=a.e.r;++u)for(i=kn(u),o=a.s.c;o<=a.e.c;++o)if(t=s[o]+i,r=c?(e[u]||[])[o]:e[t],n="",r!==void 0){if(r.F!=null){if(t=r.F,!r.f)continue;n=r.f,t.indexOf(":")==-1&&(t=t+":"+t)}if(r.f!=null)n=r.f;else{if(r.t=="z")continue;if(r.t=="n"&&r.v!=null)n=""+r.v;else if(r.t=="b")n=r.v?"TRUE":"FALSE";else if(r.w!==void 0)n="'"+r.w;else{if(r.v===void 0)continue;r.t=="s"?n="'"+r.v:n=""+r.v}}l[l.length]=t+"="+n}return l}function jT(e,t,r){var n=r||{},a=+!n.skipHeader,i=e||{},s=0,o=0;if(i&&n.origin!=null)if(typeof n.origin=="number")s=n.origin;else{var l=typeof n.origin=="string"?ra(n.origin):n.origin;s=l.r,o=l.c}var c,u={s:{c:0,r:0},e:{c:o,r:s+t.length-1+a}};if(i["!ref"]){var f=Or(i["!ref"]);u.e.c=Math.max(u.e.c,f.e.c),u.e.r=Math.max(u.e.r,f.e.r),s==-1&&(s=f.e.r+1,u.e.r=s+t.length-1+a)}else s==-1&&(s=0,u.e.r=t.length-1+a);var d=n.header||[],h=0;t.forEach(function(m,_){ds(m).forEach(function(y){(h=d.indexOf(y))==-1&&(d[h=d.length]=y);var b=m[y],w="z",T="",F=Nt({c:o+h,r:s+_+a});c=bh(i,F),b&&typeof b=="object"&&!(b instanceof Date)?i[F]=b:(typeof b=="number"?w="n":typeof b=="boolean"?w="b":typeof b=="string"?w="s":b instanceof Date?(w="d",n.cellDates||(w="n",b=ia(b)),T=n.dateNF||Ot[14]):b===null&&n.nullError&&(w="e",b=0),c?(c.t=w,c.v=b,delete c.w,delete c.R,T&&(c.z=T)):i[F]=c={t:w,v:b},T&&(c.z=T))})}),u.e.c=Math.max(u.e.c,o+d.length-1);var g=kn(s);if(a)for(h=0;h<d.length;++h)i[sn(h+o)+g]={t:"s",v:d[h]};return i["!ref"]=$t(u),i}function CX(e,t){return jT(null,e,t)}function bh(e,t,r){if(typeof t=="string"){if(Array.isArray(e)){var n=ra(t);return e[n.r]||(e[n.r]=[]),e[n.r][n.c]||(e[n.r][n.c]={t:"z"})}return e[t]||(e[t]={t:"z"})}return typeof t!="number"?bh(e,Nt(t)):bh(e,Nt({r:t,c:r||0}))}function NX(e,t){if(typeof t=="number"){if(t>=0&&e.SheetNames.length>t)return t;throw new Error("Cannot find sheet # "+t)}else if(typeof t=="string"){var r=e.SheetNames.indexOf(t);if(r>-1)return r;throw new Error("Cannot find sheet name |"+t+"|")}else throw new Error("Cannot find sheet |"+t+"|")}function H5(){return{SheetNames:[],Sheets:{}}}function W5(e,t,r,n){var a=1;if(!r)for(;a<=65535&&e.SheetNames.indexOf(r="Sheet"+a)!=-1;++a,r=void 0);if(!r||e.SheetNames.length>=65535)throw new Error("Too many worksheets");if(n&&e.SheetNames.indexOf(r)>=0){var i=r.match(/(^.*?)(\d+)$/);a=i&&+i[2]||0;var s=i&&i[1]||r;for(++a;a<=65535&&e.SheetNames.indexOf(r=s+a)!=-1;++a);}if(dK(r),e.SheetNames.indexOf(r)>=0)throw new Error("Worksheet with name |"+r+"| already exists!");return e.SheetNames.push(r),e.Sheets[r]=t,r}function PX(e,t,r){e.Workbook||(e.Workbook={}),e.Workbook.Sheets||(e.Workbook.Sheets=[]);var n=NX(e,t);switch(e.Workbook.Sheets[n]||(e.Workbook.Sheets[n]={}),r){case 0:case 1:case 2:break;default:throw new Error("Bad sheet visibility setting "+r)}e.Workbook.Sheets[n].Hidden=r}function LX(e,t){return e.z=t,e}function RT(e,t,r){return t?(e.l={Target:t},r&&(e.l.Tooltip=r)):delete e.l,e}function FX(e,t,r){return RT(e,"#"+t,r)}function OX(e,t,r){e.c||(e.c=[]),e.c.push({t,a:r||"SheetJS"})}function IX(e,t,r,n){for(var a=typeof t!="string"?t:Or(t),i=typeof t=="string"?t:$t(t),s=a.s.r;s<=a.e.r;++s)for(var o=a.s.c;o<=a.e.c;++o){var l=bh(e,s,o);l.t="n",l.F=i,delete l.v,s==a.s.r&&o==a.s.c&&(l.f=r,n&&(l.D=!0))}return e}var C2={encode_col:sn,encode_row:kn,encode_cell:Nt,encode_range:$t,decode_col:P5,decode_row:N5,split_cell:q$,decode_cell:ra,decode_range:o0,format_cell:eo,sheet_add_aoa:$A,sheet_add_json:jT,sheet_add_dom:LT,aoa_to_sheet:l0,json_to_sheet:CX,table_to_sheet:FT,table_to_book:JK,sheet_to_csv:DT,sheet_to_txt:AX,sheet_to_json:Sv,sheet_to_html:YK,sheet_to_formulae:TX,sheet_to_row_object_array:Sv,sheet_get_cell:bh,book_new:H5,book_append_sheet:W5,book_set_sheet_visibility:PX,cell_set_number_format:LX,cell_set_hyperlink:RT,cell_set_internal_link:FX,cell_add_comment:OX,sheet_set_array_formula:IX,consts:{SHEET_VISIBLE:0,SHEET_HIDDEN:1,SHEET_VERY_HIDDEN:2}};function yp(e){return e.normalize("NFD").replace(/[\u0300-\u036f]/g,"").replace(/\s+/g," ").trim().toUpperCase()}function DX(e){const t=new Date(Date.UTC(1899,11,30)),n=Math.floor(e)*24*60*60*1e3;return new Date(t.getTime()+n).toISOString().slice(0,10)}const jX=()=>{const{addArticle:e,addMovement:t,articles:r}=ps(),n=ie.useRef(null),[a,i]=ie.useState(null),[s,o]=ie.useState([]),[l,c]=ie.useState([]),[u,f]=ie.useState(!1),[d,h]=ie.useState(!1),[g,m]=ie.useState(null),[_,y]=ie.useState(!1),b=async j=>{var me;o([]),c([]),i(null);const J=(me=j.target.files)==null?void 0:me[0];if(!J)return;const N=await J.arrayBuffer(),L=_v(N);let G=[],W=[],le=[],de=[],X=!1;L.SheetNames.forEach(E=>{const D=C2.sheet_to_json(L.Sheets[E],{defval:"",raw:!1});if(D.length>0&&D[0].Nombre_Articulo&&D[0].Costo_Unitario){X=!0;for(const O of D)O.Nombre_Articulo&&G.push({nombre:O.Nombre_Articulo.toString().trim(),costo:Number(O.Costo_Unitario)||0})}});let ee=!1;L.SheetNames.forEach(E=>{const D=C2.sheet_to_json(L.Sheets[E],{defval:"",raw:!1});if(D.length>0&&D[0].Nombre_Articulo&&D[0].Tipo_Movimiento&&D[0].Cantidad&&D[0].Fecha){ee=!0;for(const O of D)!O.Nombre_Articulo||!O.Tipo_Movimiento||!O.Cantidad||W.push({articulo:O.Nombre_Articulo.toString().trim(),tipo:O.Tipo_Movimiento==="Entrada"?"Entrada":"Salida",fecha:O.Fecha,descripcion:O.Descripcion||"",cantidad:Math.round(Number(O.Cantidad)),costo:O.Costo_Unitario?Number(O.Costo_Unitario):0})}else if(D.length>0&&D[0].ID_Articulo&&D[0].Tipo_Movimiento&&D[0].Cantidad&&D[0].Fecha){ee=!0;for(const O of D)!O.ID_Articulo||!O.Tipo_Movimiento||!O.Cantidad||W.push({articulo:"",tipo:O.Tipo_Movimiento==="Entrada"?"Entrada":"Salida",fecha:O.Fecha,descripcion:O.Descripcion||"",cantidad:Math.round(Number(O.Cantidad)),costo:O.Costo_Unitario?Number(O.Costo_Unitario):0,id_articulo:Number(O.ID_Articulo)})}}),!X&&!ee&&L.SheetNames.forEach(E=>{const D=C2.sheet_to_json(L.Sheets[E],{header:1,blankrows:!1});let O=null,M=!1;for(let K=0;K<D.length;K++){const Y=D[K];if(!(!Array.isArray(Y)||Y.length===0)){if(typeof Y[0]=="string"&&Y[0].toUpperCase().includes("PRODUCTO:")){const re=(Y[0].split(":")[1]||"").trim()+(Y[1]?" "+Y[1]:"");if(!re){de.push(`Se detect un artculo sin nombre en la hoja '${E}', fila ${K+1}.`);continue}O={nombre:re,costo:0},G.push(O),M=!1}if(typeof Y[0]=="string"&&Y[0].toUpperCase().includes("FEC")){M=!0;continue}if(M&&O){let re="";if(typeof Y[0]=="number"?re=DX(Y[0]):typeof Y[0]=="string"&&Y[0].match(/^\d{4}-\d{2}-\d{2}/)&&(re=Y[0]),re){const se=Y[1]||"";Y[2]&&!isNaN(Number(Y[2]))&&(W.push({articulo:O.nombre,tipo:"Entrada",fecha:re,descripcion:se,cantidad:Math.round(Number(Y[2])),costo:Number(Y[3])||0}),Number(Y[3])>(O.costo||0)&&(O.costo=Number(Y[3]))),Y[7]&&!isNaN(Number(Y[7]))&&W.push({articulo:O.nombre,tipo:"Salida",fecha:re,descripcion:se,cantidad:Math.round(Number(Y[7])),costo:Number(Y[8])||0})}}}}});const R=W.filter(E=>E.cantidad>0),pe=W.filter(E=>E.cantidad<=0);o(le),c(de),i({articles:G,movements:R,movimientosDescartados:pe})},w={};r.forEach(j=>{w[j.nombre.trim().toUpperCase()]=j.id}),a&&a.articles.forEach(j=>{w[j.nombre.trim().toUpperCase()]=1});const T=a?a.movements.filter(j=>w[j.articulo.trim().toUpperCase()]).length:0,F=a?a.movements.length-T:0,I=async()=>{if(!a||l.length>0)return;f(!0),await ir.from("articulos").delete().neq("id",0);const j=[],J=new Set;for(const N of a.articles){const L=yp(N.nombre);J.has(L)||(j.push({...N,nombre:L}),J.add(L))}for(const N of j)await e({nombre:N.nombre,costo:N.costo});f(!1),y(!0),m({articulos:j.length,movimientos:0,advertencia:void 0}),h(!0)},A=async()=>{if(!a||l.length>0)return;f(!0),await ir.from("movimientos").delete().neq("id",0);const{data:j}=await ir.from("articulos").select("id, nombre"),J={};Array.isArray(j)&&j.forEach(W=>{const le=yp(W.nombre);J[le]=W.id});let N=0,L=0,G=[];for(const W of a.movements){let le=W.id_articulo;if(W.articulo&&W.articulo.length>0){const de=yp(W.articulo);le=J[de]}le?(await t({id_articulo:le,tipo:W.tipo,cantidad:W.cantidad,fecha:W.fecha,descripcion:W.descripcion,costo:W.costo}),L++):(N++,G.push({original:W.articulo,normalizado:W.id_articulo?`ID: ${W.id_articulo}`:yp(W.articulo),tipo:W.tipo,fecha:W.fecha,descripcion:W.descripcion,cantidad:W.cantidad,costo:W.costo,motivo:"No se encontr artculo con ese nombre o ID"}))}f(!1),m({articulos:0,movimientos:L,advertencia:N>0?`${N} movimientos no se importaron por no tener artculo asociado.`:void 0,movimientosNoAsociadosDetalle:G}),h(!0)},P=a&&a.movimientosDescartados?a.movimientosDescartados:[];return v.jsxs("div",{className:"max-w-3xl mx-auto py-10",children:[v.jsxs("div",{className:"bg-white rounded-2xl shadow-lg p-8 border border-gray-100",children:[v.jsx("h2",{className:"text-2xl font-bold mb-4",children:"Importar artculos y movimientos desde Excel"}),v.jsx("input",{ref:n,type:"file",accept:".xlsx,.xls",onChange:b,className:"mb-4"}),l.length>0&&v.jsxs("div",{className:"mb-2 text-red-600",children:[v.jsx("b",{children:"Errores crticos detectados:"}),v.jsx("ul",{className:"list-disc ml-6",children:l.map((j,J)=>v.jsx("li",{children:j},J))})]}),s.length>0&&v.jsxs("div",{className:"mb-2 text-yellow-700",children:[v.jsx("b",{children:"Advertencias:"}),v.jsx("ul",{className:"list-disc ml-6",children:s.map((j,J)=>v.jsx("li",{children:j},J))})]}),a&&v.jsxs("div",{className:"mb-4",children:[v.jsx("h3",{className:"font-semibold mb-2",children:"Resumen de importacin"}),v.jsxs("div",{children:["Artculos detectados: ",a.articles.length]}),v.jsxs("div",{children:["Movimientos detectados: ",a.movements.length]}),v.jsxs("div",{className:"flex gap-4 mt-4",children:[v.jsx("button",{onClick:I,disabled:u||l.length>0,className:"px-4 py-2 bg-green-600 text-white rounded-lg",children:"Importar solo artculos"}),v.jsx("button",{onClick:A,disabled:u||l.length>0||!_,className:`px-4 py-2 rounded-lg ${_?"bg-blue-600 text-white":"bg-gray-300 text-gray-500 cursor-not-allowed"}`,children:"Importar solo movimientos"})]}),v.jsx("div",{className:"text-xs text-gray-500 mt-2",children:"Primero importa los artculos, luego los movimientos."}),v.jsxs("div",{className:"text-sm text-gray-700 mb-2",children:[v.jsxs("span",{className:"mr-4",children:["Movimientos que se asociarn correctamente: ",v.jsx("b",{children:T})]}),v.jsxs("span",{children:["Movimientos sin artculo asociado: ",v.jsx("b",{children:F})]})]}),v.jsxs("div",{className:"mt-4",children:[v.jsx("h4",{className:"font-semibold mb-1",children:"Artculos"}),v.jsxs("table",{className:"min-w-full text-sm border mb-2",children:[v.jsx("thead",{children:v.jsx("tr",{className:"bg-gray-100",children:v.jsx("th",{className:"px-2 py-1 border",children:"Nombre"})})}),v.jsx("tbody",{children:a.articles.map((j,J)=>v.jsx("tr",{children:v.jsx("td",{className:"px-2 py-1 border",children:j.nombre})},J))})]}),v.jsx("h4",{className:"font-semibold mb-1",children:"Primeros movimientos"}),v.jsxs("table",{className:"min-w-full text-sm border",children:[v.jsx("thead",{children:v.jsxs("tr",{className:"bg-gray-100",children:[v.jsx("th",{className:"px-2 py-1 border",children:"Artculo"}),v.jsx("th",{className:"px-2 py-1 border",children:"Tipo"}),v.jsx("th",{className:"px-2 py-1 border",children:"Fecha"}),v.jsx("th",{className:"px-2 py-1 border",children:"Descripcin"}),v.jsx("th",{className:"px-2 py-1 border",children:"Cantidad"}),v.jsx("th",{className:"px-2 py-1 border",children:"Costo"})]})}),v.jsx("tbody",{children:a.movements.slice(0,5).map((j,J)=>v.jsxs("tr",{children:[v.jsx("td",{className:"px-2 py-1 border",children:j.articulo}),v.jsx("td",{className:"px-2 py-1 border",children:j.tipo}),v.jsx("td",{className:"px-2 py-1 border",children:j.fecha}),v.jsx("td",{className:"px-2 py-1 border",children:j.descripcion}),v.jsx("td",{className:"px-2 py-1 border",children:j.cantidad}),v.jsx("td",{className:"px-2 py-1 border",children:j.costo})]},J))})]})]})]})]}),v.jsxs(Xu,{isOpen:d,onRequestClose:()=>h(!1),className:"bg-white rounded-2xl shadow-lg p-8 border border-gray-100 max-w-lg mx-auto mt-20 outline-none",overlayClassName:"fixed inset-0 bg-black bg-opacity-40 flex items-center justify-center z-50",ariaHideApp:!1,children:[v.jsx("h2",{className:"text-2xl font-bold mb-4 text-center",children:"Importacin completada"}),g&&v.jsxs("div",{children:[v.jsxs("div",{className:"mb-2",children:["Artculos importados: ",v.jsx("b",{children:g.articulos})]}),v.jsxs("div",{className:"mb-2",children:["Movimientos importados: ",v.jsx("b",{children:g.movimientos})]}),g.advertencia&&v.jsxs("div",{className:"mt-4 text-yellow-700 font-semibold",children:[" ",g.advertencia]}),g.movimientosNoAsociadosDetalle&&g.movimientosNoAsociadosDetalle.length>0&&v.jsxs("div",{className:"mt-4",children:[v.jsx("h4",{className:"font-semibold mb-2",children:"Movimientos no asociados"}),v.jsxs("div",{className:"overflow-x-auto max-h-64",children:[v.jsxs("table",{className:"min-w-full text-xs border",children:[v.jsx("thead",{children:v.jsxs("tr",{className:"bg-gray-100",children:[v.jsx("th",{className:"px-2 py-1 border",children:"Artculo original"}),v.jsx("th",{className:"px-2 py-1 border",children:"Normalizado"}),v.jsx("th",{className:"px-2 py-1 border",children:"Tipo"}),v.jsx("th",{className:"px-2 py-1 border",children:"Fecha"}),v.jsx("th",{className:"px-2 py-1 border",children:"Descripcin"}),v.jsx("th",{className:"px-2 py-1 border",children:"Cantidad"}),v.jsx("th",{className:"px-2 py-1 border",children:"Costo"}),v.jsx("th",{className:"px-2 py-1 border",children:"Motivo"})]})}),v.jsx("tbody",{children:g.movimientosNoAsociadosDetalle.slice(0,20).map((j,J)=>v.jsxs("tr",{children:[v.jsx("td",{className:"px-2 py-1 border",children:j.original}),v.jsx("td",{className:"px-2 py-1 border",children:j.normalizado}),v.jsx("td",{className:"px-2 py-1 border",children:j.tipo}),v.jsx("td",{className:"px-2 py-1 border",children:j.fecha}),v.jsx("td",{className:"px-2 py-1 border",children:j.descripcion}),v.jsx("td",{className:"px-2 py-1 border",children:j.cantidad}),v.jsx("td",{className:"px-2 py-1 border",children:j.costo}),v.jsx("td",{className:"px-2 py-1 border text-red-600",children:j.motivo})]},J))})]}),v.jsx("div",{className:"text-xs text-gray-500 mt-1",children:"Mostrando mximo 20 movimientos no asociados."})]})]}),P.length>0&&v.jsxs("div",{className:"mt-4 text-yellow-700 font-semibold",children:[" ",P.length," movimientos fueron descartados por cantidad invlida ( 0).",v.jsxs("div",{className:"overflow-x-auto max-h-40 mt-2",children:[v.jsxs("table",{className:"min-w-full text-xs border",children:[v.jsx("thead",{children:v.jsxs("tr",{className:"bg-gray-100",children:[v.jsx("th",{className:"px-2 py-1 border",children:"Artculo"}),v.jsx("th",{className:"px-2 py-1 border",children:"Tipo"}),v.jsx("th",{className:"px-2 py-1 border",children:"Fecha"}),v.jsx("th",{className:"px-2 py-1 border",children:"Descripcin"}),v.jsx("th",{className:"px-2 py-1 border",children:"Cantidad"}),v.jsx("th",{className:"px-2 py-1 border",children:"Costo"})]})}),v.jsx("tbody",{children:P.slice(0,20).map((j,J)=>v.jsxs("tr",{children:[v.jsx("td",{className:"px-2 py-1 border",children:j.articulo}),v.jsx("td",{className:"px-2 py-1 border",children:j.tipo}),v.jsx("td",{className:"px-2 py-1 border",children:j.fecha}),v.jsx("td",{className:"px-2 py-1 border",children:j.descripcion}),v.jsx("td",{className:"px-2 py-1 border text-red-600",children:j.cantidad}),v.jsx("td",{className:"px-2 py-1 border",children:j.costo})]},J))})]}),v.jsx("div",{className:"text-xs text-gray-500 mt-1",children:"Mostrando mximo 20 movimientos descartados."})]})]}),v.jsx("button",{onClick:()=>h(!1),className:"mt-6 px-4 py-2 bg-blue-600 text-white rounded-lg w-full",children:"Cerrar"})]})]})]})};function tr(e){"@babel/helpers - typeof";return tr=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},tr(e)}var Vn=Uint8Array,Da=Uint16Array,q5=Int32Array,Mm=new Vn([0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,0,0,0]),Bm=new Vn([0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13,0,0]),kv=new Vn([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),MT=function(e,t){for(var r=new Da(31),n=0;n<31;++n)r[n]=t+=1<<e[n-1];for(var a=new q5(r[30]),n=1;n<30;++n)for(var i=r[n];i<r[n+1];++i)a[i]=i-r[n]<<5|n;return{b:r,r:a}},BT=MT(Mm,2),UT=BT.b,Ev=BT.r;UT[28]=258,Ev[258]=28;var $T=MT(Bm,0),RX=$T.b,A_=$T.r,Av=new Da(32768);for(var vr=0;vr<32768;++vr){var So=(vr&43690)>>1|(vr&21845)<<1;So=(So&52428)>>2|(So&13107)<<2,So=(So&61680)>>4|(So&3855)<<4,Av[vr]=((So&65280)>>8|(So&255)<<8)>>1}var fs=function(e,t,r){for(var n=e.length,a=0,i=new Da(t);a<n;++a)e[a]&&++i[e[a]-1];var s=new Da(t);for(a=1;a<t;++a)s[a]=s[a-1]+i[a-1]<<1;var o;if(r){o=new Da(1<<t);var l=15-t;for(a=0;a<n;++a)if(e[a])for(var c=a<<4|e[a],u=t-e[a],f=s[e[a]-1]++<<u,d=f|(1<<u)-1;f<=d;++f)o[Av[f]>>l]=c}else for(o=new Da(n),a=0;a<n;++a)e[a]&&(o[a]=Av[s[e[a]-1]++]>>15-e[a]);return o},sl=new Vn(288);for(var vr=0;vr<144;++vr)sl[vr]=8;for(var vr=144;vr<256;++vr)sl[vr]=9;for(var vr=256;vr<280;++vr)sl[vr]=7;for(var vr=280;vr<288;++vr)sl[vr]=8;var _h=new Vn(32);for(var vr=0;vr<32;++vr)_h[vr]=5;var MX=fs(sl,9,0),BX=fs(sl,9,1),UX=fs(_h,5,0),$X=fs(_h,5,1),N2=function(e){for(var t=e[0],r=1;r<e.length;++r)e[r]>t&&(t=e[r]);return t},ki=function(e,t,r){var n=t/8|0;return(e[n]|e[n+1]<<8)>>(t&7)&r},P2=function(e,t){var r=t/8|0;return(e[r]|e[r+1]<<8|e[r+2]<<16)>>(t&7)},G5=function(e){return(e+7)/8|0},VT=function(e,t,r){return(r==null||r>e.length)&&(r=e.length),new Vn(e.subarray(t,r))},VX=["unexpected EOF","invalid block type","invalid length/literal","invalid distance","stream finished","no stream handler",,"no callback","invalid UTF-8 data","extra field too long","date not in range 1980-2099","filename too long","stream finishing","invalid zip data"],Ni=function(e,t,r){var n=new Error(t||VX[e]);if(n.code=e,Error.captureStackTrace&&Error.captureStackTrace(n,Ni),!r)throw n;return n},zX=function(e,t,r,n){var a=e.length,i=0;if(!a||t.f&&!t.l)return r||new Vn(0);var s=!r,o=s||t.i!=2,l=t.i;s&&(r=new Vn(a*3));var c=function(Ce){var Z=r.length;if(Ce>Z){var Ie=new Vn(Math.max(Z*2,Ce));Ie.set(r),r=Ie}},u=t.f||0,f=t.p||0,d=t.b||0,h=t.l,g=t.d,m=t.m,_=t.n,y=a*8;do{if(!h){u=ki(e,f,1);var b=ki(e,f+1,3);if(f+=3,b)if(b==1)h=BX,g=$X,m=9,_=5;else if(b==2){var I=ki(e,f,31)+257,A=ki(e,f+10,15)+4,P=I+ki(e,f+5,31)+1;f+=14;for(var j=new Vn(P),J=new Vn(19),N=0;N<A;++N)J[kv[N]]=ki(e,f+N*3,7);f+=A*3;for(var L=N2(J),G=(1<<L)-1,W=fs(J,L,1),N=0;N<P;){var le=W[ki(e,f,G)];f+=le&15;var w=le>>4;if(w<16)j[N++]=w;else{var de=0,X=0;for(w==16?(X=3+ki(e,f,3),f+=2,de=j[N-1]):w==17?(X=3+ki(e,f,7),f+=3):w==18&&(X=11+ki(e,f,127),f+=7);X--;)j[N++]=de}}var ee=j.subarray(0,I),R=j.subarray(I);m=N2(ee),_=N2(R),h=fs(ee,m,1),g=fs(R,_,1)}else Ni(1);else{var w=G5(f)+4,T=e[w-4]|e[w-3]<<8,F=w+T;if(F>a){l&&Ni(0);break}o&&c(d+T),r.set(e.subarray(w,F),d),t.b=d+=T,t.p=f=F*8,t.f=u;continue}if(f>y){l&&Ni(0);break}}o&&c(d+131072);for(var pe=(1<<m)-1,me=(1<<_)-1,E=f;;E=f){var de=h[P2(e,f)&pe],D=de>>4;if(f+=de&15,f>y){l&&Ni(0);break}if(de||Ni(2),D<256)r[d++]=D;else if(D==256){E=f,h=null;break}else{var O=D-254;if(D>264){var N=D-257,M=Mm[N];O=ki(e,f,(1<<M)-1)+UT[N],f+=M}var K=g[P2(e,f)&me],Y=K>>4;K||Ni(3),f+=K&15;var R=RX[Y];if(Y>3){var M=Bm[Y];R+=P2(e,f)&(1<<M)-1,f+=M}if(f>y){l&&Ni(0);break}o&&c(d+131072);var re=d+O;if(d<R){var se=i-R,xe=Math.min(R,re);for(se+d<0&&Ni(3);d<xe;++d)r[d]=n[se+d]}for(;d<re;++d)r[d]=r[d-R]}}t.l=h,t.p=E,t.b=d,t.f=u,h&&(u=1,t.m=m,t.d=g,t.n=_)}while(!u);return d!=r.length&&s?VT(r,0,d):r.subarray(0,d)},Ls=function(e,t,r){r<<=t&7;var n=t/8|0;e[n]|=r,e[n+1]|=r>>8},Y0=function(e,t,r){r<<=t&7;var n=t/8|0;e[n]|=r,e[n+1]|=r>>8,e[n+2]|=r>>16},L2=function(e,t){for(var r=[],n=0;n<e.length;++n)e[n]&&r.push({s:n,f:e[n]});var a=r.length,i=r.slice();if(!a)return{t:HT,l:0};if(a==1){var s=new Vn(r[0].s+1);return s[r[0].s]=1,{t:s,l:1}}r.sort(function(F,I){return F.f-I.f}),r.push({s:-1,f:25001});var o=r[0],l=r[1],c=0,u=1,f=2;for(r[0]={s:-1,f:o.f+l.f,l:o,r:l};u!=a-1;)o=r[r[c].f<r[f].f?c++:f++],l=r[c!=u&&r[c].f<r[f].f?c++:f++],r[u++]={s:-1,f:o.f+l.f,l:o,r:l};for(var d=i[0].s,n=1;n<a;++n)i[n].s>d&&(d=i[n].s);var h=new Da(d+1),g=Tv(r[u-1],h,0);if(g>t){var n=0,m=0,_=g-t,y=1<<_;for(i.sort(function(I,A){return h[A.s]-h[I.s]||I.f-A.f});n<a;++n){var b=i[n].s;if(h[b]>t)m+=y-(1<<g-h[b]),h[b]=t;else break}for(m>>=_;m>0;){var w=i[n].s;h[w]<t?m-=1<<t-h[w]++-1:++n}for(;n>=0&&m;--n){var T=i[n].s;h[T]==t&&(--h[T],++m)}g=t}return{t:new Vn(h),l:g}},Tv=function(e,t,r){return e.s==-1?Math.max(Tv(e.l,t,r+1),Tv(e.r,t,r+1)):t[e.s]=r},T_=function(e){for(var t=e.length;t&&!e[--t];);for(var r=new Da(++t),n=0,a=e[0],i=1,s=function(l){r[n++]=l},o=1;o<=t;++o)if(e[o]==a&&o!=t)++i;else{if(!a&&i>2){for(;i>138;i-=138)s(32754);i>2&&(s(i>10?i-11<<5|28690:i-3<<5|12305),i=0)}else if(i>3){for(s(a),--i;i>6;i-=6)s(8304);i>2&&(s(i-3<<5|8208),i=0)}for(;i--;)s(a);i=1,a=e[o]}return{c:r.subarray(0,n),n:t}},J0=function(e,t){for(var r=0,n=0;n<t.length;++n)r+=e[n]*t[n];return r},zT=function(e,t,r){var n=r.length,a=G5(t+2);e[a]=n&255,e[a+1]=n>>8,e[a+2]=e[a]^255,e[a+3]=e[a+1]^255;for(var i=0;i<n;++i)e[a+i+4]=r[i];return(a+4+n)*8},C_=function(e,t,r,n,a,i,s,o,l,c,u){Ls(t,u++,r),++a[256];for(var f=L2(a,15),d=f.t,h=f.l,g=L2(i,15),m=g.t,_=g.l,y=T_(d),b=y.c,w=y.n,T=T_(m),F=T.c,I=T.n,A=new Da(19),P=0;P<b.length;++P)++A[b[P]&31];for(var P=0;P<F.length;++P)++A[F[P]&31];for(var j=L2(A,7),J=j.t,N=j.l,L=19;L>4&&!J[kv[L-1]];--L);var G=c+5<<3,W=J0(a,sl)+J0(i,_h)+s,le=J0(a,d)+J0(i,m)+s+14+3*L+J0(A,J)+2*A[16]+3*A[17]+7*A[18];if(l>=0&&G<=W&&G<=le)return zT(t,u,e.subarray(l,l+c));var de,X,ee,R;if(Ls(t,u,1+(le<W)),u+=2,le<W){de=fs(d,h,0),X=d,ee=fs(m,_,0),R=m;var pe=fs(J,N,0);Ls(t,u,w-257),Ls(t,u+5,I-1),Ls(t,u+10,L-4),u+=14;for(var P=0;P<L;++P)Ls(t,u+3*P,J[kv[P]]);u+=3*L;for(var me=[b,F],E=0;E<2;++E)for(var D=me[E],P=0;P<D.length;++P){var O=D[P]&31;Ls(t,u,pe[O]),u+=J[O],O>15&&(Ls(t,u,D[P]>>5&127),u+=D[P]>>12)}}else de=MX,X=sl,ee=UX,R=_h;for(var P=0;P<o;++P){var M=n[P];if(M>255){var O=M>>18&31;Y0(t,u,de[O+257]),u+=X[O+257],O>7&&(Ls(t,u,M>>23&31),u+=Mm[O]);var K=M&31;Y0(t,u,ee[K]),u+=R[K],K>3&&(Y0(t,u,M>>5&8191),u+=Bm[K])}else Y0(t,u,de[M]),u+=X[M]}return Y0(t,u,de[256]),u+X[256]},HX=new q5([65540,131080,131088,131104,262176,1048704,1048832,2114560,2117632]),HT=new Vn(0),WX=function(e,t,r,n,a,i){var s=i.z||e.length,o=new Vn(n+s+5*(1+Math.ceil(s/7e3))+a),l=o.subarray(n,o.length-a),c=i.l,u=(i.r||0)&7;if(t){u&&(l[0]=i.r>>3);for(var f=HX[t-1],d=f>>13,h=f&8191,g=(1<<r)-1,m=i.p||new Da(32768),_=i.h||new Da(g+1),y=Math.ceil(r/3),b=2*y,w=function(He){return(e[He]^e[He+1]<<y^e[He+2]<<b)&g},T=new q5(25e3),F=new Da(288),I=new Da(32),A=0,P=0,j=i.i||0,J=0,N=i.w||0,L=0;j+2<s;++j){var G=w(j),W=j&32767,le=_[G];if(m[W]=le,_[G]=W,N<=j){var de=s-j;if((A>7e3||J>24576)&&(de>423||!c)){u=C_(e,l,0,T,F,I,P,J,L,j-L,u),J=A=P=0,L=j;for(var X=0;X<286;++X)F[X]=0;for(var X=0;X<30;++X)I[X]=0}var ee=2,R=0,pe=h,me=W-le&32767;if(de>2&&G==w(j-me))for(var E=Math.min(d,de)-1,D=Math.min(32767,j),O=Math.min(258,de);me<=D&&--pe&&W!=le;){if(e[j+ee]==e[j+ee-me]){for(var M=0;M<O&&e[j+M]==e[j+M-me];++M);if(M>ee){if(ee=M,R=me,M>E)break;for(var K=Math.min(me,M-2),Y=0,X=0;X<K;++X){var re=j-me+X&32767,se=m[re],xe=re-se&32767;xe>Y&&(Y=xe,le=re)}}}W=le,le=m[W],me+=W-le&32767}if(R){T[J++]=268435456|Ev[ee]<<18|A_[R];var Ce=Ev[ee]&31,Z=A_[R]&31;P+=Mm[Ce]+Bm[Z],++F[257+Ce],++I[Z],N=j+ee,++A}else T[J++]=e[j],++F[e[j]]}}for(j=Math.max(j,N);j<s;++j)T[J++]=e[j],++F[e[j]];u=C_(e,l,c,T,F,I,P,J,L,j-L,u),c||(i.r=u&7|l[u/8|0]<<3,u-=7,i.h=_,i.p=m,i.i=j,i.w=N)}else{for(var j=i.w||0;j<s+c;j+=65535){var Ie=j+65535;Ie>=s&&(l[u/8|0]=c,Ie=s),u=zT(l,u+1,e.subarray(j,Ie))}i.i=s}return VT(o,0,n+G5(u)+a)},WT=function(){var e=1,t=0;return{p:function(r){for(var n=e,a=t,i=r.length|0,s=0;s!=i;){for(var o=Math.min(s+2655,i);s<o;++s)a+=n+=r[s];n=(n&65535)+15*(n>>16),a=(a&65535)+15*(a>>16)}e=n,t=a},d:function(){return e%=65521,t%=65521,(e&255)<<24|(e&65280)<<8|(t&255)<<8|t>>8}}},qX=function(e,t,r,n,a){if(!a&&(a={l:1},t.dictionary)){var i=t.dictionary.subarray(-32768),s=new Vn(i.length+e.length);s.set(i),s.set(e,i.length),e=s,a.w=i.length}return WX(e,t.level==null?6:t.level,t.mem==null?a.l?Math.ceil(Math.max(8,Math.min(13,Math.log(e.length)))*1.5):20:12+t.mem,r,n,a)},qT=function(e,t,r){for(;r;++t)e[t]=r,r>>>=8},GX=function(e,t){var r=t.level,n=r==0?0:r<6?1:r==9?3:2;if(e[0]=120,e[1]=n<<6|(t.dictionary&&32),e[1]|=31-(e[0]<<8|e[1])%31,t.dictionary){var a=WT();a.p(t.dictionary),qT(e,2,a.d())}},KX=function(e,t){return((e[0]&15)!=8||e[0]>>4>7||(e[0]<<8|e[1])%31)&&Ni(6,"invalid zlib data"),(e[1]>>5&1)==+!t&&Ni(6,"invalid zlib data: "+(e[1]&32?"need":"unexpected")+" dictionary"),(e[1]>>3&4)+2};function Cv(e,t){t||(t={});var r=WT();r.p(e);var n=qX(e,t,t.dictionary?6:2,4);return GX(n,t),qT(n,n.length-4,r.d()),n}function XX(e,t){return zX(e.subarray(KX(e,t),-4),{i:2},t,t)}var YX=typeof TextDecoder<"u"&&new TextDecoder,JX=0;try{YX.decode(HT,{stream:!0}),JX=1}catch{}var yt=function(){return typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:this}();function F2(){yt.console&&typeof yt.console.log=="function"&&yt.console.log.apply(yt.console,arguments)}var lr={log:F2,warn:function(e){yt.console&&(typeof yt.console.warn=="function"?yt.console.warn.apply(yt.console,arguments):F2.call(null,arguments))},error:function(e){yt.console&&(typeof yt.console.error=="function"?yt.console.error.apply(yt.console,arguments):F2(e))}};function O2(e,t,r){var n=new XMLHttpRequest;n.open("GET",e),n.responseType="blob",n.onload=function(){Il(n.response,t,r)},n.onerror=function(){lr.error("could not download file")},n.send()}function N_(e){var t=new XMLHttpRequest;t.open("HEAD",e,!1);try{t.send()}catch{}return t.status>=200&&t.status<=299}function wp(e){try{e.dispatchEvent(new MouseEvent("click"))}catch{var t=document.createEvent("MouseEvents");t.initMouseEvent("click",!0,!0,window,0,0,0,80,20,!1,!1,!1,!1,0,null),e.dispatchEvent(t)}}var Mf,Nv,Il=yt.saveAs||((typeof window>"u"?"undefined":tr(window))!=="object"||window!==yt?function(){}:typeof HTMLAnchorElement<"u"&&"download"in HTMLAnchorElement.prototype?function(e,t,r){var n=yt.URL||yt.webkitURL,a=document.createElement("a");t=t||e.name||"download",a.download=t,a.rel="noopener",typeof e=="string"?(a.href=e,a.origin!==location.origin?N_(a.href)?O2(e,t,r):wp(a,a.target="_blank"):wp(a)):(a.href=n.createObjectURL(e),setTimeout(function(){n.revokeObjectURL(a.href)},4e4),setTimeout(function(){wp(a)},0))}:"msSaveOrOpenBlob"in navigator?function(e,t,r){if(t=t||e.name||"download",typeof e=="string")if(N_(e))O2(e,t,r);else{var n=document.createElement("a");n.href=e,n.target="_blank",setTimeout(function(){wp(n)})}else navigator.msSaveOrOpenBlob(function(a,i){return i===void 0?i={autoBom:!1}:tr(i)!=="object"&&(lr.warn("Deprecated: Expected third argument to be a object"),i={autoBom:!i}),i.autoBom&&/^\s*(?:text\/\S*|application\/xml|\S*\/\S*\+xml)\s*;.*charset\s*=\s*utf-8/i.test(a.type)?new Blob(["\uFEFF",a],{type:a.type}):a}(e,r),t)}:function(e,t,r,n){if((n=n||open("","_blank"))&&(n.document.title=n.document.body.innerText="downloading..."),typeof e=="string")return O2(e,t,r);var a=e.type==="application/octet-stream",i=/constructor/i.test(yt.HTMLElement)||yt.safari,s=/CriOS\/[\d]+/.test(navigator.userAgent);if((s||a&&i)&&(typeof FileReader>"u"?"undefined":tr(FileReader))==="object"){var o=new FileReader;o.onloadend=function(){var u=o.result;u=s?u:u.replace(/^data:[^;]*;/,"data:attachment/file;"),n?n.location.href=u:location=u,n=null},o.readAsDataURL(e)}else{var l=yt.URL||yt.webkitURL,c=l.createObjectURL(e);n?n.location=c:location.href=c,n=null,setTimeout(function(){l.revokeObjectURL(c)},4e4)}});/**
 * A class to parse color values
 * @author Stoyan Stefanov <sstoo@gmail.com>
 * {@link   http://www.phpied.com/rgb-color-parser-in-javascript/}
 * @license Use it if you like it
 */function GT(e){var t;e=e||"",this.ok=!1,e.charAt(0)=="#"&&(e=e.substr(1,6)),e={aliceblue:"f0f8ff",antiquewhite:"faebd7",aqua:"00ffff",aquamarine:"7fffd4",azure:"f0ffff",beige:"f5f5dc",bisque:"ffe4c4",black:"000000",blanchedalmond:"ffebcd",blue:"0000ff",blueviolet:"8a2be2",brown:"a52a2a",burlywood:"deb887",cadetblue:"5f9ea0",chartreuse:"7fff00",chocolate:"d2691e",coral:"ff7f50",cornflowerblue:"6495ed",cornsilk:"fff8dc",crimson:"dc143c",cyan:"00ffff",darkblue:"00008b",darkcyan:"008b8b",darkgoldenrod:"b8860b",darkgray:"a9a9a9",darkgreen:"006400",darkkhaki:"bdb76b",darkmagenta:"8b008b",darkolivegreen:"556b2f",darkorange:"ff8c00",darkorchid:"9932cc",darkred:"8b0000",darksalmon:"e9967a",darkseagreen:"8fbc8f",darkslateblue:"483d8b",darkslategray:"2f4f4f",darkturquoise:"00ced1",darkviolet:"9400d3",deeppink:"ff1493",deepskyblue:"00bfff",dimgray:"696969",dodgerblue:"1e90ff",feldspar:"d19275",firebrick:"b22222",floralwhite:"fffaf0",forestgreen:"228b22",fuchsia:"ff00ff",gainsboro:"dcdcdc",ghostwhite:"f8f8ff",gold:"ffd700",goldenrod:"daa520",gray:"808080",green:"008000",greenyellow:"adff2f",honeydew:"f0fff0",hotpink:"ff69b4",indianred:"cd5c5c",indigo:"4b0082",ivory:"fffff0",khaki:"f0e68c",lavender:"e6e6fa",lavenderblush:"fff0f5",lawngreen:"7cfc00",lemonchiffon:"fffacd",lightblue:"add8e6",lightcoral:"f08080",lightcyan:"e0ffff",lightgoldenrodyellow:"fafad2",lightgrey:"d3d3d3",lightgreen:"90ee90",lightpink:"ffb6c1",lightsalmon:"ffa07a",lightseagreen:"20b2aa",lightskyblue:"87cefa",lightslateblue:"8470ff",lightslategray:"778899",lightsteelblue:"b0c4de",lightyellow:"ffffe0",lime:"00ff00",limegreen:"32cd32",linen:"faf0e6",magenta:"ff00ff",maroon:"800000",mediumaquamarine:"66cdaa",mediumblue:"0000cd",mediumorchid:"ba55d3",mediumpurple:"9370d8",mediumseagreen:"3cb371",mediumslateblue:"7b68ee",mediumspringgreen:"00fa9a",mediumturquoise:"48d1cc",mediumvioletred:"c71585",midnightblue:"191970",mintcream:"f5fffa",mistyrose:"ffe4e1",moccasin:"ffe4b5",navajowhite:"ffdead",navy:"000080",oldlace:"fdf5e6",olive:"808000",olivedrab:"6b8e23",orange:"ffa500",orangered:"ff4500",orchid:"da70d6",palegoldenrod:"eee8aa",palegreen:"98fb98",paleturquoise:"afeeee",palevioletred:"d87093",papayawhip:"ffefd5",peachpuff:"ffdab9",peru:"cd853f",pink:"ffc0cb",plum:"dda0dd",powderblue:"b0e0e6",purple:"800080",red:"ff0000",rosybrown:"bc8f8f",royalblue:"4169e1",saddlebrown:"8b4513",salmon:"fa8072",sandybrown:"f4a460",seagreen:"2e8b57",seashell:"fff5ee",sienna:"a0522d",silver:"c0c0c0",skyblue:"87ceeb",slateblue:"6a5acd",slategray:"708090",snow:"fffafa",springgreen:"00ff7f",steelblue:"4682b4",tan:"d2b48c",teal:"008080",thistle:"d8bfd8",tomato:"ff6347",turquoise:"40e0d0",violet:"ee82ee",violetred:"d02090",wheat:"f5deb3",white:"ffffff",whitesmoke:"f5f5f5",yellow:"ffff00",yellowgreen:"9acd32"}[e=(e=e.replace(/ /g,"")).toLowerCase()]||e;for(var r=[{re:/^rgb\((\d{1,3}),\s*(\d{1,3}),\s*(\d{1,3})\)$/,example:["rgb(123, 234, 45)","rgb(255,234,245)"],process:function(o){return[parseInt(o[1]),parseInt(o[2]),parseInt(o[3])]}},{re:/^(\w{2})(\w{2})(\w{2})$/,example:["#00ff00","336699"],process:function(o){return[parseInt(o[1],16),parseInt(o[2],16),parseInt(o[3],16)]}},{re:/^(\w{1})(\w{1})(\w{1})$/,example:["#fb0","f0f"],process:function(o){return[parseInt(o[1]+o[1],16),parseInt(o[2]+o[2],16),parseInt(o[3]+o[3],16)]}}],n=0;n<r.length;n++){var a=r[n].re,i=r[n].process,s=a.exec(e);s&&(t=i(s),this.r=t[0],this.g=t[1],this.b=t[2],this.ok=!0)}this.r=this.r<0||isNaN(this.r)?0:this.r>255?255:this.r,this.g=this.g<0||isNaN(this.g)?0:this.g>255?255:this.g,this.b=this.b<0||isNaN(this.b)?0:this.b>255?255:this.b,this.toRGB=function(){return"rgb("+this.r+", "+this.g+", "+this.b+")"},this.toHex=function(){var o=this.r.toString(16),l=this.g.toString(16),c=this.b.toString(16);return o.length==1&&(o="0"+o),l.length==1&&(l="0"+l),c.length==1&&(c="0"+c),"#"+o+l+c}}/**
 * @license
 * Joseph Myers does not specify a particular license for his work.
 *
 * Author: Joseph Myers
 * Accessed from: http://www.myersdaily.org/joseph/javascript/md5.js
 *
 * Modified by: Owen Leong
 */function I2(e,t){var r=e[0],n=e[1],a=e[2],i=e[3];r=Fn(r,n,a,i,t[0],7,-680876936),i=Fn(i,r,n,a,t[1],12,-389564586),a=Fn(a,i,r,n,t[2],17,606105819),n=Fn(n,a,i,r,t[3],22,-1044525330),r=Fn(r,n,a,i,t[4],7,-176418897),i=Fn(i,r,n,a,t[5],12,1200080426),a=Fn(a,i,r,n,t[6],17,-1473231341),n=Fn(n,a,i,r,t[7],22,-45705983),r=Fn(r,n,a,i,t[8],7,1770035416),i=Fn(i,r,n,a,t[9],12,-1958414417),a=Fn(a,i,r,n,t[10],17,-42063),n=Fn(n,a,i,r,t[11],22,-1990404162),r=Fn(r,n,a,i,t[12],7,1804603682),i=Fn(i,r,n,a,t[13],12,-40341101),a=Fn(a,i,r,n,t[14],17,-1502002290),r=On(r,n=Fn(n,a,i,r,t[15],22,1236535329),a,i,t[1],5,-165796510),i=On(i,r,n,a,t[6],9,-1069501632),a=On(a,i,r,n,t[11],14,643717713),n=On(n,a,i,r,t[0],20,-373897302),r=On(r,n,a,i,t[5],5,-701558691),i=On(i,r,n,a,t[10],9,38016083),a=On(a,i,r,n,t[15],14,-660478335),n=On(n,a,i,r,t[4],20,-405537848),r=On(r,n,a,i,t[9],5,568446438),i=On(i,r,n,a,t[14],9,-1019803690),a=On(a,i,r,n,t[3],14,-187363961),n=On(n,a,i,r,t[8],20,1163531501),r=On(r,n,a,i,t[13],5,-1444681467),i=On(i,r,n,a,t[2],9,-51403784),a=On(a,i,r,n,t[7],14,1735328473),r=In(r,n=On(n,a,i,r,t[12],20,-1926607734),a,i,t[5],4,-378558),i=In(i,r,n,a,t[8],11,-2022574463),a=In(a,i,r,n,t[11],16,1839030562),n=In(n,a,i,r,t[14],23,-35309556),r=In(r,n,a,i,t[1],4,-1530992060),i=In(i,r,n,a,t[4],11,1272893353),a=In(a,i,r,n,t[7],16,-155497632),n=In(n,a,i,r,t[10],23,-1094730640),r=In(r,n,a,i,t[13],4,681279174),i=In(i,r,n,a,t[0],11,-358537222),a=In(a,i,r,n,t[3],16,-722521979),n=In(n,a,i,r,t[6],23,76029189),r=In(r,n,a,i,t[9],4,-640364487),i=In(i,r,n,a,t[12],11,-421815835),a=In(a,i,r,n,t[15],16,530742520),r=Dn(r,n=In(n,a,i,r,t[2],23,-995338651),a,i,t[0],6,-198630844),i=Dn(i,r,n,a,t[7],10,1126891415),a=Dn(a,i,r,n,t[14],15,-1416354905),n=Dn(n,a,i,r,t[5],21,-57434055),r=Dn(r,n,a,i,t[12],6,1700485571),i=Dn(i,r,n,a,t[3],10,-1894986606),a=Dn(a,i,r,n,t[10],15,-1051523),n=Dn(n,a,i,r,t[1],21,-2054922799),r=Dn(r,n,a,i,t[8],6,1873313359),i=Dn(i,r,n,a,t[15],10,-30611744),a=Dn(a,i,r,n,t[6],15,-1560198380),n=Dn(n,a,i,r,t[13],21,1309151649),r=Dn(r,n,a,i,t[4],6,-145523070),i=Dn(i,r,n,a,t[11],10,-1120210379),a=Dn(a,i,r,n,t[2],15,718787259),n=Dn(n,a,i,r,t[9],21,-343485551),e[0]=Vo(r,e[0]),e[1]=Vo(n,e[1]),e[2]=Vo(a,e[2]),e[3]=Vo(i,e[3])}function Um(e,t,r,n,a,i){return t=Vo(Vo(t,e),Vo(n,i)),Vo(t<<a|t>>>32-a,r)}function Fn(e,t,r,n,a,i,s){return Um(t&r|~t&n,e,t,a,i,s)}function On(e,t,r,n,a,i,s){return Um(t&n|r&~n,e,t,a,i,s)}function In(e,t,r,n,a,i,s){return Um(t^r^n,e,t,a,i,s)}function Dn(e,t,r,n,a,i,s){return Um(r^(t|~n),e,t,a,i,s)}function KT(e){var t,r=e.length,n=[1732584193,-271733879,-1732584194,271733878];for(t=64;t<=e.length;t+=64)I2(n,QX(e.substring(t-64,t)));e=e.substring(t-64);var a=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0];for(t=0;t<e.length;t++)a[t>>2]|=e.charCodeAt(t)<<(t%4<<3);if(a[t>>2]|=128<<(t%4<<3),t>55)for(I2(n,a),t=0;t<16;t++)a[t]=0;return a[14]=8*r,I2(n,a),n}function QX(e){var t,r=[];for(t=0;t<64;t+=4)r[t>>2]=e.charCodeAt(t)+(e.charCodeAt(t+1)<<8)+(e.charCodeAt(t+2)<<16)+(e.charCodeAt(t+3)<<24);return r}Mf=yt.atob.bind(yt),Nv=yt.btoa.bind(yt);var P_="0123456789abcdef".split("");function ZX(e){for(var t="",r=0;r<4;r++)t+=P_[e>>8*r+4&15]+P_[e>>8*r&15];return t}function eY(e){return String.fromCharCode((255&e)>>0,(65280&e)>>8,(16711680&e)>>16,(4278190080&e)>>24)}function Pv(e){return KT(e).map(eY).join("")}var tY=function(e){for(var t=0;t<e.length;t++)e[t]=ZX(e[t]);return e.join("")}(KT("hello"))!="5d41402abc4b2a76b9719d911017c592";function Vo(e,t){if(tY){var r=(65535&e)+(65535&t);return(e>>16)+(t>>16)+(r>>16)<<16|65535&r}return e+t&4294967295}/**
 * @license
 * FPDF is released under a permissive license: there is no usage restriction.
 * You may embed it freely in your application (commercial or not), with or
 * without modifications.
 *
 * Reference: http://www.fpdf.org/en/script/script37.php
 */function Lv(e,t){var r,n,a,i;if(e!==r){for(var s=(a=e,i=1+(256/e.length>>0),new Array(i+1).join(a)),o=[],l=0;l<256;l++)o[l]=l;var c=0;for(l=0;l<256;l++){var u=o[l];c=(c+u+s.charCodeAt(l))%256,o[l]=o[c],o[c]=u}r=e,n=o}else o=n;var f=t.length,d=0,h=0,g="";for(l=0;l<f;l++)h=(h+(u=o[d=(d+1)%256]))%256,o[d]=o[h],o[h]=u,s=o[(o[d]+o[h])%256],g+=String.fromCharCode(t.charCodeAt(l)^s);return g}/**
 * @license
 * Licensed under the MIT License.
 * http://opensource.org/licenses/mit-license
 * Author: Owen Leong (@owenl131)
 * Date: 15 Oct 2020
 * References:
 * https://www.cs.cmu.edu/~dst/Adobe/Gallery/anon21jul01-pdf-encryption.txt
 * https://github.com/foliojs/pdfkit/blob/master/lib/security.js
 * http://www.fpdf.org/en/script/script37.php
 */var L_={print:4,modify:8,copy:16,"annot-forms":32};function tu(e,t,r,n){this.v=1,this.r=2;var a=192;e.forEach(function(o){if(L_.perm!==void 0)throw new Error("Invalid permission: "+o);a+=L_[o]}),this.padding="(N^NuAd\0NV\b..\0h>/\fdSiz";var i=(t+this.padding).substr(0,32),s=(r+this.padding).substr(0,32);this.O=this.processOwnerPassword(i,s),this.P=-(1+(255^a)),this.encryptionKey=Pv(i+this.O+this.lsbFirstWord(this.P)+this.hexToBytes(n)).substr(0,5),this.U=Lv(this.encryptionKey,this.padding)}function ru(e){if(/[^\u0000-\u00ff]/.test(e))throw new Error("Invalid PDF Name Object: "+e+", Only accept ASCII characters.");for(var t="",r=e.length,n=0;n<r;n++){var a=e.charCodeAt(n);a<33||a===35||a===37||a===40||a===41||a===47||a===60||a===62||a===91||a===93||a===123||a===125||a>126?t+="#"+("0"+a.toString(16)).slice(-2):t+=e[n]}return t}function F_(e){if(tr(e)!=="object")throw new Error("Invalid Context passed to initialize PubSub (jsPDF-module)");var t={};this.subscribe=function(r,n,a){if(a=a||!1,typeof r!="string"||typeof n!="function"||typeof a!="boolean")throw new Error("Invalid arguments passed to PubSub.subscribe (jsPDF-module)");t.hasOwnProperty(r)||(t[r]={});var i=Math.random().toString(35);return t[r][i]=[n,!!a],i},this.unsubscribe=function(r){for(var n in t)if(t[n][r])return delete t[n][r],Object.keys(t[n]).length===0&&delete t[n],!0;return!1},this.publish=function(r){if(t.hasOwnProperty(r)){var n=Array.prototype.slice.call(arguments,1),a=[];for(var i in t[r]){var s=t[r][i];try{s[0].apply(e,n)}catch(o){yt.console&&lr.error("jsPDF PubSub Error",o.message,o)}s[1]&&a.push(i)}a.length&&a.forEach(this.unsubscribe)}},this.getTopics=function(){return t}}function z1(e){if(!(this instanceof z1))return new z1(e);var t="opacity,stroke-opacity".split(",");for(var r in e)e.hasOwnProperty(r)&&t.indexOf(r)>=0&&(this[r]=e[r]);this.id="",this.objectNumber=-1}function XT(e,t){this.gState=e,this.matrix=t,this.id="",this.objectNumber=-1}function Rl(e,t,r,n,a){if(!(this instanceof Rl))return new Rl(e,t,r,n,a);this.type=e==="axial"?2:3,this.coords=t,this.colors=r,XT.call(this,n,a)}function bu(e,t,r,n,a){if(!(this instanceof bu))return new bu(e,t,r,n,a);this.boundingBox=e,this.xStep=t,this.yStep=r,this.stream="",this.cloneIndex=0,XT.call(this,n,a)}function vt(e){var t,r=typeof arguments[0]=="string"?arguments[0]:"p",n=arguments[1],a=arguments[2],i=arguments[3],s=[],o=1,l=16,c="S",u=null;tr(e=e||{})==="object"&&(r=e.orientation,n=e.unit||n,a=e.format||a,i=e.compress||e.compressPdf||i,(u=e.encryption||null)!==null&&(u.userPassword=u.userPassword||"",u.ownerPassword=u.ownerPassword||"",u.userPermissions=u.userPermissions||[]),o=typeof e.userUnit=="number"?Math.abs(e.userUnit):1,e.precision!==void 0&&(t=e.precision),e.floatPrecision!==void 0&&(l=e.floatPrecision),c=e.defaultPathOperation||"S"),s=e.filters||(i===!0?["FlateEncode"]:s),n=n||"mm",r=(""+(r||"P")).toLowerCase();var f=e.putOnlyUsedFonts||!1,d={},h={internal:{},__private__:{}};h.__private__.PubSub=F_;var g="1.3",m=h.__private__.getPdfVersion=function(){return g};h.__private__.setPdfVersion=function(S){g=S};var _={a0:[2383.94,3370.39],a1:[1683.78,2383.94],a2:[1190.55,1683.78],a3:[841.89,1190.55],a4:[595.28,841.89],a5:[419.53,595.28],a6:[297.64,419.53],a7:[209.76,297.64],a8:[147.4,209.76],a9:[104.88,147.4],a10:[73.7,104.88],b0:[2834.65,4008.19],b1:[2004.09,2834.65],b2:[1417.32,2004.09],b3:[1000.63,1417.32],b4:[708.66,1000.63],b5:[498.9,708.66],b6:[354.33,498.9],b7:[249.45,354.33],b8:[175.75,249.45],b9:[124.72,175.75],b10:[87.87,124.72],c0:[2599.37,3676.54],c1:[1836.85,2599.37],c2:[1298.27,1836.85],c3:[918.43,1298.27],c4:[649.13,918.43],c5:[459.21,649.13],c6:[323.15,459.21],c7:[229.61,323.15],c8:[161.57,229.61],c9:[113.39,161.57],c10:[79.37,113.39],dl:[311.81,623.62],letter:[612,792],"government-letter":[576,756],legal:[612,1008],"junior-legal":[576,360],ledger:[1224,792],tabloid:[792,1224],"credit-card":[153,243]};h.__private__.getPageFormats=function(){return _};var y=h.__private__.getPageFormat=function(S){return _[S]};a=a||"a4";var b={COMPAT:"compat",ADVANCED:"advanced"},w=b.COMPAT;function T(){this.saveGraphicsState(),oe(new pt(ze,0,0,-ze,0,oo()*ze).toString()+" cm"),this.setFontSize(this.getFontSize()/ze),c="n",w=b.ADVANCED}function F(){this.restoreGraphicsState(),c="S",w=b.COMPAT}var I=h.__private__.combineFontStyleAndFontWeight=function(S,U){if(S=="bold"&&U=="normal"||S=="bold"&&U==400||S=="normal"&&U=="italic"||S=="bold"&&U=="italic")throw new Error("Invalid Combination of fontweight and fontstyle");return U&&(S=U==400||U==="normal"?S==="italic"?"italic":"normal":U!=700&&U!=="bold"||S!=="normal"?(U==700?"bold":U)+""+S:"bold"),S};h.advancedAPI=function(S){var U=w===b.COMPAT;return U&&T.call(this),typeof S!="function"||(S(this),U&&F.call(this)),this},h.compatAPI=function(S){var U=w===b.ADVANCED;return U&&F.call(this),typeof S!="function"||(S(this),U&&T.call(this)),this},h.isAdvancedAPI=function(){return w===b.ADVANCED};var A,P=function(S){if(w!==b.ADVANCED)throw new Error(S+" is only available in 'advanced' API mode. You need to call advancedAPI() first.")},j=h.roundToPrecision=h.__private__.roundToPrecision=function(S,U){var he=t||U;if(isNaN(S)||isNaN(he))throw new Error("Invalid argument passed to jsPDF.roundToPrecision");return S.toFixed(he).replace(/0+$/,"")};A=h.hpf=h.__private__.hpf=typeof l=="number"?function(S){if(isNaN(S))throw new Error("Invalid argument passed to jsPDF.hpf");return j(S,l)}:l==="smart"?function(S){if(isNaN(S))throw new Error("Invalid argument passed to jsPDF.hpf");return j(S,S>-1&&S<1?16:5)}:function(S){if(isNaN(S))throw new Error("Invalid argument passed to jsPDF.hpf");return j(S,16)};var J=h.f2=h.__private__.f2=function(S){if(isNaN(S))throw new Error("Invalid argument passed to jsPDF.f2");return j(S,2)},N=h.__private__.f3=function(S){if(isNaN(S))throw new Error("Invalid argument passed to jsPDF.f3");return j(S,3)},L=h.scale=h.__private__.scale=function(S){if(isNaN(S))throw new Error("Invalid argument passed to jsPDF.scale");return w===b.COMPAT?S*ze:w===b.ADVANCED?S:void 0},G=function(S){return w===b.COMPAT?oo()-S:w===b.ADVANCED?S:void 0},W=function(S){return L(G(S))};h.__private__.setPrecision=h.setPrecision=function(S){typeof parseInt(S,10)=="number"&&(t=parseInt(S,10))};var le,de="00000000000000000000000000000000",X=h.__private__.getFileId=function(){return de},ee=h.__private__.setFileId=function(S){return de=S!==void 0&&/^[a-fA-F0-9]{32}$/.test(S)?S.toUpperCase():de.split("").map(function(){return"ABCDEF0123456789".charAt(Math.floor(16*Math.random()))}).join(""),u!==null&&(Tn=new tu(u.userPermissions,u.userPassword,u.ownerPassword,de)),de};h.setFileId=function(S){return ee(S),this},h.getFileId=function(){return X()};var R=h.__private__.convertDateToPDFDate=function(S){var U=S.getTimezoneOffset(),he=U<0?"+":"-",ge=Math.floor(Math.abs(U/60)),_e=Math.abs(U%60),Oe=[he,O(ge),"'",O(_e),"'"].join("");return["D:",S.getFullYear(),O(S.getMonth()+1),O(S.getDate()),O(S.getHours()),O(S.getMinutes()),O(S.getSeconds()),Oe].join("")},pe=h.__private__.convertPDFDateToDate=function(S){var U=parseInt(S.substr(2,4),10),he=parseInt(S.substr(6,2),10)-1,ge=parseInt(S.substr(8,2),10),_e=parseInt(S.substr(10,2),10),Oe=parseInt(S.substr(12,2),10),$e=parseInt(S.substr(14,2),10);return new Date(U,he,ge,_e,Oe,$e,0)},me=h.__private__.setCreationDate=function(S){var U;if(S===void 0&&(S=new Date),S instanceof Date)U=R(S);else{if(!/^D:(20[0-2][0-9]|203[0-7]|19[7-9][0-9])(0[0-9]|1[0-2])([0-2][0-9]|3[0-1])(0[0-9]|1[0-9]|2[0-3])(0[0-9]|[1-5][0-9])(0[0-9]|[1-5][0-9])(\+0[0-9]|\+1[0-4]|-0[0-9]|-1[0-1])'(0[0-9]|[1-5][0-9])'?$/.test(S))throw new Error("Invalid argument passed to jsPDF.setCreationDate");U=S}return le=U},E=h.__private__.getCreationDate=function(S){var U=le;return S==="jsDate"&&(U=pe(le)),U};h.setCreationDate=function(S){return me(S),this},h.getCreationDate=function(S){return E(S)};var D,O=h.__private__.padd2=function(S){return("0"+parseInt(S)).slice(-2)},M=h.__private__.padd2Hex=function(S){return("00"+(S=S.toString())).substr(S.length)},K=0,Y=[],re=[],se=0,xe=[],Ce=[],Z=!1,Ie=re,He=function(){K=0,se=0,re=[],Y=[],xe=[],te=Tr(),ne=Tr()};h.__private__.setCustomOutputDestination=function(S){Z=!0,Ie=S};var Te=function(S){Z||(Ie=S)};h.__private__.resetCustomOutputDestination=function(){Z=!1,Ie=re};var oe=h.__private__.out=function(S){return S=S.toString(),se+=S.length+1,Ie.push(S),Ie},De=h.__private__.write=function(S){return oe(arguments.length===1?S.toString():Array.prototype.join.call(arguments," "))},Xe=h.__private__.getArrayBuffer=function(S){for(var U=S.length,he=new ArrayBuffer(U),ge=new Uint8Array(he);U--;)ge[U]=S.charCodeAt(U);return he},Be=[["Helvetica","helvetica","normal","WinAnsiEncoding"],["Helvetica-Bold","helvetica","bold","WinAnsiEncoding"],["Helvetica-Oblique","helvetica","italic","WinAnsiEncoding"],["Helvetica-BoldOblique","helvetica","bolditalic","WinAnsiEncoding"],["Courier","courier","normal","WinAnsiEncoding"],["Courier-Bold","courier","bold","WinAnsiEncoding"],["Courier-Oblique","courier","italic","WinAnsiEncoding"],["Courier-BoldOblique","courier","bolditalic","WinAnsiEncoding"],["Times-Roman","times","normal","WinAnsiEncoding"],["Times-Bold","times","bold","WinAnsiEncoding"],["Times-Italic","times","italic","WinAnsiEncoding"],["Times-BoldItalic","times","bolditalic","WinAnsiEncoding"],["ZapfDingbats","zapfdingbats","normal",null],["Symbol","symbol","normal",null]];h.__private__.getStandardFonts=function(){return Be};var Ge=e.fontSize||16;h.__private__.setFontSize=h.setFontSize=function(S){return Ge=w===b.ADVANCED?S/ze:S,this};var Ye,Je=h.__private__.getFontSize=h.getFontSize=function(){return w===b.COMPAT?Ge:Ge*ze},ot=e.R2L||!1;h.__private__.setR2L=h.setR2L=function(S){return ot=S,this},h.__private__.getR2L=h.getR2L=function(){return ot};var ct,gt=h.__private__.setZoomMode=function(S){var U=[void 0,null,"fullwidth","fullheight","fullpage","original"];if(/^(?:\d+\.\d*|\d*\.\d+|\d+)%$/.test(S))Ye=S;else if(isNaN(S)){if(U.indexOf(S)===-1)throw new Error('zoom must be Integer (e.g. 2), a percentage Value (e.g. 300%) or fullwidth, fullheight, fullpage, original. "'+S+'" is not recognized.');Ye=S}else Ye=parseInt(S,10)};h.__private__.getZoomMode=function(){return Ye};var bt,It=h.__private__.setPageMode=function(S){if([void 0,null,"UseNone","UseOutlines","UseThumbs","FullScreen"].indexOf(S)==-1)throw new Error('Page mode must be one of UseNone, UseOutlines, UseThumbs, or FullScreen. "'+S+'" is not recognized.');ct=S};h.__private__.getPageMode=function(){return ct};var Et=h.__private__.setLayoutMode=function(S){if([void 0,null,"continuous","single","twoleft","tworight","two"].indexOf(S)==-1)throw new Error('Layout mode must be one of continuous, single, twoleft, tworight. "'+S+'" is not recognized.');bt=S};h.__private__.getLayoutMode=function(){return bt},h.__private__.setDisplayMode=h.setDisplayMode=function(S,U,he){return gt(S),Et(U),It(he),this};var ut={title:"",subject:"",author:"",keywords:"",creator:""};h.__private__.getDocumentProperty=function(S){if(Object.keys(ut).indexOf(S)===-1)throw new Error("Invalid argument passed to jsPDF.getDocumentProperty");return ut[S]},h.__private__.getDocumentProperties=function(){return ut},h.__private__.setDocumentProperties=h.setProperties=h.setDocumentProperties=function(S){for(var U in ut)ut.hasOwnProperty(U)&&S[U]&&(ut[U]=S[U]);return this},h.__private__.setDocumentProperty=function(S,U){if(Object.keys(ut).indexOf(S)===-1)throw new Error("Invalid arguments passed to jsPDF.setDocumentProperty");return ut[S]=U};var Ze,ze,Jt,dt,Zr,Xt={},cr={},Va=[],Vt={},Gi={},gr={},ka={},di=null,sr=0,St=[],qt=new F_(h),ys=e.hotfixes||[],en={},za={},Ha=[],pt=function S(U,he,ge,_e,Oe,$e){if(!(this instanceof S))return new S(U,he,ge,_e,Oe,$e);isNaN(U)&&(U=1),isNaN(he)&&(he=0),isNaN(ge)&&(ge=0),isNaN(_e)&&(_e=1),isNaN(Oe)&&(Oe=0),isNaN($e)&&($e=0),this._matrix=[U,he,ge,_e,Oe,$e]};Object.defineProperty(pt.prototype,"sx",{get:function(){return this._matrix[0]},set:function(S){this._matrix[0]=S}}),Object.defineProperty(pt.prototype,"shy",{get:function(){return this._matrix[1]},set:function(S){this._matrix[1]=S}}),Object.defineProperty(pt.prototype,"shx",{get:function(){return this._matrix[2]},set:function(S){this._matrix[2]=S}}),Object.defineProperty(pt.prototype,"sy",{get:function(){return this._matrix[3]},set:function(S){this._matrix[3]=S}}),Object.defineProperty(pt.prototype,"tx",{get:function(){return this._matrix[4]},set:function(S){this._matrix[4]=S}}),Object.defineProperty(pt.prototype,"ty",{get:function(){return this._matrix[5]},set:function(S){this._matrix[5]=S}}),Object.defineProperty(pt.prototype,"a",{get:function(){return this._matrix[0]},set:function(S){this._matrix[0]=S}}),Object.defineProperty(pt.prototype,"b",{get:function(){return this._matrix[1]},set:function(S){this._matrix[1]=S}}),Object.defineProperty(pt.prototype,"c",{get:function(){return this._matrix[2]},set:function(S){this._matrix[2]=S}}),Object.defineProperty(pt.prototype,"d",{get:function(){return this._matrix[3]},set:function(S){this._matrix[3]=S}}),Object.defineProperty(pt.prototype,"e",{get:function(){return this._matrix[4]},set:function(S){this._matrix[4]=S}}),Object.defineProperty(pt.prototype,"f",{get:function(){return this._matrix[5]},set:function(S){this._matrix[5]=S}}),Object.defineProperty(pt.prototype,"rotation",{get:function(){return Math.atan2(this.shx,this.sx)}}),Object.defineProperty(pt.prototype,"scaleX",{get:function(){return this.decompose().scale.sx}}),Object.defineProperty(pt.prototype,"scaleY",{get:function(){return this.decompose().scale.sy}}),Object.defineProperty(pt.prototype,"isIdentity",{get:function(){return this.sx===1&&this.shy===0&&this.shx===0&&this.sy===1&&this.tx===0&&this.ty===0}}),pt.prototype.join=function(S){return[this.sx,this.shy,this.shx,this.sy,this.tx,this.ty].map(A).join(S)},pt.prototype.multiply=function(S){var U=S.sx*this.sx+S.shy*this.shx,he=S.sx*this.shy+S.shy*this.sy,ge=S.shx*this.sx+S.sy*this.shx,_e=S.shx*this.shy+S.sy*this.sy,Oe=S.tx*this.sx+S.ty*this.shx+this.tx,$e=S.tx*this.shy+S.ty*this.sy+this.ty;return new pt(U,he,ge,_e,Oe,$e)},pt.prototype.decompose=function(){var S=this.sx,U=this.shy,he=this.shx,ge=this.sy,_e=this.tx,Oe=this.ty,$e=Math.sqrt(S*S+U*U),nt=(S/=$e)*he+(U/=$e)*ge;he-=S*nt,ge-=U*nt;var ht=Math.sqrt(he*he+ge*ge);return nt/=ht,S*(ge/=ht)<U*(he/=ht)&&(S=-S,U=-U,nt=-nt,$e=-$e),{scale:new pt($e,0,0,ht,0,0),translate:new pt(1,0,0,1,_e,Oe),rotate:new pt(S,U,-U,S,0,0),skew:new pt(1,0,nt,1,0,0)}},pt.prototype.toString=function(S){return this.join(" ")},pt.prototype.inversed=function(){var S=this.sx,U=this.shy,he=this.shx,ge=this.sy,_e=this.tx,Oe=this.ty,$e=1/(S*ge-U*he),nt=ge*$e,ht=-U*$e,Pt=-he*$e,At=S*$e;return new pt(nt,ht,Pt,At,-nt*_e-Pt*Oe,-ht*_e-At*Oe)},pt.prototype.applyToPoint=function(S){var U=S.x*this.sx+S.y*this.shx+this.tx,he=S.x*this.shy+S.y*this.sy+this.ty;return new Tc(U,he)},pt.prototype.applyToRectangle=function(S){var U=this.applyToPoint(S),he=this.applyToPoint(new Tc(S.x+S.w,S.y+S.h));return new v0(U.x,U.y,he.x-U.x,he.y-U.y)},pt.prototype.clone=function(){var S=this.sx,U=this.shy,he=this.shx,ge=this.sy,_e=this.tx,Oe=this.ty;return new pt(S,U,he,ge,_e,Oe)},h.Matrix=pt;var Ea=h.matrixMult=function(S,U){return U.multiply(S)},la=new pt(1,0,0,1,0,0);h.unitMatrix=h.identityMatrix=la;var An=function(S,U){if(!Gi[S]){var he=(U instanceof Rl?"Sh":"P")+(Object.keys(Vt).length+1).toString(10);U.id=he,Gi[S]=he,Vt[he]=U,qt.publish("addPattern",U)}};h.ShadingPattern=Rl,h.TilingPattern=bu,h.addShadingPattern=function(S,U){return P("addShadingPattern()"),An(S,U),this},h.beginTilingPattern=function(S){P("beginTilingPattern()"),ld(S.boundingBox[0],S.boundingBox[1],S.boundingBox[2]-S.boundingBox[0],S.boundingBox[3]-S.boundingBox[1],S.matrix)},h.endTilingPattern=function(S,U){P("endTilingPattern()"),U.stream=Ce[D].join(`
`),An(S,U),qt.publish("endTilingPattern",U),Ha.pop().restore()};var Ir=h.__private__.newObject=function(){var S=Tr();return z(S,!0),S},Tr=h.__private__.newObjectDeferred=function(){return K++,Y[K]=function(){return se},K},z=function(S,U){return U=typeof U=="boolean"&&U,Y[S]=se,U&&oe(S+" 0 obj"),S},ue=h.__private__.newAdditionalObject=function(){var S={objId:Tr(),content:""};return xe.push(S),S},te=Tr(),ne=Tr(),ce=h.__private__.decodeColorString=function(S){var U=S.split(" ");if(U.length!==2||U[1]!=="g"&&U[1]!=="G")U.length===5&&(U[4]==="k"||U[4]==="K")&&(U=[(1-U[0])*(1-U[3]),(1-U[1])*(1-U[3]),(1-U[2])*(1-U[3]),"r"]);else{var he=parseFloat(U[0]);U=[he,he,he,"r"]}for(var ge="#",_e=0;_e<3;_e++)ge+=("0"+Math.floor(255*parseFloat(U[_e])).toString(16)).slice(-2);return ge},fe=h.__private__.encodeColorString=function(S){var U;typeof S=="string"&&(S={ch1:S});var he=S.ch1,ge=S.ch2,_e=S.ch3,Oe=S.ch4,$e=S.pdfColorType==="draw"?["G","RG","K"]:["g","rg","k"];if(typeof he=="string"&&he.charAt(0)!=="#"){var nt=new GT(he);if(nt.ok)he=nt.toHex();else if(!/^\d*\.?\d*$/.test(he))throw new Error('Invalid color "'+he+'" passed to jsPDF.encodeColorString.')}if(typeof he=="string"&&/^#[0-9A-Fa-f]{3}$/.test(he)&&(he="#"+he[1]+he[1]+he[2]+he[2]+he[3]+he[3]),typeof he=="string"&&/^#[0-9A-Fa-f]{6}$/.test(he)){var ht=parseInt(he.substr(1),16);he=ht>>16&255,ge=ht>>8&255,_e=255&ht}if(ge===void 0||Oe===void 0&&he===ge&&ge===_e)if(typeof he=="string")U=he+" "+$e[0];else switch(S.precision){case 2:U=J(he/255)+" "+$e[0];break;case 3:default:U=N(he/255)+" "+$e[0]}else if(Oe===void 0||tr(Oe)==="object"){if(Oe&&!isNaN(Oe.a)&&Oe.a===0)return U=["1.","1.","1.",$e[1]].join(" ");if(typeof he=="string")U=[he,ge,_e,$e[1]].join(" ");else switch(S.precision){case 2:U=[J(he/255),J(ge/255),J(_e/255),$e[1]].join(" ");break;default:case 3:U=[N(he/255),N(ge/255),N(_e/255),$e[1]].join(" ")}}else if(typeof he=="string")U=[he,ge,_e,Oe,$e[2]].join(" ");else switch(S.precision){case 2:U=[J(he),J(ge),J(_e),J(Oe),$e[2]].join(" ");break;case 3:default:U=[N(he),N(ge),N(_e),N(Oe),$e[2]].join(" ")}return U},ke=h.__private__.getFilters=function(){return s},Le=h.__private__.putStream=function(S){var U=(S=S||{}).data||"",he=S.filters||ke(),ge=S.alreadyAppliedFilters||[],_e=S.addLength1||!1,Oe=U.length,$e=S.objectId,nt=function(Cn){return Cn};if(u!==null&&$e===void 0)throw new Error("ObjectId must be passed to putStream for file encryption");u!==null&&(nt=Tn.encryptor($e,0));var ht={};he===!0&&(he=["FlateEncode"]);var Pt=S.additionalKeyValues||[],At=(ht=vt.API.processDataByFilters!==void 0?vt.API.processDataByFilters(U,he):{data:U,reverseChain:[]}).reverseChain+(Array.isArray(ge)?ge.join(" "):ge.toString());if(ht.data.length!==0&&(Pt.push({key:"Length",value:ht.data.length}),_e===!0&&Pt.push({key:"Length1",value:Oe})),At.length!=0)if(At.split("/").length-1==1)Pt.push({key:"Filter",value:At});else{Pt.push({key:"Filter",value:"["+At+"]"});for(var Bt=0;Bt<Pt.length;Bt+=1)if(Pt[Bt].key==="DecodeParms"){for(var _r=[],Cr=0;Cr<ht.reverseChain.split("/").length-1;Cr+=1)_r.push("null");_r.push(Pt[Bt].value),Pt[Bt].value="["+_r.join(" ")+"]"}}oe("<<");for(var Wr=0;Wr<Pt.length;Wr++)oe("/"+Pt[Wr].key+" "+Pt[Wr].value);oe(">>"),ht.data.length!==0&&(oe("stream"),oe(nt(ht.data)),oe("endstream"))},Se=h.__private__.putPage=function(S){var U=S.number,he=S.data,ge=S.objId,_e=S.contentsObjId;z(ge,!0),oe("<</Type /Page"),oe("/Parent "+S.rootDictionaryObjId+" 0 R"),oe("/Resources "+S.resourceDictionaryObjId+" 0 R"),oe("/MediaBox ["+parseFloat(A(S.mediaBox.bottomLeftX))+" "+parseFloat(A(S.mediaBox.bottomLeftY))+" "+A(S.mediaBox.topRightX)+" "+A(S.mediaBox.topRightY)+"]"),S.cropBox!==null&&oe("/CropBox ["+A(S.cropBox.bottomLeftX)+" "+A(S.cropBox.bottomLeftY)+" "+A(S.cropBox.topRightX)+" "+A(S.cropBox.topRightY)+"]"),S.bleedBox!==null&&oe("/BleedBox ["+A(S.bleedBox.bottomLeftX)+" "+A(S.bleedBox.bottomLeftY)+" "+A(S.bleedBox.topRightX)+" "+A(S.bleedBox.topRightY)+"]"),S.trimBox!==null&&oe("/TrimBox ["+A(S.trimBox.bottomLeftX)+" "+A(S.trimBox.bottomLeftY)+" "+A(S.trimBox.topRightX)+" "+A(S.trimBox.topRightY)+"]"),S.artBox!==null&&oe("/ArtBox ["+A(S.artBox.bottomLeftX)+" "+A(S.artBox.bottomLeftY)+" "+A(S.artBox.topRightX)+" "+A(S.artBox.topRightY)+"]"),typeof S.userUnit=="number"&&S.userUnit!==1&&oe("/UserUnit "+S.userUnit),qt.publish("putPage",{objId:ge,pageContext:St[U],pageNumber:U,page:he}),oe("/Contents "+_e+" 0 R"),oe(">>"),oe("endobj");var Oe=he.join(`
`);return w===b.ADVANCED&&(Oe+=`
Q`),z(_e,!0),Le({data:Oe,filters:ke(),objectId:_e}),oe("endobj"),ge},Ne=h.__private__.putPages=function(){var S,U,he=[];for(S=1;S<=sr;S++)St[S].objId=Tr(),St[S].contentsObjId=Tr();for(S=1;S<=sr;S++)he.push(Se({number:S,data:Ce[S],objId:St[S].objId,contentsObjId:St[S].contentsObjId,mediaBox:St[S].mediaBox,cropBox:St[S].cropBox,bleedBox:St[S].bleedBox,trimBox:St[S].trimBox,artBox:St[S].artBox,userUnit:St[S].userUnit,rootDictionaryObjId:te,resourceDictionaryObjId:ne}));z(te,!0),oe("<</Type /Pages");var ge="/Kids [";for(U=0;U<sr;U++)ge+=he[U]+" 0 R ";oe(ge+"]"),oe("/Count "+sr),oe(">>"),oe("endobj"),qt.publish("postPutPages")},Pe=function(S){qt.publish("putFont",{font:S,out:oe,newObject:Ir,putStream:Le}),S.isAlreadyPutted!==!0&&(S.objectNumber=Ir(),oe("<<"),oe("/Type /Font"),oe("/BaseFont /"+ru(S.postScriptName)),oe("/Subtype /Type1"),typeof S.encoding=="string"&&oe("/Encoding /"+S.encoding),oe("/FirstChar 32"),oe("/LastChar 255"),oe(">>"),oe("endobj"))},Ve=function(){for(var S in Xt)Xt.hasOwnProperty(S)&&(f===!1||f===!0&&d.hasOwnProperty(S))&&Pe(Xt[S])},Ke=function(S){S.objectNumber=Ir();var U=[];U.push({key:"Type",value:"/XObject"}),U.push({key:"Subtype",value:"/Form"}),U.push({key:"BBox",value:"["+[A(S.x),A(S.y),A(S.x+S.width),A(S.y+S.height)].join(" ")+"]"}),U.push({key:"Matrix",value:"["+S.matrix.toString()+"]"});var he=S.pages[1].join(`
`);Le({data:he,additionalKeyValues:U,objectId:S.objectNumber}),oe("endobj")},rt=function(){for(var S in en)en.hasOwnProperty(S)&&Ke(en[S])},qe=function(S,U){var he,ge=[],_e=1/(U-1);for(he=0;he<1;he+=_e)ge.push(he);if(ge.push(1),S[0].offset!=0){var Oe={offset:0,color:S[0].color};S.unshift(Oe)}if(S[S.length-1].offset!=1){var $e={offset:1,color:S[S.length-1].color};S.push($e)}for(var nt="",ht=0,Pt=0;Pt<ge.length;Pt++){for(he=ge[Pt];he>S[ht+1].offset;)ht++;var At=S[ht].offset,Bt=(he-At)/(S[ht+1].offset-At),_r=S[ht].color,Cr=S[ht+1].color;nt+=M(Math.round((1-Bt)*_r[0]+Bt*Cr[0]).toString(16))+M(Math.round((1-Bt)*_r[1]+Bt*Cr[1]).toString(16))+M(Math.round((1-Bt)*_r[2]+Bt*Cr[2]).toString(16))}return nt.trim()},tt=function(S,U){U||(U=21);var he=Ir(),ge=qe(S.colors,U),_e=[];_e.push({key:"FunctionType",value:"0"}),_e.push({key:"Domain",value:"[0.0 1.0]"}),_e.push({key:"Size",value:"["+U+"]"}),_e.push({key:"BitsPerSample",value:"8"}),_e.push({key:"Range",value:"[0.0 1.0 0.0 1.0 0.0 1.0]"}),_e.push({key:"Decode",value:"[0.0 1.0 0.0 1.0 0.0 1.0]"}),Le({data:ge,additionalKeyValues:_e,alreadyAppliedFilters:["/ASCIIHexDecode"],objectId:he}),oe("endobj"),S.objectNumber=Ir(),oe("<< /ShadingType "+S.type),oe("/ColorSpace /DeviceRGB");var Oe="/Coords ["+A(parseFloat(S.coords[0]))+" "+A(parseFloat(S.coords[1]))+" ";S.type===2?Oe+=A(parseFloat(S.coords[2]))+" "+A(parseFloat(S.coords[3])):Oe+=A(parseFloat(S.coords[2]))+" "+A(parseFloat(S.coords[3]))+" "+A(parseFloat(S.coords[4]))+" "+A(parseFloat(S.coords[5])),oe(Oe+="]"),S.matrix&&oe("/Matrix ["+S.matrix.toString()+"]"),oe("/Function "+he+" 0 R"),oe("/Extend [true true]"),oe(">>"),oe("endobj")},_t=function(S,U){var he=Tr(),ge=Ir();U.push({resourcesOid:he,objectOid:ge}),S.objectNumber=ge;var _e=[];_e.push({key:"Type",value:"/Pattern"}),_e.push({key:"PatternType",value:"1"}),_e.push({key:"PaintType",value:"1"}),_e.push({key:"TilingType",value:"1"}),_e.push({key:"BBox",value:"["+S.boundingBox.map(A).join(" ")+"]"}),_e.push({key:"XStep",value:A(S.xStep)}),_e.push({key:"YStep",value:A(S.yStep)}),_e.push({key:"Resources",value:he+" 0 R"}),S.matrix&&_e.push({key:"Matrix",value:"["+S.matrix.toString()+"]"}),Le({data:S.stream,additionalKeyValues:_e,objectId:S.objectNumber}),oe("endobj")},Yt=function(S){var U;for(U in Vt)Vt.hasOwnProperty(U)&&(Vt[U]instanceof Rl?tt(Vt[U]):Vt[U]instanceof bu&&_t(Vt[U],S))},nr=function(S){for(var U in S.objectNumber=Ir(),oe("<<"),S)switch(U){case"opacity":oe("/ca "+J(S[U]));break;case"stroke-opacity":oe("/CA "+J(S[U]))}oe(">>"),oe("endobj")},Hr=function(){var S;for(S in gr)gr.hasOwnProperty(S)&&nr(gr[S])},pi=function(){for(var S in oe("/XObject <<"),en)en.hasOwnProperty(S)&&en[S].objectNumber>=0&&oe("/"+S+" "+en[S].objectNumber+" 0 R");qt.publish("putXobjectDict"),oe(">>")},ws=function(){Tn.oid=Ir(),oe("<<"),oe("/Filter /Standard"),oe("/V "+Tn.v),oe("/R "+Tn.r),oe("/U <"+Tn.toHexString(Tn.U)+">"),oe("/O <"+Tn.toHexString(Tn.O)+">"),oe("/P "+Tn.P),oe(">>"),oe("endobj")},Ki=function(){for(var S in oe("/Font <<"),Xt)Xt.hasOwnProperty(S)&&(f===!1||f===!0&&d.hasOwnProperty(S))&&oe("/"+S+" "+Xt[S].objectNumber+" 0 R");oe(">>")},mi=function(){if(Object.keys(Vt).length>0){for(var S in oe("/Shading <<"),Vt)Vt.hasOwnProperty(S)&&Vt[S]instanceof Rl&&Vt[S].objectNumber>=0&&oe("/"+S+" "+Vt[S].objectNumber+" 0 R");qt.publish("putShadingPatternDict"),oe(">>")}},Xi=function(S){if(Object.keys(Vt).length>0){for(var U in oe("/Pattern <<"),Vt)Vt.hasOwnProperty(U)&&Vt[U]instanceof h.TilingPattern&&Vt[U].objectNumber>=0&&Vt[U].objectNumber<S&&oe("/"+U+" "+Vt[U].objectNumber+" 0 R");qt.publish("putTilingPatternDict"),oe(">>")}},Aa=function(){if(Object.keys(gr).length>0){var S;for(S in oe("/ExtGState <<"),gr)gr.hasOwnProperty(S)&&gr[S].objectNumber>=0&&oe("/"+S+" "+gr[S].objectNumber+" 0 R");qt.publish("putGStateDict"),oe(">>")}},Dr=function(S){z(S.resourcesOid,!0),oe("<<"),oe("/ProcSet [/PDF /Text /ImageB /ImageC /ImageI]"),Ki(),mi(),Xi(S.objectOid),Aa(),pi(),oe(">>"),oe("endobj")},Gh=function(){var S=[];Ve(),Hr(),rt(),Yt(S),qt.publish("putResources"),S.forEach(Dr),Dr({resourcesOid:ne,objectOid:Number.MAX_SAFE_INTEGER}),qt.publish("postPutResources")},Kh=function(){qt.publish("putAdditionalObjects");for(var S=0;S<xe.length;S++){var U=xe[S];z(U.objId,!0),oe(U.content),oe("endobj")}qt.publish("postPutAdditionalObjects")},Xh=function(S){cr[S.fontName]=cr[S.fontName]||{},cr[S.fontName][S.fontStyle]=S.id},c0=function(S,U,he,ge,_e){var Oe={id:"F"+(Object.keys(Xt).length+1).toString(10),postScriptName:S,fontName:U,fontStyle:he,encoding:ge,isStandardFont:_e||!1,metadata:{}};return qt.publish("addFont",{font:Oe,instance:this}),Xt[Oe.id]=Oe,Xh(Oe),Oe.id},Vm=function(S){for(var U=0,he=Be.length;U<he;U++){var ge=c0.call(this,S[U][0],S[U][1],S[U][2],Be[U][3],!0);f===!1&&(d[ge]=!0);var _e=S[U][0].split("-");Xh({id:ge,fontName:_e[0],fontStyle:_e[1]||""})}qt.publish("addFonts",{fonts:Xt,dictionary:cr})},gi=function(S){return S.foo=function(){try{return S.apply(this,arguments)}catch(ge){var U=ge.stack||"";~U.indexOf(" at ")&&(U=U.split(" at ")[1]);var he="Error in function "+U.split(`
`)[0].split("<")[0]+": "+ge.message;if(!yt.console)throw new Error(he);yt.console.error(he,ge),yt.alert&&alert(he)}},S.foo.bar=S,S.foo},bc=function(S,U){var he,ge,_e,Oe,$e,nt,ht,Pt,At;if(_e=(U=U||{}).sourceEncoding||"Unicode",$e=U.outputEncoding,(U.autoencode||$e)&&Xt[Ze].metadata&&Xt[Ze].metadata[_e]&&Xt[Ze].metadata[_e].encoding&&(Oe=Xt[Ze].metadata[_e].encoding,!$e&&Xt[Ze].encoding&&($e=Xt[Ze].encoding),!$e&&Oe.codePages&&($e=Oe.codePages[0]),typeof $e=="string"&&($e=Oe[$e]),$e)){for(ht=!1,nt=[],he=0,ge=S.length;he<ge;he++)(Pt=$e[S.charCodeAt(he)])?nt.push(String.fromCharCode(Pt)):nt.push(S[he]),nt[he].charCodeAt(0)>>8&&(ht=!0);S=nt.join("")}for(he=S.length;ht===void 0&&he!==0;)S.charCodeAt(he-1)>>8&&(ht=!0),he--;if(!ht)return S;for(nt=U.noBOM?[]:[254,255],he=0,ge=S.length;he<ge;he++){if((At=(Pt=S.charCodeAt(he))>>8)>>8)throw new Error("Character at position "+he+" of string '"+S+"' exceeds 16bits. Cannot be encoded into UCS-2 BE");nt.push(At),nt.push(Pt-(At<<8))}return String.fromCharCode.apply(void 0,nt)},ca=h.__private__.pdfEscape=h.pdfEscape=function(S,U){return bc(S,U).replace(/\\/g,"\\\\").replace(/\(/g,"\\(").replace(/\)/g,"\\)")},u0=h.__private__.beginPage=function(S){Ce[++sr]=[],St[sr]={objId:0,contentsObjId:0,userUnit:Number(o),artBox:null,bleedBox:null,cropBox:null,trimBox:null,mediaBox:{bottomLeftX:0,bottomLeftY:0,topRightX:Number(S[0]),topRightY:Number(S[1])}},Jh(sr),Te(Ce[D])},Yh=function(S,U){var he,ge,_e;switch(r=U||r,typeof S=="string"&&(he=y(S.toLowerCase()),Array.isArray(he)&&(ge=he[0],_e=he[1])),Array.isArray(S)&&(ge=S[0]*ze,_e=S[1]*ze),isNaN(ge)&&(ge=a[0],_e=a[1]),(ge>14400||_e>14400)&&(lr.warn("A page in a PDF can not be wider or taller than 14400 userUnit. jsPDF limits the width/height to 14400"),ge=Math.min(14400,ge),_e=Math.min(14400,_e)),a=[ge,_e],r.substr(0,1)){case"l":_e>ge&&(a=[_e,ge]);break;case"p":ge>_e&&(a=[_e,ge])}u0(a),nd(p0),oe(xi),g0!==0&&oe(g0+" J"),x0!==0&&oe(x0+" j"),qt.publish("addPage",{pageNumber:sr})},zm=function(S){S>0&&S<=sr&&(Ce.splice(S,1),St.splice(S,1),sr--,D>sr&&(D=sr),this.setPage(D))},Jh=function(S){S>0&&S<=sr&&(D=S)},Hm=h.__private__.getNumberOfPages=h.getNumberOfPages=function(){return Ce.length-1},Qh=function(S,U,he){var ge,_e=void 0;return he=he||{},S=S!==void 0?S:Xt[Ze].fontName,U=U!==void 0?U:Xt[Ze].fontStyle,ge=S.toLowerCase(),cr[ge]!==void 0&&cr[ge][U]!==void 0?_e=cr[ge][U]:cr[S]!==void 0&&cr[S][U]!==void 0?_e=cr[S][U]:he.disableWarning===!1&&lr.warn("Unable to look up font label for font '"+S+"', '"+U+"'. Refer to getFontList() for available fonts."),_e||he.noFallback||(_e=cr.times[U])==null&&(_e=cr.times.normal),_e},Wm=h.__private__.putInfo=function(){var S=Ir(),U=function(ge){return ge};for(var he in u!==null&&(U=Tn.encryptor(S,0)),oe("<<"),oe("/Producer ("+ca(U("jsPDF "+vt.version))+")"),ut)ut.hasOwnProperty(he)&&ut[he]&&oe("/"+he.substr(0,1).toUpperCase()+he.substr(1)+" ("+ca(U(ut[he]))+")");oe("/CreationDate ("+ca(U(le))+")"),oe(">>"),oe("endobj")},f0=h.__private__.putCatalog=function(S){var U=(S=S||{}).rootDictionaryObjId||te;switch(Ir(),oe("<<"),oe("/Type /Catalog"),oe("/Pages "+U+" 0 R"),Ye||(Ye="fullwidth"),Ye){case"fullwidth":oe("/OpenAction [3 0 R /FitH null]");break;case"fullheight":oe("/OpenAction [3 0 R /FitV null]");break;case"fullpage":oe("/OpenAction [3 0 R /Fit]");break;case"original":oe("/OpenAction [3 0 R /XYZ null null 1]");break;default:var he=""+Ye;he.substr(he.length-1)==="%"&&(Ye=parseInt(Ye)/100),typeof Ye=="number"&&oe("/OpenAction [3 0 R /XYZ null null "+J(Ye)+"]")}switch(bt||(bt="continuous"),bt){case"continuous":oe("/PageLayout /OneColumn");break;case"single":oe("/PageLayout /SinglePage");break;case"two":case"twoleft":oe("/PageLayout /TwoColumnLeft");break;case"tworight":oe("/PageLayout /TwoColumnRight")}ct&&oe("/PageMode /"+ct),qt.publish("putCatalog"),oe(">>"),oe("endobj")},qm=h.__private__.putTrailer=function(){oe("trailer"),oe("<<"),oe("/Size "+(K+1)),oe("/Root "+K+" 0 R"),oe("/Info "+(K-1)+" 0 R"),u!==null&&oe("/Encrypt "+Tn.oid+" 0 R"),oe("/ID [ <"+de+"> <"+de+"> ]"),oe(">>")},Gm=h.__private__.putHeader=function(){oe("%PDF-"+g),oe("%")},Km=h.__private__.putXRef=function(){var S="0000000000";oe("xref"),oe("0 "+(K+1)),oe("0000000000 65535 f ");for(var U=1;U<=K;U++)typeof Y[U]=="function"?oe((S+Y[U]()).slice(-10)+" 00000 n "):Y[U]!==void 0?oe((S+Y[U]).slice(-10)+" 00000 n "):oe("0000000000 00000 n ")},bs=h.__private__.buildDocument=function(){He(),Te(re),qt.publish("buildDocument"),Gm(),Ne(),Kh(),Gh(),u!==null&&ws(),Wm(),f0();var S=se;return Km(),qm(),oe("startxref"),oe(""+S),oe("%%EOF"),Te(Ce[D]),re.join(`
`)},_c=h.__private__.getBlob=function(S){return new Blob([Xe(S)],{type:"application/pdf"})},Sc=h.output=h.__private__.output=gi(function(S,U){switch(typeof(U=U||{})=="string"?U={filename:U}:U.filename=U.filename||"generated.pdf",S){case void 0:return bs();case"save":h.save(U.filename);break;case"arraybuffer":return Xe(bs());case"blob":return _c(bs());case"bloburi":case"bloburl":if(yt.URL!==void 0&&typeof yt.URL.createObjectURL=="function")return yt.URL&&yt.URL.createObjectURL(_c(bs()))||void 0;lr.warn("bloburl is not supported by your system, because URL.createObjectURL is not supported by your browser.");break;case"datauristring":case"dataurlstring":var he="",ge=bs();try{he=Nv(ge)}catch{he=Nv(unescape(encodeURIComponent(ge)))}return"data:application/pdf;filename="+U.filename+";base64,"+he;case"pdfobjectnewwindow":if(Object.prototype.toString.call(yt)==="[object Window]"){var _e="https://cdnjs.cloudflare.com/ajax/libs/pdfobject/2.1.1/pdfobject.min.js",Oe=' integrity="sha512-4ze/a9/4jqu+tX9dfOqJYSvyYd5M6qum/3HpCLr+/Jqf0whc37VUbkpNGHR7/8pSnCFw47T1fmIpwBV7UySh3g==" crossorigin="anonymous"';U.pdfObjectUrl&&(_e=U.pdfObjectUrl,Oe="");var $e='<html><style>html, body { padding: 0; margin: 0; } iframe { width: 100%; height: 100%; border: 0;}  </style><body><script src="'+_e+'"'+Oe+'><\/script><script >PDFObject.embed("'+this.output("dataurlstring")+'", '+JSON.stringify(U)+");<\/script></body></html>",nt=yt.open();return nt!==null&&nt.document.write($e),nt}throw new Error("The option pdfobjectnewwindow just works in a browser-environment.");case"pdfjsnewwindow":if(Object.prototype.toString.call(yt)==="[object Window]"){var ht='<html><style>html, body { padding: 0; margin: 0; } iframe { width: 100%; height: 100%; border: 0;}  </style><body><iframe id="pdfViewer" src="'+(U.pdfJsUrl||"examples/PDF.js/web/viewer.html")+"?file=&downloadName="+U.filename+'" width="500px" height="400px" /></body></html>',Pt=yt.open();if(Pt!==null){Pt.document.write(ht);var At=this;Pt.document.documentElement.querySelector("#pdfViewer").onload=function(){Pt.document.title=U.filename,Pt.document.documentElement.querySelector("#pdfViewer").contentWindow.PDFViewerApplication.open(At.output("bloburl"))}}return Pt}throw new Error("The option pdfjsnewwindow just works in a browser-environment.");case"dataurlnewwindow":if(Object.prototype.toString.call(yt)!=="[object Window]")throw new Error("The option dataurlnewwindow just works in a browser-environment.");var Bt='<html><style>html, body { padding: 0; margin: 0; } iframe { width: 100%; height: 100%; border: 0;}  </style><body><iframe src="'+this.output("datauristring",U)+'"></iframe></body></html>',_r=yt.open();if(_r!==null&&(_r.document.write(Bt),_r.document.title=U.filename),_r||typeof safari>"u")return _r;break;case"datauri":case"dataurl":return yt.document.location.href=this.output("datauristring",U);default:return null}}),Zh=function(S){return Array.isArray(ys)===!0&&ys.indexOf(S)>-1};switch(n){case"pt":ze=1;break;case"mm":ze=72/25.4;break;case"cm":ze=72/2.54;break;case"in":ze=72;break;case"px":ze=Zh("px_scaling")==1?.75:96/72;break;case"pc":case"em":ze=12;break;case"ex":ze=6;break;default:if(typeof n!="number")throw new Error("Invalid unit: "+n);ze=n}var Tn=null;me(),ee();var Xm=function(S){return u!==null?Tn.encryptor(S,0):function(U){return U}},ed=h.__private__.getPageInfo=h.getPageInfo=function(S){if(isNaN(S)||S%1!=0)throw new Error("Invalid argument passed to jsPDF.getPageInfo");return{objId:St[S].objId,pageNumber:S,pageContext:St[S]}},kt=h.__private__.getPageInfoByObjId=function(S){if(isNaN(S)||S%1!=0)throw new Error("Invalid argument passed to jsPDF.getPageInfoByObjId");for(var U in St)if(St[U].objId===S)break;return ed(U)},Ym=h.__private__.getCurrentPageInfo=h.getCurrentPageInfo=function(){return{objId:St[D].objId,pageNumber:D,pageContext:St[D]}};h.addPage=function(){return Yh.apply(this,arguments),this},h.setPage=function(){return Jh.apply(this,arguments),Te.call(this,Ce[D]),this},h.insertPage=function(S){return this.addPage(),this.movePage(D,S),this},h.movePage=function(S,U){var he,ge;if(S>U){he=Ce[S],ge=St[S];for(var _e=S;_e>U;_e--)Ce[_e]=Ce[_e-1],St[_e]=St[_e-1];Ce[U]=he,St[U]=ge,this.setPage(U)}else if(S<U){he=Ce[S],ge=St[S];for(var Oe=S;Oe<U;Oe++)Ce[Oe]=Ce[Oe+1],St[Oe]=St[Oe+1];Ce[U]=he,St[U]=ge,this.setPage(U)}return this},h.deletePage=function(){return zm.apply(this,arguments),this},h.__private__.text=h.text=function(S,U,he,ge,_e){var Oe,$e,nt,ht,Pt,At,Bt,_r,Cr,Wr=(ge=ge||{}).scope||this;if(typeof S=="number"&&typeof U=="number"&&(typeof he=="string"||Array.isArray(he))){var Cn=he;he=U,U=S,S=Cn}if(arguments[3]instanceof pt?(P("The transform parameter of text() with a Matrix value"),Cr=_e):(nt=arguments[4],ht=arguments[5],tr(Bt=arguments[3])==="object"&&Bt!==null||(typeof nt=="string"&&(ht=nt,nt=null),typeof Bt=="string"&&(ht=Bt,Bt=null),typeof Bt=="number"&&(nt=Bt,Bt=null),ge={flags:Bt,angle:nt,align:ht})),isNaN(U)||isNaN(he)||S==null)throw new Error("Invalid arguments passed to jsPDF.text");if(S.length===0)return Wr;var cn="",vi=!1,Ta=typeof ge.lineHeightFactor=="number"?ge.lineHeightFactor:gl,Qi=Wr.internal.scaleFactor;function cd(ur){return ur=ur.split("	").join(Array(ge.TabLen||9).join(" ")),ca(ur,Bt)}function _0(ur){for(var fr,Rr=ur.concat(),tn=[],As=Rr.length;As--;)typeof(fr=Rr.shift())=="string"?tn.push(fr):Array.isArray(ur)&&(fr.length===1||fr[1]===void 0&&fr[2]===void 0)?tn.push(fr[0]):tn.push([fr[0],fr[1],fr[2]]);return tn}function S0(ur,fr){var Rr;if(typeof ur=="string")Rr=fr(ur)[0];else if(Array.isArray(ur)){for(var tn,As,L0=ur.concat(),Mc=[],pd=L0.length;pd--;)typeof(tn=L0.shift())=="string"?Mc.push(fr(tn)[0]):Array.isArray(tn)&&typeof tn[0]=="string"&&(As=fr(tn[0],tn[1],tn[2]),Mc.push([As[0],As[1],As[2]]));Rr=Mc}return Rr}var Nc=!1,k0=!0;if(typeof S=="string")Nc=!0;else if(Array.isArray(S)){var E0=S.concat();$e=[];for(var Pc,vn=E0.length;vn--;)(typeof(Pc=E0.shift())!="string"||Array.isArray(Pc)&&typeof Pc[0]!="string")&&(k0=!1);Nc=k0}if(Nc===!1)throw new Error('Type of text must be string or Array. "'+S+'" is not recognized.');typeof S=="string"&&(S=S.match(/[\r?\n]/)?S.split(/\r\n|\r|\n/g):[S]);var Lc=Ge/Wr.internal.scaleFactor,Fc=Lc*(Ta-1);switch(ge.baseline){case"bottom":he-=Fc;break;case"top":he+=Lc-Fc;break;case"hanging":he+=Lc-2*Fc;break;case"middle":he+=Lc/2-Fc}if((At=ge.maxWidth||0)>0&&(typeof S=="string"?S=Wr.splitTextToSize(S,At):Object.prototype.toString.call(S)==="[object Array]"&&(S=S.reduce(function(ur,fr){return ur.concat(Wr.splitTextToSize(fr,At))},[]))),Oe={text:S,x:U,y:he,options:ge,mutex:{pdfEscape:ca,activeFontKey:Ze,fonts:Xt,activeFontSize:Ge}},qt.publish("preProcessText",Oe),S=Oe.text,nt=(ge=Oe.options).angle,!(Cr instanceof pt)&&nt&&typeof nt=="number"){nt*=Math.PI/180,ge.rotationDirection===0&&(nt=-nt),w===b.ADVANCED&&(nt=-nt);var Oc=Math.cos(nt),A0=Math.sin(nt);Cr=new pt(Oc,A0,-A0,Oc,0,0)}else nt&&nt instanceof pt&&(Cr=nt);w!==b.ADVANCED||Cr||(Cr=la),(Pt=ge.charSpace||Ac)!==void 0&&(cn+=A(L(Pt))+` Tc
`,this.setCharSpace(this.getCharSpace()||0)),(_r=ge.horizontalScale)!==void 0&&(cn+=A(100*_r)+` Tz
`),ge.lang;var ua=-1,sg=ge.renderingMode!==void 0?ge.renderingMode:ge.stroke,T0=Wr.internal.getCurrentPageInfo().pageContext;switch(sg){case 0:case!1:case"fill":ua=0;break;case 1:case!0:case"stroke":ua=1;break;case 2:case"fillThenStroke":ua=2;break;case 3:case"invisible":ua=3;break;case 4:case"fillAndAddForClipping":ua=4;break;case 5:case"strokeAndAddPathForClipping":ua=5;break;case 6:case"fillThenStrokeAndAddToPathForClipping":ua=6;break;case 7:case"addToPathForClipping":ua=7}var ud=T0.usedRenderingMode!==void 0?T0.usedRenderingMode:-1;ua!==-1?cn+=ua+` Tr
`:ud!==-1&&(cn+=`0 Tr
`),ua!==-1&&(T0.usedRenderingMode=ua),ht=ge.align||"left";var Wa,Ic=Ge*Ta,fd=Wr.internal.pageSize.getWidth(),hd=Xt[Ze];Pt=ge.charSpace||Ac,At=ge.maxWidth||0,Bt=Object.assign({autoencode:!0,noBOM:!0},ge.flags);var lo=[],yl=function(ur){return Wr.getStringUnitWidth(ur,{font:hd,charSpace:Pt,fontSize:Ge,doKerning:!1})*Ge/Qi};if(Object.prototype.toString.call(S)==="[object Array]"){var fa;$e=_0(S),ht!=="left"&&(Wa=$e.map(yl));var Kn,co=0;if(ht==="right"){U-=Wa[0],S=[],vn=$e.length;for(var Ss=0;Ss<vn;Ss++)Ss===0?(Kn=Ji(U),fa=_s(he)):(Kn=L(co-Wa[Ss]),fa=-Ic),S.push([$e[Ss],Kn,fa]),co=Wa[Ss]}else if(ht==="center"){U-=Wa[0]/2,S=[],vn=$e.length;for(var ks=0;ks<vn;ks++)ks===0?(Kn=Ji(U),fa=_s(he)):(Kn=L((co-Wa[ks])/2),fa=-Ic),S.push([$e[ks],Kn,fa]),co=Wa[ks]}else if(ht==="left"){S=[],vn=$e.length;for(var Dc=0;Dc<vn;Dc++)S.push($e[Dc])}else if(ht==="justify"&&hd.encoding==="Identity-H"){S=[],vn=$e.length,At=At!==0?At:fd;for(var Es=0,jr=0;jr<vn;jr++)if(fa=jr===0?_s(he):-Ic,Kn=jr===0?Ji(U):Es,jr<vn-1){var C0=L((At-Wa[jr])/($e[jr].split(" ").length-1)),Xn=$e[jr].split(" ");S.push([Xn[0]+" ",Kn,fa]),Es=0;for(var qa=1;qa<Xn.length;qa++){var jc=(yl(Xn[qa-1]+" "+Xn[qa])-yl(Xn[qa]))*Qi+C0;qa==Xn.length-1?S.push([Xn[qa],jc,0]):S.push([Xn[qa]+" ",jc,0]),Es-=jc}}else S.push([$e[jr],Kn,fa]);S.push(["",Es,0])}else{if(ht!=="justify")throw new Error('Unrecognized alignment option, use "left", "center", "right" or "justify".');for(S=[],vn=$e.length,At=At!==0?At:fd,jr=0;jr<vn;jr++)fa=jr===0?_s(he):-Ic,Kn=jr===0?Ji(U):0,jr<vn-1?lo.push(A(L((At-Wa[jr])/($e[jr].split(" ").length-1)))):lo.push(0),S.push([$e[jr],Kn,fa])}}var dd=typeof ge.R2L=="boolean"?ge.R2L:ot;dd===!0&&(S=S0(S,function(ur,fr,Rr){return[ur.split("").reverse().join(""),fr,Rr]})),Oe={text:S,x:U,y:he,options:ge,mutex:{pdfEscape:ca,activeFontKey:Ze,fonts:Xt,activeFontSize:Ge}},qt.publish("postProcessText",Oe),S=Oe.text,vi=Oe.mutex.isHex||!1;var N0=Xt[Ze].encoding;N0!=="WinAnsiEncoding"&&N0!=="StandardEncoding"||(S=S0(S,function(ur,fr,Rr){return[cd(ur),fr,Rr]})),$e=_0(S),S=[];for(var wl,bl,uo,_l=0,Rc=1,Sl=Array.isArray($e[0])?Rc:_l,fo="",P0=function(ur,fr,Rr){var tn="";return Rr instanceof pt?(Rr=typeof ge.angle=="number"?Ea(Rr,new pt(1,0,0,1,ur,fr)):Ea(new pt(1,0,0,1,ur,fr),Rr),w===b.ADVANCED&&(Rr=Ea(new pt(1,0,0,-1,0,0),Rr)),tn=Rr.join(" ")+` Tm
`):tn=A(ur)+" "+A(fr)+` Td
`,tn},Ga=0;Ga<$e.length;Ga++){switch(fo="",Sl){case Rc:uo=(vi?"<":"(")+$e[Ga][0]+(vi?">":")"),wl=parseFloat($e[Ga][1]),bl=parseFloat($e[Ga][2]);break;case _l:uo=(vi?"<":"(")+$e[Ga]+(vi?">":")"),wl=Ji(U),bl=_s(he)}lo!==void 0&&lo[Ga]!==void 0&&(fo=lo[Ga]+` Tw
`),Ga===0?S.push(fo+P0(wl,bl,Cr)+uo):Sl===_l?S.push(fo+uo):Sl===Rc&&S.push(fo+P0(wl,bl,Cr)+uo)}S=Sl===_l?S.join(` Tj
T* `):S.join(` Tj
`),S+=` Tj
`;var Ka=`BT
/`;return Ka+=Ze+" "+Ge+` Tf
`,Ka+=A(Ge*Ta)+` TL
`,Ka+=xl+`
`,Ka+=cn,Ka+=S,oe(Ka+="ET"),d[Ze]=!0,Wr};var Jm=h.__private__.clip=h.clip=function(S){return oe(S==="evenodd"?"W*":"W"),this};h.clipEvenOdd=function(){return Jm("evenodd")},h.__private__.discardPath=h.discardPath=function(){return oe("n"),this};var Yi=h.__private__.isValidStyle=function(S){var U=!1;return[void 0,null,"S","D","F","DF","FD","f","f*","B","B*","n"].indexOf(S)!==-1&&(U=!0),U};h.__private__.setDefaultPathOperation=h.setDefaultPathOperation=function(S){return Yi(S)&&(c=S),this};var td=h.__private__.getStyle=h.getStyle=function(S){var U=c;switch(S){case"D":case"S":U="S";break;case"F":U="f";break;case"FD":case"DF":U="B";break;case"f":case"f*":case"B":case"B*":U=S}return U},rd=h.close=function(){return oe("h"),this};h.stroke=function(){return oe("S"),this},h.fill=function(S){return kc("f",S),this},h.fillEvenOdd=function(S){return kc("f*",S),this},h.fillStroke=function(S){return kc("B",S),this},h.fillStrokeEvenOdd=function(S){return kc("B*",S),this};var kc=function(S,U){tr(U)==="object"?Zm(U,S):oe(S)},h0=function(S){S===null||w===b.ADVANCED&&S===void 0||(S=td(S),oe(S))};function Qm(S,U,he,ge,_e){var Oe=new bu(U||this.boundingBox,he||this.xStep,ge||this.yStep,this.gState,_e||this.matrix);Oe.stream=this.stream;var $e=S+"$$"+this.cloneIndex+++"$$";return An($e,Oe),Oe}var Zm=function(S,U){var he=Gi[S.key],ge=Vt[he];if(ge instanceof Rl)oe("q"),oe(eg(U)),ge.gState&&h.setGState(ge.gState),oe(S.matrix.toString()+" cm"),oe("/"+he+" sh"),oe("Q");else if(ge instanceof bu){var _e=new pt(1,0,0,-1,0,oo());S.matrix&&(_e=_e.multiply(S.matrix||la),he=Qm.call(ge,S.key,S.boundingBox,S.xStep,S.yStep,_e).id),oe("q"),oe("/Pattern cs"),oe("/"+he+" scn"),ge.gState&&h.setGState(ge.gState),oe(U),oe("Q")}},eg=function(S){switch(S){case"f":case"F":return"W n";case"f*":return"W* n";case"B":return"W S";case"B*":return"W* S";case"S":return"W S";case"n":return"W n"}},d0=h.moveTo=function(S,U){return oe(A(L(S))+" "+A(W(U))+" m"),this},ml=h.lineTo=function(S,U){return oe(A(L(S))+" "+A(W(U))+" l"),this},io=h.curveTo=function(S,U,he,ge,_e,Oe){return oe([A(L(S)),A(W(U)),A(L(he)),A(W(ge)),A(L(_e)),A(W(Oe)),"c"].join(" ")),this};h.__private__.line=h.line=function(S,U,he,ge,_e){if(isNaN(S)||isNaN(U)||isNaN(he)||isNaN(ge)||!Yi(_e))throw new Error("Invalid arguments passed to jsPDF.line");return w===b.COMPAT?this.lines([[he-S,ge-U]],S,U,[1,1],_e||"S"):this.lines([[he-S,ge-U]],S,U,[1,1]).stroke()},h.__private__.lines=h.lines=function(S,U,he,ge,_e,Oe){var $e,nt,ht,Pt,At,Bt,_r,Cr,Wr,Cn,cn,vi;if(typeof S=="number"&&(vi=he,he=U,U=S,S=vi),ge=ge||[1,1],Oe=Oe||!1,isNaN(U)||isNaN(he)||!Array.isArray(S)||!Array.isArray(ge)||!Yi(_e)||typeof Oe!="boolean")throw new Error("Invalid arguments passed to jsPDF.lines");for(d0(U,he),$e=ge[0],nt=ge[1],Pt=S.length,Cn=U,cn=he,ht=0;ht<Pt;ht++)(At=S[ht]).length===2?(Cn=At[0]*$e+Cn,cn=At[1]*nt+cn,ml(Cn,cn)):(Bt=At[0]*$e+Cn,_r=At[1]*nt+cn,Cr=At[2]*$e+Cn,Wr=At[3]*nt+cn,Cn=At[4]*$e+Cn,cn=At[5]*nt+cn,io(Bt,_r,Cr,Wr,Cn,cn));return Oe&&rd(),h0(_e),this},h.path=function(S){for(var U=0;U<S.length;U++){var he=S[U],ge=he.c;switch(he.op){case"m":d0(ge[0],ge[1]);break;case"l":ml(ge[0],ge[1]);break;case"c":io.apply(this,ge);break;case"h":rd()}}return this},h.__private__.rect=h.rect=function(S,U,he,ge,_e){if(isNaN(S)||isNaN(U)||isNaN(he)||isNaN(ge)||!Yi(_e))throw new Error("Invalid arguments passed to jsPDF.rect");return w===b.COMPAT&&(ge=-ge),oe([A(L(S)),A(W(U)),A(L(he)),A(L(ge)),"re"].join(" ")),h0(_e),this},h.__private__.triangle=h.triangle=function(S,U,he,ge,_e,Oe,$e){if(isNaN(S)||isNaN(U)||isNaN(he)||isNaN(ge)||isNaN(_e)||isNaN(Oe)||!Yi($e))throw new Error("Invalid arguments passed to jsPDF.triangle");return this.lines([[he-S,ge-U],[_e-he,Oe-ge],[S-_e,U-Oe]],S,U,[1,1],$e,!0),this},h.__private__.roundedRect=h.roundedRect=function(S,U,he,ge,_e,Oe,$e){if(isNaN(S)||isNaN(U)||isNaN(he)||isNaN(ge)||isNaN(_e)||isNaN(Oe)||!Yi($e))throw new Error("Invalid arguments passed to jsPDF.roundedRect");var nt=4/3*(Math.SQRT2-1);return _e=Math.min(_e,.5*he),Oe=Math.min(Oe,.5*ge),this.lines([[he-2*_e,0],[_e*nt,0,_e,Oe-Oe*nt,_e,Oe],[0,ge-2*Oe],[0,Oe*nt,-_e*nt,Oe,-_e,Oe],[2*_e-he,0],[-_e*nt,0,-_e,-Oe*nt,-_e,-Oe],[0,2*Oe-ge],[0,-Oe*nt,_e*nt,-Oe,_e,-Oe]],S+_e,U,[1,1],$e,!0),this},h.__private__.ellipse=h.ellipse=function(S,U,he,ge,_e){if(isNaN(S)||isNaN(U)||isNaN(he)||isNaN(ge)||!Yi(_e))throw new Error("Invalid arguments passed to jsPDF.ellipse");var Oe=4/3*(Math.SQRT2-1)*he,$e=4/3*(Math.SQRT2-1)*ge;return d0(S+he,U),io(S+he,U-$e,S+Oe,U-ge,S,U-ge),io(S-Oe,U-ge,S-he,U-$e,S-he,U),io(S-he,U+$e,S-Oe,U+ge,S,U+ge),io(S+Oe,U+ge,S+he,U+$e,S+he,U),h0(_e),this},h.__private__.circle=h.circle=function(S,U,he,ge){if(isNaN(S)||isNaN(U)||isNaN(he)||!Yi(ge))throw new Error("Invalid arguments passed to jsPDF.circle");return this.ellipse(S,U,he,he,ge)},h.setFont=function(S,U,he){return he&&(U=I(U,he)),Ze=Qh(S,U,{disableWarning:!1}),this};var tg=h.__private__.getFont=h.getFont=function(){return Xt[Qh.apply(h,arguments)]};h.__private__.getFontList=h.getFontList=function(){var S,U,he={};for(S in cr)if(cr.hasOwnProperty(S))for(U in he[S]=[],cr[S])cr[S].hasOwnProperty(U)&&he[S].push(U);return he},h.addFont=function(S,U,he,ge,_e){var Oe=["StandardEncoding","MacRomanEncoding","Identity-H","WinAnsiEncoding"];return arguments[3]&&Oe.indexOf(arguments[3])!==-1?_e=arguments[3]:arguments[3]&&Oe.indexOf(arguments[3])==-1&&(he=I(he,ge)),_e=_e||"Identity-H",c0.call(this,S,U,he,_e)};var gl,p0=e.lineWidth||.200025,Ec=h.__private__.getLineWidth=h.getLineWidth=function(){return p0},nd=h.__private__.setLineWidth=h.setLineWidth=function(S){return p0=S,oe(A(L(S))+" w"),this};h.__private__.setLineDash=vt.API.setLineDash=vt.API.setLineDashPattern=function(S,U){if(S=S||[],U=U||0,isNaN(U)||!Array.isArray(S))throw new Error("Invalid arguments passed to jsPDF.setLineDash");return S=S.map(function(he){return A(L(he))}).join(" "),U=A(L(U)),oe("["+S+"] "+U+" d"),this};var ad=h.__private__.getLineHeight=h.getLineHeight=function(){return Ge*gl};h.__private__.getLineHeight=h.getLineHeight=function(){return Ge*gl};var id=h.__private__.setLineHeightFactor=h.setLineHeightFactor=function(S){return typeof(S=S||1.15)=="number"&&(gl=S),this},sd=h.__private__.getLineHeightFactor=h.getLineHeightFactor=function(){return gl};id(e.lineHeight);var Ji=h.__private__.getHorizontalCoordinate=function(S){return L(S)},_s=h.__private__.getVerticalCoordinate=function(S){return w===b.ADVANCED?S:St[D].mediaBox.topRightY-St[D].mediaBox.bottomLeftY-L(S)},rg=h.__private__.getHorizontalCoordinateString=h.getHorizontalCoordinateString=function(S){return A(Ji(S))},so=h.__private__.getVerticalCoordinateString=h.getVerticalCoordinateString=function(S){return A(_s(S))},xi=e.strokeColor||"0 G";h.__private__.getStrokeColor=h.getDrawColor=function(){return ce(xi)},h.__private__.setStrokeColor=h.setDrawColor=function(S,U,he,ge){return xi=fe({ch1:S,ch2:U,ch3:he,ch4:ge,pdfColorType:"draw",precision:2}),oe(xi),this};var m0=e.fillColor||"0 g";h.__private__.getFillColor=h.getFillColor=function(){return ce(m0)},h.__private__.setFillColor=h.setFillColor=function(S,U,he,ge){return m0=fe({ch1:S,ch2:U,ch3:he,ch4:ge,pdfColorType:"fill",precision:2}),oe(m0),this};var xl=e.textColor||"0 g",ng=h.__private__.getTextColor=h.getTextColor=function(){return ce(xl)};h.__private__.setTextColor=h.setTextColor=function(S,U,he,ge){return xl=fe({ch1:S,ch2:U,ch3:he,ch4:ge,pdfColorType:"text",precision:3}),this};var Ac=e.charSpace,ag=h.__private__.getCharSpace=h.getCharSpace=function(){return parseFloat(Ac||0)};h.__private__.setCharSpace=h.setCharSpace=function(S){if(isNaN(S))throw new Error("Invalid argument passed to jsPDF.setCharSpace");return Ac=S,this};var g0=0;h.CapJoinStyles={0:0,butt:0,but:0,miter:0,1:1,round:1,rounded:1,circle:1,2:2,projecting:2,project:2,square:2,bevel:2},h.__private__.setLineCap=h.setLineCap=function(S){var U=h.CapJoinStyles[S];if(U===void 0)throw new Error("Line cap style of '"+S+"' is not recognized. See or extend .CapJoinStyles property for valid styles");return g0=U,oe(U+" J"),this};var x0=0;h.__private__.setLineJoin=h.setLineJoin=function(S){var U=h.CapJoinStyles[S];if(U===void 0)throw new Error("Line join style of '"+S+"' is not recognized. See or extend .CapJoinStyles property for valid styles");return x0=U,oe(U+" j"),this},h.__private__.setLineMiterLimit=h.__private__.setMiterLimit=h.setLineMiterLimit=h.setMiterLimit=function(S){if(S=S||0,isNaN(S))throw new Error("Invalid argument passed to jsPDF.setLineMiterLimit");return oe(A(L(S))+" M"),this},h.GState=z1,h.setGState=function(S){(S=typeof S=="string"?gr[ka[S]]:od(null,S)).equals(di)||(oe("/"+S.id+" gs"),di=S)};var od=function(S,U){if(!S||!ka[S]){var he=!1;for(var ge in gr)if(gr.hasOwnProperty(ge)&&gr[ge].equals(U)){he=!0;break}if(he)U=gr[ge];else{var _e="GS"+(Object.keys(gr).length+1).toString(10);gr[_e]=U,U.id=_e}return S&&(ka[S]=U.id),qt.publish("addGState",U),U}};h.addGState=function(S,U){return od(S,U),this},h.saveGraphicsState=function(){return oe("q"),Va.push({key:Ze,size:Ge,color:xl}),this},h.restoreGraphicsState=function(){oe("Q");var S=Va.pop();return Ze=S.key,Ge=S.size,xl=S.color,di=null,this},h.setCurrentTransformationMatrix=function(S){return oe(S.toString()+" cm"),this},h.comment=function(S){return oe("#"+S),this};var Tc=function(S,U){var he=S||0;Object.defineProperty(this,"x",{enumerable:!0,get:function(){return he},set:function(Oe){isNaN(Oe)||(he=parseFloat(Oe))}});var ge=U||0;Object.defineProperty(this,"y",{enumerable:!0,get:function(){return ge},set:function(Oe){isNaN(Oe)||(ge=parseFloat(Oe))}});var _e="pt";return Object.defineProperty(this,"type",{enumerable:!0,get:function(){return _e},set:function(Oe){_e=Oe.toString()}}),this},v0=function(S,U,he,ge){Tc.call(this,S,U),this.type="rect";var _e=he||0;Object.defineProperty(this,"w",{enumerable:!0,get:function(){return _e},set:function($e){isNaN($e)||(_e=parseFloat($e))}});var Oe=ge||0;return Object.defineProperty(this,"h",{enumerable:!0,get:function(){return Oe},set:function($e){isNaN($e)||(Oe=parseFloat($e))}}),this},y0=function(){this.page=sr,this.currentPage=D,this.pages=Ce.slice(0),this.pagesContext=St.slice(0),this.x=Jt,this.y=dt,this.matrix=Zr,this.width=vl(D),this.height=oo(D),this.outputDestination=Ie,this.id="",this.objectNumber=-1};y0.prototype.restore=function(){sr=this.page,D=this.currentPage,St=this.pagesContext,Ce=this.pages,Jt=this.x,dt=this.y,Zr=this.matrix,w0(D,this.width),b0(D,this.height),Ie=this.outputDestination};var ld=function(S,U,he,ge,_e){Ha.push(new y0),sr=D=0,Ce=[],Jt=S,dt=U,Zr=_e,u0([he,ge])},ig=function(S){if(za[S])Ha.pop().restore();else{var U=new y0,he="Xo"+(Object.keys(en).length+1).toString(10);U.id=he,za[S]=he,en[he]=U,qt.publish("addFormObject",U),Ha.pop().restore()}};for(var Cc in h.beginFormObject=function(S,U,he,ge,_e){return ld(S,U,he,ge,_e),this},h.endFormObject=function(S){return ig(S),this},h.doFormObject=function(S,U){var he=en[za[S]];return oe("q"),oe(U.toString()+" cm"),oe("/"+he.id+" Do"),oe("Q"),this},h.getFormObject=function(S){var U=en[za[S]];return{x:U.x,y:U.y,width:U.width,height:U.height,matrix:U.matrix}},h.save=function(S,U){return S=S||"generated.pdf",(U=U||{}).returnPromise=U.returnPromise||!1,U.returnPromise===!1?(Il(_c(bs()),S),typeof Il.unload=="function"&&yt.setTimeout&&setTimeout(Il.unload,911),this):new Promise(function(he,ge){try{var _e=Il(_c(bs()),S);typeof Il.unload=="function"&&yt.setTimeout&&setTimeout(Il.unload,911),he(_e)}catch(Oe){ge(Oe.message)}})},vt.API)vt.API.hasOwnProperty(Cc)&&(Cc==="events"&&vt.API.events.length?function(S,U){var he,ge,_e;for(_e=U.length-1;_e!==-1;_e--)he=U[_e][0],ge=U[_e][1],S.subscribe.apply(S,[he].concat(typeof ge=="function"?[ge]:ge))}(qt,vt.API.events):h[Cc]=vt.API[Cc]);var vl=h.getPageWidth=function(S){return(St[S=S||D].mediaBox.topRightX-St[S].mediaBox.bottomLeftX)/ze},w0=h.setPageWidth=function(S,U){St[S].mediaBox.topRightX=U*ze+St[S].mediaBox.bottomLeftX},oo=h.getPageHeight=function(S){return(St[S=S||D].mediaBox.topRightY-St[S].mediaBox.bottomLeftY)/ze},b0=h.setPageHeight=function(S,U){St[S].mediaBox.topRightY=U*ze+St[S].mediaBox.bottomLeftY};return h.internal={pdfEscape:ca,getStyle:td,getFont:tg,getFontSize:Je,getCharSpace:ag,getTextColor:ng,getLineHeight:ad,getLineHeightFactor:sd,getLineWidth:Ec,write:De,getHorizontalCoordinate:Ji,getVerticalCoordinate:_s,getCoordinateString:rg,getVerticalCoordinateString:so,collections:{},newObject:Ir,newAdditionalObject:ue,newObjectDeferred:Tr,newObjectDeferredBegin:z,getFilters:ke,putStream:Le,events:qt,scaleFactor:ze,pageSize:{getWidth:function(){return vl(D)},setWidth:function(S){w0(D,S)},getHeight:function(){return oo(D)},setHeight:function(S){b0(D,S)}},encryptionOptions:u,encryption:Tn,getEncryptor:Xm,output:Sc,getNumberOfPages:Hm,pages:Ce,out:oe,f2:J,f3:N,getPageInfo:ed,getPageInfoByObjId:kt,getCurrentPageInfo:Ym,getPDFVersion:m,Point:Tc,Rectangle:v0,Matrix:pt,hasHotfix:Zh},Object.defineProperty(h.internal.pageSize,"width",{get:function(){return vl(D)},set:function(S){w0(D,S)},enumerable:!0,configurable:!0}),Object.defineProperty(h.internal.pageSize,"height",{get:function(){return oo(D)},set:function(S){b0(D,S)},enumerable:!0,configurable:!0}),Vm.call(h,Be),Ze="F1",Yh(a,r),qt.publish("initialized"),h}tu.prototype.lsbFirstWord=function(e){return String.fromCharCode(e>>0&255,e>>8&255,e>>16&255,e>>24&255)},tu.prototype.toHexString=function(e){return e.split("").map(function(t){return("0"+(255&t.charCodeAt(0)).toString(16)).slice(-2)}).join("")},tu.prototype.hexToBytes=function(e){for(var t=[],r=0;r<e.length;r+=2)t.push(String.fromCharCode(parseInt(e.substr(r,2),16)));return t.join("")},tu.prototype.processOwnerPassword=function(e,t){return Lv(Pv(t).substr(0,5),e)},tu.prototype.encryptor=function(e,t){var r=Pv(this.encryptionKey+String.fromCharCode(255&e,e>>8&255,e>>16&255,255&t,t>>8&255)).substr(0,10);return function(n){return Lv(r,n)}},z1.prototype.equals=function(e){var t,r="id,objectNumber,equals";if(!e||tr(e)!==tr(this))return!1;var n=0;for(t in this)if(!(r.indexOf(t)>=0)){if(this.hasOwnProperty(t)&&!e.hasOwnProperty(t)||this[t]!==e[t])return!1;n++}for(t in e)e.hasOwnProperty(t)&&r.indexOf(t)<0&&n--;return n===0},vt.API={events:[]},vt.version="3.0.1";var Pr=vt.API,K5=1,wc=function(e){return e.replace(/\\/g,"\\\\").replace(/\(/g,"\\(").replace(/\)/g,"\\)")},Yc=function(e){return e.replace(/\\\\/g,"\\").replace(/\\\(/g,"(").replace(/\\\)/g,")")},Ct=function(e){return e.toFixed(2)},ko=function(e){return e.toFixed(5)};Pr.__acroform__={};var Sa=function(e,t){e.prototype=Object.create(t.prototype),e.prototype.constructor=e},O_=function(e){return e*K5},ns=function(e){var t=new JT,r=lt.internal.getHeight(e)||0,n=lt.internal.getWidth(e)||0;return t.BBox=[0,0,Number(Ct(n)),Number(Ct(r))],t},rY=Pr.__acroform__.setBit=function(e,t){if(e=e||0,t=t||0,isNaN(e)||isNaN(t))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.setBit");return e|=1<<t},nY=Pr.__acroform__.clearBit=function(e,t){if(e=e||0,t=t||0,isNaN(e)||isNaN(t))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.clearBit");return e&=~(1<<t)},aY=Pr.__acroform__.getBit=function(e,t){if(isNaN(e)||isNaN(t))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.getBit");return e&1<<t?1:0},Ur=Pr.__acroform__.getBitForPdf=function(e,t){if(isNaN(e)||isNaN(t))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.getBitForPdf");return aY(e,t-1)},$r=Pr.__acroform__.setBitForPdf=function(e,t){if(isNaN(e)||isNaN(t))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.setBitForPdf");return rY(e,t-1)},Vr=Pr.__acroform__.clearBitForPdf=function(e,t){if(isNaN(e)||isNaN(t))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.clearBitForPdf");return nY(e,t-1)},iY=Pr.__acroform__.calculateCoordinates=function(e,t){var r=t.internal.getHorizontalCoordinate,n=t.internal.getVerticalCoordinate,a=e[0],i=e[1],s=e[2],o=e[3],l={};return l.lowerLeft_X=r(a)||0,l.lowerLeft_Y=n(i+o)||0,l.upperRight_X=r(a+s)||0,l.upperRight_Y=n(i)||0,[Number(Ct(l.lowerLeft_X)),Number(Ct(l.lowerLeft_Y)),Number(Ct(l.upperRight_X)),Number(Ct(l.upperRight_Y))]},sY=function(e){if(e.appearanceStreamContent)return e.appearanceStreamContent;if(e.V||e.DV){var t=[],r=e._V||e.DV,n=Fv(e,r),a=e.scope.internal.getFont(e.fontName,e.fontStyle).id;t.push("/Tx BMC"),t.push("q"),t.push("BT"),t.push(e.scope.__private__.encodeColorString(e.color)),t.push("/"+a+" "+Ct(n.fontSize)+" Tf"),t.push("1 0 0 1 0 0 Tm"),t.push(n.text),t.push("ET"),t.push("Q"),t.push("EMC");var i=ns(e);return i.scope=e.scope,i.stream=t.join(`
`),i}},Fv=function(e,t){var r=e.fontSize===0?e.maxFontSize:e.fontSize,n={text:"",fontSize:""},a=(t=(t=t.substr(0,1)=="("?t.substr(1):t).substr(t.length-1)==")"?t.substr(0,t.length-1):t).split(" ");a=e.multiline?a.map(function(N){return N.split(`
`)}):a.map(function(N){return[N]});var i=r,s=lt.internal.getHeight(e)||0;s=s<0?-s:s;var o=lt.internal.getWidth(e)||0;o=o<0?-o:o;var l=function(N,L,G){if(N+1<a.length){var W=L+" "+a[N+1][0];return bp(W,e,G).width<=o-4}return!1};i++;e:for(;i>0;){t="",i--;var c,u,f=bp("3",e,i).height,d=e.multiline?s-i:(s-f)/2,h=d+=2,g=0,m=0,_=0;if(i<=0){t=`(...) Tj
`,t+="% Width of Text: "+bp(t,e,i=12).width+", FieldWidth:"+o+`
`;break}for(var y="",b=0,w=0;w<a.length;w++)if(a.hasOwnProperty(w)){var T=!1;if(a[w].length!==1&&_!==a[w].length-1){if((f+2)*(b+2)+2>s)continue e;y+=a[w][_],T=!0,m=w,w--}else{y=(y+=a[w][_]+" ").substr(y.length-1)==" "?y.substr(0,y.length-1):y;var F=parseInt(w),I=l(F,y,i),A=w>=a.length-1;if(I&&!A){y+=" ",_=0;continue}if(I||A){if(A)m=F;else if(e.multiline&&(f+2)*(b+2)+2>s)continue e}else{if(!e.multiline||(f+2)*(b+2)+2>s)continue e;m=F}}for(var P="",j=g;j<=m;j++){var J=a[j];if(e.multiline){if(j===m){P+=J[_]+" ",_=(_+1)%J.length;continue}if(j===g){P+=J[J.length-1]+" ";continue}}P+=J[0]+" "}switch(P=P.substr(P.length-1)==" "?P.substr(0,P.length-1):P,u=bp(P,e,i).width,e.textAlign){case"right":c=o-u-2;break;case"center":c=(o-u)/2;break;case"left":default:c=2}t+=Ct(c)+" "+Ct(h)+` Td
`,t+="("+wc(P)+`) Tj
`,t+=-Ct(c)+` 0 Td
`,h=-(i+2),u=0,g=T?m:m+1,b++,y=""}break}return n.text=t,n.fontSize=i,n},bp=function(e,t,r){var n=t.scope.internal.getFont(t.fontName,t.fontStyle),a=t.scope.getStringUnitWidth(e,{font:n,fontSize:parseFloat(r),charSpace:0})*parseFloat(r);return{height:t.scope.getStringUnitWidth("3",{font:n,fontSize:parseFloat(r),charSpace:0})*parseFloat(r)*1.5,width:a}},oY={fields:[],xForms:[],acroFormDictionaryRoot:null,printedOut:!1,internal:null,isInitialized:!1},lY=function(e,t){var r={type:"reference",object:e};t.internal.getPageInfo(e.page).pageContext.annotations.find(function(n){return n.type===r.type&&n.object===r.object})===void 0&&t.internal.getPageInfo(e.page).pageContext.annotations.push(r)},cY=function(e,t){for(var r in e)if(e.hasOwnProperty(r)){var n=r,a=e[r];t.internal.newObjectDeferredBegin(a.objId,!0),tr(a)==="object"&&typeof a.putStream=="function"&&a.putStream(),delete e[n]}},uY=function(e,t){if(t.scope=e,e.internal!==void 0&&(e.internal.acroformPlugin===void 0||e.internal.acroformPlugin.isInitialized===!1)){if(Wi.FieldNum=0,e.internal.acroformPlugin=JSON.parse(JSON.stringify(oY)),e.internal.acroformPlugin.acroFormDictionaryRoot)throw new Error("Exception while creating AcroformDictionary");K5=e.internal.scaleFactor,e.internal.acroformPlugin.acroFormDictionaryRoot=new QT,e.internal.acroformPlugin.acroFormDictionaryRoot.scope=e,e.internal.acroformPlugin.acroFormDictionaryRoot._eventID=e.internal.events.subscribe("postPutResources",function(){(function(r){r.internal.events.unsubscribe(r.internal.acroformPlugin.acroFormDictionaryRoot._eventID),delete r.internal.acroformPlugin.acroFormDictionaryRoot._eventID,r.internal.acroformPlugin.printedOut=!0})(e)}),e.internal.events.subscribe("buildDocument",function(){(function(r){r.internal.acroformPlugin.acroFormDictionaryRoot.objId=void 0;var n=r.internal.acroformPlugin.acroFormDictionaryRoot.Fields;for(var a in n)if(n.hasOwnProperty(a)){var i=n[a];i.objId=void 0,i.hasAnnotation&&lY(i,r)}})(e)}),e.internal.events.subscribe("putCatalog",function(){(function(r){if(r.internal.acroformPlugin.acroFormDictionaryRoot===void 0)throw new Error("putCatalogCallback: Root missing.");r.internal.write("/AcroForm "+r.internal.acroformPlugin.acroFormDictionaryRoot.objId+" 0 R")})(e)}),e.internal.events.subscribe("postPutPages",function(r){(function(n,a){var i=!n;for(var s in n||(a.internal.newObjectDeferredBegin(a.internal.acroformPlugin.acroFormDictionaryRoot.objId,!0),a.internal.acroformPlugin.acroFormDictionaryRoot.putStream()),n=n||a.internal.acroformPlugin.acroFormDictionaryRoot.Kids)if(n.hasOwnProperty(s)){var o=n[s],l=[],c=o.Rect;if(o.Rect&&(o.Rect=iY(o.Rect,a)),a.internal.newObjectDeferredBegin(o.objId,!0),o.DA=lt.createDefaultAppearanceStream(o),tr(o)==="object"&&typeof o.getKeyValueListForStream=="function"&&(l=o.getKeyValueListForStream()),o.Rect=c,o.hasAppearanceStream&&!o.appearanceStreamContent){var u=sY(o);l.push({key:"AP",value:"<</N "+u+">>"}),a.internal.acroformPlugin.xForms.push(u)}if(o.appearanceStreamContent){var f="";for(var d in o.appearanceStreamContent)if(o.appearanceStreamContent.hasOwnProperty(d)){var h=o.appearanceStreamContent[d];if(f+="/"+d+" ",f+="<<",Object.keys(h).length>=1||Array.isArray(h)){for(var s in h)if(h.hasOwnProperty(s)){var g=h[s];typeof g=="function"&&(g=g.call(a,o)),f+="/"+s+" "+g+" ",a.internal.acroformPlugin.xForms.indexOf(g)>=0||a.internal.acroformPlugin.xForms.push(g)}}else typeof(g=h)=="function"&&(g=g.call(a,o)),f+="/"+s+" "+g,a.internal.acroformPlugin.xForms.indexOf(g)>=0||a.internal.acroformPlugin.xForms.push(g);f+=">>"}l.push({key:"AP",value:`<<
`+f+">>"})}a.internal.putStream({additionalKeyValues:l,objectId:o.objId}),a.internal.out("endobj")}i&&cY(a.internal.acroformPlugin.xForms,a)})(r,e)}),e.internal.acroformPlugin.isInitialized=!0}},YT=Pr.__acroform__.arrayToPdfArray=function(e,t,r){var n=function(s){return s};if(Array.isArray(e)){for(var a="[",i=0;i<e.length;i++)switch(i!==0&&(a+=" "),tr(e[i])){case"boolean":case"number":case"object":a+=e[i].toString();break;case"string":e[i].substr(0,1)!=="/"?(t!==void 0&&r&&(n=r.internal.getEncryptor(t)),a+="("+wc(n(e[i].toString()))+")"):a+=e[i].toString()}return a+="]"}throw new Error("Invalid argument passed to jsPDF.__acroform__.arrayToPdfArray")},D2=function(e,t,r){var n=function(a){return a};return t!==void 0&&r&&(n=r.internal.getEncryptor(t)),(e=e||"").toString(),e="("+wc(n(e))+")"},os=function(){this._objId=void 0,this._scope=void 0,Object.defineProperty(this,"objId",{get:function(){if(this._objId===void 0){if(this.scope===void 0)return;this._objId=this.scope.internal.newObjectDeferred()}return this._objId},set:function(e){this._objId=e}}),Object.defineProperty(this,"scope",{value:this._scope,writable:!0})};os.prototype.toString=function(){return this.objId+" 0 R"},os.prototype.putStream=function(){var e=this.getKeyValueListForStream();this.scope.internal.putStream({data:this.stream,additionalKeyValues:e,objectId:this.objId}),this.scope.internal.out("endobj")},os.prototype.getKeyValueListForStream=function(){var e=[],t=Object.getOwnPropertyNames(this).filter(function(i){return i!="content"&&i!="appearanceStreamContent"&&i!="scope"&&i!="objId"&&i.substring(0,1)!="_"});for(var r in t)if(Object.getOwnPropertyDescriptor(this,t[r]).configurable===!1){var n=t[r],a=this[n];a&&(Array.isArray(a)?e.push({key:n,value:YT(a,this.objId,this.scope)}):a instanceof os?(a.scope=this.scope,e.push({key:n,value:a.objId+" 0 R"})):typeof a!="function"&&e.push({key:n,value:a}))}return e};var JT=function(){os.call(this),Object.defineProperty(this,"Type",{value:"/XObject",configurable:!1,writable:!0}),Object.defineProperty(this,"Subtype",{value:"/Form",configurable:!1,writable:!0}),Object.defineProperty(this,"FormType",{value:1,configurable:!1,writable:!0});var e,t=[];Object.defineProperty(this,"BBox",{configurable:!1,get:function(){return t},set:function(r){t=r}}),Object.defineProperty(this,"Resources",{value:"2 0 R",configurable:!1,writable:!0}),Object.defineProperty(this,"stream",{enumerable:!1,configurable:!0,set:function(r){e=r.trim()},get:function(){return e||null}})};Sa(JT,os);var QT=function(){os.call(this);var e,t=[];Object.defineProperty(this,"Kids",{enumerable:!1,configurable:!0,get:function(){return t.length>0?t:void 0}}),Object.defineProperty(this,"Fields",{enumerable:!1,configurable:!1,get:function(){return t}}),Object.defineProperty(this,"DA",{enumerable:!1,configurable:!1,get:function(){if(e){var r=function(n){return n};return this.scope&&(r=this.scope.internal.getEncryptor(this.objId)),"("+wc(r(e))+")"}},set:function(r){e=r}})};Sa(QT,os);var Wi=function e(){os.call(this);var t=4;Object.defineProperty(this,"F",{enumerable:!1,configurable:!1,get:function(){return t},set:function(y){if(isNaN(y))throw new Error('Invalid value "'+y+'" for attribute F supplied.');t=y}}),Object.defineProperty(this,"showWhenPrinted",{enumerable:!0,configurable:!0,get:function(){return!!Ur(t,3)},set:function(y){y?this.F=$r(t,3):this.F=Vr(t,3)}});var r=0;Object.defineProperty(this,"Ff",{enumerable:!1,configurable:!1,get:function(){return r},set:function(y){if(isNaN(y))throw new Error('Invalid value "'+y+'" for attribute Ff supplied.');r=y}});var n=[];Object.defineProperty(this,"Rect",{enumerable:!1,configurable:!1,get:function(){if(n.length!==0)return n},set:function(y){n=y!==void 0?y:[]}}),Object.defineProperty(this,"x",{enumerable:!0,configurable:!0,get:function(){return!n||isNaN(n[0])?0:n[0]},set:function(y){n[0]=y}}),Object.defineProperty(this,"y",{enumerable:!0,configurable:!0,get:function(){return!n||isNaN(n[1])?0:n[1]},set:function(y){n[1]=y}}),Object.defineProperty(this,"width",{enumerable:!0,configurable:!0,get:function(){return!n||isNaN(n[2])?0:n[2]},set:function(y){n[2]=y}}),Object.defineProperty(this,"height",{enumerable:!0,configurable:!0,get:function(){return!n||isNaN(n[3])?0:n[3]},set:function(y){n[3]=y}});var a="";Object.defineProperty(this,"FT",{enumerable:!0,configurable:!1,get:function(){return a},set:function(y){switch(y){case"/Btn":case"/Tx":case"/Ch":case"/Sig":a=y;break;default:throw new Error('Invalid value "'+y+'" for attribute FT supplied.')}}});var i=null;Object.defineProperty(this,"T",{enumerable:!0,configurable:!1,get:function(){if(!i||i.length<1){if(this instanceof H1)return;i="FieldObject"+e.FieldNum++}var y=function(b){return b};return this.scope&&(y=this.scope.internal.getEncryptor(this.objId)),"("+wc(y(i))+")"},set:function(y){i=y.toString()}}),Object.defineProperty(this,"fieldName",{configurable:!0,enumerable:!0,get:function(){return i},set:function(y){i=y}});var s="helvetica";Object.defineProperty(this,"fontName",{enumerable:!0,configurable:!0,get:function(){return s},set:function(y){s=y}});var o="normal";Object.defineProperty(this,"fontStyle",{enumerable:!0,configurable:!0,get:function(){return o},set:function(y){o=y}});var l=0;Object.defineProperty(this,"fontSize",{enumerable:!0,configurable:!0,get:function(){return l},set:function(y){l=y}});var c=void 0;Object.defineProperty(this,"maxFontSize",{enumerable:!0,configurable:!0,get:function(){return c===void 0?50/K5:c},set:function(y){c=y}});var u="black";Object.defineProperty(this,"color",{enumerable:!0,configurable:!0,get:function(){return u},set:function(y){u=y}});var f="/F1 0 Tf 0 g";Object.defineProperty(this,"DA",{enumerable:!0,configurable:!1,get:function(){if(!(!f||this instanceof H1||this instanceof Jl))return D2(f,this.objId,this.scope)},set:function(y){y=y.toString(),f=y}});var d=null;Object.defineProperty(this,"DV",{enumerable:!1,configurable:!1,get:function(){if(d)return this instanceof mn?d:D2(d,this.objId,this.scope)},set:function(y){y=y.toString(),d=this instanceof mn?y:y.substr(0,1)==="("?Yc(y.substr(1,y.length-2)):Yc(y)}}),Object.defineProperty(this,"defaultValue",{enumerable:!0,configurable:!0,get:function(){return this instanceof mn?Yc(d.substr(1,d.length-1)):d},set:function(y){y=y.toString(),d=this instanceof mn?"/"+y:y}});var h=null;Object.defineProperty(this,"_V",{enumerable:!1,configurable:!1,get:function(){if(h)return h},set:function(y){this.V=y}}),Object.defineProperty(this,"V",{enumerable:!1,configurable:!1,get:function(){if(h)return this instanceof mn?h:D2(h,this.objId,this.scope)},set:function(y){y=y.toString(),h=this instanceof mn?y:y.substr(0,1)==="("?Yc(y.substr(1,y.length-2)):Yc(y)}}),Object.defineProperty(this,"value",{enumerable:!0,configurable:!0,get:function(){return this instanceof mn?Yc(h.substr(1,h.length-1)):h},set:function(y){y=y.toString(),h=this instanceof mn?"/"+y:y}}),Object.defineProperty(this,"hasAnnotation",{enumerable:!0,configurable:!0,get:function(){return this.Rect}}),Object.defineProperty(this,"Type",{enumerable:!0,configurable:!1,get:function(){return this.hasAnnotation?"/Annot":null}}),Object.defineProperty(this,"Subtype",{enumerable:!0,configurable:!1,get:function(){return this.hasAnnotation?"/Widget":null}});var g,m=!1;Object.defineProperty(this,"hasAppearanceStream",{enumerable:!0,configurable:!0,get:function(){return m},set:function(y){y=!!y,m=y}}),Object.defineProperty(this,"page",{enumerable:!0,configurable:!0,get:function(){if(g)return g},set:function(y){g=y}}),Object.defineProperty(this,"readOnly",{enumerable:!0,configurable:!0,get:function(){return!!Ur(this.Ff,1)},set:function(y){y?this.Ff=$r(this.Ff,1):this.Ff=Vr(this.Ff,1)}}),Object.defineProperty(this,"required",{enumerable:!0,configurable:!0,get:function(){return!!Ur(this.Ff,2)},set:function(y){y?this.Ff=$r(this.Ff,2):this.Ff=Vr(this.Ff,2)}}),Object.defineProperty(this,"noExport",{enumerable:!0,configurable:!0,get:function(){return!!Ur(this.Ff,3)},set:function(y){y?this.Ff=$r(this.Ff,3):this.Ff=Vr(this.Ff,3)}});var _=null;Object.defineProperty(this,"Q",{enumerable:!0,configurable:!1,get:function(){if(_!==null)return _},set:function(y){if([0,1,2].indexOf(y)===-1)throw new Error('Invalid value "'+y+'" for attribute Q supplied.');_=y}}),Object.defineProperty(this,"textAlign",{get:function(){var y;switch(_){case 0:default:y="left";break;case 1:y="center";break;case 2:y="right"}return y},configurable:!0,enumerable:!0,set:function(y){switch(y){case"right":case 2:_=2;break;case"center":case 1:_=1;break;case"left":case 0:default:_=0}}})};Sa(Wi,os);var Fu=function(){Wi.call(this),this.FT="/Ch",this.V="()",this.fontName="zapfdingbats";var e=0;Object.defineProperty(this,"TI",{enumerable:!0,configurable:!1,get:function(){return e},set:function(r){e=r}}),Object.defineProperty(this,"topIndex",{enumerable:!0,configurable:!0,get:function(){return e},set:function(r){e=r}});var t=[];Object.defineProperty(this,"Opt",{enumerable:!0,configurable:!1,get:function(){return YT(t,this.objId,this.scope)},set:function(r){var n,a;a=[],typeof(n=r)=="string"&&(a=function(i,s,o){o||(o=1);for(var l,c=[];l=s.exec(i);)c.push(l[o]);return c}(n,/\((.*?)\)/g)),t=a}}),this.getOptions=function(){return t},this.setOptions=function(r){t=r,this.sort&&t.sort()},this.addOption=function(r){r=(r=r||"").toString(),t.push(r),this.sort&&t.sort()},this.removeOption=function(r,n){for(n=n||!1,r=(r=r||"").toString();t.indexOf(r)!==-1&&(t.splice(t.indexOf(r),1),n!==!1););},Object.defineProperty(this,"combo",{enumerable:!0,configurable:!0,get:function(){return!!Ur(this.Ff,18)},set:function(r){r?this.Ff=$r(this.Ff,18):this.Ff=Vr(this.Ff,18)}}),Object.defineProperty(this,"edit",{enumerable:!0,configurable:!0,get:function(){return!!Ur(this.Ff,19)},set:function(r){this.combo===!0&&(r?this.Ff=$r(this.Ff,19):this.Ff=Vr(this.Ff,19))}}),Object.defineProperty(this,"sort",{enumerable:!0,configurable:!0,get:function(){return!!Ur(this.Ff,20)},set:function(r){r?(this.Ff=$r(this.Ff,20),t.sort()):this.Ff=Vr(this.Ff,20)}}),Object.defineProperty(this,"multiSelect",{enumerable:!0,configurable:!0,get:function(){return!!Ur(this.Ff,22)},set:function(r){r?this.Ff=$r(this.Ff,22):this.Ff=Vr(this.Ff,22)}}),Object.defineProperty(this,"doNotSpellCheck",{enumerable:!0,configurable:!0,get:function(){return!!Ur(this.Ff,23)},set:function(r){r?this.Ff=$r(this.Ff,23):this.Ff=Vr(this.Ff,23)}}),Object.defineProperty(this,"commitOnSelChange",{enumerable:!0,configurable:!0,get:function(){return!!Ur(this.Ff,27)},set:function(r){r?this.Ff=$r(this.Ff,27):this.Ff=Vr(this.Ff,27)}}),this.hasAppearanceStream=!1};Sa(Fu,Wi);var Ou=function(){Fu.call(this),this.fontName="helvetica",this.combo=!1};Sa(Ou,Fu);var Iu=function(){Ou.call(this),this.combo=!0};Sa(Iu,Ou);var $p=function(){Iu.call(this),this.edit=!0};Sa($p,Iu);var mn=function(){Wi.call(this),this.FT="/Btn",Object.defineProperty(this,"noToggleToOff",{enumerable:!0,configurable:!0,get:function(){return!!Ur(this.Ff,15)},set:function(r){r?this.Ff=$r(this.Ff,15):this.Ff=Vr(this.Ff,15)}}),Object.defineProperty(this,"radio",{enumerable:!0,configurable:!0,get:function(){return!!Ur(this.Ff,16)},set:function(r){r?this.Ff=$r(this.Ff,16):this.Ff=Vr(this.Ff,16)}}),Object.defineProperty(this,"pushButton",{enumerable:!0,configurable:!0,get:function(){return!!Ur(this.Ff,17)},set:function(r){r?this.Ff=$r(this.Ff,17):this.Ff=Vr(this.Ff,17)}}),Object.defineProperty(this,"radioIsUnison",{enumerable:!0,configurable:!0,get:function(){return!!Ur(this.Ff,26)},set:function(r){r?this.Ff=$r(this.Ff,26):this.Ff=Vr(this.Ff,26)}});var e,t={};Object.defineProperty(this,"MK",{enumerable:!1,configurable:!1,get:function(){var r=function(i){return i};if(this.scope&&(r=this.scope.internal.getEncryptor(this.objId)),Object.keys(t).length!==0){var n,a=[];for(n in a.push("<<"),t)a.push("/"+n+" ("+wc(r(t[n]))+")");return a.push(">>"),a.join(`
`)}},set:function(r){tr(r)==="object"&&(t=r)}}),Object.defineProperty(this,"caption",{enumerable:!0,configurable:!0,get:function(){return t.CA||""},set:function(r){typeof r=="string"&&(t.CA=r)}}),Object.defineProperty(this,"AS",{enumerable:!1,configurable:!1,get:function(){return e},set:function(r){e=r}}),Object.defineProperty(this,"appearanceState",{enumerable:!0,configurable:!0,get:function(){return e.substr(1,e.length-1)},set:function(r){e="/"+r}})};Sa(mn,Wi);var Vp=function(){mn.call(this),this.pushButton=!0};Sa(Vp,mn);var Du=function(){mn.call(this),this.radio=!0,this.pushButton=!1;var e=[];Object.defineProperty(this,"Kids",{enumerable:!0,configurable:!1,get:function(){return e},set:function(t){e=t!==void 0?t:[]}})};Sa(Du,mn);var H1=function(){var e,t;Wi.call(this),Object.defineProperty(this,"Parent",{enumerable:!1,configurable:!1,get:function(){return e},set:function(a){e=a}}),Object.defineProperty(this,"optionName",{enumerable:!1,configurable:!0,get:function(){return t},set:function(a){t=a}});var r,n={};Object.defineProperty(this,"MK",{enumerable:!1,configurable:!1,get:function(){var a=function(o){return o};this.scope&&(a=this.scope.internal.getEncryptor(this.objId));var i,s=[];for(i in s.push("<<"),n)s.push("/"+i+" ("+wc(a(n[i]))+")");return s.push(">>"),s.join(`
`)},set:function(a){tr(a)==="object"&&(n=a)}}),Object.defineProperty(this,"caption",{enumerable:!0,configurable:!0,get:function(){return n.CA||""},set:function(a){typeof a=="string"&&(n.CA=a)}}),Object.defineProperty(this,"AS",{enumerable:!1,configurable:!1,get:function(){return r},set:function(a){r=a}}),Object.defineProperty(this,"appearanceState",{enumerable:!0,configurable:!0,get:function(){return r.substr(1,r.length-1)},set:function(a){r="/"+a}}),this.caption="l",this.appearanceState="Off",this._AppearanceType=lt.RadioButton.Circle,this.appearanceStreamContent=this._AppearanceType.createAppearanceStream(this.optionName)};Sa(H1,Wi),Du.prototype.setAppearance=function(e){if(!("createAppearanceStream"in e)||!("getCA"in e))throw new Error("Couldn't assign Appearance to RadioButton. Appearance was Invalid!");for(var t in this.Kids)if(this.Kids.hasOwnProperty(t)){var r=this.Kids[t];r.appearanceStreamContent=e.createAppearanceStream(r.optionName),r.caption=e.getCA()}},Du.prototype.createOption=function(e){var t=new H1;return t.Parent=this,t.optionName=e,this.Kids.push(t),fY.call(this.scope,t),t};var zp=function(){mn.call(this),this.fontName="zapfdingbats",this.caption="3",this.appearanceState="On",this.value="On",this.textAlign="center",this.appearanceStreamContent=lt.CheckBox.createAppearanceStream()};Sa(zp,mn);var Jl=function(){Wi.call(this),this.FT="/Tx",Object.defineProperty(this,"multiline",{enumerable:!0,configurable:!0,get:function(){return!!Ur(this.Ff,13)},set:function(t){t?this.Ff=$r(this.Ff,13):this.Ff=Vr(this.Ff,13)}}),Object.defineProperty(this,"fileSelect",{enumerable:!0,configurable:!0,get:function(){return!!Ur(this.Ff,21)},set:function(t){t?this.Ff=$r(this.Ff,21):this.Ff=Vr(this.Ff,21)}}),Object.defineProperty(this,"doNotSpellCheck",{enumerable:!0,configurable:!0,get:function(){return!!Ur(this.Ff,23)},set:function(t){t?this.Ff=$r(this.Ff,23):this.Ff=Vr(this.Ff,23)}}),Object.defineProperty(this,"doNotScroll",{enumerable:!0,configurable:!0,get:function(){return!!Ur(this.Ff,24)},set:function(t){t?this.Ff=$r(this.Ff,24):this.Ff=Vr(this.Ff,24)}}),Object.defineProperty(this,"comb",{enumerable:!0,configurable:!0,get:function(){return!!Ur(this.Ff,25)},set:function(t){t?this.Ff=$r(this.Ff,25):this.Ff=Vr(this.Ff,25)}}),Object.defineProperty(this,"richText",{enumerable:!0,configurable:!0,get:function(){return!!Ur(this.Ff,26)},set:function(t){t?this.Ff=$r(this.Ff,26):this.Ff=Vr(this.Ff,26)}});var e=null;Object.defineProperty(this,"MaxLen",{enumerable:!0,configurable:!1,get:function(){return e},set:function(t){e=t}}),Object.defineProperty(this,"maxLength",{enumerable:!0,configurable:!0,get:function(){return e},set:function(t){Number.isInteger(t)&&(e=t)}}),Object.defineProperty(this,"hasAppearanceStream",{enumerable:!0,configurable:!0,get:function(){return this.V||this.DV}})};Sa(Jl,Wi);var Hp=function(){Jl.call(this),Object.defineProperty(this,"password",{enumerable:!0,configurable:!0,get:function(){return!!Ur(this.Ff,14)},set:function(e){e?this.Ff=$r(this.Ff,14):this.Ff=Vr(this.Ff,14)}}),this.password=!0};Sa(Hp,Jl);var lt={CheckBox:{createAppearanceStream:function(){return{N:{On:lt.CheckBox.YesNormal},D:{On:lt.CheckBox.YesPushDown,Off:lt.CheckBox.OffPushDown}}},YesPushDown:function(e){var t=ns(e);t.scope=e.scope;var r=[],n=e.scope.internal.getFont(e.fontName,e.fontStyle).id,a=e.scope.__private__.encodeColorString(e.color),i=Fv(e,e.caption);return r.push("0.749023 g"),r.push("0 0 "+Ct(lt.internal.getWidth(e))+" "+Ct(lt.internal.getHeight(e))+" re"),r.push("f"),r.push("BMC"),r.push("q"),r.push("0 0 1 rg"),r.push("/"+n+" "+Ct(i.fontSize)+" Tf "+a),r.push("BT"),r.push(i.text),r.push("ET"),r.push("Q"),r.push("EMC"),t.stream=r.join(`
`),t},YesNormal:function(e){var t=ns(e);t.scope=e.scope;var r=e.scope.internal.getFont(e.fontName,e.fontStyle).id,n=e.scope.__private__.encodeColorString(e.color),a=[],i=lt.internal.getHeight(e),s=lt.internal.getWidth(e),o=Fv(e,e.caption);return a.push("1 g"),a.push("0 0 "+Ct(s)+" "+Ct(i)+" re"),a.push("f"),a.push("q"),a.push("0 0 1 rg"),a.push("0 0 "+Ct(s-1)+" "+Ct(i-1)+" re"),a.push("W"),a.push("n"),a.push("0 g"),a.push("BT"),a.push("/"+r+" "+Ct(o.fontSize)+" Tf "+n),a.push(o.text),a.push("ET"),a.push("Q"),t.stream=a.join(`
`),t},OffPushDown:function(e){var t=ns(e);t.scope=e.scope;var r=[];return r.push("0.749023 g"),r.push("0 0 "+Ct(lt.internal.getWidth(e))+" "+Ct(lt.internal.getHeight(e))+" re"),r.push("f"),t.stream=r.join(`
`),t}},RadioButton:{Circle:{createAppearanceStream:function(e){var t={D:{Off:lt.RadioButton.Circle.OffPushDown},N:{}};return t.N[e]=lt.RadioButton.Circle.YesNormal,t.D[e]=lt.RadioButton.Circle.YesPushDown,t},getCA:function(){return"l"},YesNormal:function(e){var t=ns(e);t.scope=e.scope;var r=[],n=lt.internal.getWidth(e)<=lt.internal.getHeight(e)?lt.internal.getWidth(e)/4:lt.internal.getHeight(e)/4;n=Number((.9*n).toFixed(5));var a=lt.internal.Bezier_C,i=Number((n*a).toFixed(5));return r.push("q"),r.push("1 0 0 1 "+ko(lt.internal.getWidth(e)/2)+" "+ko(lt.internal.getHeight(e)/2)+" cm"),r.push(n+" 0 m"),r.push(n+" "+i+" "+i+" "+n+" 0 "+n+" c"),r.push("-"+i+" "+n+" -"+n+" "+i+" -"+n+" 0 c"),r.push("-"+n+" -"+i+" -"+i+" -"+n+" 0 -"+n+" c"),r.push(i+" -"+n+" "+n+" -"+i+" "+n+" 0 c"),r.push("f"),r.push("Q"),t.stream=r.join(`
`),t},YesPushDown:function(e){var t=ns(e);t.scope=e.scope;var r=[],n=lt.internal.getWidth(e)<=lt.internal.getHeight(e)?lt.internal.getWidth(e)/4:lt.internal.getHeight(e)/4;n=Number((.9*n).toFixed(5));var a=Number((2*n).toFixed(5)),i=Number((a*lt.internal.Bezier_C).toFixed(5)),s=Number((n*lt.internal.Bezier_C).toFixed(5));return r.push("0.749023 g"),r.push("q"),r.push("1 0 0 1 "+ko(lt.internal.getWidth(e)/2)+" "+ko(lt.internal.getHeight(e)/2)+" cm"),r.push(a+" 0 m"),r.push(a+" "+i+" "+i+" "+a+" 0 "+a+" c"),r.push("-"+i+" "+a+" -"+a+" "+i+" -"+a+" 0 c"),r.push("-"+a+" -"+i+" -"+i+" -"+a+" 0 -"+a+" c"),r.push(i+" -"+a+" "+a+" -"+i+" "+a+" 0 c"),r.push("f"),r.push("Q"),r.push("0 g"),r.push("q"),r.push("1 0 0 1 "+ko(lt.internal.getWidth(e)/2)+" "+ko(lt.internal.getHeight(e)/2)+" cm"),r.push(n+" 0 m"),r.push(n+" "+s+" "+s+" "+n+" 0 "+n+" c"),r.push("-"+s+" "+n+" -"+n+" "+s+" -"+n+" 0 c"),r.push("-"+n+" -"+s+" -"+s+" -"+n+" 0 -"+n+" c"),r.push(s+" -"+n+" "+n+" -"+s+" "+n+" 0 c"),r.push("f"),r.push("Q"),t.stream=r.join(`
`),t},OffPushDown:function(e){var t=ns(e);t.scope=e.scope;var r=[],n=lt.internal.getWidth(e)<=lt.internal.getHeight(e)?lt.internal.getWidth(e)/4:lt.internal.getHeight(e)/4;n=Number((.9*n).toFixed(5));var a=Number((2*n).toFixed(5)),i=Number((a*lt.internal.Bezier_C).toFixed(5));return r.push("0.749023 g"),r.push("q"),r.push("1 0 0 1 "+ko(lt.internal.getWidth(e)/2)+" "+ko(lt.internal.getHeight(e)/2)+" cm"),r.push(a+" 0 m"),r.push(a+" "+i+" "+i+" "+a+" 0 "+a+" c"),r.push("-"+i+" "+a+" -"+a+" "+i+" -"+a+" 0 c"),r.push("-"+a+" -"+i+" -"+i+" -"+a+" 0 -"+a+" c"),r.push(i+" -"+a+" "+a+" -"+i+" "+a+" 0 c"),r.push("f"),r.push("Q"),t.stream=r.join(`
`),t}},Cross:{createAppearanceStream:function(e){var t={D:{Off:lt.RadioButton.Cross.OffPushDown},N:{}};return t.N[e]=lt.RadioButton.Cross.YesNormal,t.D[e]=lt.RadioButton.Cross.YesPushDown,t},getCA:function(){return"8"},YesNormal:function(e){var t=ns(e);t.scope=e.scope;var r=[],n=lt.internal.calculateCross(e);return r.push("q"),r.push("1 1 "+Ct(lt.internal.getWidth(e)-2)+" "+Ct(lt.internal.getHeight(e)-2)+" re"),r.push("W"),r.push("n"),r.push(Ct(n.x1.x)+" "+Ct(n.x1.y)+" m"),r.push(Ct(n.x2.x)+" "+Ct(n.x2.y)+" l"),r.push(Ct(n.x4.x)+" "+Ct(n.x4.y)+" m"),r.push(Ct(n.x3.x)+" "+Ct(n.x3.y)+" l"),r.push("s"),r.push("Q"),t.stream=r.join(`
`),t},YesPushDown:function(e){var t=ns(e);t.scope=e.scope;var r=lt.internal.calculateCross(e),n=[];return n.push("0.749023 g"),n.push("0 0 "+Ct(lt.internal.getWidth(e))+" "+Ct(lt.internal.getHeight(e))+" re"),n.push("f"),n.push("q"),n.push("1 1 "+Ct(lt.internal.getWidth(e)-2)+" "+Ct(lt.internal.getHeight(e)-2)+" re"),n.push("W"),n.push("n"),n.push(Ct(r.x1.x)+" "+Ct(r.x1.y)+" m"),n.push(Ct(r.x2.x)+" "+Ct(r.x2.y)+" l"),n.push(Ct(r.x4.x)+" "+Ct(r.x4.y)+" m"),n.push(Ct(r.x3.x)+" "+Ct(r.x3.y)+" l"),n.push("s"),n.push("Q"),t.stream=n.join(`
`),t},OffPushDown:function(e){var t=ns(e);t.scope=e.scope;var r=[];return r.push("0.749023 g"),r.push("0 0 "+Ct(lt.internal.getWidth(e))+" "+Ct(lt.internal.getHeight(e))+" re"),r.push("f"),t.stream=r.join(`
`),t}}},createDefaultAppearanceStream:function(e){var t=e.scope.internal.getFont(e.fontName,e.fontStyle).id,r=e.scope.__private__.encodeColorString(e.color);return"/"+t+" "+e.fontSize+" Tf "+r}};lt.internal={Bezier_C:.551915024494,calculateCross:function(e){var t=lt.internal.getWidth(e),r=lt.internal.getHeight(e),n=Math.min(t,r);return{x1:{x:(t-n)/2,y:(r-n)/2+n},x2:{x:(t-n)/2+n,y:(r-n)/2},x3:{x:(t-n)/2,y:(r-n)/2},x4:{x:(t-n)/2+n,y:(r-n)/2+n}}}},lt.internal.getWidth=function(e){var t=0;return tr(e)==="object"&&(t=O_(e.Rect[2])),t},lt.internal.getHeight=function(e){var t=0;return tr(e)==="object"&&(t=O_(e.Rect[3])),t};var fY=Pr.addField=function(e){if(uY(this,e),!(e instanceof Wi))throw new Error("Invalid argument passed to jsPDF.addField.");var t;return(t=e).scope.internal.acroformPlugin.printedOut&&(t.scope.internal.acroformPlugin.printedOut=!1,t.scope.internal.acroformPlugin.acroFormDictionaryRoot=null),t.scope.internal.acroformPlugin.acroFormDictionaryRoot.Fields.push(t),e.page=e.scope.internal.getCurrentPageInfo().pageNumber,this};Pr.AcroFormChoiceField=Fu,Pr.AcroFormListBox=Ou,Pr.AcroFormComboBox=Iu,Pr.AcroFormEditBox=$p,Pr.AcroFormButton=mn,Pr.AcroFormPushButton=Vp,Pr.AcroFormRadioButton=Du,Pr.AcroFormCheckBox=zp,Pr.AcroFormTextField=Jl,Pr.AcroFormPasswordField=Hp,Pr.AcroFormAppearance=lt,Pr.AcroForm={ChoiceField:Fu,ListBox:Ou,ComboBox:Iu,EditBox:$p,Button:mn,PushButton:Vp,RadioButton:Du,CheckBox:zp,TextField:Jl,PasswordField:Hp,Appearance:lt},vt.AcroForm={ChoiceField:Fu,ListBox:Ou,ComboBox:Iu,EditBox:$p,Button:mn,PushButton:Vp,RadioButton:Du,CheckBox:zp,TextField:Jl,PasswordField:Hp,Appearance:lt};function ZT(e){return e.reduce(function(t,r,n){return t[r]=n,t},{})}(function(e){e.__addimage__={};var t="UNKNOWN",r={PNG:[[137,80,78,71]],TIFF:[[77,77,0,42],[73,73,42,0]],JPEG:[[255,216,255,224,void 0,void 0,74,70,73,70,0],[255,216,255,225,void 0,void 0,69,120,105,102,0,0],[255,216,255,219],[255,216,255,238]],JPEG2000:[[0,0,0,12,106,80,32,32]],GIF87a:[[71,73,70,56,55,97]],GIF89a:[[71,73,70,56,57,97]],WEBP:[[82,73,70,70,void 0,void 0,void 0,void 0,87,69,66,80]],BMP:[[66,77],[66,65],[67,73],[67,80],[73,67],[80,84]]},n=e.__addimage__.getImageFileTypeByImageData=function(N,L){var G,W,le,de,X,ee=t;if((L=L||t)==="RGBA"||N.data!==void 0&&N.data instanceof Uint8ClampedArray&&"height"in N&&"width"in N)return"RGBA";if(I(N))for(X in r)for(le=r[X],G=0;G<le.length;G+=1){for(de=!0,W=0;W<le[G].length;W+=1)if(le[G][W]!==void 0&&le[G][W]!==N[W]){de=!1;break}if(de===!0){ee=X;break}}else for(X in r)for(le=r[X],G=0;G<le.length;G+=1){for(de=!0,W=0;W<le[G].length;W+=1)if(le[G][W]!==void 0&&le[G][W]!==N.charCodeAt(W)){de=!1;break}if(de===!0){ee=X;break}}return ee===t&&L!==t&&(ee=L),ee},a=function N(L){for(var G=this.internal.write,W=this.internal.putStream,le=(0,this.internal.getFilters)();le.indexOf("FlateEncode")!==-1;)le.splice(le.indexOf("FlateEncode"),1);L.objectId=this.internal.newObject();var de=[];if(de.push({key:"Type",value:"/XObject"}),de.push({key:"Subtype",value:"/Image"}),de.push({key:"Width",value:L.width}),de.push({key:"Height",value:L.height}),L.colorSpace===_.INDEXED?de.push({key:"ColorSpace",value:"[/Indexed /DeviceRGB "+(L.palette.length/3-1)+" "+("sMask"in L&&L.sMask!==void 0?L.objectId+2:L.objectId+1)+" 0 R]"}):(de.push({key:"ColorSpace",value:"/"+L.colorSpace}),L.colorSpace===_.DEVICE_CMYK&&de.push({key:"Decode",value:"[1 0 1 0 1 0 1 0]"})),de.push({key:"BitsPerComponent",value:L.bitsPerComponent}),"decodeParameters"in L&&L.decodeParameters!==void 0&&de.push({key:"DecodeParms",value:"<<"+L.decodeParameters+">>"}),"transparency"in L&&Array.isArray(L.transparency)){for(var X="",ee=0,R=L.transparency.length;ee<R;ee++)X+=L.transparency[ee]+" "+L.transparency[ee]+" ";de.push({key:"Mask",value:"["+X+"]"})}L.sMask!==void 0&&de.push({key:"SMask",value:L.objectId+1+" 0 R"});var pe=L.filter!==void 0?["/"+L.filter]:void 0;if(W({data:L.data,additionalKeyValues:de,alreadyAppliedFilters:pe,objectId:L.objectId}),G("endobj"),"sMask"in L&&L.sMask!==void 0){var me="/Predictor "+L.predictor+" /Colors 1 /BitsPerComponent "+L.bitsPerComponent+" /Columns "+L.width,E={width:L.width,height:L.height,colorSpace:"DeviceGray",bitsPerComponent:L.bitsPerComponent,decodeParameters:me,data:L.sMask};"filter"in L&&(E.filter=L.filter),N.call(this,E)}if(L.colorSpace===_.INDEXED){var D=this.internal.newObject();W({data:P(new Uint8Array(L.palette)),objectId:D}),G("endobj")}},i=function(){var N=this.internal.collections.addImage_images;for(var L in N)a.call(this,N[L])},s=function(){var N,L=this.internal.collections.addImage_images,G=this.internal.write;for(var W in L)G("/I"+(N=L[W]).index,N.objectId,"0","R")},o=function(){this.internal.collections.addImage_images||(this.internal.collections.addImage_images={},this.internal.events.subscribe("putResources",i),this.internal.events.subscribe("putXobjectDict",s))},l=function(){var N=this.internal.collections.addImage_images;return o.call(this),N},c=function(){return Object.keys(this.internal.collections.addImage_images).length},u=function(N){return typeof e["process"+N.toUpperCase()]=="function"},f=function(N){return tr(N)==="object"&&N.nodeType===1},d=function(N,L){if(N.nodeName==="IMG"&&N.hasAttribute("src")){var G=""+N.getAttribute("src");if(G.indexOf("data:image/")===0)return Mf(unescape(G).split("base64,").pop());var W=e.loadFile(G,!0);if(W!==void 0)return W}if(N.nodeName==="CANVAS"){if(N.width===0||N.height===0)throw new Error("Given canvas must have data. Canvas width: "+N.width+", height: "+N.height);var le;switch(L){case"PNG":le="image/png";break;case"WEBP":le="image/webp";break;case"JPEG":case"JPG":default:le="image/jpeg"}return Mf(N.toDataURL(le,1).split("base64,").pop())}},h=function(N){var L=this.internal.collections.addImage_images;if(L){for(var G in L)if(N===L[G].alias)return L[G]}},g=function(N,L,G){return N||L||(N=-96,L=-96),N<0&&(N=-1*G.width*72/N/this.internal.scaleFactor),L<0&&(L=-1*G.height*72/L/this.internal.scaleFactor),N===0&&(N=L*G.width/G.height),L===0&&(L=N*G.height/G.width),[N,L]},m=function(N,L,G,W,le,de){var X=g.call(this,G,W,le),ee=this.internal.getCoordinateString,R=this.internal.getVerticalCoordinateString,pe=l.call(this);if(G=X[0],W=X[1],pe[le.index]=le,de){de*=Math.PI/180;var me=Math.cos(de),E=Math.sin(de),D=function(M){return M.toFixed(4)},O=[D(me),D(E),D(-1*E),D(me),0,0,"cm"]}this.internal.write("q"),de?(this.internal.write([1,"0","0",1,ee(N),R(L+W),"cm"].join(" ")),this.internal.write(O.join(" ")),this.internal.write([ee(G),"0","0",ee(W),"0","0","cm"].join(" "))):this.internal.write([ee(G),"0","0",ee(W),ee(N),R(L+W),"cm"].join(" ")),this.isAdvancedAPI()&&this.internal.write([1,0,0,-1,0,0,"cm"].join(" ")),this.internal.write("/I"+le.index+" Do"),this.internal.write("Q")},_=e.color_spaces={DEVICE_RGB:"DeviceRGB",DEVICE_GRAY:"DeviceGray",DEVICE_CMYK:"DeviceCMYK",CAL_GREY:"CalGray",CAL_RGB:"CalRGB",LAB:"Lab",ICC_BASED:"ICCBased",INDEXED:"Indexed",PATTERN:"Pattern",SEPARATION:"Separation",DEVICE_N:"DeviceN"};e.decode={DCT_DECODE:"DCTDecode",FLATE_DECODE:"FlateDecode",LZW_DECODE:"LZWDecode",JPX_DECODE:"JPXDecode",JBIG2_DECODE:"JBIG2Decode",ASCII85_DECODE:"ASCII85Decode",ASCII_HEX_DECODE:"ASCIIHexDecode",RUN_LENGTH_DECODE:"RunLengthDecode",CCITT_FAX_DECODE:"CCITTFaxDecode"};var y=e.image_compression={NONE:"NONE",FAST:"FAST",MEDIUM:"MEDIUM",SLOW:"SLOW"},b=e.__addimage__.sHashCode=function(N){var L,G,W=0;if(typeof N=="string")for(G=N.length,L=0;L<G;L++)W=(W<<5)-W+N.charCodeAt(L),W|=0;else if(I(N))for(G=N.byteLength/2,L=0;L<G;L++)W=(W<<5)-W+N[L],W|=0;return W},w=e.__addimage__.validateStringAsBase64=function(N){(N=N||"").toString().trim();var L=!0;return N.length===0&&(L=!1),N.length%4!=0&&(L=!1),/^[A-Za-z0-9+/]+$/.test(N.substr(0,N.length-2))===!1&&(L=!1),/^[A-Za-z0-9/][A-Za-z0-9+/]|[A-Za-z0-9+/]=|==$/.test(N.substr(-2))===!1&&(L=!1),L},T=e.__addimage__.extractImageFromDataUrl=function(N){if(N==null||!(N=N.trim()).startsWith("data:"))return null;var L=N.indexOf(",");return L<0?null:N.substring(0,L).trim().endsWith("base64")?N.substring(L+1):null},F=e.__addimage__.supportsArrayBuffer=function(){return typeof ArrayBuffer<"u"&&typeof Uint8Array<"u"};e.__addimage__.isArrayBuffer=function(N){return F()&&N instanceof ArrayBuffer};var I=e.__addimage__.isArrayBufferView=function(N){return F()&&typeof Uint32Array<"u"&&(N instanceof Int8Array||N instanceof Uint8Array||typeof Uint8ClampedArray<"u"&&N instanceof Uint8ClampedArray||N instanceof Int16Array||N instanceof Uint16Array||N instanceof Int32Array||N instanceof Uint32Array||N instanceof Float32Array||N instanceof Float64Array)},A=e.__addimage__.binaryStringToUint8Array=function(N){for(var L=N.length,G=new Uint8Array(L),W=0;W<L;W++)G[W]=N.charCodeAt(W);return G},P=e.__addimage__.arrayBufferToBinaryString=function(N){for(var L="",G=I(N)?N:new Uint8Array(N),W=0;W<G.length;W+=8192)L+=String.fromCharCode.apply(null,G.subarray(W,W+8192));return L};e.addImage=function(){var N,L,G,W,le,de,X,ee,R;if(typeof arguments[1]=="number"?(L=t,G=arguments[1],W=arguments[2],le=arguments[3],de=arguments[4],X=arguments[5],ee=arguments[6],R=arguments[7]):(L=arguments[1],G=arguments[2],W=arguments[3],le=arguments[4],de=arguments[5],X=arguments[6],ee=arguments[7],R=arguments[8]),tr(N=arguments[0])==="object"&&!f(N)&&"imageData"in N){var pe=N;N=pe.imageData,L=pe.format||L||t,G=pe.x||G||0,W=pe.y||W||0,le=pe.w||pe.width||le,de=pe.h||pe.height||de,X=pe.alias||X,ee=pe.compression||ee,R=pe.rotation||pe.angle||R}var me=this.internal.getFilters();if(ee===void 0&&me.indexOf("FlateEncode")!==-1&&(ee="SLOW"),isNaN(G)||isNaN(W))throw new Error("Invalid coordinates passed to jsPDF.addImage");o.call(this);var E=j.call(this,N,L,X,ee);return m.call(this,G,W,le,de,E,R),this};var j=function(N,L,G,W){var le,de,X;if(typeof N=="string"&&n(N)===t){N=unescape(N);var ee=J(N,!1);(ee!==""||(ee=e.loadFile(N,!0))!==void 0)&&(N=ee)}if(f(N)&&(N=d(N,L)),L=n(N,L),!u(L))throw new Error("addImage does not support files of type '"+L+"', please ensure that a plugin for '"+L+"' support is added.");if(((X=G)==null||X.length===0)&&(G=function(R){return typeof R=="string"||I(R)?b(R):I(R.data)?b(R.data):null}(N)),(le=h.call(this,G))||(F()&&(N instanceof Uint8Array||L==="RGBA"||(de=N,N=A(N))),le=this["process"+L.toUpperCase()](N,c.call(this),G,function(R){return R&&typeof R=="string"&&(R=R.toUpperCase()),R in e.image_compression?R:y.NONE}(W),de)),!le)throw new Error("An unknown error occurred whilst processing the image.");return le},J=e.__addimage__.convertBase64ToBinaryString=function(N,L){L=typeof L!="boolean"||L;var G,W="";if(typeof N=="string"){var le;G=(le=T(N))!==null&&le!==void 0?le:N;try{W=Mf(G)}catch(de){if(L)throw w(G)?new Error("atob-Error in jsPDF.convertBase64ToBinaryString "+de.message):new Error("Supplied Data is not a valid base64-String jsPDF.convertBase64ToBinaryString ")}}return W};e.getImageProperties=function(N){var L,G,W="";if(f(N)&&(N=d(N)),typeof N=="string"&&n(N)===t&&((W=J(N,!1))===""&&(W=e.loadFile(N)||""),N=W),G=n(N),!u(G))throw new Error("addImage does not support files of type '"+G+"', please ensure that a plugin for '"+G+"' support is added.");if(!F()||N instanceof Uint8Array||(N=A(N)),!(L=this["process"+G.toUpperCase()](N)))throw new Error("An unknown error occurred whilst processing the image");return L.fileType=G,L}})(vt.API),function(e){var t=function(r){if(r!==void 0&&r!="")return!0};vt.API.events.push(["addPage",function(r){this.internal.getPageInfo(r.pageNumber).pageContext.annotations=[]}]),e.events.push(["putPage",function(r){for(var n,a,i,s=this.internal.getCoordinateString,o=this.internal.getVerticalCoordinateString,l=this.internal.getPageInfoByObjId(r.objId),c=r.pageContext.annotations,u=!1,f=0;f<c.length&&!u;f++)switch((n=c[f]).type){case"link":(t(n.options.url)||t(n.options.pageNumber))&&(u=!0);break;case"reference":case"text":case"freetext":u=!0}if(u!=0){this.internal.write("/Annots [");for(var d=0;d<c.length;d++){n=c[d];var h=this.internal.pdfEscape,g=this.internal.getEncryptor(r.objId);switch(n.type){case"reference":this.internal.write(" "+n.object.objId+" 0 R ");break;case"text":var m=this.internal.newAdditionalObject(),_=this.internal.newAdditionalObject(),y=this.internal.getEncryptor(m.objId),b=n.title||"Note";i="<</Type /Annot /Subtype /Text "+(a="/Rect ["+s(n.bounds.x)+" "+o(n.bounds.y+n.bounds.h)+" "+s(n.bounds.x+n.bounds.w)+" "+o(n.bounds.y)+"] ")+"/Contents ("+h(y(n.contents))+")",i+=" /Popup "+_.objId+" 0 R",i+=" /P "+l.objId+" 0 R",i+=" /T ("+h(y(b))+") >>",m.content=i;var w=m.objId+" 0 R";i="<</Type /Annot /Subtype /Popup "+(a="/Rect ["+s(n.bounds.x+30)+" "+o(n.bounds.y+n.bounds.h)+" "+s(n.bounds.x+n.bounds.w+30)+" "+o(n.bounds.y)+"] ")+" /Parent "+w,n.open&&(i+=" /Open true"),i+=" >>",_.content=i,this.internal.write(m.objId,"0 R",_.objId,"0 R");break;case"freetext":a="/Rect ["+s(n.bounds.x)+" "+o(n.bounds.y)+" "+s(n.bounds.x+n.bounds.w)+" "+o(n.bounds.y+n.bounds.h)+"] ";var T=n.color||"#000000";i="<</Type /Annot /Subtype /FreeText "+a+"/Contents ("+h(g(n.contents))+")",i+=" /DS(font: Helvetica,sans-serif 12.0pt; text-align:left; color:#"+T+")",i+=" /Border [0 0 0]",i+=" >>",this.internal.write(i);break;case"link":if(n.options.name){var F=this.annotations._nameMap[n.options.name];n.options.pageNumber=F.page,n.options.top=F.y}else n.options.top||(n.options.top=0);if(a="/Rect ["+n.finalBounds.x+" "+n.finalBounds.y+" "+n.finalBounds.w+" "+n.finalBounds.h+"] ",i="",n.options.url)i="<</Type /Annot /Subtype /Link "+a+"/Border [0 0 0] /A <</S /URI /URI ("+h(g(n.options.url))+") >>";else if(n.options.pageNumber)switch(i="<</Type /Annot /Subtype /Link "+a+"/Border [0 0 0] /Dest ["+this.internal.getPageInfo(n.options.pageNumber).objId+" 0 R",n.options.magFactor=n.options.magFactor||"XYZ",n.options.magFactor){case"Fit":i+=" /Fit]";break;case"FitH":i+=" /FitH "+n.options.top+"]";break;case"FitV":n.options.left=n.options.left||0,i+=" /FitV "+n.options.left+"]";break;case"XYZ":default:var I=o(n.options.top);n.options.left=n.options.left||0,n.options.zoom===void 0&&(n.options.zoom=0),i+=" /XYZ "+n.options.left+" "+I+" "+n.options.zoom+"]"}i!=""&&(i+=" >>",this.internal.write(i))}}this.internal.write("]")}}]),e.createAnnotation=function(r){var n=this.internal.getCurrentPageInfo();switch(r.type){case"link":this.link(r.bounds.x,r.bounds.y,r.bounds.w,r.bounds.h,r);break;case"text":case"freetext":n.pageContext.annotations.push(r)}},e.link=function(r,n,a,i,s){var o=this.internal.getCurrentPageInfo(),l=this.internal.getCoordinateString,c=this.internal.getVerticalCoordinateString;o.pageContext.annotations.push({finalBounds:{x:l(r),y:c(n),w:l(r+a),h:c(n+i)},options:s,type:"link"})},e.textWithLink=function(r,n,a,i){var s,o,l=this.getTextWidth(r),c=this.internal.getLineHeight()/this.internal.scaleFactor;if(i.maxWidth!==void 0){o=i.maxWidth;var u=this.splitTextToSize(r,o).length;s=Math.ceil(c*u)}else o=l,s=c;return this.text(r,n,a,i),a+=.2*c,i.align==="center"&&(n-=l/2),i.align==="right"&&(n-=l),this.link(n,a-c,o,s,i),l},e.getTextWidth=function(r){var n=this.internal.getFontSize();return this.getStringUnitWidth(r)*n/this.internal.scaleFactor}}(vt.API),function(e){var t={1569:[65152],1570:[65153,65154],1571:[65155,65156],1572:[65157,65158],1573:[65159,65160],1574:[65161,65162,65163,65164],1575:[65165,65166],1576:[65167,65168,65169,65170],1577:[65171,65172],1578:[65173,65174,65175,65176],1579:[65177,65178,65179,65180],1580:[65181,65182,65183,65184],1581:[65185,65186,65187,65188],1582:[65189,65190,65191,65192],1583:[65193,65194],1584:[65195,65196],1585:[65197,65198],1586:[65199,65200],1587:[65201,65202,65203,65204],1588:[65205,65206,65207,65208],1589:[65209,65210,65211,65212],1590:[65213,65214,65215,65216],1591:[65217,65218,65219,65220],1592:[65221,65222,65223,65224],1593:[65225,65226,65227,65228],1594:[65229,65230,65231,65232],1601:[65233,65234,65235,65236],1602:[65237,65238,65239,65240],1603:[65241,65242,65243,65244],1604:[65245,65246,65247,65248],1605:[65249,65250,65251,65252],1606:[65253,65254,65255,65256],1607:[65257,65258,65259,65260],1608:[65261,65262],1609:[65263,65264,64488,64489],1610:[65265,65266,65267,65268],1649:[64336,64337],1655:[64477],1657:[64358,64359,64360,64361],1658:[64350,64351,64352,64353],1659:[64338,64339,64340,64341],1662:[64342,64343,64344,64345],1663:[64354,64355,64356,64357],1664:[64346,64347,64348,64349],1667:[64374,64375,64376,64377],1668:[64370,64371,64372,64373],1670:[64378,64379,64380,64381],1671:[64382,64383,64384,64385],1672:[64392,64393],1676:[64388,64389],1677:[64386,64387],1678:[64390,64391],1681:[64396,64397],1688:[64394,64395],1700:[64362,64363,64364,64365],1702:[64366,64367,64368,64369],1705:[64398,64399,64400,64401],1709:[64467,64468,64469,64470],1711:[64402,64403,64404,64405],1713:[64410,64411,64412,64413],1715:[64406,64407,64408,64409],1722:[64414,64415],1723:[64416,64417,64418,64419],1726:[64426,64427,64428,64429],1728:[64420,64421],1729:[64422,64423,64424,64425],1733:[64480,64481],1734:[64473,64474],1735:[64471,64472],1736:[64475,64476],1737:[64482,64483],1739:[64478,64479],1740:[64508,64509,64510,64511],1744:[64484,64485,64486,64487],1746:[64430,64431],1747:[64432,64433]},r={65247:{65154:65269,65156:65271,65160:65273,65166:65275},65248:{65154:65270,65156:65272,65160:65274,65166:65276},65165:{65247:{65248:{65258:65010}}},1617:{1612:64606,1613:64607,1614:64608,1615:64609,1616:64610}},n={1612:64606,1613:64607,1614:64608,1615:64609,1616:64610},a=[1570,1571,1573,1575];e.__arabicParser__={};var i=e.__arabicParser__.isInArabicSubstitutionA=function(m){return t[m.charCodeAt(0)]!==void 0},s=e.__arabicParser__.isArabicLetter=function(m){return typeof m=="string"&&/^[\u0600-\u06FF\u0750-\u077F\u08A0-\u08FF\uFB50-\uFDFF\uFE70-\uFEFF]+$/.test(m)},o=e.__arabicParser__.isArabicEndLetter=function(m){return s(m)&&i(m)&&t[m.charCodeAt(0)].length<=2},l=e.__arabicParser__.isArabicAlfLetter=function(m){return s(m)&&a.indexOf(m.charCodeAt(0))>=0};e.__arabicParser__.arabicLetterHasIsolatedForm=function(m){return s(m)&&i(m)&&t[m.charCodeAt(0)].length>=1};var c=e.__arabicParser__.arabicLetterHasFinalForm=function(m){return s(m)&&i(m)&&t[m.charCodeAt(0)].length>=2};e.__arabicParser__.arabicLetterHasInitialForm=function(m){return s(m)&&i(m)&&t[m.charCodeAt(0)].length>=3};var u=e.__arabicParser__.arabicLetterHasMedialForm=function(m){return s(m)&&i(m)&&t[m.charCodeAt(0)].length==4},f=e.__arabicParser__.resolveLigatures=function(m){var _=0,y=r,b="",w=0;for(_=0;_<m.length;_+=1)y[m.charCodeAt(_)]!==void 0?(w++,typeof(y=y[m.charCodeAt(_)])=="number"&&(b+=String.fromCharCode(y),y=r,w=0),_===m.length-1&&(y=r,b+=m.charAt(_-(w-1)),_-=w-1,w=0)):(y=r,b+=m.charAt(_-w),_-=w,w=0);return b};e.__arabicParser__.isArabicDiacritic=function(m){return m!==void 0&&n[m.charCodeAt(0)]!==void 0};var d=e.__arabicParser__.getCorrectForm=function(m,_,y){return s(m)?i(m)===!1?-1:!c(m)||!s(_)&&!s(y)||!s(y)&&o(_)||o(m)&&!s(_)||o(m)&&l(_)||o(m)&&o(_)?0:u(m)&&s(_)&&!o(_)&&s(y)&&c(y)?3:o(m)||!s(y)?1:2:-1},h=function(m){var _=0,y=0,b=0,w="",T="",F="",I=(m=m||"").split("\\s+"),A=[];for(_=0;_<I.length;_+=1){for(A.push(""),y=0;y<I[_].length;y+=1)w=I[_][y],T=I[_][y-1],F=I[_][y+1],s(w)?(b=d(w,T,F),A[_]+=b!==-1?String.fromCharCode(t[w.charCodeAt(0)][b]):w):A[_]+=w;A[_]=f(A[_])}return A.join(" ")},g=e.__arabicParser__.processArabic=e.processArabic=function(){var m,_=typeof arguments[0]=="string"?arguments[0]:arguments[0].text,y=[];if(Array.isArray(_)){var b=0;for(y=[],b=0;b<_.length;b+=1)Array.isArray(_[b])?y.push([h(_[b][0]),_[b][1],_[b][2]]):y.push([h(_[b])]);m=y}else m=h(_);return typeof arguments[0]=="string"?m:(arguments[0].text=m,arguments[0])};e.events.push(["preProcessText",g])}(vt.API),vt.API.autoPrint=function(e){var t;switch((e=e||{}).variant=e.variant||"non-conform",e.variant){case"javascript":this.addJS("print({});");break;case"non-conform":default:this.internal.events.subscribe("postPutResources",function(){t=this.internal.newObject(),this.internal.out("<<"),this.internal.out("/S /Named"),this.internal.out("/Type /Action"),this.internal.out("/N /Print"),this.internal.out(">>"),this.internal.out("endobj")}),this.internal.events.subscribe("putCatalog",function(){this.internal.out("/OpenAction "+t+" 0 R")})}return this},function(e){var t=function(){var r=void 0;Object.defineProperty(this,"pdf",{get:function(){return r},set:function(o){r=o}});var n=150;Object.defineProperty(this,"width",{get:function(){return n},set:function(o){n=isNaN(o)||Number.isInteger(o)===!1||o<0?150:o,this.getContext("2d").pageWrapXEnabled&&(this.getContext("2d").pageWrapX=n+1)}});var a=300;Object.defineProperty(this,"height",{get:function(){return a},set:function(o){a=isNaN(o)||Number.isInteger(o)===!1||o<0?300:o,this.getContext("2d").pageWrapYEnabled&&(this.getContext("2d").pageWrapY=a+1)}});var i=[];Object.defineProperty(this,"childNodes",{get:function(){return i},set:function(o){i=o}});var s={};Object.defineProperty(this,"style",{get:function(){return s},set:function(o){s=o}}),Object.defineProperty(this,"parentNode",{})};t.prototype.getContext=function(r,n){var a;if((r=r||"2d")!=="2d")return null;for(a in n)this.pdf.context2d.hasOwnProperty(a)&&(this.pdf.context2d[a]=n[a]);return this.pdf.context2d._canvas=this,this.pdf.context2d},t.prototype.toDataURL=function(){throw new Error("toDataURL is not implemented.")},e.events.push(["initialized",function(){this.canvas=new t,this.canvas.pdf=this}])}(vt.API),function(e){var t={left:0,top:0,bottom:0,right:0},r=!1,n=function(){this.internal.__cell__===void 0&&(this.internal.__cell__={},this.internal.__cell__.padding=3,this.internal.__cell__.headerFunction=void 0,this.internal.__cell__.margins=Object.assign({},t),this.internal.__cell__.margins.width=this.getPageWidth(),a.call(this))},a=function(){this.internal.__cell__.lastCell=new i,this.internal.__cell__.pages=1},i=function(){var l=arguments[0];Object.defineProperty(this,"x",{enumerable:!0,get:function(){return l},set:function(m){l=m}});var c=arguments[1];Object.defineProperty(this,"y",{enumerable:!0,get:function(){return c},set:function(m){c=m}});var u=arguments[2];Object.defineProperty(this,"width",{enumerable:!0,get:function(){return u},set:function(m){u=m}});var f=arguments[3];Object.defineProperty(this,"height",{enumerable:!0,get:function(){return f},set:function(m){f=m}});var d=arguments[4];Object.defineProperty(this,"text",{enumerable:!0,get:function(){return d},set:function(m){d=m}});var h=arguments[5];Object.defineProperty(this,"lineNumber",{enumerable:!0,get:function(){return h},set:function(m){h=m}});var g=arguments[6];return Object.defineProperty(this,"align",{enumerable:!0,get:function(){return g},set:function(m){g=m}}),this};i.prototype.clone=function(){return new i(this.x,this.y,this.width,this.height,this.text,this.lineNumber,this.align)},i.prototype.toArray=function(){return[this.x,this.y,this.width,this.height,this.text,this.lineNumber,this.align]},e.setHeaderFunction=function(l){return n.call(this),this.internal.__cell__.headerFunction=typeof l=="function"?l:void 0,this},e.getTextDimensions=function(l,c){n.call(this);var u=(c=c||{}).fontSize||this.getFontSize(),f=c.font||this.getFont(),d=c.scaleFactor||this.internal.scaleFactor,h=0,g=0,m=0,_=this;if(!Array.isArray(l)&&typeof l!="string"){if(typeof l!="number")throw new Error("getTextDimensions expects text-parameter to be of type String or type Number or an Array of Strings.");l=String(l)}var y=c.maxWidth;y>0?typeof l=="string"?l=this.splitTextToSize(l,y):Object.prototype.toString.call(l)==="[object Array]"&&(l=l.reduce(function(w,T){return w.concat(_.splitTextToSize(T,y))},[])):l=Array.isArray(l)?l:[l];for(var b=0;b<l.length;b++)h<(m=this.getStringUnitWidth(l[b],{font:f})*u)&&(h=m);return h!==0&&(g=l.length),{w:h/=d,h:Math.max((g*u*this.getLineHeightFactor()-u*(this.getLineHeightFactor()-1))/d,0)}},e.cellAddPage=function(){n.call(this),this.addPage();var l=this.internal.__cell__.margins||t;return this.internal.__cell__.lastCell=new i(l.left,l.top,void 0,void 0),this.internal.__cell__.pages+=1,this};var s=e.cell=function(){var l;l=arguments[0]instanceof i?arguments[0]:new i(arguments[0],arguments[1],arguments[2],arguments[3],arguments[4],arguments[5]),n.call(this);var c=this.internal.__cell__.lastCell,u=this.internal.__cell__.padding,f=this.internal.__cell__.margins||t,d=this.internal.__cell__.tableHeaderRow,h=this.internal.__cell__.printHeaders;return c.lineNumber!==void 0&&(c.lineNumber===l.lineNumber?(l.x=(c.x||0)+(c.width||0),l.y=c.y||0):c.y+c.height+l.height+f.bottom>this.getPageHeight()?(this.cellAddPage(),l.y=f.top,h&&d&&(this.printHeaderRow(l.lineNumber,!0),l.y+=d[0].height)):l.y=c.y+c.height||l.y),l.text[0]!==void 0&&(this.rect(l.x,l.y,l.width,l.height,r===!0?"FD":void 0),l.align==="right"?this.text(l.text,l.x+l.width-u,l.y+u,{align:"right",baseline:"top"}):l.align==="center"?this.text(l.text,l.x+l.width/2,l.y+u,{align:"center",baseline:"top",maxWidth:l.width-u-u}):this.text(l.text,l.x+u,l.y+u,{align:"left",baseline:"top",maxWidth:l.width-u-u})),this.internal.__cell__.lastCell=l,this};e.table=function(l,c,u,f,d){if(n.call(this),!u)throw new Error("No data for PDF table.");var h,g,m,_,y=[],b=[],w=[],T={},F={},I=[],A=[],P=(d=d||{}).autoSize||!1,j=d.printHeaders!==!1,J=d.css&&d.css["font-size"]!==void 0?16*d.css["font-size"]:d.fontSize||12,N=d.margins||Object.assign({width:this.getPageWidth()},t),L=typeof d.padding=="number"?d.padding:3,G=d.headerBackgroundColor||"#c8c8c8",W=d.headerTextColor||"#000";if(a.call(this),this.internal.__cell__.printHeaders=j,this.internal.__cell__.margins=N,this.internal.__cell__.table_font_size=J,this.internal.__cell__.padding=L,this.internal.__cell__.headerBackgroundColor=G,this.internal.__cell__.headerTextColor=W,this.setFontSize(J),f==null)b=y=Object.keys(u[0]),w=y.map(function(){return"left"});else if(Array.isArray(f)&&tr(f[0])==="object")for(y=f.map(function(pe){return pe.name}),b=f.map(function(pe){return pe.prompt||pe.name||""}),w=f.map(function(pe){return pe.align||"left"}),h=0;h<f.length;h+=1)F[f[h].name]=f[h].width*(19.049976/25.4);else Array.isArray(f)&&typeof f[0]=="string"&&(b=y=f,w=y.map(function(){return"left"}));if(P||Array.isArray(f)&&typeof f[0]=="string")for(h=0;h<y.length;h+=1){for(T[_=y[h]]=u.map(function(pe){return pe[_]}),this.setFont(void 0,"bold"),I.push(this.getTextDimensions(b[h],{fontSize:this.internal.__cell__.table_font_size,scaleFactor:this.internal.scaleFactor}).w),g=T[_],this.setFont(void 0,"normal"),m=0;m<g.length;m+=1)I.push(this.getTextDimensions(g[m],{fontSize:this.internal.__cell__.table_font_size,scaleFactor:this.internal.scaleFactor}).w);F[_]=Math.max.apply(null,I)+L+L,I=[]}if(j){var le={};for(h=0;h<y.length;h+=1)le[y[h]]={},le[y[h]].text=b[h],le[y[h]].align=w[h];var de=o.call(this,le,F);A=y.map(function(pe){return new i(l,c,F[pe],de,le[pe].text,void 0,le[pe].align)}),this.setTableHeaderRow(A),this.printHeaderRow(1,!1)}var X=f.reduce(function(pe,me){return pe[me.name]=me.align,pe},{});for(h=0;h<u.length;h+=1){"rowStart"in d&&d.rowStart instanceof Function&&d.rowStart({row:h,data:u[h]},this);var ee=o.call(this,u[h],F);for(m=0;m<y.length;m+=1){var R=u[h][y[m]];"cellStart"in d&&d.cellStart instanceof Function&&d.cellStart({row:h,col:m,data:R},this),s.call(this,new i(l,c,F[y[m]],ee,R,h+2,X[y[m]]))}}return this.internal.__cell__.table_x=l,this.internal.__cell__.table_y=c,this};var o=function(l,c){var u=this.internal.__cell__.padding,f=this.internal.__cell__.table_font_size,d=this.internal.scaleFactor;return Object.keys(l).map(function(h){var g=l[h];return this.splitTextToSize(g.hasOwnProperty("text")?g.text:g,c[h]-u-u)},this).map(function(h){return this.getLineHeightFactor()*h.length*f/d+u+u},this).reduce(function(h,g){return Math.max(h,g)},0)};e.setTableHeaderRow=function(l){n.call(this),this.internal.__cell__.tableHeaderRow=l},e.printHeaderRow=function(l,c){if(n.call(this),!this.internal.__cell__.tableHeaderRow)throw new Error("Property tableHeaderRow does not exist.");var u;if(r=!0,typeof this.internal.__cell__.headerFunction=="function"){var f=this.internal.__cell__.headerFunction(this,this.internal.__cell__.pages);this.internal.__cell__.lastCell=new i(f[0],f[1],f[2],f[3],void 0,-1)}this.setFont(void 0,"bold");for(var d=[],h=0;h<this.internal.__cell__.tableHeaderRow.length;h+=1){u=this.internal.__cell__.tableHeaderRow[h].clone(),c&&(u.y=this.internal.__cell__.margins.top||0,d.push(u)),u.lineNumber=l;var g=this.getTextColor();this.setTextColor(this.internal.__cell__.headerTextColor),this.setFillColor(this.internal.__cell__.headerBackgroundColor),s.call(this,u),this.setTextColor(g)}d.length>0&&this.setTableHeaderRow(d),this.setFont(void 0,"normal"),r=!1}}(vt.API);var eC={italic:["italic","oblique","normal"],oblique:["oblique","italic","normal"],normal:["normal","oblique","italic"]},tC=["ultra-condensed","extra-condensed","condensed","semi-condensed","normal","semi-expanded","expanded","extra-expanded","ultra-expanded"],Ov=ZT(tC),rC=[100,200,300,400,500,600,700,800,900],hY=ZT(rC);function Iv(e){var t=e.family.replace(/"|'/g,"").toLowerCase(),r=function(i){return eC[i=i||"normal"]?i:"normal"}(e.style),n=function(i){if(!i)return 400;if(typeof i=="number")return i>=100&&i<=900&&i%100==0?i:400;if(/^\d00$/.test(i))return parseInt(i);switch(i){case"bold":return 700;case"normal":default:return 400}}(e.weight),a=function(i){return typeof Ov[i=i||"normal"]=="number"?i:"normal"}(e.stretch);return{family:t,style:r,weight:n,stretch:a,src:e.src||[],ref:e.ref||{name:t,style:[a,r,n].join(" ")}}}function I_(e,t,r,n){var a;for(a=r;a>=0&&a<t.length;a+=n)if(e[t[a]])return e[t[a]];for(a=r;a>=0&&a<t.length;a-=n)if(e[t[a]])return e[t[a]]}var dY={"sans-serif":"helvetica",fixed:"courier",monospace:"courier",terminal:"courier",cursive:"times",fantasy:"times",serif:"times"},D_={caption:"times",icon:"times",menu:"times","message-box":"times","small-caption":"times","status-bar":"times"};function j_(e){return[e.stretch,e.style,e.weight,e.family].join(" ")}function pY(e,t,r){for(var n=(r=r||{}).defaultFontFamily||"times",a=Object.assign({},dY,r.genericFontFamilies||{}),i=null,s=null,o=0;o<t.length;++o)if(a[(i=Iv(t[o])).family]&&(i.family=a[i.family]),e.hasOwnProperty(i.family)){s=e[i.family];break}if(!(s=s||e[n]))throw new Error("Could not find a font-family for the rule '"+j_(i)+"' and default family '"+n+"'.");if(s=function(l,c){if(c[l])return c[l];var u=Ov[l],f=u<=Ov.normal?-1:1,d=I_(c,tC,u,f);if(!d)throw new Error("Could not find a matching font-stretch value for "+l);return d}(i.stretch,s),s=function(l,c){if(c[l])return c[l];for(var u=eC[l],f=0;f<u.length;++f)if(c[u[f]])return c[u[f]];throw new Error("Could not find a matching font-style for "+l)}(i.style,s),!(s=function(l,c){if(c[l])return c[l];if(l===400&&c[500])return c[500];if(l===500&&c[400])return c[400];var u=hY[l],f=I_(c,rC,u,l<400?-1:1);if(!f)throw new Error("Could not find a matching font-weight for value "+l);return f}(i.weight,s)))throw new Error("Failed to resolve a font for the rule '"+j_(i)+"'.");return s}function R_(e){return e.trimLeft()}function mY(e,t){for(var r=0;r<e.length;){if(e.charAt(r)===t)return[e.substring(0,r),e.substring(r+1)];r+=1}return null}function gY(e){var t=e.match(/^(-[a-z_]|[a-z_])[a-z0-9_-]*/i);return t===null?null:[t[0],e.substring(t[0].length)]}var _p,M_,B_,j2=["times"];(function(e){var t,r,n,a,i,s,o,l,c,u=function(E){return E=E||{},this.isStrokeTransparent=E.isStrokeTransparent||!1,this.strokeOpacity=E.strokeOpacity||1,this.strokeStyle=E.strokeStyle||"#000000",this.fillStyle=E.fillStyle||"#000000",this.isFillTransparent=E.isFillTransparent||!1,this.fillOpacity=E.fillOpacity||1,this.font=E.font||"10px sans-serif",this.textBaseline=E.textBaseline||"alphabetic",this.textAlign=E.textAlign||"left",this.lineWidth=E.lineWidth||1,this.lineJoin=E.lineJoin||"miter",this.lineCap=E.lineCap||"butt",this.path=E.path||[],this.transform=E.transform!==void 0?E.transform.clone():new l,this.globalCompositeOperation=E.globalCompositeOperation||"normal",this.globalAlpha=E.globalAlpha||1,this.clip_path=E.clip_path||[],this.currentPoint=E.currentPoint||new s,this.miterLimit=E.miterLimit||10,this.lastPoint=E.lastPoint||new s,this.lineDashOffset=E.lineDashOffset||0,this.lineDash=E.lineDash||[],this.margin=E.margin||[0,0,0,0],this.prevPageLastElemOffset=E.prevPageLastElemOffset||0,this.ignoreClearRect=typeof E.ignoreClearRect!="boolean"||E.ignoreClearRect,this};e.events.push(["initialized",function(){this.context2d=new f(this),t=this.internal.f2,r=this.internal.getCoordinateString,n=this.internal.getVerticalCoordinateString,a=this.internal.getHorizontalCoordinate,i=this.internal.getVerticalCoordinate,s=this.internal.Point,o=this.internal.Rectangle,l=this.internal.Matrix,c=new u}]);var f=function(E){Object.defineProperty(this,"canvas",{get:function(){return{parentNode:!1,style:!1}}});var D=E;Object.defineProperty(this,"pdf",{get:function(){return D}});var O=!1;Object.defineProperty(this,"pageWrapXEnabled",{get:function(){return O},set:function(Te){O=!!Te}});var M=!1;Object.defineProperty(this,"pageWrapYEnabled",{get:function(){return M},set:function(Te){M=!!Te}});var K=0;Object.defineProperty(this,"posX",{get:function(){return K},set:function(Te){isNaN(Te)||(K=Te)}});var Y=0;Object.defineProperty(this,"posY",{get:function(){return Y},set:function(Te){isNaN(Te)||(Y=Te)}}),Object.defineProperty(this,"margin",{get:function(){return c.margin},set:function(Te){var oe;typeof Te=="number"?oe=[Te,Te,Te,Te]:((oe=new Array(4))[0]=Te[0],oe[1]=Te.length>=2?Te[1]:oe[0],oe[2]=Te.length>=3?Te[2]:oe[0],oe[3]=Te.length>=4?Te[3]:oe[1]),c.margin=oe}});var re=!1;Object.defineProperty(this,"autoPaging",{get:function(){return re},set:function(Te){re=Te}});var se=0;Object.defineProperty(this,"lastBreak",{get:function(){return se},set:function(Te){se=Te}});var xe=[];Object.defineProperty(this,"pageBreaks",{get:function(){return xe},set:function(Te){xe=Te}}),Object.defineProperty(this,"ctx",{get:function(){return c},set:function(Te){Te instanceof u&&(c=Te)}}),Object.defineProperty(this,"path",{get:function(){return c.path},set:function(Te){c.path=Te}});var Ce=[];Object.defineProperty(this,"ctxStack",{get:function(){return Ce},set:function(Te){Ce=Te}}),Object.defineProperty(this,"fillStyle",{get:function(){return this.ctx.fillStyle},set:function(Te){var oe;oe=d(Te),this.ctx.fillStyle=oe.style,this.ctx.isFillTransparent=oe.a===0,this.ctx.fillOpacity=oe.a,this.pdf.setFillColor(oe.r,oe.g,oe.b,{a:oe.a}),this.pdf.setTextColor(oe.r,oe.g,oe.b,{a:oe.a})}}),Object.defineProperty(this,"strokeStyle",{get:function(){return this.ctx.strokeStyle},set:function(Te){var oe=d(Te);this.ctx.strokeStyle=oe.style,this.ctx.isStrokeTransparent=oe.a===0,this.ctx.strokeOpacity=oe.a,oe.a===0?this.pdf.setDrawColor(255,255,255):(oe.a,this.pdf.setDrawColor(oe.r,oe.g,oe.b))}}),Object.defineProperty(this,"lineCap",{get:function(){return this.ctx.lineCap},set:function(Te){["butt","round","square"].indexOf(Te)!==-1&&(this.ctx.lineCap=Te,this.pdf.setLineCap(Te))}}),Object.defineProperty(this,"lineWidth",{get:function(){return this.ctx.lineWidth},set:function(Te){isNaN(Te)||(this.ctx.lineWidth=Te,this.pdf.setLineWidth(Te))}}),Object.defineProperty(this,"lineJoin",{get:function(){return this.ctx.lineJoin},set:function(Te){["bevel","round","miter"].indexOf(Te)!==-1&&(this.ctx.lineJoin=Te,this.pdf.setLineJoin(Te))}}),Object.defineProperty(this,"miterLimit",{get:function(){return this.ctx.miterLimit},set:function(Te){isNaN(Te)||(this.ctx.miterLimit=Te,this.pdf.setMiterLimit(Te))}}),Object.defineProperty(this,"textBaseline",{get:function(){return this.ctx.textBaseline},set:function(Te){this.ctx.textBaseline=Te}}),Object.defineProperty(this,"textAlign",{get:function(){return this.ctx.textAlign},set:function(Te){["right","end","center","left","start"].indexOf(Te)!==-1&&(this.ctx.textAlign=Te)}});var Z=null;function Ie(Te,oe){if(Z===null){var De=function(Xe){var Be=[];return Object.keys(Xe).forEach(function(Ge){Xe[Ge].forEach(function(Ye){var Je=null;switch(Ye){case"bold":Je={family:Ge,weight:"bold"};break;case"italic":Je={family:Ge,style:"italic"};break;case"bolditalic":Je={family:Ge,weight:"bold",style:"italic"};break;case"":case"normal":Je={family:Ge}}Je!==null&&(Je.ref={name:Ge,style:Ye},Be.push(Je))})}),Be}(Te.getFontList());Z=function(Xe){for(var Be={},Ge=0;Ge<Xe.length;++Ge){var Ye=Iv(Xe[Ge]),Je=Ye.family,ot=Ye.stretch,ct=Ye.style,gt=Ye.weight;Be[Je]=Be[Je]||{},Be[Je][ot]=Be[Je][ot]||{},Be[Je][ot][ct]=Be[Je][ot][ct]||{},Be[Je][ot][ct][gt]=Ye}return Be}(De.concat(oe))}return Z}var He=null;Object.defineProperty(this,"fontFaces",{get:function(){return He},set:function(Te){Z=null,He=Te}}),Object.defineProperty(this,"font",{get:function(){return this.ctx.font},set:function(Te){var oe;if(this.ctx.font=Te,(oe=/^\s*(?=(?:(?:[-a-z]+\s*){0,2}(italic|oblique))?)(?=(?:(?:[-a-z]+\s*){0,2}(small-caps))?)(?=(?:(?:[-a-z]+\s*){0,2}(bold(?:er)?|lighter|[1-9]00))?)(?:(?:normal|\1|\2|\3)\s*){0,3}((?:xx?-)?(?:small|large)|medium|smaller|larger|[.\d]+(?:\%|in|[cem]m|ex|p[ctx]))(?:\s*\/\s*(normal|[.\d]+(?:\%|in|[cem]m|ex|p[ctx])))?\s*([-_,\"\'\sa-z]+?)\s*$/i.exec(Te))!==null){var De=oe[1];oe[2];var Xe=oe[3],Be=oe[4];oe[5];var Ge=oe[6],Ye=/^([.\d]+)((?:%|in|[cem]m|ex|p[ctx]))$/i.exec(Be)[2];Be=Math.floor(Ye==="px"?parseFloat(Be)*this.pdf.internal.scaleFactor:Ye==="em"?parseFloat(Be)*this.pdf.getFontSize():parseFloat(Be)*this.pdf.internal.scaleFactor),this.pdf.setFontSize(Be);var Je=function(ut){var Ze,ze,Jt=[],dt=ut.trim();if(dt==="")return j2;if(dt in D_)return[D_[dt]];for(;dt!=="";){switch(ze=null,Ze=(dt=R_(dt)).charAt(0)){case'"':case"'":ze=mY(dt.substring(1),Ze);break;default:ze=gY(dt)}if(ze===null||(Jt.push(ze[0]),(dt=R_(ze[1]))!==""&&dt.charAt(0)!==","))return j2;dt=dt.replace(/^,/,"")}return Jt}(Ge);if(this.fontFaces){var ot=pY(Ie(this.pdf,this.fontFaces),Je.map(function(ut){return{family:ut,stretch:"normal",weight:Xe,style:De}}));this.pdf.setFont(ot.ref.name,ot.ref.style)}else{var ct="";(Xe==="bold"||parseInt(Xe,10)>=700||De==="bold")&&(ct="bold"),De==="italic"&&(ct+="italic"),ct.length===0&&(ct="normal");for(var gt="",bt={arial:"Helvetica",Arial:"Helvetica",verdana:"Helvetica",Verdana:"Helvetica",helvetica:"Helvetica",Helvetica:"Helvetica","sans-serif":"Helvetica",fixed:"Courier",monospace:"Courier",terminal:"Courier",cursive:"Times",fantasy:"Times",serif:"Times"},It=0;It<Je.length;It++){if(this.pdf.internal.getFont(Je[It],ct,{noFallback:!0,disableWarning:!0})!==void 0){gt=Je[It];break}if(ct==="bolditalic"&&this.pdf.internal.getFont(Je[It],"bold",{noFallback:!0,disableWarning:!0})!==void 0)gt=Je[It],ct="bold";else if(this.pdf.internal.getFont(Je[It],"normal",{noFallback:!0,disableWarning:!0})!==void 0){gt=Je[It],ct="normal";break}}if(gt===""){for(var Et=0;Et<Je.length;Et++)if(bt[Je[Et]]){gt=bt[Je[Et]];break}}gt=gt===""?"Times":gt,this.pdf.setFont(gt,ct)}}}}),Object.defineProperty(this,"globalCompositeOperation",{get:function(){return this.ctx.globalCompositeOperation},set:function(Te){this.ctx.globalCompositeOperation=Te}}),Object.defineProperty(this,"globalAlpha",{get:function(){return this.ctx.globalAlpha},set:function(Te){this.ctx.globalAlpha=Te}}),Object.defineProperty(this,"lineDashOffset",{get:function(){return this.ctx.lineDashOffset},set:function(Te){this.ctx.lineDashOffset=Te,me.call(this)}}),Object.defineProperty(this,"lineDash",{get:function(){return this.ctx.lineDash},set:function(Te){this.ctx.lineDash=Te,me.call(this)}}),Object.defineProperty(this,"ignoreClearRect",{get:function(){return this.ctx.ignoreClearRect},set:function(Te){this.ctx.ignoreClearRect=!!Te}})};f.prototype.setLineDash=function(E){this.lineDash=E},f.prototype.getLineDash=function(){return this.lineDash.length%2?this.lineDash.concat(this.lineDash):this.lineDash.slice()},f.prototype.fill=function(){T.call(this,"fill",!1)},f.prototype.stroke=function(){T.call(this,"stroke",!1)},f.prototype.beginPath=function(){this.path=[{type:"begin"}]},f.prototype.moveTo=function(E,D){if(isNaN(E)||isNaN(D))throw lr.error("jsPDF.context2d.moveTo: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.moveTo");var O=this.ctx.transform.applyToPoint(new s(E,D));this.path.push({type:"mt",x:O.x,y:O.y}),this.ctx.lastPoint=new s(E,D)},f.prototype.closePath=function(){var E=new s(0,0),D=0;for(D=this.path.length-1;D!==-1;D--)if(this.path[D].type==="begin"&&tr(this.path[D+1])==="object"&&typeof this.path[D+1].x=="number"){E=new s(this.path[D+1].x,this.path[D+1].y);break}this.path.push({type:"close"}),this.ctx.lastPoint=new s(E.x,E.y)},f.prototype.lineTo=function(E,D){if(isNaN(E)||isNaN(D))throw lr.error("jsPDF.context2d.lineTo: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.lineTo");var O=this.ctx.transform.applyToPoint(new s(E,D));this.path.push({type:"lt",x:O.x,y:O.y}),this.ctx.lastPoint=new s(O.x,O.y)},f.prototype.clip=function(){this.ctx.clip_path=JSON.parse(JSON.stringify(this.path)),T.call(this,null,!0)},f.prototype.quadraticCurveTo=function(E,D,O,M){if(isNaN(O)||isNaN(M)||isNaN(E)||isNaN(D))throw lr.error("jsPDF.context2d.quadraticCurveTo: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.quadraticCurveTo");var K=this.ctx.transform.applyToPoint(new s(O,M)),Y=this.ctx.transform.applyToPoint(new s(E,D));this.path.push({type:"qct",x1:Y.x,y1:Y.y,x:K.x,y:K.y}),this.ctx.lastPoint=new s(K.x,K.y)},f.prototype.bezierCurveTo=function(E,D,O,M,K,Y){if(isNaN(K)||isNaN(Y)||isNaN(E)||isNaN(D)||isNaN(O)||isNaN(M))throw lr.error("jsPDF.context2d.bezierCurveTo: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.bezierCurveTo");var re=this.ctx.transform.applyToPoint(new s(K,Y)),se=this.ctx.transform.applyToPoint(new s(E,D)),xe=this.ctx.transform.applyToPoint(new s(O,M));this.path.push({type:"bct",x1:se.x,y1:se.y,x2:xe.x,y2:xe.y,x:re.x,y:re.y}),this.ctx.lastPoint=new s(re.x,re.y)},f.prototype.arc=function(E,D,O,M,K,Y){if(isNaN(E)||isNaN(D)||isNaN(O)||isNaN(M)||isNaN(K))throw lr.error("jsPDF.context2d.arc: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.arc");if(Y=!!Y,!this.ctx.transform.isIdentity){var re=this.ctx.transform.applyToPoint(new s(E,D));E=re.x,D=re.y;var se=this.ctx.transform.applyToPoint(new s(0,O)),xe=this.ctx.transform.applyToPoint(new s(0,0));O=Math.sqrt(Math.pow(se.x-xe.x,2)+Math.pow(se.y-xe.y,2))}Math.abs(K-M)>=2*Math.PI&&(M=0,K=2*Math.PI),this.path.push({type:"arc",x:E,y:D,radius:O,startAngle:M,endAngle:K,counterclockwise:Y})},f.prototype.arcTo=function(E,D,O,M,K){throw new Error("arcTo not implemented.")},f.prototype.rect=function(E,D,O,M){if(isNaN(E)||isNaN(D)||isNaN(O)||isNaN(M))throw lr.error("jsPDF.context2d.rect: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.rect");this.moveTo(E,D),this.lineTo(E+O,D),this.lineTo(E+O,D+M),this.lineTo(E,D+M),this.lineTo(E,D),this.lineTo(E+O,D),this.lineTo(E,D)},f.prototype.fillRect=function(E,D,O,M){if(isNaN(E)||isNaN(D)||isNaN(O)||isNaN(M))throw lr.error("jsPDF.context2d.fillRect: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.fillRect");if(!h.call(this)){var K={};this.lineCap!=="butt"&&(K.lineCap=this.lineCap,this.lineCap="butt"),this.lineJoin!=="miter"&&(K.lineJoin=this.lineJoin,this.lineJoin="miter"),this.beginPath(),this.rect(E,D,O,M),this.fill(),K.hasOwnProperty("lineCap")&&(this.lineCap=K.lineCap),K.hasOwnProperty("lineJoin")&&(this.lineJoin=K.lineJoin)}},f.prototype.strokeRect=function(E,D,O,M){if(isNaN(E)||isNaN(D)||isNaN(O)||isNaN(M))throw lr.error("jsPDF.context2d.strokeRect: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.strokeRect");g.call(this)||(this.beginPath(),this.rect(E,D,O,M),this.stroke())},f.prototype.clearRect=function(E,D,O,M){if(isNaN(E)||isNaN(D)||isNaN(O)||isNaN(M))throw lr.error("jsPDF.context2d.clearRect: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.clearRect");this.ignoreClearRect||(this.fillStyle="#ffffff",this.fillRect(E,D,O,M))},f.prototype.save=function(E){E=typeof E!="boolean"||E;for(var D=this.pdf.internal.getCurrentPageInfo().pageNumber,O=0;O<this.pdf.internal.getNumberOfPages();O++)this.pdf.setPage(O+1),this.pdf.internal.out("q");if(this.pdf.setPage(D),E){this.ctx.fontSize=this.pdf.internal.getFontSize();var M=new u(this.ctx);this.ctxStack.push(this.ctx),this.ctx=M}},f.prototype.restore=function(E){E=typeof E!="boolean"||E;for(var D=this.pdf.internal.getCurrentPageInfo().pageNumber,O=0;O<this.pdf.internal.getNumberOfPages();O++)this.pdf.setPage(O+1),this.pdf.internal.out("Q");this.pdf.setPage(D),E&&this.ctxStack.length!==0&&(this.ctx=this.ctxStack.pop(),this.fillStyle=this.ctx.fillStyle,this.strokeStyle=this.ctx.strokeStyle,this.font=this.ctx.font,this.lineCap=this.ctx.lineCap,this.lineWidth=this.ctx.lineWidth,this.lineJoin=this.ctx.lineJoin,this.lineDash=this.ctx.lineDash,this.lineDashOffset=this.ctx.lineDashOffset)},f.prototype.toDataURL=function(){throw new Error("toDataUrl not implemented.")};var d=function(E){var D,O,M,K;if(E.isCanvasGradient===!0&&(E=E.getColor()),!E)return{r:0,g:0,b:0,a:0,style:E};if(/transparent|rgba\s*\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*,\s*0+\s*\)/.test(E))D=0,O=0,M=0,K=0;else{var Y=/rgb\s*\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*\)/.exec(E);if(Y!==null)D=parseInt(Y[1]),O=parseInt(Y[2]),M=parseInt(Y[3]),K=1;else if((Y=/rgba\s*\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*,\s*([\d.]+)\s*\)/.exec(E))!==null)D=parseInt(Y[1]),O=parseInt(Y[2]),M=parseInt(Y[3]),K=parseFloat(Y[4]);else{if(K=1,typeof E=="string"&&E.charAt(0)!=="#"){var re=new GT(E);E=re.ok?re.toHex():"#000000"}E.length===4?(D=E.substring(1,2),D+=D,O=E.substring(2,3),O+=O,M=E.substring(3,4),M+=M):(D=E.substring(1,3),O=E.substring(3,5),M=E.substring(5,7)),D=parseInt(D,16),O=parseInt(O,16),M=parseInt(M,16)}}return{r:D,g:O,b:M,a:K,style:E}},h=function(){return this.ctx.isFillTransparent||this.globalAlpha==0},g=function(){return!!(this.ctx.isStrokeTransparent||this.globalAlpha==0)};f.prototype.fillText=function(E,D,O,M){if(isNaN(D)||isNaN(O)||typeof E!="string")throw lr.error("jsPDF.context2d.fillText: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.fillText");if(M=isNaN(M)?void 0:M,!h.call(this)){var K=ee(this.ctx.transform.rotation),Y=this.ctx.transform.scaleX;L.call(this,{text:E,x:D,y:O,scale:Y,angle:K,align:this.textAlign,maxWidth:M})}},f.prototype.strokeText=function(E,D,O,M){if(isNaN(D)||isNaN(O)||typeof E!="string")throw lr.error("jsPDF.context2d.strokeText: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.strokeText");if(!g.call(this)){M=isNaN(M)?void 0:M;var K=ee(this.ctx.transform.rotation),Y=this.ctx.transform.scaleX;L.call(this,{text:E,x:D,y:O,scale:Y,renderingMode:"stroke",angle:K,align:this.textAlign,maxWidth:M})}},f.prototype.measureText=function(E){if(typeof E!="string")throw lr.error("jsPDF.context2d.measureText: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.measureText");var D=this.pdf,O=this.pdf.internal.scaleFactor,M=D.internal.getFontSize(),K=D.getStringUnitWidth(E)*M/D.internal.scaleFactor,Y=function(re){var se=(re=re||{}).width||0;return Object.defineProperty(this,"width",{get:function(){return se}}),this};return new Y({width:K*=Math.round(96*O/72*1e4)/1e4})},f.prototype.scale=function(E,D){if(isNaN(E)||isNaN(D))throw lr.error("jsPDF.context2d.scale: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.scale");var O=new l(E,0,0,D,0,0);this.ctx.transform=this.ctx.transform.multiply(O)},f.prototype.rotate=function(E){if(isNaN(E))throw lr.error("jsPDF.context2d.rotate: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.rotate");var D=new l(Math.cos(E),Math.sin(E),-Math.sin(E),Math.cos(E),0,0);this.ctx.transform=this.ctx.transform.multiply(D)},f.prototype.translate=function(E,D){if(isNaN(E)||isNaN(D))throw lr.error("jsPDF.context2d.translate: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.translate");var O=new l(1,0,0,1,E,D);this.ctx.transform=this.ctx.transform.multiply(O)},f.prototype.transform=function(E,D,O,M,K,Y){if(isNaN(E)||isNaN(D)||isNaN(O)||isNaN(M)||isNaN(K)||isNaN(Y))throw lr.error("jsPDF.context2d.transform: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.transform");var re=new l(E,D,O,M,K,Y);this.ctx.transform=this.ctx.transform.multiply(re)},f.prototype.setTransform=function(E,D,O,M,K,Y){E=isNaN(E)?1:E,D=isNaN(D)?0:D,O=isNaN(O)?0:O,M=isNaN(M)?1:M,K=isNaN(K)?0:K,Y=isNaN(Y)?0:Y,this.ctx.transform=new l(E,D,O,M,K,Y)};var m=function(){return this.margin[0]>0||this.margin[1]>0||this.margin[2]>0||this.margin[3]>0};f.prototype.drawImage=function(E,D,O,M,K,Y,re,se,xe){var Ce=this.pdf.getImageProperties(E),Z=1,Ie=1,He=1,Te=1;M!==void 0&&se!==void 0&&(He=se/M,Te=xe/K,Z=Ce.width/M*se/M,Ie=Ce.height/K*xe/K),Y===void 0&&(Y=D,re=O,D=0,O=0),M!==void 0&&se===void 0&&(se=M,xe=K),M===void 0&&se===void 0&&(se=Ce.width,xe=Ce.height);for(var oe,De=this.ctx.transform.decompose(),Xe=ee(De.rotate.shx),Be=new l,Ge=(Be=(Be=(Be=Be.multiply(De.translate)).multiply(De.skew)).multiply(De.scale)).applyToRectangle(new o(Y-D*He,re-O*Te,M*Z,K*Ie)),Ye=_.call(this,Ge),Je=[],ot=0;ot<Ye.length;ot+=1)Je.indexOf(Ye[ot])===-1&&Je.push(Ye[ot]);if(w(Je),this.autoPaging)for(var ct=Je[0],gt=Je[Je.length-1],bt=ct;bt<gt+1;bt++){this.pdf.setPage(bt);var It=this.pdf.internal.pageSize.width-this.margin[3]-this.margin[1],Et=bt===1?this.posY+this.margin[0]:this.margin[0],ut=this.pdf.internal.pageSize.height-this.posY-this.margin[0]-this.margin[2],Ze=this.pdf.internal.pageSize.height-this.margin[0]-this.margin[2],ze=bt===1?0:ut+(bt-2)*Ze;if(this.ctx.clip_path.length!==0){var Jt=this.path;oe=JSON.parse(JSON.stringify(this.ctx.clip_path)),this.path=b(oe,this.posX+this.margin[3],-ze+Et+this.ctx.prevPageLastElemOffset),F.call(this,"fill",!0),this.path=Jt}var dt=JSON.parse(JSON.stringify(Ge));dt=b([dt],this.posX+this.margin[3],-ze+Et+this.ctx.prevPageLastElemOffset)[0];var Zr=(bt>ct||bt<gt)&&m.call(this);Zr&&(this.pdf.saveGraphicsState(),this.pdf.rect(this.margin[3],this.margin[0],It,Ze,null).clip().discardPath()),this.pdf.addImage(E,"JPEG",dt.x,dt.y,dt.w,dt.h,null,null,Xe),Zr&&this.pdf.restoreGraphicsState()}else this.pdf.addImage(E,"JPEG",Ge.x,Ge.y,Ge.w,Ge.h,null,null,Xe)};var _=function(E,D,O){var M=[];D=D||this.pdf.internal.pageSize.width,O=O||this.pdf.internal.pageSize.height-this.margin[0]-this.margin[2];var K=this.posY+this.ctx.prevPageLastElemOffset;switch(E.type){default:case"mt":case"lt":M.push(Math.floor((E.y+K)/O)+1);break;case"arc":M.push(Math.floor((E.y+K-E.radius)/O)+1),M.push(Math.floor((E.y+K+E.radius)/O)+1);break;case"qct":var Y=R(this.ctx.lastPoint.x,this.ctx.lastPoint.y,E.x1,E.y1,E.x,E.y);M.push(Math.floor((Y.y+K)/O)+1),M.push(Math.floor((Y.y+Y.h+K)/O)+1);break;case"bct":var re=pe(this.ctx.lastPoint.x,this.ctx.lastPoint.y,E.x1,E.y1,E.x2,E.y2,E.x,E.y);M.push(Math.floor((re.y+K)/O)+1),M.push(Math.floor((re.y+re.h+K)/O)+1);break;case"rect":M.push(Math.floor((E.y+K)/O)+1),M.push(Math.floor((E.y+E.h+K)/O)+1)}for(var se=0;se<M.length;se+=1)for(;this.pdf.internal.getNumberOfPages()<M[se];)y.call(this);return M},y=function(){var E=this.fillStyle,D=this.strokeStyle,O=this.font,M=this.lineCap,K=this.lineWidth,Y=this.lineJoin;this.pdf.addPage(),this.fillStyle=E,this.strokeStyle=D,this.font=O,this.lineCap=M,this.lineWidth=K,this.lineJoin=Y},b=function(E,D,O){for(var M=0;M<E.length;M++)switch(E[M].type){case"bct":E[M].x2+=D,E[M].y2+=O;case"qct":E[M].x1+=D,E[M].y1+=O;case"mt":case"lt":case"arc":default:E[M].x+=D,E[M].y+=O}return E},w=function(E){return E.sort(function(D,O){return D-O})},T=function(E,D){for(var O,M,K=this.fillStyle,Y=this.strokeStyle,re=this.lineCap,se=this.lineWidth,xe=Math.abs(se*this.ctx.transform.scaleX),Ce=this.lineJoin,Z=JSON.parse(JSON.stringify(this.path)),Ie=JSON.parse(JSON.stringify(this.path)),He=[],Te=0;Te<Ie.length;Te++)if(Ie[Te].x!==void 0)for(var oe=_.call(this,Ie[Te]),De=0;De<oe.length;De+=1)He.indexOf(oe[De])===-1&&He.push(oe[De]);for(var Xe=0;Xe<He.length;Xe++)for(;this.pdf.internal.getNumberOfPages()<He[Xe];)y.call(this);if(w(He),this.autoPaging)for(var Be=He[0],Ge=He[He.length-1],Ye=Be;Ye<Ge+1;Ye++){this.pdf.setPage(Ye),this.fillStyle=K,this.strokeStyle=Y,this.lineCap=re,this.lineWidth=xe,this.lineJoin=Ce;var Je=this.pdf.internal.pageSize.width-this.margin[3]-this.margin[1],ot=Ye===1?this.posY+this.margin[0]:this.margin[0],ct=this.pdf.internal.pageSize.height-this.posY-this.margin[0]-this.margin[2],gt=this.pdf.internal.pageSize.height-this.margin[0]-this.margin[2],bt=Ye===1?0:ct+(Ye-2)*gt;if(this.ctx.clip_path.length!==0){var It=this.path;O=JSON.parse(JSON.stringify(this.ctx.clip_path)),this.path=b(O,this.posX+this.margin[3],-bt+ot+this.ctx.prevPageLastElemOffset),F.call(this,E,!0),this.path=It}if(M=JSON.parse(JSON.stringify(Z)),this.path=b(M,this.posX+this.margin[3],-bt+ot+this.ctx.prevPageLastElemOffset),D===!1||Ye===0){var Et=(Ye>Be||Ye<Ge)&&m.call(this);Et&&(this.pdf.saveGraphicsState(),this.pdf.rect(this.margin[3],this.margin[0],Je,gt,null).clip().discardPath()),F.call(this,E,D),Et&&this.pdf.restoreGraphicsState()}this.lineWidth=se}else this.lineWidth=xe,F.call(this,E,D),this.lineWidth=se;this.path=Z},F=function(E,D){if((E!=="stroke"||D||!g.call(this))&&(E==="stroke"||D||!h.call(this))){for(var O,M,K=[],Y=this.path,re=0;re<Y.length;re++){var se=Y[re];switch(se.type){case"begin":K.push({begin:!0});break;case"close":K.push({close:!0});break;case"mt":K.push({start:se,deltas:[],abs:[]});break;case"lt":var xe=K.length;if(Y[re-1]&&!isNaN(Y[re-1].x)&&(O=[se.x-Y[re-1].x,se.y-Y[re-1].y],xe>0)){for(;xe>=0;xe--)if(K[xe-1].close!==!0&&K[xe-1].begin!==!0){K[xe-1].deltas.push(O),K[xe-1].abs.push(se);break}}break;case"bct":O=[se.x1-Y[re-1].x,se.y1-Y[re-1].y,se.x2-Y[re-1].x,se.y2-Y[re-1].y,se.x-Y[re-1].x,se.y-Y[re-1].y],K[K.length-1].deltas.push(O);break;case"qct":var Ce=Y[re-1].x+2/3*(se.x1-Y[re-1].x),Z=Y[re-1].y+2/3*(se.y1-Y[re-1].y),Ie=se.x+2/3*(se.x1-se.x),He=se.y+2/3*(se.y1-se.y),Te=se.x,oe=se.y;O=[Ce-Y[re-1].x,Z-Y[re-1].y,Ie-Y[re-1].x,He-Y[re-1].y,Te-Y[re-1].x,oe-Y[re-1].y],K[K.length-1].deltas.push(O);break;case"arc":K.push({deltas:[],abs:[],arc:!0}),Array.isArray(K[K.length-1].abs)&&K[K.length-1].abs.push(se)}}M=D?null:E==="stroke"?"stroke":"fill";for(var De=!1,Xe=0;Xe<K.length;Xe++)if(K[Xe].arc)for(var Be=K[Xe].abs,Ge=0;Ge<Be.length;Ge++){var Ye=Be[Ge];Ye.type==="arc"?P.call(this,Ye.x,Ye.y,Ye.radius,Ye.startAngle,Ye.endAngle,Ye.counterclockwise,void 0,D,!De):G.call(this,Ye.x,Ye.y),De=!0}else if(K[Xe].close===!0)this.pdf.internal.out("h"),De=!1;else if(K[Xe].begin!==!0){var Je=K[Xe].start.x,ot=K[Xe].start.y;W.call(this,K[Xe].deltas,Je,ot),De=!0}M&&j.call(this,M),D&&J.call(this)}},I=function(E){var D=this.pdf.internal.getFontSize()/this.pdf.internal.scaleFactor,O=D*(this.pdf.internal.getLineHeightFactor()-1);switch(this.ctx.textBaseline){case"bottom":return E-O;case"top":return E+D-O;case"hanging":return E+D-2*O;case"middle":return E+D/2-O;case"ideographic":return E;case"alphabetic":default:return E}},A=function(E){return E+this.pdf.internal.getFontSize()/this.pdf.internal.scaleFactor*(this.pdf.internal.getLineHeightFactor()-1)};f.prototype.createLinearGradient=function(){var E=function(){};return E.colorStops=[],E.addColorStop=function(D,O){this.colorStops.push([D,O])},E.getColor=function(){return this.colorStops.length===0?"#000000":this.colorStops[0][1]},E.isCanvasGradient=!0,E},f.prototype.createPattern=function(){return this.createLinearGradient()},f.prototype.createRadialGradient=function(){return this.createLinearGradient()};var P=function(E,D,O,M,K,Y,re,se,xe){for(var Ce=de.call(this,O,M,K,Y),Z=0;Z<Ce.length;Z++){var Ie=Ce[Z];Z===0&&(xe?N.call(this,Ie.x1+E,Ie.y1+D):G.call(this,Ie.x1+E,Ie.y1+D)),le.call(this,E,D,Ie.x2,Ie.y2,Ie.x3,Ie.y3,Ie.x4,Ie.y4)}se?J.call(this):j.call(this,re)},j=function(E){switch(E){case"stroke":this.pdf.internal.out("S");break;case"fill":this.pdf.internal.out("f")}},J=function(){this.pdf.clip(),this.pdf.discardPath()},N=function(E,D){this.pdf.internal.out(r(E)+" "+n(D)+" m")},L=function(E){var D;switch(E.align){case"right":case"end":D="right";break;case"center":D="center";break;case"left":case"start":default:D="left"}var O=this.pdf.getTextDimensions(E.text),M=I.call(this,E.y),K=A.call(this,M)-O.h,Y=this.ctx.transform.applyToPoint(new s(E.x,M)),re=this.ctx.transform.decompose(),se=new l;se=(se=(se=se.multiply(re.translate)).multiply(re.skew)).multiply(re.scale);for(var xe,Ce,Z,Ie=this.ctx.transform.applyToRectangle(new o(E.x,M,O.w,O.h)),He=se.applyToRectangle(new o(E.x,K,O.w,O.h)),Te=_.call(this,He),oe=[],De=0;De<Te.length;De+=1)oe.indexOf(Te[De])===-1&&oe.push(Te[De]);if(w(oe),this.autoPaging)for(var Xe=oe[0],Be=oe[oe.length-1],Ge=Xe;Ge<Be+1;Ge++){this.pdf.setPage(Ge);var Ye=Ge===1?this.posY+this.margin[0]:this.margin[0],Je=this.pdf.internal.pageSize.height-this.posY-this.margin[0]-this.margin[2],ot=this.pdf.internal.pageSize.height-this.margin[2],ct=ot-this.margin[0],gt=this.pdf.internal.pageSize.width-this.margin[1],bt=gt-this.margin[3],It=Ge===1?0:Je+(Ge-2)*ct;if(this.ctx.clip_path.length!==0){var Et=this.path;xe=JSON.parse(JSON.stringify(this.ctx.clip_path)),this.path=b(xe,this.posX+this.margin[3],-1*It+Ye),F.call(this,"fill",!0),this.path=Et}var ut=b([JSON.parse(JSON.stringify(He))],this.posX+this.margin[3],-It+Ye+this.ctx.prevPageLastElemOffset)[0];E.scale>=.01&&(Ce=this.pdf.internal.getFontSize(),this.pdf.setFontSize(Ce*E.scale),Z=this.lineWidth,this.lineWidth=Z*E.scale);var Ze=this.autoPaging!=="text";if(Ze||ut.y+ut.h<=ot){if(Ze||ut.y>=Ye&&ut.x<=gt){var ze=Ze?E.text:this.pdf.splitTextToSize(E.text,E.maxWidth||gt-ut.x)[0],Jt=b([JSON.parse(JSON.stringify(Ie))],this.posX+this.margin[3],-It+Ye+this.ctx.prevPageLastElemOffset)[0],dt=Ze&&(Ge>Xe||Ge<Be)&&m.call(this);dt&&(this.pdf.saveGraphicsState(),this.pdf.rect(this.margin[3],this.margin[0],bt,ct,null).clip().discardPath()),this.pdf.text(ze,Jt.x,Jt.y,{angle:E.angle,align:D,renderingMode:E.renderingMode}),dt&&this.pdf.restoreGraphicsState()}}else ut.y<ot&&(this.ctx.prevPageLastElemOffset+=ot-ut.y);E.scale>=.01&&(this.pdf.setFontSize(Ce),this.lineWidth=Z)}else E.scale>=.01&&(Ce=this.pdf.internal.getFontSize(),this.pdf.setFontSize(Ce*E.scale),Z=this.lineWidth,this.lineWidth=Z*E.scale),this.pdf.text(E.text,Y.x+this.posX,Y.y+this.posY,{angle:E.angle,align:D,renderingMode:E.renderingMode,maxWidth:E.maxWidth}),E.scale>=.01&&(this.pdf.setFontSize(Ce),this.lineWidth=Z)},G=function(E,D,O,M){O=O||0,M=M||0,this.pdf.internal.out(r(E+O)+" "+n(D+M)+" l")},W=function(E,D,O){return this.pdf.lines(E,D,O,null,null)},le=function(E,D,O,M,K,Y,re,se){this.pdf.internal.out([t(a(O+E)),t(i(M+D)),t(a(K+E)),t(i(Y+D)),t(a(re+E)),t(i(se+D)),"c"].join(" "))},de=function(E,D,O,M){for(var K=2*Math.PI,Y=Math.PI/2;D>O;)D-=K;var re=Math.abs(O-D);re<K&&M&&(re=K-re);for(var se=[],xe=M?-1:1,Ce=D;re>1e-5;){var Z=Ce+xe*Math.min(re,Y);se.push(X.call(this,E,Ce,Z)),re-=Math.abs(Z-Ce),Ce=Z}return se},X=function(E,D,O){var M=(O-D)/2,K=E*Math.cos(M),Y=E*Math.sin(M),re=K,se=-Y,xe=re*re+se*se,Ce=xe+re*K+se*Y,Z=4/3*(Math.sqrt(2*xe*Ce)-Ce)/(re*Y-se*K),Ie=re-Z*se,He=se+Z*re,Te=Ie,oe=-He,De=M+D,Xe=Math.cos(De),Be=Math.sin(De);return{x1:E*Math.cos(D),y1:E*Math.sin(D),x2:Ie*Xe-He*Be,y2:Ie*Be+He*Xe,x3:Te*Xe-oe*Be,y3:Te*Be+oe*Xe,x4:E*Math.cos(O),y4:E*Math.sin(O)}},ee=function(E){return 180*E/Math.PI},R=function(E,D,O,M,K,Y){var re=E+.5*(O-E),se=D+.5*(M-D),xe=K+.5*(O-K),Ce=Y+.5*(M-Y),Z=Math.min(E,K,re,xe),Ie=Math.max(E,K,re,xe),He=Math.min(D,Y,se,Ce),Te=Math.max(D,Y,se,Ce);return new o(Z,He,Ie-Z,Te-He)},pe=function(E,D,O,M,K,Y,re,se){var xe,Ce,Z,Ie,He,Te,oe,De,Xe,Be,Ge,Ye,Je,ot,ct=O-E,gt=M-D,bt=K-O,It=Y-M,Et=re-K,ut=se-Y;for(Ce=0;Ce<41;Ce++)Xe=(oe=(Z=E+(xe=Ce/40)*ct)+xe*((He=O+xe*bt)-Z))+xe*(He+xe*(K+xe*Et-He)-oe),Be=(De=(Ie=D+xe*gt)+xe*((Te=M+xe*It)-Ie))+xe*(Te+xe*(Y+xe*ut-Te)-De),Ce==0?(Ge=Xe,Ye=Be,Je=Xe,ot=Be):(Ge=Math.min(Ge,Xe),Ye=Math.min(Ye,Be),Je=Math.max(Je,Xe),ot=Math.max(ot,Be));return new o(Math.round(Ge),Math.round(Ye),Math.round(Je-Ge),Math.round(ot-Ye))},me=function(){if(this.prevLineDash||this.ctx.lineDash.length||this.ctx.lineDashOffset){var E,D,O=(E=this.ctx.lineDash,D=this.ctx.lineDashOffset,JSON.stringify({lineDash:E,lineDashOffset:D}));this.prevLineDash!==O&&(this.pdf.setLineDash(this.ctx.lineDash,this.ctx.lineDashOffset),this.prevLineDash=O)}}})(vt.API),function(e){var t=function(i){var s,o,l,c,u,f,d,h,g,m;for(o=[],l=0,c=(i+=s="\0\0\0\0".slice(i.length%4||4)).length;c>l;l+=4)(u=(i.charCodeAt(l)<<24)+(i.charCodeAt(l+1)<<16)+(i.charCodeAt(l+2)<<8)+i.charCodeAt(l+3))!==0?(f=(u=((u=((u=((u=(u-(m=u%85))/85)-(g=u%85))/85)-(h=u%85))/85)-(d=u%85))/85)%85,o.push(f+33,d+33,h+33,g+33,m+33)):o.push(122);return function(_,y){for(var b=y;b>0;b--)_.pop()}(o,s.length),String.fromCharCode.apply(String,o)+"~>"},r=function(i){var s,o,l,c,u,f=String,d="length",h=255,g="charCodeAt",m="slice",_="replace";for(i[m](-2),i=i[m](0,-2)[_](/\s/g,"")[_]("z","!!!!!"),l=[],c=0,u=(i+=s="uuuuu"[m](i[d]%5||5))[d];u>c;c+=5)o=52200625*(i[g](c)-33)+614125*(i[g](c+1)-33)+7225*(i[g](c+2)-33)+85*(i[g](c+3)-33)+(i[g](c+4)-33),l.push(h&o>>24,h&o>>16,h&o>>8,h&o);return function(y,b){for(var w=b;w>0;w--)y.pop()}(l,s[d]),f.fromCharCode.apply(f,l)},n=function(i){var s=new RegExp(/^([0-9A-Fa-f]{2})+$/);if((i=i.replace(/\s/g,"")).indexOf(">")!==-1&&(i=i.substr(0,i.indexOf(">"))),i.length%2&&(i+="0"),s.test(i)===!1)return"";for(var o="",l=0;l<i.length;l+=2)o+=String.fromCharCode("0x"+(i[l]+i[l+1]));return o},a=function(i){for(var s=new Uint8Array(i.length),o=i.length;o--;)s[o]=i.charCodeAt(o);return i=(s=Cv(s)).reduce(function(l,c){return l+String.fromCharCode(c)},"")};e.processDataByFilters=function(i,s){var o=0,l=i||"",c=[];for(typeof(s=s||[])=="string"&&(s=[s]),o=0;o<s.length;o+=1)switch(s[o]){case"ASCII85Decode":case"/ASCII85Decode":l=r(l),c.push("/ASCII85Encode");break;case"ASCII85Encode":case"/ASCII85Encode":l=t(l),c.push("/ASCII85Decode");break;case"ASCIIHexDecode":case"/ASCIIHexDecode":l=n(l),c.push("/ASCIIHexEncode");break;case"ASCIIHexEncode":case"/ASCIIHexEncode":l=l.split("").map(function(u){return("0"+u.charCodeAt().toString(16)).slice(-2)}).join("")+">",c.push("/ASCIIHexDecode");break;case"FlateEncode":case"/FlateEncode":l=a(l),c.push("/FlateDecode");break;default:throw new Error('The filter: "'+s[o]+'" is not implemented')}return{data:l,reverseChain:c.reverse().join(" ")}}}(vt.API),function(e){e.loadFile=function(t,r,n){return function(a,i,s){i=i!==!1,s=typeof s=="function"?s:function(){};var o=void 0;try{o=function(l,c,u){var f=new XMLHttpRequest,d=0,h=function(g){var m=g.length,_=[],y=String.fromCharCode;for(d=0;d<m;d+=1)_.push(y(255&g.charCodeAt(d)));return _.join("")};if(f.open("GET",l,!c),f.overrideMimeType("text/plain; charset=x-user-defined"),c===!1&&(f.onload=function(){f.status===200?u(h(this.responseText)):u(void 0)}),f.send(null),c&&f.status===200)return h(f.responseText)}(a,i,s)}catch{}return o}(t,r,n)},e.loadImageFile=e.loadFile}(vt.API),function(e){function t(){return(yt.html2canvas?Promise.resolve(yt.html2canvas):tl(()=>import("./html2canvas.esm-CBrSDip1.js"),[])).catch(function(s){return Promise.reject(new Error("Could not load html2canvas: "+s))}).then(function(s){return s.default?s.default:s})}function r(){return(yt.DOMPurify?Promise.resolve(yt.DOMPurify):tl(()=>import("./purify.es-BFmuJLeH.js"),[])).catch(function(s){return Promise.reject(new Error("Could not load dompurify: "+s))}).then(function(s){return s.default?s.default:s})}var n=function(s){var o=tr(s);return o==="undefined"?"undefined":o==="string"||s instanceof String?"string":o==="number"||s instanceof Number?"number":o==="function"||s instanceof Function?"function":s&&s.constructor===Array?"array":s&&s.nodeType===1?"element":o==="object"?"object":"unknown"},a=function(s,o){var l=document.createElement(s);for(var c in o.className&&(l.className=o.className),o.innerHTML&&o.dompurify&&(l.innerHTML=o.dompurify.sanitize(o.innerHTML)),o.style)l.style[c]=o.style[c];return l},i=function s(o){var l=Object.assign(s.convert(Promise.resolve()),JSON.parse(JSON.stringify(s.template))),c=s.convert(Promise.resolve(),l);return c=(c=c.setProgress(1,s,1,[s])).set(o)};(i.prototype=Object.create(Promise.prototype)).constructor=i,i.convert=function(s,o){return s.__proto__=o||i.prototype,s},i.template={prop:{src:null,container:null,overlay:null,canvas:null,img:null,pdf:null,pageSize:null,callback:function(){}},progress:{val:0,state:null,n:0,stack:[]},opt:{filename:"file.pdf",margin:[0,0,0,0],enableLinks:!0,x:0,y:0,html2canvas:{},jsPDF:{},backgroundColor:"transparent"}},i.prototype.from=function(s,o){return this.then(function(){switch(o=o||function(l){switch(n(l)){case"string":return"string";case"element":return l.nodeName.toLowerCase()==="canvas"?"canvas":"element";default:return"unknown"}}(s)){case"string":return this.then(r).then(function(l){return this.set({src:a("div",{innerHTML:s,dompurify:l})})});case"element":return this.set({src:s});case"canvas":return this.set({canvas:s});case"img":return this.set({img:s});default:return this.error("Unknown source type.")}})},i.prototype.to=function(s){switch(s){case"container":return this.toContainer();case"canvas":return this.toCanvas();case"img":return this.toImg();case"pdf":return this.toPdf();default:return this.error("Invalid target.")}},i.prototype.toContainer=function(){return this.thenList([function(){return this.prop.src||this.error("Cannot duplicate - no source HTML.")},function(){return this.prop.pageSize||this.setPageSize()}]).then(function(){var s={position:"relative",display:"inline-block",width:(typeof this.opt.width!="number"||isNaN(this.opt.width)||typeof this.opt.windowWidth!="number"||isNaN(this.opt.windowWidth)?Math.max(this.prop.src.clientWidth,this.prop.src.scrollWidth,this.prop.src.offsetWidth):this.opt.windowWidth)+"px",left:0,right:0,top:0,margin:"auto",backgroundColor:this.opt.backgroundColor},o=function l(c,u){for(var f=c.nodeType===3?document.createTextNode(c.nodeValue):c.cloneNode(!1),d=c.firstChild;d;d=d.nextSibling)u!==!0&&d.nodeType===1&&d.nodeName==="SCRIPT"||f.appendChild(l(d,u));return c.nodeType===1&&(c.nodeName==="CANVAS"?(f.width=c.width,f.height=c.height,f.getContext("2d").drawImage(c,0,0)):c.nodeName!=="TEXTAREA"&&c.nodeName!=="SELECT"||(f.value=c.value),f.addEventListener("load",function(){f.scrollTop=c.scrollTop,f.scrollLeft=c.scrollLeft},!0)),f}(this.prop.src,this.opt.html2canvas.javascriptEnabled);o.tagName==="BODY"&&(s.height=Math.max(document.body.scrollHeight,document.body.offsetHeight,document.documentElement.clientHeight,document.documentElement.scrollHeight,document.documentElement.offsetHeight)+"px"),this.prop.overlay=a("div",{className:"html2pdf__overlay",style:{position:"fixed",overflow:"hidden",zIndex:1e3,left:"-100000px",right:0,bottom:0,top:0}}),this.prop.container=a("div",{className:"html2pdf__container",style:s}),this.prop.container.appendChild(o),this.prop.container.firstChild.appendChild(a("div",{style:{clear:"both",border:"0 none transparent",margin:0,padding:0,height:0}})),this.prop.container.style.float="none",this.prop.overlay.appendChild(this.prop.container),document.body.appendChild(this.prop.overlay),this.prop.container.firstChild.style.position="relative",this.prop.container.height=Math.max(this.prop.container.firstChild.clientHeight,this.prop.container.firstChild.scrollHeight,this.prop.container.firstChild.offsetHeight)+"px"})},i.prototype.toCanvas=function(){var s=[function(){return document.body.contains(this.prop.container)||this.toContainer()}];return this.thenList(s).then(t).then(function(o){var l=Object.assign({},this.opt.html2canvas);return delete l.onrendered,o(this.prop.container,l)}).then(function(o){(this.opt.html2canvas.onrendered||function(){})(o),this.prop.canvas=o,document.body.removeChild(this.prop.overlay)})},i.prototype.toContext2d=function(){var s=[function(){return document.body.contains(this.prop.container)||this.toContainer()}];return this.thenList(s).then(t).then(function(o){var l=this.opt.jsPDF,c=this.opt.fontFaces,u=typeof this.opt.width!="number"||isNaN(this.opt.width)||typeof this.opt.windowWidth!="number"||isNaN(this.opt.windowWidth)?1:this.opt.width/this.opt.windowWidth,f=Object.assign({async:!0,allowTaint:!0,scale:u,scrollX:this.opt.scrollX||0,scrollY:this.opt.scrollY||0,backgroundColor:"#ffffff",imageTimeout:15e3,logging:!0,proxy:null,removeContainer:!0,foreignObjectRendering:!1,useCORS:!1},this.opt.html2canvas);if(delete f.onrendered,l.context2d.autoPaging=this.opt.autoPaging===void 0||this.opt.autoPaging,l.context2d.posX=this.opt.x,l.context2d.posY=this.opt.y,l.context2d.margin=this.opt.margin,l.context2d.fontFaces=c,c)for(var d=0;d<c.length;++d){var h=c[d],g=h.src.find(function(m){return m.format==="truetype"});g&&l.addFont(g.url,h.ref.name,h.ref.style)}return f.windowHeight=f.windowHeight||0,f.windowHeight=f.windowHeight==0?Math.max(this.prop.container.clientHeight,this.prop.container.scrollHeight,this.prop.container.offsetHeight):f.windowHeight,l.context2d.save(!0),o(this.prop.container,f)}).then(function(o){this.opt.jsPDF.context2d.restore(!0),(this.opt.html2canvas.onrendered||function(){})(o),this.prop.canvas=o,document.body.removeChild(this.prop.overlay)})},i.prototype.toImg=function(){return this.thenList([function(){return this.prop.canvas||this.toCanvas()}]).then(function(){var s=this.prop.canvas.toDataURL("image/"+this.opt.image.type,this.opt.image.quality);this.prop.img=document.createElement("img"),this.prop.img.src=s})},i.prototype.toPdf=function(){return this.thenList([function(){return this.toContext2d()}]).then(function(){this.prop.pdf=this.prop.pdf||this.opt.jsPDF})},i.prototype.output=function(s,o,l){return(l=l||"pdf").toLowerCase()==="img"||l.toLowerCase()==="image"?this.outputImg(s,o):this.outputPdf(s,o)},i.prototype.outputPdf=function(s,o){return this.thenList([function(){return this.prop.pdf||this.toPdf()}]).then(function(){return this.prop.pdf.output(s,o)})},i.prototype.outputImg=function(s){return this.thenList([function(){return this.prop.img||this.toImg()}]).then(function(){switch(s){case void 0:case"img":return this.prop.img;case"datauristring":case"dataurlstring":return this.prop.img.src;case"datauri":case"dataurl":return document.location.href=this.prop.img.src;default:throw'Image output type "'+s+'" is not supported.'}})},i.prototype.save=function(s){return this.thenList([function(){return this.prop.pdf||this.toPdf()}]).set(s?{filename:s}:null).then(function(){this.prop.pdf.save(this.opt.filename)})},i.prototype.doCallback=function(){return this.thenList([function(){return this.prop.pdf||this.toPdf()}]).then(function(){this.prop.callback(this.prop.pdf)})},i.prototype.set=function(s){if(n(s)!=="object")return this;var o=Object.keys(s||{}).map(function(l){if(l in i.template.prop)return function(){this.prop[l]=s[l]};switch(l){case"margin":return this.setMargin.bind(this,s.margin);case"jsPDF":return function(){return this.opt.jsPDF=s.jsPDF,this.setPageSize()};case"pageSize":return this.setPageSize.bind(this,s.pageSize);default:return function(){this.opt[l]=s[l]}}},this);return this.then(function(){return this.thenList(o)})},i.prototype.get=function(s,o){return this.then(function(){var l=s in i.template.prop?this.prop[s]:this.opt[s];return o?o(l):l})},i.prototype.setMargin=function(s){return this.then(function(){switch(n(s)){case"number":s=[s,s,s,s];case"array":if(s.length===2&&(s=[s[0],s[1],s[0],s[1]]),s.length===4)break;default:return this.error("Invalid margin array.")}this.opt.margin=s}).then(this.setPageSize)},i.prototype.setPageSize=function(s){function o(l,c){return Math.floor(l*c/72*96)}return this.then(function(){(s=s||vt.getPageSize(this.opt.jsPDF)).hasOwnProperty("inner")||(s.inner={width:s.width-this.opt.margin[1]-this.opt.margin[3],height:s.height-this.opt.margin[0]-this.opt.margin[2]},s.inner.px={width:o(s.inner.width,s.k),height:o(s.inner.height,s.k)},s.inner.ratio=s.inner.height/s.inner.width),this.prop.pageSize=s})},i.prototype.setProgress=function(s,o,l,c){return s!=null&&(this.progress.val=s),o!=null&&(this.progress.state=o),l!=null&&(this.progress.n=l),c!=null&&(this.progress.stack=c),this.progress.ratio=this.progress.val/this.progress.state,this},i.prototype.updateProgress=function(s,o,l,c){return this.setProgress(s?this.progress.val+s:null,o||null,l?this.progress.n+l:null,c?this.progress.stack.concat(c):null)},i.prototype.then=function(s,o){var l=this;return this.thenCore(s,o,function(c,u){return l.updateProgress(null,null,1,[c]),Promise.prototype.then.call(this,function(f){return l.updateProgress(null,c),f}).then(c,u).then(function(f){return l.updateProgress(1),f})})},i.prototype.thenCore=function(s,o,l){l=l||Promise.prototype.then,s&&(s=s.bind(this)),o&&(o=o.bind(this));var c=Promise.toString().indexOf("[native code]")!==-1&&Promise.name==="Promise"?this:i.convert(Object.assign({},this),Promise.prototype),u=l.call(c,s,o);return i.convert(u,this.__proto__)},i.prototype.thenExternal=function(s,o){return Promise.prototype.then.call(this,s,o)},i.prototype.thenList=function(s){var o=this;return s.forEach(function(l){o=o.thenCore(l)}),o},i.prototype.catch=function(s){s&&(s=s.bind(this));var o=Promise.prototype.catch.call(this,s);return i.convert(o,this)},i.prototype.catchExternal=function(s){return Promise.prototype.catch.call(this,s)},i.prototype.error=function(s){return this.then(function(){throw new Error(s)})},i.prototype.using=i.prototype.set,i.prototype.saveAs=i.prototype.save,i.prototype.export=i.prototype.output,i.prototype.run=i.prototype.then,vt.getPageSize=function(s,o,l){if(tr(s)==="object"){var c=s;s=c.orientation,o=c.unit||o,l=c.format||l}o=o||"mm",l=l||"a4",s=(""+(s||"P")).toLowerCase();var u,f=(""+l).toLowerCase(),d={a0:[2383.94,3370.39],a1:[1683.78,2383.94],a2:[1190.55,1683.78],a3:[841.89,1190.55],a4:[595.28,841.89],a5:[419.53,595.28],a6:[297.64,419.53],a7:[209.76,297.64],a8:[147.4,209.76],a9:[104.88,147.4],a10:[73.7,104.88],b0:[2834.65,4008.19],b1:[2004.09,2834.65],b2:[1417.32,2004.09],b3:[1000.63,1417.32],b4:[708.66,1000.63],b5:[498.9,708.66],b6:[354.33,498.9],b7:[249.45,354.33],b8:[175.75,249.45],b9:[124.72,175.75],b10:[87.87,124.72],c0:[2599.37,3676.54],c1:[1836.85,2599.37],c2:[1298.27,1836.85],c3:[918.43,1298.27],c4:[649.13,918.43],c5:[459.21,649.13],c6:[323.15,459.21],c7:[229.61,323.15],c8:[161.57,229.61],c9:[113.39,161.57],c10:[79.37,113.39],dl:[311.81,623.62],letter:[612,792],"government-letter":[576,756],legal:[612,1008],"junior-legal":[576,360],ledger:[1224,792],tabloid:[792,1224],"credit-card":[153,243]};switch(o){case"pt":u=1;break;case"mm":u=72/25.4;break;case"cm":u=72/2.54;break;case"in":u=72;break;case"px":u=.75;break;case"pc":case"em":u=12;break;case"ex":u=6;break;default:throw"Invalid unit: "+o}var h,g=0,m=0;if(d.hasOwnProperty(f))g=d[f][1]/u,m=d[f][0]/u;else try{g=l[1],m=l[0]}catch{throw new Error("Invalid format: "+l)}if(s==="p"||s==="portrait")s="p",m>g&&(h=m,m=g,g=h);else{if(s!=="l"&&s!=="landscape")throw"Invalid orientation: "+s;s="l",g>m&&(h=m,m=g,g=h)}return{width:m,height:g,unit:o,k:u,orientation:s}},e.html=function(s,o){(o=o||{}).callback=o.callback||function(){},o.html2canvas=o.html2canvas||{},o.html2canvas.canvas=o.html2canvas.canvas||this.canvas,o.jsPDF=o.jsPDF||this,o.fontFaces=o.fontFaces?o.fontFaces.map(Iv):null;var l=new i(o);return o.worker?l:l.from(s).doCallback()}}(vt.API),vt.API.addJS=function(e){return B_=e,this.internal.events.subscribe("postPutResources",function(){_p=this.internal.newObject(),this.internal.out("<<"),this.internal.out("/Names [(EmbeddedJS) "+(_p+1)+" 0 R]"),this.internal.out(">>"),this.internal.out("endobj"),M_=this.internal.newObject(),this.internal.out("<<"),this.internal.out("/S /JavaScript"),this.internal.out("/JS ("+B_+")"),this.internal.out(">>"),this.internal.out("endobj")}),this.internal.events.subscribe("putCatalog",function(){_p!==void 0&&M_!==void 0&&this.internal.out("/Names <</JavaScript "+_p+" 0 R>>")}),this},function(e){var t;e.events.push(["postPutResources",function(){var r=this,n=/^(\d+) 0 obj$/;if(this.outline.root.children.length>0)for(var a=r.outline.render().split(/\r\n/),i=0;i<a.length;i++){var s=a[i],o=n.exec(s);if(o!=null){var l=o[1];r.internal.newObjectDeferredBegin(l,!1)}r.internal.write(s)}if(this.outline.createNamedDestinations){var c=this.internal.pages.length,u=[];for(i=0;i<c;i++){var f=r.internal.newObject();u.push(f);var d=r.internal.getPageInfo(i+1);r.internal.write("<< /D["+d.objId+" 0 R /XYZ null null null]>> endobj")}var h=r.internal.newObject();for(r.internal.write("<< /Names [ "),i=0;i<u.length;i++)r.internal.write("(page_"+(i+1)+")"+u[i]+" 0 R");r.internal.write(" ] >>","endobj"),t=r.internal.newObject(),r.internal.write("<< /Dests "+h+" 0 R"),r.internal.write(">>","endobj")}}]),e.events.push(["putCatalog",function(){this.outline.root.children.length>0&&(this.internal.write("/Outlines",this.outline.makeRef(this.outline.root)),this.outline.createNamedDestinations&&this.internal.write("/Names "+t+" 0 R"))}]),e.events.push(["initialized",function(){var r=this;r.outline={createNamedDestinations:!1,root:{children:[]}},r.outline.add=function(n,a,i){var s={title:a,options:i,children:[]};return n==null&&(n=this.root),n.children.push(s),s},r.outline.render=function(){return this.ctx={},this.ctx.val="",this.ctx.pdf=r,this.genIds_r(this.root),this.renderRoot(this.root),this.renderItems(this.root),this.ctx.val},r.outline.genIds_r=function(n){n.id=r.internal.newObjectDeferred();for(var a=0;a<n.children.length;a++)this.genIds_r(n.children[a])},r.outline.renderRoot=function(n){this.objStart(n),this.line("/Type /Outlines"),n.children.length>0&&(this.line("/First "+this.makeRef(n.children[0])),this.line("/Last "+this.makeRef(n.children[n.children.length-1]))),this.line("/Count "+this.count_r({count:0},n)),this.objEnd()},r.outline.renderItems=function(n){for(var a=this.ctx.pdf.internal.getVerticalCoordinateString,i=0;i<n.children.length;i++){var s=n.children[i];this.objStart(s),this.line("/Title "+this.makeString(s.title)),this.line("/Parent "+this.makeRef(n)),i>0&&this.line("/Prev "+this.makeRef(n.children[i-1])),i<n.children.length-1&&this.line("/Next "+this.makeRef(n.children[i+1])),s.children.length>0&&(this.line("/First "+this.makeRef(s.children[0])),this.line("/Last "+this.makeRef(s.children[s.children.length-1])));var o=this.count=this.count_r({count:0},s);if(o>0&&this.line("/Count "+o),s.options&&s.options.pageNumber){var l=r.internal.getPageInfo(s.options.pageNumber);this.line("/Dest ["+l.objId+" 0 R /XYZ 0 "+a(0)+" 0]")}this.objEnd()}for(var c=0;c<n.children.length;c++)this.renderItems(n.children[c])},r.outline.line=function(n){this.ctx.val+=n+`\r
`},r.outline.makeRef=function(n){return n.id+" 0 R"},r.outline.makeString=function(n){return"("+r.internal.pdfEscape(n)+")"},r.outline.objStart=function(n){this.ctx.val+=`\r
`+n.id+` 0 obj\r
<<\r
`},r.outline.objEnd=function(){this.ctx.val+=`>> \r
endobj\r
`},r.outline.count_r=function(n,a){for(var i=0;i<a.children.length;i++)n.count++,this.count_r(n,a.children[i]);return n.count}}])}(vt.API),function(e){var t=[192,193,194,195,196,197,198,199];e.processJPEG=function(r,n,a,i,s,o){var l,c=this.decode.DCT_DECODE,u=null;if(typeof r=="string"||this.__addimage__.isArrayBuffer(r)||this.__addimage__.isArrayBufferView(r)){switch(r=s||r,r=this.__addimage__.isArrayBuffer(r)?new Uint8Array(r):r,(l=function(f){for(var d,h=256*f.charCodeAt(4)+f.charCodeAt(5),g=f.length,m={width:0,height:0,numcomponents:1},_=4;_<g;_+=2){if(_+=h,t.indexOf(f.charCodeAt(_+1))!==-1){d=256*f.charCodeAt(_+5)+f.charCodeAt(_+6),m={width:256*f.charCodeAt(_+7)+f.charCodeAt(_+8),height:d,numcomponents:f.charCodeAt(_+9)};break}h=256*f.charCodeAt(_+2)+f.charCodeAt(_+3)}return m}(r=this.__addimage__.isArrayBufferView(r)?this.__addimage__.arrayBufferToBinaryString(r):r)).numcomponents){case 1:o=this.color_spaces.DEVICE_GRAY;break;case 4:o=this.color_spaces.DEVICE_CMYK;break;case 3:o=this.color_spaces.DEVICE_RGB}u={data:r,width:l.width,height:l.height,colorSpace:o,bitsPerComponent:8,filter:c,index:n,alias:a}}return u}}(vt.API);var Jc,Sp,U_,$_,V_,xY=function(){var e,t,r;function n(i){var s,o,l,c,u,f,d,h,g,m,_,y,b,w;for(this.data=i,this.pos=8,this.palette=[],this.imgData=[],this.transparency={},this.animation=null,this.text={},f=null;;){switch(s=this.readUInt32(),g=(function(){var T,F;for(F=[],T=0;T<4;++T)F.push(String.fromCharCode(this.data[this.pos++]));return F}).call(this).join("")){case"IHDR":this.width=this.readUInt32(),this.height=this.readUInt32(),this.bits=this.data[this.pos++],this.colorType=this.data[this.pos++],this.compressionMethod=this.data[this.pos++],this.filterMethod=this.data[this.pos++],this.interlaceMethod=this.data[this.pos++];break;case"acTL":this.animation={numFrames:this.readUInt32(),numPlays:this.readUInt32()||1/0,frames:[]};break;case"PLTE":this.palette=this.read(s);break;case"fcTL":f&&this.animation.frames.push(f),this.pos+=4,f={width:this.readUInt32(),height:this.readUInt32(),xOffset:this.readUInt32(),yOffset:this.readUInt32()},u=this.readUInt16(),c=this.readUInt16()||100,f.delay=1e3*u/c,f.disposeOp=this.data[this.pos++],f.blendOp=this.data[this.pos++],f.data=[];break;case"IDAT":case"fdAT":for(g==="fdAT"&&(this.pos+=4,s-=4),i=(f!=null?f.data:void 0)||this.imgData,y=0;0<=s?y<s:y>s;0<=s?++y:--y)i.push(this.data[this.pos++]);break;case"tRNS":switch(this.transparency={},this.colorType){case 3:if(l=this.palette.length/3,this.transparency.indexed=this.read(s),this.transparency.indexed.length>l)throw new Error("More transparent colors than palette size");if((m=l-this.transparency.indexed.length)>0)for(b=0;0<=m?b<m:b>m;0<=m?++b:--b)this.transparency.indexed.push(255);break;case 0:this.transparency.grayscale=this.read(s)[0];break;case 2:this.transparency.rgb=this.read(s)}break;case"tEXt":d=(_=this.read(s)).indexOf(0),h=String.fromCharCode.apply(String,_.slice(0,d)),this.text[h]=String.fromCharCode.apply(String,_.slice(d+1));break;case"IEND":return f&&this.animation.frames.push(f),this.colors=(function(){switch(this.colorType){case 0:case 3:case 4:return 1;case 2:case 6:return 3}}).call(this),this.hasAlphaChannel=(w=this.colorType)===4||w===6,o=this.colors+(this.hasAlphaChannel?1:0),this.pixelBitlength=this.bits*o,this.colorSpace=(function(){switch(this.colors){case 1:return"DeviceGray";case 3:return"DeviceRGB"}}).call(this),void(this.imgData=new Uint8Array(this.imgData));default:this.pos+=s}if(this.pos+=4,this.pos>this.data.length)throw new Error("Incomplete or corrupt PNG file")}}n.prototype.read=function(i){var s,o;for(o=[],s=0;0<=i?s<i:s>i;0<=i?++s:--s)o.push(this.data[this.pos++]);return o},n.prototype.readUInt32=function(){return this.data[this.pos++]<<24|this.data[this.pos++]<<16|this.data[this.pos++]<<8|this.data[this.pos++]},n.prototype.readUInt16=function(){return this.data[this.pos++]<<8|this.data[this.pos++]},n.prototype.decodePixels=function(i){var s=this.pixelBitlength/8,o=new Uint8Array(this.width*this.height*s),l=0,c=this;if(i==null&&(i=this.imgData),i.length===0)return new Uint8Array(0);function u(f,d,h,g){var m,_,y,b,w,T,F,I,A,P,j,J,N,L,G,W,le,de,X,ee,R,pe=Math.ceil((c.width-f)/h),me=Math.ceil((c.height-d)/g),E=c.width==pe&&c.height==me;for(L=s*pe,J=E?o:new Uint8Array(L*me),T=i.length,N=0,_=0;N<me&&l<T;){switch(i[l++]){case 0:for(b=le=0;le<L;b=le+=1)J[_++]=i[l++];break;case 1:for(b=de=0;de<L;b=de+=1)m=i[l++],w=b<s?0:J[_-s],J[_++]=(m+w)%256;break;case 2:for(b=X=0;X<L;b=X+=1)m=i[l++],y=(b-b%s)/s,G=N&&J[(N-1)*L+y*s+b%s],J[_++]=(G+m)%256;break;case 3:for(b=ee=0;ee<L;b=ee+=1)m=i[l++],y=(b-b%s)/s,w=b<s?0:J[_-s],G=N&&J[(N-1)*L+y*s+b%s],J[_++]=(m+Math.floor((w+G)/2))%256;break;case 4:for(b=R=0;R<L;b=R+=1)m=i[l++],y=(b-b%s)/s,w=b<s?0:J[_-s],N===0?G=W=0:(G=J[(N-1)*L+y*s+b%s],W=y&&J[(N-1)*L+(y-1)*s+b%s]),F=w+G-W,I=Math.abs(F-w),P=Math.abs(F-G),j=Math.abs(F-W),A=I<=P&&I<=j?w:P<=j?G:W,J[_++]=(m+A)%256;break;default:throw new Error("Invalid filter algorithm: "+i[l-1])}if(!E){var D=((d+N*g)*c.width+f)*s,O=N*L;for(b=0;b<pe;b+=1){for(var M=0;M<s;M+=1)o[D++]=J[O++];D+=(h-1)*s}}N++}}return i=XX(i),c.interlaceMethod==1?(u(0,0,8,8),u(4,0,8,8),u(0,4,4,8),u(2,0,4,4),u(0,2,2,4),u(1,0,2,2),u(0,1,1,2)):u(0,0,1,1),o},n.prototype.decodePalette=function(){var i,s,o,l,c,u,f,d,h;for(o=this.palette,u=this.transparency.indexed||[],c=new Uint8Array((u.length||0)+o.length),l=0,i=0,s=f=0,d=o.length;f<d;s=f+=3)c[l++]=o[s],c[l++]=o[s+1],c[l++]=o[s+2],c[l++]=(h=u[i++])!=null?h:255;return c},n.prototype.copyToImageData=function(i,s){var o,l,c,u,f,d,h,g,m,_,y;if(l=this.colors,m=null,o=this.hasAlphaChannel,this.palette.length&&(m=(y=this._decodedPalette)!=null?y:this._decodedPalette=this.decodePalette(),l=4,o=!0),g=(c=i.data||i).length,f=m||s,u=d=0,l===1)for(;u<g;)h=m?4*s[u/4]:d,_=f[h++],c[u++]=_,c[u++]=_,c[u++]=_,c[u++]=o?f[h++]:255,d=h;else for(;u<g;)h=m?4*s[u/4]:d,c[u++]=f[h++],c[u++]=f[h++],c[u++]=f[h++],c[u++]=o?f[h++]:255,d=h},n.prototype.decode=function(){var i;return i=new Uint8Array(this.width*this.height*4),this.copyToImageData(i,this.decodePixels()),i};var a=function(){if(Object.prototype.toString.call(yt)==="[object Window]"){try{t=yt.document.createElement("canvas"),r=t.getContext("2d")}catch{return!1}return!0}return!1};return a(),e=function(i){var s;if(a()===!0)return r.width=i.width,r.height=i.height,r.clearRect(0,0,i.width,i.height),r.putImageData(i,0,0),(s=new Image).src=t.toDataURL(),s;throw new Error("This method requires a Browser with Canvas-capability.")},n.prototype.decodeFrames=function(i){var s,o,l,c,u,f,d,h;if(this.animation){for(h=[],o=u=0,f=(d=this.animation.frames).length;u<f;o=++u)s=d[o],l=i.createImageData(s.width,s.height),c=this.decodePixels(new Uint8Array(s.data)),this.copyToImageData(l,c),s.imageData=l,h.push(s.image=e(l));return h}},n.prototype.renderFrame=function(i,s){var o,l,c;return o=(l=this.animation.frames)[s],c=l[s-1],s===0&&i.clearRect(0,0,this.width,this.height),(c!=null?c.disposeOp:void 0)===1?i.clearRect(c.xOffset,c.yOffset,c.width,c.height):(c!=null?c.disposeOp:void 0)===2&&i.putImageData(c.imageData,c.xOffset,c.yOffset),o.blendOp===0&&i.clearRect(o.xOffset,o.yOffset,o.width,o.height),i.drawImage(o.image,o.xOffset,o.yOffset)},n.prototype.animate=function(i){var s,o,l,c,u,f,d=this;return o=0,f=this.animation,c=f.numFrames,l=f.frames,u=f.numPlays,(s=function(){var h,g;if(h=o++%c,g=l[h],d.renderFrame(i,h),c>1&&o/c<u)return d.animation._timeout=setTimeout(s,g.delay)})()},n.prototype.stopAnimation=function(){var i;return clearTimeout((i=this.animation)!=null?i._timeout:void 0)},n.prototype.render=function(i){var s,o;return i._png&&i._png.stopAnimation(),i._png=this,i.width=this.width,i.height=this.height,s=i.getContext("2d"),this.animation?(this.decodeFrames(s),this.animate(s)):(o=s.createImageData(this.width,this.height),this.copyToImageData(o,this.decodePixels()),s.putImageData(o,0,0))},n}();/**
 * @license
 *
 * Copyright (c) 2014 James Robb, https://github.com/jamesbrobb
 *
 * Permission is hereby granted, free of charge, to any person obtaining
 * a copy of this software and associated documentation files (the
 * "Software"), to deal in the Software without restriction, including
 * without limitation the rights to use, copy, modify, merge, publish,
 * distribute, sublicense, and/or sell copies of the Software, and to
 * permit persons to whom the Software is furnished to do so, subject to
 * the following conditions:
 *
 * The above copyright notice and this permission notice shall be
 * included in all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND,
 * EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF
 * MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND
 * NONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE
 * LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION
 * OF CONTRACT, TORT OR OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION
 * WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE SOFTWARE.
 * ====================================================================
 *//**
 * @license
 * (c) Dean McNamee <dean@gmail.com>, 2013.
 *
 * https://github.com/deanm/omggif
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to
 * deal in the Software without restriction, including without limitation the
 * rights to use, copy, modify, merge, publish, distribute, sublicense, and/or
 * sell copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING
 * FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS
 * IN THE SOFTWARE.
 *
 * omggif is a JavaScript implementation of a GIF 89a encoder and decoder,
 * including animation and compression.  It does not rely on any specific
 * underlying system, so should run in the browser, Node, or Plask.
 */function vY(e){var t=0;if(e[t++]!==71||e[t++]!==73||e[t++]!==70||e[t++]!==56||(e[t++]+1&253)!=56||e[t++]!==97)throw new Error("Invalid GIF 87a/89a header.");var r=e[t++]|e[t++]<<8,n=e[t++]|e[t++]<<8,a=e[t++],i=a>>7,s=1<<(7&a)+1;e[t++],e[t++];var o=null,l=null;i&&(o=t,l=s,t+=3*s);var c=!0,u=[],f=0,d=null,h=0,g=null;for(this.width=r,this.height=n;c&&t<e.length;)switch(e[t++]){case 33:switch(e[t++]){case 255:if(e[t]!==11||e[t+1]==78&&e[t+2]==69&&e[t+3]==84&&e[t+4]==83&&e[t+5]==67&&e[t+6]==65&&e[t+7]==80&&e[t+8]==69&&e[t+9]==50&&e[t+10]==46&&e[t+11]==48&&e[t+12]==3&&e[t+13]==1&&e[t+16]==0)t+=14,g=e[t++]|e[t++]<<8,t++;else for(t+=12;;){if(!((N=e[t++])>=0))throw Error("Invalid block size");if(N===0)break;t+=N}break;case 249:if(e[t++]!==4||e[t+4]!==0)throw new Error("Invalid graphics extension block.");var m=e[t++];f=e[t++]|e[t++]<<8,d=e[t++],!(1&m)&&(d=null),h=m>>2&7,t++;break;case 254:for(;;){if(!((N=e[t++])>=0))throw Error("Invalid block size");if(N===0)break;t+=N}break;default:throw new Error("Unknown graphic control label: 0x"+e[t-1].toString(16))}break;case 44:var _=e[t++]|e[t++]<<8,y=e[t++]|e[t++]<<8,b=e[t++]|e[t++]<<8,w=e[t++]|e[t++]<<8,T=e[t++],F=T>>6&1,I=1<<(7&T)+1,A=o,P=l,j=!1;T>>7&&(j=!0,A=t,P=I,t+=3*I);var J=t;for(t++;;){var N;if(!((N=e[t++])>=0))throw Error("Invalid block size");if(N===0)break;t+=N}u.push({x:_,y,width:b,height:w,has_local_palette:j,palette_offset:A,palette_size:P,data_offset:J,data_length:t-J,transparent_index:d,interlaced:!!F,delay:f,disposal:h});break;case 59:c=!1;break;default:throw new Error("Unknown gif block: 0x"+e[t-1].toString(16))}this.numFrames=function(){return u.length},this.loopCount=function(){return g},this.frameInfo=function(L){if(L<0||L>=u.length)throw new Error("Frame index out of range.");return u[L]},this.decodeAndBlitFrameBGRA=function(L,G){var W=this.frameInfo(L),le=W.width*W.height,de=new Uint8Array(le);z_(e,W.data_offset,de,le);var X=W.palette_offset,ee=W.transparent_index;ee===null&&(ee=256);var R=W.width,pe=r-R,me=R,E=4*(W.y*r+W.x),D=4*((W.y+W.height)*r+W.x),O=E,M=4*pe;W.interlaced===!0&&(M+=4*r*7);for(var K=8,Y=0,re=de.length;Y<re;++Y){var se=de[Y];if(me===0&&(me=R,(O+=M)>=D&&(M=4*pe+4*r*(K-1),O=E+(R+pe)*(K<<1),K>>=1)),se===ee)O+=4;else{var xe=e[X+3*se],Ce=e[X+3*se+1],Z=e[X+3*se+2];G[O++]=Z,G[O++]=Ce,G[O++]=xe,G[O++]=255}--me}},this.decodeAndBlitFrameRGBA=function(L,G){var W=this.frameInfo(L),le=W.width*W.height,de=new Uint8Array(le);z_(e,W.data_offset,de,le);var X=W.palette_offset,ee=W.transparent_index;ee===null&&(ee=256);var R=W.width,pe=r-R,me=R,E=4*(W.y*r+W.x),D=4*((W.y+W.height)*r+W.x),O=E,M=4*pe;W.interlaced===!0&&(M+=4*r*7);for(var K=8,Y=0,re=de.length;Y<re;++Y){var se=de[Y];if(me===0&&(me=R,(O+=M)>=D&&(M=4*pe+4*r*(K-1),O=E+(R+pe)*(K<<1),K>>=1)),se===ee)O+=4;else{var xe=e[X+3*se],Ce=e[X+3*se+1],Z=e[X+3*se+2];G[O++]=xe,G[O++]=Ce,G[O++]=Z,G[O++]=255}--me}}}function z_(e,t,r,n){for(var a=e[t++],i=1<<a,s=i+1,o=s+1,l=a+1,c=(1<<l)-1,u=0,f=0,d=0,h=e[t++],g=new Int32Array(4096),m=null;;){for(;u<16&&h!==0;)f|=e[t++]<<u,u+=8,h===1?h=e[t++]:--h;if(u<l)break;var _=f&c;if(f>>=l,u-=l,_!==i){if(_===s)break;for(var y=_<o?_:m,b=0,w=y;w>i;)w=g[w]>>8,++b;var T=w;if(d+b+(y!==_?1:0)>n)return void lr.log("Warning, gif stream longer than expected.");r[d++]=T;var F=d+=b;for(y!==_&&(r[d++]=T),w=y;b--;)w=g[w],r[--F]=255&w,w>>=8;m!==null&&o<4096&&(g[o++]=m<<8|T,o>=c+1&&l<12&&(++l,c=c<<1|1)),m=_}else o=s+1,c=(1<<(l=a+1))-1,m=null}return d!==n&&lr.log("Warning, gif stream shorter than expected."),r}/**
 * @license
  Copyright (c) 2008, Adobe Systems Incorporated
  All rights reserved.

  Redistribution and use in source and binary forms, with or without 
  modification, are permitted provided that the following conditions are
  met:

  * Redistributions of source code must retain the above copyright notice, 
    this list of conditions and the following disclaimer.
  
  * Redistributions in binary form must reproduce the above copyright
    notice, this list of conditions and the following disclaimer in the 
    documentation and/or other materials provided with the distribution.
  
  * Neither the name of Adobe Systems Incorporated nor the names of its 
    contributors may be used to endorse or promote products derived from 
    this software without specific prior written permission.

  THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS "AS
  IS" AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO,
  THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR
  PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT OWNER OR 
  CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL,
  EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO,
  PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR
  PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF
  LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING
  NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS
  SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
*/function R2(e){var t,r,n,a,i,s=Math.floor,o=new Array(64),l=new Array(64),c=new Array(64),u=new Array(64),f=new Array(65535),d=new Array(65535),h=new Array(64),g=new Array(64),m=[],_=0,y=7,b=new Array(64),w=new Array(64),T=new Array(64),F=new Array(256),I=new Array(2048),A=[0,1,5,6,14,15,27,28,2,4,7,13,16,26,29,42,3,8,12,17,25,30,41,43,9,11,18,24,31,40,44,53,10,19,23,32,39,45,52,54,20,22,33,38,46,51,55,60,21,34,37,47,50,56,59,61,35,36,48,49,57,58,62,63],P=[0,0,1,5,1,1,1,1,1,1,0,0,0,0,0,0,0],j=[0,1,2,3,4,5,6,7,8,9,10,11],J=[0,0,2,1,3,3,2,4,3,5,5,4,4,0,0,1,125],N=[1,2,3,0,4,17,5,18,33,49,65,6,19,81,97,7,34,113,20,50,129,145,161,8,35,66,177,193,21,82,209,240,36,51,98,114,130,9,10,22,23,24,25,26,37,38,39,40,41,42,52,53,54,55,56,57,58,67,68,69,70,71,72,73,74,83,84,85,86,87,88,89,90,99,100,101,102,103,104,105,106,115,116,117,118,119,120,121,122,131,132,133,134,135,136,137,138,146,147,148,149,150,151,152,153,154,162,163,164,165,166,167,168,169,170,178,179,180,181,182,183,184,185,186,194,195,196,197,198,199,200,201,202,210,211,212,213,214,215,216,217,218,225,226,227,228,229,230,231,232,233,234,241,242,243,244,245,246,247,248,249,250],L=[0,0,3,1,1,1,1,1,1,1,1,1,0,0,0,0,0],G=[0,1,2,3,4,5,6,7,8,9,10,11],W=[0,0,2,1,2,4,4,3,4,7,5,4,4,0,1,2,119],le=[0,1,2,3,17,4,5,33,49,6,18,65,81,7,97,113,19,34,50,129,8,20,66,145,161,177,193,9,35,51,82,240,21,98,114,209,10,22,36,52,225,37,241,23,24,25,26,38,39,40,41,42,53,54,55,56,57,58,67,68,69,70,71,72,73,74,83,84,85,86,87,88,89,90,99,100,101,102,103,104,105,106,115,116,117,118,119,120,121,122,130,131,132,133,134,135,136,137,138,146,147,148,149,150,151,152,153,154,162,163,164,165,166,167,168,169,170,178,179,180,181,182,183,184,185,186,194,195,196,197,198,199,200,201,202,210,211,212,213,214,215,216,217,218,226,227,228,229,230,231,232,233,234,242,243,244,245,246,247,248,249,250];function de(E,D){for(var O=0,M=0,K=new Array,Y=1;Y<=16;Y++){for(var re=1;re<=E[Y];re++)K[D[M]]=[],K[D[M]][0]=O,K[D[M]][1]=Y,M++,O++;O*=2}return K}function X(E){for(var D=E[0],O=E[1]-1;O>=0;)D&1<<O&&(_|=1<<y),O--,--y<0&&(_==255?(ee(255),ee(0)):ee(_),y=7,_=0)}function ee(E){m.push(E)}function R(E){ee(E>>8&255),ee(255&E)}function pe(E,D,O,M,K){for(var Y,re=K[0],se=K[240],xe=function(Be,Ge){var Ye,Je,ot,ct,gt,bt,It,Et,ut,Ze,ze=0;for(ut=0;ut<8;++ut){Ye=Be[ze],Je=Be[ze+1],ot=Be[ze+2],ct=Be[ze+3],gt=Be[ze+4],bt=Be[ze+5],It=Be[ze+6];var Jt=Ye+(Et=Be[ze+7]),dt=Ye-Et,Zr=Je+It,Xt=Je-It,cr=ot+bt,Va=ot-bt,Vt=ct+gt,Gi=ct-gt,gr=Jt+Vt,ka=Jt-Vt,di=Zr+cr,sr=Zr-cr;Be[ze]=gr+di,Be[ze+4]=gr-di;var St=.707106781*(sr+ka);Be[ze+2]=ka+St,Be[ze+6]=ka-St;var qt=.382683433*((gr=Gi+Va)-(sr=Xt+dt)),ys=.5411961*gr+qt,en=1.306562965*sr+qt,za=.707106781*(di=Va+Xt),Ha=dt+za,pt=dt-za;Be[ze+5]=pt+ys,Be[ze+3]=pt-ys,Be[ze+1]=Ha+en,Be[ze+7]=Ha-en,ze+=8}for(ze=0,ut=0;ut<8;++ut){Ye=Be[ze],Je=Be[ze+8],ot=Be[ze+16],ct=Be[ze+24],gt=Be[ze+32],bt=Be[ze+40],It=Be[ze+48];var Ea=Ye+(Et=Be[ze+56]),la=Ye-Et,An=Je+It,Ir=Je-It,Tr=ot+bt,z=ot-bt,ue=ct+gt,te=ct-gt,ne=Ea+ue,ce=Ea-ue,fe=An+Tr,ke=An-Tr;Be[ze]=ne+fe,Be[ze+32]=ne-fe;var Le=.707106781*(ke+ce);Be[ze+16]=ce+Le,Be[ze+48]=ce-Le;var Se=.382683433*((ne=te+z)-(ke=Ir+la)),Ne=.5411961*ne+Se,Pe=1.306562965*ke+Se,Ve=.707106781*(fe=z+Ir),Ke=la+Ve,rt=la-Ve;Be[ze+40]=rt+Ne,Be[ze+24]=rt-Ne,Be[ze+8]=Ke+Pe,Be[ze+56]=Ke-Pe,ze++}for(ut=0;ut<64;++ut)Ze=Be[ut]*Ge[ut],h[ut]=Ze>0?Ze+.5|0:Ze-.5|0;return h}(E,D),Ce=0;Ce<64;++Ce)g[A[Ce]]=xe[Ce];var Z=g[0]-O;O=g[0],Z==0?X(M[0]):(X(M[d[Y=32767+Z]]),X(f[Y]));for(var Ie=63;Ie>0&&g[Ie]==0;)Ie--;if(Ie==0)return X(re),O;for(var He,Te=1;Te<=Ie;){for(var oe=Te;g[Te]==0&&Te<=Ie;)++Te;var De=Te-oe;if(De>=16){He=De>>4;for(var Xe=1;Xe<=He;++Xe)X(se);De&=15}Y=32767+g[Te],X(K[(De<<4)+d[Y]]),X(f[Y]),Te++}return Ie!=63&&X(re),O}function me(E){E=Math.min(Math.max(E,1),100),i!=E&&(function(D){for(var O=[16,11,10,16,24,40,51,61,12,12,14,19,26,58,60,55,14,13,16,24,40,57,69,56,14,17,22,29,51,87,80,62,18,22,37,56,68,109,103,77,24,35,55,64,81,104,113,92,49,64,78,87,103,121,120,101,72,92,95,98,112,100,103,99],M=0;M<64;M++){var K=s((O[M]*D+50)/100);K=Math.min(Math.max(K,1),255),o[A[M]]=K}for(var Y=[17,18,24,47,99,99,99,99,18,21,26,66,99,99,99,99,24,26,56,99,99,99,99,99,47,66,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99],re=0;re<64;re++){var se=s((Y[re]*D+50)/100);se=Math.min(Math.max(se,1),255),l[A[re]]=se}for(var xe=[1,1.387039845,1.306562965,1.175875602,1,.785694958,.5411961,.275899379],Ce=0,Z=0;Z<8;Z++)for(var Ie=0;Ie<8;Ie++)c[Ce]=1/(o[A[Ce]]*xe[Z]*xe[Ie]*8),u[Ce]=1/(l[A[Ce]]*xe[Z]*xe[Ie]*8),Ce++}(E<50?Math.floor(5e3/E):Math.floor(200-2*E)),i=E)}this.encode=function(E,D){D&&me(D),m=new Array,_=0,y=7,R(65496),R(65504),R(16),ee(74),ee(70),ee(73),ee(70),ee(0),ee(1),ee(1),ee(0),R(1),R(1),ee(0),ee(0),function(){R(65499),R(132),ee(0);for(var Je=0;Je<64;Je++)ee(o[Je]);ee(1);for(var ot=0;ot<64;ot++)ee(l[ot])}(),function(Je,ot){R(65472),R(17),ee(8),R(ot),R(Je),ee(3),ee(1),ee(17),ee(0),ee(2),ee(17),ee(1),ee(3),ee(17),ee(1)}(E.width,E.height),function(){R(65476),R(418),ee(0);for(var Je=0;Je<16;Je++)ee(P[Je+1]);for(var ot=0;ot<=11;ot++)ee(j[ot]);ee(16);for(var ct=0;ct<16;ct++)ee(J[ct+1]);for(var gt=0;gt<=161;gt++)ee(N[gt]);ee(1);for(var bt=0;bt<16;bt++)ee(L[bt+1]);for(var It=0;It<=11;It++)ee(G[It]);ee(17);for(var Et=0;Et<16;Et++)ee(W[Et+1]);for(var ut=0;ut<=161;ut++)ee(le[ut])}(),R(65498),R(12),ee(3),ee(1),ee(0),ee(2),ee(17),ee(3),ee(17),ee(0),ee(63),ee(0);var O=0,M=0,K=0;_=0,y=7,this.encode.displayName="_encode_";for(var Y,re,se,xe,Ce,Z,Ie,He,Te,oe=E.data,De=E.width,Xe=E.height,Be=4*De,Ge=0;Ge<Xe;){for(Y=0;Y<Be;){for(Ce=Be*Ge+Y,Ie=-1,He=0,Te=0;Te<64;Te++)Z=Ce+(He=Te>>3)*Be+(Ie=4*(7&Te)),Ge+He>=Xe&&(Z-=Be*(Ge+1+He-Xe)),Y+Ie>=Be&&(Z-=Y+Ie-Be+4),re=oe[Z++],se=oe[Z++],xe=oe[Z++],b[Te]=(I[re]+I[se+256>>0]+I[xe+512>>0]>>16)-128,w[Te]=(I[re+768>>0]+I[se+1024>>0]+I[xe+1280>>0]>>16)-128,T[Te]=(I[re+1280>>0]+I[se+1536>>0]+I[xe+1792>>0]>>16)-128;O=pe(b,c,O,t,n),M=pe(w,u,M,r,a),K=pe(T,u,K,r,a),Y+=32}Ge+=8}if(y>=0){var Ye=[];Ye[1]=y+1,Ye[0]=(1<<y+1)-1,X(Ye)}return R(65497),new Uint8Array(m)},e=e||50,function(){for(var E=String.fromCharCode,D=0;D<256;D++)F[D]=E(D)}(),t=de(P,j),r=de(L,G),n=de(J,N),a=de(W,le),function(){for(var E=1,D=2,O=1;O<=15;O++){for(var M=E;M<D;M++)d[32767+M]=O,f[32767+M]=[],f[32767+M][1]=O,f[32767+M][0]=M;for(var K=-(D-1);K<=-E;K++)d[32767+K]=O,f[32767+K]=[],f[32767+K][1]=O,f[32767+K][0]=D-1+K;E<<=1,D<<=1}}(),function(){for(var E=0;E<256;E++)I[E]=19595*E,I[E+256>>0]=38470*E,I[E+512>>0]=7471*E+32768,I[E+768>>0]=-11059*E,I[E+1024>>0]=-21709*E,I[E+1280>>0]=32768*E+8421375,I[E+1536>>0]=-27439*E,I[E+1792>>0]=-5329*E}(),me(e)}/**
 * @license
 * Copyright (c) 2017 Aras Abbasi
 *
 * Licensed under the MIT License.
 * http://opensource.org/licenses/mit-license
 */function Ei(e,t){if(this.pos=0,this.buffer=e,this.datav=new DataView(e.buffer),this.is_with_alpha=!!t,this.bottom_up=!0,this.flag=String.fromCharCode(this.buffer[0])+String.fromCharCode(this.buffer[1]),this.pos+=2,["BM","BA","CI","CP","IC","PT"].indexOf(this.flag)===-1)throw new Error("Invalid BMP File");this.parseHeader(),this.parseBGR()}function H_(e){function t(P){if(!P)throw Error("assert :P")}function r(P,j,J){for(var N=0;4>N;N++)if(P[j+N]!=J.charCodeAt(N))return!0;return!1}function n(P,j,J,N,L){for(var G=0;G<L;G++)P[j+G]=J[N+G]}function a(P,j,J,N){for(var L=0;L<N;L++)P[j+L]=J}function i(P){return new Int32Array(P)}function s(P,j){for(var J=[],N=0;N<P;N++)J.push(new j);return J}function o(P,j){var J=[];return function N(L,G,W){for(var le=W[G],de=0;de<le&&(L.push(W.length>G+1?[]:new j),!(W.length<G+1));de++)N(L[de],G+1,W)}(J,0,P),J}var l=function(){var P=this;function j(p,x){for(var k=1<<x-1>>>0;p&k;)k>>>=1;return k?(p&k-1)+k:p}function J(p,x,k,C,B){t(!(C%k));do p[x+(C-=k)]=B;while(0<C)}function N(p,x,k,C,B){if(t(2328>=B),512>=B)var V=i(512);else if((V=i(B))==null)return 0;return function(H,q,Q,ae,ve,Ee){var Ae,be,Me=q,Fe=1<<Q,ye=i(16),we=i(16);for(t(ve!=0),t(ae!=null),t(H!=null),t(0<Q),be=0;be<ve;++be){if(15<ae[be])return 0;++ye[ae[be]]}if(ye[0]==ve)return 0;for(we[1]=0,Ae=1;15>Ae;++Ae){if(ye[Ae]>1<<Ae)return 0;we[Ae+1]=we[Ae]+ye[Ae]}for(be=0;be<ve;++be)Ae=ae[be],0<ae[be]&&(Ee[we[Ae]++]=be);if(we[15]==1)return(ae=new L).g=0,ae.value=Ee[0],J(H,Me,1,Fe,ae),Fe;var je,Ue=-1,Re=Fe-1,at=0,Qe=1,mt=1,et=1<<Q;for(be=0,Ae=1,ve=2;Ae<=Q;++Ae,ve<<=1){if(Qe+=mt<<=1,0>(mt-=ye[Ae]))return 0;for(;0<ye[Ae];--ye[Ae])(ae=new L).g=Ae,ae.value=Ee[be++],J(H,Me+at,ve,et,ae),at=j(at,Ae)}for(Ae=Q+1,ve=2;15>=Ae;++Ae,ve<<=1){if(Qe+=mt<<=1,0>(mt-=ye[Ae]))return 0;for(;0<ye[Ae];--ye[Ae]){if(ae=new L,(at&Re)!=Ue){for(Me+=et,je=1<<(Ue=Ae)-Q;15>Ue&&!(0>=(je-=ye[Ue]));)++Ue,je<<=1;Fe+=et=1<<(je=Ue-Q),H[q+(Ue=at&Re)].g=je+Q,H[q+Ue].value=Me-q-Ue}ae.g=Ae-Q,ae.value=Ee[be++],J(H,Me+(at>>Q),ve,et,ae),at=j(at,Ae)}}return Qe!=2*we[15]-1?0:Fe}(p,x,k,C,B,V)}function L(){this.value=this.g=0}function G(){this.value=this.g=0}function W(){this.G=s(5,L),this.H=i(5),this.jc=this.Qb=this.qb=this.nd=0,this.pd=s(vn,G)}function le(p,x,k,C){t(p!=null),t(x!=null),t(2147483648>C),p.Ca=254,p.I=0,p.b=-8,p.Ka=0,p.oa=x,p.pa=k,p.Jd=x,p.Yc=k+C,p.Zc=4<=C?k+C-4+1:k,Y(p)}function de(p,x){for(var k=0;0<x--;)k|=se(p,128)<<x;return k}function X(p,x){var k=de(p,x);return re(p)?-k:k}function ee(p,x,k,C){var B,V=0;for(t(p!=null),t(x!=null),t(4294967288>C),p.Sb=C,p.Ra=0,p.u=0,p.h=0,4<C&&(C=4),B=0;B<C;++B)V+=x[k+B]<<8*B;p.Ra=V,p.bb=C,p.oa=x,p.pa=k}function R(p){for(;8<=p.u&&p.bb<p.Sb;)p.Ra>>>=8,p.Ra+=p.oa[p.pa+p.bb]<<Oc-8>>>0,++p.bb,p.u-=8;O(p)&&(p.h=1,p.u=0)}function pe(p,x){if(t(0<=x),!p.h&&x<=Fc){var k=D(p)&Lc[x];return p.u+=x,R(p),k}return p.h=1,p.u=0}function me(){this.b=this.Ca=this.I=0,this.oa=[],this.pa=0,this.Jd=[],this.Yc=0,this.Zc=[],this.Ka=0}function E(){this.Ra=0,this.oa=[],this.h=this.u=this.bb=this.Sb=this.pa=0}function D(p){return p.Ra>>>(p.u&Oc-1)>>>0}function O(p){return t(p.bb<=p.Sb),p.h||p.bb==p.Sb&&p.u>Oc}function M(p,x){p.u=x,p.h=O(p)}function K(p){p.u>=A0&&(t(p.u>=A0),R(p))}function Y(p){t(p!=null&&p.oa!=null),p.pa<p.Zc?(p.I=(p.oa[p.pa++]|p.I<<8)>>>0,p.b+=8):(t(p!=null&&p.oa!=null),p.pa<p.Yc?(p.b+=8,p.I=p.oa[p.pa++]|p.I<<8):p.Ka?p.b=0:(p.I<<=8,p.b+=8,p.Ka=1))}function re(p){return de(p,1)}function se(p,x){var k=p.Ca;0>p.b&&Y(p);var C=p.b,B=k*x>>>8,V=(p.I>>>C>B)+0;for(V?(k-=B,p.I-=B+1<<C>>>0):k=B+1,C=k,B=0;256<=C;)B+=8,C>>=8;return C=7^B+ua[C],p.b-=C,p.Ca=(k<<C)-1,V}function xe(p,x,k){p[x+0]=k>>24&255,p[x+1]=k>>16&255,p[x+2]=k>>8&255,p[x+3]=k>>0&255}function Ce(p,x){return p[x+0]<<0|p[x+1]<<8}function Z(p,x){return Ce(p,x)|p[x+2]<<16}function Ie(p,x){return Ce(p,x)|Ce(p,x+2)<<16}function He(p,x){var k=1<<x;return t(p!=null),t(0<x),p.X=i(k),p.X==null?0:(p.Mb=32-x,p.Xa=x,1)}function Te(p,x){t(p!=null),t(x!=null),t(p.Xa==x.Xa),n(x.X,0,p.X,0,1<<x.Xa)}function oe(){this.X=[],this.Xa=this.Mb=0}function De(p,x,k,C){t(k!=null),t(C!=null);var B=k[0],V=C[0];return B==0&&(B=(p*V+x/2)/x),V==0&&(V=(x*B+p/2)/p),0>=B||0>=V?0:(k[0]=B,C[0]=V,1)}function Xe(p,x){return p+(1<<x)-1>>>x}function Be(p,x){return((4278255360&p)+(4278255360&x)>>>0&4278255360)+((16711935&p)+(16711935&x)>>>0&16711935)>>>0}function Ge(p,x){P[x]=function(k,C,B,V,H,q,Q){var ae;for(ae=0;ae<H;++ae){var ve=P[p](q[Q+ae-1],B,V+ae);q[Q+ae]=Be(k[C+ae],ve)}}}function Ye(){this.ud=this.hd=this.jd=0}function Je(p,x){return((4278124286&(p^x))>>>1)+(p&x)>>>0}function ot(p){return 0<=p&&256>p?p:0>p?0:255<p?255:void 0}function ct(p,x){return ot(p+(p-x+.5>>1))}function gt(p,x,k){return Math.abs(x-k)-Math.abs(p-k)}function bt(p,x,k,C,B,V,H){for(C=V[H-1],k=0;k<B;++k)V[H+k]=C=Be(p[x+k],C)}function It(p,x,k,C,B){var V;for(V=0;V<k;++V){var H=p[x+V],q=H>>8&255,Q=16711935&(Q=(Q=16711935&H)+((q<<16)+q));C[B+V]=(4278255360&H)+Q>>>0}}function Et(p,x){x.jd=p>>0&255,x.hd=p>>8&255,x.ud=p>>16&255}function ut(p,x,k,C,B,V){var H;for(H=0;H<C;++H){var q=x[k+H],Q=q>>>8,ae=q,ve=255&(ve=(ve=q>>>16)+((p.jd<<24>>24)*(Q<<24>>24)>>>5));ae=255&(ae=(ae=ae+((p.hd<<24>>24)*(Q<<24>>24)>>>5))+((p.ud<<24>>24)*(ve<<24>>24)>>>5)),B[V+H]=(4278255360&q)+(ve<<16)+ae}}function Ze(p,x,k,C,B){P[x]=function(V,H,q,Q,ae,ve,Ee,Ae,be){for(Q=Ee;Q<Ae;++Q)for(Ee=0;Ee<be;++Ee)ae[ve++]=B(q[C(V[H++])])},P[p]=function(V,H,q,Q,ae,ve,Ee){var Ae=8>>V.b,be=V.Ea,Me=V.K[0],Fe=V.w;if(8>Ae)for(V=(1<<V.b)-1,Fe=(1<<Ae)-1;H<q;++H){var ye,we=0;for(ye=0;ye<be;++ye)ye&V||(we=C(Q[ae++])),ve[Ee++]=B(Me[we&Fe]),we>>=Ae}else P["VP8LMapColor"+k](Q,ae,Me,Fe,ve,Ee,H,q,be)}}function ze(p,x,k,C,B){for(k=x+k;x<k;){var V=p[x++];C[B++]=V>>16&255,C[B++]=V>>8&255,C[B++]=V>>0&255}}function Jt(p,x,k,C,B){for(k=x+k;x<k;){var V=p[x++];C[B++]=V>>16&255,C[B++]=V>>8&255,C[B++]=V>>0&255,C[B++]=V>>24&255}}function dt(p,x,k,C,B){for(k=x+k;x<k;){var V=(H=p[x++])>>16&240|H>>12&15,H=H>>0&240|H>>28&15;C[B++]=V,C[B++]=H}}function Zr(p,x,k,C,B){for(k=x+k;x<k;){var V=(H=p[x++])>>16&248|H>>13&7,H=H>>5&224|H>>3&31;C[B++]=V,C[B++]=H}}function Xt(p,x,k,C,B){for(k=x+k;x<k;){var V=p[x++];C[B++]=V>>0&255,C[B++]=V>>8&255,C[B++]=V>>16&255}}function cr(p,x,k,C,B,V){if(V==0)for(k=x+k;x<k;)xe(C,((V=p[x++])[0]>>24|V[1]>>8&65280|V[2]<<8&16711680|V[3]<<24)>>>0),B+=32;else n(C,B,p,x,k)}function Va(p,x){P[x][0]=P[p+"0"],P[x][1]=P[p+"1"],P[x][2]=P[p+"2"],P[x][3]=P[p+"3"],P[x][4]=P[p+"4"],P[x][5]=P[p+"5"],P[x][6]=P[p+"6"],P[x][7]=P[p+"7"],P[x][8]=P[p+"8"],P[x][9]=P[p+"9"],P[x][10]=P[p+"10"],P[x][11]=P[p+"11"],P[x][12]=P[p+"12"],P[x][13]=P[p+"13"],P[x][14]=P[p+"0"],P[x][15]=P[p+"0"]}function Vt(p){return p==cg||p==ug||p==wd||p==fg}function Gi(){this.eb=[],this.size=this.A=this.fb=0}function gr(){this.y=[],this.f=[],this.ea=[],this.F=[],this.Tc=this.Ed=this.Cd=this.Fd=this.lb=this.Db=this.Ab=this.fa=this.J=this.W=this.N=this.O=0}function ka(){this.Rd=this.height=this.width=this.S=0,this.f={},this.f.RGBA=new Gi,this.f.kb=new gr,this.sd=null}function di(){this.width=[0],this.height=[0],this.Pd=[0],this.Qd=[0],this.format=[0]}function sr(){this.Id=this.fd=this.Md=this.hb=this.ib=this.da=this.bd=this.cd=this.j=this.v=this.Da=this.Sd=this.ob=0}function St(p){return alert("todo:WebPSamplerProcessPlane"),p.T}function qt(p,x){var k=p.T,C=x.ba.f.RGBA,B=C.eb,V=C.fb+p.ka*C.A,H=Ya[x.ba.S],q=p.y,Q=p.O,ae=p.f,ve=p.N,Ee=p.ea,Ae=p.W,be=x.cc,Me=x.dc,Fe=x.Mc,ye=x.Nc,we=p.ka,je=p.ka+p.T,Ue=p.U,Re=Ue+1>>1;for(we==0?H(q,Q,null,null,ae,ve,Ee,Ae,ae,ve,Ee,Ae,B,V,null,null,Ue):(H(x.ec,x.fc,q,Q,be,Me,Fe,ye,ae,ve,Ee,Ae,B,V-C.A,B,V,Ue),++k);we+2<je;we+=2)be=ae,Me=ve,Fe=Ee,ye=Ae,ve+=p.Rc,Ae+=p.Rc,V+=2*C.A,H(q,(Q+=2*p.fa)-p.fa,q,Q,be,Me,Fe,ye,ae,ve,Ee,Ae,B,V-C.A,B,V,Ue);return Q+=p.fa,p.j+je<p.o?(n(x.ec,x.fc,q,Q,Ue),n(x.cc,x.dc,ae,ve,Re),n(x.Mc,x.Nc,Ee,Ae,Re),k--):1&je||H(q,Q,null,null,ae,ve,Ee,Ae,ae,ve,Ee,Ae,B,V+C.A,null,null,Ue),k}function ys(p,x,k){var C=p.F,B=[p.J];if(C!=null){var V=p.U,H=x.ba.S,q=H==yd||H==wd;x=x.ba.f.RGBA;var Q=[0],ae=p.ka;Q[0]=p.T,p.Kb&&(ae==0?--Q[0]:(--ae,B[0]-=p.width),p.j+p.ka+p.T==p.o&&(Q[0]=p.o-p.j-ae));var ve=x.eb;ae=x.fb+ae*x.A,p=fr(C,B[0],p.width,V,Q,ve,ae+(q?0:3),x.A),t(k==Q),p&&Vt(H)&&Ka(ve,ae,q,V,Q,x.A)}return 0}function en(p){var x=p.ma,k=x.ba.S,C=11>k,B=k==xd||k==vd||k==yd||k==lg||k==12||Vt(k);if(x.memory=null,x.Ib=null,x.Jb=null,x.Nd=null,!k0(x.Oa,p,B?11:12))return 0;if(B&&Vt(k)&&$e(),p.da)alert("todo:use_scaling");else{if(C){if(x.Ib=St,p.Kb){if(k=p.U+1>>1,x.memory=i(p.U+2*k),x.memory==null)return 0;x.ec=x.memory,x.fc=0,x.cc=x.ec,x.dc=x.fc+p.U,x.Mc=x.cc,x.Nc=x.dc+k,x.Ib=qt,$e()}}else alert("todo:EmitYUV");B&&(x.Jb=ys,C&&_e())}if(C&&!iw){for(p=0;256>p;++p)MC[p]=89858*(p-128)+_d>>bd,$C[p]=-22014*(p-128)+_d,UC[p]=-45773*(p-128),BC[p]=113618*(p-128)+_d>>bd;for(p=O0;p<pg;++p)x=76283*(p-16)+_d>>bd,VC[p-O0]=Ta(x,255),zC[p-O0]=Ta(x+8>>4,15);iw=1}return 1}function za(p){var x=p.ma,k=p.U,C=p.T;return t(!(1&p.ka)),0>=k||0>=C?0:(k=x.Ib(p,x),x.Jb!=null&&x.Jb(p,x,k),x.Dc+=k,1)}function Ha(p){p.ma.memory=null}function pt(p,x,k,C){return pe(p,8)!=47?0:(x[0]=pe(p,14)+1,k[0]=pe(p,14)+1,C[0]=pe(p,1),pe(p,3)!=0?0:!p.h)}function Ea(p,x){if(4>p)return p+1;var k=p-2>>1;return(2+(1&p)<<k)+pe(x,k)+1}function la(p,x){return 120<x?x-120:1<=(k=((k=kC[x-1])>>4)*p+(8-(15&k)))?k:1;var k}function An(p,x,k){var C=D(k),B=p[x+=255&C].g-8;return 0<B&&(M(k,k.u+8),C=D(k),x+=p[x].value,x+=C&(1<<B)-1),M(k,k.u+p[x].g),p[x].value}function Ir(p,x,k){return k.g+=p.g,k.value+=p.value<<x>>>0,t(8>=k.g),p.g}function Tr(p,x,k){var C=p.xc;return t((x=C==0?0:p.vc[p.md*(k>>C)+(x>>C)])<p.Wb),p.Ya[x]}function z(p,x,k,C){var B=p.ab,V=p.c*x,H=p.C;x=H+x;var q=k,Q=C;for(C=p.Ta,k=p.Ua;0<B--;){var ae=p.gc[B],ve=H,Ee=x,Ae=q,be=Q,Me=(Q=C,q=k,ae.Ea);switch(t(ve<Ee),t(Ee<=ae.nc),ae.hc){case 2:ud(Ae,be,(Ee-ve)*Me,Q,q);break;case 0:var Fe=ve,ye=Ee,we=Q,je=q,Ue=(et=ae).Ea;Fe==0&&(sg(Ae,be,null,null,1,we,je),bt(Ae,be+1,0,0,Ue-1,we,je+1),be+=Ue,je+=Ue,++Fe);for(var Re=1<<et.b,at=Re-1,Qe=Xe(Ue,et.b),mt=et.K,et=et.w+(Fe>>et.b)*Qe;Fe<ye;){var Gt=mt,Qt=et,zt=1;for(T0(Ae,be,we,je-Ue,1,we,je);zt<Ue;){var Rt=(zt&~at)+Re;Rt>Ue&&(Rt=Ue),(0,lo[Gt[Qt++]>>8&15])(Ae,be+ +zt,we,je+zt-Ue,Rt-zt,we,je+zt),zt=Rt}be+=Ue,je+=Ue,++Fe&at||(et+=Qe)}Ee!=ae.nc&&n(Q,q-Me,Q,q+(Ee-ve-1)*Me,Me);break;case 1:for(Me=Ae,ye=be,Ue=(Ae=ae.Ea)-(je=Ae&~(we=(be=1<<ae.b)-1)),Fe=Xe(Ae,ae.b),Re=ae.K,ae=ae.w+(ve>>ae.b)*Fe;ve<Ee;){for(at=Re,Qe=ae,mt=new Ye,et=ye+je,Gt=ye+Ae;ye<et;)Et(at[Qe++],mt),yl(mt,Me,ye,be,Q,q),ye+=be,q+=be;ye<Gt&&(Et(at[Qe++],mt),yl(mt,Me,ye,Ue,Q,q),ye+=Ue,q+=Ue),++ve&we||(ae+=Fe)}break;case 3:if(Ae==Q&&be==q&&0<ae.b){for(ye=Q,Ae=Me=q+(Ee-ve)*Me-(je=(Ee-ve)*Xe(ae.Ea,ae.b)),be=Q,we=q,Fe=[],je=(Ue=je)-1;0<=je;--je)Fe[je]=be[we+je];for(je=Ue-1;0<=je;--je)ye[Ae+je]=Fe[je];Wa(ae,ve,Ee,Q,Me,Q,q)}else Wa(ae,ve,Ee,Ae,be,Q,q)}q=C,Q=k}Q!=k&&n(C,k,q,Q,V)}function ue(p,x){var k=p.V,C=p.Ba+p.c*p.C,B=x-p.C;if(t(x<=p.l.o),t(16>=B),0<B){var V=p.l,H=p.Ta,q=p.Ua,Q=V.width;if(z(p,B,k,C),B=q=[q],t((k=p.C)<(C=x)),t(V.v<V.va),C>V.o&&(C=V.o),k<V.j){var ae=V.j-k;k=V.j,B[0]+=ae*Q}if(k>=C?k=0:(B[0]+=4*V.v,V.ka=k-V.j,V.U=V.va-V.v,V.T=C-k,k=1),k){if(q=q[0],11>(k=p.ca).S){var ve=k.f.RGBA,Ee=(C=k.S,B=V.U,V=V.T,ae=ve.eb,ve.A),Ae=V;for(ve=ve.fb+p.Ma*ve.A;0<Ae--;){var be=H,Me=q,Fe=B,ye=ae,we=ve;switch(C){case gd:fa(be,Me,Fe,ye,we);break;case xd:Kn(be,Me,Fe,ye,we);break;case cg:Kn(be,Me,Fe,ye,we),Ka(ye,we,0,Fe,1,0);break;case X5:ks(be,Me,Fe,ye,we);break;case vd:cr(be,Me,Fe,ye,we,1);break;case ug:cr(be,Me,Fe,ye,we,1),Ka(ye,we,0,Fe,1,0);break;case yd:cr(be,Me,Fe,ye,we,0);break;case wd:cr(be,Me,Fe,ye,we,0),Ka(ye,we,1,Fe,1,0);break;case lg:co(be,Me,Fe,ye,we);break;case fg:co(be,Me,Fe,ye,we),ur(ye,we,Fe,1,0);break;case Y5:Ss(be,Me,Fe,ye,we);break;default:t(0)}q+=Q,ve+=Ee}p.Ma+=V}else alert("todo:EmitRescaledRowsYUVA");t(p.Ma<=k.height)}}p.C=x,t(p.C<=p.i)}function te(p){var x;if(0<p.ua)return 0;for(x=0;x<p.Wb;++x){var k=p.Ya[x].G,C=p.Ya[x].H;if(0<k[1][C[1]+0].g||0<k[2][C[2]+0].g||0<k[3][C[3]+0].g)return 0}return 1}function ne(p,x,k,C,B,V){if(p.Z!=0){var H=p.qd,q=p.rd;for(t(po[p.Z]!=null);x<k;++x)po[p.Z](H,q,C,B,C,B,V),H=C,q=B,B+=V;p.qd=H,p.rd=q}}function ce(p,x){var k=p.l.ma,C=k.Z==0||k.Z==1?p.l.j:p.C;if(C=p.C<C?C:p.C,t(x<=p.l.o),x>C){var B=p.l.width,V=k.ca,H=k.tb+B*C,q=p.V,Q=p.Ba+p.c*C,ae=p.gc;t(p.ab==1),t(ae[0].hc==3),fd(ae[0],C,x,q,Q,V,H),ne(k,C,x,V,H,B)}p.C=p.Ma=x}function fe(p,x,k,C,B,V,H){var q=p.$/C,Q=p.$%C,ae=p.m,ve=p.s,Ee=k+p.$,Ae=Ee;B=k+C*B;var be=k+C*V,Me=280+ve.ua,Fe=p.Pb?q:16777216,ye=0<ve.ua?ve.Wa:null,we=ve.wc,je=Ee<be?Tr(ve,Q,q):null;t(p.C<V),t(be<=B);var Ue=!1;e:for(;;){for(;Ue||Ee<be;){var Re=0;if(q>=Fe){var at=Ee-k;t((Fe=p).Pb),Fe.wd=Fe.m,Fe.xd=at,0<Fe.s.ua&&Te(Fe.s.Wa,Fe.s.vb),Fe=q+AC}if(Q&we||(je=Tr(ve,Q,q)),t(je!=null),je.Qb&&(x[Ee]=je.qb,Ue=!0),!Ue)if(K(ae),je.jc){Re=ae,at=x;var Qe=Ee,mt=je.pd[D(Re)&vn-1];t(je.jc),256>mt.g?(M(Re,Re.u+mt.g),at[Qe]=mt.value,Re=0):(M(Re,Re.u+mt.g-256),t(256<=mt.value),Re=mt.value),Re==0&&(Ue=!0)}else Re=An(je.G[0],je.H[0],ae);if(ae.h)break;if(Ue||256>Re){if(!Ue)if(je.nd)x[Ee]=(je.qb|Re<<8)>>>0;else{if(K(ae),Ue=An(je.G[1],je.H[1],ae),K(ae),at=An(je.G[2],je.H[2],ae),Qe=An(je.G[3],je.H[3],ae),ae.h)break;x[Ee]=(Qe<<24|Ue<<16|Re<<8|at)>>>0}if(Ue=!1,++Ee,++Q>=C&&(Q=0,++q,H!=null&&q<=V&&!(q%16)&&H(p,q),ye!=null))for(;Ae<Ee;)Re=x[Ae++],ye.X[(506832829*Re&4294967295)>>>ye.Mb]=Re}else if(280>Re){if(Re=Ea(Re-256,ae),at=An(je.G[4],je.H[4],ae),K(ae),at=la(C,at=Ea(at,ae)),ae.h)break;if(Ee-k<at||B-Ee<Re)break e;for(Qe=0;Qe<Re;++Qe)x[Ee+Qe]=x[Ee+Qe-at];for(Ee+=Re,Q+=Re;Q>=C;)Q-=C,++q,H!=null&&q<=V&&!(q%16)&&H(p,q);if(t(Ee<=B),Q&we&&(je=Tr(ve,Q,q)),ye!=null)for(;Ae<Ee;)Re=x[Ae++],ye.X[(506832829*Re&4294967295)>>>ye.Mb]=Re}else{if(!(Re<Me))break e;for(Ue=Re-280,t(ye!=null);Ae<Ee;)Re=x[Ae++],ye.X[(506832829*Re&4294967295)>>>ye.Mb]=Re;Re=Ee,t(!(Ue>>>(at=ye).Xa)),x[Re]=at.X[Ue],Ue=!0}Ue||t(ae.h==O(ae))}if(p.Pb&&ae.h&&Ee<B)t(p.m.h),p.a=5,p.m=p.wd,p.$=p.xd,0<p.s.ua&&Te(p.s.vb,p.s.Wa);else{if(ae.h)break e;H!=null&&H(p,q>V?V:q),p.a=0,p.$=Ee-k}return 1}return p.a=3,0}function ke(p){t(p!=null),p.vc=null,p.yc=null,p.Ya=null;var x=p.Wa;x!=null&&(x.X=null),p.vb=null,t(p!=null)}function Le(){var p=new ig;return p==null?null:(p.a=0,p.xb=Z5,Va("Predictor","VP8LPredictors"),Va("Predictor","VP8LPredictors_C"),Va("PredictorAdd","VP8LPredictorsAdd"),Va("PredictorAdd","VP8LPredictorsAdd_C"),ud=It,yl=ut,fa=ze,Kn=Jt,co=dt,Ss=Zr,ks=Xt,P.VP8LMapColor32b=Ic,P.VP8LMapColor8b=hd,p)}function Se(p,x,k,C,B){var V=1,H=[p],q=[x],Q=C.m,ae=C.s,ve=null,Ee=0;e:for(;;){if(k)for(;V&&pe(Q,1);){var Ae=H,be=q,Me=C,Fe=1,ye=Me.m,we=Me.gc[Me.ab],je=pe(ye,2);if(Me.Oc&1<<je)V=0;else{switch(Me.Oc|=1<<je,we.hc=je,we.Ea=Ae[0],we.nc=be[0],we.K=[null],++Me.ab,t(4>=Me.ab),je){case 0:case 1:we.b=pe(ye,3)+2,Fe=Se(Xe(we.Ea,we.b),Xe(we.nc,we.b),0,Me,we.K),we.K=we.K[0];break;case 3:var Ue,Re=pe(ye,8)+1,at=16<Re?0:4<Re?1:2<Re?2:3;if(Ae[0]=Xe(we.Ea,at),we.b=at,Ue=Fe=Se(Re,1,0,Me,we.K)){var Qe,mt=Re,et=we,Gt=1<<(8>>et.b),Qt=i(Gt);if(Qt==null)Ue=0;else{var zt=et.K[0],Rt=et.w;for(Qt[0]=et.K[0][0],Qe=1;Qe<1*mt;++Qe)Qt[Qe]=Be(zt[Rt+Qe],Qt[Qe-1]);for(;Qe<4*Gt;++Qe)Qt[Qe]=0;et.K[0]=null,et.K[0]=Qt,Ue=1}}Fe=Ue;break;case 2:break;default:t(0)}V=Fe}}if(H=H[0],q=q[0],V&&pe(Q,1)&&!(V=1<=(Ee=pe(Q,4))&&11>=Ee)){C.a=3;break e}var or;if(or=V)t:{var ar,Lt,qr,ha=C,Gr=H,da=q,Zt=Ee,Na=k,Pa=ha.m,un=ha.s,yn=[null],Yn=1,Ja=0,Zi=EC[Zt];r:for(;;){if(Na&&pe(Pa,1)){var fn=pe(Pa,3)+2,Cs=Xe(Gr,fn),kl=Xe(da,fn),Bc=Cs*kl;if(!Se(Cs,kl,0,ha,yn))break r;for(yn=yn[0],un.xc=fn,ar=0;ar<Bc;++ar){var mo=yn[ar]>>8&65535;yn[ar]=mo,mo>=Yn&&(Yn=mo+1)}}if(Pa.h)break r;for(Lt=0;5>Lt;++Lt){var Nr=J5[Lt];!Lt&&0<Zt&&(Nr+=1<<Zt),Ja<Nr&&(Ja=Nr)}var mg=s(Yn*Zi,L),lw=Yn,cw=s(lw,W);if(cw==null)var kd=null;else t(65536>=lw),kd=cw;var I0=i(Ja);if(kd==null||I0==null||mg==null){ha.a=1;break r}var Ed=mg;for(ar=qr=0;ar<Yn;++ar){var wi=kd[ar],Uc=wi.G,$c=wi.H,uw=0,Ad=1,fw=0;for(Lt=0;5>Lt;++Lt){Nr=J5[Lt],Uc[Lt]=Ed,$c[Lt]=qr,!Lt&&0<Zt&&(Nr+=1<<Zt);a:{var Td,gg=Nr,Cd=ha,D0=I0,qC=Ed,GC=qr,xg=0,go=Cd.m,KC=pe(go,1);if(a(D0,0,0,gg),KC){var XC=pe(go,1)+1,YC=pe(go,1),hw=pe(go,YC==0?1:8);D0[hw]=1,XC==2&&(D0[hw=pe(go,8)]=1);var Nd=1}else{var dw=i(19),pw=pe(go,4)+4;if(19<pw){Cd.a=3;var Pd=0;break a}for(Td=0;Td<pw;++Td)dw[SC[Td]]=pe(go,3);var vg=void 0,j0=void 0,mw=Cd,JC=dw,Ld=gg,gw=D0,yg=0,xo=mw.m,xw=8,vw=s(128,L);n:for(;N(vw,0,7,JC,19);){if(pe(xo,1)){var QC=2+2*pe(xo,3);if((vg=2+pe(xo,QC))>Ld)break n}else vg=Ld;for(j0=0;j0<Ld&&vg--;){K(xo);var yw=vw[0+(127&D(xo))];M(xo,xo.u+yw.g);var Vc=yw.value;if(16>Vc)gw[j0++]=Vc,Vc!=0&&(xw=Vc);else{var ZC=Vc==16,ww=Vc-16,eN=bC[ww],bw=pe(xo,wC[ww])+eN;if(j0+bw>Ld)break n;for(var tN=ZC?xw:0;0<bw--;)gw[j0++]=tN}}yg=1;break n}yg||(mw.a=3),Nd=yg}(Nd=Nd&&!go.h)&&(xg=N(qC,GC,8,D0,gg)),Nd&&xg!=0?Pd=xg:(Cd.a=3,Pd=0)}if(Pd==0)break r;if(Ad&&_C[Lt]==1&&(Ad=Ed[qr].g==0),uw+=Ed[qr].g,qr+=Pd,3>=Lt){var R0,wg=I0[0];for(R0=1;R0<Nr;++R0)I0[R0]>wg&&(wg=I0[R0]);fw+=wg}}if(wi.nd=Ad,wi.Qb=0,Ad&&(wi.qb=(Uc[3][$c[3]+0].value<<24|Uc[1][$c[1]+0].value<<16|Uc[2][$c[2]+0].value)>>>0,uw==0&&256>Uc[0][$c[0]+0].value&&(wi.Qb=1,wi.qb+=Uc[0][$c[0]+0].value<<8)),wi.jc=!wi.Qb&&6>fw,wi.jc){var Fd,Ns=wi;for(Fd=0;Fd<vn;++Fd){var vo=Fd,yo=Ns.pd[vo],Od=Ns.G[0][Ns.H[0]+vo];256<=Od.value?(yo.g=Od.g+256,yo.value=Od.value):(yo.g=0,yo.value=0,vo>>=Ir(Od,8,yo),vo>>=Ir(Ns.G[1][Ns.H[1]+vo],16,yo),vo>>=Ir(Ns.G[2][Ns.H[2]+vo],0,yo),Ir(Ns.G[3][Ns.H[3]+vo],24,yo))}}}un.vc=yn,un.Wb=Yn,un.Ya=kd,un.yc=mg,or=1;break t}or=0}if(!(V=or)){C.a=3;break e}if(0<Ee){if(ae.ua=1<<Ee,!He(ae.Wa,Ee)){C.a=1,V=0;break e}}else ae.ua=0;var bg=C,_w=H,rN=q,_g=bg.s,Sg=_g.xc;if(bg.c=_w,bg.i=rN,_g.md=Xe(_w,Sg),_g.wc=Sg==0?-1:(1<<Sg)-1,k){C.xb=OC;break e}if((ve=i(H*q))==null){C.a=1,V=0;break e}V=(V=fe(C,ve,0,H,q,q,null))&&!Q.h;break e}return V?(B!=null?B[0]=ve:(t(ve==null),t(k)),C.$=0,k||ke(ae)):ke(ae),V}function Ne(p,x){var k=p.c*p.i,C=k+x+16*x;return t(p.c<=x),p.V=i(C),p.V==null?(p.Ta=null,p.Ua=0,p.a=1,0):(p.Ta=p.V,p.Ua=p.Ba+k+x,1)}function Pe(p,x){var k=p.C,C=x-k,B=p.V,V=p.Ba+p.c*k;for(t(x<=p.l.o);0<C;){var H=16<C?16:C,q=p.l.ma,Q=p.l.width,ae=Q*H,ve=q.ca,Ee=q.tb+Q*k,Ae=p.Ta,be=p.Ua;z(p,H,B,V),Rr(Ae,be,ve,Ee,ae),ne(q,k,k+H,ve,Ee,Q),C-=H,B+=H*p.c,k+=H}t(k==x),p.C=p.Ma=x}function Ve(){this.ub=this.yd=this.td=this.Rb=0}function Ke(){this.Kd=this.Ld=this.Ud=this.Td=this.i=this.c=0}function rt(){this.Fb=this.Bb=this.Cb=0,this.Zb=i(4),this.Lb=i(4)}function qe(){this.Yb=function(){var p=[];return function x(k,C,B){for(var V=B[C],H=0;H<V&&(k.push(B.length>C+1?[]:0),!(B.length<C+1));H++)x(k[H],C+1,B)}(p,0,[3,11]),p}()}function tt(){this.jb=i(3),this.Wc=o([4,8],qe),this.Xc=o([4,17],qe)}function _t(){this.Pc=this.wb=this.Tb=this.zd=0,this.vd=new i(4),this.od=new i(4)}function Yt(){this.ld=this.La=this.dd=this.tc=0}function nr(){this.Na=this.la=0}function Hr(){this.Sc=[0,0],this.Eb=[0,0],this.Qc=[0,0],this.ia=this.lc=0}function pi(){this.ad=i(384),this.Za=0,this.Ob=i(16),this.$b=this.Ad=this.ia=this.Gc=this.Hc=this.Dd=0}function ws(){this.uc=this.M=this.Nb=0,this.wa=Array(new Yt),this.Y=0,this.ya=Array(new pi),this.aa=0,this.l=new Xi}function Ki(){this.y=i(16),this.f=i(8),this.ea=i(8)}function mi(){this.cb=this.a=0,this.sc="",this.m=new me,this.Od=new Ve,this.Kc=new Ke,this.ed=new _t,this.Qa=new rt,this.Ic=this.$c=this.Aa=0,this.D=new ws,this.Xb=this.Va=this.Hb=this.zb=this.yb=this.Ub=this.za=0,this.Jc=s(8,me),this.ia=0,this.pb=s(4,Hr),this.Pa=new tt,this.Bd=this.kc=0,this.Ac=[],this.Bc=0,this.zc=[0,0,0,0],this.Gd=Array(new Ki),this.Hd=0,this.rb=Array(new nr),this.sb=0,this.wa=Array(new Yt),this.Y=0,this.oc=[],this.pc=0,this.sa=[],this.ta=0,this.qa=[],this.ra=0,this.Ha=[],this.B=this.R=this.Ia=0,this.Ec=[],this.M=this.ja=this.Vb=this.Fc=0,this.ya=Array(new pi),this.L=this.aa=0,this.gd=o([4,2],Yt),this.ga=null,this.Fa=[],this.Cc=this.qc=this.P=0,this.Gb=[],this.Uc=0,this.mb=[],this.nb=0,this.rc=[],this.Ga=this.Vc=0}function Xi(){this.T=this.U=this.ka=this.height=this.width=0,this.y=[],this.f=[],this.ea=[],this.Rc=this.fa=this.W=this.N=this.O=0,this.ma="void",this.put="VP8IoPutHook",this.ac="VP8IoSetupHook",this.bc="VP8IoTeardownHook",this.ha=this.Kb=0,this.data=[],this.hb=this.ib=this.da=this.o=this.j=this.va=this.v=this.Da=this.ob=this.w=0,this.F=[],this.J=0}function Aa(){var p=new mi;return p!=null&&(p.a=0,p.sc="OK",p.cb=0,p.Xb=0,F0||(F0=Xh)),p}function Dr(p,x,k){return p.a==0&&(p.a=x,p.sc=k,p.cb=0),0}function Gh(p,x,k){return 3<=k&&p[x+0]==157&&p[x+1]==1&&p[x+2]==42}function Kh(p,x){if(p==null)return 0;if(p.a=0,p.sc="OK",x==null)return Dr(p,2,"null VP8Io passed to VP8GetHeaders()");var k=x.data,C=x.w,B=x.ha;if(4>B)return Dr(p,7,"Truncated header.");var V=k[C+0]|k[C+1]<<8|k[C+2]<<16,H=p.Od;if(H.Rb=!(1&V),H.td=V>>1&7,H.yd=V>>4&1,H.ub=V>>5,3<H.td)return Dr(p,3,"Incorrect keyframe parameters.");if(!H.yd)return Dr(p,4,"Frame not displayable.");C+=3,B-=3;var q=p.Kc;if(H.Rb){if(7>B)return Dr(p,7,"cannot parse picture header");if(!Gh(k,C,B))return Dr(p,3,"Bad code word");q.c=16383&(k[C+4]<<8|k[C+3]),q.Td=k[C+4]>>6,q.i=16383&(k[C+6]<<8|k[C+5]),q.Ud=k[C+6]>>6,C+=7,B-=7,p.za=q.c+15>>4,p.Ub=q.i+15>>4,x.width=q.c,x.height=q.i,x.Da=0,x.j=0,x.v=0,x.va=x.width,x.o=x.height,x.da=0,x.ib=x.width,x.hb=x.height,x.U=x.width,x.T=x.height,a((V=p.Pa).jb,0,255,V.jb.length),t((V=p.Qa)!=null),V.Cb=0,V.Bb=0,V.Fb=1,a(V.Zb,0,0,V.Zb.length),a(V.Lb,0,0,V.Lb)}if(H.ub>B)return Dr(p,7,"bad partition length");le(V=p.m,k,C,H.ub),C+=H.ub,B-=H.ub,H.Rb&&(q.Ld=re(V),q.Kd=re(V)),q=p.Qa;var Q,ae=p.Pa;if(t(V!=null),t(q!=null),q.Cb=re(V),q.Cb){if(q.Bb=re(V),re(V)){for(q.Fb=re(V),Q=0;4>Q;++Q)q.Zb[Q]=re(V)?X(V,7):0;for(Q=0;4>Q;++Q)q.Lb[Q]=re(V)?X(V,6):0}if(q.Bb)for(Q=0;3>Q;++Q)ae.jb[Q]=re(V)?de(V,8):255}else q.Bb=0;if(V.Ka)return Dr(p,3,"cannot parse segment header");if((q=p.ed).zd=re(V),q.Tb=de(V,6),q.wb=de(V,3),q.Pc=re(V),q.Pc&&re(V)){for(ae=0;4>ae;++ae)re(V)&&(q.vd[ae]=X(V,6));for(ae=0;4>ae;++ae)re(V)&&(q.od[ae]=X(V,6))}if(p.L=q.Tb==0?0:q.zd?1:2,V.Ka)return Dr(p,3,"cannot parse filter header");var ve=B;if(B=Q=C,C=Q+ve,q=ve,p.Xb=(1<<de(p.m,2))-1,ve<3*(ae=p.Xb))k=7;else{for(Q+=3*ae,q-=3*ae,ve=0;ve<ae;++ve){var Ee=k[B+0]|k[B+1]<<8|k[B+2]<<16;Ee>q&&(Ee=q),le(p.Jc[+ve],k,Q,Ee),Q+=Ee,q-=Ee,B+=3}le(p.Jc[+ae],k,Q,q),k=Q<C?0:5}if(k!=0)return Dr(p,k,"cannot parse partitions");for(k=de(Q=p.m,7),B=re(Q)?X(Q,4):0,C=re(Q)?X(Q,4):0,q=re(Q)?X(Q,4):0,ae=re(Q)?X(Q,4):0,Q=re(Q)?X(Q,4):0,ve=p.Qa,Ee=0;4>Ee;++Ee){if(ve.Cb){var Ae=ve.Zb[Ee];ve.Fb||(Ae+=k)}else{if(0<Ee){p.pb[Ee]=p.pb[0];continue}Ae=k}var be=p.pb[Ee];be.Sc[0]=hg[Ta(Ae+B,127)],be.Sc[1]=dg[Ta(Ae+0,127)],be.Eb[0]=2*hg[Ta(Ae+C,127)],be.Eb[1]=101581*dg[Ta(Ae+q,127)]>>16,8>be.Eb[1]&&(be.Eb[1]=8),be.Qc[0]=hg[Ta(Ae+ae,117)],be.Qc[1]=dg[Ta(Ae+Q,127)],be.lc=Ae+Q}if(!H.Rb)return Dr(p,4,"Not a key frame.");for(re(V),H=p.Pa,k=0;4>k;++k){for(B=0;8>B;++B)for(C=0;3>C;++C)for(q=0;11>q;++q)ae=se(V,LC[k][B][C][q])?de(V,8):NC[k][B][C][q],H.Wc[k][B].Yb[C][q]=ae;for(B=0;17>B;++B)H.Xc[k][B]=H.Wc[k][FC[B]]}return p.kc=re(V),p.kc&&(p.Bd=de(V,8)),p.cb=1}function Xh(p,x,k,C,B,V,H){var q=x[B].Yb[k];for(k=0;16>B;++B){if(!se(p,q[k+0]))return B;for(;!se(p,q[k+1]);)if(q=x[++B].Yb[0],k=0,B==16)return 16;var Q=x[B+1].Yb;if(se(p,q[k+2])){var ae=p,ve=0;if(se(ae,(Ae=q)[(Ee=k)+3]))if(se(ae,Ae[Ee+6])){for(q=0,Ee=2*(ve=se(ae,Ae[Ee+8]))+(Ae=se(ae,Ae[Ee+9+ve])),ve=0,Ae=TC[Ee];Ae[q];++q)ve+=ve+se(ae,Ae[q]);ve+=3+(8<<Ee)}else se(ae,Ae[Ee+7])?(ve=7+2*se(ae,165),ve+=se(ae,145)):ve=5+se(ae,159);else ve=se(ae,Ae[Ee+4])?3+se(ae,Ae[Ee+5]):2;q=Q[2]}else ve=1,q=Q[1];Q=H+CC[B],0>(ae=p).b&&Y(ae);var Ee,Ae=ae.b,be=(Ee=ae.Ca>>1)-(ae.I>>Ae)>>31;--ae.b,ae.Ca+=be,ae.Ca|=1,ae.I-=(Ee+1&be)<<Ae,V[Q]=((ve^be)-be)*C[(0<B)+0]}return 16}function c0(p){var x=p.rb[p.sb-1];x.la=0,x.Na=0,a(p.zc,0,0,p.zc.length),p.ja=0}function Vm(p,x){if(p==null)return 0;if(x==null)return Dr(p,2,"NULL VP8Io parameter in VP8Decode().");if(!p.cb&&!Kh(p,x))return 0;if(t(p.cb),x.ac==null||x.ac(x)){x.ob&&(p.L=0);var k=Sd[p.L];if(p.L==2?(p.yb=0,p.zb=0):(p.yb=x.v-k>>4,p.zb=x.j-k>>4,0>p.yb&&(p.yb=0),0>p.zb&&(p.zb=0)),p.Va=x.o+15+k>>4,p.Hb=x.va+15+k>>4,p.Hb>p.za&&(p.Hb=p.za),p.Va>p.Ub&&(p.Va=p.Ub),0<p.L){var C=p.ed;for(k=0;4>k;++k){var B;if(p.Qa.Cb){var V=p.Qa.Lb[k];p.Qa.Fb||(V+=C.Tb)}else V=C.Tb;for(B=0;1>=B;++B){var H=p.gd[k][B],q=V;if(C.Pc&&(q+=C.vd[0],B&&(q+=C.od[0])),0<(q=0>q?0:63<q?63:q)){var Q=q;0<C.wb&&(Q=4<C.wb?Q>>2:Q>>1)>9-C.wb&&(Q=9-C.wb),1>Q&&(Q=1),H.dd=Q,H.tc=2*q+Q,H.ld=40<=q?2:15<=q?1:0}else H.tc=0;H.La=B}}}k=0}else Dr(p,6,"Frame setup failed"),k=p.a;if(k=k==0){if(k){p.$c=0,0<p.Aa||(p.Ic=WC);e:{k=p.Ic,C=4*(Q=p.za);var ae=32*Q,ve=Q+1,Ee=0<p.L?Q*(0<p.Aa?2:1):0,Ae=(p.Aa==2?2:1)*Q;if((H=C+832+(B=3*(16*k+Sd[p.L])/2*ae)+(V=p.Fa!=null&&0<p.Fa.length?p.Kc.c*p.Kc.i:0))!=H)k=0;else{if(H>p.Vb){if(p.Vb=0,p.Ec=i(H),p.Fc=0,p.Ec==null){k=Dr(p,1,"no memory during frame initialization.");break e}p.Vb=H}H=p.Ec,q=p.Fc,p.Ac=H,p.Bc=q,q+=C,p.Gd=s(ae,Ki),p.Hd=0,p.rb=s(ve+1,nr),p.sb=1,p.wa=Ee?s(Ee,Yt):null,p.Y=0,p.D.Nb=0,p.D.wa=p.wa,p.D.Y=p.Y,0<p.Aa&&(p.D.Y+=Q),t(!0),p.oc=H,p.pc=q,q+=832,p.ya=s(Ae,pi),p.aa=0,p.D.ya=p.ya,p.D.aa=p.aa,p.Aa==2&&(p.D.aa+=Q),p.R=16*Q,p.B=8*Q,Q=(ae=Sd[p.L])*p.R,ae=ae/2*p.B,p.sa=H,p.ta=q+Q,p.qa=p.sa,p.ra=p.ta+16*k*p.R+ae,p.Ha=p.qa,p.Ia=p.ra+8*k*p.B+ae,p.$c=0,q+=B,p.mb=V?H:null,p.nb=V?q:null,t(q+V<=p.Fc+p.Vb),c0(p),a(p.Ac,p.Bc,0,C),k=1}}if(k){if(x.ka=0,x.y=p.sa,x.O=p.ta,x.f=p.qa,x.N=p.ra,x.ea=p.Ha,x.Vd=p.Ia,x.fa=p.R,x.Rc=p.B,x.F=null,x.J=0,!pd){for(k=-255;255>=k;++k)tn[255+k]=0>k?-k:k;for(k=-1020;1020>=k;++k)As[1020+k]=-128>k?-128:127<k?127:k;for(k=-112;112>=k;++k)L0[112+k]=-16>k?-16:15<k?15:k;for(k=-255;510>=k;++k)Mc[255+k]=0>k?0:255<k?255:k;pd=1}Dc=Wm,Es=zm,C0=Jh,Xn=Hm,qa=Qh,jr=Yh,jc=m0,dd=xl,N0=ag,wl=g0,bl=ng,uo=Ac,_l=x0,Rc=od,Sl=sd,fo=Ji,P0=_s,Ga=rg,yi[0]=Yi,yi[1]=qm,yi[2]=Ym,yi[3]=Jm,yi[4]=td,yi[5]=kc,yi[6]=rd,yi[7]=h0,yi[8]=Zm,yi[9]=Qm,ho[0]=Zh,ho[1]=Km,ho[2]=bs,ho[3]=_c,ho[4]=Tn,ho[5]=Xm,ho[6]=ed,Ts[0]=io,Ts[1]=Gm,Ts[2]=eg,Ts[3]=d0,Ts[4]=gl,Ts[5]=tg,Ts[6]=p0,k=1}else k=0}k&&(k=function(be,Me){for(be.M=0;be.M<be.Va;++be.M){var Fe,ye=be.Jc[be.M&be.Xb],we=be.m,je=be;for(Fe=0;Fe<je.za;++Fe){var Ue=we,Re=je,at=Re.Ac,Qe=Re.Bc+4*Fe,mt=Re.zc,et=Re.ya[Re.aa+Fe];if(Re.Qa.Bb?et.$b=se(Ue,Re.Pa.jb[0])?2+se(Ue,Re.Pa.jb[2]):se(Ue,Re.Pa.jb[1]):et.$b=0,Re.kc&&(et.Ad=se(Ue,Re.Bd)),et.Za=!se(Ue,145)+0,et.Za){var Gt=et.Ob,Qt=0;for(Re=0;4>Re;++Re){var zt,Rt=mt[0+Re];for(zt=0;4>zt;++zt){Rt=PC[at[Qe+zt]][Rt];for(var or=Q5[se(Ue,Rt[0])];0<or;)or=Q5[2*or+se(Ue,Rt[or])];Rt=-or,at[Qe+zt]=Rt}n(Gt,Qt,at,Qe,4),Qt+=4,mt[0+Re]=Rt}}else Rt=se(Ue,156)?se(Ue,128)?1:3:se(Ue,163)?2:0,et.Ob[0]=Rt,a(at,Qe,Rt,4),a(mt,0,Rt,4);et.Dd=se(Ue,142)?se(Ue,114)?se(Ue,183)?1:3:2:0}if(je.m.Ka)return Dr(be,7,"Premature end-of-partition0 encountered.");for(;be.ja<be.za;++be.ja){if(je=ye,Ue=(we=be).rb[we.sb-1],at=we.rb[we.sb+we.ja],Fe=we.ya[we.aa+we.ja],Qe=we.kc?Fe.Ad:0)Ue.la=at.la=0,Fe.Za||(Ue.Na=at.Na=0),Fe.Hc=0,Fe.Gc=0,Fe.ia=0;else{var ar,Lt;if(Ue=at,at=je,Qe=we.Pa.Xc,mt=we.ya[we.aa+we.ja],et=we.pb[mt.$b],Re=mt.ad,Gt=0,Qt=we.rb[we.sb-1],Rt=zt=0,a(Re,Gt,0,384),mt.Za)var qr=0,ha=Qe[3];else{or=i(16);var Gr=Ue.Na+Qt.Na;if(Gr=F0(at,Qe[1],Gr,et.Eb,0,or,0),Ue.Na=Qt.Na=(0<Gr)+0,1<Gr)Dc(or,0,Re,Gt);else{var da=or[0]+3>>3;for(or=0;256>or;or+=16)Re[Gt+or]=da}qr=1,ha=Qe[0]}var Zt=15&Ue.la,Na=15&Qt.la;for(or=0;4>or;++or){var Pa=1&Na;for(da=Lt=0;4>da;++da)Zt=Zt>>1|(Pa=(Gr=F0(at,ha,Gr=Pa+(1&Zt),et.Sc,qr,Re,Gt))>qr)<<7,Lt=Lt<<2|(3<Gr?3:1<Gr?2:Re[Gt+0]!=0),Gt+=16;Zt>>=4,Na=Na>>1|Pa<<7,zt=(zt<<8|Lt)>>>0}for(ha=Zt,qr=Na>>4,ar=0;4>ar;ar+=2){for(Lt=0,Zt=Ue.la>>4+ar,Na=Qt.la>>4+ar,or=0;2>or;++or){for(Pa=1&Na,da=0;2>da;++da)Gr=Pa+(1&Zt),Zt=Zt>>1|(Pa=0<(Gr=F0(at,Qe[2],Gr,et.Qc,0,Re,Gt)))<<3,Lt=Lt<<2|(3<Gr?3:1<Gr?2:Re[Gt+0]!=0),Gt+=16;Zt>>=2,Na=Na>>1|Pa<<5}Rt|=Lt<<4*ar,ha|=Zt<<4<<ar,qr|=(240&Na)<<ar}Ue.la=ha,Qt.la=qr,mt.Hc=zt,mt.Gc=Rt,mt.ia=43690&Rt?0:et.ia,Qe=!(zt|Rt)}if(0<we.L&&(we.wa[we.Y+we.ja]=we.gd[Fe.$b][Fe.Za],we.wa[we.Y+we.ja].La|=!Qe),je.Ka)return Dr(be,7,"Premature end-of-file encountered.")}if(c0(be),we=Me,je=1,Fe=(ye=be).D,Ue=0<ye.L&&ye.M>=ye.zb&&ye.M<=ye.Va,ye.Aa==0)e:{if(Fe.M=ye.M,Fe.uc=Ue,S0(ye,Fe),je=1,Fe=(Lt=ye.D).Nb,Ue=(Rt=Sd[ye.L])*ye.R,at=Rt/2*ye.B,or=16*Fe*ye.R,da=8*Fe*ye.B,Qe=ye.sa,mt=ye.ta-Ue+or,et=ye.qa,Re=ye.ra-at+da,Gt=ye.Ha,Qt=ye.Ia-at+da,Na=(Zt=Lt.M)==0,zt=Zt>=ye.Va-1,ye.Aa==2&&S0(ye,Lt),Lt.uc)for(Pa=(Gr=ye).D.M,t(Gr.D.uc),Lt=Gr.yb;Lt<Gr.Hb;++Lt){qr=Lt,ha=Pa;var un=(yn=(Nr=Gr).D).Nb;ar=Nr.R;var yn=yn.wa[yn.Y+qr],Yn=Nr.sa,Ja=Nr.ta+16*un*ar+16*qr,Zi=yn.dd,fn=yn.tc;if(fn!=0)if(t(3<=fn),Nr.L==1)0<qr&&fo(Yn,Ja,ar,fn+4),yn.La&&Ga(Yn,Ja,ar,fn),0<ha&&Sl(Yn,Ja,ar,fn+4),yn.La&&P0(Yn,Ja,ar,fn);else{var Cs=Nr.B,kl=Nr.qa,Bc=Nr.ra+8*un*Cs+8*qr,mo=Nr.Ha,Nr=Nr.Ia+8*un*Cs+8*qr;un=yn.ld,0<qr&&(dd(Yn,Ja,ar,fn+4,Zi,un),wl(kl,Bc,mo,Nr,Cs,fn+4,Zi,un)),yn.La&&(uo(Yn,Ja,ar,fn,Zi,un),Rc(kl,Bc,mo,Nr,Cs,fn,Zi,un)),0<ha&&(jc(Yn,Ja,ar,fn+4,Zi,un),N0(kl,Bc,mo,Nr,Cs,fn+4,Zi,un)),yn.La&&(bl(Yn,Ja,ar,fn,Zi,un),_l(kl,Bc,mo,Nr,Cs,fn,Zi,un))}}if(ye.ia&&alert("todo:DitherRow"),we.put!=null){if(Lt=16*Zt,Zt=16*(Zt+1),Na?(we.y=ye.sa,we.O=ye.ta+or,we.f=ye.qa,we.N=ye.ra+da,we.ea=ye.Ha,we.W=ye.Ia+da):(Lt-=Rt,we.y=Qe,we.O=mt,we.f=et,we.N=Re,we.ea=Gt,we.W=Qt),zt||(Zt-=Rt),Zt>we.o&&(Zt=we.o),we.F=null,we.J=null,ye.Fa!=null&&0<ye.Fa.length&&Lt<Zt&&(we.J=b0(ye,we,Lt,Zt-Lt),we.F=ye.mb,we.F==null&&we.F.length==0)){je=Dr(ye,3,"Could not decode alpha data.");break e}Lt<we.j&&(Rt=we.j-Lt,Lt=we.j,t(!(1&Rt)),we.O+=ye.R*Rt,we.N+=ye.B*(Rt>>1),we.W+=ye.B*(Rt>>1),we.F!=null&&(we.J+=we.width*Rt)),Lt<Zt&&(we.O+=we.v,we.N+=we.v>>1,we.W+=we.v>>1,we.F!=null&&(we.J+=we.v),we.ka=Lt-we.j,we.U=we.va-we.v,we.T=Zt-Lt,je=we.put(we))}Fe+1!=ye.Ic||zt||(n(ye.sa,ye.ta-Ue,Qe,mt+16*ye.R,Ue),n(ye.qa,ye.ra-at,et,Re+8*ye.B,at),n(ye.Ha,ye.Ia-at,Gt,Qt+8*ye.B,at))}if(!je)return Dr(be,6,"Output aborted.")}return 1}(p,x)),x.bc!=null&&x.bc(x),k&=1}return k?(p.cb=0,k):0}function gi(p,x,k,C,B){B=p[x+k+32*C]+(B>>3),p[x+k+32*C]=-256&B?0>B?0:255:B}function bc(p,x,k,C,B,V){gi(p,x,0,k,C+B),gi(p,x,1,k,C+V),gi(p,x,2,k,C-V),gi(p,x,3,k,C-B)}function ca(p){return(20091*p>>16)+p}function u0(p,x,k,C){var B,V=0,H=i(16);for(B=0;4>B;++B){var q=p[x+0]+p[x+8],Q=p[x+0]-p[x+8],ae=(35468*p[x+4]>>16)-ca(p[x+12]),ve=ca(p[x+4])+(35468*p[x+12]>>16);H[V+0]=q+ve,H[V+1]=Q+ae,H[V+2]=Q-ae,H[V+3]=q-ve,V+=4,x++}for(B=V=0;4>B;++B)q=(p=H[V+0]+4)+H[V+8],Q=p-H[V+8],ae=(35468*H[V+4]>>16)-ca(H[V+12]),gi(k,C,0,0,q+(ve=ca(H[V+4])+(35468*H[V+12]>>16))),gi(k,C,1,0,Q+ae),gi(k,C,2,0,Q-ae),gi(k,C,3,0,q-ve),V++,C+=32}function Yh(p,x,k,C){var B=p[x+0]+4,V=35468*p[x+4]>>16,H=ca(p[x+4]),q=35468*p[x+1]>>16;bc(k,C,0,B+H,p=ca(p[x+1]),q),bc(k,C,1,B+V,p,q),bc(k,C,2,B-V,p,q),bc(k,C,3,B-H,p,q)}function zm(p,x,k,C,B){u0(p,x,k,C),B&&u0(p,x+16,k,C+4)}function Jh(p,x,k,C){Es(p,x+0,k,C,1),Es(p,x+32,k,C+128,1)}function Hm(p,x,k,C){var B;for(p=p[x+0]+4,B=0;4>B;++B)for(x=0;4>x;++x)gi(k,C,x,B,p)}function Qh(p,x,k,C){p[x+0]&&Xn(p,x+0,k,C),p[x+16]&&Xn(p,x+16,k,C+4),p[x+32]&&Xn(p,x+32,k,C+128),p[x+48]&&Xn(p,x+48,k,C+128+4)}function Wm(p,x,k,C){var B,V=i(16);for(B=0;4>B;++B){var H=p[x+0+B]+p[x+12+B],q=p[x+4+B]+p[x+8+B],Q=p[x+4+B]-p[x+8+B],ae=p[x+0+B]-p[x+12+B];V[0+B]=H+q,V[8+B]=H-q,V[4+B]=ae+Q,V[12+B]=ae-Q}for(B=0;4>B;++B)H=(p=V[0+4*B]+3)+V[3+4*B],q=V[1+4*B]+V[2+4*B],Q=V[1+4*B]-V[2+4*B],ae=p-V[3+4*B],k[C+0]=H+q>>3,k[C+16]=ae+Q>>3,k[C+32]=H-q>>3,k[C+48]=ae-Q>>3,C+=64}function f0(p,x,k){var C,B=x-32,V=Ca,H=255-p[B-1];for(C=0;C<k;++C){var q,Q=V,ae=H+p[x-1];for(q=0;q<k;++q)p[x+q]=Q[ae+p[B+q]];x+=32}}function qm(p,x){f0(p,x,4)}function Gm(p,x){f0(p,x,8)}function Km(p,x){f0(p,x,16)}function bs(p,x){var k;for(k=0;16>k;++k)n(p,x+32*k,p,x-32,16)}function _c(p,x){var k;for(k=16;0<k;--k)a(p,x,p[x-1],16),x+=32}function Sc(p,x,k){var C;for(C=0;16>C;++C)a(x,k+32*C,p,16)}function Zh(p,x){var k,C=16;for(k=0;16>k;++k)C+=p[x-1+32*k]+p[x+k-32];Sc(C>>5,p,x)}function Tn(p,x){var k,C=8;for(k=0;16>k;++k)C+=p[x-1+32*k];Sc(C>>4,p,x)}function Xm(p,x){var k,C=8;for(k=0;16>k;++k)C+=p[x+k-32];Sc(C>>4,p,x)}function ed(p,x){Sc(128,p,x)}function kt(p,x,k){return p+2*x+k+2>>2}function Ym(p,x){var k,C=x-32;for(C=new Uint8Array([kt(p[C-1],p[C+0],p[C+1]),kt(p[C+0],p[C+1],p[C+2]),kt(p[C+1],p[C+2],p[C+3]),kt(p[C+2],p[C+3],p[C+4])]),k=0;4>k;++k)n(p,x+32*k,C,0,C.length)}function Jm(p,x){var k=p[x-1],C=p[x-1+32],B=p[x-1+64],V=p[x-1+96];xe(p,x+0,16843009*kt(p[x-1-32],k,C)),xe(p,x+32,16843009*kt(k,C,B)),xe(p,x+64,16843009*kt(C,B,V)),xe(p,x+96,16843009*kt(B,V,V))}function Yi(p,x){var k,C=4;for(k=0;4>k;++k)C+=p[x+k-32]+p[x-1+32*k];for(C>>=3,k=0;4>k;++k)a(p,x+32*k,C,4)}function td(p,x){var k=p[x-1+0],C=p[x-1+32],B=p[x-1+64],V=p[x-1-32],H=p[x+0-32],q=p[x+1-32],Q=p[x+2-32],ae=p[x+3-32];p[x+0+96]=kt(C,B,p[x-1+96]),p[x+1+96]=p[x+0+64]=kt(k,C,B),p[x+2+96]=p[x+1+64]=p[x+0+32]=kt(V,k,C),p[x+3+96]=p[x+2+64]=p[x+1+32]=p[x+0+0]=kt(H,V,k),p[x+3+64]=p[x+2+32]=p[x+1+0]=kt(q,H,V),p[x+3+32]=p[x+2+0]=kt(Q,q,H),p[x+3+0]=kt(ae,Q,q)}function rd(p,x){var k=p[x+1-32],C=p[x+2-32],B=p[x+3-32],V=p[x+4-32],H=p[x+5-32],q=p[x+6-32],Q=p[x+7-32];p[x+0+0]=kt(p[x+0-32],k,C),p[x+1+0]=p[x+0+32]=kt(k,C,B),p[x+2+0]=p[x+1+32]=p[x+0+64]=kt(C,B,V),p[x+3+0]=p[x+2+32]=p[x+1+64]=p[x+0+96]=kt(B,V,H),p[x+3+32]=p[x+2+64]=p[x+1+96]=kt(V,H,q),p[x+3+64]=p[x+2+96]=kt(H,q,Q),p[x+3+96]=kt(q,Q,Q)}function kc(p,x){var k=p[x-1+0],C=p[x-1+32],B=p[x-1+64],V=p[x-1-32],H=p[x+0-32],q=p[x+1-32],Q=p[x+2-32],ae=p[x+3-32];p[x+0+0]=p[x+1+64]=V+H+1>>1,p[x+1+0]=p[x+2+64]=H+q+1>>1,p[x+2+0]=p[x+3+64]=q+Q+1>>1,p[x+3+0]=Q+ae+1>>1,p[x+0+96]=kt(B,C,k),p[x+0+64]=kt(C,k,V),p[x+0+32]=p[x+1+96]=kt(k,V,H),p[x+1+32]=p[x+2+96]=kt(V,H,q),p[x+2+32]=p[x+3+96]=kt(H,q,Q),p[x+3+32]=kt(q,Q,ae)}function h0(p,x){var k=p[x+0-32],C=p[x+1-32],B=p[x+2-32],V=p[x+3-32],H=p[x+4-32],q=p[x+5-32],Q=p[x+6-32],ae=p[x+7-32];p[x+0+0]=k+C+1>>1,p[x+1+0]=p[x+0+64]=C+B+1>>1,p[x+2+0]=p[x+1+64]=B+V+1>>1,p[x+3+0]=p[x+2+64]=V+H+1>>1,p[x+0+32]=kt(k,C,B),p[x+1+32]=p[x+0+96]=kt(C,B,V),p[x+2+32]=p[x+1+96]=kt(B,V,H),p[x+3+32]=p[x+2+96]=kt(V,H,q),p[x+3+64]=kt(H,q,Q),p[x+3+96]=kt(q,Q,ae)}function Qm(p,x){var k=p[x-1+0],C=p[x-1+32],B=p[x-1+64],V=p[x-1+96];p[x+0+0]=k+C+1>>1,p[x+2+0]=p[x+0+32]=C+B+1>>1,p[x+2+32]=p[x+0+64]=B+V+1>>1,p[x+1+0]=kt(k,C,B),p[x+3+0]=p[x+1+32]=kt(C,B,V),p[x+3+32]=p[x+1+64]=kt(B,V,V),p[x+3+64]=p[x+2+64]=p[x+0+96]=p[x+1+96]=p[x+2+96]=p[x+3+96]=V}function Zm(p,x){var k=p[x-1+0],C=p[x-1+32],B=p[x-1+64],V=p[x-1+96],H=p[x-1-32],q=p[x+0-32],Q=p[x+1-32],ae=p[x+2-32];p[x+0+0]=p[x+2+32]=k+H+1>>1,p[x+0+32]=p[x+2+64]=C+k+1>>1,p[x+0+64]=p[x+2+96]=B+C+1>>1,p[x+0+96]=V+B+1>>1,p[x+3+0]=kt(q,Q,ae),p[x+2+0]=kt(H,q,Q),p[x+1+0]=p[x+3+32]=kt(k,H,q),p[x+1+32]=p[x+3+64]=kt(C,k,H),p[x+1+64]=p[x+3+96]=kt(B,C,k),p[x+1+96]=kt(V,B,C)}function eg(p,x){var k;for(k=0;8>k;++k)n(p,x+32*k,p,x-32,8)}function d0(p,x){var k;for(k=0;8>k;++k)a(p,x,p[x-1],8),x+=32}function ml(p,x,k){var C;for(C=0;8>C;++C)a(x,k+32*C,p,8)}function io(p,x){var k,C=8;for(k=0;8>k;++k)C+=p[x+k-32]+p[x-1+32*k];ml(C>>4,p,x)}function tg(p,x){var k,C=4;for(k=0;8>k;++k)C+=p[x+k-32];ml(C>>3,p,x)}function gl(p,x){var k,C=4;for(k=0;8>k;++k)C+=p[x-1+32*k];ml(C>>3,p,x)}function p0(p,x){ml(128,p,x)}function Ec(p,x,k){var C=p[x-k],B=p[x+0],V=3*(B-C)+og[1020+p[x-2*k]-p[x+k]],H=md[112+(V+4>>3)];p[x-k]=Ca[255+C+md[112+(V+3>>3)]],p[x+0]=Ca[255+B-H]}function nd(p,x,k,C){var B=p[x+0],V=p[x+k];return Xa[255+p[x-2*k]-p[x-k]]>C||Xa[255+V-B]>C}function ad(p,x,k,C){return 4*Xa[255+p[x-k]-p[x+0]]+Xa[255+p[x-2*k]-p[x+k]]<=C}function id(p,x,k,C,B){var V=p[x-3*k],H=p[x-2*k],q=p[x-k],Q=p[x+0],ae=p[x+k],ve=p[x+2*k],Ee=p[x+3*k];return 4*Xa[255+q-Q]+Xa[255+H-ae]>C?0:Xa[255+p[x-4*k]-V]<=B&&Xa[255+V-H]<=B&&Xa[255+H-q]<=B&&Xa[255+Ee-ve]<=B&&Xa[255+ve-ae]<=B&&Xa[255+ae-Q]<=B}function sd(p,x,k,C){var B=2*C+1;for(C=0;16>C;++C)ad(p,x+C,k,B)&&Ec(p,x+C,k)}function Ji(p,x,k,C){var B=2*C+1;for(C=0;16>C;++C)ad(p,x+C*k,1,B)&&Ec(p,x+C*k,1)}function _s(p,x,k,C){var B;for(B=3;0<B;--B)sd(p,x+=4*k,k,C)}function rg(p,x,k,C){var B;for(B=3;0<B;--B)Ji(p,x+=4,k,C)}function so(p,x,k,C,B,V,H,q){for(V=2*V+1;0<B--;){if(id(p,x,k,V,H))if(nd(p,x,k,q))Ec(p,x,k);else{var Q=p,ae=x,ve=k,Ee=Q[ae-2*ve],Ae=Q[ae-ve],be=Q[ae+0],Me=Q[ae+ve],Fe=Q[ae+2*ve],ye=27*(je=og[1020+3*(be-Ae)+og[1020+Ee-Me]])+63>>7,we=18*je+63>>7,je=9*je+63>>7;Q[ae-3*ve]=Ca[255+Q[ae-3*ve]+je],Q[ae-2*ve]=Ca[255+Ee+we],Q[ae-ve]=Ca[255+Ae+ye],Q[ae+0]=Ca[255+be-ye],Q[ae+ve]=Ca[255+Me-we],Q[ae+2*ve]=Ca[255+Fe-je]}x+=C}}function xi(p,x,k,C,B,V,H,q){for(V=2*V+1;0<B--;){if(id(p,x,k,V,H))if(nd(p,x,k,q))Ec(p,x,k);else{var Q=p,ae=x,ve=k,Ee=Q[ae-ve],Ae=Q[ae+0],be=Q[ae+ve],Me=md[112+((Fe=3*(Ae-Ee))+4>>3)],Fe=md[112+(Fe+3>>3)],ye=Me+1>>1;Q[ae-2*ve]=Ca[255+Q[ae-2*ve]+ye],Q[ae-ve]=Ca[255+Ee+Fe],Q[ae+0]=Ca[255+Ae-Me],Q[ae+ve]=Ca[255+be-ye]}x+=C}}function m0(p,x,k,C,B,V){so(p,x,k,1,16,C,B,V)}function xl(p,x,k,C,B,V){so(p,x,1,k,16,C,B,V)}function ng(p,x,k,C,B,V){var H;for(H=3;0<H;--H)xi(p,x+=4*k,k,1,16,C,B,V)}function Ac(p,x,k,C,B,V){var H;for(H=3;0<H;--H)xi(p,x+=4,1,k,16,C,B,V)}function ag(p,x,k,C,B,V,H,q){so(p,x,B,1,8,V,H,q),so(k,C,B,1,8,V,H,q)}function g0(p,x,k,C,B,V,H,q){so(p,x,1,B,8,V,H,q),so(k,C,1,B,8,V,H,q)}function x0(p,x,k,C,B,V,H,q){xi(p,x+4*B,B,1,8,V,H,q),xi(k,C+4*B,B,1,8,V,H,q)}function od(p,x,k,C,B,V,H,q){xi(p,x+4,1,B,8,V,H,q),xi(k,C+4,1,B,8,V,H,q)}function Tc(){this.ba=new ka,this.ec=[],this.cc=[],this.Mc=[],this.Dc=this.Nc=this.dc=this.fc=0,this.Oa=new sr,this.memory=0,this.Ib="OutputFunc",this.Jb="OutputAlphaFunc",this.Nd="OutputRowFunc"}function v0(){this.data=[],this.offset=this.kd=this.ha=this.w=0,this.na=[],this.xa=this.gb=this.Ja=this.Sa=this.P=0}function y0(){this.nc=this.Ea=this.b=this.hc=0,this.K=[],this.w=0}function ld(){this.ua=0,this.Wa=new oe,this.vb=new oe,this.md=this.xc=this.wc=0,this.vc=[],this.Wb=0,this.Ya=new W,this.yc=new L}function ig(){this.xb=this.a=0,this.l=new Xi,this.ca=new ka,this.V=[],this.Ba=0,this.Ta=[],this.Ua=0,this.m=new E,this.Pb=0,this.wd=new E,this.Ma=this.$=this.C=this.i=this.c=this.xd=0,this.s=new ld,this.ab=0,this.gc=s(4,y0),this.Oc=0}function Cc(){this.Lc=this.Z=this.$a=this.i=this.c=0,this.l=new Xi,this.ic=0,this.ca=[],this.tb=0,this.qd=null,this.rd=0}function vl(p,x,k,C,B,V,H){for(p=p==null?0:p[x+0],x=0;x<H;++x)B[V+x]=p+k[C+x]&255,p=B[V+x]}function w0(p,x,k,C,B,V,H){var q;if(p==null)vl(null,null,k,C,B,V,H);else for(q=0;q<H;++q)B[V+q]=p[x+q]+k[C+q]&255}function oo(p,x,k,C,B,V,H){if(p==null)vl(null,null,k,C,B,V,H);else{var q,Q=p[x+0],ae=Q,ve=Q;for(q=0;q<H;++q)ae=ve+(Q=p[x+q])-ae,ve=k[C+q]+(-256&ae?0>ae?0:255:ae)&255,ae=Q,B[V+q]=ve}}function b0(p,x,k,C){var B=x.width,V=x.o;if(t(p!=null&&x!=null),0>k||0>=C||k+C>V)return null;if(!p.Cc){if(p.ga==null){var H;if(p.ga=new Cc,(H=p.ga==null)||(H=x.width*x.o,t(p.Gb.length==0),p.Gb=i(H),p.Uc=0,p.Gb==null?H=0:(p.mb=p.Gb,p.nb=p.Uc,p.rc=null,H=1),H=!H),!H){H=p.ga;var q=p.Fa,Q=p.P,ae=p.qc,ve=p.mb,Ee=p.nb,Ae=Q+1,be=ae-1,Me=H.l;if(t(q!=null&&ve!=null&&x!=null),po[0]=null,po[1]=vl,po[2]=w0,po[3]=oo,H.ca=ve,H.tb=Ee,H.c=x.width,H.i=x.height,t(0<H.c&&0<H.i),1>=ae)x=0;else if(H.$a=q[Q+0]>>0&3,H.Z=q[Q+0]>>2&3,H.Lc=q[Q+0]>>4&3,Q=q[Q+0]>>6&3,0>H.$a||1<H.$a||4<=H.Z||1<H.Lc||Q)x=0;else if(Me.put=za,Me.ac=en,Me.bc=Ha,Me.ma=H,Me.width=x.width,Me.height=x.height,Me.Da=x.Da,Me.v=x.v,Me.va=x.va,Me.j=x.j,Me.o=x.o,H.$a)e:{t(H.$a==1),x=Le();t:for(;;){if(x==null){x=0;break e}if(t(H!=null),H.mc=x,x.c=H.c,x.i=H.i,x.l=H.l,x.l.ma=H,x.l.width=H.c,x.l.height=H.i,x.a=0,ee(x.m,q,Ae,be),!Se(H.c,H.i,1,x,null)||(x.ab==1&&x.gc[0].hc==3&&te(x.s)?(H.ic=1,q=x.c*x.i,x.Ta=null,x.Ua=0,x.V=i(q),x.Ba=0,x.V==null?(x.a=1,x=0):x=1):(H.ic=0,x=Ne(x,H.c)),!x))break t;x=1;break e}H.mc=null,x=0}else x=be>=H.c*H.i;H=!x}if(H)return null;p.ga.Lc!=1?p.Ga=0:C=V-k}t(p.ga!=null),t(k+C<=V);e:{if(x=(q=p.ga).c,V=q.l.o,q.$a==0){if(Ae=p.rc,be=p.Vc,Me=p.Fa,Q=p.P+1+k*x,ae=p.mb,ve=p.nb+k*x,t(Q<=p.P+p.qc),q.Z!=0)for(t(po[q.Z]!=null),H=0;H<C;++H)po[q.Z](Ae,be,Me,Q,ae,ve,x),Ae=ae,be=ve,ve+=x,Q+=x;else for(H=0;H<C;++H)n(ae,ve,Me,Q,x),Ae=ae,be=ve,ve+=x,Q+=x;p.rc=Ae,p.Vc=be}else{if(t(q.mc!=null),x=k+C,t((H=q.mc)!=null),t(x<=H.i),H.C>=x)x=1;else if(q.ic||_e(),q.ic){q=H.V,Ae=H.Ba,be=H.c;var Fe=H.i,ye=(Me=1,Q=H.$/be,ae=H.$%be,ve=H.m,Ee=H.s,H.$),we=be*Fe,je=be*x,Ue=Ee.wc,Re=ye<je?Tr(Ee,ae,Q):null;t(ye<=we),t(x<=Fe),t(te(Ee));t:for(;;){for(;!ve.h&&ye<je;){if(ae&Ue||(Re=Tr(Ee,ae,Q)),t(Re!=null),K(ve),256>(Fe=An(Re.G[0],Re.H[0],ve)))q[Ae+ye]=Fe,++ye,++ae>=be&&(ae=0,++Q<=x&&!(Q%16)&&ce(H,Q));else{if(!(280>Fe)){Me=0;break t}Fe=Ea(Fe-256,ve);var at,Qe=An(Re.G[4],Re.H[4],ve);if(K(ve),!(ye>=(Qe=la(be,Qe=Ea(Qe,ve)))&&we-ye>=Fe)){Me=0;break t}for(at=0;at<Fe;++at)q[Ae+ye+at]=q[Ae+ye+at-Qe];for(ye+=Fe,ae+=Fe;ae>=be;)ae-=be,++Q<=x&&!(Q%16)&&ce(H,Q);ye<je&&ae&Ue&&(Re=Tr(Ee,ae,Q))}t(ve.h==O(ve))}ce(H,Q>x?x:Q);break t}!Me||ve.h&&ye<we?(Me=0,H.a=ve.h?5:3):H.$=ye,x=Me}else x=fe(H,H.V,H.Ba,H.c,H.i,x,Pe);if(!x){C=0;break e}}k+C>=V&&(p.Cc=1),C=1}if(!C)return null;if(p.Cc&&((C=p.ga)!=null&&(C.mc=null),p.ga=null,0<p.Ga))return alert("todo:WebPDequantizeLevels"),null}return p.nb+k*B}function S(p,x,k,C,B,V){for(;0<B--;){var H,q=p,Q=x+(k?1:0),ae=p,ve=x+(k?0:3);for(H=0;H<C;++H){var Ee=ae[ve+4*H];Ee!=255&&(Ee*=32897,q[Q+4*H+0]=q[Q+4*H+0]*Ee>>23,q[Q+4*H+1]=q[Q+4*H+1]*Ee>>23,q[Q+4*H+2]=q[Q+4*H+2]*Ee>>23)}x+=V}}function U(p,x,k,C,B){for(;0<C--;){var V;for(V=0;V<k;++V){var H=p[x+2*V+0],q=15&(ae=p[x+2*V+1]),Q=4369*q,ae=(240&ae|ae>>4)*Q>>16;p[x+2*V+0]=(240&H|H>>4)*Q>>16&240|(15&H|H<<4)*Q>>16>>4&15,p[x+2*V+1]=240&ae|q}x+=B}}function he(p,x,k,C,B,V,H,q){var Q,ae,ve=255;for(ae=0;ae<B;++ae){for(Q=0;Q<C;++Q){var Ee=p[x+Q];V[H+4*Q]=Ee,ve&=Ee}x+=k,H+=q}return ve!=255}function ge(p,x,k,C,B){var V;for(V=0;V<B;++V)k[C+V]=p[x+V]>>8}function _e(){Ka=S,ur=U,fr=he,Rr=ge}function Oe(p,x,k){P[p]=function(C,B,V,H,q,Q,ae,ve,Ee,Ae,be,Me,Fe,ye,we,je,Ue){var Re,at=Ue-1>>1,Qe=q[Q+0]|ae[ve+0]<<16,mt=Ee[Ae+0]|be[Me+0]<<16;t(C!=null);var et=3*Qe+mt+131074>>2;for(x(C[B+0],255&et,et>>16,Fe,ye),V!=null&&(et=3*mt+Qe+131074>>2,x(V[H+0],255&et,et>>16,we,je)),Re=1;Re<=at;++Re){var Gt=q[Q+Re]|ae[ve+Re]<<16,Qt=Ee[Ae+Re]|be[Me+Re]<<16,zt=Qe+Gt+mt+Qt+524296,Rt=zt+2*(Gt+mt)>>3;et=Rt+Qe>>1,Qe=(zt=zt+2*(Qe+Qt)>>3)+Gt>>1,x(C[B+2*Re-1],255&et,et>>16,Fe,ye+(2*Re-1)*k),x(C[B+2*Re-0],255&Qe,Qe>>16,Fe,ye+(2*Re-0)*k),V!=null&&(et=zt+mt>>1,Qe=Rt+Qt>>1,x(V[H+2*Re-1],255&et,et>>16,we,je+(2*Re-1)*k),x(V[H+2*Re+0],255&Qe,Qe>>16,we,je+(2*Re+0)*k)),Qe=Gt,mt=Qt}1&Ue||(et=3*Qe+mt+131074>>2,x(C[B+Ue-1],255&et,et>>16,Fe,ye+(Ue-1)*k),V!=null&&(et=3*mt+Qe+131074>>2,x(V[H+Ue-1],255&et,et>>16,we,je+(Ue-1)*k)))}}function $e(){Ya[gd]=IC,Ya[xd]=ew,Ya[X5]=DC,Ya[vd]=tw,Ya[yd]=rw,Ya[lg]=nw,Ya[Y5]=jC,Ya[cg]=ew,Ya[ug]=tw,Ya[wd]=rw,Ya[fg]=nw}function nt(p){return p&~RC?0>p?0:255:p>>aw}function ht(p,x){return nt((19077*p>>8)+(26149*x>>8)-14234)}function Pt(p,x,k){return nt((19077*p>>8)-(6419*x>>8)-(13320*k>>8)+8708)}function At(p,x){return nt((19077*p>>8)+(33050*x>>8)-17685)}function Bt(p,x,k,C,B){C[B+0]=ht(p,k),C[B+1]=Pt(p,x,k),C[B+2]=At(p,x)}function _r(p,x,k,C,B){C[B+0]=At(p,x),C[B+1]=Pt(p,x,k),C[B+2]=ht(p,k)}function Cr(p,x,k,C,B){var V=Pt(p,x,k);x=V<<3&224|At(p,x)>>3,C[B+0]=248&ht(p,k)|V>>5,C[B+1]=x}function Wr(p,x,k,C,B){var V=240&At(p,x)|15;C[B+0]=240&ht(p,k)|Pt(p,x,k)>>4,C[B+1]=V}function Cn(p,x,k,C,B){C[B+0]=255,Bt(p,x,k,C,B+1)}function cn(p,x,k,C,B){_r(p,x,k,C,B),C[B+3]=255}function vi(p,x,k,C,B){Bt(p,x,k,C,B),C[B+3]=255}function Ta(p,x){return 0>p?0:p>x?x:p}function Qi(p,x,k){P[p]=function(C,B,V,H,q,Q,ae,ve,Ee){for(var Ae=ve+(-2&Ee)*k;ve!=Ae;)x(C[B+0],V[H+0],q[Q+0],ae,ve),x(C[B+1],V[H+0],q[Q+0],ae,ve+k),B+=2,++H,++Q,ve+=2*k;1&Ee&&x(C[B+0],V[H+0],q[Q+0],ae,ve)}}function cd(p,x,k){return k==0?p==0?x==0?6:5:x==0?4:0:k}function _0(p,x,k,C,B){switch(p>>>30){case 3:Es(x,k,C,B,0);break;case 2:jr(x,k,C,B);break;case 1:Xn(x,k,C,B)}}function S0(p,x){var k,C,B=x.M,V=x.Nb,H=p.oc,q=p.pc+40,Q=p.oc,ae=p.pc+584,ve=p.oc,Ee=p.pc+600;for(k=0;16>k;++k)H[q+32*k-1]=129;for(k=0;8>k;++k)Q[ae+32*k-1]=129,ve[Ee+32*k-1]=129;for(0<B?H[q-1-32]=Q[ae-1-32]=ve[Ee-1-32]=129:(a(H,q-32-1,127,21),a(Q,ae-32-1,127,9),a(ve,Ee-32-1,127,9)),C=0;C<p.za;++C){var Ae=x.ya[x.aa+C];if(0<C){for(k=-1;16>k;++k)n(H,q+32*k-4,H,q+32*k+12,4);for(k=-1;8>k;++k)n(Q,ae+32*k-4,Q,ae+32*k+4,4),n(ve,Ee+32*k-4,ve,Ee+32*k+4,4)}var be=p.Gd,Me=p.Hd+C,Fe=Ae.ad,ye=Ae.Hc;if(0<B&&(n(H,q-32,be[Me].y,0,16),n(Q,ae-32,be[Me].f,0,8),n(ve,Ee-32,be[Me].ea,0,8)),Ae.Za){var we=H,je=q-32+16;for(0<B&&(C>=p.za-1?a(we,je,be[Me].y[15],4):n(we,je,be[Me+1].y,0,4)),k=0;4>k;k++)we[je+128+k]=we[je+256+k]=we[je+384+k]=we[je+0+k];for(k=0;16>k;++k,ye<<=2)we=H,je=q+sw[k],yi[Ae.Ob[k]](we,je),_0(ye,Fe,16*+k,we,je)}else if(we=cd(C,B,Ae.Ob[0]),ho[we](H,q),ye!=0)for(k=0;16>k;++k,ye<<=2)_0(ye,Fe,16*+k,H,q+sw[k]);for(k=Ae.Gc,we=cd(C,B,Ae.Dd),Ts[we](Q,ae),Ts[we](ve,Ee),ye=Fe,we=Q,je=ae,255&(Ae=k>>0)&&(170&Ae?C0(ye,256,we,je):qa(ye,256,we,je)),Ae=ve,ye=Ee,255&(k>>=8)&&(170&k?C0(Fe,320,Ae,ye):qa(Fe,320,Ae,ye)),B<p.Ub-1&&(n(be[Me].y,0,H,q+480,16),n(be[Me].f,0,Q,ae+224,8),n(be[Me].ea,0,ve,Ee+224,8)),k=8*V*p.B,be=p.sa,Me=p.ta+16*C+16*V*p.R,Fe=p.qa,Ae=p.ra+8*C+k,ye=p.Ha,we=p.Ia+8*C+k,k=0;16>k;++k)n(be,Me+k*p.R,H,q+32*k,16);for(k=0;8>k;++k)n(Fe,Ae+k*p.B,Q,ae+32*k,8),n(ye,we+k*p.B,ve,Ee+32*k,8)}}function Nc(p,x,k,C,B,V,H,q,Q){var ae=[0],ve=[0],Ee=0,Ae=Q!=null?Q.kd:0,be=Q??new v0;if(p==null||12>k)return 7;be.data=p,be.w=x,be.ha=k,x=[x],k=[k],be.gb=[be.gb];e:{var Me=x,Fe=k,ye=be.gb;if(t(p!=null),t(Fe!=null),t(ye!=null),ye[0]=0,12<=Fe[0]&&!r(p,Me[0],"RIFF")){if(r(p,Me[0]+8,"WEBP")){ye=3;break e}var we=Ie(p,Me[0]+4);if(12>we||4294967286<we){ye=3;break e}if(Ae&&we>Fe[0]-8){ye=7;break e}ye[0]=we,Me[0]+=12,Fe[0]-=12}ye=0}if(ye!=0)return ye;for(we=0<be.gb[0],k=k[0];;){e:{var je=p;Fe=x,ye=k;var Ue=ae,Re=ve,at=Me=[0];if((et=Ee=[Ee])[0]=0,8>ye[0])ye=7;else{if(!r(je,Fe[0],"VP8X")){if(Ie(je,Fe[0]+4)!=10){ye=3;break e}if(18>ye[0]){ye=7;break e}var Qe=Ie(je,Fe[0]+8),mt=1+Z(je,Fe[0]+12);if(2147483648<=mt*(je=1+Z(je,Fe[0]+15))){ye=3;break e}at!=null&&(at[0]=Qe),Ue!=null&&(Ue[0]=mt),Re!=null&&(Re[0]=je),Fe[0]+=18,ye[0]-=18,et[0]=1}ye=0}}if(Ee=Ee[0],Me=Me[0],ye!=0)return ye;if(Fe=!!(2&Me),!we&&Ee)return 3;if(V!=null&&(V[0]=!!(16&Me)),H!=null&&(H[0]=Fe),q!=null&&(q[0]=0),H=ae[0],Me=ve[0],Ee&&Fe&&Q==null){ye=0;break}if(4>k){ye=7;break}if(we&&Ee||!we&&!Ee&&!r(p,x[0],"ALPH")){k=[k],be.na=[be.na],be.P=[be.P],be.Sa=[be.Sa];e:{Qe=p,ye=x,we=k;var et=be.gb;Ue=be.na,Re=be.P,at=be.Sa,mt=22,t(Qe!=null),t(we!=null),je=ye[0];var Gt=we[0];for(t(Ue!=null),t(at!=null),Ue[0]=null,Re[0]=null,at[0]=0;;){if(ye[0]=je,we[0]=Gt,8>Gt){ye=7;break e}var Qt=Ie(Qe,je+4);if(4294967286<Qt){ye=3;break e}var zt=8+Qt+1&-2;if(mt+=zt,0<et&&mt>et){ye=3;break e}if(!r(Qe,je,"VP8 ")||!r(Qe,je,"VP8L")){ye=0;break e}if(Gt[0]<zt){ye=7;break e}r(Qe,je,"ALPH")||(Ue[0]=Qe,Re[0]=je+8,at[0]=Qt),je+=zt,Gt-=zt}}if(k=k[0],be.na=be.na[0],be.P=be.P[0],be.Sa=be.Sa[0],ye!=0)break}k=[k],be.Ja=[be.Ja],be.xa=[be.xa];e:if(et=p,ye=x,we=k,Ue=be.gb[0],Re=be.Ja,at=be.xa,Qe=ye[0],je=!r(et,Qe,"VP8 "),mt=!r(et,Qe,"VP8L"),t(et!=null),t(we!=null),t(Re!=null),t(at!=null),8>we[0])ye=7;else{if(je||mt){if(et=Ie(et,Qe+4),12<=Ue&&et>Ue-12){ye=3;break e}if(Ae&&et>we[0]-8){ye=7;break e}Re[0]=et,ye[0]+=8,we[0]-=8,at[0]=mt}else at[0]=5<=we[0]&&et[Qe+0]==47&&!(et[Qe+4]>>5),Re[0]=we[0];ye=0}if(k=k[0],be.Ja=be.Ja[0],be.xa=be.xa[0],x=x[0],ye!=0)break;if(4294967286<be.Ja)return 3;if(q==null||Fe||(q[0]=be.xa?2:1),H=[H],Me=[Me],be.xa){if(5>k){ye=7;break}q=H,Ae=Me,Fe=V,p==null||5>k?p=0:5<=k&&p[x+0]==47&&!(p[x+4]>>5)?(we=[0],et=[0],Ue=[0],ee(Re=new E,p,x,k),pt(Re,we,et,Ue)?(q!=null&&(q[0]=we[0]),Ae!=null&&(Ae[0]=et[0]),Fe!=null&&(Fe[0]=Ue[0]),p=1):p=0):p=0}else{if(10>k){ye=7;break}q=Me,p==null||10>k||!Gh(p,x+3,k-3)?p=0:(Ae=p[x+0]|p[x+1]<<8|p[x+2]<<16,Fe=16383&(p[x+7]<<8|p[x+6]),p=16383&(p[x+9]<<8|p[x+8]),1&Ae||3<(Ae>>1&7)||!(Ae>>4&1)||Ae>>5>=be.Ja||!Fe||!p?p=0:(H&&(H[0]=Fe),q&&(q[0]=p),p=1))}if(!p||(H=H[0],Me=Me[0],Ee&&(ae[0]!=H||ve[0]!=Me)))return 3;Q!=null&&(Q[0]=be,Q.offset=x-Q.w,t(4294967286>x-Q.w),t(Q.offset==Q.ha-k));break}return ye==0||ye==7&&Ee&&Q==null?(V!=null&&(V[0]|=be.na!=null&&0<be.na.length),C!=null&&(C[0]=H),B!=null&&(B[0]=Me),0):ye}function k0(p,x,k){var C=x.width,B=x.height,V=0,H=0,q=C,Q=B;if(x.Da=p!=null&&0<p.Da,x.Da&&(q=p.cd,Q=p.bd,V=p.v,H=p.j,11>k||(V&=-2,H&=-2),0>V||0>H||0>=q||0>=Q||V+q>C||H+Q>B))return 0;if(x.v=V,x.j=H,x.va=V+q,x.o=H+Q,x.U=q,x.T=Q,x.da=p!=null&&0<p.da,x.da){if(!De(q,Q,k=[p.ib],V=[p.hb]))return 0;x.ib=k[0],x.hb=V[0]}return x.ob=p!=null&&p.ob,x.Kb=p==null||!p.Sd,x.da&&(x.ob=x.ib<3*C/4&&x.hb<3*B/4,x.Kb=0),1}function E0(p){if(p==null)return 2;if(11>p.S){var x=p.f.RGBA;x.fb+=(p.height-1)*x.A,x.A=-x.A}else x=p.f.kb,p=p.height,x.O+=(p-1)*x.fa,x.fa=-x.fa,x.N+=(p-1>>1)*x.Ab,x.Ab=-x.Ab,x.W+=(p-1>>1)*x.Db,x.Db=-x.Db,x.F!=null&&(x.J+=(p-1)*x.lb,x.lb=-x.lb);return 0}function Pc(p,x,k,C){if(C==null||0>=p||0>=x)return 2;if(k!=null){if(k.Da){var B=k.cd,V=k.bd,H=-2&k.v,q=-2&k.j;if(0>H||0>q||0>=B||0>=V||H+B>p||q+V>x)return 2;p=B,x=V}if(k.da){if(!De(p,x,B=[k.ib],V=[k.hb]))return 2;p=B[0],x=V[0]}}C.width=p,C.height=x;e:{var Q=C.width,ae=C.height;if(p=C.S,0>=Q||0>=ae||!(p>=gd&&13>p))p=2;else{if(0>=C.Rd&&C.sd==null){H=V=B=x=0;var ve=(q=Q*ow[p])*ae;if(11>p||(V=(ae+1)/2*(x=(Q+1)/2),p==12&&(H=(B=Q)*ae)),(ae=i(ve+2*V+H))==null){p=1;break e}C.sd=ae,11>p?((Q=C.f.RGBA).eb=ae,Q.fb=0,Q.A=q,Q.size=ve):((Q=C.f.kb).y=ae,Q.O=0,Q.fa=q,Q.Fd=ve,Q.f=ae,Q.N=0+ve,Q.Ab=x,Q.Cd=V,Q.ea=ae,Q.W=0+ve+V,Q.Db=x,Q.Ed=V,p==12&&(Q.F=ae,Q.J=0+ve+2*V),Q.Tc=H,Q.lb=B)}if(x=1,B=C.S,V=C.width,H=C.height,B>=gd&&13>B)if(11>B)p=C.f.RGBA,x&=(q=Math.abs(p.A))*(H-1)+V<=p.size,x&=q>=V*ow[B],x&=p.eb!=null;else{p=C.f.kb,q=(V+1)/2,ve=(H+1)/2,Q=Math.abs(p.fa),ae=Math.abs(p.Ab);var Ee=Math.abs(p.Db),Ae=Math.abs(p.lb),be=Ae*(H-1)+V;x&=Q*(H-1)+V<=p.Fd,x&=ae*(ve-1)+q<=p.Cd,x=(x&=Ee*(ve-1)+q<=p.Ed)&Q>=V&ae>=q&Ee>=q,x&=p.y!=null,x&=p.f!=null,x&=p.ea!=null,B==12&&(x&=Ae>=V,x&=be<=p.Tc,x&=p.F!=null)}else x=0;p=x?0:2}}return p!=0||k!=null&&k.fd&&(p=E0(C)),p}var vn=64,Lc=[0,1,3,7,15,31,63,127,255,511,1023,2047,4095,8191,16383,32767,65535,131071,262143,524287,1048575,2097151,4194303,8388607,16777215],Fc=24,Oc=32,A0=8,ua=[0,0,1,1,2,2,2,2,3,3,3,3,3,3,3,3,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7];Ge("Predictor0","PredictorAdd0"),P.Predictor0=function(){return 4278190080},P.Predictor1=function(p){return p},P.Predictor2=function(p,x,k){return x[k+0]},P.Predictor3=function(p,x,k){return x[k+1]},P.Predictor4=function(p,x,k){return x[k-1]},P.Predictor5=function(p,x,k){return Je(Je(p,x[k+1]),x[k+0])},P.Predictor6=function(p,x,k){return Je(p,x[k-1])},P.Predictor7=function(p,x,k){return Je(p,x[k+0])},P.Predictor8=function(p,x,k){return Je(x[k-1],x[k+0])},P.Predictor9=function(p,x,k){return Je(x[k+0],x[k+1])},P.Predictor10=function(p,x,k){return Je(Je(p,x[k-1]),Je(x[k+0],x[k+1]))},P.Predictor11=function(p,x,k){var C=x[k+0];return 0>=gt(C>>24&255,p>>24&255,(x=x[k-1])>>24&255)+gt(C>>16&255,p>>16&255,x>>16&255)+gt(C>>8&255,p>>8&255,x>>8&255)+gt(255&C,255&p,255&x)?C:p},P.Predictor12=function(p,x,k){var C=x[k+0];return(ot((p>>24&255)+(C>>24&255)-((x=x[k-1])>>24&255))<<24|ot((p>>16&255)+(C>>16&255)-(x>>16&255))<<16|ot((p>>8&255)+(C>>8&255)-(x>>8&255))<<8|ot((255&p)+(255&C)-(255&x)))>>>0},P.Predictor13=function(p,x,k){var C=x[k-1];return(ct((p=Je(p,x[k+0]))>>24&255,C>>24&255)<<24|ct(p>>16&255,C>>16&255)<<16|ct(p>>8&255,C>>8&255)<<8|ct(p>>0&255,C>>0&255))>>>0};var sg=P.PredictorAdd0;P.PredictorAdd1=bt,Ge("Predictor2","PredictorAdd2"),Ge("Predictor3","PredictorAdd3"),Ge("Predictor4","PredictorAdd4"),Ge("Predictor5","PredictorAdd5"),Ge("Predictor6","PredictorAdd6"),Ge("Predictor7","PredictorAdd7"),Ge("Predictor8","PredictorAdd8"),Ge("Predictor9","PredictorAdd9"),Ge("Predictor10","PredictorAdd10"),Ge("Predictor11","PredictorAdd11"),Ge("Predictor12","PredictorAdd12"),Ge("Predictor13","PredictorAdd13");var T0=P.PredictorAdd2;Ze("ColorIndexInverseTransform","MapARGB","32b",function(p){return p>>8&255},function(p){return p}),Ze("VP8LColorIndexInverseTransformAlpha","MapAlpha","8b",function(p){return p},function(p){return p>>8&255});var ud,Wa=P.ColorIndexInverseTransform,Ic=P.MapARGB,fd=P.VP8LColorIndexInverseTransformAlpha,hd=P.MapAlpha,lo=P.VP8LPredictorsAdd=[];lo.length=16,(P.VP8LPredictors=[]).length=16,(P.VP8LPredictorsAdd_C=[]).length=16,(P.VP8LPredictors_C=[]).length=16;var yl,fa,Kn,co,Ss,ks,Dc,Es,jr,C0,Xn,qa,jc,dd,N0,wl,bl,uo,_l,Rc,Sl,fo,P0,Ga,Ka,ur,fr,Rr,tn=i(511),As=i(2041),L0=i(225),Mc=i(767),pd=0,og=As,md=L0,Ca=Mc,Xa=tn,gd=0,xd=1,X5=2,vd=3,yd=4,lg=5,Y5=6,cg=7,ug=8,wd=9,fg=10,wC=[2,3,7],bC=[3,3,11],J5=[280,256,256,256,40],_C=[0,1,1,1,0],SC=[17,18,0,1,2,3,4,5,16,6,7,8,9,10,11,12,13,14,15],kC=[24,7,23,25,40,6,39,41,22,26,38,42,56,5,55,57,21,27,54,58,37,43,72,4,71,73,20,28,53,59,70,74,36,44,88,69,75,52,60,3,87,89,19,29,86,90,35,45,68,76,85,91,51,61,104,2,103,105,18,30,102,106,34,46,84,92,67,77,101,107,50,62,120,1,119,121,83,93,17,31,100,108,66,78,118,122,33,47,117,123,49,63,99,109,82,94,0,116,124,65,79,16,32,98,110,48,115,125,81,95,64,114,126,97,111,80,113,127,96,112],EC=[2954,2956,2958,2962,2970,2986,3018,3082,3212,3468,3980,5004],AC=8,hg=[4,5,6,7,8,9,10,10,11,12,13,14,15,16,17,17,18,19,20,20,21,21,22,22,23,23,24,25,25,26,27,28,29,30,31,32,33,34,35,36,37,37,38,39,40,41,42,43,44,45,46,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,76,77,78,79,80,81,82,83,84,85,86,87,88,89,91,93,95,96,98,100,101,102,104,106,108,110,112,114,116,118,122,124,126,128,130,132,134,136,138,140,143,145,148,151,154,157],dg=[4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,60,62,64,66,68,70,72,74,76,78,80,82,84,86,88,90,92,94,96,98,100,102,104,106,108,110,112,114,116,119,122,125,128,131,134,137,140,143,146,149,152,155,158,161,164,167,170,173,177,181,185,189,193,197,201,205,209,213,217,221,225,229,234,239,245,249,254,259,264,269,274,279,284],F0=null,TC=[[173,148,140,0],[176,155,140,135,0],[180,157,141,134,130,0],[254,254,243,230,196,177,153,140,133,130,129,0]],CC=[0,1,4,8,5,2,3,6,9,12,13,10,7,11,14,15],Q5=[-0,1,-1,2,-2,3,4,6,-3,5,-4,-5,-6,7,-7,8,-8,-9],NC=[[[[128,128,128,128,128,128,128,128,128,128,128],[128,128,128,128,128,128,128,128,128,128,128],[128,128,128,128,128,128,128,128,128,128,128]],[[253,136,254,255,228,219,128,128,128,128,128],[189,129,242,255,227,213,255,219,128,128,128],[106,126,227,252,214,209,255,255,128,128,128]],[[1,98,248,255,236,226,255,255,128,128,128],[181,133,238,254,221,234,255,154,128,128,128],[78,134,202,247,198,180,255,219,128,128,128]],[[1,185,249,255,243,255,128,128,128,128,128],[184,150,247,255,236,224,128,128,128,128,128],[77,110,216,255,236,230,128,128,128,128,128]],[[1,101,251,255,241,255,128,128,128,128,128],[170,139,241,252,236,209,255,255,128,128,128],[37,116,196,243,228,255,255,255,128,128,128]],[[1,204,254,255,245,255,128,128,128,128,128],[207,160,250,255,238,128,128,128,128,128,128],[102,103,231,255,211,171,128,128,128,128,128]],[[1,152,252,255,240,255,128,128,128,128,128],[177,135,243,255,234,225,128,128,128,128,128],[80,129,211,255,194,224,128,128,128,128,128]],[[1,1,255,128,128,128,128,128,128,128,128],[246,1,255,128,128,128,128,128,128,128,128],[255,128,128,128,128,128,128,128,128,128,128]]],[[[198,35,237,223,193,187,162,160,145,155,62],[131,45,198,221,172,176,220,157,252,221,1],[68,47,146,208,149,167,221,162,255,223,128]],[[1,149,241,255,221,224,255,255,128,128,128],[184,141,234,253,222,220,255,199,128,128,128],[81,99,181,242,176,190,249,202,255,255,128]],[[1,129,232,253,214,197,242,196,255,255,128],[99,121,210,250,201,198,255,202,128,128,128],[23,91,163,242,170,187,247,210,255,255,128]],[[1,200,246,255,234,255,128,128,128,128,128],[109,178,241,255,231,245,255,255,128,128,128],[44,130,201,253,205,192,255,255,128,128,128]],[[1,132,239,251,219,209,255,165,128,128,128],[94,136,225,251,218,190,255,255,128,128,128],[22,100,174,245,186,161,255,199,128,128,128]],[[1,182,249,255,232,235,128,128,128,128,128],[124,143,241,255,227,234,128,128,128,128,128],[35,77,181,251,193,211,255,205,128,128,128]],[[1,157,247,255,236,231,255,255,128,128,128],[121,141,235,255,225,227,255,255,128,128,128],[45,99,188,251,195,217,255,224,128,128,128]],[[1,1,251,255,213,255,128,128,128,128,128],[203,1,248,255,255,128,128,128,128,128,128],[137,1,177,255,224,255,128,128,128,128,128]]],[[[253,9,248,251,207,208,255,192,128,128,128],[175,13,224,243,193,185,249,198,255,255,128],[73,17,171,221,161,179,236,167,255,234,128]],[[1,95,247,253,212,183,255,255,128,128,128],[239,90,244,250,211,209,255,255,128,128,128],[155,77,195,248,188,195,255,255,128,128,128]],[[1,24,239,251,218,219,255,205,128,128,128],[201,51,219,255,196,186,128,128,128,128,128],[69,46,190,239,201,218,255,228,128,128,128]],[[1,191,251,255,255,128,128,128,128,128,128],[223,165,249,255,213,255,128,128,128,128,128],[141,124,248,255,255,128,128,128,128,128,128]],[[1,16,248,255,255,128,128,128,128,128,128],[190,36,230,255,236,255,128,128,128,128,128],[149,1,255,128,128,128,128,128,128,128,128]],[[1,226,255,128,128,128,128,128,128,128,128],[247,192,255,128,128,128,128,128,128,128,128],[240,128,255,128,128,128,128,128,128,128,128]],[[1,134,252,255,255,128,128,128,128,128,128],[213,62,250,255,255,128,128,128,128,128,128],[55,93,255,128,128,128,128,128,128,128,128]],[[128,128,128,128,128,128,128,128,128,128,128],[128,128,128,128,128,128,128,128,128,128,128],[128,128,128,128,128,128,128,128,128,128,128]]],[[[202,24,213,235,186,191,220,160,240,175,255],[126,38,182,232,169,184,228,174,255,187,128],[61,46,138,219,151,178,240,170,255,216,128]],[[1,112,230,250,199,191,247,159,255,255,128],[166,109,228,252,211,215,255,174,128,128,128],[39,77,162,232,172,180,245,178,255,255,128]],[[1,52,220,246,198,199,249,220,255,255,128],[124,74,191,243,183,193,250,221,255,255,128],[24,71,130,219,154,170,243,182,255,255,128]],[[1,182,225,249,219,240,255,224,128,128,128],[149,150,226,252,216,205,255,171,128,128,128],[28,108,170,242,183,194,254,223,255,255,128]],[[1,81,230,252,204,203,255,192,128,128,128],[123,102,209,247,188,196,255,233,128,128,128],[20,95,153,243,164,173,255,203,128,128,128]],[[1,222,248,255,216,213,128,128,128,128,128],[168,175,246,252,235,205,255,255,128,128,128],[47,116,215,255,211,212,255,255,128,128,128]],[[1,121,236,253,212,214,255,255,128,128,128],[141,84,213,252,201,202,255,219,128,128,128],[42,80,160,240,162,185,255,205,128,128,128]],[[1,1,255,128,128,128,128,128,128,128,128],[244,1,255,128,128,128,128,128,128,128,128],[238,1,255,128,128,128,128,128,128,128,128]]]],PC=[[[231,120,48,89,115,113,120,152,112],[152,179,64,126,170,118,46,70,95],[175,69,143,80,85,82,72,155,103],[56,58,10,171,218,189,17,13,152],[114,26,17,163,44,195,21,10,173],[121,24,80,195,26,62,44,64,85],[144,71,10,38,171,213,144,34,26],[170,46,55,19,136,160,33,206,71],[63,20,8,114,114,208,12,9,226],[81,40,11,96,182,84,29,16,36]],[[134,183,89,137,98,101,106,165,148],[72,187,100,130,157,111,32,75,80],[66,102,167,99,74,62,40,234,128],[41,53,9,178,241,141,26,8,107],[74,43,26,146,73,166,49,23,157],[65,38,105,160,51,52,31,115,128],[104,79,12,27,217,255,87,17,7],[87,68,71,44,114,51,15,186,23],[47,41,14,110,182,183,21,17,194],[66,45,25,102,197,189,23,18,22]],[[88,88,147,150,42,46,45,196,205],[43,97,183,117,85,38,35,179,61],[39,53,200,87,26,21,43,232,171],[56,34,51,104,114,102,29,93,77],[39,28,85,171,58,165,90,98,64],[34,22,116,206,23,34,43,166,73],[107,54,32,26,51,1,81,43,31],[68,25,106,22,64,171,36,225,114],[34,19,21,102,132,188,16,76,124],[62,18,78,95,85,57,50,48,51]],[[193,101,35,159,215,111,89,46,111],[60,148,31,172,219,228,21,18,111],[112,113,77,85,179,255,38,120,114],[40,42,1,196,245,209,10,25,109],[88,43,29,140,166,213,37,43,154],[61,63,30,155,67,45,68,1,209],[100,80,8,43,154,1,51,26,71],[142,78,78,16,255,128,34,197,171],[41,40,5,102,211,183,4,1,221],[51,50,17,168,209,192,23,25,82]],[[138,31,36,171,27,166,38,44,229],[67,87,58,169,82,115,26,59,179],[63,59,90,180,59,166,93,73,154],[40,40,21,116,143,209,34,39,175],[47,15,16,183,34,223,49,45,183],[46,17,33,183,6,98,15,32,183],[57,46,22,24,128,1,54,17,37],[65,32,73,115,28,128,23,128,205],[40,3,9,115,51,192,18,6,223],[87,37,9,115,59,77,64,21,47]],[[104,55,44,218,9,54,53,130,226],[64,90,70,205,40,41,23,26,57],[54,57,112,184,5,41,38,166,213],[30,34,26,133,152,116,10,32,134],[39,19,53,221,26,114,32,73,255],[31,9,65,234,2,15,1,118,73],[75,32,12,51,192,255,160,43,51],[88,31,35,67,102,85,55,186,85],[56,21,23,111,59,205,45,37,192],[55,38,70,124,73,102,1,34,98]],[[125,98,42,88,104,85,117,175,82],[95,84,53,89,128,100,113,101,45],[75,79,123,47,51,128,81,171,1],[57,17,5,71,102,57,53,41,49],[38,33,13,121,57,73,26,1,85],[41,10,67,138,77,110,90,47,114],[115,21,2,10,102,255,166,23,6],[101,29,16,10,85,128,101,196,26],[57,18,10,102,102,213,34,20,43],[117,20,15,36,163,128,68,1,26]],[[102,61,71,37,34,53,31,243,192],[69,60,71,38,73,119,28,222,37],[68,45,128,34,1,47,11,245,171],[62,17,19,70,146,85,55,62,70],[37,43,37,154,100,163,85,160,1],[63,9,92,136,28,64,32,201,85],[75,15,9,9,64,255,184,119,16],[86,6,28,5,64,255,25,248,1],[56,8,17,132,137,255,55,116,128],[58,15,20,82,135,57,26,121,40]],[[164,50,31,137,154,133,25,35,218],[51,103,44,131,131,123,31,6,158],[86,40,64,135,148,224,45,183,128],[22,26,17,131,240,154,14,1,209],[45,16,21,91,64,222,7,1,197],[56,21,39,155,60,138,23,102,213],[83,12,13,54,192,255,68,47,28],[85,26,85,85,128,128,32,146,171],[18,11,7,63,144,171,4,4,246],[35,27,10,146,174,171,12,26,128]],[[190,80,35,99,180,80,126,54,45],[85,126,47,87,176,51,41,20,32],[101,75,128,139,118,146,116,128,85],[56,41,15,176,236,85,37,9,62],[71,30,17,119,118,255,17,18,138],[101,38,60,138,55,70,43,26,142],[146,36,19,30,171,255,97,27,20],[138,45,61,62,219,1,81,188,64],[32,41,20,117,151,142,20,21,163],[112,19,12,61,195,128,48,4,24]]],LC=[[[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[176,246,255,255,255,255,255,255,255,255,255],[223,241,252,255,255,255,255,255,255,255,255],[249,253,253,255,255,255,255,255,255,255,255]],[[255,244,252,255,255,255,255,255,255,255,255],[234,254,254,255,255,255,255,255,255,255,255],[253,255,255,255,255,255,255,255,255,255,255]],[[255,246,254,255,255,255,255,255,255,255,255],[239,253,254,255,255,255,255,255,255,255,255],[254,255,254,255,255,255,255,255,255,255,255]],[[255,248,254,255,255,255,255,255,255,255,255],[251,255,254,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,253,254,255,255,255,255,255,255,255,255],[251,254,254,255,255,255,255,255,255,255,255],[254,255,254,255,255,255,255,255,255,255,255]],[[255,254,253,255,254,255,255,255,255,255,255],[250,255,254,255,254,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]]],[[[217,255,255,255,255,255,255,255,255,255,255],[225,252,241,253,255,255,254,255,255,255,255],[234,250,241,250,253,255,253,254,255,255,255]],[[255,254,255,255,255,255,255,255,255,255,255],[223,254,254,255,255,255,255,255,255,255,255],[238,253,254,254,255,255,255,255,255,255,255]],[[255,248,254,255,255,255,255,255,255,255,255],[249,254,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,253,255,255,255,255,255,255,255,255,255],[247,254,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,253,254,255,255,255,255,255,255,255,255],[252,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,254,254,255,255,255,255,255,255,255,255],[253,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,254,253,255,255,255,255,255,255,255,255],[250,255,255,255,255,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]]],[[[186,251,250,255,255,255,255,255,255,255,255],[234,251,244,254,255,255,255,255,255,255,255],[251,251,243,253,254,255,254,255,255,255,255]],[[255,253,254,255,255,255,255,255,255,255,255],[236,253,254,255,255,255,255,255,255,255,255],[251,253,253,254,254,255,255,255,255,255,255]],[[255,254,254,255,255,255,255,255,255,255,255],[254,254,254,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,254,255,255,255,255,255,255,255,255,255],[254,254,255,255,255,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]]],[[[248,255,255,255,255,255,255,255,255,255,255],[250,254,252,254,255,255,255,255,255,255,255],[248,254,249,253,255,255,255,255,255,255,255]],[[255,253,253,255,255,255,255,255,255,255,255],[246,253,253,255,255,255,255,255,255,255,255],[252,254,251,254,254,255,255,255,255,255,255]],[[255,254,252,255,255,255,255,255,255,255,255],[248,254,253,255,255,255,255,255,255,255,255],[253,255,254,254,255,255,255,255,255,255,255]],[[255,251,254,255,255,255,255,255,255,255,255],[245,251,254,255,255,255,255,255,255,255,255],[253,253,254,255,255,255,255,255,255,255,255]],[[255,251,253,255,255,255,255,255,255,255,255],[252,253,254,255,255,255,255,255,255,255,255],[255,254,255,255,255,255,255,255,255,255,255]],[[255,252,255,255,255,255,255,255,255,255,255],[249,255,254,255,255,255,255,255,255,255,255],[255,255,254,255,255,255,255,255,255,255,255]],[[255,255,253,255,255,255,255,255,255,255,255],[250,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]]]],FC=[0,1,2,3,6,4,5,6,6,6,6,6,6,6,6,7,0],ho=[],yi=[],Ts=[],OC=1,Z5=2,po=[],Ya=[];Oe("UpsampleRgbLinePair",Bt,3),Oe("UpsampleBgrLinePair",_r,3),Oe("UpsampleRgbaLinePair",vi,4),Oe("UpsampleBgraLinePair",cn,4),Oe("UpsampleArgbLinePair",Cn,4),Oe("UpsampleRgba4444LinePair",Wr,2),Oe("UpsampleRgb565LinePair",Cr,2);var IC=P.UpsampleRgbLinePair,DC=P.UpsampleBgrLinePair,ew=P.UpsampleRgbaLinePair,tw=P.UpsampleBgraLinePair,rw=P.UpsampleArgbLinePair,nw=P.UpsampleRgba4444LinePair,jC=P.UpsampleRgb565LinePair,bd=16,_d=1<<bd-1,O0=-227,pg=482,aw=6,RC=(256<<aw)-1,iw=0,MC=i(256),BC=i(256),UC=i(256),$C=i(256),VC=i(pg-O0),zC=i(pg-O0);Qi("YuvToRgbRow",Bt,3),Qi("YuvToBgrRow",_r,3),Qi("YuvToRgbaRow",vi,4),Qi("YuvToBgraRow",cn,4),Qi("YuvToArgbRow",Cn,4),Qi("YuvToRgba4444Row",Wr,2),Qi("YuvToRgb565Row",Cr,2);var sw=[0,4,8,12,128,132,136,140,256,260,264,268,384,388,392,396],Sd=[0,2,8],HC=[8,7,6,4,4,2,2,2,1,1,1,1],WC=1;this.WebPDecodeRGBA=function(p,x,k,C,B){var V=xd,H=new Tc,q=new ka;H.ba=q,q.S=V,q.width=[q.width],q.height=[q.height];var Q=q.width,ae=q.height,ve=new di;if(ve==null||p==null)var Ee=2;else t(ve!=null),Ee=Nc(p,x,k,ve.width,ve.height,ve.Pd,ve.Qd,ve.format,null);if(Ee!=0?Q=0:(Q!=null&&(Q[0]=ve.width[0]),ae!=null&&(ae[0]=ve.height[0]),Q=1),Q){q.width=q.width[0],q.height=q.height[0],C!=null&&(C[0]=q.width),B!=null&&(B[0]=q.height);e:{if(C=new Xi,(B=new v0).data=p,B.w=x,B.ha=k,B.kd=1,x=[0],t(B!=null),((p=Nc(B.data,B.w,B.ha,null,null,null,x,null,B))==0||p==7)&&x[0]&&(p=4),(x=p)==0){if(t(H!=null),C.data=B.data,C.w=B.w+B.offset,C.ha=B.ha-B.offset,C.put=za,C.ac=en,C.bc=Ha,C.ma=H,B.xa){if((p=Le())==null){H=1;break e}if(function(Ae,be){var Me=[0],Fe=[0],ye=[0];t:for(;;){if(Ae==null)return 0;if(be==null)return Ae.a=2,0;if(Ae.l=be,Ae.a=0,ee(Ae.m,be.data,be.w,be.ha),!pt(Ae.m,Me,Fe,ye)){Ae.a=3;break t}if(Ae.xb=Z5,be.width=Me[0],be.height=Fe[0],!Se(Me[0],Fe[0],1,Ae,null))break t;return 1}return t(Ae.a!=0),0}(p,C)){if(C=(x=Pc(C.width,C.height,H.Oa,H.ba))==0){t:{C=p;r:for(;;){if(C==null){C=0;break t}if(t(C.s.yc!=null),t(C.s.Ya!=null),t(0<C.s.Wb),t((k=C.l)!=null),t((B=k.ma)!=null),C.xb!=0){if(C.ca=B.ba,C.tb=B.tb,t(C.ca!=null),!k0(B.Oa,k,vd)){C.a=2;break r}if(!Ne(C,k.width)||k.da)break r;if((k.da||Vt(C.ca.S))&&_e(),11>C.ca.S||(alert("todo:WebPInitConvertARGBToYUV"),C.ca.f.kb.F!=null&&_e()),C.Pb&&0<C.s.ua&&C.s.vb.X==null&&!He(C.s.vb,C.s.Wa.Xa)){C.a=1;break r}C.xb=0}if(!fe(C,C.V,C.Ba,C.c,C.i,k.o,ue))break r;B.Dc=C.Ma,C=1;break t}t(C.a!=0),C=0}C=!C}C&&(x=p.a)}else x=p.a}else{if((p=new Aa)==null){H=1;break e}if(p.Fa=B.na,p.P=B.P,p.qc=B.Sa,Kh(p,C)){if((x=Pc(C.width,C.height,H.Oa,H.ba))==0){if(p.Aa=0,k=H.Oa,t((B=p)!=null),k!=null){if(0<(Q=0>(Q=k.Md)?0:100<Q?255:255*Q/100)){for(ae=ve=0;4>ae;++ae)12>(Ee=B.pb[ae]).lc&&(Ee.ia=Q*HC[0>Ee.lc?0:Ee.lc]>>3),ve|=Ee.ia;ve&&(alert("todo:VP8InitRandom"),B.ia=1)}B.Ga=k.Id,100<B.Ga?B.Ga=100:0>B.Ga&&(B.Ga=0)}Vm(p,C)||(x=p.a)}}else x=p.a}x==0&&H.Oa!=null&&H.Oa.fd&&(x=E0(H.ba))}H=x}V=H!=0?null:11>V?q.f.RGBA.eb:q.f.kb.y}else V=null;return V};var ow=[3,4,3,4,4,2,2,4,4,4,2,1,1]};function c(P,j){for(var J="",N=0;N<4;N++)J+=String.fromCharCode(P[j++]);return J}function u(P,j){return(P[j+0]<<0|P[j+1]<<8|P[j+2]<<16)>>>0}function f(P,j){return(P[j+0]<<0|P[j+1]<<8|P[j+2]<<16|P[j+3]<<24)>>>0}new l;var d=[0],h=[0],g=[],m=new l,_=e,y=function(P,j){var J={},N=0,L=!1,G=0,W=0;if(J.frames=[],!function(D,O,M,K){for(var Y=0;Y<K;Y++)if(D[O+Y]!=M.charCodeAt(Y))return!0;return!1}(P,j,"RIFF",4)){for(f(P,j+=4),j+=8;j<P.length;){var le=c(P,j),de=f(P,j+=4);j+=4;var X=de+(1&de);switch(le){case"VP8 ":case"VP8L":J.frames[N]===void 0&&(J.frames[N]={}),(pe=J.frames[N]).src_off=L?W:j-8,pe.src_size=G+de+8,N++,L&&(L=!1,G=0,W=0);break;case"VP8X":(pe=J.header={}).feature_flags=P[j];var ee=j+4;pe.canvas_width=1+u(P,ee),ee+=3,pe.canvas_height=1+u(P,ee),ee+=3;break;case"ALPH":L=!0,G=X+8,W=j-8;break;case"ANIM":(pe=J.header).bgcolor=f(P,j),ee=j+4,pe.loop_count=(me=P)[(E=ee)+0]<<0|me[E+1]<<8,ee+=2;break;case"ANMF":var R,pe;(pe=J.frames[N]={}).offset_x=2*u(P,j),j+=3,pe.offset_y=2*u(P,j),j+=3,pe.width=1+u(P,j),j+=3,pe.height=1+u(P,j),j+=3,pe.duration=u(P,j),j+=3,R=P[j++],pe.dispose=1&R,pe.blend=R>>1&1}le!="ANMF"&&(j+=X)}var me,E;return J}}(_,0);y.response=_,y.rgbaoutput=!0,y.dataurl=!1;var b=y.header?y.header:null,w=y.frames?y.frames:null;if(b){b.loop_counter=b.loop_count,d=[b.canvas_height],h=[b.canvas_width];for(var T=0;T<w.length&&w[T].blend!=0;T++);}var F=w[0],I=m.WebPDecodeRGBA(_,F.src_off,F.src_size,h,d);F.rgba=I,F.imgwidth=h[0],F.imgheight=d[0];for(var A=0;A<h[0]*d[0]*4;A++)g[A]=I[A];return this.width=h,this.height=d,this.data=g,this}(function(e){var t=function(){return typeof Cv=="function"},r=function(d,h,g,m){var _=4,y=s;switch(m){case e.image_compression.FAST:_=1,y=i;break;case e.image_compression.MEDIUM:_=6,y=o;break;case e.image_compression.SLOW:_=9,y=l}d=n(d,h,g,y);var b=Cv(d,{level:_});return e.__addimage__.arrayBufferToBinaryString(b)},n=function(d,h,g,m){for(var _,y,b,w=d.length/h,T=new Uint8Array(d.length+w),F=u(),I=0;I<w;I+=1){if(b=I*h,_=d.subarray(b,b+h),m)T.set(m(_,g,y),b+I);else{for(var A,P=F.length,j=[];A<P;A+=1)j[A]=F[A](_,g,y);var J=f(j.concat());T.set(j[J],b+I)}y=_}return T},a=function(d){var h=Array.apply([],d);return h.unshift(0),h},i=function(d,h){var g,m=[],_=d.length;m[0]=1;for(var y=0;y<_;y+=1)g=d[y-h]||0,m[y+1]=d[y]-g+256&255;return m},s=function(d,h,g){var m,_=[],y=d.length;_[0]=2;for(var b=0;b<y;b+=1)m=g&&g[b]||0,_[b+1]=d[b]-m+256&255;return _},o=function(d,h,g){var m,_,y=[],b=d.length;y[0]=3;for(var w=0;w<b;w+=1)m=d[w-h]||0,_=g&&g[w]||0,y[w+1]=d[w]+256-(m+_>>>1)&255;return y},l=function(d,h,g){var m,_,y,b,w=[],T=d.length;w[0]=4;for(var F=0;F<T;F+=1)m=d[F-h]||0,_=g&&g[F]||0,y=g&&g[F-h]||0,b=c(m,_,y),w[F+1]=d[F]-b+256&255;return w},c=function(d,h,g){if(d===h&&h===g)return d;var m=Math.abs(h-g),_=Math.abs(d-g),y=Math.abs(d+h-g-g);return m<=_&&m<=y?d:_<=y?h:g},u=function(){return[a,i,s,o,l]},f=function(d){var h=d.map(function(g){return g.reduce(function(m,_){return m+Math.abs(_)},0)});return h.indexOf(Math.min.apply(null,h))};e.processPNG=function(d,h,g,m){var _,y,b,w,T,F,I,A,P,j,J,N,L,G,W,le=this.decode.FLATE_DECODE,de="";if(this.__addimage__.isArrayBuffer(d)&&(d=new Uint8Array(d)),this.__addimage__.isArrayBufferView(d)){if(d=(b=new xY(d)).imgData,y=b.bits,_=b.colorSpace,T=b.colors,[4,6].indexOf(b.colorType)!==-1){if(b.bits===8){P=(A=b.pixelBitlength==32?new Uint32Array(b.decodePixels().buffer):b.pixelBitlength==16?new Uint16Array(b.decodePixels().buffer):new Uint8Array(b.decodePixels().buffer)).length,J=new Uint8Array(P*b.colors),j=new Uint8Array(P);var X,ee=b.pixelBitlength-b.bits;for(G=0,W=0;G<P;G++){for(L=A[G],X=0;X<ee;)J[W++]=L>>>X&255,X+=b.bits;j[G]=L>>>X&255}}if(b.bits===16){P=(A=new Uint32Array(b.decodePixels().buffer)).length,J=new Uint8Array(P*(32/b.pixelBitlength)*b.colors),j=new Uint8Array(P*(32/b.pixelBitlength)),N=b.colors>1,G=0,W=0;for(var R=0;G<P;)L=A[G++],J[W++]=L>>>0&255,N&&(J[W++]=L>>>16&255,L=A[G++],J[W++]=L>>>0&255),j[R++]=L>>>16&255;y=8}m!==e.image_compression.NONE&&t()?(d=r(J,b.width*b.colors,b.colors,m),I=r(j,b.width,1,m)):(d=J,I=j,le=void 0)}if(b.colorType===3&&(_=this.color_spaces.INDEXED,F=b.palette,b.transparency.indexed)){var pe=b.transparency.indexed,me=0;for(G=0,P=pe.length;G<P;++G)me+=pe[G];if((me/=255)===P-1&&pe.indexOf(0)!==-1)w=[pe.indexOf(0)];else if(me!==P){for(A=b.decodePixels(),j=new Uint8Array(A.length),G=0,P=A.length;G<P;G++)j[G]=pe[A[G]];I=r(j,b.width,1)}}var E=function(D){var O;switch(D){case e.image_compression.FAST:O=11;break;case e.image_compression.MEDIUM:O=13;break;case e.image_compression.SLOW:O=14;break;default:O=12}return O}(m);return le===this.decode.FLATE_DECODE&&(de="/Predictor "+E+" "),de+="/Colors "+T+" /BitsPerComponent "+y+" /Columns "+b.width,(this.__addimage__.isArrayBuffer(d)||this.__addimage__.isArrayBufferView(d))&&(d=this.__addimage__.arrayBufferToBinaryString(d)),(I&&this.__addimage__.isArrayBuffer(I)||this.__addimage__.isArrayBufferView(I))&&(I=this.__addimage__.arrayBufferToBinaryString(I)),{alias:g,data:d,index:h,filter:le,decodeParameters:de,transparency:w,palette:F,sMask:I,predictor:E,width:b.width,height:b.height,bitsPerComponent:y,colorSpace:_}}}})(vt.API),function(e){e.processGIF89A=function(t,r,n,a){var i=new vY(t),s=i.width,o=i.height,l=[];i.decodeAndBlitFrameRGBA(0,l);var c={data:l,width:s,height:o},u=new R2(100).encode(c,100);return e.processJPEG.call(this,u,r,n,a)},e.processGIF87A=e.processGIF89A}(vt.API),Ei.prototype.parseHeader=function(){if(this.fileSize=this.datav.getUint32(this.pos,!0),this.pos+=4,this.reserved=this.datav.getUint32(this.pos,!0),this.pos+=4,this.offset=this.datav.getUint32(this.pos,!0),this.pos+=4,this.headerSize=this.datav.getUint32(this.pos,!0),this.pos+=4,this.width=this.datav.getUint32(this.pos,!0),this.pos+=4,this.height=this.datav.getInt32(this.pos,!0),this.pos+=4,this.planes=this.datav.getUint16(this.pos,!0),this.pos+=2,this.bitPP=this.datav.getUint16(this.pos,!0),this.pos+=2,this.compress=this.datav.getUint32(this.pos,!0),this.pos+=4,this.rawSize=this.datav.getUint32(this.pos,!0),this.pos+=4,this.hr=this.datav.getUint32(this.pos,!0),this.pos+=4,this.vr=this.datav.getUint32(this.pos,!0),this.pos+=4,this.colors=this.datav.getUint32(this.pos,!0),this.pos+=4,this.importantColors=this.datav.getUint32(this.pos,!0),this.pos+=4,this.bitPP===16&&this.is_with_alpha&&(this.bitPP=15),this.bitPP<15){var e=this.colors===0?1<<this.bitPP:this.colors;this.palette=new Array(e);for(var t=0;t<e;t++){var r=this.datav.getUint8(this.pos++,!0),n=this.datav.getUint8(this.pos++,!0),a=this.datav.getUint8(this.pos++,!0),i=this.datav.getUint8(this.pos++,!0);this.palette[t]={red:a,green:n,blue:r,quad:i}}}this.height<0&&(this.height*=-1,this.bottom_up=!1)},Ei.prototype.parseBGR=function(){this.pos=this.offset;try{var e="bit"+this.bitPP,t=this.width*this.height*4;this.data=new Uint8Array(t),this[e]()}catch(r){lr.log("bit decode error:"+r)}},Ei.prototype.bit1=function(){var e,t=Math.ceil(this.width/8),r=t%4;for(e=this.height-1;e>=0;e--){for(var n=this.bottom_up?e:this.height-1-e,a=0;a<t;a++)for(var i=this.datav.getUint8(this.pos++,!0),s=n*this.width*4+8*a*4,o=0;o<8&&8*a+o<this.width;o++){var l=this.palette[i>>7-o&1];this.data[s+4*o]=l.blue,this.data[s+4*o+1]=l.green,this.data[s+4*o+2]=l.red,this.data[s+4*o+3]=255}r!==0&&(this.pos+=4-r)}},Ei.prototype.bit4=function(){for(var e=Math.ceil(this.width/2),t=e%4,r=this.height-1;r>=0;r--){for(var n=this.bottom_up?r:this.height-1-r,a=0;a<e;a++){var i=this.datav.getUint8(this.pos++,!0),s=n*this.width*4+2*a*4,o=i>>4,l=15&i,c=this.palette[o];if(this.data[s]=c.blue,this.data[s+1]=c.green,this.data[s+2]=c.red,this.data[s+3]=255,2*a+1>=this.width)break;c=this.palette[l],this.data[s+4]=c.blue,this.data[s+4+1]=c.green,this.data[s+4+2]=c.red,this.data[s+4+3]=255}t!==0&&(this.pos+=4-t)}},Ei.prototype.bit8=function(){for(var e=this.width%4,t=this.height-1;t>=0;t--){for(var r=this.bottom_up?t:this.height-1-t,n=0;n<this.width;n++){var a=this.datav.getUint8(this.pos++,!0),i=r*this.width*4+4*n;if(a<this.palette.length){var s=this.palette[a];this.data[i]=s.red,this.data[i+1]=s.green,this.data[i+2]=s.blue,this.data[i+3]=255}else this.data[i]=255,this.data[i+1]=255,this.data[i+2]=255,this.data[i+3]=255}e!==0&&(this.pos+=4-e)}},Ei.prototype.bit15=function(){for(var e=this.width%3,t=parseInt("11111",2),r=this.height-1;r>=0;r--){for(var n=this.bottom_up?r:this.height-1-r,a=0;a<this.width;a++){var i=this.datav.getUint16(this.pos,!0);this.pos+=2;var s=(i&t)/t*255|0,o=(i>>5&t)/t*255|0,l=(i>>10&t)/t*255|0,c=i>>15?255:0,u=n*this.width*4+4*a;this.data[u]=l,this.data[u+1]=o,this.data[u+2]=s,this.data[u+3]=c}this.pos+=e}},Ei.prototype.bit16=function(){for(var e=this.width%3,t=parseInt("11111",2),r=parseInt("111111",2),n=this.height-1;n>=0;n--){for(var a=this.bottom_up?n:this.height-1-n,i=0;i<this.width;i++){var s=this.datav.getUint16(this.pos,!0);this.pos+=2;var o=(s&t)/t*255|0,l=(s>>5&r)/r*255|0,c=(s>>11)/t*255|0,u=a*this.width*4+4*i;this.data[u]=c,this.data[u+1]=l,this.data[u+2]=o,this.data[u+3]=255}this.pos+=e}},Ei.prototype.bit24=function(){for(var e=this.height-1;e>=0;e--){for(var t=this.bottom_up?e:this.height-1-e,r=0;r<this.width;r++){var n=this.datav.getUint8(this.pos++,!0),a=this.datav.getUint8(this.pos++,!0),i=this.datav.getUint8(this.pos++,!0),s=t*this.width*4+4*r;this.data[s]=i,this.data[s+1]=a,this.data[s+2]=n,this.data[s+3]=255}this.pos+=this.width%4}},Ei.prototype.bit32=function(){for(var e=this.height-1;e>=0;e--)for(var t=this.bottom_up?e:this.height-1-e,r=0;r<this.width;r++){var n=this.datav.getUint8(this.pos++,!0),a=this.datav.getUint8(this.pos++,!0),i=this.datav.getUint8(this.pos++,!0),s=this.datav.getUint8(this.pos++,!0),o=t*this.width*4+4*r;this.data[o]=i,this.data[o+1]=a,this.data[o+2]=n,this.data[o+3]=s}},Ei.prototype.getData=function(){return this.data},function(e){e.processBMP=function(t,r,n,a){var i=new Ei(t,!1),s=i.width,o=i.height,l={data:i.getData(),width:s,height:o},c=new R2(100).encode(l,100);return e.processJPEG.call(this,c,r,n,a)}}(vt.API),H_.prototype.getData=function(){return this.data},function(e){e.processWEBP=function(t,r,n,a){var i=new H_(t),s=i.width,o=i.height,l={data:i.getData(),width:s,height:o},c=new R2(100).encode(l,100);return e.processJPEG.call(this,c,r,n,a)}}(vt.API),vt.API.processRGBA=function(e,t,r){for(var n=e.data,a=n.length,i=new Uint8Array(a/4*3),s=new Uint8Array(a/4),o=0,l=0,c=0;c<a;c+=4){var u=n[c],f=n[c+1],d=n[c+2],h=n[c+3];i[o++]=u,i[o++]=f,i[o++]=d,s[l++]=h}var g=this.__addimage__.arrayBufferToBinaryString(i);return{alpha:this.__addimage__.arrayBufferToBinaryString(s),data:g,index:t,alias:r,colorSpace:"DeviceRGB",bitsPerComponent:8,width:e.width,height:e.height}},vt.API.setLanguage=function(e){return this.internal.languageSettings===void 0&&(this.internal.languageSettings={},this.internal.languageSettings.isSubscribed=!1),{af:"Afrikaans",sq:"Albanian",ar:"Arabic (Standard)","ar-DZ":"Arabic (Algeria)","ar-BH":"Arabic (Bahrain)","ar-EG":"Arabic (Egypt)","ar-IQ":"Arabic (Iraq)","ar-JO":"Arabic (Jordan)","ar-KW":"Arabic (Kuwait)","ar-LB":"Arabic (Lebanon)","ar-LY":"Arabic (Libya)","ar-MA":"Arabic (Morocco)","ar-OM":"Arabic (Oman)","ar-QA":"Arabic (Qatar)","ar-SA":"Arabic (Saudi Arabia)","ar-SY":"Arabic (Syria)","ar-TN":"Arabic (Tunisia)","ar-AE":"Arabic (U.A.E.)","ar-YE":"Arabic (Yemen)",an:"Aragonese",hy:"Armenian",as:"Assamese",ast:"Asturian",az:"Azerbaijani",eu:"Basque",be:"Belarusian",bn:"Bengali",bs:"Bosnian",br:"Breton",bg:"Bulgarian",my:"Burmese",ca:"Catalan",ch:"Chamorro",ce:"Chechen",zh:"Chinese","zh-HK":"Chinese (Hong Kong)","zh-CN":"Chinese (PRC)","zh-SG":"Chinese (Singapore)","zh-TW":"Chinese (Taiwan)",cv:"Chuvash",co:"Corsican",cr:"Cree",hr:"Croatian",cs:"Czech",da:"Danish",nl:"Dutch (Standard)","nl-BE":"Dutch (Belgian)",en:"English","en-AU":"English (Australia)","en-BZ":"English (Belize)","en-CA":"English (Canada)","en-IE":"English (Ireland)","en-JM":"English (Jamaica)","en-NZ":"English (New Zealand)","en-PH":"English (Philippines)","en-ZA":"English (South Africa)","en-TT":"English (Trinidad & Tobago)","en-GB":"English (United Kingdom)","en-US":"English (United States)","en-ZW":"English (Zimbabwe)",eo:"Esperanto",et:"Estonian",fo:"Faeroese",fj:"Fijian",fi:"Finnish",fr:"French (Standard)","fr-BE":"French (Belgium)","fr-CA":"French (Canada)","fr-FR":"French (France)","fr-LU":"French (Luxembourg)","fr-MC":"French (Monaco)","fr-CH":"French (Switzerland)",fy:"Frisian",fur:"Friulian",gd:"Gaelic (Scots)","gd-IE":"Gaelic (Irish)",gl:"Galacian",ka:"Georgian",de:"German (Standard)","de-AT":"German (Austria)","de-DE":"German (Germany)","de-LI":"German (Liechtenstein)","de-LU":"German (Luxembourg)","de-CH":"German (Switzerland)",el:"Greek",gu:"Gujurati",ht:"Haitian",he:"Hebrew",hi:"Hindi",hu:"Hungarian",is:"Icelandic",id:"Indonesian",iu:"Inuktitut",ga:"Irish",it:"Italian (Standard)","it-CH":"Italian (Switzerland)",ja:"Japanese",kn:"Kannada",ks:"Kashmiri",kk:"Kazakh",km:"Khmer",ky:"Kirghiz",tlh:"Klingon",ko:"Korean","ko-KP":"Korean (North Korea)","ko-KR":"Korean (South Korea)",la:"Latin",lv:"Latvian",lt:"Lithuanian",lb:"Luxembourgish",mk:"North Macedonia",ms:"Malay",ml:"Malayalam",mt:"Maltese",mi:"Maori",mr:"Marathi",mo:"Moldavian",nv:"Navajo",ng:"Ndonga",ne:"Nepali",no:"Norwegian",nb:"Norwegian (Bokmal)",nn:"Norwegian (Nynorsk)",oc:"Occitan",or:"Oriya",om:"Oromo",fa:"Persian","fa-IR":"Persian/Iran",pl:"Polish",pt:"Portuguese","pt-BR":"Portuguese (Brazil)",pa:"Punjabi","pa-IN":"Punjabi (India)","pa-PK":"Punjabi (Pakistan)",qu:"Quechua",rm:"Rhaeto-Romanic",ro:"Romanian","ro-MO":"Romanian (Moldavia)",ru:"Russian","ru-MO":"Russian (Moldavia)",sz:"Sami (Lappish)",sg:"Sango",sa:"Sanskrit",sc:"Sardinian",sd:"Sindhi",si:"Singhalese",sr:"Serbian",sk:"Slovak",sl:"Slovenian",so:"Somani",sb:"Sorbian",es:"Spanish","es-AR":"Spanish (Argentina)","es-BO":"Spanish (Bolivia)","es-CL":"Spanish (Chile)","es-CO":"Spanish (Colombia)","es-CR":"Spanish (Costa Rica)","es-DO":"Spanish (Dominican Republic)","es-EC":"Spanish (Ecuador)","es-SV":"Spanish (El Salvador)","es-GT":"Spanish (Guatemala)","es-HN":"Spanish (Honduras)","es-MX":"Spanish (Mexico)","es-NI":"Spanish (Nicaragua)","es-PA":"Spanish (Panama)","es-PY":"Spanish (Paraguay)","es-PE":"Spanish (Peru)","es-PR":"Spanish (Puerto Rico)","es-ES":"Spanish (Spain)","es-UY":"Spanish (Uruguay)","es-VE":"Spanish (Venezuela)",sx:"Sutu",sw:"Swahili",sv:"Swedish","sv-FI":"Swedish (Finland)","sv-SV":"Swedish (Sweden)",ta:"Tamil",tt:"Tatar",te:"Teluga",th:"Thai",tig:"Tigre",ts:"Tsonga",tn:"Tswana",tr:"Turkish",tk:"Turkmen",uk:"Ukrainian",hsb:"Upper Sorbian",ur:"Urdu",ve:"Venda",vi:"Vietnamese",vo:"Volapuk",wa:"Walloon",cy:"Welsh",xh:"Xhosa",ji:"Yiddish",zu:"Zulu"}[e]!==void 0&&(this.internal.languageSettings.languageCode=e,this.internal.languageSettings.isSubscribed===!1&&(this.internal.events.subscribe("putCatalog",function(){this.internal.write("/Lang ("+this.internal.languageSettings.languageCode+")")}),this.internal.languageSettings.isSubscribed=!0)),this},Jc=vt.API,Sp=Jc.getCharWidthsArray=function(e,t){var r,n,a=(t=t||{}).font||this.internal.getFont(),i=t.fontSize||this.internal.getFontSize(),s=t.charSpace||this.internal.getCharSpace(),o=t.widths?t.widths:a.metadata.Unicode.widths,l=o.fof?o.fof:1,c=t.kerning?t.kerning:a.metadata.Unicode.kerning,u=c.fof?c.fof:1,f=t.doKerning!==!1,d=0,h=e.length,g=0,m=o[0]||l,_=[];for(r=0;r<h;r++)n=e.charCodeAt(r),typeof a.metadata.widthOfString=="function"?_.push((a.metadata.widthOfGlyph(a.metadata.characterToGlyph(n))+s*(1e3/i)||0)/1e3):(d=f&&tr(c[n])==="object"&&!isNaN(parseInt(c[n][g],10))?c[n][g]/u:0,_.push((o[n]||m)/l+d)),g=n;return _},U_=Jc.getStringUnitWidth=function(e,t){var r=(t=t||{}).fontSize||this.internal.getFontSize(),n=t.font||this.internal.getFont(),a=t.charSpace||this.internal.getCharSpace();return Jc.processArabic&&(e=Jc.processArabic(e)),typeof n.metadata.widthOfString=="function"?n.metadata.widthOfString(e,r,a)/r:Sp.apply(this,arguments).reduce(function(i,s){return i+s},0)},$_=function(e,t,r,n){for(var a=[],i=0,s=e.length,o=0;i!==s&&o+t[i]<r;)o+=t[i],i++;a.push(e.slice(0,i));var l=i;for(o=0;i!==s;)o+t[i]>n&&(a.push(e.slice(l,i)),o=0,l=i),o+=t[i],i++;return l!==i&&a.push(e.slice(l,i)),a},V_=function(e,t,r){r||(r={});var n,a,i,s,o,l,c,u=[],f=[u],d=r.textIndent||0,h=0,g=0,m=e.split(" "),_=Sp.apply(this,[" ",r])[0];if(l=r.lineIndent===-1?m[0].length+2:r.lineIndent||0){var y=Array(l).join(" "),b=[];m.map(function(T){(T=T.split(/\s*\n/)).length>1?b=b.concat(T.map(function(F,I){return(I&&F.length?`
`:"")+F})):b.push(T[0])}),m=b,l=U_.apply(this,[y,r])}for(i=0,s=m.length;i<s;i++){var w=0;if(n=m[i],l&&n[0]==`
`&&(n=n.substr(1),w=1),d+h+(g=(a=Sp.apply(this,[n,r])).reduce(function(T,F){return T+F},0))>t||w){if(g>t){for(o=$_.apply(this,[n,a,t-(d+h),t]),u.push(o.shift()),u=[o.pop()];o.length;)f.push([o.shift()]);g=a.slice(n.length-(u[0]?u[0].length:0)).reduce(function(T,F){return T+F},0)}else u=[n];f.push(u),d=g+l,h=_}else u.push(n),d+=h+g,h=_}return c=l?function(T,F){return(F?y:"")+T.join(" ")}:function(T){return T.join(" ")},f.map(c)},Jc.splitTextToSize=function(e,t,r){var n,a=(r=r||{}).fontSize||this.internal.getFontSize(),i=(function(u){if(u.widths&&u.kerning)return{widths:u.widths,kerning:u.kerning};var f=this.internal.getFont(u.fontName,u.fontStyle);return f.metadata.Unicode?{widths:f.metadata.Unicode.widths||{0:1},kerning:f.metadata.Unicode.kerning||{}}:{font:f.metadata,fontSize:this.internal.getFontSize(),charSpace:this.internal.getCharSpace()}}).call(this,r);n=Array.isArray(e)?e:String(e).split(/\r?\n/);var s=1*this.internal.scaleFactor*t/a;i.textIndent=r.textIndent?1*r.textIndent*this.internal.scaleFactor/a:0,i.lineIndent=r.lineIndent;var o,l,c=[];for(o=0,l=n.length;o<l;o++)c=c.concat(V_.apply(this,[n[o],s,i]));return c},function(e){e.__fontmetrics__=e.__fontmetrics__||{};for(var t="klmnopqrstuvwxyz",r={},n={},a=0;a<t.length;a++)r[t[a]]="0123456789abcdef"[a],n["0123456789abcdef"[a]]=t[a];var i=function(f){return"0x"+parseInt(f,10).toString(16)},s=e.__fontmetrics__.compress=function(f){var d,h,g,m,_=["{"];for(var y in f){if(d=f[y],isNaN(parseInt(y,10))?h="'"+y+"'":(y=parseInt(y,10),h=(h=i(y).slice(2)).slice(0,-1)+n[h.slice(-1)]),typeof d=="number")d<0?(g=i(d).slice(3),m="-"):(g=i(d).slice(2),m=""),g=m+g.slice(0,-1)+n[g.slice(-1)];else{if(tr(d)!=="object")throw new Error("Don't know what to do with value type "+tr(d)+".");g=s(d)}_.push(h+g)}return _.push("}"),_.join("")},o=e.__fontmetrics__.uncompress=function(f){if(typeof f!="string")throw new Error("Invalid argument passed to uncompress.");for(var d,h,g,m,_={},y=1,b=_,w=[],T="",F="",I=f.length-1,A=1;A<I;A+=1)(m=f[A])=="'"?d?(g=d.join(""),d=void 0):d=[]:d?d.push(m):m=="{"?(w.push([b,g]),b={},g=void 0):m=="}"?((h=w.pop())[0][h[1]]=b,g=void 0,b=h[0]):m=="-"?y=-1:g===void 0?r.hasOwnProperty(m)?(T+=r[m],g=parseInt(T,16)*y,y=1,T=""):T+=m:r.hasOwnProperty(m)?(F+=r[m],b[g]=parseInt(F,16)*y,y=1,g=void 0,F=""):F+=m;return _},l={codePages:["WinAnsiEncoding"],WinAnsiEncoding:o("{19m8n201n9q201o9r201s9l201t9m201u8m201w9n201x9o201y8o202k8q202l8r202m9p202q8p20aw8k203k8t203t8v203u9v2cq8s212m9t15m8w15n9w2dw9s16k8u16l9u17s9z17x8y17y9y}")},c={Unicode:{Courier:l,"Courier-Bold":l,"Courier-BoldOblique":l,"Courier-Oblique":l,Helvetica:l,"Helvetica-Bold":l,"Helvetica-BoldOblique":l,"Helvetica-Oblique":l,"Times-Roman":l,"Times-Bold":l,"Times-BoldItalic":l,"Times-Italic":l}},u={Unicode:{"Courier-Oblique":o("{'widths'{k3w'fof'6o}'kerning'{'fof'-6o}}"),"Times-BoldItalic":o("{'widths'{k3o2q4ycx2r201n3m201o6o201s2l201t2l201u2l201w3m201x3m201y3m2k1t2l2r202m2n2n3m2o3m2p5n202q6o2r1w2s2l2t2l2u3m2v3t2w1t2x2l2y1t2z1w3k3m3l3m3m3m3n3m3o3m3p3m3q3m3r3m3s3m203t2l203u2l3v2l3w3t3x3t3y3t3z3m4k5n4l4m4m4m4n4m4o4s4p4m4q4m4r4s4s4y4t2r4u3m4v4m4w3x4x5t4y4s4z4s5k3x5l4s5m4m5n3r5o3x5p4s5q4m5r5t5s4m5t3x5u3x5v2l5w1w5x2l5y3t5z3m6k2l6l3m6m3m6n2w6o3m6p2w6q2l6r3m6s3r6t1w6u1w6v3m6w1w6x4y6y3r6z3m7k3m7l3m7m2r7n2r7o1w7p3r7q2w7r4m7s3m7t2w7u2r7v2n7w1q7x2n7y3t202l3mcl4mal2ram3man3mao3map3mar3mas2lat4uau1uav3maw3way4uaz2lbk2sbl3t'fof'6obo2lbp3tbq3mbr1tbs2lbu1ybv3mbz3mck4m202k3mcm4mcn4mco4mcp4mcq5ycr4mcs4mct4mcu4mcv4mcw2r2m3rcy2rcz2rdl4sdm4sdn4sdo4sdp4sdq4sds4sdt4sdu4sdv4sdw4sdz3mek3mel3mem3men3meo3mep3meq4ser2wes2wet2weu2wev2wew1wex1wey1wez1wfl3rfm3mfn3mfo3mfp3mfq3mfr3tfs3mft3rfu3rfv3rfw3rfz2w203k6o212m6o2dw2l2cq2l3t3m3u2l17s3x19m3m}'kerning'{cl{4qu5kt5qt5rs17ss5ts}201s{201ss}201t{cks4lscmscnscoscpscls2wu2yu201ts}201x{2wu2yu}2k{201ts}2w{4qx5kx5ou5qx5rs17su5tu}2x{17su5tu5ou}2y{4qx5kx5ou5qx5rs17ss5ts}'fof'-6ofn{17sw5tw5ou5qw5rs}7t{cksclscmscnscoscps4ls}3u{17su5tu5os5qs}3v{17su5tu5os5qs}7p{17su5tu}ck{4qu5kt5qt5rs17ss5ts}4l{4qu5kt5qt5rs17ss5ts}cm{4qu5kt5qt5rs17ss5ts}cn{4qu5kt5qt5rs17ss5ts}co{4qu5kt5qt5rs17ss5ts}cp{4qu5kt5qt5rs17ss5ts}6l{4qu5ou5qw5rt17su5tu}5q{ckuclucmucnucoucpu4lu}5r{ckuclucmucnucoucpu4lu}7q{cksclscmscnscoscps4ls}6p{4qu5ou5qw5rt17sw5tw}ek{4qu5ou5qw5rt17su5tu}el{4qu5ou5qw5rt17su5tu}em{4qu5ou5qw5rt17su5tu}en{4qu5ou5qw5rt17su5tu}eo{4qu5ou5qw5rt17su5tu}ep{4qu5ou5qw5rt17su5tu}es{17ss5ts5qs4qu}et{4qu5ou5qw5rt17sw5tw}eu{4qu5ou5qw5rt17ss5ts}ev{17ss5ts5qs4qu}6z{17sw5tw5ou5qw5rs}fm{17sw5tw5ou5qw5rs}7n{201ts}fo{17sw5tw5ou5qw5rs}fp{17sw5tw5ou5qw5rs}fq{17sw5tw5ou5qw5rs}7r{cksclscmscnscoscps4ls}fs{17sw5tw5ou5qw5rs}ft{17su5tu}fu{17su5tu}fv{17su5tu}fw{17su5tu}fz{cksclscmscnscoscps4ls}}}"),"Helvetica-Bold":o("{'widths'{k3s2q4scx1w201n3r201o6o201s1w201t1w201u1w201w3m201x3m201y3m2k1w2l2l202m2n2n3r2o3r2p5t202q6o2r1s2s2l2t2l2u2r2v3u2w1w2x2l2y1w2z1w3k3r3l3r3m3r3n3r3o3r3p3r3q3r3r3r3s3r203t2l203u2l3v2l3w3u3x3u3y3u3z3x4k6l4l4s4m4s4n4s4o4s4p4m4q3x4r4y4s4s4t1w4u3r4v4s4w3x4x5n4y4s4z4y5k4m5l4y5m4s5n4m5o3x5p4s5q4m5r5y5s4m5t4m5u3x5v2l5w1w5x2l5y3u5z3r6k2l6l3r6m3x6n3r6o3x6p3r6q2l6r3x6s3x6t1w6u1w6v3r6w1w6x5t6y3x6z3x7k3x7l3x7m2r7n3r7o2l7p3x7q3r7r4y7s3r7t3r7u3m7v2r7w1w7x2r7y3u202l3rcl4sal2lam3ran3rao3rap3rar3ras2lat4tau2pav3raw3uay4taz2lbk2sbl3u'fof'6obo2lbp3xbq3rbr1wbs2lbu2obv3rbz3xck4s202k3rcm4scn4sco4scp4scq6ocr4scs4mct4mcu4mcv4mcw1w2m2zcy1wcz1wdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3xek3rel3rem3ren3reo3rep3req5ter3res3ret3reu3rev3rew1wex1wey1wez1wfl3xfm3xfn3xfo3xfp3xfq3xfr3ufs3xft3xfu3xfv3xfw3xfz3r203k6o212m6o2dw2l2cq2l3t3r3u2l17s4m19m3r}'kerning'{cl{4qs5ku5ot5qs17sv5tv}201t{2ww4wy2yw}201w{2ks}201x{2ww4wy2yw}2k{201ts201xs}2w{7qs4qu5kw5os5qw5rs17su5tu7tsfzs}2x{5ow5qs}2y{7qs4qu5kw5os5qw5rs17su5tu7tsfzs}'fof'-6o7p{17su5tu5ot}ck{4qs5ku5ot5qs17sv5tv}4l{4qs5ku5ot5qs17sv5tv}cm{4qs5ku5ot5qs17sv5tv}cn{4qs5ku5ot5qs17sv5tv}co{4qs5ku5ot5qs17sv5tv}cp{4qs5ku5ot5qs17sv5tv}6l{17st5tt5os}17s{2kwclvcmvcnvcovcpv4lv4wwckv}5o{2kucltcmtcntcotcpt4lt4wtckt}5q{2ksclscmscnscoscps4ls4wvcks}5r{2ks4ws}5t{2kwclvcmvcnvcovcpv4lv4wwckv}eo{17st5tt5os}fu{17su5tu5ot}6p{17ss5ts}ek{17st5tt5os}el{17st5tt5os}em{17st5tt5os}en{17st5tt5os}6o{201ts}ep{17st5tt5os}es{17ss5ts}et{17ss5ts}eu{17ss5ts}ev{17ss5ts}6z{17su5tu5os5qt}fm{17su5tu5os5qt}fn{17su5tu5os5qt}fo{17su5tu5os5qt}fp{17su5tu5os5qt}fq{17su5tu5os5qt}fs{17su5tu5os5qt}ft{17su5tu5ot}7m{5os}fv{17su5tu5ot}fw{17su5tu5ot}}}"),Courier:o("{'widths'{k3w'fof'6o}'kerning'{'fof'-6o}}"),"Courier-BoldOblique":o("{'widths'{k3w'fof'6o}'kerning'{'fof'-6o}}"),"Times-Bold":o("{'widths'{k3q2q5ncx2r201n3m201o6o201s2l201t2l201u2l201w3m201x3m201y3m2k1t2l2l202m2n2n3m2o3m2p6o202q6o2r1w2s2l2t2l2u3m2v3t2w1t2x2l2y1t2z1w3k3m3l3m3m3m3n3m3o3m3p3m3q3m3r3m3s3m203t2l203u2l3v2l3w3t3x3t3y3t3z3m4k5x4l4s4m4m4n4s4o4s4p4m4q3x4r4y4s4y4t2r4u3m4v4y4w4m4x5y4y4s4z4y5k3x5l4y5m4s5n3r5o4m5p4s5q4s5r6o5s4s5t4s5u4m5v2l5w1w5x2l5y3u5z3m6k2l6l3m6m3r6n2w6o3r6p2w6q2l6r3m6s3r6t1w6u2l6v3r6w1w6x5n6y3r6z3m7k3r7l3r7m2w7n2r7o2l7p3r7q3m7r4s7s3m7t3m7u2w7v2r7w1q7x2r7y3o202l3mcl4sal2lam3man3mao3map3mar3mas2lat4uau1yav3maw3tay4uaz2lbk2sbl3t'fof'6obo2lbp3rbr1tbs2lbu2lbv3mbz3mck4s202k3mcm4scn4sco4scp4scq6ocr4scs4mct4mcu4mcv4mcw2r2m3rcy2rcz2rdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3rek3mel3mem3men3meo3mep3meq4ser2wes2wet2weu2wev2wew1wex1wey1wez1wfl3rfm3mfn3mfo3mfp3mfq3mfr3tfs3mft3rfu3rfv3rfw3rfz3m203k6o212m6o2dw2l2cq2l3t3m3u2l17s4s19m3m}'kerning'{cl{4qt5ks5ot5qy5rw17sv5tv}201t{cks4lscmscnscoscpscls4wv}2k{201ts}2w{4qu5ku7mu5os5qx5ru17su5tu}2x{17su5tu5ou5qs}2y{4qv5kv7mu5ot5qz5ru17su5tu}'fof'-6o7t{cksclscmscnscoscps4ls}3u{17su5tu5os5qu}3v{17su5tu5os5qu}fu{17su5tu5ou5qu}7p{17su5tu5ou5qu}ck{4qt5ks5ot5qy5rw17sv5tv}4l{4qt5ks5ot5qy5rw17sv5tv}cm{4qt5ks5ot5qy5rw17sv5tv}cn{4qt5ks5ot5qy5rw17sv5tv}co{4qt5ks5ot5qy5rw17sv5tv}cp{4qt5ks5ot5qy5rw17sv5tv}6l{17st5tt5ou5qu}17s{ckuclucmucnucoucpu4lu4wu}5o{ckuclucmucnucoucpu4lu4wu}5q{ckzclzcmzcnzcozcpz4lz4wu}5r{ckxclxcmxcnxcoxcpx4lx4wu}5t{ckuclucmucnucoucpu4lu4wu}7q{ckuclucmucnucoucpu4lu}6p{17sw5tw5ou5qu}ek{17st5tt5qu}el{17st5tt5ou5qu}em{17st5tt5qu}en{17st5tt5qu}eo{17st5tt5qu}ep{17st5tt5ou5qu}es{17ss5ts5qu}et{17sw5tw5ou5qu}eu{17sw5tw5ou5qu}ev{17ss5ts5qu}6z{17sw5tw5ou5qu5rs}fm{17sw5tw5ou5qu5rs}fn{17sw5tw5ou5qu5rs}fo{17sw5tw5ou5qu5rs}fp{17sw5tw5ou5qu5rs}fq{17sw5tw5ou5qu5rs}7r{cktcltcmtcntcotcpt4lt5os}fs{17sw5tw5ou5qu5rs}ft{17su5tu5ou5qu}7m{5os}fv{17su5tu5ou5qu}fw{17su5tu5ou5qu}fz{cksclscmscnscoscps4ls}}}"),Symbol:o("{'widths'{k3uaw4r19m3m2k1t2l2l202m2y2n3m2p5n202q6o3k3m2s2l2t2l2v3r2w1t3m3m2y1t2z1wbk2sbl3r'fof'6o3n3m3o3m3p3m3q3m3r3m3s3m3t3m3u1w3v1w3w3r3x3r3y3r3z2wbp3t3l3m5v2l5x2l5z3m2q4yfr3r7v3k7w1o7x3k}'kerning'{'fof'-6o}}"),Helvetica:o("{'widths'{k3p2q4mcx1w201n3r201o6o201s1q201t1q201u1q201w2l201x2l201y2l2k1w2l1w202m2n2n3r2o3r2p5t202q6o2r1n2s2l2t2l2u2r2v3u2w1w2x2l2y1w2z1w3k3r3l3r3m3r3n3r3o3r3p3r3q3r3r3r3s3r203t2l203u2l3v1w3w3u3x3u3y3u3z3r4k6p4l4m4m4m4n4s4o4s4p4m4q3x4r4y4s4s4t1w4u3m4v4m4w3r4x5n4y4s4z4y5k4m5l4y5m4s5n4m5o3x5p4s5q4m5r5y5s4m5t4m5u3x5v1w5w1w5x1w5y2z5z3r6k2l6l3r6m3r6n3m6o3r6p3r6q1w6r3r6s3r6t1q6u1q6v3m6w1q6x5n6y3r6z3r7k3r7l3r7m2l7n3m7o1w7p3r7q3m7r4s7s3m7t3m7u3m7v2l7w1u7x2l7y3u202l3rcl4mal2lam3ran3rao3rap3rar3ras2lat4tau2pav3raw3uay4taz2lbk2sbl3u'fof'6obo2lbp3rbr1wbs2lbu2obv3rbz3xck4m202k3rcm4mcn4mco4mcp4mcq6ocr4scs4mct4mcu4mcv4mcw1w2m2ncy1wcz1wdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3xek3rel3rem3ren3reo3rep3req5ter3mes3ret3reu3rev3rew1wex1wey1wez1wfl3rfm3rfn3rfo3rfp3rfq3rfr3ufs3xft3rfu3rfv3rfw3rfz3m203k6o212m6o2dw2l2cq2l3t3r3u1w17s4m19m3r}'kerning'{5q{4wv}cl{4qs5kw5ow5qs17sv5tv}201t{2wu4w1k2yu}201x{2wu4wy2yu}17s{2ktclucmucnu4otcpu4lu4wycoucku}2w{7qs4qz5k1m17sy5ow5qx5rsfsu5ty7tufzu}2x{17sy5ty5oy5qs}2y{7qs4qz5k1m17sy5ow5qx5rsfsu5ty7tufzu}'fof'-6o7p{17sv5tv5ow}ck{4qs5kw5ow5qs17sv5tv}4l{4qs5kw5ow5qs17sv5tv}cm{4qs5kw5ow5qs17sv5tv}cn{4qs5kw5ow5qs17sv5tv}co{4qs5kw5ow5qs17sv5tv}cp{4qs5kw5ow5qs17sv5tv}6l{17sy5ty5ow}do{17st5tt}4z{17st5tt}7s{fst}dm{17st5tt}dn{17st5tt}5o{ckwclwcmwcnwcowcpw4lw4wv}dp{17st5tt}dq{17st5tt}7t{5ow}ds{17st5tt}5t{2ktclucmucnu4otcpu4lu4wycoucku}fu{17sv5tv5ow}6p{17sy5ty5ow5qs}ek{17sy5ty5ow}el{17sy5ty5ow}em{17sy5ty5ow}en{5ty}eo{17sy5ty5ow}ep{17sy5ty5ow}es{17sy5ty5qs}et{17sy5ty5ow5qs}eu{17sy5ty5ow5qs}ev{17sy5ty5ow5qs}6z{17sy5ty5ow5qs}fm{17sy5ty5ow5qs}fn{17sy5ty5ow5qs}fo{17sy5ty5ow5qs}fp{17sy5ty5qs}fq{17sy5ty5ow5qs}7r{5ow}fs{17sy5ty5ow5qs}ft{17sv5tv5ow}7m{5ow}fv{17sv5tv5ow}fw{17sv5tv5ow}}}"),"Helvetica-BoldOblique":o("{'widths'{k3s2q4scx1w201n3r201o6o201s1w201t1w201u1w201w3m201x3m201y3m2k1w2l2l202m2n2n3r2o3r2p5t202q6o2r1s2s2l2t2l2u2r2v3u2w1w2x2l2y1w2z1w3k3r3l3r3m3r3n3r3o3r3p3r3q3r3r3r3s3r203t2l203u2l3v2l3w3u3x3u3y3u3z3x4k6l4l4s4m4s4n4s4o4s4p4m4q3x4r4y4s4s4t1w4u3r4v4s4w3x4x5n4y4s4z4y5k4m5l4y5m4s5n4m5o3x5p4s5q4m5r5y5s4m5t4m5u3x5v2l5w1w5x2l5y3u5z3r6k2l6l3r6m3x6n3r6o3x6p3r6q2l6r3x6s3x6t1w6u1w6v3r6w1w6x5t6y3x6z3x7k3x7l3x7m2r7n3r7o2l7p3x7q3r7r4y7s3r7t3r7u3m7v2r7w1w7x2r7y3u202l3rcl4sal2lam3ran3rao3rap3rar3ras2lat4tau2pav3raw3uay4taz2lbk2sbl3u'fof'6obo2lbp3xbq3rbr1wbs2lbu2obv3rbz3xck4s202k3rcm4scn4sco4scp4scq6ocr4scs4mct4mcu4mcv4mcw1w2m2zcy1wcz1wdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3xek3rel3rem3ren3reo3rep3req5ter3res3ret3reu3rev3rew1wex1wey1wez1wfl3xfm3xfn3xfo3xfp3xfq3xfr3ufs3xft3xfu3xfv3xfw3xfz3r203k6o212m6o2dw2l2cq2l3t3r3u2l17s4m19m3r}'kerning'{cl{4qs5ku5ot5qs17sv5tv}201t{2ww4wy2yw}201w{2ks}201x{2ww4wy2yw}2k{201ts201xs}2w{7qs4qu5kw5os5qw5rs17su5tu7tsfzs}2x{5ow5qs}2y{7qs4qu5kw5os5qw5rs17su5tu7tsfzs}'fof'-6o7p{17su5tu5ot}ck{4qs5ku5ot5qs17sv5tv}4l{4qs5ku5ot5qs17sv5tv}cm{4qs5ku5ot5qs17sv5tv}cn{4qs5ku5ot5qs17sv5tv}co{4qs5ku5ot5qs17sv5tv}cp{4qs5ku5ot5qs17sv5tv}6l{17st5tt5os}17s{2kwclvcmvcnvcovcpv4lv4wwckv}5o{2kucltcmtcntcotcpt4lt4wtckt}5q{2ksclscmscnscoscps4ls4wvcks}5r{2ks4ws}5t{2kwclvcmvcnvcovcpv4lv4wwckv}eo{17st5tt5os}fu{17su5tu5ot}6p{17ss5ts}ek{17st5tt5os}el{17st5tt5os}em{17st5tt5os}en{17st5tt5os}6o{201ts}ep{17st5tt5os}es{17ss5ts}et{17ss5ts}eu{17ss5ts}ev{17ss5ts}6z{17su5tu5os5qt}fm{17su5tu5os5qt}fn{17su5tu5os5qt}fo{17su5tu5os5qt}fp{17su5tu5os5qt}fq{17su5tu5os5qt}fs{17su5tu5os5qt}ft{17su5tu5ot}7m{5os}fv{17su5tu5ot}fw{17su5tu5ot}}}"),ZapfDingbats:o("{'widths'{k4u2k1w'fof'6o}'kerning'{'fof'-6o}}"),"Courier-Bold":o("{'widths'{k3w'fof'6o}'kerning'{'fof'-6o}}"),"Times-Italic":o("{'widths'{k3n2q4ycx2l201n3m201o5t201s2l201t2l201u2l201w3r201x3r201y3r2k1t2l2l202m2n2n3m2o3m2p5n202q5t2r1p2s2l2t2l2u3m2v4n2w1t2x2l2y1t2z1w3k3m3l3m3m3m3n3m3o3m3p3m3q3m3r3m3s3m203t2l203u2l3v2l3w4n3x4n3y4n3z3m4k5w4l3x4m3x4n4m4o4s4p3x4q3x4r4s4s4s4t2l4u2w4v4m4w3r4x5n4y4m4z4s5k3x5l4s5m3x5n3m5o3r5p4s5q3x5r5n5s3x5t3r5u3r5v2r5w1w5x2r5y2u5z3m6k2l6l3m6m3m6n2w6o3m6p2w6q1w6r3m6s3m6t1w6u1w6v2w6w1w6x4s6y3m6z3m7k3m7l3m7m2r7n2r7o1w7p3m7q2w7r4m7s2w7t2w7u2r7v2s7w1v7x2s7y3q202l3mcl3xal2ram3man3mao3map3mar3mas2lat4wau1vav3maw4nay4waz2lbk2sbl4n'fof'6obo2lbp3mbq3obr1tbs2lbu1zbv3mbz3mck3x202k3mcm3xcn3xco3xcp3xcq5tcr4mcs3xct3xcu3xcv3xcw2l2m2ucy2lcz2ldl4mdm4sdn4sdo4sdp4sdq4sds4sdt4sdu4sdv4sdw4sdz3mek3mel3mem3men3meo3mep3meq4mer2wes2wet2weu2wev2wew1wex1wey1wez1wfl3mfm3mfn3mfo3mfp3mfq3mfr4nfs3mft3mfu3mfv3mfw3mfz2w203k6o212m6m2dw2l2cq2l3t3m3u2l17s3r19m3m}'kerning'{cl{5kt4qw}201s{201sw}201t{201tw2wy2yy6q-t}201x{2wy2yy}2k{201tw}2w{7qs4qy7rs5ky7mw5os5qx5ru17su5tu}2x{17ss5ts5os}2y{7qs4qy7rs5ky7mw5os5qx5ru17su5tu}'fof'-6o6t{17ss5ts5qs}7t{5os}3v{5qs}7p{17su5tu5qs}ck{5kt4qw}4l{5kt4qw}cm{5kt4qw}cn{5kt4qw}co{5kt4qw}cp{5kt4qw}6l{4qs5ks5ou5qw5ru17su5tu}17s{2ks}5q{ckvclvcmvcnvcovcpv4lv}5r{ckuclucmucnucoucpu4lu}5t{2ks}6p{4qs5ks5ou5qw5ru17su5tu}ek{4qs5ks5ou5qw5ru17su5tu}el{4qs5ks5ou5qw5ru17su5tu}em{4qs5ks5ou5qw5ru17su5tu}en{4qs5ks5ou5qw5ru17su5tu}eo{4qs5ks5ou5qw5ru17su5tu}ep{4qs5ks5ou5qw5ru17su5tu}es{5ks5qs4qs}et{4qs5ks5ou5qw5ru17su5tu}eu{4qs5ks5qw5ru17su5tu}ev{5ks5qs4qs}ex{17ss5ts5qs}6z{4qv5ks5ou5qw5ru17su5tu}fm{4qv5ks5ou5qw5ru17su5tu}fn{4qv5ks5ou5qw5ru17su5tu}fo{4qv5ks5ou5qw5ru17su5tu}fp{4qv5ks5ou5qw5ru17su5tu}fq{4qv5ks5ou5qw5ru17su5tu}7r{5os}fs{4qv5ks5ou5qw5ru17su5tu}ft{17su5tu5qs}fu{17su5tu5qs}fv{17su5tu5qs}fw{17su5tu5qs}}}"),"Times-Roman":o("{'widths'{k3n2q4ycx2l201n3m201o6o201s2l201t2l201u2l201w2w201x2w201y2w2k1t2l2l202m2n2n3m2o3m2p5n202q6o2r1m2s2l2t2l2u3m2v3s2w1t2x2l2y1t2z1w3k3m3l3m3m3m3n3m3o3m3p3m3q3m3r3m3s3m203t2l203u2l3v1w3w3s3x3s3y3s3z2w4k5w4l4s4m4m4n4m4o4s4p3x4q3r4r4s4s4s4t2l4u2r4v4s4w3x4x5t4y4s4z4s5k3r5l4s5m4m5n3r5o3x5p4s5q4s5r5y5s4s5t4s5u3x5v2l5w1w5x2l5y2z5z3m6k2l6l2w6m3m6n2w6o3m6p2w6q2l6r3m6s3m6t1w6u1w6v3m6w1w6x4y6y3m6z3m7k3m7l3m7m2l7n2r7o1w7p3m7q3m7r4s7s3m7t3m7u2w7v3k7w1o7x3k7y3q202l3mcl4sal2lam3man3mao3map3mar3mas2lat4wau1vav3maw3say4waz2lbk2sbl3s'fof'6obo2lbp3mbq2xbr1tbs2lbu1zbv3mbz2wck4s202k3mcm4scn4sco4scp4scq5tcr4mcs3xct3xcu3xcv3xcw2l2m2tcy2lcz2ldl4sdm4sdn4sdo4sdp4sdq4sds4sdt4sdu4sdv4sdw4sdz3mek2wel2wem2wen2weo2wep2weq4mer2wes2wet2weu2wev2wew1wex1wey1wez1wfl3mfm3mfn3mfo3mfp3mfq3mfr3sfs3mft3mfu3mfv3mfw3mfz3m203k6o212m6m2dw2l2cq2l3t3m3u1w17s4s19m3m}'kerning'{cl{4qs5ku17sw5ou5qy5rw201ss5tw201ws}201s{201ss}201t{ckw4lwcmwcnwcowcpwclw4wu201ts}2k{201ts}2w{4qs5kw5os5qx5ru17sx5tx}2x{17sw5tw5ou5qu}2y{4qs5kw5os5qx5ru17sx5tx}'fof'-6o7t{ckuclucmucnucoucpu4lu5os5rs}3u{17su5tu5qs}3v{17su5tu5qs}7p{17sw5tw5qs}ck{4qs5ku17sw5ou5qy5rw201ss5tw201ws}4l{4qs5ku17sw5ou5qy5rw201ss5tw201ws}cm{4qs5ku17sw5ou5qy5rw201ss5tw201ws}cn{4qs5ku17sw5ou5qy5rw201ss5tw201ws}co{4qs5ku17sw5ou5qy5rw201ss5tw201ws}cp{4qs5ku17sw5ou5qy5rw201ss5tw201ws}6l{17su5tu5os5qw5rs}17s{2ktclvcmvcnvcovcpv4lv4wuckv}5o{ckwclwcmwcnwcowcpw4lw4wu}5q{ckyclycmycnycoycpy4ly4wu5ms}5r{cktcltcmtcntcotcpt4lt4ws}5t{2ktclvcmvcnvcovcpv4lv4wuckv}7q{cksclscmscnscoscps4ls}6p{17su5tu5qw5rs}ek{5qs5rs}el{17su5tu5os5qw5rs}em{17su5tu5os5qs5rs}en{17su5qs5rs}eo{5qs5rs}ep{17su5tu5os5qw5rs}es{5qs}et{17su5tu5qw5rs}eu{17su5tu5qs5rs}ev{5qs}6z{17sv5tv5os5qx5rs}fm{5os5qt5rs}fn{17sv5tv5os5qx5rs}fo{17sv5tv5os5qx5rs}fp{5os5qt5rs}fq{5os5qt5rs}7r{ckuclucmucnucoucpu4lu5os}fs{17sv5tv5os5qx5rs}ft{17ss5ts5qs}fu{17sw5tw5qs}fv{17sw5tw5qs}fw{17ss5ts5qs}fz{ckuclucmucnucoucpu4lu5os5rs}}}"),"Helvetica-Oblique":o("{'widths'{k3p2q4mcx1w201n3r201o6o201s1q201t1q201u1q201w2l201x2l201y2l2k1w2l1w202m2n2n3r2o3r2p5t202q6o2r1n2s2l2t2l2u2r2v3u2w1w2x2l2y1w2z1w3k3r3l3r3m3r3n3r3o3r3p3r3q3r3r3r3s3r203t2l203u2l3v1w3w3u3x3u3y3u3z3r4k6p4l4m4m4m4n4s4o4s4p4m4q3x4r4y4s4s4t1w4u3m4v4m4w3r4x5n4y4s4z4y5k4m5l4y5m4s5n4m5o3x5p4s5q4m5r5y5s4m5t4m5u3x5v1w5w1w5x1w5y2z5z3r6k2l6l3r6m3r6n3m6o3r6p3r6q1w6r3r6s3r6t1q6u1q6v3m6w1q6x5n6y3r6z3r7k3r7l3r7m2l7n3m7o1w7p3r7q3m7r4s7s3m7t3m7u3m7v2l7w1u7x2l7y3u202l3rcl4mal2lam3ran3rao3rap3rar3ras2lat4tau2pav3raw3uay4taz2lbk2sbl3u'fof'6obo2lbp3rbr1wbs2lbu2obv3rbz3xck4m202k3rcm4mcn4mco4mcp4mcq6ocr4scs4mct4mcu4mcv4mcw1w2m2ncy1wcz1wdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3xek3rel3rem3ren3reo3rep3req5ter3mes3ret3reu3rev3rew1wex1wey1wez1wfl3rfm3rfn3rfo3rfp3rfq3rfr3ufs3xft3rfu3rfv3rfw3rfz3m203k6o212m6o2dw2l2cq2l3t3r3u1w17s4m19m3r}'kerning'{5q{4wv}cl{4qs5kw5ow5qs17sv5tv}201t{2wu4w1k2yu}201x{2wu4wy2yu}17s{2ktclucmucnu4otcpu4lu4wycoucku}2w{7qs4qz5k1m17sy5ow5qx5rsfsu5ty7tufzu}2x{17sy5ty5oy5qs}2y{7qs4qz5k1m17sy5ow5qx5rsfsu5ty7tufzu}'fof'-6o7p{17sv5tv5ow}ck{4qs5kw5ow5qs17sv5tv}4l{4qs5kw5ow5qs17sv5tv}cm{4qs5kw5ow5qs17sv5tv}cn{4qs5kw5ow5qs17sv5tv}co{4qs5kw5ow5qs17sv5tv}cp{4qs5kw5ow5qs17sv5tv}6l{17sy5ty5ow}do{17st5tt}4z{17st5tt}7s{fst}dm{17st5tt}dn{17st5tt}5o{ckwclwcmwcnwcowcpw4lw4wv}dp{17st5tt}dq{17st5tt}7t{5ow}ds{17st5tt}5t{2ktclucmucnu4otcpu4lu4wycoucku}fu{17sv5tv5ow}6p{17sy5ty5ow5qs}ek{17sy5ty5ow}el{17sy5ty5ow}em{17sy5ty5ow}en{5ty}eo{17sy5ty5ow}ep{17sy5ty5ow}es{17sy5ty5qs}et{17sy5ty5ow5qs}eu{17sy5ty5ow5qs}ev{17sy5ty5ow5qs}6z{17sy5ty5ow5qs}fm{17sy5ty5ow5qs}fn{17sy5ty5ow5qs}fo{17sy5ty5ow5qs}fp{17sy5ty5qs}fq{17sy5ty5ow5qs}7r{5ow}fs{17sy5ty5ow5qs}ft{17sv5tv5ow}7m{5ow}fv{17sv5tv5ow}fw{17sv5tv5ow}}}")}};e.events.push(["addFont",function(f){var d=f.font,h=u.Unicode[d.postScriptName];h&&(d.metadata.Unicode={},d.metadata.Unicode.widths=h.widths,d.metadata.Unicode.kerning=h.kerning);var g=c.Unicode[d.postScriptName];g&&(d.metadata.Unicode.encoding=g,d.encoding=g.codePages[0])}])}(vt.API),function(e){var t=function(r){for(var n=r.length,a=new Uint8Array(n),i=0;i<n;i++)a[i]=r.charCodeAt(i);return a};e.API.events.push(["addFont",function(r){var n=void 0,a=r.font,i=r.instance;if(!a.isStandardFont){if(i===void 0)throw new Error("Font does not exist in vFS, import fonts or remove declaration doc.addFont('"+a.postScriptName+"').");if(typeof(n=i.existsFileInVFS(a.postScriptName)===!1?i.loadFile(a.postScriptName):i.getFileFromVFS(a.postScriptName))!="string")throw new Error("Font is not stored as string-data in vFS, import fonts or remove declaration doc.addFont('"+a.postScriptName+"').");(function(s,o){o=/^\x00\x01\x00\x00/.test(o)?t(o):t(Mf(o)),s.metadata=e.API.TTFFont.open(o),s.metadata.Unicode=s.metadata.Unicode||{encoding:{},kerning:{},widths:[]},s.metadata.glyIdsUsed=[0]})(a,n)}}])}(vt),function(e){function t(){return(yt.canvg?Promise.resolve(yt.canvg):tl(()=>import("./index.es-B_VlSOnO.js"),[])).catch(function(r){return Promise.reject(new Error("Could not load canvg: "+r))}).then(function(r){return r.default?r.default:r})}vt.API.addSvgAsImage=function(r,n,a,i,s,o,l,c){if(isNaN(n)||isNaN(a))throw lr.error("jsPDF.addSvgAsImage: Invalid coordinates",arguments),new Error("Invalid coordinates passed to jsPDF.addSvgAsImage");if(isNaN(i)||isNaN(s))throw lr.error("jsPDF.addSvgAsImage: Invalid measurements",arguments),new Error("Invalid measurements (width and/or height) passed to jsPDF.addSvgAsImage");var u=document.createElement("canvas");u.width=i,u.height=s;var f=u.getContext("2d");f.fillStyle="#fff",f.fillRect(0,0,u.width,u.height);var d={ignoreMouse:!0,ignoreAnimation:!0,ignoreDimensions:!0},h=this;return t().then(function(g){return g.fromString(f,r,d)},function(){return Promise.reject(new Error("Could not load canvg."))}).then(function(g){return g.render(d)}).then(function(){h.addImage(u.toDataURL("image/jpeg",1),n,a,i,s,l,c)})}}(),vt.API.putTotalPages=function(e){var t,r=0;parseInt(this.internal.getFont().id.substr(1),10)<15?(t=new RegExp(e,"g"),r=this.internal.getNumberOfPages()):(t=new RegExp(this.pdfEscape16(e,this.internal.getFont()),"g"),r=this.pdfEscape16(this.internal.getNumberOfPages()+"",this.internal.getFont()));for(var n=1;n<=this.internal.getNumberOfPages();n++)for(var a=0;a<this.internal.pages[n].length;a++)this.internal.pages[n][a]=this.internal.pages[n][a].replace(t,r);return this},vt.API.viewerPreferences=function(e,t){var r;e=e||{},t=t||!1;var n,a,i,s={HideToolbar:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},HideMenubar:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},HideWindowUI:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},FitWindow:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},CenterWindow:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},DisplayDocTitle:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.4},NonFullScreenPageMode:{defaultValue:"UseNone",value:"UseNone",type:"name",explicitSet:!1,valueSet:["UseNone","UseOutlines","UseThumbs","UseOC"],pdfVersion:1.3},Direction:{defaultValue:"L2R",value:"L2R",type:"name",explicitSet:!1,valueSet:["L2R","R2L"],pdfVersion:1.3},ViewArea:{defaultValue:"CropBox",value:"CropBox",type:"name",explicitSet:!1,valueSet:["MediaBox","CropBox","TrimBox","BleedBox","ArtBox"],pdfVersion:1.4},ViewClip:{defaultValue:"CropBox",value:"CropBox",type:"name",explicitSet:!1,valueSet:["MediaBox","CropBox","TrimBox","BleedBox","ArtBox"],pdfVersion:1.4},PrintArea:{defaultValue:"CropBox",value:"CropBox",type:"name",explicitSet:!1,valueSet:["MediaBox","CropBox","TrimBox","BleedBox","ArtBox"],pdfVersion:1.4},PrintClip:{defaultValue:"CropBox",value:"CropBox",type:"name",explicitSet:!1,valueSet:["MediaBox","CropBox","TrimBox","BleedBox","ArtBox"],pdfVersion:1.4},PrintScaling:{defaultValue:"AppDefault",value:"AppDefault",type:"name",explicitSet:!1,valueSet:["AppDefault","None"],pdfVersion:1.6},Duplex:{defaultValue:"",value:"none",type:"name",explicitSet:!1,valueSet:["Simplex","DuplexFlipShortEdge","DuplexFlipLongEdge","none"],pdfVersion:1.7},PickTrayByPDFSize:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.7},PrintPageRange:{defaultValue:"",value:"",type:"array",explicitSet:!1,valueSet:null,pdfVersion:1.7},NumCopies:{defaultValue:1,value:1,type:"integer",explicitSet:!1,valueSet:null,pdfVersion:1.7}},o=Object.keys(s),l=[],c=0,u=0,f=0;function d(g,m){var _,y=!1;for(_=0;_<g.length;_+=1)g[_]===m&&(y=!0);return y}if(this.internal.viewerpreferences===void 0&&(this.internal.viewerpreferences={},this.internal.viewerpreferences.configuration=JSON.parse(JSON.stringify(s)),this.internal.viewerpreferences.isSubscribed=!1),r=this.internal.viewerpreferences.configuration,e==="reset"||t===!0){var h=o.length;for(f=0;f<h;f+=1)r[o[f]].value=r[o[f]].defaultValue,r[o[f]].explicitSet=!1}if(tr(e)==="object"){for(a in e)if(i=e[a],d(o,a)&&i!==void 0){if(r[a].type==="boolean"&&typeof i=="boolean")r[a].value=i;else if(r[a].type==="name"&&d(r[a].valueSet,i))r[a].value=i;else if(r[a].type==="integer"&&Number.isInteger(i))r[a].value=i;else if(r[a].type==="array"){for(c=0;c<i.length;c+=1)if(n=!0,i[c].length===1&&typeof i[c][0]=="number")l.push(String(i[c]-1));else if(i[c].length>1){for(u=0;u<i[c].length;u+=1)typeof i[c][u]!="number"&&(n=!1);n===!0&&l.push([i[c][0]-1,i[c][1]-1].join(" "))}r[a].value="["+l.join(" ")+"]"}else r[a].value=r[a].defaultValue;r[a].explicitSet=!0}}return this.internal.viewerpreferences.isSubscribed===!1&&(this.internal.events.subscribe("putCatalog",function(){var g,m=[];for(g in r)r[g].explicitSet===!0&&(r[g].type==="name"?m.push("/"+g+" /"+r[g].value):m.push("/"+g+" "+r[g].value));m.length!==0&&this.internal.write(`/ViewerPreferences
<<
`+m.join(`
`)+`
>>`)}),this.internal.viewerpreferences.isSubscribed=!0),this.internal.viewerpreferences.configuration=r,this},function(e){var t=function(){var n='<rdf:RDF xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#"><rdf:Description rdf:about="" xmlns:jspdf="'+this.internal.__metadata__.namespaceuri+'"><jspdf:metadata>',a=unescape(encodeURIComponent('<x:xmpmeta xmlns:x="adobe:ns:meta/">')),i=unescape(encodeURIComponent(n)),s=unescape(encodeURIComponent(this.internal.__metadata__.metadata)),o=unescape(encodeURIComponent("</jspdf:metadata></rdf:Description></rdf:RDF>")),l=unescape(encodeURIComponent("</x:xmpmeta>")),c=i.length+s.length+o.length+a.length+l.length;this.internal.__metadata__.metadata_object_number=this.internal.newObject(),this.internal.write("<< /Type /Metadata /Subtype /XML /Length "+c+" >>"),this.internal.write("stream"),this.internal.write(a+i+s+o+l),this.internal.write("endstream"),this.internal.write("endobj")},r=function(){this.internal.__metadata__.metadata_object_number&&this.internal.write("/Metadata "+this.internal.__metadata__.metadata_object_number+" 0 R")};e.addMetadata=function(n,a){return this.internal.__metadata__===void 0&&(this.internal.__metadata__={metadata:n,namespaceuri:a||"http://jspdf.default.namespaceuri/"},this.internal.events.subscribe("putCatalog",r),this.internal.events.subscribe("postPutResources",t)),this}}(vt.API),function(e){var t=e.API,r=t.pdfEscape16=function(i,s){for(var o,l=s.metadata.Unicode.widths,c=["","0","00","000","0000"],u=[""],f=0,d=i.length;f<d;++f){if(o=s.metadata.characterToGlyph(i.charCodeAt(f)),s.metadata.glyIdsUsed.push(o),s.metadata.toUnicode[o]=i.charCodeAt(f),l.indexOf(o)==-1&&(l.push(o),l.push([parseInt(s.metadata.widthOfGlyph(o),10)])),o=="0")return u.join("");o=o.toString(16),u.push(c[4-o.length],o)}return u.join("")},n=function(i){var s,o,l,c,u,f,d;for(u=`/CIDInit /ProcSet findresource begin
12 dict begin
begincmap
/CIDSystemInfo <<
  /Registry (Adobe)
  /Ordering (UCS)
  /Supplement 0
>> def
/CMapName /Adobe-Identity-UCS def
/CMapType 2 def
1 begincodespacerange
<0000><ffff>
endcodespacerange`,l=[],f=0,d=(o=Object.keys(i).sort(function(h,g){return h-g})).length;f<d;f++)s=o[f],l.length>=100&&(u+=`
`+l.length+` beginbfchar
`+l.join(`
`)+`
endbfchar`,l=[]),i[s]!==void 0&&i[s]!==null&&typeof i[s].toString=="function"&&(c=("0000"+i[s].toString(16)).slice(-4),s=("0000"+(+s).toString(16)).slice(-4),l.push("<"+s+"><"+c+">"));return l.length&&(u+=`
`+l.length+` beginbfchar
`+l.join(`
`)+`
endbfchar
`),u+=`endcmap
CMapName currentdict /CMap defineresource pop
end
end`};t.events.push(["putFont",function(i){(function(s){var o=s.font,l=s.out,c=s.newObject,u=s.putStream;if(o.metadata instanceof e.API.TTFFont&&o.encoding==="Identity-H"){for(var f=o.metadata.Unicode.widths,d=o.metadata.subset.encode(o.metadata.glyIdsUsed,1),h="",g=0;g<d.length;g++)h+=String.fromCharCode(d[g]);var m=c();u({data:h,addLength1:!0,objectId:m}),l("endobj");var _=c();u({data:n(o.metadata.toUnicode),addLength1:!0,objectId:_}),l("endobj");var y=c();l("<<"),l("/Type /FontDescriptor"),l("/FontName /"+ru(o.fontName)),l("/FontFile2 "+m+" 0 R"),l("/FontBBox "+e.API.PDFObject.convert(o.metadata.bbox)),l("/Flags "+o.metadata.flags),l("/StemV "+o.metadata.stemV),l("/ItalicAngle "+o.metadata.italicAngle),l("/Ascent "+o.metadata.ascender),l("/Descent "+o.metadata.decender),l("/CapHeight "+o.metadata.capHeight),l(">>"),l("endobj");var b=c();l("<<"),l("/Type /Font"),l("/BaseFont /"+ru(o.fontName)),l("/FontDescriptor "+y+" 0 R"),l("/W "+e.API.PDFObject.convert(f)),l("/CIDToGIDMap /Identity"),l("/DW 1000"),l("/Subtype /CIDFontType2"),l("/CIDSystemInfo"),l("<<"),l("/Supplement 0"),l("/Registry (Adobe)"),l("/Ordering ("+o.encoding+")"),l(">>"),l(">>"),l("endobj"),o.objectNumber=c(),l("<<"),l("/Type /Font"),l("/Subtype /Type0"),l("/ToUnicode "+_+" 0 R"),l("/BaseFont /"+ru(o.fontName)),l("/Encoding /"+o.encoding),l("/DescendantFonts ["+b+" 0 R]"),l(">>"),l("endobj"),o.isAlreadyPutted=!0}})(i)}]),t.events.push(["putFont",function(i){(function(s){var o=s.font,l=s.out,c=s.newObject,u=s.putStream;if(o.metadata instanceof e.API.TTFFont&&o.encoding==="WinAnsiEncoding"){for(var f=o.metadata.rawData,d="",h=0;h<f.length;h++)d+=String.fromCharCode(f[h]);var g=c();u({data:d,addLength1:!0,objectId:g}),l("endobj");var m=c();u({data:n(o.metadata.toUnicode),addLength1:!0,objectId:m}),l("endobj");var _=c();l("<<"),l("/Descent "+o.metadata.decender),l("/CapHeight "+o.metadata.capHeight),l("/StemV "+o.metadata.stemV),l("/Type /FontDescriptor"),l("/FontFile2 "+g+" 0 R"),l("/Flags 96"),l("/FontBBox "+e.API.PDFObject.convert(o.metadata.bbox)),l("/FontName /"+ru(o.fontName)),l("/ItalicAngle "+o.metadata.italicAngle),l("/Ascent "+o.metadata.ascender),l(">>"),l("endobj"),o.objectNumber=c();for(var y=0;y<o.metadata.hmtx.widths.length;y++)o.metadata.hmtx.widths[y]=parseInt(o.metadata.hmtx.widths[y]*(1e3/o.metadata.head.unitsPerEm));l("<</Subtype/TrueType/Type/Font/ToUnicode "+m+" 0 R/BaseFont/"+ru(o.fontName)+"/FontDescriptor "+_+" 0 R/Encoding/"+o.encoding+" /FirstChar 29 /LastChar 255 /Widths "+e.API.PDFObject.convert(o.metadata.hmtx.widths)+">>"),l("endobj"),o.isAlreadyPutted=!0}})(i)}]);var a=function(i){var s,o=i.text||"",l=i.x,c=i.y,u=i.options||{},f=i.mutex||{},d=f.pdfEscape,h=f.activeFontKey,g=f.fonts,m=h,_="",y=0,b="",w=g[m].encoding;if(g[m].encoding!=="Identity-H")return{text:o,x:l,y:c,options:u,mutex:f};for(b=o,m=h,Array.isArray(o)&&(b=o[0]),y=0;y<b.length;y+=1)g[m].metadata.hasOwnProperty("cmap")&&(s=g[m].metadata.cmap.unicode.codeMap[b[y].charCodeAt(0)]),s||b[y].charCodeAt(0)<256&&g[m].metadata.hasOwnProperty("Unicode")?_+=b[y]:_+="";var T="";return parseInt(m.slice(1))<14||w==="WinAnsiEncoding"?T=d(_,m).split("").map(function(F){return F.charCodeAt(0).toString(16)}).join(""):w==="Identity-H"&&(T=r(_,g[m])),f.isHex=!0,{text:T,x:l,y:c,options:u,mutex:f}};t.events.push(["postProcessText",function(i){var s=i.text||"",o=[],l={text:s,x:i.x,y:i.y,options:i.options,mutex:i.mutex};if(Array.isArray(s)){var c=0;for(c=0;c<s.length;c+=1)Array.isArray(s[c])&&s[c].length===3?o.push([a(Object.assign({},l,{text:s[c][0]})).text,s[c][1],s[c][2]]):o.push(a(Object.assign({},l,{text:s[c]})).text);i.text=o}else i.text=a(Object.assign({},l,{text:s})).text}])}(vt),function(e){var t=function(){return this.internal.vFS===void 0&&(this.internal.vFS={}),!0};e.existsFileInVFS=function(r){return t.call(this),this.internal.vFS[r]!==void 0},e.addFileToVFS=function(r,n){return t.call(this),this.internal.vFS[r]=n,this},e.getFileFromVFS=function(r){return t.call(this),this.internal.vFS[r]!==void 0?this.internal.vFS[r]:null}}(vt.API),function(e){e.__bidiEngine__=e.prototype.__bidiEngine__=function(n){var a,i,s,o,l,c,u,f=t,d=[[0,3,0,1,0,0,0],[0,3,0,1,2,2,0],[0,3,0,17,2,0,1],[0,3,5,5,4,1,0],[0,3,21,21,4,0,1],[0,3,5,5,4,2,0]],h=[[2,0,1,1,0,1,0],[2,0,1,1,0,2,0],[2,0,2,1,3,2,0],[2,0,2,33,3,1,1]],g={L:0,R:1,EN:2,AN:3,N:4,B:5,S:6},m={0:0,5:1,6:2,7:3,32:4,251:5,254:6,255:7},_=["(",")","(","<",">","<","[","]","[","{","}","{","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","",""],y=new RegExp(/^([1-4|9]|1[0-9]|2[0-9]|3[0168]|4[04589]|5[012]|7[78]|159|16[0-9]|17[0-2]|21[569]|22[03489]|250)$/),b=!1,w=0;this.__bidiEngine__={};var T=function(N){var L=N.charCodeAt(),G=L>>8,W=m[G];return W!==void 0?f[256*W+(255&L)]:G===252||G===253?"AL":y.test(G)?"L":G===8?"R":"N"},F=function(N){for(var L,G=0;G<N.length;G++){if((L=T(N.charAt(G)))==="L")return!1;if(L==="R")return!0}return!1},I=function(N,L,G,W){var le,de,X,ee,R=L[W];switch(R){case"L":case"R":b=!1;break;case"N":case"AN":break;case"EN":b&&(R="AN");break;case"AL":b=!0,R="R";break;case"WS":R="N";break;case"CS":W<1||W+1>=L.length||(le=G[W-1])!=="EN"&&le!=="AN"||(de=L[W+1])!=="EN"&&de!=="AN"?R="N":b&&(de="AN"),R=de===le?de:"N";break;case"ES":R=(le=W>0?G[W-1]:"B")==="EN"&&W+1<L.length&&L[W+1]==="EN"?"EN":"N";break;case"ET":if(W>0&&G[W-1]==="EN"){R="EN";break}if(b){R="N";break}for(X=W+1,ee=L.length;X<ee&&L[X]==="ET";)X++;R=X<ee&&L[X]==="EN"?"EN":"N";break;case"NSM":if(s&&!o){for(ee=L.length,X=W+1;X<ee&&L[X]==="NSM";)X++;if(X<ee){var pe=N[W],me=pe>=1425&&pe<=2303||pe===64286;if(le=L[X],me&&(le==="R"||le==="AL")){R="R";break}}}R=W<1||(le=L[W-1])==="B"?"N":G[W-1];break;case"B":b=!1,a=!0,R=w;break;case"S":i=!0,R="N";break;case"LRE":case"RLE":case"LRO":case"RLO":case"PDF":b=!1;break;case"BN":R="N"}return R},A=function(N,L,G){var W=N.split("");return G&&P(W,G,{hiLevel:w}),W.reverse(),L&&L.reverse(),W.join("")},P=function(N,L,G){var W,le,de,X,ee,R=-1,pe=N.length,me=0,E=[],D=w?h:d,O=[];for(b=!1,a=!1,i=!1,le=0;le<pe;le++)O[le]=T(N[le]);for(de=0;de<pe;de++){if(ee=me,E[de]=I(N,O,E,de),W=240&(me=D[ee][g[E[de]]]),me&=15,L[de]=X=D[me][5],W>0)if(W===16){for(le=R;le<de;le++)L[le]=1;R=-1}else R=-1;if(D[me][6])R===-1&&(R=de);else if(R>-1){for(le=R;le<de;le++)L[le]=X;R=-1}O[de]==="B"&&(L[de]=0),G.hiLevel|=X}i&&function(M,K,Y){for(var re=0;re<Y;re++)if(M[re]==="S"){K[re]=w;for(var se=re-1;se>=0&&M[se]==="WS";se--)K[se]=w}}(O,L,pe)},j=function(N,L,G,W,le){if(!(le.hiLevel<N)){if(N===1&&w===1&&!a)return L.reverse(),void(G&&G.reverse());for(var de,X,ee,R,pe=L.length,me=0;me<pe;){if(W[me]>=N){for(ee=me+1;ee<pe&&W[ee]>=N;)ee++;for(R=me,X=ee-1;R<X;R++,X--)de=L[R],L[R]=L[X],L[X]=de,G&&(de=G[R],G[R]=G[X],G[X]=de);me=ee}me++}}},J=function(N,L,G){var W=N.split(""),le={hiLevel:w};return G||(G=[]),P(W,G,le),function(de,X,ee){if(ee.hiLevel!==0&&u)for(var R,pe=0;pe<de.length;pe++)X[pe]===1&&(R=_.indexOf(de[pe]))>=0&&(de[pe]=_[R+1])}(W,G,le),j(2,W,L,G,le),j(1,W,L,G,le),W.join("")};return this.__bidiEngine__.doBidiReorder=function(N,L,G){if(function(le,de){if(de)for(var X=0;X<le.length;X++)de[X]=X;o===void 0&&(o=F(le)),c===void 0&&(c=F(le))}(N,L),s||!l||c)if(s&&l&&o^c)w=o?1:0,N=A(N,L,G);else if(!s&&l&&c)w=o?1:0,N=J(N,L,G),N=A(N,L);else if(!s||o||l||c){if(s&&!l&&o^c)N=A(N,L),o?(w=0,N=J(N,L,G)):(w=1,N=J(N,L,G),N=A(N,L));else if(s&&o&&!l&&c)w=1,N=J(N,L,G),N=A(N,L);else if(!s&&!l&&o^c){var W=u;o?(w=1,N=J(N,L,G),w=0,u=!1,N=J(N,L,G),u=W):(w=0,N=J(N,L,G),N=A(N,L),w=1,u=!1,N=J(N,L,G),u=W,N=A(N,L))}}else w=0,N=J(N,L,G);else w=o?1:0,N=J(N,L,G);return N},this.__bidiEngine__.setOptions=function(N){N&&(s=N.isInputVisual,l=N.isOutputVisual,o=N.isInputRtl,c=N.isOutputRtl,u=N.isSymmetricSwapping)},this.__bidiEngine__.setOptions(n),this.__bidiEngine__};var t=["BN","BN","BN","BN","BN","BN","BN","BN","BN","S","B","S","WS","B","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","B","B","B","S","WS","N","N","ET","ET","ET","N","N","N","N","N","ES","CS","ES","CS","CS","EN","EN","EN","EN","EN","EN","EN","EN","EN","EN","CS","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","N","BN","BN","BN","BN","BN","BN","B","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","CS","N","ET","ET","ET","ET","N","N","N","N","L","N","N","BN","N","N","ET","ET","EN","EN","N","L","N","N","N","EN","L","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","L","L","L","L","L","L","L","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","L","N","N","N","N","N","ET","N","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","R","NSM","R","NSM","NSM","R","NSM","NSM","R","NSM","N","N","N","N","N","N","N","N","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","N","N","N","N","N","R","R","R","R","R","N","N","N","N","N","N","N","N","N","N","N","AN","AN","AN","AN","AN","AN","N","N","AL","ET","ET","AL","CS","AL","N","N","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","AL","AL","N","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","AN","AN","AN","AN","AN","AN","AN","AN","AN","AN","ET","AN","AN","AL","AL","AL","NSM","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","AN","N","NSM","NSM","NSM","NSM","NSM","NSM","AL","AL","NSM","NSM","N","NSM","NSM","NSM","NSM","AL","AL","EN","EN","EN","EN","EN","EN","EN","EN","EN","EN","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","N","AL","AL","NSM","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","N","N","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","AL","N","N","N","N","N","N","N","N","N","N","N","N","N","N","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","R","R","N","N","N","N","R","N","N","N","N","N","WS","WS","WS","WS","WS","WS","WS","WS","WS","WS","WS","BN","BN","BN","L","R","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","WS","B","LRE","RLE","PDF","LRO","RLO","CS","ET","ET","ET","ET","ET","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","CS","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","WS","BN","BN","BN","BN","BN","N","LRI","RLI","FSI","PDI","BN","BN","BN","BN","BN","BN","EN","L","N","N","EN","EN","EN","EN","EN","EN","ES","ES","N","N","N","L","EN","EN","EN","EN","EN","EN","EN","EN","EN","EN","ES","ES","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","L","L","L","L","L","L","L","N","N","N","N","N","N","N","N","N","N","N","N","L","L","L","L","L","N","N","N","N","N","R","NSM","R","R","R","R","R","R","R","R","R","R","ES","R","R","R","R","R","R","R","R","R","R","R","R","R","N","R","R","R","R","R","N","R","N","R","R","N","R","R","N","R","R","R","R","R","R","R","R","R","R","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","CS","N","CS","N","N","CS","N","N","N","N","N","N","N","N","N","ET","N","N","ES","ES","N","N","N","N","N","ET","ET","N","N","N","N","N","AL","AL","AL","AL","AL","N","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","N","N","BN","N","N","N","ET","ET","ET","N","N","N","N","N","ES","CS","ES","CS","CS","EN","EN","EN","EN","EN","EN","EN","EN","EN","EN","CS","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","N","N","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","L","L","L","L","L","L","N","N","L","L","L","L","L","L","N","N","L","L","L","L","L","L","N","N","L","L","L","N","N","N","ET","ET","N","N","N","ET","ET","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N"],r=new e.__bidiEngine__({isInputVisual:!0});e.API.events.push(["postProcessText",function(n){var a=n.text;n.x,n.y;var i=n.options||{};n.mutex,i.lang;var s=[];if(i.isInputVisual=typeof i.isInputVisual!="boolean"||i.isInputVisual,r.setOptions(i),Object.prototype.toString.call(a)==="[object Array]"){var o=0;for(s=[],o=0;o<a.length;o+=1)Object.prototype.toString.call(a[o])==="[object Array]"?s.push([r.doBidiReorder(a[o][0]),a[o][1],a[o][2]]):s.push([r.doBidiReorder(a[o])]);n.text=s}else n.text=r.doBidiReorder(a);r.setOptions({isInputVisual:!0})}])}(vt),vt.API.TTFFont=function(){function e(t){var r;if(this.rawData=t,r=this.contents=new ol(t),this.contents.pos=4,r.readString(4)==="ttcf")throw new Error("TTCF not supported.");r.pos=0,this.parse(),this.subset=new OY(this),this.registerTTF()}return e.open=function(t){return new e(t)},e.prototype.parse=function(){return this.directory=new yY(this.contents),this.head=new bY(this),this.name=new AY(this),this.cmap=new nC(this),this.toUnicode={},this.hhea=new _Y(this),this.maxp=new TY(this),this.hmtx=new CY(this),this.post=new kY(this),this.os2=new SY(this),this.loca=new FY(this),this.glyf=new NY(this),this.ascender=this.os2.exists&&this.os2.ascender||this.hhea.ascender,this.decender=this.os2.exists&&this.os2.decender||this.hhea.decender,this.lineGap=this.os2.exists&&this.os2.lineGap||this.hhea.lineGap,this.bbox=[this.head.xMin,this.head.yMin,this.head.xMax,this.head.yMax]},e.prototype.registerTTF=function(){var t,r,n,a,i;if(this.scaleFactor=1e3/this.head.unitsPerEm,this.bbox=(function(){var s,o,l,c;for(c=[],s=0,o=(l=this.bbox).length;s<o;s++)t=l[s],c.push(Math.round(t*this.scaleFactor));return c}).call(this),this.stemV=0,this.post.exists?(n=255&(a=this.post.italic_angle),32768&(r=a>>16)&&(r=-(1+(65535^r))),this.italicAngle=+(r+"."+n)):this.italicAngle=0,this.ascender=Math.round(this.ascender*this.scaleFactor),this.decender=Math.round(this.decender*this.scaleFactor),this.lineGap=Math.round(this.lineGap*this.scaleFactor),this.capHeight=this.os2.exists&&this.os2.capHeight||this.ascender,this.xHeight=this.os2.exists&&this.os2.xHeight||0,this.familyClass=(this.os2.exists&&this.os2.familyClass||0)>>8,this.isSerif=(i=this.familyClass)===1||i===2||i===3||i===4||i===5||i===7,this.isScript=this.familyClass===10,this.flags=0,this.post.isFixedPitch&&(this.flags|=1),this.isSerif&&(this.flags|=2),this.isScript&&(this.flags|=8),this.italicAngle!==0&&(this.flags|=64),this.flags|=32,!this.cmap.unicode)throw new Error("No unicode cmap for font")},e.prototype.characterToGlyph=function(t){var r;return((r=this.cmap.unicode)!=null?r.codeMap[t]:void 0)||0},e.prototype.widthOfGlyph=function(t){var r;return r=1e3/this.head.unitsPerEm,this.hmtx.forGlyph(t).advance*r},e.prototype.widthOfString=function(t,r,n){var a,i,s,o;for(s=0,i=0,o=(t=""+t).length;0<=o?i<o:i>o;i=0<=o?++i:--i)a=t.charCodeAt(i),s+=this.widthOfGlyph(this.characterToGlyph(a))+n*(1e3/r)||0;return s*(r/1e3)},e.prototype.lineHeight=function(t,r){var n;return r==null&&(r=!1),n=r?this.lineGap:0,(this.ascender+n-this.decender)/1e3*t},e}();var qi,ol=function(){function e(t){this.data=t??[],this.pos=0,this.length=this.data.length}return e.prototype.readByte=function(){return this.data[this.pos++]},e.prototype.writeByte=function(t){return this.data[this.pos++]=t},e.prototype.readUInt32=function(){return 16777216*this.readByte()+(this.readByte()<<16)+(this.readByte()<<8)+this.readByte()},e.prototype.writeUInt32=function(t){return this.writeByte(t>>>24&255),this.writeByte(t>>16&255),this.writeByte(t>>8&255),this.writeByte(255&t)},e.prototype.readInt32=function(){var t;return(t=this.readUInt32())>=2147483648?t-4294967296:t},e.prototype.writeInt32=function(t){return t<0&&(t+=4294967296),this.writeUInt32(t)},e.prototype.readUInt16=function(){return this.readByte()<<8|this.readByte()},e.prototype.writeUInt16=function(t){return this.writeByte(t>>8&255),this.writeByte(255&t)},e.prototype.readInt16=function(){var t;return(t=this.readUInt16())>=32768?t-65536:t},e.prototype.writeInt16=function(t){return t<0&&(t+=65536),this.writeUInt16(t)},e.prototype.readString=function(t){var r,n;for(n=[],r=0;0<=t?r<t:r>t;r=0<=t?++r:--r)n[r]=String.fromCharCode(this.readByte());return n.join("")},e.prototype.writeString=function(t){var r,n,a;for(a=[],r=0,n=t.length;0<=n?r<n:r>n;r=0<=n?++r:--r)a.push(this.writeByte(t.charCodeAt(r)));return a},e.prototype.readShort=function(){return this.readInt16()},e.prototype.writeShort=function(t){return this.writeInt16(t)},e.prototype.readLongLong=function(){var t,r,n,a,i,s,o,l;return t=this.readByte(),r=this.readByte(),n=this.readByte(),a=this.readByte(),i=this.readByte(),s=this.readByte(),o=this.readByte(),l=this.readByte(),128&t?-1*(72057594037927940*(255^t)+281474976710656*(255^r)+1099511627776*(255^n)+4294967296*(255^a)+16777216*(255^i)+65536*(255^s)+256*(255^o)+(255^l)+1):72057594037927940*t+281474976710656*r+1099511627776*n+4294967296*a+16777216*i+65536*s+256*o+l},e.prototype.writeLongLong=function(t){var r,n;return r=Math.floor(t/4294967296),n=4294967295&t,this.writeByte(r>>24&255),this.writeByte(r>>16&255),this.writeByte(r>>8&255),this.writeByte(255&r),this.writeByte(n>>24&255),this.writeByte(n>>16&255),this.writeByte(n>>8&255),this.writeByte(255&n)},e.prototype.readInt=function(){return this.readInt32()},e.prototype.writeInt=function(t){return this.writeInt32(t)},e.prototype.read=function(t){var r,n;for(r=[],n=0;0<=t?n<t:n>t;n=0<=t?++n:--n)r.push(this.readByte());return r},e.prototype.write=function(t){var r,n,a,i;for(i=[],n=0,a=t.length;n<a;n++)r=t[n],i.push(this.writeByte(r));return i},e}(),yY=function(){var e;function t(r){var n,a,i;for(this.scalarType=r.readInt(),this.tableCount=r.readShort(),this.searchRange=r.readShort(),this.entrySelector=r.readShort(),this.rangeShift=r.readShort(),this.tables={},a=0,i=this.tableCount;0<=i?a<i:a>i;a=0<=i?++a:--a)n={tag:r.readString(4),checksum:r.readInt(),offset:r.readInt(),length:r.readInt()},this.tables[n.tag]=n}return t.prototype.encode=function(r){var n,a,i,s,o,l,c,u,f,d,h,g,m;for(m in h=Object.keys(r).length,l=Math.log(2),f=16*Math.floor(Math.log(h)/l),s=Math.floor(f/l),u=16*h-f,(a=new ol).writeInt(this.scalarType),a.writeShort(h),a.writeShort(f),a.writeShort(s),a.writeShort(u),i=16*h,c=a.pos+i,o=null,g=[],r)for(d=r[m],a.writeString(m),a.writeInt(e(d)),a.writeInt(c),a.writeInt(d.length),g=g.concat(d),m==="head"&&(o=c),c+=d.length;c%4;)g.push(0),c++;return a.write(g),n=2981146554-e(a.data),a.pos=o+8,a.writeUInt32(n),a.data},e=function(r){var n,a,i,s;for(r=aC.call(r);r.length%4;)r.push(0);for(i=new ol(r),a=0,n=0,s=r.length;n<s;n=n+=4)a+=i.readUInt32();return 4294967295&a},t}(),wY={}.hasOwnProperty,vs=function(e,t){for(var r in t)wY.call(t,r)&&(e[r]=t[r]);function n(){this.constructor=e}return n.prototype=t.prototype,e.prototype=new n,e.__super__=t.prototype,e};qi=function(){function e(t){var r;this.file=t,r=this.file.directory.tables[this.tag],this.exists=!!r,r&&(this.offset=r.offset,this.length=r.length,this.parse(this.file.contents))}return e.prototype.parse=function(){},e.prototype.encode=function(){},e.prototype.raw=function(){return this.exists?(this.file.contents.pos=this.offset,this.file.contents.read(this.length)):null},e}();var bY=function(e){function t(){return t.__super__.constructor.apply(this,arguments)}return vs(t,qi),t.prototype.tag="head",t.prototype.parse=function(r){return r.pos=this.offset,this.version=r.readInt(),this.revision=r.readInt(),this.checkSumAdjustment=r.readInt(),this.magicNumber=r.readInt(),this.flags=r.readShort(),this.unitsPerEm=r.readShort(),this.created=r.readLongLong(),this.modified=r.readLongLong(),this.xMin=r.readShort(),this.yMin=r.readShort(),this.xMax=r.readShort(),this.yMax=r.readShort(),this.macStyle=r.readShort(),this.lowestRecPPEM=r.readShort(),this.fontDirectionHint=r.readShort(),this.indexToLocFormat=r.readShort(),this.glyphDataFormat=r.readShort()},t.prototype.encode=function(r){var n;return(n=new ol).writeInt(this.version),n.writeInt(this.revision),n.writeInt(this.checkSumAdjustment),n.writeInt(this.magicNumber),n.writeShort(this.flags),n.writeShort(this.unitsPerEm),n.writeLongLong(this.created),n.writeLongLong(this.modified),n.writeShort(this.xMin),n.writeShort(this.yMin),n.writeShort(this.xMax),n.writeShort(this.yMax),n.writeShort(this.macStyle),n.writeShort(this.lowestRecPPEM),n.writeShort(this.fontDirectionHint),n.writeShort(r),n.writeShort(this.glyphDataFormat),n.data},t}(),W_=function(){function e(t,r){var n,a,i,s,o,l,c,u,f,d,h,g,m,_,y,b,w;switch(this.platformID=t.readUInt16(),this.encodingID=t.readShort(),this.offset=r+t.readInt(),f=t.pos,t.pos=this.offset,this.format=t.readUInt16(),this.length=t.readUInt16(),this.language=t.readUInt16(),this.isUnicode=this.platformID===3&&this.encodingID===1&&this.format===4||this.platformID===0&&this.format===4,this.codeMap={},this.format){case 0:for(l=0;l<256;++l)this.codeMap[l]=t.readByte();break;case 4:for(h=t.readUInt16(),d=h/2,t.pos+=6,i=function(){var T,F;for(F=[],l=T=0;0<=d?T<d:T>d;l=0<=d?++T:--T)F.push(t.readUInt16());return F}(),t.pos+=2,m=function(){var T,F;for(F=[],l=T=0;0<=d?T<d:T>d;l=0<=d?++T:--T)F.push(t.readUInt16());return F}(),c=function(){var T,F;for(F=[],l=T=0;0<=d?T<d:T>d;l=0<=d?++T:--T)F.push(t.readUInt16());return F}(),u=function(){var T,F;for(F=[],l=T=0;0<=d?T<d:T>d;l=0<=d?++T:--T)F.push(t.readUInt16());return F}(),a=(this.length-t.pos+this.offset)/2,o=function(){var T,F;for(F=[],l=T=0;0<=a?T<a:T>a;l=0<=a?++T:--T)F.push(t.readUInt16());return F}(),l=y=0,w=i.length;y<w;l=++y)for(_=i[l],n=b=g=m[l];g<=_?b<=_:b>=_;n=g<=_?++b:--b)u[l]===0?s=n+c[l]:(s=o[u[l]/2+(n-g)-(d-l)]||0)!==0&&(s+=c[l]),this.codeMap[n]=65535&s}t.pos=f}return e.encode=function(t,r){var n,a,i,s,o,l,c,u,f,d,h,g,m,_,y,b,w,T,F,I,A,P,j,J,N,L,G,W,le,de,X,ee,R,pe,me,E,D,O,M,K,Y,re,se,xe,Ce,Z;switch(W=new ol,s=Object.keys(t).sort(function(Ie,He){return Ie-He}),r){case"macroman":for(m=0,_=function(){var Ie=[];for(g=0;g<256;++g)Ie.push(0);return Ie}(),b={0:0},i={},le=0,R=s.length;le<R;le++)b[se=t[a=s[le]]]==null&&(b[se]=++m),i[a]={old:t[a],new:b[t[a]]},_[a]=b[t[a]];return W.writeUInt16(1),W.writeUInt16(0),W.writeUInt32(12),W.writeUInt16(0),W.writeUInt16(262),W.writeUInt16(0),W.write(_),{charMap:i,subtable:W.data,maxGlyphID:m+1};case"unicode":for(L=[],f=[],w=0,b={},n={},y=c=null,de=0,pe=s.length;de<pe;de++)b[F=t[a=s[de]]]==null&&(b[F]=++w),n[a]={old:F,new:b[F]},o=b[F]-a,y!=null&&o===c||(y&&f.push(y),L.push(a),c=o),y=a;for(y&&f.push(y),f.push(65535),L.push(65535),J=2*(j=L.length),P=2*Math.pow(Math.log(j)/Math.LN2,2),d=Math.log(P/2)/Math.LN2,A=2*j-P,l=[],I=[],h=[],g=X=0,me=L.length;X<me;g=++X){if(N=L[g],u=f[g],N===65535){l.push(0),I.push(0);break}if(N-(G=n[N].new)>=32768)for(l.push(0),I.push(2*(h.length+j-g)),a=ee=N;N<=u?ee<=u:ee>=u;a=N<=u?++ee:--ee)h.push(n[a].new);else l.push(G-N),I.push(0)}for(W.writeUInt16(3),W.writeUInt16(1),W.writeUInt32(12),W.writeUInt16(4),W.writeUInt16(16+8*j+2*h.length),W.writeUInt16(0),W.writeUInt16(J),W.writeUInt16(P),W.writeUInt16(d),W.writeUInt16(A),Y=0,E=f.length;Y<E;Y++)a=f[Y],W.writeUInt16(a);for(W.writeUInt16(0),re=0,D=L.length;re<D;re++)a=L[re],W.writeUInt16(a);for(xe=0,O=l.length;xe<O;xe++)o=l[xe],W.writeUInt16(o);for(Ce=0,M=I.length;Ce<M;Ce++)T=I[Ce],W.writeUInt16(T);for(Z=0,K=h.length;Z<K;Z++)m=h[Z],W.writeUInt16(m);return{charMap:n,subtable:W.data,maxGlyphID:w+1}}},e}(),nC=function(e){function t(){return t.__super__.constructor.apply(this,arguments)}return vs(t,qi),t.prototype.tag="cmap",t.prototype.parse=function(r){var n,a,i;for(r.pos=this.offset,this.version=r.readUInt16(),i=r.readUInt16(),this.tables=[],this.unicode=null,a=0;0<=i?a<i:a>i;a=0<=i?++a:--a)n=new W_(r,this.offset),this.tables.push(n),n.isUnicode&&this.unicode==null&&(this.unicode=n);return!0},t.encode=function(r,n){var a,i;return n==null&&(n="macroman"),a=W_.encode(r,n),(i=new ol).writeUInt16(0),i.writeUInt16(1),a.table=i.data.concat(a.subtable),a},t}(),_Y=function(e){function t(){return t.__super__.constructor.apply(this,arguments)}return vs(t,qi),t.prototype.tag="hhea",t.prototype.parse=function(r){return r.pos=this.offset,this.version=r.readInt(),this.ascender=r.readShort(),this.decender=r.readShort(),this.lineGap=r.readShort(),this.advanceWidthMax=r.readShort(),this.minLeftSideBearing=r.readShort(),this.minRightSideBearing=r.readShort(),this.xMaxExtent=r.readShort(),this.caretSlopeRise=r.readShort(),this.caretSlopeRun=r.readShort(),this.caretOffset=r.readShort(),r.pos+=8,this.metricDataFormat=r.readShort(),this.numberOfMetrics=r.readUInt16()},t}(),SY=function(e){function t(){return t.__super__.constructor.apply(this,arguments)}return vs(t,qi),t.prototype.tag="OS/2",t.prototype.parse=function(r){if(r.pos=this.offset,this.version=r.readUInt16(),this.averageCharWidth=r.readShort(),this.weightClass=r.readUInt16(),this.widthClass=r.readUInt16(),this.type=r.readShort(),this.ySubscriptXSize=r.readShort(),this.ySubscriptYSize=r.readShort(),this.ySubscriptXOffset=r.readShort(),this.ySubscriptYOffset=r.readShort(),this.ySuperscriptXSize=r.readShort(),this.ySuperscriptYSize=r.readShort(),this.ySuperscriptXOffset=r.readShort(),this.ySuperscriptYOffset=r.readShort(),this.yStrikeoutSize=r.readShort(),this.yStrikeoutPosition=r.readShort(),this.familyClass=r.readShort(),this.panose=function(){var n,a;for(a=[],n=0;n<10;++n)a.push(r.readByte());return a}(),this.charRange=function(){var n,a;for(a=[],n=0;n<4;++n)a.push(r.readInt());return a}(),this.vendorID=r.readString(4),this.selection=r.readShort(),this.firstCharIndex=r.readShort(),this.lastCharIndex=r.readShort(),this.version>0&&(this.ascent=r.readShort(),this.descent=r.readShort(),this.lineGap=r.readShort(),this.winAscent=r.readShort(),this.winDescent=r.readShort(),this.codePageRange=function(){var n,a;for(a=[],n=0;n<2;n=++n)a.push(r.readInt());return a}(),this.version>1))return this.xHeight=r.readShort(),this.capHeight=r.readShort(),this.defaultChar=r.readShort(),this.breakChar=r.readShort(),this.maxContext=r.readShort()},t}(),kY=function(e){function t(){return t.__super__.constructor.apply(this,arguments)}return vs(t,qi),t.prototype.tag="post",t.prototype.parse=function(r){var n,a,i;switch(r.pos=this.offset,this.format=r.readInt(),this.italicAngle=r.readInt(),this.underlinePosition=r.readShort(),this.underlineThickness=r.readShort(),this.isFixedPitch=r.readInt(),this.minMemType42=r.readInt(),this.maxMemType42=r.readInt(),this.minMemType1=r.readInt(),this.maxMemType1=r.readInt(),this.format){case 65536:break;case 131072:var s;for(a=r.readUInt16(),this.glyphNameIndex=[],s=0;0<=a?s<a:s>a;s=0<=a?++s:--s)this.glyphNameIndex.push(r.readUInt16());for(this.names=[],i=[];r.pos<this.offset+this.length;)n=r.readByte(),i.push(this.names.push(r.readString(n)));return i;case 151552:return a=r.readUInt16(),this.offsets=r.read(a);case 196608:break;case 262144:return this.map=(function(){var o,l,c;for(c=[],s=o=0,l=this.file.maxp.numGlyphs;0<=l?o<l:o>l;s=0<=l?++o:--o)c.push(r.readUInt32());return c}).call(this)}},t}(),EY=function(e,t){this.raw=e,this.length=e.length,this.platformID=t.platformID,this.encodingID=t.encodingID,this.languageID=t.languageID},AY=function(e){function t(){return t.__super__.constructor.apply(this,arguments)}return vs(t,qi),t.prototype.tag="name",t.prototype.parse=function(r){var n,a,i,s,o,l,c,u,f,d,h;for(r.pos=this.offset,r.readShort(),n=r.readShort(),l=r.readShort(),a=[],s=0;0<=n?s<n:s>n;s=0<=n?++s:--s)a.push({platformID:r.readShort(),encodingID:r.readShort(),languageID:r.readShort(),nameID:r.readShort(),length:r.readShort(),offset:this.offset+l+r.readShort()});for(c={},s=f=0,d=a.length;f<d;s=++f)i=a[s],r.pos=i.offset,u=r.readString(i.length),o=new EY(u,i),c[h=i.nameID]==null&&(c[h]=[]),c[i.nameID].push(o);this.strings=c,this.copyright=c[0],this.fontFamily=c[1],this.fontSubfamily=c[2],this.uniqueSubfamily=c[3],this.fontName=c[4],this.version=c[5];try{this.postscriptName=c[6][0].raw.replace(/[\x00-\x19\x80-\xff]/g,"")}catch{this.postscriptName=c[4][0].raw.replace(/[\x00-\x19\x80-\xff]/g,"")}return this.trademark=c[7],this.manufacturer=c[8],this.designer=c[9],this.description=c[10],this.vendorUrl=c[11],this.designerUrl=c[12],this.license=c[13],this.licenseUrl=c[14],this.preferredFamily=c[15],this.preferredSubfamily=c[17],this.compatibleFull=c[18],this.sampleText=c[19]},t}(),TY=function(e){function t(){return t.__super__.constructor.apply(this,arguments)}return vs(t,qi),t.prototype.tag="maxp",t.prototype.parse=function(r){return r.pos=this.offset,this.version=r.readInt(),this.numGlyphs=r.readUInt16(),this.maxPoints=r.readUInt16(),this.maxContours=r.readUInt16(),this.maxCompositePoints=r.readUInt16(),this.maxComponentContours=r.readUInt16(),this.maxZones=r.readUInt16(),this.maxTwilightPoints=r.readUInt16(),this.maxStorage=r.readUInt16(),this.maxFunctionDefs=r.readUInt16(),this.maxInstructionDefs=r.readUInt16(),this.maxStackElements=r.readUInt16(),this.maxSizeOfInstructions=r.readUInt16(),this.maxComponentElements=r.readUInt16(),this.maxComponentDepth=r.readUInt16()},t}(),CY=function(e){function t(){return t.__super__.constructor.apply(this,arguments)}return vs(t,qi),t.prototype.tag="hmtx",t.prototype.parse=function(r){var n,a,i,s,o,l,c;for(r.pos=this.offset,this.metrics=[],n=0,l=this.file.hhea.numberOfMetrics;0<=l?n<l:n>l;n=0<=l?++n:--n)this.metrics.push({advance:r.readUInt16(),lsb:r.readInt16()});for(i=this.file.maxp.numGlyphs-this.file.hhea.numberOfMetrics,this.leftSideBearings=function(){var u,f;for(f=[],n=u=0;0<=i?u<i:u>i;n=0<=i?++u:--u)f.push(r.readInt16());return f}(),this.widths=(function(){var u,f,d,h;for(h=[],u=0,f=(d=this.metrics).length;u<f;u++)s=d[u],h.push(s.advance);return h}).call(this),a=this.widths[this.widths.length-1],c=[],n=o=0;0<=i?o<i:o>i;n=0<=i?++o:--o)c.push(this.widths.push(a));return c},t.prototype.forGlyph=function(r){return r in this.metrics?this.metrics[r]:{advance:this.metrics[this.metrics.length-1].advance,lsb:this.leftSideBearings[r-this.metrics.length]}},t}(),aC=[].slice,NY=function(e){function t(){return t.__super__.constructor.apply(this,arguments)}return vs(t,qi),t.prototype.tag="glyf",t.prototype.parse=function(){return this.cache={}},t.prototype.glyphFor=function(r){var n,a,i,s,o,l,c,u,f,d;return r in this.cache?this.cache[r]:(s=this.file.loca,n=this.file.contents,a=s.indexOf(r),(i=s.lengthOf(r))===0?this.cache[r]=null:(n.pos=this.offset+a,o=(l=new ol(n.read(i))).readShort(),u=l.readShort(),d=l.readShort(),c=l.readShort(),f=l.readShort(),this.cache[r]=o===-1?new LY(l,u,d,c,f):new PY(l,o,u,d,c,f),this.cache[r]))},t.prototype.encode=function(r,n,a){var i,s,o,l,c;for(o=[],s=[],l=0,c=n.length;l<c;l++)i=r[n[l]],s.push(o.length),i&&(o=o.concat(i.encode(a)));return s.push(o.length),{table:o,offsets:s}},t}(),PY=function(){function e(t,r,n,a,i,s){this.raw=t,this.numberOfContours=r,this.xMin=n,this.yMin=a,this.xMax=i,this.yMax=s,this.compound=!1}return e.prototype.encode=function(){return this.raw.data},e}(),LY=function(){function e(t,r,n,a,i){var s,o;for(this.raw=t,this.xMin=r,this.yMin=n,this.xMax=a,this.yMax=i,this.compound=!0,this.glyphIDs=[],this.glyphOffsets=[],s=this.raw;o=s.readShort(),this.glyphOffsets.push(s.pos),this.glyphIDs.push(s.readUInt16()),32&o;)s.pos+=1&o?4:2,128&o?s.pos+=8:64&o?s.pos+=4:8&o&&(s.pos+=2)}return e.prototype.encode=function(){var t,r,n;for(r=new ol(aC.call(this.raw.data)),t=0,n=this.glyphIDs.length;t<n;++t)r.pos=this.glyphOffsets[t];return r.data},e}(),FY=function(e){function t(){return t.__super__.constructor.apply(this,arguments)}return vs(t,qi),t.prototype.tag="loca",t.prototype.parse=function(r){var n,a;return r.pos=this.offset,n=this.file.head.indexToLocFormat,this.offsets=n===0?(function(){var i,s;for(s=[],a=0,i=this.length;a<i;a+=2)s.push(2*r.readUInt16());return s}).call(this):(function(){var i,s;for(s=[],a=0,i=this.length;a<i;a+=4)s.push(r.readUInt32());return s}).call(this)},t.prototype.indexOf=function(r){return this.offsets[r]},t.prototype.lengthOf=function(r){return this.offsets[r+1]-this.offsets[r]},t.prototype.encode=function(r,n){for(var a=new Uint32Array(this.offsets.length),i=0,s=0,o=0;o<a.length;++o)if(a[o]=i,s<n.length&&n[s]==o){++s,a[o]=i;var l=this.offsets[o],c=this.offsets[o+1]-l;c>0&&(i+=c)}for(var u=new Array(4*a.length),f=0;f<a.length;++f)u[4*f+3]=255&a[f],u[4*f+2]=(65280&a[f])>>8,u[4*f+1]=(16711680&a[f])>>16,u[4*f]=(4278190080&a[f])>>24;return u},t}(),OY=function(){function e(t){this.font=t,this.subset={},this.unicodes={},this.next=33}return e.prototype.generateCmap=function(){var t,r,n,a,i;for(r in a=this.font.cmap.tables[0].codeMap,t={},i=this.subset)n=i[r],t[r]=a[n];return t},e.prototype.glyphsFor=function(t){var r,n,a,i,s,o,l;for(a={},s=0,o=t.length;s<o;s++)a[i=t[s]]=this.font.glyf.glyphFor(i);for(i in r=[],a)(n=a[i])!=null&&n.compound&&r.push.apply(r,n.glyphIDs);if(r.length>0)for(i in l=this.glyphsFor(r))n=l[i],a[i]=n;return a},e.prototype.encode=function(t,r){var n,a,i,s,o,l,c,u,f,d,h,g,m,_,y;for(a in n=nC.encode(this.generateCmap(),"unicode"),s=this.glyphsFor(t),h={0:0},y=n.charMap)h[(l=y[a]).old]=l.new;for(g in d=n.maxGlyphID,s)g in h||(h[g]=d++);return u=function(b){var w,T;for(w in T={},b)T[b[w]]=w;return T}(h),f=Object.keys(u).sort(function(b,w){return b-w}),m=function(){var b,w,T;for(T=[],b=0,w=f.length;b<w;b++)o=f[b],T.push(u[o]);return T}(),i=this.font.glyf.encode(s,m,h),c=this.font.loca.encode(i.offsets,m),_={cmap:this.font.cmap.raw(),glyf:i.table,loca:c,hmtx:this.font.hmtx.raw(),hhea:this.font.hhea.raw(),maxp:this.font.maxp.raw(),post:this.font.post.raw(),name:this.font.name.raw(),head:this.font.head.encode(r)},this.font.os2.exists&&(_["OS/2"]=this.font.os2.raw()),this.font.directory.encode(_)},e}();vt.API.PDFObject=function(){var e;function t(){}return e=function(r,n){return(Array(n+1).join("0")+r).slice(-n)},t.convert=function(r){var n,a,i,s;if(Array.isArray(r))return"["+function(){var o,l,c;for(c=[],o=0,l=r.length;o<l;o++)n=r[o],c.push(t.convert(n));return c}().join(" ")+"]";if(typeof r=="string")return"/"+r;if(r!=null&&r.isString)return"("+r+")";if(r instanceof Date)return"(D:"+e(r.getUTCFullYear(),4)+e(r.getUTCMonth(),2)+e(r.getUTCDate(),2)+e(r.getUTCHours(),2)+e(r.getUTCMinutes(),2)+e(r.getUTCSeconds(),2)+"Z)";if({}.toString.call(r)==="[object Object]"){for(a in i=["<<"],r)s=r[a],i.push("/"+a+" "+t.convert(s));return i.push(">>"),i.join(`
`)}return""+r},t}();function iC(e,t,r,n,a){n=n||{};var i=1.15,s=a.internal.scaleFactor,o=a.internal.getFontSize()/s,l=a.getLineHeightFactor?a.getLineHeightFactor():i,c=o*l,u=/\r\n|\r|\n/g,f="",d=1;if((n.valign==="middle"||n.valign==="bottom"||n.halign==="center"||n.halign==="right")&&(f=typeof e=="string"?e.split(u):e,d=f.length||1),r+=o*(2-i),n.valign==="middle"?r-=d/2*c:n.valign==="bottom"&&(r-=d*c),n.halign==="center"||n.halign==="right"){var h=o;if(n.halign==="center"&&(h*=.5),f&&d>=1){for(var g=0;g<f.length;g++)a.text(f[g],t-a.getStringUnitWidth(f[g])*h,r),r+=c;return a}t-=a.getStringUnitWidth(e)*h}return n.halign==="justify"?a.text(e,t,r,{maxWidth:n.maxWidth||100,align:"justify"}):a.text(e,t,r),a}var q_={},ju=function(){function e(t){this.jsPDFDocument=t,this.userStyles={textColor:t.getTextColor?this.jsPDFDocument.getTextColor():0,fontSize:t.internal.getFontSize(),fontStyle:t.internal.getFont().fontStyle,font:t.internal.getFont().fontName,lineWidth:t.getLineWidth?this.jsPDFDocument.getLineWidth():0,lineColor:t.getDrawColor?this.jsPDFDocument.getDrawColor():0}}return e.setDefaults=function(t,r){r===void 0&&(r=null),r?r.__autoTableDocumentDefaults=t:q_=t},e.unifyColor=function(t){return Array.isArray(t)?t:typeof t=="number"?[t,t,t]:typeof t=="string"?[t]:null},e.prototype.applyStyles=function(t,r){var n,a,i;r===void 0&&(r=!1),t.fontStyle&&this.jsPDFDocument.setFontStyle&&this.jsPDFDocument.setFontStyle(t.fontStyle);var s=this.jsPDFDocument.internal.getFont(),o=s.fontStyle,l=s.fontName;if(t.font&&(l=t.font),t.fontStyle){o=t.fontStyle;var c=this.getFontList()[l];c&&c.indexOf(o)===-1&&this.jsPDFDocument.setFontStyle&&(this.jsPDFDocument.setFontStyle(c[0]),o=c[0])}if(this.jsPDFDocument.setFont(l,o),t.fontSize&&this.jsPDFDocument.setFontSize(t.fontSize),!r){var u=e.unifyColor(t.fillColor);u&&(n=this.jsPDFDocument).setFillColor.apply(n,u),u=e.unifyColor(t.textColor),u&&(a=this.jsPDFDocument).setTextColor.apply(a,u),u=e.unifyColor(t.lineColor),u&&(i=this.jsPDFDocument).setDrawColor.apply(i,u),typeof t.lineWidth=="number"&&this.jsPDFDocument.setLineWidth(t.lineWidth)}},e.prototype.splitTextToSize=function(t,r,n){return this.jsPDFDocument.splitTextToSize(t,r,n)},e.prototype.rect=function(t,r,n,a,i){return this.jsPDFDocument.rect(t,r,n,a,i)},e.prototype.getLastAutoTable=function(){return this.jsPDFDocument.lastAutoTable||null},e.prototype.getTextWidth=function(t){return this.jsPDFDocument.getTextWidth(t)},e.prototype.getDocument=function(){return this.jsPDFDocument},e.prototype.setPage=function(t){this.jsPDFDocument.setPage(t)},e.prototype.addPage=function(){return this.jsPDFDocument.addPage()},e.prototype.getFontList=function(){return this.jsPDFDocument.getFontList()},e.prototype.getGlobalOptions=function(){return q_||{}},e.prototype.getDocumentOptions=function(){return this.jsPDFDocument.__autoTableDocumentDefaults||{}},e.prototype.pageSize=function(){var t=this.jsPDFDocument.internal.pageSize;return t.width==null&&(t={width:t.getWidth(),height:t.getHeight()}),t},e.prototype.scaleFactor=function(){return this.jsPDFDocument.internal.scaleFactor},e.prototype.getLineHeightFactor=function(){var t=this.jsPDFDocument;return t.getLineHeightFactor?t.getLineHeightFactor():1.15},e.prototype.getLineHeight=function(t){return t/this.scaleFactor()*this.getLineHeightFactor()},e.prototype.pageNumber=function(){var t=this.jsPDFDocument.internal.getCurrentPageInfo();return t?t.pageNumber:this.jsPDFDocument.internal.getNumberOfPages()},e}(),Dv=function(e,t){return Dv=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,n){r.__proto__=n}||function(r,n){for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(r[a]=n[a])},Dv(e,t)};function sC(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");Dv(e,t);function r(){this.constructor=e}e.prototype=t===null?Object.create(t):(r.prototype=t.prototype,new r)}var oC=function(e){sC(t,e);function t(r){var n=e.call(this)||this;return n._element=r,n}return t}(Array);function IY(e){return{font:"helvetica",fontStyle:"normal",overflow:"linebreak",fillColor:!1,textColor:20,halign:"left",valign:"top",fontSize:10,cellPadding:5/e,lineColor:200,lineWidth:0,cellWidth:"auto",minCellHeight:0,minCellWidth:0}}function DY(e){var t={striped:{table:{fillColor:255,textColor:80,fontStyle:"normal"},head:{textColor:255,fillColor:[41,128,185],fontStyle:"bold"},body:{},foot:{textColor:255,fillColor:[41,128,185],fontStyle:"bold"},alternateRow:{fillColor:245}},grid:{table:{fillColor:255,textColor:80,fontStyle:"normal",lineWidth:.1},head:{textColor:255,fillColor:[26,188,156],fontStyle:"bold",lineWidth:0},body:{},foot:{textColor:255,fillColor:[26,188,156],fontStyle:"bold",lineWidth:0},alternateRow:{}},plain:{head:{fontStyle:"bold"},foot:{fontStyle:"bold"}}};return t[e]}function W1(e,t,r){r.applyStyles(t,!0);var n=Array.isArray(e)?e:[e],a=n.map(function(i){return r.getTextWidth(i)}).reduce(function(i,s){return Math.max(i,s)},0);return a}function lC(e,t,r,n){var a=t.settings.tableLineWidth,i=t.settings.tableLineColor;e.applyStyles({lineWidth:a,lineColor:i});var s=cC(a,!1);s&&e.rect(r.x,r.y,t.getWidth(e.pageSize().width),n.y-r.y,s)}function cC(e,t){var r=e>0,n=t||t===0;return r&&n?"DF":r?"S":n?"F":null}function $m(e,t){var r,n,a,i;if(e=e||t,Array.isArray(e)){if(e.length>=4)return{top:e[0],right:e[1],bottom:e[2],left:e[3]};if(e.length===3)return{top:e[0],right:e[1],bottom:e[2],left:e[1]};if(e.length===2)return{top:e[0],right:e[1],bottom:e[0],left:e[1]};e.length===1?e=e[0]:e=t}return typeof e=="object"?(typeof e.vertical=="number"&&(e.top=e.vertical,e.bottom=e.vertical),typeof e.horizontal=="number"&&(e.right=e.horizontal,e.left=e.horizontal),{left:(r=e.left)!==null&&r!==void 0?r:t,top:(n=e.top)!==null&&n!==void 0?n:t,right:(a=e.right)!==null&&a!==void 0?a:t,bottom:(i=e.bottom)!==null&&i!==void 0?i:t}):(typeof e!="number"&&(e=t),{top:e,right:e,bottom:e,left:e})}function uC(e,t){var r=$m(t.settings.margin,0);return e.pageSize().width-(r.left+r.right)}function jY(e,t,r,n,a){var i={},s=1.3333333333333333,o=M2(t,function(w){return a.getComputedStyle(w).backgroundColor});o!=null&&(i.fillColor=o);var l=M2(t,function(w){return a.getComputedStyle(w).color});l!=null&&(i.textColor=l);var c=MY(n,r);c&&(i.cellPadding=c);var u="borderTopColor",f=s*r,d=n.borderTopWidth;if(n.borderBottomWidth===d&&n.borderRightWidth===d&&n.borderLeftWidth===d){var h=(parseFloat(d)||0)/f;h&&(i.lineWidth=h)}else i.lineWidth={top:(parseFloat(n.borderTopWidth)||0)/f,right:(parseFloat(n.borderRightWidth)||0)/f,bottom:(parseFloat(n.borderBottomWidth)||0)/f,left:(parseFloat(n.borderLeftWidth)||0)/f},i.lineWidth.top||(i.lineWidth.right?u="borderRightColor":i.lineWidth.bottom?u="borderBottomColor":i.lineWidth.left&&(u="borderLeftColor"));var g=M2(t,function(w){return a.getComputedStyle(w)[u]});g!=null&&(i.lineColor=g);var m=["left","right","center","justify"];m.indexOf(n.textAlign)!==-1&&(i.halign=n.textAlign),m=["middle","bottom","top"],m.indexOf(n.verticalAlign)!==-1&&(i.valign=n.verticalAlign);var _=parseInt(n.fontSize||"");isNaN(_)||(i.fontSize=_/s);var y=RY(n);y&&(i.fontStyle=y);var b=(n.fontFamily||"").toLowerCase();return e.indexOf(b)!==-1&&(i.font=b),i}function RY(e){var t="";return(e.fontWeight==="bold"||e.fontWeight==="bolder"||parseInt(e.fontWeight)>=700)&&(t="bold"),(e.fontStyle==="italic"||e.fontStyle==="oblique")&&(t+="italic"),t}function M2(e,t){var r=fC(e,t);if(!r)return null;var n=r.match(/^rgba?\((\d+),\s*(\d+),\s*(\d+)(?:,\s*(\d*\.?\d*))?\)$/);if(!n||!Array.isArray(n))return null;var a=[parseInt(n[1]),parseInt(n[2]),parseInt(n[3])],i=parseInt(n[4]);return i===0||isNaN(a[0])||isNaN(a[1])||isNaN(a[2])?null:a}function fC(e,t){var r=t(e);return r==="rgba(0, 0, 0, 0)"||r==="transparent"||r==="initial"||r==="inherit"?e.parentElement==null?null:fC(e.parentElement,t):r}function MY(e,t){var r=[e.paddingTop,e.paddingRight,e.paddingBottom,e.paddingLeft],n=96/(72/t),a=(parseInt(e.lineHeight)-parseInt(e.fontSize))/t/2,i=r.map(function(o){return parseInt(o||"0")/n}),s=$m(i,0);return a>s.top&&(s.top=a),a>s.bottom&&(s.bottom=a),s}function hC(e,t,r,n,a){var i,s;n===void 0&&(n=!1),a===void 0&&(a=!1);var o;typeof t=="string"?o=r.document.querySelector(t):o=t;var l=Object.keys(e.getFontList()),c=e.scaleFactor(),u=[],f=[],d=[];if(!o)return console.error("Html table could not be found with input: ",t),{head:u,body:f,foot:d};for(var h=0;h<o.rows.length;h++){var g=o.rows[h],m=(s=(i=g==null?void 0:g.parentElement)===null||i===void 0?void 0:i.tagName)===null||s===void 0?void 0:s.toLowerCase(),_=BY(l,c,r,g,n,a);_&&(m==="thead"?u.push(_):m==="tfoot"?d.push(_):f.push(_))}return{head:u,body:f,foot:d}}function BY(e,t,r,n,a,i){for(var s=new oC(n),o=0;o<n.cells.length;o++){var l=n.cells[o],c=r.getComputedStyle(l);if(a||c.display!=="none"){var u=void 0;i&&(u=jY(e,l,t,c,r)),s.push({rowSpan:l.rowSpan,colSpan:l.colSpan,styles:u,_element:l,content:UY(l)})}}var f=r.getComputedStyle(n);if(s.length>0&&(a||f.display!=="none"))return s}function UY(e){var t=e.cloneNode(!0);return t.innerHTML=t.innerHTML.replace(/\n/g,"").replace(/ +/g," "),t.innerHTML=t.innerHTML.split(/<br.*?>/).map(function(r){return r.trim()}).join(`
`),t.innerText||t.textContent||""}function $Y(e,t,r){for(var n=0,a=[e,t,r];n<a.length;n++){var i=a[n];i&&typeof i!="object"&&console.error("The options parameter should be of type object, is: "+typeof i),i.startY&&typeof i.startY!="number"&&(console.error("Invalid value for startY option",i.startY),delete i.startY)}}function Us(e,t,r,n,a){if(e==null)throw new TypeError("Cannot convert undefined or null to object");for(var i=Object(e),s=1;s<arguments.length;s++){var o=arguments[s];if(o!=null)for(var l in o)Object.prototype.hasOwnProperty.call(o,l)&&(i[l]=o[l])}return i}function dC(e,t){var r=new ju(e),n=r.getDocumentOptions(),a=r.getGlobalOptions();$Y(a,n,t);var i=Us({},a,n,t),s;typeof window<"u"&&(s=window);var o=VY(a,n,t),l=zY(a,n,t),c=HY(r,i),u=qY(r,i,s);return{id:t.tableId,content:u,hooks:l,styles:o,settings:c}}function VY(e,t,r){for(var n={styles:{},headStyles:{},bodyStyles:{},footStyles:{},alternateRowStyles:{},columnStyles:{}},a=function(l){if(l==="columnStyles"){var c=e[l],u=t[l],f=r[l];n.columnStyles=Us({},c,u,f)}else{var d=[e,t,r],h=d.map(function(g){return g[l]||{}});n[l]=Us({},h[0],h[1],h[2])}},i=0,s=Object.keys(n);i<s.length;i++){var o=s[i];a(o)}return n}function zY(e,t,r){for(var n=[e,t,r],a={didParseCell:[],willDrawCell:[],didDrawCell:[],willDrawPage:[],didDrawPage:[]},i=0,s=n;i<s.length;i++){var o=s[i];o.didParseCell&&a.didParseCell.push(o.didParseCell),o.willDrawCell&&a.willDrawCell.push(o.willDrawCell),o.didDrawCell&&a.didDrawCell.push(o.didDrawCell),o.willDrawPage&&a.willDrawPage.push(o.willDrawPage),o.didDrawPage&&a.didDrawPage.push(o.didDrawPage)}return a}function HY(e,t){var r,n,a,i,s,o,l,c,u,f,d,h,g=$m(t.margin,40/e.scaleFactor()),m=(r=WY(e,t.startY))!==null&&r!==void 0?r:g.top,_;t.showFoot===!0?_="everyPage":t.showFoot===!1?_="never":_=(n=t.showFoot)!==null&&n!==void 0?n:"everyPage";var y;t.showHead===!0?y="everyPage":t.showHead===!1?y="never":y=(a=t.showHead)!==null&&a!==void 0?a:"everyPage";var b=(i=t.useCss)!==null&&i!==void 0?i:!1,w=t.theme||(b?"plain":"striped"),T=!!t.horizontalPageBreak,F=(s=t.horizontalPageBreakRepeat)!==null&&s!==void 0?s:null;return{includeHiddenHtml:(o=t.includeHiddenHtml)!==null&&o!==void 0?o:!1,useCss:b,theme:w,startY:m,margin:g,pageBreak:(l=t.pageBreak)!==null&&l!==void 0?l:"auto",rowPageBreak:(c=t.rowPageBreak)!==null&&c!==void 0?c:"auto",tableWidth:(u=t.tableWidth)!==null&&u!==void 0?u:"auto",showHead:y,showFoot:_,tableLineWidth:(f=t.tableLineWidth)!==null&&f!==void 0?f:0,tableLineColor:(d=t.tableLineColor)!==null&&d!==void 0?d:200,horizontalPageBreak:T,horizontalPageBreakRepeat:F,horizontalPageBreakBehaviour:(h=t.horizontalPageBreakBehaviour)!==null&&h!==void 0?h:"afterAllRows"}}function WY(e,t){var r=e.getLastAutoTable(),n=e.scaleFactor(),a=e.pageNumber(),i=!1;if(r&&r.startPageNumber){var s=r.startPageNumber+r.pageNumber-1;i=s===a}return typeof t=="number"?t:(t==null||t===!1)&&i&&(r==null?void 0:r.finalY)!=null?r.finalY+20/n:null}function qY(e,t,r){var n=t.head||[],a=t.body||[],i=t.foot||[];if(t.html){var s=t.includeHiddenHtml;if(r){var o=hC(e,t.html,r,s,t.useCss)||{};n=o.head||n,a=o.body||n,i=o.foot||n}else console.error("Cannot parse html in non browser environment")}var l=t.columns||GY(n,a,i);return{columns:l,head:n,body:a,foot:i}}function GY(e,t,r){var n=e[0]||t[0]||r[0]||[],a=[];return Object.keys(n).filter(function(i){return i!=="_element"}).forEach(function(i){var s=1,o;Array.isArray(n)?o=n[parseInt(i)]:o=n[i],typeof o=="object"&&!Array.isArray(o)&&(s=(o==null?void 0:o.colSpan)||1);for(var l=0;l<s;l++){var c=void 0;Array.isArray(n)?c=a.length:c=i+(l>0?"_".concat(l):"");var u={dataKey:c};a.push(u)}}),a}var jv=function(){function e(t,r,n){this.table=r,this.pageNumber=r.pageNumber,this.settings=r.settings,this.cursor=n,this.doc=t.getDocument()}return e}(),KY=function(e){sC(t,e);function t(r,n,a,i,s,o){var l=e.call(this,r,n,o)||this;return l.cell=a,l.row=i,l.column=s,l.section=i.section,l}return t}(jv),XY=function(){function e(t,r){this.pageNumber=1,this.id=t.id,this.settings=t.settings,this.styles=t.styles,this.hooks=t.hooks,this.columns=r.columns,this.head=r.head,this.body=r.body,this.foot=r.foot}return e.prototype.getHeadHeight=function(t){return this.head.reduce(function(r,n){return r+n.getMaxCellHeight(t)},0)},e.prototype.getFootHeight=function(t){return this.foot.reduce(function(r,n){return r+n.getMaxCellHeight(t)},0)},e.prototype.allRows=function(){return this.head.concat(this.body).concat(this.foot)},e.prototype.callCellHooks=function(t,r,n,a,i,s){for(var o=0,l=r;o<l.length;o++){var c=l[o],u=new KY(t,this,n,a,i,s),f=c(u)===!1;if(n.text=Array.isArray(n.text)?n.text:[n.text],f)return!1}return!0},e.prototype.callEndPageHooks=function(t,r){t.applyStyles(t.userStyles);for(var n=0,a=this.hooks.didDrawPage;n<a.length;n++){var i=a[n];i(new jv(t,this,r))}},e.prototype.callWillDrawPageHooks=function(t,r){for(var n=0,a=this.hooks.willDrawPage;n<a.length;n++){var i=a[n];i(new jv(t,this,r))}},e.prototype.getWidth=function(t){if(typeof this.settings.tableWidth=="number")return this.settings.tableWidth;if(this.settings.tableWidth==="wrap"){var r=this.columns.reduce(function(a,i){return a+i.wrappedWidth},0);return r}else{var n=this.settings.margin;return t-n.left-n.right}},e}(),pC=function(){function e(t,r,n,a,i){i===void 0&&(i=!1),this.height=0,this.raw=t,t instanceof oC&&(this.raw=t._element,this.element=t._element),this.index=r,this.section=n,this.cells=a,this.spansMultiplePages=i}return e.prototype.getMaxCellHeight=function(t){var r=this;return t.reduce(function(n,a){var i;return Math.max(n,((i=r.cells[a.index])===null||i===void 0?void 0:i.height)||0)},0)},e.prototype.hasRowSpan=function(t){var r=this;return t.filter(function(n){var a=r.cells[n.index];return a?a.rowSpan>1:!1}).length>0},e.prototype.canEntireRowFit=function(t,r){return this.getMaxCellHeight(r)<=t},e.prototype.getMinimumRowHeight=function(t,r){var n=this;return t.reduce(function(a,i){var s=n.cells[i.index];if(!s)return 0;var o=r.getLineHeight(s.styles.fontSize),l=s.padding("vertical"),c=l+o;return c>a?c:a},0)},e}(),mC=function(){function e(t,r,n){var a;this.contentHeight=0,this.contentWidth=0,this.wrappedWidth=0,this.minReadableWidth=0,this.minWidth=0,this.width=0,this.height=0,this.x=0,this.y=0,this.styles=r,this.section=n,this.raw=t;var i=t;t!=null&&typeof t=="object"&&!Array.isArray(t)?(this.rowSpan=t.rowSpan||1,this.colSpan=t.colSpan||1,i=(a=t.content)!==null&&a!==void 0?a:t,t._element&&(this.raw=t._element)):(this.rowSpan=1,this.colSpan=1);var s=i!=null?""+i:"",o=/\r\n|\r|\n/g;this.text=s.split(o)}return e.prototype.getTextPos=function(){var t;if(this.styles.valign==="top")t=this.y+this.padding("top");else if(this.styles.valign==="bottom")t=this.y+this.height-this.padding("bottom");else{var r=this.height-this.padding("vertical");t=this.y+r/2+this.padding("top")}var n;if(this.styles.halign==="right")n=this.x+this.width-this.padding("right");else if(this.styles.halign==="center"){var a=this.width-this.padding("horizontal");n=this.x+a/2+this.padding("left")}else n=this.x+this.padding("left");return{x:n,y:t}},e.prototype.getContentHeight=function(t,r){r===void 0&&(r=1.15);var n=Array.isArray(this.text)?this.text.length:1,a=this.styles.fontSize/t*r,i=n*a+this.padding("vertical");return Math.max(i,this.styles.minCellHeight)},e.prototype.padding=function(t){var r=$m(this.styles.cellPadding,0);return t==="vertical"?r.top+r.bottom:t==="horizontal"?r.left+r.right:r[t]},e}(),YY=function(){function e(t,r,n){this.wrappedWidth=0,this.minReadableWidth=0,this.minWidth=0,this.width=0,this.dataKey=t,this.raw=r,this.index=n}return e.prototype.getMaxCustomCellWidth=function(t){for(var r=0,n=0,a=t.allRows();n<a.length;n++){var i=a[n],s=i.cells[this.index];s&&typeof s.styles.cellWidth=="number"&&(r=Math.max(r,s.styles.cellWidth))}return r},e}();function JY(e,t){QY(e,t);var r=[],n=0;t.columns.forEach(function(i){var s=i.getMaxCustomCellWidth(t);s?i.width=s:(i.width=i.wrappedWidth,r.push(i)),n+=i.width});var a=t.getWidth(e.pageSize().width)-n;a&&(a=Rv(r,a,function(i){return Math.max(i.minReadableWidth,i.minWidth)})),a&&(a=Rv(r,a,function(i){return i.minWidth})),a=Math.abs(a),!t.settings.horizontalPageBreak&&a>.1/e.scaleFactor()&&(a=a<1?a:Math.round(a),console.warn("Of the table content, ".concat(a," units width could not fit page"))),eJ(t),tJ(t,e),ZY(t)}function QY(e,t){var r=e.scaleFactor(),n=t.settings.horizontalPageBreak,a=uC(e,t);t.allRows().forEach(function(i){for(var s=0,o=t.columns;s<o.length;s++){var l=o[s],c=i.cells[l.index];if(c){var u=t.hooks.didParseCell;t.callCellHooks(e,u,c,i,l,null);var f=c.padding("horizontal");c.contentWidth=W1(c.text,c.styles,e)+f;var d=W1(c.text.join(" ").split(/[^\S\u00A0]+/),c.styles,e);if(c.minReadableWidth=d+c.padding("horizontal"),typeof c.styles.cellWidth=="number")c.minWidth=c.styles.cellWidth,c.wrappedWidth=c.styles.cellWidth;else if(c.styles.cellWidth==="wrap"||n===!0)c.contentWidth>a?(c.minWidth=a,c.wrappedWidth=a):(c.minWidth=c.contentWidth,c.wrappedWidth=c.contentWidth);else{var h=10/r;c.minWidth=c.styles.minCellWidth||h,c.wrappedWidth=c.contentWidth,c.minWidth>c.wrappedWidth&&(c.wrappedWidth=c.minWidth)}}}}),t.allRows().forEach(function(i){for(var s=0,o=t.columns;s<o.length;s++){var l=o[s],c=i.cells[l.index];if(c&&c.colSpan===1)l.wrappedWidth=Math.max(l.wrappedWidth,c.wrappedWidth),l.minWidth=Math.max(l.minWidth,c.minWidth),l.minReadableWidth=Math.max(l.minReadableWidth,c.minReadableWidth);else{var u=t.styles.columnStyles[l.dataKey]||t.styles.columnStyles[l.index]||{},f=u.cellWidth||u.minCellWidth;f&&typeof f=="number"&&(l.minWidth=f,l.wrappedWidth=f)}c&&(c.colSpan>1&&!l.minWidth&&(l.minWidth=c.minWidth),c.colSpan>1&&!l.wrappedWidth&&(l.wrappedWidth=c.minWidth))}})}function Rv(e,t,r){for(var n=t,a=e.reduce(function(h,g){return h+g.wrappedWidth},0),i=0;i<e.length;i++){var s=e[i],o=s.wrappedWidth/a,l=n*o,c=s.width+l,u=r(s),f=c<u?u:c;t-=f-s.width,s.width=f}if(t=Math.round(t*1e10)/1e10,t){var d=e.filter(function(h){return t<0?h.width>r(h):!0});d.length&&(t=Rv(d,t,r))}return t}function ZY(e){for(var t={},r=1,n=e.allRows(),a=0;a<n.length;a++)for(var i=n[a],s=0,o=e.columns;s<o.length;s++){var l=o[s],c=t[l.index];if(r>1)r--,delete i.cells[l.index];else if(c)c.cell.height+=i.height,r=c.cell.colSpan,delete i.cells[l.index],c.left--,c.left<=1&&delete t[l.index];else{var u=i.cells[l.index];if(!u)continue;if(u.height=i.height,u.rowSpan>1){var f=n.length-a,d=u.rowSpan>f?f:u.rowSpan;t[l.index]={cell:u,left:d,row:i}}}}}function eJ(e){for(var t=e.allRows(),r=0;r<t.length;r++)for(var n=t[r],a=null,i=0,s=0,o=0;o<e.columns.length;o++){var l=e.columns[o];if(s-=1,s>1&&e.columns[o+1])i+=l.width,delete n.cells[l.index];else if(a){var c=a;delete n.cells[l.index],a=null,c.width=l.width+i}else{var c=n.cells[l.index];if(!c)continue;if(s=c.colSpan,i=0,c.colSpan>1){a=c,i+=l.width;continue}c.width=l.width+i}}}function tJ(e,t){for(var r={count:0,height:0},n=0,a=e.allRows();n<a.length;n++){for(var i=a[n],s=0,o=e.columns;s<o.length;s++){var l=o[s],c=i.cells[l.index];if(c){t.applyStyles(c.styles,!0);var u=c.width-c.padding("horizontal");if(c.styles.overflow==="linebreak")c.text=t.splitTextToSize(c.text,u+1/t.scaleFactor(),{fontSize:c.styles.fontSize});else if(c.styles.overflow==="ellipsize")c.text=G_(c.text,u,c.styles,t,"...");else if(c.styles.overflow==="hidden")c.text=G_(c.text,u,c.styles,t,"");else if(typeof c.styles.overflow=="function"){var f=c.styles.overflow(c.text,u);typeof f=="string"?c.text=[f]:c.text=f}c.contentHeight=c.getContentHeight(t.scaleFactor(),t.getLineHeightFactor());var d=c.contentHeight/c.rowSpan;c.rowSpan>1&&r.count*r.height<d*c.rowSpan?r={height:d,count:c.rowSpan}:r&&r.count>0&&r.height>d&&(d=r.height),d>i.height&&(i.height=d)}}r.count--}}function G_(e,t,r,n,a){return e.map(function(i){return rJ(i,t,r,n,a)})}function rJ(e,t,r,n,a){var i=1e4*n.scaleFactor();if(t=Math.ceil(t*i)/i,t>=W1(e,r,n))return e;for(;t<W1(e+a,r,n)&&!(e.length<=1);)e=e.substring(0,e.length-1);return e.trim()+a}function gC(e,t){var r=new ju(e),n=nJ(t,r.scaleFactor()),a=new XY(t,n);return JY(r,a),r.applyStyles(r.userStyles),a}function nJ(e,t){var r=e.content,n=iJ(r.columns);if(r.head.length===0){var a=K_(n,"head");a&&r.head.push(a)}if(r.foot.length===0){var a=K_(n,"foot");a&&r.foot.push(a)}var i=e.settings.theme,s=e.styles;return{columns:n,head:B2("head",r.head,n,s,i,t),body:B2("body",r.body,n,s,i,t),foot:B2("foot",r.foot,n,s,i,t)}}function B2(e,t,r,n,a,i){var s={},o=t.map(function(l,c){for(var u=0,f={},d=0,h=0,g=0,m=r;g<m.length;g++){var _=m[g];if(s[_.index]==null||s[_.index].left===0)if(h===0){var y=void 0;Array.isArray(l)?y=l[_.index-d-u]:y=l[_.dataKey];var b={};typeof y=="object"&&!Array.isArray(y)&&(b=(y==null?void 0:y.styles)||{});var w=sJ(e,_,c,a,n,i,b),T=new mC(y,w,e);f[_.dataKey]=T,f[_.index]=T,h=T.colSpan-1,s[_.index]={left:T.rowSpan-1,times:h}}else h--,d++;else s[_.index].left--,h=s[_.index].times,u++}return new pC(l,c,e,f)});return o}function K_(e,t){var r={};return e.forEach(function(n){if(n.raw!=null){var a=aJ(t,n.raw);a!=null&&(r[n.dataKey]=a)}}),Object.keys(r).length>0?r:null}function aJ(e,t){if(e==="head"){if(typeof t=="object")return t.header||null;if(typeof t=="string"||typeof t=="number")return t}else if(e==="foot"&&typeof t=="object")return t.footer;return null}function iJ(e){return e.map(function(t,r){var n,a;return typeof t=="object"?a=(n=t.dataKey)!==null&&n!==void 0?n:r:a=r,new YY(a,t,r)})}function sJ(e,t,r,n,a,i,s){var o=DY(n),l;e==="head"?l=a.headStyles:e==="body"?l=a.bodyStyles:e==="foot"&&(l=a.footStyles);var c=Us({},o.table,o[e],a.styles,l),u=a.columnStyles[t.dataKey]||a.columnStyles[t.index]||{},f=e==="body"?u:{},d=e==="body"&&r%2===0?Us({},o.alternateRow,a.alternateRowStyles):{},h=IY(i),g=Us({},h,c,d,f);return Us(g,s)}function oJ(e,t,r){var n;r===void 0&&(r={});var a=uC(e,t),i=new Map,s=[],o=[],l=[];Array.isArray(t.settings.horizontalPageBreakRepeat)?l=t.settings.horizontalPageBreakRepeat:(typeof t.settings.horizontalPageBreakRepeat=="string"||typeof t.settings.horizontalPageBreakRepeat=="number")&&(l=[t.settings.horizontalPageBreakRepeat]),l.forEach(function(d){var h=t.columns.find(function(g){return g.dataKey===d||g.index===d});h&&!i.has(h.index)&&(i.set(h.index,!0),s.push(h.index),o.push(t.columns[h.index]),a-=h.wrappedWidth)});for(var c=!0,u=(n=r==null?void 0:r.start)!==null&&n!==void 0?n:0;u<t.columns.length;){if(i.has(u)){u++;continue}var f=t.columns[u].wrappedWidth;if(c||a>=f)c=!1,s.push(u),o.push(t.columns[u]),a-=f;else break;u++}return{colIndexes:s,columns:o,lastIndex:u-1}}function lJ(e,t){for(var r=[],n=0;n<t.columns.length;n++){var a=oJ(e,t,{start:n});a.columns.length&&(r.push(a),n=a.lastIndex)}return r}function xC(e,t){var r=t.settings,n=r.startY,a=r.margin,i={x:a.left,y:n},s=t.getHeadHeight(t.columns)+t.getFootHeight(t.columns),o=n+a.bottom+s;if(r.pageBreak==="avoid"){var l=t.body,c=l.reduce(function(d,h){return d+h.height},0);o+=c}var u=new ju(e);(r.pageBreak==="always"||r.startY!=null&&o>u.pageSize().height)&&(yC(u),i.y=a.top),t.callWillDrawPageHooks(u,i);var f=Us({},i);t.startPageNumber=u.pageNumber(),r.horizontalPageBreak?cJ(u,t,f,i):(u.applyStyles(u.userStyles),(r.showHead==="firstPage"||r.showHead==="everyPage")&&t.head.forEach(function(d){return to(u,t,d,i,t.columns)}),u.applyStyles(u.userStyles),t.body.forEach(function(d,h){var g=h===t.body.length-1;q1(u,t,d,g,f,i,t.columns)}),u.applyStyles(u.userStyles),(r.showFoot==="lastPage"||r.showFoot==="everyPage")&&t.foot.forEach(function(d){return to(u,t,d,i,t.columns)})),lC(u,t,f,i),t.callEndPageHooks(u,i),t.finalY=i.y,e.lastAutoTable=t,u.applyStyles(u.userStyles)}function cJ(e,t,r,n){var a=lJ(e,t),i=t.settings;if(i.horizontalPageBreakBehaviour==="afterAllRows")a.forEach(function(c,u){e.applyStyles(e.userStyles),u>0?Bf(e,t,r,n,c.columns,!0):X_(e,t,n,c.columns),uJ(e,t,r,n,c.columns),U2(e,t,n,c.columns)});else for(var s=-1,o=a[0],l=function(){var c=s;if(o){e.applyStyles(e.userStyles);var u=o.columns;s>=0?Bf(e,t,r,n,u,!0):X_(e,t,n,u),c=Y_(e,t,s+1,n,u),U2(e,t,n,u)}var f=c-s;a.slice(1).forEach(function(d){e.applyStyles(e.userStyles),Bf(e,t,r,n,d.columns,!0),Y_(e,t,s+1,n,d.columns,f),U2(e,t,n,d.columns)}),s=c};s<t.body.length-1;)l()}function X_(e,t,r,n){var a=t.settings;e.applyStyles(e.userStyles),(a.showHead==="firstPage"||a.showHead==="everyPage")&&t.head.forEach(function(i){return to(e,t,i,r,n)})}function uJ(e,t,r,n,a){e.applyStyles(e.userStyles),t.body.forEach(function(i,s){var o=s===t.body.length-1;q1(e,t,i,o,r,n,a)})}function Y_(e,t,r,n,a,i){e.applyStyles(e.userStyles),i=i??t.body.length;var s=Math.min(r+i,t.body.length),o=-1;return t.body.slice(r,s).forEach(function(l,c){var u=r+c===t.body.length-1,f=vC(e,t,u,n);l.canEntireRowFit(f,a)&&(to(e,t,l,n,a),o=r+c)}),o}function U2(e,t,r,n){var a=t.settings;e.applyStyles(e.userStyles),(a.showFoot==="lastPage"||a.showFoot==="everyPage")&&t.foot.forEach(function(i){return to(e,t,i,r,n)})}function fJ(e,t,r){var n=r.getLineHeight(e.styles.fontSize),a=e.padding("vertical"),i=Math.floor((t-a)/n);return Math.max(0,i)}function hJ(e,t,r,n){var a={};e.spansMultiplePages=!0,e.height=0;for(var i=0,s=0,o=r.columns;s<o.length;s++){var l=o[s],c=e.cells[l.index];if(c){Array.isArray(c.text)||(c.text=[c.text]);var u=new mC(c.raw,c.styles,c.section);u=Us(u,c),u.text=[];var f=fJ(c,t,n);c.text.length>f&&(u.text=c.text.splice(f,c.text.length));var d=n.scaleFactor(),h=n.getLineHeightFactor();c.contentHeight=c.getContentHeight(d,h),c.contentHeight>=t&&(c.contentHeight=t,u.styles.minCellHeight-=t),c.contentHeight>e.height&&(e.height=c.contentHeight),u.contentHeight=u.getContentHeight(d,h),u.contentHeight>i&&(i=u.contentHeight),a[l.index]=u}}var g=new pC(e.raw,-1,e.section,a,!0);g.height=i;for(var m=0,_=r.columns;m<_.length;m++){var l=_[m],u=g.cells[l.index];u&&(u.height=g.height);var c=e.cells[l.index];c&&(c.height=e.height)}return g}function dJ(e,t,r,n){var a=e.pageSize().height,i=n.settings.margin,s=i.top+i.bottom,o=a-s;t.section==="body"&&(o-=n.getHeadHeight(n.columns)+n.getFootHeight(n.columns));var l=t.getMinimumRowHeight(n.columns,e),c=l<r;if(l>o)return console.error("Will not be able to print row ".concat(t.index," correctly since it's minimum height is larger than page height")),!0;if(!c)return!1;var u=t.hasRowSpan(n.columns),f=t.getMaxCellHeight(n.columns)>o;return f?(u&&console.error("The content of row ".concat(t.index," will not be drawn correctly since drawing rows with a height larger than the page height and has cells with rowspans is not supported.")),!0):!(u||n.settings.rowPageBreak==="avoid")}function q1(e,t,r,n,a,i,s){var o=vC(e,t,n,i);if(r.canEntireRowFit(o,s))to(e,t,r,i,s);else if(dJ(e,r,o,t)){var l=hJ(r,o,t,e);to(e,t,r,i,s),Bf(e,t,a,i,s),q1(e,t,l,n,a,i,s)}else Bf(e,t,a,i,s),q1(e,t,r,n,a,i,s)}function to(e,t,r,n,a){n.x=t.settings.margin.left;for(var i=0,s=a;i<s.length;i++){var o=s[i],l=r.cells[o.index];if(!l){n.x+=o.width;continue}e.applyStyles(l.styles),l.x=n.x,l.y=n.y;var c=t.callCellHooks(e,t.hooks.willDrawCell,l,r,o,n);if(c===!1){n.x+=o.width;continue}pJ(e,l,n);var u=l.getTextPos();iC(l.text,u.x,u.y,{halign:l.styles.halign,valign:l.styles.valign,maxWidth:Math.ceil(l.width-l.padding("left")-l.padding("right"))},e.getDocument()),t.callCellHooks(e,t.hooks.didDrawCell,l,r,o,n),n.x+=o.width}n.y+=r.height}function pJ(e,t,r){var n=t.styles;if(e.getDocument().setFillColor(e.getDocument().getFillColor()),typeof n.lineWidth=="number"){var a=cC(n.lineWidth,n.fillColor);a&&e.rect(t.x,r.y,t.width,t.height,a)}else typeof n.lineWidth=="object"&&(n.fillColor&&e.rect(t.x,r.y,t.width,t.height,"F"),mJ(e,t,r,n.lineWidth))}function mJ(e,t,r,n){var a,i,s,o;n.top&&(a=r.x,i=r.y,s=r.x+t.width,o=r.y,n.right&&(s+=.5*n.right),n.left&&(a-=.5*n.left),l(n.top,a,i,s,o)),n.bottom&&(a=r.x,i=r.y+t.height,s=r.x+t.width,o=r.y+t.height,n.right&&(s+=.5*n.right),n.left&&(a-=.5*n.left),l(n.bottom,a,i,s,o)),n.left&&(a=r.x,i=r.y,s=r.x,o=r.y+t.height,n.top&&(i-=.5*n.top),n.bottom&&(o+=.5*n.bottom),l(n.left,a,i,s,o)),n.right&&(a=r.x+t.width,i=r.y,s=r.x+t.width,o=r.y+t.height,n.top&&(i-=.5*n.top),n.bottom&&(o+=.5*n.bottom),l(n.right,a,i,s,o));function l(c,u,f,d,h){e.getDocument().setLineWidth(c),e.getDocument().line(u,f,d,h,"S")}}function vC(e,t,r,n){var a=t.settings.margin.bottom,i=t.settings.showFoot;return(i==="everyPage"||i==="lastPage"&&r)&&(a+=t.getFootHeight(t.columns)),e.pageSize().height-n.y-a}function Bf(e,t,r,n,a,i){a===void 0&&(a=[]),i===void 0&&(i=!1),e.applyStyles(e.userStyles),t.settings.showFoot==="everyPage"&&!i&&t.foot.forEach(function(o){return to(e,t,o,n,a)}),t.callEndPageHooks(e,n);var s=t.settings.margin;lC(e,t,r,n),yC(e),t.pageNumber++,n.x=s.left,n.y=s.top,r.y=s.top,t.callWillDrawPageHooks(e,n),t.settings.showHead==="everyPage"&&(t.head.forEach(function(o){return to(e,t,o,n,a)}),e.applyStyles(e.userStyles))}function yC(e){var t=e.pageNumber();e.setPage(t+1);var r=e.pageNumber();return r===t?(e.addPage(),!0):!1}function gJ(e){e.API.autoTable=function(){for(var t=[],r=0;r<arguments.length;r++)t[r]=arguments[r];var n=t[0],a=dC(this,n),i=gC(this,a);return xC(this,i),this},e.API.lastAutoTable=!1,e.API.autoTableText=function(t,r,n,a){iC(t,r,n,a,this)},e.API.autoTableSetDefaults=function(t){return ju.setDefaults(t,this),this},e.autoTableSetDefaults=function(t,r){ju.setDefaults(t,r)},e.API.autoTableHtmlToJson=function(t,r){var n;if(r===void 0&&(r=!1),typeof window>"u")return console.error("Cannot run autoTableHtmlToJson in non browser environment"),null;var a=new ju(this),i=hC(a,t,window,r,!1),s=i.head,o=i.body,l=((n=s[0])===null||n===void 0?void 0:n.map(function(c){return c.content}))||[];return{columns:l,rows:o,data:o}}}var $2;function xJ(e,t){var r=dC(e,t),n=gC(e,r);xC(e,n)}try{if(typeof window<"u"&&window){var J_=window,Q_=J_.jsPDF||(($2=J_.jspdf)===null||$2===void 0?void 0:$2.jsPDF);Q_&&gJ(Q_)}}catch(e){console.error("Could not apply autoTable plugin",e)}const Z_=["Todos los meses","Enero","Febrero","Marzo","Abril","Mayo","Junio","Julio","Agosto","Septiembre","Octubre","Noviembre","Diciembre"],Mv=new Date().getFullYear(),vJ=Array.from({length:Mv-2022},(e,t)=>2023+t),yJ=()=>{const{articles:e,movements:t}=ps(),[r,n]=ie.useState(""),[a,i]=ie.useState(0),[s,o]=ie.useState(Mv),l=ie.useMemo(()=>e.map(h=>{const g=t.filter(w=>w.id_articulo===h.id),m=g.filter(w=>{if(w.tipo!=="Salida")return!1;const T=new Date(w.fecha);return s===0?!0:a===0?T.getFullYear()===s:T.getFullYear()===s&&T.getMonth()+1===a}).reduce((w,T)=>w+T.cantidad*h.costo,0),_=s===0?g.filter(w=>w.tipo==="Salida").reduce((w,T)=>w+T.cantidad*h.costo,0):g.filter(w=>w.tipo==="Salida"&&new Date(w.fecha).getFullYear()===s).reduce((w,T)=>w+T.cantidad*h.costo,0),y=g.filter(w=>{const T=new Date(w.fecha);return s===0?!0:a===0?T.getFullYear()<=s:T.getFullYear()<s||T.getFullYear()===s&&T.getMonth()+1<=a}).reduce((w,T)=>w+(T.tipo==="Entrada"?T.cantidad:-T.cantidad),0),b=y*h.costo;return{...h,consumo:m,consumoAnual:_,existencias:y,saldo:b}}).filter(h=>!r||h.nombre.toLowerCase().includes(r.toLowerCase())),[e,t,r,a,s]),c=()=>{const h=["Artculo","Consumo","Existencias","Costo","Saldo"],g=l.map(_=>[_.nombre,_.consumo.toLocaleString("es-ES",{minimumFractionDigits:2}),_.existencias.toString(),ft(_.costo),ft(_.saldo)]),m=Lm(h,g);Fm(m,"papeleria_nueva.csv")},u=()=>{const h=["Artculo","Consumo","Existencias","Costo","Saldo"],g=l.map(w=>[w.nombre,w.consumo.toLocaleString("es-ES",{minimumFractionDigits:2}),w.existencias.toString(),ft(w.costo),ft(w.saldo)]),m=new vt;m.text("Papelera Nueva",14,14),xJ(m,{head:[h],body:g,startY:20,styles:{font:"helvetica",fontSize:10},headStyles:{fillColor:[240,240,240],textColor:0}}),m.save("papeleria_nueva.pdf");const _=`<table><thead><tr>${h.map(w=>`<th>${w}</th>`).join("")}</tr></thead><tbody>${g.map(w=>`<tr>${w.map(T=>`<td>${T}</td>`).join("")}</tr>`).join("")}</tbody></table>`,y=Gl("Papelera Nueva",_,{articleId:r||void 0,dateFrom:a&&s?`${Z_[a]} ${s}`:void 0}),b=window.open("","_blank");b&&(b.document.write(y),b.document.close(),b.focus(),setTimeout(()=>b.print(),500))},f=()=>{u()},d=()=>{n(""),i(0),o(Mv)};return v.jsxs("div",{className:"p-8",children:[v.jsx("h1",{className:"text-2xl font-bold mb-6",children:"Papelera Nueva"}),v.jsxs("div",{className:"flex flex-wrap gap-4 mb-4 items-end",children:[v.jsxs("select",{className:"border rounded px-2 py-1",value:r,onChange:h=>n(h.target.value),children:[v.jsx("option",{value:"",children:"Todos los artculos"}),e.map(h=>v.jsx("option",{value:h.nombre,children:h.nombre},h.id))]}),v.jsx("select",{className:"border rounded px-2 py-1",value:a,onChange:h=>i(Number(h.target.value)),children:Z_.map((h,g)=>v.jsx("option",{value:g,children:h},g))}),v.jsxs("select",{className:"border rounded px-2 py-1",value:s,onChange:h=>o(Number(h.target.value)),children:[v.jsx("option",{value:0,children:"Todos los aos"}),vJ.map(h=>v.jsx("option",{value:h,children:h},h))]}),v.jsxs("div",{className:"flex gap-2 ml-auto",children:[v.jsx("button",{onClick:f,className:"bg-gray-200 px-3 py-1 rounded hover:bg-gray-300",children:"Imprimir"}),v.jsx("button",{onClick:u,className:"bg-gray-200 px-3 py-1 rounded hover:bg-gray-300",children:"Exportar PDF"}),v.jsx("button",{onClick:c,className:"bg-blue-600 text-white px-3 py-1 rounded hover:bg-blue-700",children:"Exportar CSV"}),v.jsx("button",{onClick:d,className:"bg-red-100 text-red-700 px-3 py-1 rounded hover:bg-red-200",children:"Limpiar filtros"})]})]}),v.jsx("div",{className:"overflow-x-auto",children:v.jsxs("table",{className:"min-w-full border",children:[v.jsx("thead",{children:v.jsxs("tr",{className:"bg-gray-100",children:[v.jsx("th",{className:"px-4 py-2 text-left",children:"Artculo"}),v.jsx("th",{className:"px-4 py-2 text-right",children:"Consumo"}),v.jsx("th",{className:"px-4 py-2 text-right",children:"Consumo anual"}),v.jsx("th",{className:"px-4 py-2 text-right",children:"Existencias"}),v.jsx("th",{className:"px-4 py-2 text-right",children:"Costo"}),v.jsx("th",{className:"px-4 py-2 text-right",children:"Saldo"})]})}),v.jsx("tbody",{children:l.map(h=>v.jsxs("tr",{className:"border-t",children:[v.jsx("td",{className:"px-4 py-2",children:h.nombre}),v.jsx("td",{className:"px-4 py-2 text-right",children:h.consumo.toLocaleString("es-ES",{minimumFractionDigits:2})}),v.jsx("td",{className:"px-4 py-2 text-right",children:h.consumoAnual.toLocaleString("es-ES",{minimumFractionDigits:2})}),v.jsx("td",{className:"px-4 py-2 text-right",children:h.existencias}),v.jsx("td",{className:"px-4 py-2 text-right",children:ft(h.costo)}),v.jsx("td",{className:"px-4 py-2 text-right",children:ft(h.saldo)})]},h.id))})]})})]})},wJ=()=>{const[e,t]=ie.useState([]),[r,n]=ie.useState(!0),[a,i]=ie.useState(null),[s,o]=ie.useState(!1),[l,c]=ie.useState(null),[u,f]=ie.useState(null),[d,h]=ie.useState(!1),g={username:"",full_name:"",email:"",role:"user",active:!0,password:"",confirm:""},[m,_]=ie.useState({...g});ie.useEffect(()=>{(async()=>{try{n(!0),i(null);const{data:P,error:j}=await ir.from("usuarios").select("id, username, role, full_name, email, active, last_login, created_at").order("role",{ascending:!1});if(j)throw j;t(P||[])}catch(P){console.error("Error al cargar usuarios:",P),i(P.message||"Error al cargar usuarios")}finally{n(!1)}})()},[]);const y=async()=>{try{n(!0);const{data:A,error:P}=await ir.from("usuarios").select("id, username, role, full_name, email, active, last_login, created_at").order("role",{ascending:!1});if(P)throw P;t(A||[])}catch(A){st.error(A.message||"Error al recargar usuarios")}finally{n(!1)}},b=()=>{_({...g}),o(!0)},w=A=>{_({username:A.username,full_name:A.full_name||"",email:A.email||"",role:A.role,active:!!A.active,password:"",confirm:""}),c(A)},T=async()=>{try{if(!m.username||!m.password){st.error("Usuario y contrasea son obligatorios");return}if(m.password!==m.confirm){st.error("Las contraseas no coinciden");return}h(!0);const A=await qx.hash(m.password,10),{error:P}=await ir.from("usuarios").insert({username:m.username,password_hash:A,role:m.role,full_name:m.full_name||null,email:m.email||null,active:m.active});if(P)throw P;st.success("Usuario creado"),o(!1),await y()}catch(A){st.error(A.message||"Error al crear usuario")}finally{h(!1)}},F=async()=>{if(l)try{h(!0);const A={username:m.username,role:m.role,full_name:m.full_name||null,email:m.email||null,active:m.active};if(m.password){if(m.password!==m.confirm){st.error("Las contraseas no coinciden"),h(!1);return}A.password_hash=await qx.hash(m.password,10)}const{error:P}=await ir.from("usuarios").update(A).eq("id",l.id);if(P)throw P;st.success("Usuario actualizado"),c(null),await y()}catch(A){st.error(A.message||"Error al actualizar usuario")}finally{h(!1)}},I=async()=>{if(u)try{h(!0);const{error:A}=await ir.from("usuarios").delete().eq("id",u.id);if(A)throw A;st.success("Usuario eliminado"),f(null),await y()}catch(A){st.error(A.message||"Error al eliminar usuario")}finally{h(!1)}};return r?v.jsx("div",{className:"flex justify-center items-center p-8",children:v.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-t-2 border-b-2 border-blue-500"})}):a?v.jsxs("div",{className:"bg-red-100 border-l-4 border-red-500 text-red-700 p-4 rounded shadow-md my-4",children:[v.jsx("p",{className:"font-bold",children:"Error"}),v.jsx("p",{children:a})]}):v.jsxs("div",{className:"container mx-auto p-4 max-w-4xl",children:[v.jsx("h1",{className:"text-2xl font-bold mb-6 text-center",children:"Usuarios del Sistema"}),v.jsx("div",{className:"flex justify-end mb-4",children:v.jsx("button",{onClick:b,className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700",children:"Agregar usuario"})}),e.length===0?v.jsx("div",{className:"bg-yellow-100 border-l-4 border-yellow-500 text-yellow-700 p-4 rounded shadow-md",children:v.jsx("p",{children:"No se encontraron usuarios en el sistema."})}):v.jsxs(v.Fragment,{children:[v.jsxs("p",{className:"mb-4 text-gray-600",children:["Total de usuarios: ",e.length]}),v.jsx("div",{className:"overflow-x-auto",children:v.jsxs("table",{className:"min-w-full bg-white border border-gray-200 shadow-md rounded-lg",children:[v.jsx("thead",{className:"bg-gray-100",children:v.jsxs("tr",{children:[v.jsx("th",{className:"py-3 px-4 text-left border-b",children:"Usuario"}),v.jsx("th",{className:"py-3 px-4 text-left border-b",children:"Rol"}),v.jsx("th",{className:"py-3 px-4 text-left border-b",children:"Nombre"}),v.jsx("th",{className:"py-3 px-4 text-left border-b",children:"Email"}),v.jsx("th",{className:"py-3 px-4 text-left border-b",children:"Estado"}),v.jsx("th",{className:"py-3 px-4 text-left border-b",children:"ltimo Acceso"})]})}),v.jsx("tbody",{children:e.map(A=>v.jsxs("tr",{className:"hover:bg-gray-50",children:[v.jsx("td",{className:"py-3 px-4 border-b",children:A.username}),v.jsx("td",{className:"py-3 px-4 border-b",children:v.jsx("span",{className:`px-2 py-1 rounded-full text-xs font-semibold 
                        ${A.role==="admin"?"bg-purple-100 text-purple-800":A.role==="user"?"bg-blue-100 text-blue-800":"bg-gray-100 text-gray-800"}`,children:A.role})}),v.jsx("td",{className:"py-3 px-4 border-b",children:A.full_name||"-"}),v.jsx("td",{className:"py-3 px-4 border-b",children:A.email||"-"}),v.jsx("td",{className:"py-3 px-4 border-b",children:v.jsx("span",{className:`px-2 py-1 rounded-full text-xs font-semibold 
                        ${A.active?"bg-green-100 text-green-800":"bg-red-100 text-red-800"}`,children:A.active?"Activo":"Inactivo"})}),v.jsx("td",{className:"py-3 px-4 border-b",children:A.last_login?new Date(A.last_login).toLocaleString():"Nunca"}),v.jsx("td",{className:"py-3 px-4 border-b text-right",children:v.jsxs("div",{className:"flex gap-2 justify-end",children:[v.jsx("button",{className:"px-3 py-1 rounded bg-gray-100 hover:bg-gray-200",onClick:()=>w(A),children:"Editar"}),v.jsx("button",{className:"px-3 py-1 rounded bg-red-600 text-white hover:bg-red-700",onClick:()=>f(A),children:"Eliminar"})]})})]},A.id))})]})}),v.jsxs("div",{className:"mt-8",children:[v.jsx("h2",{className:"text-xl font-semibold mb-4",children:"Detalle de Usuarios"}),v.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:e.map(A=>v.jsxs("div",{className:"bg-white p-4 rounded-lg shadow border border-gray-200",children:[v.jsxs("div",{className:"flex justify-between items-start",children:[v.jsx("h3",{className:"text-lg font-bold",children:A.username}),v.jsx("span",{className:`px-2 py-1 rounded-full text-xs font-semibold 
                      ${A.role==="admin"?"bg-purple-100 text-purple-800":A.role==="user"?"bg-blue-100 text-blue-800":"bg-gray-100 text-gray-800"}`,children:A.role})]}),v.jsxs("div",{className:"mt-2 text-sm",children:[v.jsxs("p",{children:[v.jsx("span",{className:"font-semibold",children:"Nombre:"})," ",A.full_name||"No especificado"]}),v.jsxs("p",{children:[v.jsx("span",{className:"font-semibold",children:"Email:"})," ",A.email||"No especificado"]}),v.jsxs("p",{children:[v.jsx("span",{className:"font-semibold",children:"Estado:"})," ",A.active?"Activo":"Inactivo"]}),v.jsxs("p",{children:[v.jsx("span",{className:"font-semibold",children:"ltimo acceso:"})," ",A.last_login?new Date(A.last_login).toLocaleString():"Nunca"]}),v.jsxs("p",{children:[v.jsx("span",{className:"font-semibold",children:"Creado:"})," ",new Date(A.created_at).toLocaleString()]}),v.jsxs("p",{className:"text-xs text-gray-500 mt-2 truncate",children:[v.jsx("span",{className:"font-semibold",children:"ID:"})," ",A.id]})]})]},`detail-${A.id}`))})]})]}),v.jsx(bJ,{isOpen:s,onClose:()=>o(!1),form:m,setForm:_,onSave:T,saving:d}),v.jsx(_J,{isOpen:!!l,onClose:()=>c(null),form:m,setForm:_,onSave:F,saving:d}),v.jsx(SJ,{isOpen:!!u,onClose:()=>f(null),user:u,onConfirm:I,saving:d})]})},bJ=({isOpen:e,onClose:t,form:r,setForm:n,onSave:a,saving:i})=>v.jsxs(Xu,{isOpen:e,onRequestClose:t,className:"bg-white rounded-2xl shadow-lg p-6 border border-gray-100 max-w-lg mx-auto mt-20 outline-none",overlayClassName:"fixed inset-0 bg-black bg-opacity-40 flex items-center justify-center z-50",ariaHideApp:!1,children:[v.jsx("h2",{className:"text-xl font-bold mb-4",children:"Agregar usuario"}),v.jsxs("div",{className:"space-y-3",children:[v.jsxs("div",{children:[v.jsx("label",{className:"block text-sm font-medium",children:"Usuario"}),v.jsx("input",{className:"w-full border rounded px-3 py-2",value:r.username,onChange:s=>n(o=>({...o,username:s.target.value}))})]}),v.jsxs("div",{children:[v.jsx("label",{className:"block text-sm font-medium",children:"Nombre"}),v.jsx("input",{className:"w-full border rounded px-3 py-2",value:r.full_name,onChange:s=>n(o=>({...o,full_name:s.target.value}))})]}),v.jsxs("div",{children:[v.jsx("label",{className:"block text-sm font-medium",children:"Email"}),v.jsx("input",{className:"w-full border rounded px-3 py-2",value:r.email,onChange:s=>n(o=>({...o,email:s.target.value}))})]}),v.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[v.jsxs("div",{children:[v.jsx("label",{className:"block text-sm font-medium",children:"Rol"}),v.jsxs("select",{className:"w-full border rounded px-3 py-2",value:r.role,onChange:s=>n(o=>({...o,role:s.target.value})),children:[v.jsx("option",{value:"user",children:"user"}),v.jsx("option",{value:"admin",children:"admin"})]})]}),v.jsxs("div",{className:"flex items-center gap-2 mt-6",children:[v.jsx("input",{id:"active",type:"checkbox",checked:r.active,onChange:s=>n(o=>({...o,active:s.target.checked}))}),v.jsx("label",{htmlFor:"active",children:"Activo"})]})]}),v.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[v.jsxs("div",{children:[v.jsx("label",{className:"block text-sm font-medium",children:"Contrasea"}),v.jsx("input",{type:"password",autoComplete:"new-password",className:"w-full border rounded px-3 py-2",value:r.password,onChange:s=>n(o=>({...o,password:s.target.value}))})]}),v.jsxs("div",{children:[v.jsx("label",{className:"block text-sm font-medium",children:"Confirmar"}),v.jsx("input",{type:"password",autoComplete:"new-password",className:"w-full border rounded px-3 py-2",value:r.confirm,onChange:s=>n(o=>({...o,confirm:s.target.value}))})]})]})]}),v.jsxs("div",{className:"flex justify-end gap-2 mt-6",children:[v.jsx("button",{onClick:t,className:"px-4 py-2 rounded bg-gray-100 hover:bg-gray-200",children:"Cancelar"}),v.jsx("button",{disabled:i,onClick:a,className:"px-4 py-2 rounded bg-blue-600 text-white hover:bg-blue-700 disabled:opacity-60",children:i?"Guardando...":"Guardar"})]})]}),_J=({isOpen:e,onClose:t,form:r,setForm:n,onSave:a,saving:i})=>v.jsxs(Xu,{isOpen:e,onRequestClose:t,className:"bg-white rounded-2xl shadow-lg p-6 border border-gray-100 max-w-lg mx-auto mt-20 outline-none",overlayClassName:"fixed inset-0 bg-black bg-opacity-40 flex items-center justify-center z-50",ariaHideApp:!1,children:[v.jsx("h2",{className:"text-xl font-bold mb-4",children:"Editar usuario"}),v.jsxs("div",{className:"space-y-3",children:[v.jsxs("div",{children:[v.jsx("label",{className:"block text-sm font-medium",children:"Usuario"}),v.jsx("input",{className:"w-full border rounded px-3 py-2",value:r.username,onChange:s=>n(o=>({...o,username:s.target.value}))})]}),v.jsxs("div",{children:[v.jsx("label",{className:"block text-sm font-medium",children:"Nombre"}),v.jsx("input",{className:"w-full border rounded px-3 py-2",value:r.full_name,onChange:s=>n(o=>({...o,full_name:s.target.value}))})]}),v.jsxs("div",{children:[v.jsx("label",{className:"block text-sm font-medium",children:"Email"}),v.jsx("input",{className:"w-full border rounded px-3 py-2",value:r.email,onChange:s=>n(o=>({...o,email:s.target.value}))})]}),v.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[v.jsxs("div",{children:[v.jsx("label",{className:"block text-sm font-medium",children:"Rol"}),v.jsxs("select",{className:"w-full border rounded px-3 py-2",value:r.role,onChange:s=>n(o=>({...o,role:s.target.value})),children:[v.jsx("option",{value:"user",children:"user"}),v.jsx("option",{value:"admin",children:"admin"})]})]}),v.jsxs("div",{className:"flex items-center gap-2 mt-6",children:[v.jsx("input",{id:"active2",type:"checkbox",checked:r.active,onChange:s=>n(o=>({...o,active:s.target.checked}))}),v.jsx("label",{htmlFor:"active2",children:"Activo"})]})]}),v.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[v.jsxs("div",{children:[v.jsx("label",{className:"block text-sm font-medium",children:"Nueva contrasea (opcional)"}),v.jsx("input",{type:"password",autoComplete:"new-password",className:"w-full border rounded px-3 py-2",value:r.password,onChange:s=>n(o=>({...o,password:s.target.value})),onKeyDown:s=>s.stopPropagation(),readOnly:!1})]}),v.jsxs("div",{children:[v.jsx("label",{className:"block text-sm font-medium",children:"Confirmar"}),v.jsx("input",{type:"password",autoComplete:"new-password",className:"w-full border rounded px-3 py-2",value:r.confirm,onChange:s=>n(o=>({...o,confirm:s.target.value})),onKeyDown:s=>s.stopPropagation(),readOnly:!1})]})]})]}),v.jsxs("div",{className:"flex justify-end gap-2 mt-6",children:[v.jsx("button",{onClick:t,className:"px-4 py-2 rounded bg-gray-100 hover:bg-gray-200",children:"Cancelar"}),v.jsx("button",{disabled:i,onClick:a,className:"px-4 py-2 rounded bg-blue-600 text-white hover:bg-blue-700 disabled:opacity-60",children:i?"Actualizar...":"Actualizar"})]})]}),SJ=({isOpen:e,onClose:t,user:r,onConfirm:n,saving:a})=>v.jsxs(Xu,{isOpen:e,onRequestClose:t,className:"bg-white rounded-2xl shadow-lg p-6 border border-gray-100 max-w-md mx-auto mt-20 outline-none",overlayClassName:"fixed inset-0 bg-black bg-opacity-40 flex items-center justify-center z-50",ariaHideApp:!1,children:[v.jsx("h2",{className:"text-xl font-bold mb-2 text-center",children:"Eliminar usuario?"}),v.jsx("p",{className:"text-center",children:"Esta accin no se puede deshacer."}),v.jsx("p",{className:"text-center mt-2 font-semibold",children:r==null?void 0:r.username}),v.jsxs("div",{className:"flex justify-center gap-2 mt-6",children:[v.jsx("button",{onClick:t,className:"px-4 py-2 rounded bg-gray-100 hover:bg-gray-200",children:"Cancelar"}),v.jsx("button",{disabled:a,onClick:n,className:"px-4 py-2 rounded bg-red-600 text-white hover:bg-red-700 disabled:opacity-60",children:a?"Eliminando...":"Eliminar"})]})]}),kJ=()=>v.jsxs("div",{className:"space-y-6",children:[v.jsxs("div",{className:"flex justify-between items-center",children:[v.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"Usuarios del Sistema"}),v.jsx("div",{className:"text-sm text-gray-500",children:"Administracin"})]}),v.jsx("div",{className:"bg-white shadow rounded-lg",children:v.jsx("div",{className:"p-6",children:v.jsx(wJ,{})})})]}),EJ=()=>{const[e,t]=ie.useState("dashboard"),r=()=>{const a={dashboard:dB,articles:yB,movements:bB,existencias:_B,"control-card":OU,"papeleria-nueva":yJ,"import-export":jX,usuarios:kJ}[e];return v.jsx(er.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},exit:{opacity:0,y:-20},transition:{duration:.3},className:"flex-1",children:v.jsx(a,{})},e)};return v.jsxs("div",{className:"min-h-screen bg-gray-50",children:[v.jsx(cB,{}),v.jsx(fB,{currentView:e,onViewChange:t}),v.jsx("main",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:r()})]})};function AJ(){const{isAuthenticated:e,isLoading:t}=Tm();return t?v.jsx("div",{className:"min-h-screen bg-gradient-to-br from-blue-50 via-white to-blue-100 flex items-center justify-center",children:v.jsxs("div",{className:"text-center",children:[v.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600 mx-auto mb-4"}),v.jsx("p",{className:"text-gray-600",children:"Cargando sistema..."})]})}):v.jsxs(v.Fragment,{children:[e?v.jsx(EJ,{}):v.jsx(NR,{},e?"dashboard":"login"),v.jsx(xL,{position:"top-right",toastOptions:{duration:4e3,style:{background:"#363636",color:"#fff"}}})]})}function TJ(){return v.jsx(K9,{children:v.jsx(Q9,{children:v.jsx(AJ,{})})})}mk(document.getElementById("root")).render(v.jsx(ie.StrictMode,{children:v.jsx(QM,{children:v.jsx(TJ,{})})}));export{tr as _,li as c,e6 as g};
